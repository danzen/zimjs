var di=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(wt,It)=>(typeof require<"u"?require:wt)[It]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')});import"@danzen/createjs";var j=window||{},Ne=j.createjs,Pt=j.zns,dt=j.zon==null?!0:j.zon,hi,pi,cn,Gn=dt?console.log.bind(console):function(){},$n=" border:thin solid black; color: black",ti=dt?console.log.bind(console,"%c Z ","background: #acd241;"+$n):function(){},gi=dt?console.log.bind(console,"%c Z ","background: #e472c4;"+$n):function(){},Rr=dt?console.log.bind(console,"%c Z ","background: #50c4b7;"+$n):function(){},ni=dt?console.log.bind(console,"%c Z ","background: #fb4758;"+$n):function(){},tt=dt?console.log.bind(console,"%c Z ","background: #ebcb35;"+$n):function(){},ri=dt?console.log.bind(console,"%c Z ","background: #f58e25;"+$n):function(){},Ar=dt?console.log.bind(console,"%c Z ","background: #eeeeee;"+$n):function(){},kr=dt?console.log.bind(console,"%c Z ","background: #444444; border:thin solid black; color: white"):function(){};function wn(t){return De("1"),document.getElementById(t)}function vi(t){if(De("2"),document.getElementById(t))return document.getElementById(t).style;dt&&tt("zss(): id not found")}function nr(t,wt,It,St,bt,Ct){if(De("3"),n(wt)&&wt!=""||wt=="_self")j.location.href=t;else{var Xt="";return It&&(Xt+="width="+It+","),St&&(Xt+="height="+St+","),bt&&(Xt+="fullscreen=yes,"),Ct&&(Xt+="modal=yes,alwaysRaised=yes"),j.open(t,wt,Xt)}}function Qn(t){if(De("4"),!n(t))return Number(String(t).replace(/[^\d.-]/g,""))}function n(t){return t==null}function yi(t){De("5"),!n(t)&&(t.stopImmediatePropagation&&t.stopImmediatePropagation(),j.event&&(j.event.cancelBubble=!0))}function Yr(){return De("6"),j.zilK&&(j.removeEventListener("keydown",j.zilK),j.removeEventListener("wheel",j.zilW),j.removeEventListener("DOMMouseScroll",j.zilS)),j.zilK=function(t){t||(t=event),t.keyCode&&t.keyCode>=32&&t.keyCode<=40&&t.preventDefault()},j.zilW=function(t){t||(t=event),t.preventDefault()},j.zilS=j.zilW,j.addEventListener("keydown",j.zilK,{passive:!1}),j.addEventListener("wheel",j.zilW,{passive:!1}),j.addEventListener("DOMMouseScroll",j.zilS,{passive:!1}),[j.zilK,j.zilW,j.zilS]}function fr(t,wt){De("6.1");function It(){var St=this;this.on=function(bt,Ct){if(!(n(t)||n(bt)||n(Ct)))for(var Xt=St.tags,qt=0;qt<Xt.length;qt++)Xt[qt].addEventListener(bt,Ct)},this.off=function(bt,Ct){if(!(n(t)||n(bt)||n(Ct)))for(var Xt=St.tags,qt=0;qt<Xt.length;qt++)Xt[qt].removeEventListener(bt,Ct)},Object.defineProperty(St,"tags",{get:function(){return n(t)?[]:typeof t=="string"||t instanceof String?(wt&&ri(t,document.querySelector(t)),wt?[document.querySelector(t)]:document.querySelectorAll(t)):typeof t.innerHTML=="string"?[t]:[]},set:function(){}}),this.css=function(bt,Ct){for(var Xt=St.tags,qt=0;qt<Xt.length;qt++)if(arguments.length==1&&arguments[0].constructor==={}.constructor)for(var At in bt)Xt[qt].style[At]=bt[At];else{if(arguments.length==1)return St.tags[0].style[bt];Xt[qt].style[bt]=Ct}},this.prop=function(bt,Ct){if(!n(bt)){for(var Xt=St.tags,qt=[],At=0;At<Xt.length;At++)if(n(Ct))if(bt.constructor==={}.constructor)for(var Nt in bt)Xt[At][Nt]=bt[Nt];else qt.push(Xt[At][bt]);else Xt[At][bt]=Ct;if(n(Ct))return qt}}}return new It}function dn(t){return t.length==1&&t[0]!=null&&t[0].constructor==={}.constructor}function st(t,wt,It,St){var bt=ve&&(ve.ZIMONON||ii);if(dn(wt)){De("7");var Ct=wt[0],Xt;for(var qt in Ct)(Xt=qt.match(/^(.+)gColor$/))&&(Ct[Xt[1]+"ackgroundColor"]=Ct[qt],delete Ct[qt]);var At=n(It)?t.toString().split(/\n/,1)[0].match(/\((.*)\)/)[1].replace(/\s+/g,"").split(","):It.replace(/\s+/g,"").split(","),Nt=[],Ke,e;for(Ke=0;Ke<At.length;Ke++)e=At[Ke].split("=")[0],At[Ke]=e,Nt.push(Ct[e]);for(Ke in Ct)At.indexOf(Ke)<0&&dt&&tt(t,"bad argument "+Ke);var r;return(r=Object.prototype.isPrototypeOf.call(t.prototype,St)?new(t.bind.apply(t,[null].concat(Nt))):t.apply(null,Nt))?(bt&&!r.arguments&&(r.arguments=[Ct]),r):!0}else bt&&St&&wt&&n(St.arguments)&&(St.arguments=Array.prototype.slice.call(wt))}function nt(t){if(De("7.5"),De("17.6"),!n(t))return ve.Pick.choose(t)}var xi=console.table&&dt?console.table.bind(console):function(){},wi=function(){for(var t=0;t<arguments.length;t++)if(!n(arguments[t]))return arguments[t]},ve=function(t){t.chop=function(e,r,i,l,a,s){if(De("7.8"),!n(e)){n(r)&&(r=3),n(i)&&(i=3),n(l)&&(l=!0),n(a)&&(a=0),n(s)&&(s=1),e.getBounds||(e=new t.Bitmap(e));var f=e.getBounds();n(f)&&tt("ZIM chop() - obj must have bounds");var c=f.width/r,w=f.height/i,T=a,p=[];return t.loop(i,function(x){t.loop(r,function(P){var m=new t.Bitmap(e,c+T*2,w+T*2,P*c-T,x*w-T,s);a!=0?(m.setBounds(T,T,c,w),m.regX=T,m.regY=T):m.setBounds(T,T,c,w),p.push(m)})}),l?new t.Tile(p,r,i,0,0,!0).sca(e.scaleX,e.scaleY):p}},t.shuffle=function(e,r){if(De("8"),!n(e)){Array.isArray(e)||(e=Object.values(arguments));var i=e.length,l,a;if(i==0)return e;if(r){for(var s=t.copy(e);t.arraysEqual(s,e);)t.shuffle(e);return e}else{for(;--i;)l=Math.floor(Math.random()*(i+1)),a=e[i],e[i]=e[l],e[l]=a;return e}}},t.pluck=function(e,r){if(De("9.26"),n(e)||e.length==0)return null;Array.isArray(e)||(e=Object.values(arguments));var i=Math.floor(Math.random()*e.length),l=e[i];return r&&e.splice(i,1),l},t.rand=function(e,r,i,l){if(De("9"),n(e)&&n(r))return Math.random();(n(e)||isNaN(e))&&(e=0),(n(r)||isNaN(r))&&(r=0),(e%1!=0||r%1!=0)&&(i=!1),n(i)&&(i=!0),l&&Math.random()>.5&&(e*=-1,r*=-1),i&&(e>r?e++:r>e&&r++);var a;return e==0&&r==0?0:(r==0?a=Math.random()*e:a=Math.min(e,r)+Math.random()*(Math.max(e,r)-Math.min(e,r)),i?Math.floor(a):a)},t.seedRandom=function(e){return De("9.01"),function(r,i,l,a,s,f,c,w,T){function p(L){var Y,_=L.length,k=this,$=0,O=k.i=k.j=0,X=k.S=[];for(_||(L=[_++]);a>$;)X[$]=$++;for($=0;a>$;$++)X[$]=X[O=y&O+L[$%_]+(Y=X[$])],X[O]=Y;(k.g=function(R){for(var Q,K=0,q=k.i,ne=k.j,U=k.S;R--;)Q=U[q=y&q+1],K=K*a+U[y&(U[q]=U[ne=y&ne+Q])+(U[ne]=Q)];return k.i=q,k.j=ne,K})(a)}function x(L,Y){var _,k=[],$=typeof L;if(Y&&$=="object")for(_ in L)try{k.push(x(L[_],Y-1))}catch{+function(){}()}return k.length?k:$=="string"?L:L+"\0"}function P(L,Y){for(var _,k=L+"",$=0;$<k.length;)Y[y&$]=y&(_^=19*Y[y&$])+k.charCodeAt($++);return v(Y)}function m(L){try{return I?v(I.randomBytes(a)):(r.crypto.getRandomValues(L=new Uint8Array(a)),v(L))}catch{return[+new Date,r,(L=r.navigator)&&L.plugins,r.screen,v(i)]}}function v(L){return String.fromCharCode.apply(0,L)}var I,g=l.pow(a,s),E=l.pow(2,f),A=2*E,y=a-1,C=l["seed"+T]=function(L,Y,_){var k=[];Y=Y==1?{entropy:!0}:Y||{};var $=P(x(Y.entropy?[L,v(i)]:L??m(),3),k),O=new p(k);return P(v(O.S),i),(Y.pass||_||function(X,R,Q){return Q?(l[T]=X,R):X})(function(){for(var X=O.g(s),R=g,Q=0;E>X;)X=(X+Q)*a,R*=a,Q=O.g(1);for(;X>=A;)X/=2,R/=2,Q>>>=1;return(X+Q)/R},$,"global"in Y?Y.global:this==l)};if(P(l[T](),i),c&&c.exports){c.exports=C;try{I=di("crypto")}catch{}}else w&&w.amd&&w(function(){return C})}(this,[],Math,256,6,52,typeof module=="object"&&module,typeof define=="function"&&define,"random"),t.randomO||(t.randomO=Math.random),n(e)?Math.random=t.randomO:Math.seedrandom(e),e},t.odds=function(e){return De("9.1"),(n(e)||isNaN(e))&&(e=50),Math.random()<=e/100},t.rarity=function(e,r,i,l){if(De("9.2"),n(e)||e.constructor!={}.constructor)return[];n(r)&&(r=!0),n(i)&&(i=!0),n(l)&&(l=!1);var a=[];return t.loop(e,function(s,f){var c=t.colors.indexOf(s);c!=-1&&(s=t.colorsHex[c]);var w;Array.isArray(f)?(+s==+s?s=new Number(s):s=new String(s),s._payload=f[1],s.dynamicPayload=l,Object.defineProperty(s,"payload",{get:function(){return!this.dynamicPayload&&this._lastPayload!=null?this._lastPayload:(this._lastPayload=t.Pick.choose(this._payload),this._lastPayload)},set:function(T){this._lastPayload=null,this._payload=T}}),w=f[0],t.loop(w,function(){a.push(s)})):(w=f,t.loop(w,function(){+s==+s&&(s=+s),a.push(s)}))}),r&&t.shuffle(a),a},t.repeats=function(e,r){if(De("9.25"),n(e)||!Array.isArray(e))return 0;var i={},l=0,a=0;return t.loop(e,function(s){i[s]!=null?(i[s]++,a++):i[s]=0,i[s]>l&&(l=i[s])}),r?a:l},t.series=function(){De("13.61");var e,r;if(arguments.length==0)return function(){};arguments.length==1&&Array.isArray(arguments[0])?e=arguments[0]:arguments.length==1&&arguments[0].constructor=={}.constructor?(r=arguments[0],n(r.min)&&(r.min=0),n(r.max)&&(r.max=1),n(r.step)&&(r.step=1),e=[],t.loop(Math.floor(Math.abs(r.max-r.min)+r.step),function(g){e.push(g+r.min)},null,null,r.step),r=null):e=Array.prototype.slice.call(arguments);var i=0,l=1,a=1,s=0,f=0,c=!1,w=!1,T=!1,p=!1,x=!1,P,m,v=function(g,E){if(s&&f%s!=0)return f++,m;f++;var A=e.length,y;if((p||x)&&i%A==0&&t.shuffle(e),y=e[(A*10+i)%A],i==0&&(P=y),x&&i%A==0&&A>1)for(;y==m;)t.shuffle(e),y=e[(A*10+i)%A];return c?l>0&&i+l*a>=A?(l=-1,i=A-1-(i+a-(A-1))):l<0&&i+l*a<0?(l=1,i=a-i):i+=l*a:w?l>0&&i+l*a>=A?(l=-1,i=A-1-(i+a-(A-1))+a):l<0&&i+l*a<0?(l=1,i=a-i-a):i+=l*a:T?l>0&&i+l*a>=A?i=A-1:l<0&&i+l*a<0?i=0:i+=l*a:i+=l*a,m=y,t.isPick(y)?y.noPick&&E?y:t.Pick.choose(y):y},I=v.original=t.copy(e);return v.array=e,v.type="series",Object.defineProperty(v,"index",{get:function(){var g=e.length;return(g*10+i)%g},set:function(g){i=g,f=0}}),Object.defineProperty(v,"length",{get:function(){return e.length},set:function(){}}),v.jump=function(g){return i=g,v},v.reverse=function(g){return n(g)&&(g=!0),g?l=-1:l=1,i=e.length-1,v},v.bounce=function(g){n(g)&&(g=!0);var E=e.length;return i=(E*10+i)%E,c=g,v},v.flip=function(g){n(g)&&(g=!0);var E=e.length;return i=(E*10+i)%E,w=g,v},v.step=function(g){return n(g)&&(g=1),a=Math.floor(g),v},v.every=function(g){return n(g)&&(g=1),s=Math.abs(g),f=0,v},v.constrain=function(g){return n(g)&&(g=!0),T=g,v},v.random=function(g){return n(g)&&(g=!0),g||(e=I),p=g==!0,v},v.mix=function(g){return n(g)&&(g=!0),g||(e=I),x=g==!0,v},v.shuffle=function(g){return n(g)&&(g=!0),g?t.shuffle(e):e=I,v},v},t.makeSeries=function(e){if(De("13.6"),n(e))return function(){};var r=0,i=function(){return e[r++%e.length]};return i.array=e,i},t.loop=function(e,r,i,l,a,s,f,c){var w="obj, call, reverse, interval, step, start, end, immediate",T;if(T=st(t.loop,arguments,w))return T;if(De("9.5"),n(e)||n(r))return;n(i)&&(i=!1),n(l)&&(l=0),(n(a)||a<=0)&&(a=1),n(c)&&(c=!0),e.constructor===Number&&(e=Number(e)),e.constructor===String&&(e=String(e));var p=typeof e=="number"?"number":e.constructor===Array?"array":e.constructor==={}.constructor?"object":typeof e=="string"?"string":e instanceof NodeList?"nodelist":e instanceof HTMLCollection?"htmlcollection":e.type&&e.type=="Dictionary"?"Dictionary":"invalid";if(p=="invalid")return;var x,P,m,v;if(p=="number"||p=="string"||p=="array"||p=="nodelist"||p=="htmlcollection"||p=="Dictionary"){if(p=="Dictionary"){var I=t.copy(e.values);e=t.copy(e.objects)}if(x=p=="number"?e:e.length,P=E(x-1),P==0)return;if(i)if(l===0){for(m=s;m>=f;m-=a)if(p=="number"?v=r(m,P,s,f,e):p=="array"||p=="string"?v=r(e[m],m,P,s,f,e):p=="Dictionary"?v=r(e[m],I[m],m,P,s,f,e):v=r(e.item(m),m,P,s,f,e),typeof v<"u"&&v!="next")return v}else t.interval(l,function(A){if(m=A.count,c||m--,a&&(m*=a),m=s-m,p=="number"?v=r(m,P,s,f,e):p=="array"||p=="string"?v=r(e[m],m,P,s,f,e):p=="Dictionary"?v=r(e[m],I[m],m,P,s,f,e):v=r(e.item(m),m,P,s,f,e),v=="next")A.next();else if(typeof v<"u")return A.clear(),v},P,c);else if(l===0){for(m=s;m<=f;m+=a)if(p=="number"?v=r(m,P,s,f,e):p=="array"||p=="string"?v=r(e[m],m,P,s,f,e):p=="Dictionary"?v=r(e[m],I[m],m,P,s,f,e):v=r(e.item(m),m,P,s,f,e),typeof v<"u"&&v!="next")return v}else t.interval(l,function(A){if(m=A.count,c||m--,a&&(m*=a),p=="number"?v=r(m,P,s,f,e,A):p=="array"||p=="string"?v=r(e[m],m,P,s,f,e,A):p=="Dictionary"?v=r(e[m],I[m],m,P,s,f,e):v=r(e.item(m),m,P,s,f,e,A),v=="next")A.next();else if(typeof v<"u")return A.clear(),v},P,c);return!0}else if(p=="object"){x=0;var g=[];for(m in e)x++,g.push(m);if(P=E(x-1),P==0)return;if(i)if(l===0){for(m=s;m>=f;m-=a)if(v=r(g[m],e[g[m]],m,P,s,f,e),typeof v<"u")return v}else t.interval(l,function(A){if(m=A.count,c||m--,a&&(m*=a),m=s-m,v=r(g[m],e[g[m]],m,P,s,f,e),v=="next")A.next();else if(typeof v<"u")return A.clear(),v},P,c);else if(l===0){for(m=s;m<=f;m+=a)if(v=r(g[m],e[g[m]],m,P,s,f,e),typeof v<"u")return v}else t.interval(l,function(A){if(m=A.count,c||m--,a&&(m*=a),v=r(g[m],e[g[m]],m,P,s,f,e),v=="next")A.next();else if(typeof v<"u")return A.clear(),v},P,c);return!0}function E(A){return n(s)&&(s=i?A:0),n(f)&&(f=i?0:A),i&&f>s||!i&&s>f||(s<0&&f)<0||s>A&&f>A?0:(s=Math.max(0,Math.min(s,A)),f=Math.max(0,Math.min(f,A)),Math.floor((i?s-f:f-s)/a)+1)}};function wt(e,r,i,l,a){t.timeCheck||(De("9.99"),t.timeCheck=!0);var s=n(j.TIME)?n(t.TIME)?"seconds":t.TIME:j.TIME;return s&&s.toLowerCase&&(s=s.toLowerCase()),s!="milliseconds"&&s!="ms"&&(s="seconds"),r&&r.toLowerCase&&(r=r.toLowerCase()),(r=="ms"||r=="milliseconds"||r=="seconds"||r=="s")&&(s=r),n(e)?s.charAt(0):(s=="ms"&&(s="milliseconds"),s=="s"&&(s="seconds"),s=s.charAt(0),a||It(e,s,i,l),s)}function It(e,r,i,l){n(i)&&(i=10),n(l)&&(l=9),!(!t.TIMECHECK&&!j.TIMECHECK)&&(r!="m"&&e>i||r=="m"&&e<l)&&dt&&tt("TIME - warning: time is in "+(r=="m"?"milliseconds":"seconds")+" ("+e+")")}if(t.timeout=function(e,r,i,l){var a="time, call, pauseOnBlur, timeUnit",s;if(s=st(t.timeout,arguments,a,this))return s;if(De("9.7"),!n(r)&&typeof r=="function"){var f=t.interval(e,r,1,!1,i,l);return f.type="timeoutObj",f}},t.interval=function(e,r,i,l,a,s){var f="time, call, total, immediate, pauseOnBlur, timeUnit",c;if(c=st(t.interval,arguments,f,this))return c;if(De("9.8"),n(r)||typeof r!="function")return;var w=wt(e,s);if(n(e)&&(e=w=="s"?1:1e3),n(l)&&(l=!1),!n(i)&&(isNaN(i)||i<=0))return;n(i)&&(i=-1);var T={count:0,total:i,paused:!1,time:e,active:!0,timeUnit:s};a&&(n(t.blurCheck)&&t.setBlurDetect(),t.pauseOnBlur.push(T));function p(){T.startTime=Date.now(),T.interval=t.Pick.choose(T.time),T.id=setTimeout(function(){T.paused||T.active&&(T.count++,r(T),p(),x())},T.interval*(w=="s"?1e3:1))}l&&setTimeout(function(){r(T),x()},10);function x(){i!=-1&&T.count>=(l?T.total-1:T.total)&&T.clear()}var P;return T.type="intervalOjbect",T.pause=function(m,v,I){n(m)&&(m=!0),m?(clearTimeout(P),clearTimeout(T.id),cancelAnimationFrame(T.rid),T.pauseTimeLeft=T.interval-(Date.now()-T.startTime)/(w=="s"?1e3:1)):(T.paused||T.pause(!0),P=setTimeout(function(){T.count++,r(T),p(),x()},v?0:(I?T.interval:T.pauseTimeLeft)*(w=="s"?1e3:1)),T.pauseTimeLeft=null),T.paused=m},T.next=function(){T.count++,r(T),x()},T.clear=function(){T.active=!1,clearTimeout(P),cancelAnimationFrame(T.rid),clearTimeout(T.id);var m=T.count;for(var v in T)delete T[v];T.active=!1,T.count=m,T.pause=function(){},T.clear=function(){}},p(),T},t.async=function(e,r,i,l,a){if(De("29"),!n(e)){var s=document.createElement("script"),f=wt(l);n(l)&&(l=f=="s"?2:2e3);var c;r?(i?c=i:c=r.toString().split(/\n/,1)[0].match(/^function\s?([^\s(]*)/)[1],t.asyncList||(t.asyncList={}),t.asyncList[c]||(t.asyncList[c]=[]),t.asyncList[c].push(r),t.async[c]=function(){var w=s,T=!1,p=setTimeout(function(){T=a,typeof r=="function"&&r("asyncError",a?"cancelled":"timeout")},l*(f=="s"?1e3:1));return function(x){clearTimeout(p),t.asyncList[c]&&(r=t.asyncList[c].shift()),typeof r=="function"&&!T&&r(x),w&&w.parentNode.removeChild(w),w=null}}()):(t.async.z_s&&t.async.z_s.parentNode&&t.async.z_s.parentNode.removeChild(t.async.z_s),t.async.z_s=s),e.match(/\?/)||(e+="?"),s.setAttribute("src",e+"&r="+Math.random()),document.getElementsByTagName("head")[0].appendChild(s)}},t.couple=function(e){if(De("29.2"),!t.isJSON(e))return e;var r=JSON.parse(e),i={};for(var l in r){var a=r[l];for(var s in a)i[l+"_"+s]=a[s]}return JSON.stringify(i)},t.decouple=function(e){if(De("29.3"),!t.isJSON(e))return e;var r=JSON.parse(e),i={};for(var l in r){var a=l.split("_",2);if(a.length!=2)return e;i[a[0]]||(i[a[0]]={}),i[a[0]][a[1]]=r[l]}return JSON.stringify(i)},t.convertColor=function(e,r,i){if(t.convertColorCheck||(De("27.5"),t.convertColorCheck=!0),n(r)&&(r="hex"),n(e)||!e.toLowerCase)return;e=nt(e),e=e.toLowerCase(),r=r.toLowerCase();var l=["black","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgrey","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","grey","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgrey","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"],a=["000000","f0f8ff","faebd7","00ffff","7fffd4","f0ffff","f5f5dc","ffe4c4","ffebcd","0000ff","8a2be2","a52a2a","deb887","5f9ea0","7fff00","d2691e","ff7f50","6495ed","fff8dc","dc143c","00ffff","00008b","008b8b","b8860b","a9a9a9","a9a9a9","006400","bdb76b","8b008b","556b2f","ff8c00","9932cc","8b0000","e9967a","8fbc8f","483d8b","2f4f4f","2f4f4f","00ced1","9400d3","ff1493","00bfff","696969","696969","1e90ff","b22222","fffaf0","228b22","ff00ff","dcdcdc","f8f8ff","ffd700","daa520","808080","808080","008000","adff2f","f0fff0","ff69b4","cd5c5c","4b0082","fffff0","f0e68c","e6e6fa","fff0f5","7cfc00","fffacd","add8e6","f08080","e0ffff","fafad2","d3d3d3","d3d3d3","90ee90","ffb6c1","ffa07a","20b2aa","87cefa","778899","778899","b0c4de","ffffe0","00ff00","32cd32","faf0e6","ff00ff","800000","66cdaa","0000cd","ba55d3","9370db","3cb371","7b68ee","00fa9a","48d1cc","c71585","191970","f5fffa","ffe4e1","ffe4b5","ffdead","000080","fdf5e6","808000","6b8e23","ffa500","ff4500","da70d6","eee8aa","98fb98","afeeee","db7093","ffefd5","ffdab9","cd853f","ffc0cb","dda0dd","b0e0e6","800080","663399","ff0000","bc8f8f","4169e1","8b4513","fa8072","f4a460","2e8b57","fff5ee","a0522d","c0c0c0","87ceeb","6a5acd","708090","708090","fffafa","00ff7f","4682b4","d2b48c","008080","d8bfd8","ff6347","40e0d0","ee82ee","f5deb3","ffffff","f5f5f5","ffff00","9acd32"];if(r=="zim"){var s=t.colorsHex.indexOf(e);return s<0?e:t.colors[t.colorsHex.indexOf(e)]}r=="hsv"&&r=="hsl";var f,c;if(f=e.match(/rgba\((.*)\)/)){c=f[1].split(",");var w=c.pop();if(n(i)&&(i=w),r=="array")return c.push(w),c;if(e="rgb("+c.join(",")+")",r=="rgb")return e;if(r=="hsl")return x(c[0],c[1],c[2])}function T(A){var y=Number(A).toString(16);return y.length<2&&(y="0"+y),y}function p(A,y,C,L,Y){return(Y-L)*(A-y)/(C-y)+L}function x(A,y,C){A/=255,y/=255,C/=255;let L=Math.max(A,y,C),Y=L-Math.min(A,y,C),_=Y?L===A?(y-C)/Y:L===y?2+(C-A)/Y:4+(A-y)/Y:0;return[60*_<0?60*_+360:60*_,100*(Y?L<=.5?Y/(2*L-Y):Y/(2-(2*L-Y)):0),100*(2*L-Y)/2]}function P(A){var y=A.split(","),C=T(y[0]),L=T(y[1]),Y=T(y[2]),_=n(_)?"":T(Math.round(Number(y[3])*255));return[C,L,Y,_]}n(i)&&(i=1);var m,v,I;if(f=e.match(/rgb\((.*)\)/))return r=="rgba"?"rgba("+f[1]+","+i+")":r=="hex"?(m=i!=1?","+i:"",v=P(f[1]+m),"#"+v[0]+v[1]+v[2]+v[3]):r=="hexnumber"?(m=i!=1?","+i:0,v=P(f[1]+m),parseInt(v[0]+""+v[1]+v[2],16)):r=="string"?(e=P(f[1]).join("").toLowerCase(),I=a.indexOf(e),I==-1?"#"+e:l[I]):r=="array"?(m=i!=1?","+i:0,P(f[1]+m)):r=="hsl"?(c=f[1].split(","),x(c[0],c[1],c[2])):e;function g(A){var y;return/^#([A-Fa-f0-9]{3}){1,2}$/.test(A)?(y=A.substring(1).split(""),y.length==3&&(y=[y[0],y[0],y[1],y[1],y[2],y[2]]),y="0x"+y.join(""),r=="rgb"?"rgb("+[y>>16&255,y>>8&255,y&255]+")":r=="array"?[y>>16&255,y>>8&255,y&255,i]:"rgba("+[y>>16&255,y>>8&255,y&255].join(",")+","+i+")"):/^#([A-Fa-f0-9]{4}){1,2}$/.test(A)?(y=A.substring(1).split(""),y.length==8&&(i=y.slice(-2).join(""),y=y.slice(0,6)),y.length==4&&(i=y[3]+""+y[3],y=[y[0],y[0],y[1],y[1],y[2],y[2]]),i=parseInt(i,16)/255,y="0x"+y.join(""),r=="rgb"?"rgb("+[y>>16&255,y>>8&255,y&255]+")":"rgba("+[y>>16&255,y>>8&255,y&255].join(",")+","+i+")"):r=="rgb"?"rgb(0,0,0)":"rgba(0,0,0,1)"}if(r=="hsl")return t.convertColor(t.convertColor(e,"rgb"),"hsl");if(r=="array"||r=="rgb"||r=="rgba")return e.charAt(0)=="#"?g(e):g(t.convertColor(e));if(r=="hex"){if(e.charAt(0)=="#")if(i!=1)if(m=T(Math.round(i*255)),e.length==4||e.length==5){var E=e.split("");return E[1]=E[1]+""+E[1],E[2]=E[2]+""+E[2],E[3]=E[3]+""+E[3],E[4]=m,E.join("")}else return e.length==9?e.substring(0,l.length-2)+m:e+m;else return e}else if(r=="hexnumber"){if(e.charAt(0)=="#")return parseInt(e.replace(/^#/,""),16)}else e.charAt(0)=="#"&&(e=e.replace("#",""),e.length==3&&(e=e.charAt(0)+e.charAt(0)+e.charAt(1)+e.charAt(1)+e.charAt(2)+e.charAt(2)));return r=="string"?(I=a.indexOf(e),I==-1?"#"+e:l[I]):r=="hexnumber"?parseInt(a[l.indexOf(e.toLowerCase())!=-1?l.indexOf(e):0],16):(m=i!=1?T(Math.round(i*255)):"","#"+a[l.indexOf(e.toLowerCase())!=-1?l.indexOf(e):0]+m)},t.colorRange=function(e,r,i){t.colorRangeCheck||(De("27.6"),t.colorRangeCheck=!0),n(i)&&(i=.5),i=Math.max(0,Math.min(1,i)),n(e)&&(e="white"),n(r)&&(r="black");var l=e,a=r,s=t.convertColor(e,"rgb"),f=t.convertColor(r,"rgb");e=s.substring(4,s.length-1).split(","),r=f.substring(4,f.length-1).split(",");var c,w="#",T;if(i==0)w=l;else if(i==1)w=a;else for(var p=0;p<e.length;p++)c=r[p]-e[p],T=Math.floor(parseInt(e[p],10)+c*i).toString(16),T.length<2&&(T="0"+T),w+=T;return w},t.lighten=function(e,r){return t.lightenCheck||(De("27.65"),t.lightenCheck=!0),n(r)&&(r=.5),r>=0?t.colorRange(String(e),"#FFFFFF",r):t.colorRange(String(e),"#000000",-r)},t.darken=function(e,r){return n(r)&&(r=.5),t.darkenCheck||(De("27.66"),t.darkenCheck=!0),r>=0?t.colorRange(String(e),"#000000",r):t.colorRange(String(e),"#ffffff",-r)},t.toColor=function(e,r,i){return t.toColorCheck||(De("27.67"),t.toColorCheck=!0),n(i)&&(i=.5),t.colorRange(String(e),r,i)},t.toAlpha=function(e,r){return t.toAlphaCheck||(De("27.68"),t.toAlphaCheck=!0),n(r)&&(r=.5),t.convertColor(String(e),"rgba",r)},t.toBW=function(e){if(e.indexOf("#")===0&&(e=e.slice(1)),e.length===3&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),e.length!==6)return tt("ZIM toBW() - needs hex input"),e;var r=parseInt(e.slice(0,2),16),i=parseInt(e.slice(2,4),16),l=parseInt(e.slice(4,6),16);return r*.299+i*.587+l*.114>186?"#000000":"#FFFFFF"},t.invertColor=function(e){if(t.invertColorCheck||(De("27.86"),t.invertColorCheck=!0),e.indexOf("#")===0&&(e=e.slice(1)),e.length===3&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),e.length!==6)return tt("ZIM invertColor() - needs hex input"),e;var r=parseInt(e.slice(0,2),16),i=parseInt(e.slice(2,4),16),l=parseInt(e.slice(4,6),16);r=(255-r).toString(16),i=(255-i).toString(16),l=(255-l).toString(16);function a(s,f){f=f||2;var c=new Array(f).join("0");return(c+s).slice(-f)}return"#"+a(r)+a(i)+a(l)},t.zimEase=function(e,r,i,l,a){De("27.69");var s=!1;n(a)&&(a=!0);var f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_;if(e){if(Array.isArray(e[1])){s=!0,_=e[1],e=e[0];var k=0,$=_[0],O=_[1],X=_[2],R=_[3],Q=1,K=5*($-k),q=10*(O-k)-4*K,ne=10*(X-k)+30*($-O),U=5*(R+k)-20*(X+$)+30*O,D=Q-k-U-ne-q-K}f=0,c=e[0],w=e[1],T=e[2],p=e[3],x=1,P=5*(c-f),m=10*(w-f)-4*P,v=10*(T-f)+30*(c-w),I=5*(p+f)-20*(T+c)+30*w,g=x-f-I-v-m-P}else r?(g=r[0],I=r[1],v=r[2],m=r[3],P=r[4],c=P/5,w=(m+4*P)/10,T=(v+6*P+3*m)/10,p=(I+4*P+3*m+2*v)/5):(g=0,I=0,v=0,m=0,P=1);return i?(L=function(){return t.zimEase(null,[g,I,v,m,P],!0)},Y={reverse:L,points:[c,w,T,p],polynomials:[g,I,v,m,P]},Y.noPick=function(d){if(a){if(d<.025)return 0;if(d>.975)return 1}return d<.5?(d*=2,E=d*100,A=100,y=(E/=A)*E,C=y*E,(g*C*y+I*y*y+v*C+m*y+P*E)/2):(d=1-(d-.5)*2,E=d*100,A=100,y=(E/=A)*E,C=y*E,1-(g*C*y+I*y*y+v*C+m*y+P*E)/2)}):s?(L=function(){return dt&&tt("zimEase - multi array points cannot be reversed"),t.zimEase(null,[g,I,v,m,P])},Y={reverse:L,points:[[c,w,T,p],[$,O,X,R]],polynomials:[[g,I,v,m,P],[D,U,ne,q,K]]},Y.noPick=function(d){if(a){if(d<.025)return 0;if(d>.975)return 1}return d<.5?(d*=2,E=d*100,A=100,y=(E/=A)*E,C=y*E,(g*C*y+I*y*y+v*C+m*y+P*E)/2):(d=(d-.5)*2,E=d*100,A=100,y=(E/=A)*E,C=y*E,.5+(D*C*y+U*y*y+ne*C+q*y+K*E)/2)}):(L=function(){return t.zimEase(null,[g,I,v,m,P],null,!0)},Y={reverse:L,points:[c,w,T,p],polynomials:[g,I,v,m,P]},l?Y.noPick=function(d){if(a){if(d<.025)return 0;if(d>.975)return 1}return E=100-d*100,A=100,y=(E/=A)*E,C=y*E,1-(g*C*y+I*y*y+v*C+m*y+P*E)}:Y.noPick=function(d){if(a){if(d<.025)return 0;if(d>.975)return 1}return E=d*100,A=100,y=(E/=A)*E,C=y*E,g*C*y+I*y*y+v*C+m*y+P*E}),Y.noPick.reverse=L,Y},t.spline=function(e,r,i,l,a){De("27.695"),n(e)&&(e=[]),n(r)&&(r=1),n(i)&&(i=!1),n(a)&&(a=i);var s;function f(R,Q){if(!Array.isArray(R[0]))for(s=0;s<R.length;s++)R[s]=[R[s].x,R[s].y];if(Q){var K=R[R.length-1],q=R[R.length-2],ne=R[0],U=R[1];R.unshift(K),R.unshift(q),R.push(ne),R.push(U)}var D=[];for(s=0;s<R.length;s++)D.push(R[s][0],R[s][1]);return D}e=f(e,i);var c=e.length,w=c-4,T=i?e[2]:e[0],p=i?e[3]:e[1],x="M"+[T,p];l&&l.mt(T,p);var P=i?2:0,m=i?c-4:c-2,v=2;for(s=P;s<m;s+=v){var I=s?e[s-2]:e[0],g=s?e[s-1]:e[1],E=e[s+0],A=e[s+1],y=e[s+2],C=e[s+3],L=s!==w?e[s+4]:y,Y=s!==w?e[s+5]:C,_=E+(y-I)/6*r,k=A+(C-g)/6*r,$=y-(L-E)/6*r,O=C-(Y-A)/6*r;x+="C"+[_,k,$,O,y,C],l&&l.bt(_,k,$,O,y,C)}if(a){var X=x.split("C");X.pop(),x=X.join("C")}return x},t.pointAlongCurve=function(e,r,i,l){if(De("27.7"),!(!e||!e[0]||!e[1]||!e[2]||!e[3])){n(l)&&(l=!1);var a=new t.Bezier(e[0],e[1],e[2],e[3]),s,f,c,w,T,p;if(l?(s=a.mx(r),f=a.my(r)):(s=a.x(r),f=a.y(r)),i){var x=r-.05,P=r+.05;x<0&&(x=0),P>1&&(P=1),l?(c=a.mx(x),w=a.my(x),T=a.mx(P),p=a.my(P)):(c=a.x(x),w=a.y(x),T=a.x(P),p=a.y(P));var m=t.angle(c,w,T,p);return{x:s,y:f,angle:m}}return{x:s,y:f}}},t.distanceAlongCurve=function(e){De("27.8");var r=t.dist(e[0],e[3]),i=t.dist(e[0],e[1])+t.dist(e[1],e[2])+t.dist(e[2],e[3]);return(r+i)/2},t.closestPointAlongCurve=function(e,r,i,l,a){De("27.9");var s=1e7,f,c=0,w=0;return n(i)&&(i=10),t.loop(r,function(T,p){var x=new t.Bezier(T[0],T[1],T[2],T[3]);t.loop(i,function(P,m){var v={x:x.x(P/m),y:x.y(P/m)},I=t.dist(e,v);I<s&&(s=I,f=v,c=p,w=P)})}),a?(c*i+w)/(r.length*i)*100:l?f:c},t.transformPoints=function(e,r,i,l,a){if(De("27.95"),!(n(e)||!Array.isArray(e))){n(l)&&(l=0),n(a)&&(a=0),e=t.copy(e);var s=l,f=a;r=="rotation"&&(l!=0&&(e=t.transformPoints(e,"x",-s)),a!=0&&(e=t.transformPoints(e,"y",-f)));for(var c,w=0;w<e.length;w++)if(c=e[w],!!Array.isArray(c)){if(r=="x")c[0]+=i;else if(r=="y")c[1]+=i;else if(r=="scaleX")c[0]=(c[0]-l)*i+l,c[4]=c[4]*i,c[6]=c[6]*i;else if(r=="scaleY")c[1]=(c[1]-a)*i+a,c[5]=c[5]*i,c[7]=c[7]*i;else if(r=="scale")c[0]=(c[0]-l)*i+l,c[4]=c[4]*i,c[6]=c[6]*i,c[1]=(c[1]-a)*i+a,c[5]=c[5]*i,c[7]=c[7]*i;else if(r=="rotation"){var T=i*Math.PI/180,p=c[0],x=c[1];c[0]=p*Math.cos(T)-x*Math.sin(T),c[1]=x*Math.cos(T)+p*Math.sin(T),p=c[4],x=c[5],c[4]=p*Math.cos(T)-x*Math.sin(T),c[5]=x*Math.cos(T)+p*Math.sin(T),p=c[6],x=c[7],c[6]=p*Math.cos(T)-x*Math.sin(T),c[7]=x*Math.cos(T)+p*Math.sin(T)}}return r=="rotation"&&(l!=0&&(e=t.transformPoints(e,"x",s)),a!=0&&(e=t.transformPoints(e,"y",f))),e}},t.trimPointEnds=function(e){De("27.97"),e[0][4]=0,e[0][5]=0,e[0][8]="free",e[e.length-1][6]=0,e[e.length-1][7]=0,e[e.length-1][8]="free"},t.reversePoints=function(e){return De("27.975"),e.reverse(),t.loop(e,function(r){var i=r[6];r[6]=r[4],r[4]=i;var l=r[7];r[7]=r[5],r[5]=l}),e},t.appendPoints=function(e,r,i){return De("27.98"),n(e)&&n(r)?[]:n(e)?r:(n(r)||(e[e.length-1][6]=r[0][6],e[e.length-1][7]=r[0][7],i&&(e[e.length-1][8]=i),r.shift(),e=e.concat(r)),e)},t.prependPoints=function(e,r,i){return De("27.985"),n(e)&&n(r)?[]:n(e)?r:(n(r)||(r[r.length-1][6]=e[0][6],r[r.length-1][7]=e[0][7],i&&(e[e.length-1][8]=i),e.shift(),e=r.concat(e)),e)},t.splitPoints=function(e,r,i){if(De("27.99"),!n(e)&&(n(r)&&(r=Math.floor(e.length/2)),!(r<0||r>e.length-1))){n(i)&&(i=!0);var l=t.copy(e.slice(0,r+1)),a=t.copy(e.slice(r));return i&&(t.trimPointEnds(l),t.trimPointEnds(a)),[l,a]}},t.makeID=function(e,r,i){De("13.5"),n(e)&&(e="mixed"),n(r)&&(r=5),n(i)&&(i="uppercase");var l,a=[2,3,4,5,6,7,8,9],s="abcdefghjkmnpqrstuvwxyz".split("");e.constructor===Array?l=e:e=="numbers"?l=a:e=="letters"?l=s:l=a.concat(s);for(var f="",c,w,T=0;T<r;T++)c=l[Math.floor(Math.random()*l.length)],w=Math.random(),i=="uppercase"||i=="mixed"&&w>.5?c.toUpperCase&&(c=c.toUpperCase()):c.toLowerCase&&(c=c.toLowerCase()),f+=String(c);return f},t.makeSyllable=function(e,r){De("13.55");var i="bcdfghjklmnprstvwxz",l="aeiouaeiouaeiouy";n(e)&&(e=3),n(r)&&(r=t.rand()<.3);function a(c){var w=t.rand(c.length-1),T=c.substring(w,w+1);return T}var s="",f=r?l:i;return t.loop(e,function(){s+=a(f),f=f==l?i:l}),s},t.makePrimitive=function(e){De("13.56");function r(i){return Array.isArray(i)?(t.loop(i,function(l){l=r(l)}),i):i.constructor==={}.constructor?(t.loop(i,function(l,a){i[l]=r(a)}),i):i instanceof String?String(i):i instanceof Number?Number(i):i instanceof Boolean?!!i:i}return r(e)},t.makeMath=function(){De("13.565");for(var e=Object.getOwnPropertyNames(Math),r=0;r<e.length;r++)j[e[r]]=Math[e[r]]},t.swapProperties=function(e,r,i){if(De("17.1"),n(r)||n(i)||n(r[e])||n(i[e]))return!1;var l=i[e];return i[e]=r[e],r[e]=l,!0},t.mobile=function(e){return De("28"),!n(j.MOBILE)&&j.MOBILE!="default"?j.MOBILE:!n(t.MOBILE)&&t.MOBILE!="default"?t.MOBILE:(n(e)&&(e=!0),/ip(hone|od|ad)/i.test(navigator.userAgent)?"ios":/android|nexus/i.test(navigator.userAgent)?"android":/blackberry/i.test(navigator.userAgent)?"blackberry":/nokia|phone|mobile/i.test(navigator.userAgent)?"windows":/opera mini|webos/i.test(navigator.userAgent)?"other":e&&j.orientation!==void 0?/safari/i.test(navigator.userAgent)?"ios":!0:!1)},t.vee=function(e){return De("28.5"),!n(e)&&(e.type=="Pick"||Array.isArray(e)||e.constructor=={}.constructor&&(!n(e.max)||!n(e.noPick))||typeof e=="function")},t.extend=function(e,r,i,l,a){var s="subclass, superclass, override, prefix, prototype",f;if(f=st(t.extend,arguments,s))return f;if(n(e)||n(r)){dt&&e!=t.StageGL&&tt("zim.extend() - please supply a class and its superclass");return}n(l)&&(l="super"),n(i)&&(i=[]),Array.isArray(i)||(i=[i]),n(a)&&(a=!0);var c={};for(var w in e.prototype)Object.defineProperty(c,w,Object.getOwnPropertyDescriptor(e.prototype,w));function T(){this.constructor=e}T.prototype=r.prototype,e.prototype=new T;for(w in c)Object.defineProperty(e.prototype,w,Object.getOwnPropertyDescriptor(c,w));var p=e.prototype,x=Object.getPrototypeOf&&Object.getPrototypeOf(p)||p.__proto__;if(x){p[(l+="_")+"constructor"]=x.constructor;for(var P,m=0;m<i.length;m++)P=i[m],typeof x[P]=="function"&&(p[l+P]=x[P]);if(a)for(P in x)Object.prototype.hasOwnProperty.call(p,P)&&typeof x[P]=="function"&&(p[l+P]=x[P])}return e},t.copy=function(e,r,i){if(t.copyCheck||(De("10"),t.copyCheck=!0),n(r)&&(r=!1),n(i)&&(i=!0),e==null||!(e instanceof Array||e.constructor=={}.constructor))return r&&e!=null&&e.clone&&e.type&&(e.type!="Container"&&e.type!="Stage"&&e.type!="StageGL"||i)?e.clone():e;if(e instanceof Array){for(var l=[],a=0;a<e.length;a++)l[a]=t.copy(e[a],r,i);return l}if(e.constructor=={}.constructor){var s={};for(var f in e){var c=t.copy(e[f],r,i);Object.prototype.hasOwnProperty.call(e,f)&&(s[f]=c)}return s}},t.merge=function(){t.mergeCheck||(De("12"),t.mergeCheck=!0);var e={},r,i;for(r=0;r<arguments.length;r++)for(i in arguments[r])Object.prototype.hasOwnProperty.call(arguments[r],i)&&(e[i]=arguments[r][i]);return e},t.sortObject=function(e,r,i){De("12.1");var l=function(c){return c[r]},a=Object.entries(e).sort(function(c,w){return i?l(c[1])<l(w[1])?1:l(c[1])>l(w[1])?-1:0:l(c[1])>l(w[1])?1:l(c[1])<l(w[1])?-1:0}),s=new Map(a),f={};return s.forEach((c,w)=>{f[w]=c}),f},t.arraysEqual=function(e,r,i){if(De("11"),n(e)||n(r)||(n(i)&&(i=!0),e.length!=r.length))return!1;for(var l=0;l<e.length;l++)if(e[l]instanceof Array&&r[l]instanceof Array){if(!t.arraysEqual(e[l],r[l],i))return!1}else{if(i&&e[l]!=r[l])return!1;if(!i)return t.arraysEqual(e.sort(),r.sort(),!0)}return!0},t.arrayMinMax=function(e){if(De("11.2"),!Array.isArray(e))return{min:null,max:null};for(var r=e[0],i=e[0],l=e.length;l--;)r=e[l]<r?e[l]:r,i=e[l]>i?e[l]:i;return r=isNaN(r)?null:r,i=isNaN(i)?null:i,{min:r,max:i}},t.isEmpty=function(e){if(t.zimEmptyCheck||(De("11.5"),t.zimEmptyCheck=!0),!n(e)){var r=0;for(var i in e){r++;break}return r==0}},t.isJSON=function(e){if(De("11.6"),typeof e!="string")return!1;try{return JSON.parse(e),!0}catch{return!1}},t.isPick=function(e){if(t.zimPickCheck||(De("11.7"),t.zimPickCheck=!0),!n(e))return Array.isArray(e)||e.constructor=={}.constructor&&(e.min!=null&&e.max!=null||e.noPick)||e.constructor===Function&&(e.array!=null||e()!=null)},t.zut=function(e){if(n(e)||typeof e=="object")return!0},t.decimals=function(e,r,i,l,a,s,f){if(t.zimDecimalCheck||(De("13"),t.zimDecimalCheck=!0),n(e))return 0;n(r)&&(r=1),n(i)&&(i=0),n(l)&&(l=1),n(a)&&(a=!0),n(s)&&(s=!1);var c=Math.round(e*Math.pow(10,r))/Math.pow(10,r);if(s){var w=c-Math.floor(c);c=t.decimals(Math.floor(c)+w*60/100,2)}var T=t.sign(c),p,x,P;if(i>0)for(p=String(c).indexOf("."),x=String(c).length,p<0&&(p=x++,c+="."),P=0;P<i-(x-p-1);P++)c+="0";if(l>1){T==-1&&(c=c.substr(1,c.length-1)),p=String(c).indexOf("."),x=String(c).length;var m=p<0?x:p;for(P=0;P<l-m;P++)c="0"+c;T==-1&&(c="-"+c)}return l==0&&(c=c.toString().replace(/^0\./,".")),i+l>0&&!a&&Number(c)==0&&(c=0),s&&(c=String(c).replace(".",":")),t.zut(f)?c:null},t.countDecimals=function(e){return t.zimCountDecimalsCheck||(De("13.05"),t.zimCountDecimalsCheck=!0),e%1?e.toString().split(".")[1].length:0},t.sign=function(e){return t.zimSignCheck||(De("13.1"),t.zimSignCheck=!0),e?e<0?-1:1:0},t.constrain=function(e,r,i,l){if(De("13.2"),!n(e)){if(n(r)&&(r=0),n(i)&&(i=Number.MAX_VALUE),i<r){var a=r;i=r,r=a}return n(l)&&(l=!1),l&&e<0?Math.max(-i,Math.min(e,-r)):Math.max(r,Math.min(e,i))}},t.dist=function(e,r,i,l){if(t.zimDistCheck||(De("13.3"),t.zimDistCheck=!0),!(n(e)||n(r)))return!n(e.x)&&!n(r.x)?(l=r.y,i=r.x,r=e.y,e=e.x):(n(i)&&(i=0),n(l)&&(l=0)),Math.sqrt(Math.pow(i-e,2)+Math.pow(l-r,2))},t.rectIntersect=function(e,r,i){return t.zimRectIntersectCheck||(De("13.32"),t.zimRectIntersectCheck=!0),n(i)&&(i=0),!(e.x>=r.x+r.width+i||e.x+e.width+i<=r.x||e.y>=r.y+r.height+i||e.y+e.height+i<=r.y)},t.boundsAroundPoints=function(e){t.zimBoundsAroundPointsCheck||(De("13.34"),t.zimBoundsAroundPointsCheck=!0);for(var r=1e4,i=1e4,l=-1e4,a=-1e4,s=0;s<e.length;s++){var f=e[s];f.x<r&&(r=f.x),f.x>l&&(l=f.x),f.y<i&&(i=f.y),f.y>a&&(a=f.y)}return{x:r,y:i,width:l-r,height:a-i}},t.angle=function(e,r,i,l){if(t.angleCheck||(De("13.4"),t.angleCheck=!0),!(n(e)||n(r)))return n(i)&&(i=e,e=0),n(l)&&(l=r,r=0),(Math.atan2(l-r,i-e)*180/Math.PI+360)%360},t.TAU=Math.PI*2,t.DEG=180/Math.PI,t.RAD=Math.PI/180,t.PHI=Math.pow(5,.5)*.5+.5,t.smoothStep=function(e,r,i){De("13.7");var l=t.constrain((e-r)/(i-r),0,1);return l*l*l*(l*(l*6-15)+10)},t.unicodeToUTF=function(e){if(De("13.75"),!!e){e!=" "&&(e=e.replace(/^\s+/g,""));var r,i="",l="";return r=e.charCodeAt(0),i=r,l=e.charCodeAt(1),l>=56320&&l<=57343&&(r=(i-55296)*1024+(l-56320)+65536),i=i.toString(16),l=l.toString(16),r=r.toString(16),"\\u"+i+"\\u"+l}},t.capitalizeFirst=function(e){return De("13.78"),e.charAt(0).toUpperCase()+e.slice(1)},t.Ajax=function(e,r,i,l){De("13.8");var a=new XMLHttpRequest;this.master=e,this.couple=r,this.lock=i,this.unique=l;var s=this;this.get=function(f,c){var w=n(s.master)?"":"&master="+encodeURI(e),T=n(s.lock)?"":"&lock="+encodeURI(i),p=s.unique?"&unique=true":"";a.open("GET",f+w+T+p,!0),a.onload=function(){a.status==200?c(t.isJSON(a.responseText)?JSON.parse(a.responseText):a.responseText):c(null,"Error: "+a.status)},a.send()},this.post=function(f,c,w,T,p){var x="url, data, command, extra, callback",P;if(P=st(s.post,arguments,x))return P;if(!n(f)){a.open("POST",f,!0),a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.onload=function(){var E=a.responseText;t.isJSON(E)&&(s.couple&&(E=t.decouple(E)),E=JSON.parse(E)),p(E)},t.isJSON(c)||(c=JSON.stringify(c)),s.couple&&(c=t.couple(c));var m=n(s.master)?"":"&master="+encodeURIComponent(s.master),v=n(s.lock)?"":"&lock="+encodeURIComponent(s.lock),I=n(w)?"":"&command="+encodeURIComponent(w),g=n(T)?"":"&extra="+encodeURIComponent(T);a.send("data="+encodeURIComponent(c)+m+v+I+g)}},this.put=function(f,c,w){a.open("PUT",f,!0),a.setRequestHeader("Content-type","application/json"),a.onload=function(){w(t.isJSON(a.responseText)?JSON.parse(a.responseText):s.http.responseText)},a.send(JSON.stringify(c))}},t.Noise=function(e){"use strict";De("13.9"),n(e)&&(e=Math.random()*1e6);var r=e;this.seed=e;var i=this,l={};l.NORM_2D=1/47,l.NORM_3D=1/103,l.NORM_4D=1/30,l.SQUISH_2D=(Math.sqrt(2+1)-1)/2,l.SQUISH_3D=(Math.sqrt(3+1)-1)/3,l.SQUISH_4D=(Math.sqrt(4+1)-1)/4,l.STRETCH_2D=(1/Math.sqrt(2+1)-1)/2,l.STRETCH_3D=(1/Math.sqrt(3+1)-1)/3,l.STRETCH_4D=(1/Math.sqrt(4+1)-1)/4,l.base2D=[[1,1,0,1,0,1,0,0,0],[1,1,0,1,0,1,2,1,1]],l.base3D=[[0,0,0,0,1,1,0,0,1,0,1,0,1,0,0,1],[2,1,1,0,2,1,0,1,2,0,1,1,3,1,1,1],[1,1,0,0,1,0,1,0,1,0,0,1,2,1,1,0,2,1,0,1,2,0,1,1]],l.base4D=[[0,0,0,0,0,1,1,0,0,0,1,0,1,0,0,1,0,0,1,0,1,0,0,0,1],[3,1,1,1,0,3,1,1,0,1,3,1,0,1,1,3,0,1,1,1,4,1,1,1,1],[1,1,0,0,0,1,0,1,0,0,1,0,0,1,0,1,0,0,0,1,2,1,1,0,0,2,1,0,1,0,2,1,0,0,1,2,0,1,1,0,2,0,1,0,1,2,0,0,1,1],[3,1,1,1,0,3,1,1,0,1,3,1,0,1,1,3,0,1,1,1,2,1,1,0,0,2,1,0,1,0,2,1,0,0,1,2,0,1,1,0,2,0,1,0,1,2,0,0,1,1]],l.gradients2D=[5,2,2,5,-5,2,-2,5,5,-2,2,-5,-5,-2,-2,-5],l.gradients3D=[-11,4,4,-4,11,4,-4,4,11,11,4,4,4,11,4,4,4,11,-11,-4,4,-4,-11,4,-4,-4,11,11,-4,4,4,-11,4,4,-4,11,-11,4,-4,-4,11,-4,-4,4,-11,11,4,-4,4,11,-4,4,4,-11,-11,-4,-4,-4,-11,-4,-4,-4,-11,11,-4,-4,4,-11,-4,4,-4,-11],l.gradients4D=[3,1,1,1,1,3,1,1,1,1,3,1,1,1,1,3,-3,1,1,1,-1,3,1,1,-1,1,3,1,-1,1,1,3,3,-1,1,1,1,-3,1,1,1,-1,3,1,1,-1,1,3,-3,-1,1,1,-1,-3,1,1,-1,-1,3,1,-1,-1,1,3,3,1,-1,1,1,3,-1,1,1,1,-3,1,1,1,-1,3,-3,1,-1,1,-1,3,-1,1,-1,1,-3,1,-1,1,-1,3,3,-1,-1,1,1,-3,-1,1,1,-1,-3,1,1,-1,-1,3,-3,-1,-1,1,-1,-3,-1,1,-1,-1,-3,1,-1,-1,-1,3,3,1,1,-1,1,3,1,-1,1,1,3,-1,1,1,1,-3,-3,1,1,-1,-1,3,1,-1,-1,1,3,-1,-1,1,1,-3,3,-1,1,-1,1,-3,1,-1,1,-1,3,-1,1,-1,1,-3,-3,-1,1,-1,-1,-3,1,-1,-1,-1,3,-1,-1,-1,1,-3,3,1,-1,-1,1,3,-1,-1,1,1,-3,-1,1,1,-1,-3,-3,1,-1,-1,-1,3,-1,-1,-1,1,-3,-1,-1,1,-1,-3,3,-1,-1,-1,1,-3,-1,-1,1,-1,-3,-1,1,-1,-1,-3,-3,-1,-1,-1,-1,-3,-1,-1,-1,-1,-3,-1,-1,-1,-1,-3],l.lookupPairs2D=[0,1,1,0,4,1,17,0,20,2,21,2,22,5,23,5,26,4,39,3,42,4,43,3],l.lookupPairs3D=[0,2,1,1,2,2,5,1,6,0,7,0,32,2,34,2,129,1,133,1,160,5,161,5,518,0,519,0,546,4,550,4,645,3,647,3,672,5,673,5,674,4,677,3,678,4,679,3,680,13,681,13,682,12,685,14,686,12,687,14,712,20,714,18,809,21,813,23,840,20,841,21,1198,19,1199,22,1226,18,1230,19,1325,23,1327,22,1352,15,1353,17,1354,15,1357,17,1358,16,1359,16,1360,11,1361,10,1362,11,1365,10,1366,9,1367,9,1392,11,1394,11,1489,10,1493,10,1520,8,1521,8,1878,9,1879,9,1906,7,1910,7,2005,6,2007,6,2032,8,2033,8,2034,7,2037,6,2038,7,2039,6],l.lookupPairs4D=[0,3,1,2,2,3,5,2,6,1,7,1,8,3,9,2,10,3,13,2,16,3,18,3,22,1,23,1,24,3,26,3,33,2,37,2,38,1,39,1,41,2,45,2,54,1,55,1,56,0,57,0,58,0,59,0,60,0,61,0,62,0,63,0,256,3,258,3,264,3,266,3,272,3,274,3,280,3,282,3,2049,2,2053,2,2057,2,2061,2,2081,2,2085,2,2089,2,2093,2,2304,9,2305,9,2312,9,2313,9,16390,1,16391,1,16406,1,16407,1,16422,1,16423,1,16438,1,16439,1,16642,8,16646,8,16658,8,16662,8,18437,6,18439,6,18469,6,18471,6,18688,9,18689,9,18690,8,18693,6,18694,8,18695,6,18696,9,18697,9,18706,8,18710,8,18725,6,18727,6,131128,0,131129,0,131130,0,131131,0,131132,0,131133,0,131134,0,131135,0,131352,7,131354,7,131384,7,131386,7,133161,5,133165,5,133177,5,133181,5,133376,9,133377,9,133384,9,133385,9,133400,7,133402,7,133417,5,133421,5,133432,7,133433,5,133434,7,133437,5,147510,4,147511,4,147518,4,147519,4,147714,8,147718,8,147730,8,147734,8,147736,7,147738,7,147766,4,147767,4,147768,7,147770,7,147774,4,147775,4,149509,6,149511,6,149541,6,149543,6,149545,5,149549,5,149558,4,149559,4,149561,5,149565,5,149566,4,149567,4,149760,9,149761,9,149762,8,149765,6,149766,8,149767,6,149768,9,149769,9,149778,8,149782,8,149784,7,149786,7,149797,6,149799,6,149801,5,149805,5,149814,4,149815,4,149816,7,149817,5,149818,7,149821,5,149822,4,149823,4,149824,37,149825,37,149826,36,149829,34,149830,36,149831,34,149832,37,149833,37,149842,36,149846,36,149848,35,149850,35,149861,34,149863,34,149865,33,149869,33,149878,32,149879,32,149880,35,149881,33,149882,35,149885,33,149886,32,149887,32,150080,49,150082,48,150088,49,150098,48,150104,47,150106,47,151873,46,151877,45,151881,46,151909,45,151913,44,151917,44,152128,49,152129,46,152136,49,152137,46,166214,43,166215,42,166230,43,166247,42,166262,41,166263,41,166466,48,166470,43,166482,48,166486,43,168261,45,168263,42,168293,45,168295,42,168512,31,168513,28,168514,31,168517,28,168518,25,168519,25,280952,40,280953,39,280954,40,280957,39,280958,38,280959,38,281176,47,281178,47,281208,40,281210,40,282985,44,282989,44,283001,39,283005,39,283208,30,283209,27,283224,30,283241,27,283256,22,283257,22,297334,41,297335,41,297342,38,297343,38,297554,29,297558,24,297562,29,297590,24,297594,21,297598,21,299365,26,299367,23,299373,26,299383,23,299389,20,299391,20,299584,31,299585,28,299586,31,299589,28,299590,25,299591,25,299592,30,299593,27,299602,29,299606,24,299608,30,299610,29,299621,26,299623,23,299625,27,299629,26,299638,24,299639,23,299640,22,299641,22,299642,21,299645,20,299646,21,299647,20,299648,61,299649,60,299650,61,299653,60,299654,59,299655,59,299656,58,299657,57,299666,55,299670,54,299672,58,299674,55,299685,52,299687,51,299689,57,299693,52,299702,54,299703,51,299704,56,299705,56,299706,53,299709,50,299710,53,299711,50,299904,61,299906,61,299912,58,299922,55,299928,58,299930,55,301697,60,301701,60,301705,57,301733,52,301737,57,301741,52,301952,79,301953,79,301960,76,301961,76,316038,59,316039,59,316054,54,316071,51,316086,54,316087,51,316290,78,316294,78,316306,73,316310,73,318085,77,318087,77,318117,70,318119,70,318336,79,318337,79,318338,78,318341,77,318342,78,318343,77,430776,56,430777,56,430778,53,430781,50,430782,53,430783,50,431e3,75,431002,72,431032,75,431034,72,432809,74,432813,69,432825,74,432829,69,433032,76,433033,76,433048,75,433065,74,433080,75,433081,74,447158,71,447159,68,447166,71,447167,68,447378,73,447382,73,447386,72,447414,71,447418,72,447422,71,449189,70,449191,70,449197,69,449207,68,449213,69,449215,68,449408,67,449409,67,449410,66,449413,64,449414,66,449415,64,449416,67,449417,67,449426,66,449430,66,449432,65,449434,65,449445,64,449447,64,449449,63,449453,63,449462,62,449463,62,449464,65,449465,63,449466,65,449469,63,449470,62,449471,62,449472,19,449473,19,449474,18,449477,16,449478,18,449479,16,449480,19,449481,19,449490,18,449494,18,449496,17,449498,17,449509,16,449511,16,449513,15,449517,15,449526,14,449527,14,449528,17,449529,15,449530,17,449533,15,449534,14,449535,14,449728,19,449729,19,449730,18,449734,18,449736,19,449737,19,449746,18,449750,18,449752,17,449754,17,449784,17,449786,17,451520,19,451521,19,451525,16,451527,16,451528,19,451529,19,451557,16,451559,16,451561,15,451565,15,451577,15,451581,15,451776,19,451777,19,451784,19,451785,19,465858,18,465861,16,465862,18,465863,16,465874,18,465878,18,465893,16,465895,16,465910,14,465911,14,465918,14,465919,14,466114,18,466118,18,466130,18,466134,18,467909,16,467911,16,467941,16,467943,16,468160,13,468161,13,468162,13,468163,13,468164,13,468165,13,468166,13,468167,13,580568,17,580570,17,580585,15,580589,15,580598,14,580599,14,580600,17,580601,15,580602,17,580605,15,580606,14,580607,14,580824,17,580826,17,580856,17,580858,17,582633,15,582637,15,582649,15,582653,15,582856,12,582857,12,582872,12,582873,12,582888,12,582889,12,582904,12,582905,12,596982,14,596983,14,596990,14,596991,14,597202,11,597206,11,597210,11,597214,11,597234,11,597238,11,597242,11,597246,11,599013,10,599015,10,599021,10,599023,10,599029,10,599031,10,599037,10,599039,10,599232,13,599233,13,599234,13,599235,13,599236,13,599237,13,599238,13,599239,13,599240,12,599241,12,599250,11,599254,11,599256,12,599257,12,599258,11,599262,11,599269,10,599271,10,599272,12,599273,12,599277,10,599279,10,599282,11,599285,10,599286,11,599287,10,599288,12,599289,12,599290,11,599293,10,599294,11,599295,10],l.p2D=[0,0,1,-1,0,0,-1,1,0,2,1,1,1,2,2,0,1,2,0,2,1,0,0,0],l.p3D=[0,0,1,-1,0,0,1,0,-1,0,0,-1,1,0,0,0,1,-1,0,0,-1,0,1,0,0,-1,1,0,2,1,1,0,1,1,1,-1,0,2,1,0,1,1,1,-1,1,0,2,0,1,1,1,-1,1,1,1,3,2,1,0,3,1,2,0,1,3,2,0,1,3,1,0,2,1,3,0,2,1,3,0,1,2,1,1,1,0,0,2,2,0,0,1,1,0,1,0,2,0,2,0,1,1,0,0,1,2,0,0,2,2,0,0,0,0,1,1,-1,1,2,0,0,0,0,1,-1,1,1,2,0,0,0,0,1,1,1,-1,2,3,1,1,1,2,0,0,2,2,3,1,1,1,2,2,0,0,2,3,1,1,1,2,0,2,0,2,1,1,-1,1,2,0,0,2,2,1,1,-1,1,2,2,0,0,2,1,-1,1,1,2,0,0,2,2,1,-1,1,1,2,0,2,0,2,1,1,1,-1,2,2,0,0,2,1,1,1,-1,2,0,2,0],l.p4D=[0,0,1,-1,0,0,0,1,0,-1,0,0,1,0,0,-1,0,0,-1,1,0,0,0,0,1,-1,0,0,0,1,0,-1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,-1,0,0,-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,2,1,1,0,0,1,1,1,-1,0,1,1,1,0,-1,0,2,1,0,1,0,1,1,-1,1,0,1,1,0,1,-1,0,2,0,1,1,0,1,-1,1,1,0,1,0,1,1,-1,0,2,1,0,0,1,1,1,-1,0,1,1,1,0,-1,1,0,2,0,1,0,1,1,-1,1,0,1,1,0,1,-1,1,0,2,0,0,1,1,1,-1,0,1,1,1,0,-1,1,1,1,4,2,1,1,0,4,1,2,1,0,4,1,1,2,0,1,4,2,1,0,1,4,1,2,0,1,4,1,1,0,2,1,4,2,0,1,1,4,1,0,2,1,4,1,0,1,2,1,4,0,2,1,1,4,0,1,2,1,4,0,1,1,2,1,2,1,1,0,0,3,2,1,0,0,3,1,2,0,0,1,2,1,0,1,0,3,2,0,1,0,3,1,0,2,0,1,2,0,1,1,0,3,0,2,1,0,3,0,1,2,0,1,2,1,0,0,1,3,2,0,0,1,3,1,0,0,2,1,2,0,1,0,1,3,0,2,0,1,3,0,1,0,2,1,2,0,0,1,1,3,0,0,2,1,3,0,0,1,2,2,3,1,1,1,0,2,1,1,1,-1,2,2,0,0,0,2,3,1,1,0,1,2,1,1,-1,1,2,2,0,0,0,2,3,1,0,1,1,2,1,-1,1,1,2,2,0,0,0,2,3,1,1,1,0,2,1,1,1,-1,2,0,2,0,0,2,3,1,1,0,1,2,1,1,-1,1,2,0,2,0,0,2,3,0,1,1,1,2,-1,1,1,1,2,0,2,0,0,2,3,1,1,1,0,2,1,1,1,-1,2,0,0,2,0,2,3,1,0,1,1,2,1,-1,1,1,2,0,0,2,0,2,3,0,1,1,1,2,-1,1,1,1,2,0,0,2,0,2,3,1,1,0,1,2,1,1,-1,1,2,0,0,0,2,2,3,1,0,1,1,2,1,-1,1,1,2,0,0,0,2,2,3,0,1,1,1,2,-1,1,1,1,2,0,0,0,2,2,1,1,1,-1,0,1,1,1,0,-1,0,0,0,0,0,2,1,1,-1,1,0,1,1,0,1,-1,0,0,0,0,0,2,1,-1,1,1,0,1,0,1,1,-1,0,0,0,0,0,2,1,1,-1,0,1,1,1,0,-1,1,0,0,0,0,0,2,1,-1,1,0,1,1,0,1,-1,1,0,0,0,0,0,2,1,-1,0,1,1,1,0,-1,1,1,0,0,0,0,0,2,1,1,1,-1,0,1,1,1,0,-1,2,2,0,0,0,2,1,1,-1,1,0,1,1,0,1,-1,2,2,0,0,0,2,1,1,-1,0,1,1,1,0,-1,1,2,2,0,0,0,2,1,1,1,-1,0,1,1,1,0,-1,2,0,2,0,0,2,1,-1,1,1,0,1,0,1,1,-1,2,0,2,0,0,2,1,-1,1,0,1,1,0,1,-1,1,2,0,2,0,0,2,1,1,-1,1,0,1,1,0,1,-1,2,0,0,2,0,2,1,-1,1,1,0,1,0,1,1,-1,2,0,0,2,0,2,1,-1,0,1,1,1,0,-1,1,1,2,0,0,2,0,2,1,1,-1,0,1,1,1,0,-1,1,2,0,0,0,2,2,1,-1,1,0,1,1,0,1,-1,1,2,0,0,0,2,2,1,-1,0,1,1,1,0,-1,1,1,2,0,0,0,2,3,1,1,0,0,0,2,2,0,0,0,2,1,1,1,-1,3,1,0,1,0,0,2,0,2,0,0,2,1,1,1,-1,3,1,0,0,1,0,2,0,0,2,0,2,1,1,1,-1,3,1,1,0,0,0,2,2,0,0,0,2,1,1,-1,1,3,1,0,1,0,0,2,0,2,0,0,2,1,1,-1,1,3,1,0,0,0,1,2,0,0,0,2,2,1,1,-1,1,3,1,1,0,0,0,2,2,0,0,0,2,1,-1,1,1,3,1,0,0,1,0,2,0,0,2,0,2,1,-1,1,1,3,1,0,0,0,1,2,0,0,0,2,2,1,-1,1,1,3,1,0,1,0,0,2,0,2,0,0,2,-1,1,1,1,3,1,0,0,1,0,2,0,0,2,0,2,-1,1,1,1,3,1,0,0,0,1,2,0,0,0,2,2,-1,1,1,1,3,3,2,1,0,0,3,1,2,0,0,4,1,1,1,1,3,3,2,0,1,0,3,1,0,2,0,4,1,1,1,1,3,3,0,2,1,0,3,0,1,2,0,4,1,1,1,1,3,3,2,0,0,1,3,1,0,0,2,4,1,1,1,1,3,3,0,2,0,1,3,0,1,0,2,4,1,1,1,1,3,3,0,0,2,1,3,0,0,1,2,4,1,1,1,1,3,3,2,1,0,0,3,1,2,0,0,2,1,1,1,-1,3,3,2,0,1,0,3,1,0,2,0,2,1,1,1,-1,3,3,0,2,1,0,3,0,1,2,0,2,1,1,1,-1,3,3,2,1,0,0,3,1,2,0,0,2,1,1,-1,1,3,3,2,0,0,1,3,1,0,0,2,2,1,1,-1,1,3,3,0,2,0,1,3,0,1,0,2,2,1,1,-1,1,3,3,2,0,1,0,3,1,0,2,0,2,1,-1,1,1,3,3,2,0,0,1,3,1,0,0,2,2,1,-1,1,1,3,3,0,0,2,1,3,0,0,1,2,2,1,-1,1,1,3,3,0,2,1,0,3,0,1,2,0,2,-1,1,1,1,3,3,0,2,0,1,3,0,1,0,2,2,-1,1,1,1,3,3,0,0,2,1,3,0,0,1,2,2,-1,1,1,1];function a(A){var y=new Uint32Array(1);return y[0]=A[0]*1664525+1013904223,y}function s(A,y,C){this.dx=-y-A*l.SQUISH_2D,this.dy=-C-A*l.SQUISH_2D,this.xsb=y,this.ysb=C}function f(A,y,C,L){this.dx=-y-A*l.SQUISH_3D,this.dy=-C-A*l.SQUISH_3D,this.dz=-L-A*l.SQUISH_3D,this.xsb=y,this.ysb=C,this.zsb=L}function c(A,y,C,L,Y){this.dx=-y-A*l.SQUISH_4D,this.dy=-C-A*l.SQUISH_4D,this.dz=-L-A*l.SQUISH_4D,this.dw=-Y-A*l.SQUISH_4D,this.xsb=y,this.ysb=C,this.zsb=L,this.wsb=Y}var w=[],T,p,x,P,m,v;for(T=0;T<l.p2D.length;T+=4){for(P=l.base2D[l.p2D[T]],m=null,v=null,p=0;p<P.length;p+=3)v=new s(P[p],P[p+1],P[p+2]),m===null?w[T/4]=v:m.next=v,m=v;v.next=new s(l.p2D[T+1],l.p2D[T+2],l.p2D[T+3])}for(this.lookup2D=[],T=0;T<l.lookupPairs2D.length;T+=2)this.lookup2D[l.lookupPairs2D[T]]=w[l.lookupPairs2D[T+1]];var I=[];for(T=0;T<l.p3D.length;T+=9){for(P=l.base3D[l.p3D[T]],m=null,v=null,p=0;p<P.length;p+=4)v=new f(P[p],P[p+1],P[p+2],P[p+3]),m===null?I[T/9]=v:m.next=v,m=v;v.next=new f(l.p3D[T+1],l.p3D[T+2],l.p3D[T+3],l.p3D[T+4]),v.next.next=new f(l.p3D[T+5],l.p3D[T+6],l.p3D[T+7],l.p3D[T+8])}for(this.lookup3D=[],T=0;T<l.lookupPairs3D.length;T+=2)this.lookup3D[l.lookupPairs3D[T]]=I[l.lookupPairs3D[T+1]];var g=[];for(T=0;T<l.p4D.length;T+=16){for(P=l.base4D[l.p4D[T]],m=null,v=null,p=0;p<P.length;p+=5)v=new c(P[p],P[p+1],P[p+2],P[p+3],P[p+4]),m===null?g[T/16]=v:m.next=v,m=v;v.next=new c(l.p4D[T+1],l.p4D[T+2],l.p4D[T+3],l.p4D[T+4],l.p4D[T+5]),v.next.next=new c(l.p4D[T+6],l.p4D[T+7],l.p4D[T+8],l.p4D[T+9],l.p4D[T+10]),v.next.next.next=new c(l.p4D[T+11],l.p4D[T+12],l.p4D[T+13],l.p4D[T+14],l.p4D[T+15])}for(this.lookup4D=[],T=0;T<l.lookupPairs4D.length;T+=2)this.lookup4D[l.lookupPairs4D[T]]=g[l.lookupPairs4D[T+1]];this.perm=new Uint8Array(256),this.perm2D=new Uint8Array(256),this.perm3D=new Uint8Array(256),this.perm4D=new Uint8Array(256);var E=new Uint8Array(256);for(T=0;T<256;T++)E[T]=T;for(e=new Uint32Array(1),e[0]=r,e=a(a(a(e))),T=255;T>=0;T--)e=a(e),x=new Uint32Array(1),x[0]=(e[0]+31)%(T+1),x[0]<0&&(x[0]+=T+1),this.perm[T]=E[x[0]],this.perm2D[T]=this.perm[T]&14,this.perm3D[T]=this.perm[T]%24*3,this.perm4D[T]=this.perm[T]&252,E[x[0]]=E[T];this.simplex1D=function(A){return i.simplex2D(A,1)},this.simplex2D=function(A,y){var C=(A+y)*l.STRETCH_2D,L=[A+C,y+C],Y=L[0],_=L[1],k=[Math.floor(Y),Math.floor(_)],$=k[0],O=k[1],X=($+O)*l.SQUISH_2D,R=[A-($+X),y-(O+X)],Q=R[0],K=R[1],q=[Y-$,_-O],ne=q[0],U=q[1],D=ne+U,d=new Uint32Array(4);d[0]=ne-U+1,d[1]=D,d[2]=D+U,d[3]=D+ne;for(var u=d[0]|d[1]<<1|d[2]<<2|d[3]<<4,o=i.lookup2D[u],S=0;typeof o<"u";){var F=[Q+o.dx,K+o.dy],h=F[0],b=F[1],ye=2-h*h-b*b;if(ye>0){var B=[$+o.xsb,O+o.ysb],N=B[0],re=B[1],le=i.perm2D[i.perm[N&255]+re&255],G=l.gradients2D[le]*h+l.gradients2D[le+1]*b;ye*=ye,S+=ye*ye*G}o=o.next}return S*l.NORM_2D},this.simplex3D=function(A,y,C){var L=(A+y+C)*l.STRETCH_3D,Y=[A+L,y+L,C+L],_=Y[0],k=Y[1],$=Y[2],O=[Math.floor(_),Math.floor(k),Math.floor($)],X=O[0],R=O[1],Q=O[2],K=(X+R+Q)*l.SQUISH_3D,q=[A-(X+K),y-(R+K),C-(Q+K)],ne=q[0],U=q[1],D=q[2],d=[_-X,k-R,$-Q],u=d[0],o=d[1],S=d[2],F=u+o+S,h=new Uint32Array(7);h[0]=o-S+1,h[1]=u-o+1,h[2]=u-S+1,h[3]=F,h[4]=F+S,h[5]=F+o,h[6]=F+u;for(var b=h[0]|h[1]<<1|h[2]<<2|h[3]<<3|h[4]<<5|h[5]<<7|h[6]<<9,ye=i.lookup3D[b],B=0;typeof ye<"u";){var N=[ne+ye.dx,U+ye.dy,D+ye.dz],re=N[0],le=N[1],G=N[2],z=2-re*re-le*le-G*G;if(z>0){var se=[X+ye.xsb,R+ye.ysb,Q+ye.zsb],Oe=se[0],J=se[1],pe=se[2],Z=i.perm3D[i.perm[i.perm[Oe&255]+J&255]+pe&255],de=l.gradients3D[Z]*re+l.gradients3D[Z+1]*le+l.gradients3D[Z+2]*G;z*=z,B+=z*z*de}ye=ye.next}return B*l.NORM_3D},this.simplex4D=function(A,y,C,L){var Y=(A+y+C+L)*l.STRETCH_4D,_=[A+Y,y+Y,C+Y,L+Y],k=_[0],$=_[1],O=_[2],X=_[3],R=[Math.floor(k),Math.floor($),Math.floor(O),Math.floor(X)],Q=R[0],K=R[1],q=R[2],ne=R[3],U=(Q+K+q+ne)*l.SQUISH_4D,D=A-(Q+U),d=y-(K+U),u=C-(q+U),o=L-(ne+U),S=[k-Q,$-K,O-q,X-ne],F=S[0],h=S[1],b=S[2],ye=S[3],B=F+h+b+ye,N=new Uint32Array(11);N[0]=b-ye+1,N[1]=h-b+1,N[2]=h-ye+1,N[3]=F-h+1,N[4]=F-b+1,N[5]=F-ye+1,N[6]=B<<6,N[7]=B+ye,N[8]=B+b,N[9]=B+h,N[10]=B+F;for(var re=N[0]|N[1]<<1|N[2]<<2|N[3]<<3|N[4]<<4|N[5]<<5|N[6]<<6|N[7]<<8|N[8]<<11|N[9]<<14|N[10]<<17,le=i.lookup4D[re],G=0;typeof le<"u";){var z=[D+le.dx,d+le.dy,u+le.dz,o+le.dw],se=z[0],Oe=z[1],J=z[2],pe=z[3],Z=2-se*se-Oe*Oe-J*J-pe*pe;if(Z>0){var de=[Q+le.xsb,K+le.ysb,q+le.zsb,ne+le.wsb],V=de[0],fe=de[1],ke=de[2],oe=de[3],Ce=i.perm4D[i.perm[i.perm[i.perm[V&255]+fe&255]+ke&255]+oe&255],Me=l.gradients4D[Ce]*se+l.gradients4D[Ce+1]*Oe+l.gradients4D[Ce+2]*J+l.gradients4D[Ce+3]*pe;Z*=Z,G+=Z*Z*Me}le=le.next}return G*l.NORM_4D}},typeof Ne<"u"&&(t.Point=function(e,r,i,l,a,s,f,c,w,T){De("13.45"),n(e)&&(e=0),n(r)&&(r=0),n(i)&&(i=0),n(l)&&(l=0),n(a)&&(a=0),n(s)&&(s=0),n(f)&&(f=0),n(c)&&(c=0),n(w)&&(w=0),n(T)&&(T=0),this.createjsPoint_constructor(e,r),this.type="Point",this.x=e,this.y=r,this.z=i,this.q=l,this.r=a,this.s=s,this.t=f,this.u=c,this.v=w,this.w=T,this.angle=function(p){return this.createjsPoint_angle(p)*180/Math.PI},this.project=function(p,x){return this.createjsPoint_project(p*Math.PI/180,x)}},t.extend(t.Point,Ne.Point,["angle","project"],"createjsPoint")),t.Bezier=function(r,i,l,a){De("13.47"),this.a=r,this.b=i,this.c=l,this.d=a,this.len=100,this.arcLengths=new Array(this.len+1),this.arcLengths[0]=0;for(var s=this.x(0),f=this.y(0),c=0,w=1;w<=this.len;w+=1){var T=this.x(w*.01),p=this.y(w*.01),x=s-T,P=f-p;c+=Math.sqrt(x*x+P*P),this.arcLengths[w]=c,s=T,f=p}this.length=c},t.Bezier.prototype={map:function(e){for(var r=e*this.arcLengths[this.len],i=0,l=this.len,a=0;i<l;)a=i+((l-i)/2|0),this.arcLengths[a]<r?i=a+1:l=a;this.arcLengths[a]>r&&a--;var s=this.arcLengths[a];return s===r?a/this.len:(a+(r-s)/(this.arcLengths[a+1]-s))/this.len},mx:function(e){return this.x(this.map(e))},my:function(e){return this.y(this.map(e))},x:function(e){return(1-e)*(1-e)*(1-e)*this.a.x+3*((1-e)*(1-e))*e*this.b.x+3*(1-e)*(e*e)*this.c.x+e*e*e*this.d.x},y:function(e){return(1-e)*(1-e)*(1-e)*this.a.y+3*((1-e)*(1-e))*e*this.b.y+3*(1-e)*(e*e)*this.c.y+e*e*e*this.d.y}},t.Boundary=function(e,r,i,l){De("13.46"),e.x&&(l=e.height,i=e.width,r=e.y,e=e.x),!(n(e)||n(r)||n(i)||n(l))&&(this.x=e,this.y=r,this.width=i,this.height=l,this.contract=function(a,s,f,c){return n(a)?this:(n(s)&&(s=a),n(f)?f=a*2:f=f+a,n(c)?c=s*2:c=c+s,this.x+=a,this.y+=s,this.width-=f,this.height-=c,this)})},t.GradientColor=function(e,r,i,l,a,s){if(De("13.465"),this.type="GradientColor",this.colors=n(e)?["black","white"]:e,Array.isArray(this.colors)||(this.colors=[this.colors,this.colors]),this.colors.length==1&&this.colors.push(this.colors[0]),this.ratios=n(r)?0:r,!Array.isArray(this.ratios)){this.angle=this.ratios,this.ratios=[];for(var f=0;f<this.colors.length;f++)this.ratios.push(f/(this.colors.length-1))}!n(i)&&(n(l)||n(a)||n(s))?(this.angle=i,i=null):n(this.angle)&&n(i)&&n(l)&&n(a)&&n(s)?this.angle=0:(this.x0=n(i)?0:i,this.y0=n(l)?0:l,this.x1=n(a)?0:a,this.y1=n(s)?100:s)},t.RadialColor=function(e,r,i,l,a,s,f,c){if(De("13.466"),this.type="RadialColor",this.colors=n(e)?["black","white"]:e,Array.isArray(this.colors)||(this.colors=[this.colors,this.colors]),this.colors.length==1&&this.colors.push(this.colors[0]),this.ratios=r,!Array.isArray(this.ratios)){this.ratios=[];for(var w=0;w<this.colors.length;w++)this.ratios.push(w/(this.colors.length-1))}this.x0=i,this.y0=l,this.r0=a,this.x1=s,this.y1=f,this.r1=c},t.BitmapColor=function(e,r,i){De("13.467"),this.type="BitmapColor",typeof e=="string"&&j.asset&&(e=j.asset(e)),e.type!="Bitmap"&&e.bitmap&&(e=e.bitmap),this.image=e.type=="Bitmap"?e.image:e,this.repetition=r,this.matrix=i},t.Damp=function(e,r){De("14");var i="startValue, damp",l;if(l=st(t.Damp,arguments,i,this))return l;this.lastValue=n(e)?0:e,this.damp=n(r)?.1:r},t.Damp.prototype.convert=function(e){return this.lastValue=this.lastValue+(e-this.lastValue)*this.damp},t.Damp.prototype.immediate=function(e){return this.lastValue=e,this},t.Proportion=function(e,r,i,l,a,s,f){var c="baseMin, baseMax, targetMin, targetMax, factor, targetRound, clamp",w;if(w=st(t.Proportion,arguments,c,this))return w;De("15"),n(i)&&(i=0),n(l)&&(l=1),n(a)&&(a=1),n(s)&&(s=!1),n(f)&&(f=!0);var T,p;this.convert=function(x){if(n(x)&&(x=e),!(isNaN(x)||r-e==0))return f&&(x=Math.max(x,e),x=Math.min(x,r)),T=(x-e)/(r-e),a>0?p=i+(l-i)*T:p=l-(l-i)*T,s&&(p=Math.round(p)),p}},t.ProportionDamp=function(e,r,i,l,a,s,f,c){var w="baseMin, baseMax, targetMin, targetMax, damp, factor, targetRound, clamp",T;if(T=st(t.ProportionDamp,arguments,w,this))return T;De("16"),n(i)&&(i=0),n(l)&&(l=1),n(a)&&(a=.1),n(s)&&(s=1),n(f)&&(f=!1),n(c)&&(c=!0),this.damp=a;var p=this,x,P,m,v,I,g=0,E=0;x=e,E=i;var A=setInterval(y,20);function y(){isNaN(x)||r-e==0||(c&&(x=Math.max(x,e),x=Math.min(x,r)),P=(x-e)/(r-e),m=l-i,s>0?v=i+m*P:v=l-m*P,g=v,I=g-E,E+=I*p.damp)}this.immediate=function(C){return p.convert(C),y(),E=v,f&&(E=Math.round(E)),p},this.immediateValue=function(C){return g=E=C,p},this.convert=function(C){return x=C,f?Math.round(E):E},this.dispose=function(){return clearInterval(A),!0}},t.Dictionary=function(e){De("17"),this.length=0,this.unique=e;var r=this.objects=[],i=this.values=[];this.type="Dictionary",this.add=function(l,a){n(l)||(n(a)&&(a=!0),this.unique&&this.remove(l),r.push(l),i.push(a),this.length++)},this.at=function(l){if(!n(l)){var a=r.indexOf(l);return a>-1?i[a]:null}},this.remove=function(l){if(n(l))return!1;var a=r.indexOf(l);return a>-1?(r.splice(a,1),i.splice(a,1),this.length--,!0):!1},this.clear=function(){return r=this.objects=[],i=this.values=[],this.length=null,this},this.dispose=function(){return r=null,i=null,this.length=null,!0}},t.Hierarchy=function(e,r){De("17.5");var i=this;if(n(e))return;n(r)&&(r=!1);var l;i.processSimple=function(c){var w=0,T={};function p(x,P,m,v){if(n(x)||(c=x),c.constructor=={}.constructor){var I;c.list&&(I=c,c=c.list),v&&I&&t.loop(I,function(g,E){g!="list"&&(v[g]=E)}),t.loop(c,function(g,E){var A={},y=P["id"+w]={obj:g,level:m,open:r,opened:!1,list:A};w++,p(E,A,m+1,y)})}else Array.isArray(c)&&t.loop(c,function(g){P["id"+w]={obj:g},w++})}return p(e,T,0),l=w,T},i.processComplex=function(c){var w=0;function T(p,x){t.loop(p,function(P,m){m.level=x,n(m.open)&&(m.open=r),n(m.opened)&&(m.opened=!1),m.list&&T(m.list,x+1),w++})}return T(c,0),l=w,c},n(e.id0)?i.data=i.processSimple(e):i.data=i.processComplex(e),i.getLinearList=function(c){return n(c)&&(c=i.data),a(c)[0]},i.getLinearIDs=function(c){return n(c)&&(c=i.data),a(c)[1]};function a(c){var w=[],T=[];function p(x,P){t.loop(x,function(m,v){w.push(v.obj),T.push(m),v.open&&p(v.list,P+1)})}return p(c,0),[w,T]}i.getData=function(c){var w;function T(p){t.loop(p,function(x,P){if(x==c)return w=P,w;T(P.list)})}return T(i.data),w},i.getNextSibling=function(c){var w,T;function p(x){t.loop(x,function(P,m){if(!T&&w)return T=P,T;P==c?w=m:p(m.list)})}return p(i.data),T},i.getPrevSibling=function(c){var w=[],T;function p(x,P){t.loop(x,function(m,v){if(m==c)return T=w[P]||w[P-1],T;w[P]=m,p(v.list,P+1)})}return p(i.data,0),T},i.insertBefore=function(c,w,T){return s("insertBefore",c,w,T)},i.insertAfter=function(c,w,T){return s("insertAfter",c,w,T)},i.removeItem=function(c){return s("removeItem",null,c)},i.replaceItem=function(c,w){var T=i.getData(w);return T.obj=c,s("replaceItem")};function s(c,w,T,p){var x=0,P={},m=i.data;function v(I,g,E,A){t.loop(I,function(y,C){if(!(c=="removeItem"&&y==T)){var L,Y,_;c=="insertBefore"&&y==T&&(x=f(g,x,E,w,p)),L={},Y=C.list,C.list=L,C.opened=!1,C.open=!1,_=g["id"+x]=C,_.obj.type&&_.obj.type=="TabsButton"&&(_.obj=_.obj.text),x++,v(Y,L,E+1),c=="insertAfter"&&y==T&&(x=f(g,x,E,w,p))}})}return v(m,P,0),l=x,P}function f(c,w,T,p,x){if(x){var P={};Array.isArray(p)&&(p=p[0]),c["id"+w]={obj:p,level:T,open:!1,opened:!1,list:P},w++,Array.isArray(x)||(x=[x]),t.loop(x,function(m){P["id"+w]={obj:m,level:T+1,open:!1,opened:!1,list:{}},w++})}else Array.isArray(p)||(p=[p]),t.loop(p,function(m){c["id"+w]={obj:m,level:T,open:!1,opened:!1,list:{}},w++});return w}i.getParent=function(c){var w=i.data;function T(p,x){var P=t.loop(p,function(m,v){if(m==c)return l-=1,x;if(v.list&&!t.isEmpty(v.list))return T(v.list,m)});if(P!==!0)return P}return T(w)},Object.defineProperty(i,"length",{get:function(){return l},set:function(){dt&&tt("Hierarchy() - length is read only")}})},t.Pick=function(e){t.pickCheck||(De("17.6"),t.pickCheck=!0),this.choices=e,this.num=function(i){for(var l=[],a=0;a<i;a++)l.push(t.Pick.choose(this));return this.choices=t.Pick.series(l),this};var r=this;this.loop=function(i,l){for(var a,s=0;s<i;s++)if(a=l(t.Pick.choose(r),s,i),typeof a<"u")return a}},t.Pick.prototype.type="Pick",t.Pick.series=function(){return t.pickCheck||(De("17.6"),t.pickCheck=!0),t.series.apply(null,arguments)},t.Pick.rand=function(e,r,i,l){return t.pickCheck||(De("17.6"),t.pickCheck=!0),t.rand(e,r,i,l)},t.Pick.choose=function(e,r,i){if(t.pickCheck||(De("17.6"),t.pickCheck=!0),r==null&&(r=!0),e==null)return e;if(e.type=="Pick"||r){var l=e.choices||e,a;return Array.isArray(l)?(a=l[Math.floor(Math.random()*l.length)],t.Pick.choose(a)):l.constructor==={}.constructor?n(l.noPick)?n(l.max)?l:(n(l.integer)&&(l.integer=!1),a=t.Pick.rand(l.min,l.max,l.integer,l.negative),a):l.noPick:l instanceof Function?(l.count==null?l.count=0:l.count++,t.Pick.choose(l(i,!0))):e}else return e},t.Pick.getMinMax=function(e){return!n(e.min)&&!n(e.max)?e:Array.isArray(e)?t.arrayMinMax(e):e.type=="series"?t.arrayMinMax(e.array):{min:null,max:null}},t.scrollX=function(e,r){return De("18"),t.abstractScroll("X","Left",e,r)},t.scrollY=function(e,r){return De("19"),t.abstractScroll("Y","Top",e,r)},t.abstractScroll=function(e,r,i,l){De("20");var a=wt(l),s=e=="X"?"Y":"X";if(n(i))return document.documentElement&&document.documentElement["scroll"+r]||document.body["scroll"+r];if(n(l))j.scrollTo(t["scroll"+s](),i);else{var f=50,c=l*(a=="s"?1e3:1);c<f&&(c=f);var w=c/f,T=t["scroll"+e](),p=i-T,x=p/w,P=0,m=setInterval(function(){P++,T+=x,j.scrollTo(t["scroll"+s](),T),P>=w&&(j.scrollTo(t["scroll"+s](),i),clearInterval(m))},f)}return i},t.windowWidth=function(){De("21");var e=isNaN(j.innerWidth)?j.clientWidth:j.innerWidth,r=isNaN(j.innerHeight)?j.clientHeight:j.innerHeight;if(t.mobile()&&!n(j.orientation)&&!j.parent&&(e>r&&Math.abs(j.orientation)!=90||r>e&&Math.abs(j.orientation)==90)){var i=e;e=r,r=i}return j.zdf&&j.zdf.swapRotation?r:e},t.windowHeight=function(){De("22");var e=isNaN(j.innerWidth)?j.clientWidth:j.innerWidth,r=isNaN(j.innerHeight)?j.clientHeight:j.innerHeight;if(t.mobile()&&!n(j.orientation)&&!j.parent&&(e>r&&Math.abs(j.orientation)!=90||r>e&&Math.abs(j.orientation)==90)){var i=e;e=r,r=i}return j.zdf&&j.zdf.swapRotation?e:r},t.browserZoom=function(){if(t.zimBZ)return n(t.zimBZA)?t.decimals((j.devicePixelRatio||1)/t.zimBZ1,2):t.zimBZA;if(De("22.2"),t.zimBZ=!0,typeof e>"u")if(j.zdf)var e=j.zdf;else return t.zimBZA=1,1;if(e.retina)t.zimBZ1=j.devicePixelRatio||1;else return t.zimBZA=1,1},t.getQueryString=function(e){if(De("22.5"),n(e)&&(e=location.search.replace("?","")),e=="")return{};for(var r=e.split("&"),i={},l=0;l<r.length;l++){var a=r[l].split("=");typeof i[a[0]]>"u"?i[a[0]]=decodeURIComponent((a[1]+"").replace(/\+/g,"%20")):typeof i[a[0]]=="string"?i[a[0]]=[i[a[0]],decodeURIComponent((a[1]+"").replace(/\+/g,"%20"))]:i[a[0]].push(decodeURIComponent((a[1]+"").replace(/\+/g,"%20")))}return i},t.swapHTML=function(e,r){return De("17.2"),t.swapProperties("innerHTML",wn(e),wn(r))},t.urlEncode=function(e){return De("23"),e=(e+"").toString(),encodeURIComponent(e).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A").replace(/%20/g,"+")},t.urlDecode=function(e){return De("24"),decodeURIComponent((e+"").replace(/\+/g,"%20"))},t.setCookie=function(e,r,i){if(De("25"),!(n(e)||n(r))){var l;if(i){var a=new Date;a.setTime(a.getTime()+i*24*60*60*1e3),l="; expires="+a.toGMTString()}else l="";return document.cookie=e+"="+escape(r)+l+"; path=/",!0}},t.getCookie=function(e){De("26");for(var r=document.cookie.split(/;\s*/),i=new Array,l,a=0;a<r.length;a++)l=r[a].split("="),i[l[0]]=l[1];if(!(typeof i[e]>"u"))return unescape(i[e])},t.deleteCookie=function(e){return De("27"),n(t.getCookie(e))?!1:(t.setCookie(e,"",-1),!0)},Ne==null)return dt&&ni("ZIM >= 4.3.0 requires createjs namespace to be loaded (import createjs before zim)"),t;t.localToGlobal=function(r,i,l,a){if(t.coordinatesCheck||(De("50.43"),t.coordinatesCheck=!0),!(r==null||i==null)){var s=a.call(l,r,i),f=l.stage;if(!j.zdf){if(!f)return s;j.zdf={stage:f,canvas:f.canvas}}return s.x/=t.scaX,s.y/=t.scaY,s}},t.globalToLocal=function(r,i,l,a){if(t.coordinatesCheck||(De("50.43"),t.coordinatesCheck=!0),!(r==null||i==null)){var s=l.stage;if(!j.zdf){if(!s)return a.call(l,r,i);j.zdf={stage:s,canvas:s.canvas}}r*=t.scaX,i*=t.scaY;var f=a.call(l,r,i);return f}},t.localToLocal=function(r,i,l,a){if(t.coordinatesCheck||(De("50.43"),t.coordinatesCheck=!0),!(r==null||i==null||l==null)){var s=a.localToGlobal(r,i),f=a.stage;if(!j.zdf){if(!f)return l.globalToLocal(s.x,s.y);j.zdf={stage:f,canvas:f.canvas}}if(f||(f=j.zdf.stage),l==f)return s;if(s)return l.globalToLocal(s.x,s.y)}},t.displayBase=function(e){t.zimDBCheck||(De("50.432"),t.zimDBCheck=!0);var r=e;if(Object.defineProperty(e,"width",{enumerable:!0,get:function(){var c=this.getBounds();return n(c)?null:Math.abs(c.width*this.scaleX)},set:function(c){if(e.scaleDimensions!==!1){var w=this.getBounds();if(n(w)||w.width==0){dt&&tt("DisplayObject() - width needs bounds set with setBounds()");return}var T=c/w.width;this.scaleX=this.scaleY=T}else{var p=e.width!=0?e.height/e.width:0;e.setWidth(c),e.setHeight(c*p),e.drawShape()}}}),Object.defineProperty(e,"height",{enumerable:!0,get:function(){var c=this.getBounds();return n(c)?null:Math.abs(c.height*this.scaleY)},set:function(c){if(e.scaleDimensions!==!1){var w=this.getBounds();if(n(w)||w.height==0){dt&&tt("DisplayObject() - height needs bounds set with setBounds()");return}var T=c/w.height;this.scaleX=this.scaleY=T}else{var p=e.height!=0?e.width/e.height:0;e.setHeight(c),e.setWidth(c*p),e.drawShape()}}}),Object.defineProperty(e,"widthOnly",{enumerable:!0,get:function(){var c=this.getBounds();return n(c)?null:Math.abs(c.width*this.scaleX)},set:function(c){if(e.scaleDimensions!==!1){var w=this.getBounds();if((n(w)||w.width==0)&&dt){tt("DisplayObject() - widthOnly needs bounds set with setBounds()");return}var T=c/w.width;this.scaleX=T}else e.setWidth(c),e.drawShape()}}),Object.defineProperty(e,"heightOnly",{enumerable:!0,get:function(){var c=this.getBounds();return n(c)?null:Math.abs(c.height*this.scaleY)},set:function(c){if(e.scaleDimensions!==!1){var w=this.getBounds();if((n(w)||w.height==0)&&dt){tt("DisplayObject() - heightOnly needs bounds set with setBounds()");return}var T=c/w.height;this.scaleY=T}else e.setHeight(c),e.drawShape()}}),Object.defineProperty(e,"level",{enumerable:!0,get:function(){return this.parent?this.parent.getChildIndex(this):null},set:function(c){this.parent&&this.parent.setChildIndex(this,Math.max(0,Math.min(c,this.parent.numChildren-1)))}}),Object.defineProperty(e,"depth",{enumerable:!0,get:function(){return this._depth},set:function(c){if(this._depth=c,!n(this.vrChannel)){var w=this.vrParallaxDistance?c*this.vrParallax*this.vrParallaxDistance:0;this.vrChannel=="left"?this.x=this.vrStartX+c+w:this.vrChannel=="right"&&(this.x=this.vrStartX-c+w)}}}),Object.defineProperty(e,"blendMode",{enumerable:!0,get:function(){return this.compositeOperation},set:function(c){this.compositeOperation=c}}),!r.name){var i;Object.defineProperty(r,"name",{get:function(){return i},set:function(c){i=c,t.zimObjectIDs[c]=r}})}r._draggable,Object.defineProperty(r,"draggable",{get:function(){return this._draggable},set:function(c){c!=this._draggable&&(this._draggable=c,this._draggable?this.drag():this.noDrag())}});var l,a;r.on("mousedown",function(c){c.target.stage&&(l=c.target.stage.frame,l.allowDefault&&(a=!0,l.allowDefault=!1))}),r.on("pressup",function(){l&&a&&(l.allowDefault=!0)});for(var s=["hue","saturation","brightness","contrast"],f=0;f<s.length;f++)-function(){for(var c=s[f],w=0;w<2;w++)-function(){var T=w==0?"":"Batch";Object.defineProperty(r,c+T,{get:function(){return r.effects&&r.effects.multi?r.effects.multi[c]:0},set:function(p){!r.effects||!r.effects.multi?r.effect(new t.MultiEffect(c=="hue"?p:0,c=="saturation"?p:0,c=="brightness"?p:0,c=="contrast"?p:0)):r.effects.multi[c]=p,T==""&&r.updateEffects()}})}()}()},t.gD=function(e){if(t.zimGDCheck||(De("50.435"),t.zimGDCheck=!0),!!e){if(e.z_bc){var r=e.z_bc;r.width=r.height=1,r.getContext&&r.getContext("2d").clearRect(0,0,1,1),delete e.z_bc}t.KEYFOCUS==e&&(t.KEYFOCUS=null),j.KEYFOCUS==e&&(j.KEYFOCUS=null),e.veeObj&&(e.veeObj=null),e.draggable&&e.noDrag(),e.zimTweens&&e.stopAnimate(),e.zimWire&&e.noWire(),e.zimWired&&e.noWired(),e.zimClickHoldDownEvent&&e.noHold(),e.transformControls&&e.transformControls.dispose(),e.zimClickDownEvent&&(e.zimClickDownEvent=null),e.zimClickUpEvent&&(e.zimClickUpEvent=null),e.physics&&e.removePhysics(),e.name&&t.zimObjectIDs[e.name]==e&&delete t.zimObjectIDs[e.name]}},t.Stage=function(e,r,i){if(De("50.44"),!n(e)){var l=e.tagName=="CANVAS"?e:wn(e);n(l)||(this.cjsStage_constructor(e),this.setBounds(0,0,l.width,l.height),this.type="Stage",j.zdf||(j.zimDefaultFrame=j.zdf={stage:this}),i?Ne.Touch.enable(this,!0):r&&Ne.Touch.enable(this,!1),this.cache=function(a,s,f,c,w,T){if(n(f))if(n(a)){var p=this.getBounds();if(!n(p)){var x=this.borderWidth>0?this.borderWidth/2:0;a=p.x-x,s=p.y-x,f=p.width+x*2,c=p.height+x*2}}else f=a,c=s,a=0,s=0;return this.cjsStage_cache(a,s,f,c,w,T),this.z_bc=this.cacheCanvas,this},this.on("mousedown",function(a){var s=a.clone();s.type="pressdown",a.target.dispatchEvent(s)},void 0,!1,void 0,!0),this.loop=function(a,s,f,c,w,T){return t.loop(this,a,s,f,c,w,T)},this.hitTestGrid=function(a,s,f,c,w,T,p,x,P,m,v,I){return t.hitTestGrid(this,a,s,f,c,w,T,p,x,P,m,v,I)},this.disposeAllChildren=function(){for(var a=this.numChildren-1;a>=0;a--){var s=this.getChildAt(a);s.dispose&&s.dispose()}return this},this.frame=j.zdf,Ne&&!Ne.stageTransformable&&(j.zdf.retina||typeof exportRoot<"u")&&(Object.defineProperty(this,"scale",{get:function(){return this.cjsStage_scale},set:function(a){this.cjsStage_scaleX=a,this.cjsStage_scaleY=a,t.scaX=Ne.stageTransformable?1:a,t.scaY=Ne.stageTransformable?1:a}}),Object.defineProperty(this,"scaleX",{get:function(){return this.cjsStage_scaleX},set:function(a){this.cjsStage_scaleX=a,t.scaX=Ne.stageTransformable?1:a}}),Object.defineProperty(this,"scaleY",{get:function(){return this.cjsStage_scaleY},set:function(a){this.cjsStage_scaleY=a,t.scaY=Ne.stageTransformable?1:a}}),this.localToGlobal=function(a,s){return t.localToGlobal(a,s,this,this.cjsStage_localToGlobal)},this.globalToLocal=function(a,s){return t.globalToLocal(a,s,this,this.cjsStage_globalToLocal)},this.localToLocal=function(a,s,f){return t.localToLocal(a,s,f,this)}))}},t.extend(t.Stage,Ne.Stage,["cache","localToLocal","localToGlobal","globalToLocal"],"cjsStage",!1),t.StageGL=function(e,r,i,l){if(De("50.45"),!n(e)){var a=e.tagName=="CANVAS"?e:wn(e);n(a)||(this.cjsStageGL_constructor(e,r),this.setBounds(0,0,a.width,a.height),this.type="StageGL",j.zdf||(j.zdf={stage:this}),l?Ne.Touch.enable(this,!0):i&&Ne.Touch.enable(this,!1),this.cache=function(s,f,c,w,T,p){if(n(c))if(n(s)){var x=this.getBounds();if(!n(x)){var P=this.borderWidth>0?this.borderWidth/2:0;s=x.x-P,f=x.y-P,c=x.width+P*2,w=x.height+P*2}}else c=s,w=f,s=0,f=0;return this.cjsStageGL_cache(s,f,c,w,T,p),this.z_bc=this.cacheCanvas,this},this.on("mousedown",function(s){var f=s.clone();f.type="pressdown",s.target.dispatchEvent(f)},void 0,!1,void 0,!0),this.loop=function(s,f,c,w,T,p){return t.loop(this,s,f,c,w,T,p)},this.hitTestGrid=function(s,f,c,w,T,p,x,P,m,v,I,g){return t.hitTestGrid(this,s,f,c,w,T,p,x,P,m,v,I,g)},this.disposeAllChildren=function(){for(var s=this.numChildren-1;s>=0;s--){var f=this.getChildAt(s);f.dispose&&f.dispose()}return this},this.frame=j.zdf,Ne&&!Ne.stageTransformable&&(j.zdf.retina||typeof exportRoot<"u")&&(Object.defineProperty(this,"scale",{get:function(){return this.cjsStage_scale},set:function(s){this.cjsStage_scaleX=s,this.cjsStage_scaleY=s,t.scaX=Ne.stageTransformable?1:s,t.scaY=Ne.stageTransformable?1:s}}),Object.defineProperty(this,"scaleX",{get:function(){return this.cjsStage_scaleX},set:function(s){this.cjsStage_scaleX=s,t.scaX=Ne.stageTransformable?1:s}}),Object.defineProperty(this,"scaleY",{get:function(){return this.cjsStage_scaleY},set:function(s){this.cjsStage_scaleY=s,t.scaY=Ne.stageTransformable?1:s}}),this.localToGlobal=function(s,f){return t.localToGlobal(s,f,this,this.cjsStageGL_localToGlobal)},this.globalToLocal=function(s,f){return t.globalToLocal(s,f,this,this.cjsStageGL_globalToLocal)},this.localToLocal=function(s,f,c){return t.localToLocal(s,f,c,this)}))}},t.extend(t.StageGL,Ne.StageGL,["cache","localToLocal","localToGlobal","globalToLocal"],"cjsStageGL",!1),t.Container=function(e,r,i,l,a,s,f){var c="a, b, c, d, style, group, inherit",w;if(w=st(t.Container,arguments,c,this))return w;t.containerCheck||(De("50.5"),De("50.435"),t.containerCheck=!0),this.cjsContainer_constructor(),this.type="Container",this.group=s;var T=this,p=a===!1?{}:t.getStyle(this.type,this.group,f);n(e)&&(e=p.a!=null?p.a:null),n(r)&&(r=p.b!=null?p.b:null),n(i)&&(i=p.c!=null?p.c:null),n(l)&&(l=p.d!=null?p.d:null);var x=P(e,r,i,l);function P(v,I,g,E){var A=[];return n(v)?A=[v,I,g,E]:n(I)?v.x?A=[v.x,v.y,v.width,v.height]:(A[0]=0,A[1]=0,A[2]=v,A[3]=v):n(g)?(A[0]=0,A[1]=0,A[2]=v,A[3]=I):(A[0]=v,A[1]=I,A[2]=g,A[3]=E),n(A[3])&&(A[3]=A[2]),A}n(e)||this.setBounds(x[0],x[1],x[2],x[3]),this.cache=function(v,I,g,E,A,y,C,L,Y){if(T.type=="AC"&&j.zdf)return j.zdf.ac("cache",arguments,T),T;var _="a,b,c,d,scale,options,margin,rtl,willReadFrequently",k;if(k=st(T.cache,arguments,_))return k;var $=T.getBounds();if(n(g))if(n(v)){if(!n($)){var O=T.borderWidth>0?T.borderWidth/2:0;v=$.x-O,I=$.y-O,g=$.width+O*2,E=$.height+O*2}}else g=v,E=I,v=0,I=0;return T.type=="Triangle"&&(v-=T.borderWidth?T.borderWidth:0,g+=T.borderWidth?T.borderWidth*2:0,I-=T.borderWidth?T.borderWidth:0,E+=T.borderWidth?T.borderWidth*2:0),n(C)&&(C=0),T.cjsContainer_cache(v-C,I-C,g+C*2,E+C*2,A,y,L,Y),$&&T.setBounds($.x,$.y,$.width,$.height),T.z_bc=T.canvas=T.cacheCanvas,T},this.uncache=function(){return T.cjsContainer_uncache(),T},this.childrenToBitmap=function(){var v=this.cacheCanvas,I=new t.Bitmap(this.cache().cacheCanvas);return v||this.uncache(),this.removeAllChildren(),I.addTo(this),this};var m=j.zdf||1;Ne&&!Ne.stageTransformable&&m.retina&&(this.localToGlobal=function(v,I){return t.localToGlobal(v,I,this,this.cjsContainer_localToGlobal)},this.globalToLocal=function(v,I){return t.globalToLocal(v,I,this,this.cjsContainer_globalToLocal)},this.localToLocal=function(v,I,g){return t.localToLocal(v,I,g,this)}),this.setBounds=function(v,I,g,E){var A=P(v,I,g,E);return T.cjsContainer_setBounds(A[0],A[1],A[2],A[3]),T},this.getBounds=function(v){return v?T.boundsToGlobal(null,null,null,v):T.cjsContainer_getBounds()},this.disposeAllChildren=function(){for(var v=this.numChildren-1;v>=0;v--){var I=this.getChildAt(v);I.dispose&&I.dispose()}return this},t.displayBase(T),a!==!1&&t.styleTransforms(this,p),this.clone=function(v){if(this.type=="AC"&&j.zdf)return dt&&tt("ZIM asset() - cannot clone lazy-loaded asset - use Frame() assets parameter or loadAssets() method"),j.zdf.ac("clone",arguments,this),this;var I=this.getBounds();return n(I)&&(I={x:null,y:null,width:null,height:null}),this.cloneChildren(this.cloneProps(new t.Container(I.x,I.y,I.width,I.height,a,this.group,f)),v)},this.hasProp=function(v){return!n(this[v])||Object.prototype.hasOwnProperty.call(this,v)}},t.Container.prototype.dispose=function(e){return St(this,e),!0},t.Container.prototype.specialColor=function(e,r,i){if(r.type=="GradientColor"){if(!n(r.angle))if(i.width){var l=i.getBounds();if(r.angle+=360*1e5,r.angle%=360,i.type=="Circle"){var a=l.width/2*Math.cos(r.angle*RAD),s=l.width/2*Math.sin(r.angle*RAD);r.x0=-a,r.y0=-s,r.x1=a,r.y1=s}else{var f=r.angle%90,c=l.width*Math.sin(f*RAD),w=c*Math.sin(f*RAD),T=-c*Math.cos(f*RAD),p=l.height*Math.sin(f*RAD),x=l.width+p*Math.cos(f*RAD),P=p*Math.sin(f*RAD),m=l.height*Math.sin(f*RAD),v=-m*Math.cos(f*RAD),I=l.height-m*Math.sin(f*RAD);r.angle>=0&&r.angle<90?(r.x0=l.x+w,r.y0=l.y+T,r.x1=l.x+x,r.y1=l.y+P):r.angle>=90&&r.angle<180?(r.x0=l.x+w,r.y0=l.y+T,r.x1=l.x+v,r.y1=l.y+I):r.angle>=180&&r.angle<270?(r.x0=l.x+x,r.y0=l.y+P,r.x1=l.x+w,r.y1=l.y+T):(r.x0=l.x+v,r.y0=l.y+I,r.x1=l.x+w,r.y1=l.y+T)}}else{e.style=r.colors[0];return}e.linearGradient(r.colors,r.ratios,r.x0,r.y0,r.x1,r.y1)}else if(r.type=="RadialColor"){if(n(r.x0))if(i.width){var l=i.getBounds();r.r0=0,i.type=="Circle"?(r.x0=0,r.y0=0,r.r1=l.width/2):(r.x0=l.x+l.width/2,r.y0=l.y+l.height/2,r.r1=Math.sqrt(Math.pow(l.width/2,2)+Math.pow(l.height/2,2))),r.x1=r.x0,r.y1=r.y0}else{e.style=r.colors[0];return}e.radialGradient(r.colors,r.ratios,r.x0,r.y0,r.r0,r.x1,r.y1,r.r1)}else r.type=="BitmapColor"&&e.bitmap(r.image,r.repetition,r.matrix)};function St(e,r){if(e&&t.gD(e),!r&&e&&e.dispose&&e.dispose!==t.Container.prototype.dispose&&e.dispose(null,null,!0),e&&e.addChild&&(e.dispatchEvent("removed"),e.removeAllEventListeners(),e.numChildren))for(var i=e.numChildren-1;i>=0;i--)St(e.getChildAt(i));e&&e.parent&&e.parent.removeChild(e)}t.extend(t.Container,Ne.Container,["cache","uncache","setBounds","getBounds","clone","localToLocal","localToGlobal","globalToLocal"],"cjsContainer",!1),Vn(t.Container.prototype),t.Shape=function(e,r,i,l,a,s,f,c,w){var T="a, b, c, d, graphics, optimize, style, group, inherit",p;if(p=st(t.Shape,arguments,T,this))return p;De("50.6"),this.cjsShape_constructor(a),this.type="Shape",this.group=c;var x=f===!1?{}:t.getStyle(this.type,this.group,w),P=this;n(e)&&(e=x.a!=null?x.a:null),n(r)&&(r=x.b!=null?x.b:null),n(i)&&(i=x.c!=null?x.c:null),n(l)&&(l=x.d!=null?x.d:null),n(a)&&(a=x.graphics!=null?x.graphics:null),n(s)&&(s=x.optimize!=null?x.optimize:!1);var m=v(e,r,i,l);function v(A,y,C,L){var Y=[];return n(A)?Y=[A,y,C,L]:n(y)?A.x?Y=[A.x,A.y,A.width,A.height]:(Y[0]=0,Y[1]=0,Y[2]=A,Y[3]=A):n(C)?(Y[0]=0,Y[1]=0,Y[2]=A,Y[3]=y):(Y[0]=A,Y[1]=y,Y[2]=C,Y[3]=L),n(Y[3])&&(Y[3]=Y[2]),Y}if(n(e)||this.setBounds(m[0],m[1],m[2],m[3]),!s)for(var I=["mt","lt","a","at","bt","ct","qt","cp","c","f","lf","rf","bf","ef","ss","sd","s","ls","rs","bs","es","dr","rr","rc","dc","de","dp","pg","p"],g=0;g<I.length;g++)~function(){var A=g;P[I[A]]=function(){return I[A]=="ct"?P.graphics.curveTo.apply(P.graphics,arguments):P.graphics[I[A]].apply(P.graphics,arguments),P}}();Object.defineProperty(P,"command",{get:function(){return P.graphics.command},set:function(){}}),this.cache=function(A,y,C,L,Y,_,k,$,O){var X="a,b,c,d,scale,options,margin,rtl,willReadFrequently",R;if(R=st(P.cache,arguments,X))return R;var Q=P.getBounds();if(n(C))if(n(A)){if(!n(Q)){var K=P.borderWidth>0?P.borderWidth/2:0;A=Q.x-K,y=Q.y-K,C=Q.width+K*2,L=Q.height+K*2}}else C=A,L=y,A=0,y=0;return n(k)&&(k=0),P.cjsShape_cache(A-k,y-k,C+k*2,L+k*2,Y,_,$,O),P.z_bc=P.canvas=P.cacheCanvas,P},this.setBounds=function(A,y,C,L){var Y=v(A,y,C,L);return this.cjsShape_setBounds(Y[0],Y[1],Y[2],Y[3]),this},this.getBounds=function(A){return A?P.boundsToGlobal(null,null,null,A):P.cjsShape_getBounds()},f!==!1&&t.styleTransforms(this,x),this.clone=function(A){n(A)&&(A=!0);var y=this.getBounds();n(y)&&(y={x:null,y:null,width:null,height:null});var C=P.cloneProps(new t.Shape(y.x,y.y,y.width,y.height,a,f,c,w));return A?C.graphics=P.graphics.clone():C.graphics=P.graphics,C};var E=j.zdf||1;Ne&&!Ne.stageTransformable&&E.retina&&(this.localToGlobal=function(A,y){return t.localToGlobal(A,y,this,this.cjsShape_localToGlobal)},this.globalToLocal=function(A,y){return t.globalToLocal(A,y,this,this.cjsShape_globalToLocal)},this.localToLocal=function(A,y,C){return t.localToLocal(A,y,C,this)}),this.hasProp=function(A){return!n(this[A])||Object.prototype.hasOwnProperty.call(this,A)},t.displayBase(P),this.dispose=function(){t.gD(this),this.graphics.c(),this.dispatchEvent("removed"),this.removeAllEventListeners(),this.parent&&this.parent.removeChild(this)}},t.extend(t.Shape,Ne.Shape,["cache","clone","setBounds","getBounds","localToLocal","localToGlobal","globalToLocal"],"cjsShape",!1),Vn(t.Shape.prototype),t.Bitmap=function(e,r,i,l,a,s,f,c,w){var T="image, width, height, left, top, scale, style, group, inherit",p;if(p=st(t.Bitmap,arguments,T,this))return p;De("50.7"),this.group=c;var x=f===!1?{}:t.getStyle("Bitmap",this.group,w);n(s)&&(s=x.scale!=null?x.scale:1),n(r)&&(r=x.width!=null?x.width:e?e.width:100),n(i)&&(i=x.height!=null?x.height:e?e.height:100),n(l)&&(l=x.left!=null?x.left:0),n(a)&&(a=x.top!=null?x.top:0);var P=!1,m=e;if(!n(e)&&e.uncache){P=!0;var v=e.cacheCanvas,I=e;e.cache(l,a,r,i,s),this.z_bc=e=e.cacheCanvas}this.cjsBitmap_constructor(e),I&&!v&&I.uncache();var g=this;this.type="Bitmap",!n(r)&&!n(i)&&this.setBounds(0,0,r,i),this.drawImageData=function(C,L,Y,_,k,$){if(n(C)&&(C=0),n(L)&&(L=0),n(Y)&&(Y=0),n(_)&&(_=0),n(k)&&(k=r),n($)&&($=i),!g.proxyCanvas){var O=g.proxyCanvas=document.createElement("canvas");O.setAttribute("width",r),O.setAttribute("height",i),g.proxyContext=O.getContext("2d"),e=m=g.image=O}g.proxyContext&&g.proxyContext.putImageData(g.imageData,C,L,Y,_,k,$)},j.zdf&&(j.zdf.canvas.getContext("2d")?this.imageData=j.zdf.canvas.getContext("2d").createImageData(r,i):this.imageData=document.createElement("canvas").getContext("2d").createImageData(r,i),n(e)&&g.drawImageData(),e&&e.match&&e.match(/data:image/i)&&setTimeout(function(){g.stage&&g.stage.update(),setTimeout(function(){g.stage&&g.stage.update()},50)},50)),e&&e.nodeName&&e.nodeName.toLowerCase()!="video"&&(P?g.sourceRect={x:0,y:0,width:r*s,height:i*s}:g.sourceRect={x:l,y:a,width:r,height:i});function E(C,L,Y,_){var k=[];return n(C)?k=[C,L,Y,_]:n(L)?C.x?k=[C.x,C.y,C.width,C.height]:(k[0]=0,k[1]=0,k[2]=C,k[3]=C):n(Y)?(k[0]=0,k[1]=0,k[2]=C,k[3]=L):(k[0]=C,k[1]=L,k[2]=Y,k[3]=_),n(k[3])&&(k[3]=k[2]),k}this.setBounds=function(C,L,Y,_){var k=E(C,L,Y,_);return g.cjsBitmap_setBounds(k[0],k[1],k[2],k[3]),g},this.getBounds=function(C){return C?g.boundsToGlobal(null,null,null,C):g.cjsBitmap_getBounds()},this.cache=function(C,L,Y,_,k,$,O,X){var R="a,b,c,d,scale,options,rtl,willReadFrequently",Q;if(Q=st(g.cache,arguments,R))return Q;var K;if(n(Y))if(n(C)){if(K=this.getBounds(),!n(K)){var q=this.borderWidth>0?this.borderWidth/2:0;C=K.x-q,L=K.y-q,Y=K.width+q*2,_=K.height+q*2}}else Y=C,_=L,C=0,L=0;return K=g.getBounds(),g.cjsBitmap_cache(C,L,Y,_,k,$,O,X),g.setBounds(K.x,K.y,K.width,K.height),g.z_bc=g.canvas=g.cacheCanvas,g},this.clone=function(){var C=this.cloneProps(new t.Bitmap(m,r,i,l,a,s,f,this.group,w));return C.cloned=!0,C.src=g.src,C.file=g.file,C.image=g.image,C.svg=g.svg,C.item=g.item,C};var A=j.zdf||1;Ne&&!Ne.stageTransformable&&A.retina&&(this.localToGlobal=function(C,L){return t.localToGlobal(C,L,this,this.cjsBitmap_localToGlobal)},this.globalToLocal=function(C,L){return t.globalToLocal(C,L,this,this.cjsBitmap_globalToLocal)},this.localToLocal=function(C,L,Y){return t.localToLocal(C,L,Y,this)}),this.hasProp=function(C){return!n(this[C])||Object.prototype.hasOwnProperty.call(this,C)};var y;this.getColorAt=function(C,L,Y){y||(g.cache(null,null,null,null,null,null,null,!0),y=g.cacheCanvas.getContext("2d"),g.uncache());var _=y.getImageData(C,L,1,1).data;return _[3]/=255,Y?_:"rgba("+_[0]+","+_[1]+","+_[2]+","+_[3]+")"},this.keyOut=function(C,L,Y){n(C)&&(C="#389b26"),n(L)&&(L=.1),Array.isArray(C)||(C=[C]),Array.isArray(L)||(L=[L]),!n(Y)&&!Array.isArray(Y)&&(Y=[Y]);var _,k,$=[],O=[],X=[];for(_=0;_<C.length;_++)$[_]=t.convertColor(C[_],"array"),L[_]!=null?O[_]=L[_]*255:O[_]=L[0]*255,Y&&(Y[_]!=null?(X[_]=t.convertColor(Y[_],"array"),X[_][3]*=255):(X[_]=t.convertColor(Y[0],"array"),X[_][3]*=255));g.cacheCanvas&&g.updateCache(),y||(g.cache(null,null,null,null,null,null,null,!0),y=g.cacheCanvas.getContext("2d"));var R=y.getImageData(l,a,r,i),Q=R.data,K=Q.length/4;if(Y)for(_=0;_<K;_++){var q=Q[_*4+0],ne=Q[_*4+1],U=Q[_*4+2];for(k=0;k<C.length;k++)q>$[k][0]-O[k]&&q<$[k][0]+O[k]&&ne>$[k][1]-O[k]&&ne<$[k][1]+O[k]&&U>$[k][2]-O[k]&&U<$[k][2]+O[k]&&(Q[_*4+0]=X[k][0],Q[_*4+1]=X[k][1],Q[_*4+2]=X[k][2],Q[_*4+3]=X[k][3])}else for(_=0;_<K;_++){var q=Q[_*4+0],ne=Q[_*4+1],U=Q[_*4+2];for(k=0;k<C.length;k++)q>$[k][0]-O[k]&&q<$[k][0]+O[k]&&ne>$[k][1]-O[k]&&ne<$[k][1]+O[k]&&U>$[k][2]-O[k]&&U<$[k][2]+O[k]&&(Q[_*4+3]=0)}return y.putImageData(R,a,l),this},t.displayBase(g),f!==!1&&t.styleTransforms(this,x),this.doDispose=function(){t.gD(this),this.dispatchEvent("removed"),this.removeAllEventListeners(),this.cloned||this.id&&(this.stage&&this.stage.frame?A=this.stage.frame:A=j.zdf,A&&A.assets&&A.assets[this.id]&&delete A.assets[this.id],t.assets[this.id]&&delete t.assets[this.id]),this.parent&&this.parent.removeChild(this)}},t.Bitmap.fromData=function(e,r){var i=100,l=100,a=new Image;a.onload=function(){i=a.naturalWidth,l=a.naturalHeight,n(i)&&(i=a.width),n(l)&&(l=a.height);var s=new t.Bitmap(e,i,l);setTimeout(function(){r(s)},50)},a.src=e},t.extend(t.Bitmap,Ne.Bitmap,["cache","clone","dispose","setBounds","getBounds","localToLocal","localToGlobal","globalToLocal"],"cjsBitmap",!1),t.Bitmap.prototype.dispose=function(){return this.doDispose()},Vn(t.Bitmap.prototype),t.Sprite=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y){var C="image, cols, rows, count, offsetX, offsetY, spacingX, spacingY, width, height, animations, json, id, globalControl, spriteSheet, label, frame, style, group, inherit",L;if(L=st(t.Sprite,arguments,C,this))return L;De("50.8"),this.type="Sprite",this.group=A;var Y=E===!1?{}:t.getStyle(this.type,this.group,y),_=this,k;if(n(g)&&(g=Y.frame!=null?Y.frame:j.zdf),e&&typeof e=="string"&&(e=g.asset(e)),n(x)&&!n(e)){n(r)&&(r=Y.cols!=null?Y.cols:1),n(i)&&(i=Y.rows!=null?Y.rows:1),n(l)&&(l=Y.count!=null?Y.count:r*i),n(a)&&(a=Y.offsetX!=null?Y.offsetX:0),n(s)&&(s=Y.offsetY!=null?Y.offsetY:0),n(f)&&(f=Y.spacingX!=null?Y.spacingX:0),n(c)&&(c=Y.spacingY!=null?Y.spacingY:0),n(w)&&(w=Y.width!=null?Y.width:e.width),n(T)&&(T=Y.height!=null?Y.height:e.height),e.bitmap&&(e=e.bitmap);var $=(w-a+f)/r-f,O=(T-s+c)/i-c,X=[],R=0;e:for(var Q=0;Q<i;Q++)for(var K=0;K<r;K++){if(++R>l)break e;X.push([a+K*($+f),s+Q*(O+c),$,O])}u(e,X,p)}else if(v)k=v,p=k.animations;else if(x){var g=_.stage?_.stage.frame:j.zdf;typeof x=="string"&&(x=g.asset(x));var q,ne,U;if(x.frames&&!Array.isArray(x.frames)){q=[];for(ne in x.frames)U=x.frames[ne].frame,q.push([U.x,U.y,U.w,U.h]);x.frames=q}if(x.frames&&!Array.isArray(x.frames[0])){for(q=[],ne=0;ne<x.frames.length;ne++){var U=x.frames[ne].frame;q.push([U.x,U.y,U.w,U.h])}x.frames=q}if(!x.images&&x.meta&&x.meta.image&&(x.images=[x.meta.image]),X=x.frames,p=x.animations,!n(e))u(e,X,p);else{var D=x.images?x.images[0]:null;if(!D||!D.split)k=new Ne.SpriteSheet(x);else{var d=[];t.loop(x.images,function(b){var ye=b.split("/").pop();g.asset(ye)&&g.asset(ye).type!="EmptyAsset"?d.push(g.asset(ye)):g.asset(b)&&g.asset(b).type!="EmptyAsset"||g.asset(b).type!="EmptyAsset"?d.push(g.asset(b)):dt&&tt("Sprite() - please preload Sprite in Frame or with loadAssets")}),u(d,X,p)}}}else return;function u(h,b,ye){Array.isArray(h)||(h=[h]),t.loop(h,function(N,re){h[re]=N.image});var B={images:h,frames:b,animations:ye||[]};k=new Ne.SpriteSheet(B)}this.animations=p,this.cjsSprite_constructor(k,I),n(I)||this.stop(),n(P)&&(P=t.makeID()),this.id=P,n(m)&&(m=!0),_.globalControl=m;var o=0,S;this.parseFrames=function(h,b,ye,B){var N=[],re=Number.MAX_VALUE,le=0;if(n(h))n(b)&&(b=0),n(ye)&&(ye=_.totalFrames-1),J(b,ye);else{if(n(_.animations)||n(_.animations[h]))return[];var G=_.animations[h];z(G)}function z(ke){Array.isArray(ke)?se(ke):ke.constructor=={}.constructor?Oe(ke):isNaN(ke)||N.push({f:Math.floor(ke),s:1})}function se(ke){J(ke[0],ke[1],ke[3]),ke[2]&&!n(_.animations[ke[2]])&&z(_.animations[ke[2]])}function Oe(ke){if(!n(ke.frames)){n(ke.speed)&&(ke.speed=1);for(var oe=0;oe<ke.frames.length;oe++)ke.speed<re&&(re=ke.speed),ke.speed>le&&(le=ke.speed),N.push({f:ke.frames[oe],s:ke.speed});ke.next&&!n(_.animations[ke.next])&&z(_.animations[ke.next])}}function J(ke,oe,Ce){n(Ce)&&(Ce=1);var Me;if(oe>ke)for(Me=ke;Me<=oe;Me++)te(Me);else for(Me=oe;Me<=ke;Me++)te(ke-(Me-oe));function te(ae){Ce<re&&(re=Ce),Ce>le&&(le=Ce),N.push({f:ae,s:Ce})}}if(B)return N;re=t.constrain(t.decimals(re),.1),le=t.constrain(t.decimals(le),.1);for(var pe=[],Z=re!=le,de,V=0;V<N.length;V++)if(de=N[V],Z)for(var fe=0;fe<t.constrain(Math.round(re<1?de.s/re:de.s),.1);fe++)pe.push(de.f);else pe.push(de.f);return pe},this.run=function(h,b,ye,B,N,re,le,G,z,se,Oe,J,pe,Z,de,V,fe,ke,oe,Ce,Me,te,ae,we,ue,Pe,ie,be,Le){var me="time, label, call, params, wait, waitedCall, waitedParams, loop, loopCount, loopWait, loopCall, loopParams, loopWaitCall, loopWaitParams, loopPick, rewind, rewindWait, rewindCall, rewindParams, rewindWaitCall, rewindWaitParams, rewindTime, rewindEase, startFrame, endFrame, tweek, id, globalControl, pauseOnBlur",ee;if(ee=st(_.run,arguments,me))return ee;var Ie=wt(),Re;n(Pe)&&(Pe=1),n(ie)||(_.id=ie),n(be)||(_.globalControl=be);var _e;if(Array.isArray(b)){var Ze,at;Re=[],_e=0;for(var Be,He=0;He<b.length;He++){Ze=b[He],Ze.lookup=_.parseFrames(Ze.label,Ze.startFrame,Ze.endFrame),He==0&&(Be=Ze.lookup[0]),delete Ze.startFrame,delete Ze.endFrame,Ze.obj=t.merge(Ze.obj,{normalizedFrame:Ze.lookup.length-1}),Ze.set=t.merge(Ze.set,{normalizedFrames:{noPick:Ze.lookup},normalizedFrame:0}),n(Ze.wait)&&(Ze.wait=_e*Pe),at=Ze.label,delete Ze.label,Re.push(Ze),_e=0;var et=n(Ze.time)?h:Ze.time;ue-we>0&&(_e=et/(ue-we)/2)}if(Re.length==0)return this;Re.length==1?(h=Re[0].time,b=at,ge()):_.gotoAndStop(Be)}else ge();function ge(){S=_.parseFrames(b,we,ue),o=0,_.gotoAndStop(S[o]),we=ue=null,Re={normalizedFrame:S.length-1}}n(h)&&(h=Ie=="s"?1:1e3),_.running&&_.stopAnimate(_.id),_.running=!0,Array.isArray(Re)||(_e=0,ue-we>0&&(_e=h/Math.abs(ue-we)/2),S&&S.length>0&&(_e=h/S.length/2),!n(G)&&n(se)&&(se=_e*Pe),!n(V)&&n(fe)&&(fe=_e*Pe));var xe=function(){_.running=!1,_.stop(),ye&&typeof ye=="function"&&ye(B||_)};return t.animate({target:_,obj:Re,time:h,ease:"linear",call:xe,params:B,wait:N,waitedCall:re,waitedParams:le,loop:G,loopCount:z,loopWait:se,loopCall:Oe,loopParams:J,loopWaitCall:pe,loopWaitParams:Z,rewind:V,rewindWait:fe,rewindCall:ke,rewindParams:oe,rewindWaitCall:Ce,rewindWaitParams:Me,rewindTime:te,rewindEase:ae,override:!1,pauseOnBlur:Le,id:_.id}),_.runPaused=!1,_},this.runPaused=!0,this.pauseRun=function(h){return n(h)&&(h=!0),_.runPaused=h,_.globalControl?t.pauseAnimate(h,_.id):_.pauseAnimate(h,_.id),_},this.stopRun=function(){return _.runPaused=!0,_.running=!1,_.globalControl?t.stopAnimate(_.id):_.stopAnimate(_.id),_},Object.defineProperty(this,"frame",{get:function(){return this.currentFrame},set:function(h){h=Math.round(h),this.paused?this.gotoAndStop(h):this.gotoAndPlay(h)}}),Object.defineProperty(this,"normalizedFrame",{get:function(){return o},set:function(h){o=Math.round(h),this.gotoAndStop(S[o])}}),Object.defineProperty(this,"normalizedFrames",{get:function(){return S},set:function(h){S=h}}),Object.defineProperty(this,"totalFrames",{get:function(){return k.getNumFrames()},set:function(){tt("zim.Sprite - totalFrames is read only")}}),E!==!1&&t.styleTransforms(this,Y),this.clone=function(){var h=this.cloneProps(new t.Sprite(e,r,i,l,a,s,f,c,w,T,p,x,null,m,v,I,g,E,this.group,y));return _.frame>=0&&h.run({startFrame:_.frame,endFrame:_.frame}),h},Ne&&!Ne.stageTransformable&&g.retina&&(this.localToGlobal=function(h,b){return t.localToGlobal(h,b,this,this.cjsSprite_localToGlobal)},this.globalToLocal=function(h,b){return t.globalToLocal(h,b,this,this.cjsSprite_globalToLocal)},this.localToLocal=function(h,b,ye){return t.localToLocal(h,b,ye,this)}),this.hasProp=function(h){return!n(this[h])||Object.prototype.hasOwnProperty.call(this,h)},t.displayBase(_);function F(h,b,ye,B){var N=[];return n(h)?N=[h,b,ye,B]:n(b)?h.x?N=[h.x,h.y,h.width,h.height]:(N[0]=0,N[1]=0,N[2]=h,N[3]=h):n(ye)?(N[0]=0,N[1]=0,N[2]=h,N[3]=b):(N[0]=h,N[1]=b,N[2]=ye,N[3]=B),n(N[3])&&(N[3]=N[2]),N}this.setBounds=function(h,b,ye,B){var N=F(h,b,ye,B);return _.cjsSprite_setBounds(N[0],N[1],N[2],N[3]),_},this.getBounds=function(h){return h?_.boundsToGlobal(null,null,null,h):_.cjsSprite_getBounds()},this.dispose=function(){t.gD(this),this.dispatchEvent("removed"),this.removeAllEventListeners(),this.parent&&this.parent.removeChild(this)}},t.extend(t.Sprite,Ne.Sprite,["clone","setBounds","getBounds","localToLocal","localToGlobal","globalToLocal"],"cjsSprite",!1),Vn(t.Sprite.prototype),t.MovieClip=function(e,r,i,l,a,s,f){var c="mode, startPosition, loop, labels, style, group, inherit",w;if(w=st(t.MovieClip,arguments,c,this))return w;De("50.9"),this.type="MovieClip",this.group=s;var T=a===!1?{}:t.getStyle(this.type,this.group,f);n(e)&&(e=T.mode!=null?T.mode:null),n(r)&&(r=T.startPosition!=null?T.startPosition:null),n(i)&&(i=T.loop!=null?T.loop:null),n(l)&&(l=T.labels!=null?T.labels:null),this.cjsMovieClip_constructor(e,r,i,l),a!==!1&&t.styleTransforms(this,T),this.clone=function(){return this.cloneProps(new t.MovieClip(e,r,i,l,a,this.group,f))},this.hasProp=function(P){return!n(this[P])||Object.prototype.hasOwnProperty.call(this,P)};var p=j.zdf||1;Ne&&!Ne.stageTransformable&&p.retina&&(this.localToGlobal=function(P,m){return t.localToGlobal(P,m,this,this.cjsMovieClip_localToGlobal)},this.globalToLocal=function(P,m){return t.globalToLocal(P,m,this,this.cjsMovieClip_globalToLocal)},this.localToLocal=function(P,m,v){return t.localToLocal(P,m,v,this)}),t.displayBase(this);function x(P,m,v,I){var g=[];return n(P)?g=[P,m,v,I]:n(m)?P.x?g=[P.x,P.y,P.width,P.height]:(g[0]=0,g[1]=0,g[2]=P,g[3]=P):n(v)?(g[0]=0,g[1]=0,g[2]=P,g[3]=m):(g[0]=P,g[1]=m,g[2]=v,g[3]=I),n(g[3])&&(g[3]=g[2]),g}this.setBounds=function(P,m,v,I){var g=x(P,m,v,I);return that.cjsMovieClip_setBounds(g[0],g[1],g[2],g[3]),that},this.getBounds=function(P){return P?that.boundsToGlobal(null,null,null,P):that.cjsMovieClip_getBounds()},this.dispose=function(){t.gD(this),this.dispatchEvent("removed"),this.removeAllEventListeners(),this.parent&&this.parent.removeChild(this)}},t.extend(t.MovieClip,Ne.MovieClip,["clone","setBounds","getBounds","localToLocal","localToGlobal","globalToLocal"],"cjsMovieClip",!1),Vn(t.MovieClip.prototype),t.SVGContainer=function(e,r,i,l,a,s,f,c){var w="svg, splitTypes, geometric, showControls, interactive, style, group, inherit",T;if(T=st(t.SVGContainer,arguments,w,this))return T;De("50.95"),this.group=f;var p=s===!1?{}:t.getStyle("SVGContainer",this.group,c);e&&e.type=="Bitmap"&&(e=e.svg);var x=this,P=new t.Point(0,0),m;function v(){function F(Oe,J){return N(Oe)||B(Oe,J)||b(Oe,J)||h()}function h(){throw new TypeError("Invalid")}function b(Oe,J){if(Oe){if(typeof Oe=="string")return ye(Oe,J);var pe=Object.prototype.toString.call(Oe).slice(8,-1);if(pe==="Object"&&Oe.constructor&&(pe=Oe.constructor.name),pe==="Map"||pe==="Set")return Array.from(Oe);if(pe==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(pe))return ye(Oe,J)}}function ye(Oe,J){(J==null||J>Oe.length)&&(J=Oe.length);for(var pe=0,Z=new Array(J);pe<J;pe++)Z[pe]=Oe[pe];return Z}function B(Oe,J){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(Oe)))){var pe=[],Z=!0,de=!1,V=void 0;try{for(var fe=Oe[Symbol.iterator](),ke;!(Z=(ke=fe.next()).done)&&(pe.push(ke.value),!(J&&pe.length===J));Z=!0);}catch(oe){de=!0,V=oe}finally{try{!Z&&fe.return!=null&&fe.return()}finally{if(de)throw V}}return pe}}function N(Oe){if(Array.isArray(Oe))return Oe}var re=Math.PI*2,le=function(J,pe,Z,de,V,fe,ke){var oe=J.x,Ce=J.y;oe*=pe,Ce*=Z;var Me=de*oe-V*Ce,te=V*oe+de*Ce;return{x:Me+fe,y:te+ke}},G=function(J,pe){var Z=pe===1.5707963267948966?.551915024494:pe===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(pe/4),de=Math.cos(J),V=Math.sin(J),fe=Math.cos(J+pe),ke=Math.sin(J+pe);return[{x:de-V*Z,y:V+de*Z},{x:fe+ke*Z,y:ke-fe*Z},{x:fe,y:ke}]},z=function(J,pe,Z,de){var V=J*de-pe*Z<0?-1:1,fe=J*Z+pe*de;return fe>1&&(fe=1),fe<-1&&(fe=-1),V*Math.acos(fe)},se=function(J,pe,Z,de,V,fe,ke,oe,Ce,Me,te,ae){var we=Math.pow(V,2),ue=Math.pow(fe,2),Pe=Math.pow(te,2),ie=Math.pow(ae,2),be=we*ue-we*ie-ue*Pe;be<0&&(be=0),be/=we*ie+ue*Pe,be=Math.sqrt(be)*(ke===oe?-1:1);var Le=be*V/fe*ae,me=be*-fe/V*te,ee=Me*Le-Ce*me+(J+Z)/2,Ie=Ce*Le+Me*me+(pe+de)/2,Re=(te-Le)/V,_e=(ae-me)/fe,Ze=(-te-Le)/V,at=(-ae-me)/fe,Be=z(1,0,Re,_e),He=z(Re,_e,Ze,at);return oe===0&&He>0&&(He-=re),oe===1&&He<0&&(He+=re),[ee,Ie,Be,He]};return function(J){var pe=J.px,Z=J.py,de=J.cx,V=J.cy,fe=J.rx,ke=J.ry,oe=J.xAxisRotation,Ce=oe===void 0?0:oe,Me=J.largeArcFlag,te=Me===void 0?0:Me,ae=J.sweepFlag,we=ae===void 0?0:ae,ue=[];if(fe===0||ke===0)return[];var Pe=Math.sin(Ce*re/360),ie=Math.cos(Ce*re/360),be=ie*(pe-de)/2+Pe*(Z-V)/2,Le=-Pe*(pe-de)/2+ie*(Z-V)/2;if(be===0&&Le===0)return[];fe=Math.abs(fe),ke=Math.abs(ke);var me=Math.pow(be,2)/Math.pow(fe,2)+Math.pow(Le,2)/Math.pow(ke,2);me>1&&(fe*=Math.sqrt(me),ke*=Math.sqrt(me));var ee=se(pe,Z,de,V,fe,ke,te,we,Pe,ie,be,Le),Ie=F(ee,4),Re=Ie[0],_e=Ie[1],Ze=Ie[2],at=Ie[3],Be=Math.abs(at)/(re/4);Math.abs(1-Be)<1e-7&&(Be=1);var He=Math.max(Math.ceil(Be),1);at/=He;for(var et=0;et<He;et++)ue.push(G(Ze,at)),Ze+=at;return ue.map(function(ge){var xe=le(ge[0],fe,ke,ie,Pe,Re,_e),he=xe.x,Ge=xe.y,qe=le(ge[1],fe,ke,ie,Pe,Re,_e),Fe=qe.x,We=qe.y,ce=le(ge[2],fe,ke,ie,Pe,Re,_e),Ve=ce.x,Se=ce.y;return{x1:he,y1:Ge,x2:Fe,y2:We,x:Ve,y:Se}})}}n(r)&&(r=!1),n(i)&&(i=!0);var I,g;function E(F){t.loop(F,function(h){var b=h.tagName.toLowerCase();if(b=="path"&&S(h),b=="circle"&&y("circle",h),b=="rect"&&y("rect",h),b=="ellipse"&&y("ellipse",h),b=="line"&&y("line",h),b=="polygon"&&y("polygon",h),b=="polyline"&&y("polyline",h),b=="g"){var ye=h.getAttribute("style"),B,N,re,le,G;if(ye){var z=A(ye);B=z[0],N=z[1],re=z[2],le=z[3],G=z[4]}d=h.getAttribute("transform"),O=h.getAttribute("fill")?h.getAttribute("fill"):n(B)?$:B,R=h.getAttribute("stroke")?h.getAttribute("stroke"):n(N)?X:N,K=h.getAttribute("stroke-width")?h.getAttribute("stroke-width"):n(re)?Q:re,ne=h.getAttribute("fill-opacity")?h.getAttribute("fill-opacity"):n(le)?q:le,D=h.getAttribute("stroke-opacity")?h.getAttribute("stroke-opacity"):n(G)?U:G}E(h.children),h.tagName.toLowerCase()=="g"&&(O=$,R=X,K=Q,ne=q,D=U,d=null)})}function A(F){var h=F.split(";"),b,ye,B,N,re;return t.loop(h,function(le){le=le.replace(/,/g,"");var G=le.split(":"),z=G[0].trim().toLowerCase(),se=G[1].trim().toLowerCase().replace("px","");z=="fill"&&(b=se),z=="stroke"&&(ye=se),z=="stroke-width"&&(B=se),z=="opacity"&&(N=se,re=se),z=="fill-opacity"&&(N=se),z=="stroke-opacity"&&(re=se)}),[b,ye,B,N,re]}function y(F,h){var b,ye=o(h),B=ye[0],N=ye[1],re=ye[2],le=ye[5],G=ye[6];if(F=="circle"){var z=Number(h.getAttribute("r").trim()),se=z*.5523;i?b=new t.Circle(Number(h.getAttribute("r")),B,N,re):b=new t.Blob(B,N,re,4,z,se,"mirror",null,l,null,null,null,null,null,null,null,null,null,null,null,null,null,a)}else if(F=="rect")if(i)b=new t.Rectangle(Number(h.getAttribute("width")),Number(h.getAttribute("height")),B,N,re,Number(h.getAttribute("rx")));else{var Oe=Number(h.getAttribute("width")),J=Number(h.getAttribute("height")),pe=Number(h.getAttribute("rx")),Z=Number(h.getAttribute("ry"));if(pe&&Z){var de=pe*.5523,V=Z*.5523;b=new t.Blob(B,N,re,[[pe,0,0,0,-de,0,0,0,"free"],[Oe-pe,0,0,0,0,0,de,0,"free"],[Oe,Z,0,0,0,-V,0,0,"free"],[Oe,J-Z,0,0,0,0,0,V,"free"],[Oe-pe,J,0,0,de,0,0,0,"free"],[pe,J,0,0,0,0,-de,0,"free"],[0,J-Z,0,0,0,V,0,0,"free"],[0,Z,0,0,0,0,0,-V,"free"]],null,null,null,null,l,null,null,null,null,null,null,null,null,null,null,null,null,null,a)}else b=new t.Blob(B,N,re,[[0,0],[Oe,0],[Oe,J],[0,J]],null,null,null,null,l,null,null,null,null,null,null,null,null,null,null,null,null,null,a)}else if(F=="line")b=new t.Squiggle(N,re,[[Number(h.getAttribute("x1")),Number(h.getAttribute("y1"))],[Number(h.getAttribute("x2")),Number(h.getAttribute("y2"))]],null,null,null,null,l,null,null,null,null,null,null,null,null,null,null,null,null,null,a);else if(F=="polygon"||F=="polyline"){var fe=h.getAttribute("points");fe=fe.replace(/-/g," -"),fe=fe.replace(/\s+/g," ");var ke=[];if(fe.indexOf(",")!=-1)t.loop(fe.split(" "),function(Me){var te=Me.split(",");ke.push([Number(te[0].trim()),Number(te[1].trim())])});else{var oe;t.loop(fe.split(" "),function(Me,te){(te+1)%2==0&&ke.push([oe,Me.trim()]),oe=Me.trim()})}F=="polygon"?b=new Blob(B,N,re,ke):b=new t.Squiggle(N,re,ke,null,null,null,null,l,null,null,null,null,null,null,null,null,null,null,null,null,null,a)}else F=="ellipse"&&(b=new t.Blob(B,N,re,L(0,0,Number(h.getAttribute("rx")),Number(h.getAttribute("ry"))),null,null,null,null,l,null,null,null,null,null,null,null,null,null,null,null,null,null,a));b.loc(le,G,x);var Ce=h.getAttribute("transform");(Ce||d)&&C(b,Ce||d),a&&(b.type=="Rectangle"||b.type=="Circle")&&b.transform({showReg:!1,visible:l})}function C(F,h){var b=h.split(")");t.loop(b,function(ye){if(ye!=""){var B=ye.trim().split("("),N=B[0].trim().toLowerCase(),re=B[1].trim().toLowerCase().replace("px","").replace("deg","");if(N=="translate"){var le=re.split(",");F.mov(Number(le[0].trim()),le[1]?Number(le[1].trim()):0)}if(N=="scale"){var G=re.split(",");F.type=="Blob"||F.type=="Squiggle"?G.length==1?F.transformPoints("scale",Number(G[0].trim())):G.length==2&&(F.transformPoints("scaleX",Number(G[0].trim())),F.transformPoints("scaleY",Number(G[1].trim()))):G.length==1?F.sca(Number(G[0].trim())):G.length==2&&F.sca(Number(G[0].trim()),Number(G[1].trim()))}if(N=="rotate"){var z=re.split(",");z.length==1?z.push(0,0):z.length==2&&z.push(0),F.rot(Number(z[0].trim()),Number(z[1].trim()),Number(z[2].trim()))}N=="skewX"&&(F.skewX=re),N=="skewY"&&(F.skewY=re)}})}function L(F,h,b,ye){var B=.5522848,N=b*B,re=ye*B,le=F+b,G=h+ye,z=[[F-b,h,0,0,F,G+re-ye,F,h-re,"mirror"],[F,h-ye,0,0,F-N,h,le+N-b,h,"mirror"],[le,h,0,0,F,h-re,F+N-N,G+re-ye,"mirror"],[F,G,0,0,le-b+N,h,F-N,h,"mirror"]];return z}if(!n(e)){if(e.replace&&(e=e.replace(/style\s?=[^"]*"[^"]*"/ig,"")),n(e.draggable))e.getAttribute||(I=new DOMParser,e=I.parseFromString(e,"image/svg+xml").documentElement),g=this.svg=e;else{I=new DOMParser,e=e.innerHTML?I.parseFromString(e.innerHTML,"text/xml"):e;var Y=e.getElementsByTagName("svg");g=this.svg=Y?e.getElementsByTagName("svg")[0]:null}var _,k;if(n(g)||(_=g.getAttribute("width"),k=g.getAttribute("height")),_&&(_=Number(_.trim())),k&&(k=Number(k.trim())),this.zimContainer_constructor(_,k),this.type="SVGContainer",n(g))return;var $=t.black,O=t.black,X=t.black,R=t.black,Q=2,K=2,q=1,ne=1,U=1,D=1,d,u=e.getElementsByTagName("svg");u.length==0&&(u=[e]),E(u)}function o(F){var h,b,ye,B,N,re=F.getAttribute("style");if(re){var le=A(re);h=le[0],b=le[1],ye=le[2],B=le[3],N=le[4]}h=F.getAttribute("fill")?F.getAttribute("fill"):n(h)?O:h,b=F.getAttribute("stroke")?F.getAttribute("stroke"):n(b)?R:b,ye=F.getAttribute("stroke-width")?F.getAttribute("stroke-width"):n(ye)?K:ye,B=F.getAttribute("fill-opacity")?F.getAttribute("fill-opacity"):n(B)?ne:B,N=F.getAttribute("stroke-opacity")?F.getAttribute("stroke-opacity"):n(N)?D:N;var G=F.getAttribute("x")?F.getAttribute("x"):0;G=F.getAttribute("cx")?F.getAttribute("cx"):G;var z=F.getAttribute("y")?F.getAttribute("y"):0;return z=F.getAttribute("cy")?F.getAttribute("cy"):z,!n(B)&&!n(h)&&(h=t.convertColor(h,"rgba",Number(B))),!n(N)&&!n(b)&&(b=t.convertColor(b,"rgba",Number(N))),[h,b,Number(ye),Number(B),Number(N),Number(G),Number(z)]}function S(F,h){n(h)&&(h=!0);var b=["M","m","L","l","H","h","V","v","C","c","S","s","Q","q","T","t","A","a","z","Z"],ye=["m","l","h","v","c","s","q","t","a","z"],B=new t.Point(0,0),N;if(n(F.getAttribute)?N=F:N=F.getAttribute("d"),N=N.replace(/,/g," "),N=N.replace(/([a-zA-Z])/g," $1 "),N=N.replace(/-/g," -"),N=N.replace(/\s+/g," "),N=N.replace(/\.(\d*)\./g,".$1 ."),h)var re=o(F),le=re[0],G=re[1],z=re[2];var se,Oe,J=[],pe=[0,0],Z=new t.Point(0,0),de=new t.Point(0,0,0,0),V=new t.Point(0,0,0,0,0,0),fe=new t.Point(0,0,0,0,0,0,0),ke=N.split(" "),oe=ke.slice(1,ke.length),Ce=[],Me=!1,te,ae,we=!1,ue,Pe="squiggle",ie=null;t.loop(oe,function(Le,me){if(me==0&&(P.x=0,P.y=0,pe=[0,0],te="",ae=""),b.indexOf(Le)==-1){ue=="lxo"&&(ue="lx",Ce.push("l"),Me=!0),ue=="lyo"&&(ue="ly",Me=!0),ue=="Lxo"&&(ue="Lx",Ce.push("L"),Me=!0),ue=="Lyo"&&(ue="Ly",Me=!0),Oe=Number(Le),Oe=Math.round(Oe*100)/100,ue=="X"?(P.x=Oe,ue="Y"):ue=="Y"?(P.y=Oe,ue="Lxo",J.push([P.x,P.y])):ue=="x"?(P.x=P.x+Oe,ue="y"):ue=="y"&&(P.y=P.y+Oe,ue="lxo",J.push([P.x,P.y])),ue=="H"||ue=="h"?(B.x=J[J.length-1][0],B.y=J[J.length-1][1],B.x=B.x+(ue=="h"?Oe:Oe-P.x),J.push([B.x,B.y]),ue="Lx"):(ue=="V"||ue=="v")&&(B.x=J[J.length-1][0],B.y=J[J.length-1][1],B.y=B.y+(ue=="v"?Oe:Oe-P.y),J.push([B.x,B.y]),ue="lx"),ue=="Lx"?(Z.x=Oe,ue="Ly"):ue=="Ly"?(Z.y=Oe,B.x=Z.x,B.y=Z.y,J.push([B.x,B.y]),ue="Lx"):ue=="lx"?(Ce.length>0&&(B.x!=0&&B.y!=0?(P.x=B.x,P.y=B.y):(P.x=B.x+P.x,P.y=B.y+P.y)),Z.x=P.x+Oe,Me?ue="lyo":ue="ly"):ue=="ly"&&(Z.y=P.y+Oe,B.x=Z.x,B.y=Z.y,J.push([B.x,B.y]),ue="lx");var ee;if(ue=="qx"||ue=="Qx"?(J.length>0?(P.x=J[J.length-1][0],P.y=J[J.length-1][1]):(P.x=0,P.y=0),de.x=ue=="qx"?P.x+Oe:Oe,ue=ue=="qx"?"qy":"Qy"):ue=="qy"||ue=="Qy"?(de.y=ue=="qy"?P.y+Oe:Oe,ue=ue=="qy"?"qz":"Qz",we&&(we=!1,ee=J[J.length-1],ee[6]=-ee[4],ee[7]=-ee[5],ee[8]="mirror",B.x=de.x,B.y=de.y,J[J.length]=[B.x,B.y,0,0,-ee[6],ee[7],0,0,"free"],ue=ue=="qy"?"qx":"Qx")):ue=="qz"||ue=="Qz"?(de.z=ue=="qz"?P.x+Oe:Oe,ue=ue=="qz"?"qq":"Qq"):(ue=="qq"||ue=="Qq")&&(de.w=ue=="qq"?P.y+Oe:Oe,ee=J[J.length-1],B.x=ee[0],B.y=ee[1],J.length==1?(ee[2]=0,ee[3]=0,ee[4]=0,ee[5]=0,ee[6]=2/3*(de.x-B.x),ee[7]=2/3*(de.y-B.y),ee[8]="free"):J[J.length]=[B.x,B.y,0,0,0,0,2/3*(de.x-B.x),2/3*(de.y-B.y),"free"],B.x=de.z,B.y=de.w,J[J.length]=[B.x,B.y,0,0,2/3*(de.x-B.x),2/3*(de.y-B.y),0,0,"free"],ue=ue=="qq"?"qx":"Qx"),ue=="cx"||ue=="Cx")J.length>0?(P.x=J[J.length-1][0],P.y=J[J.length-1][1]):(P.x=0,P.y=0),V.x=ue=="cx"?P.x+Oe:Oe,ue=ue=="cx"?"cy":"Cy";else if(ue=="cy"||ue=="Cy")V.y=ue=="cy"?P.y+Oe:Oe,ue=ue=="cy"?"cz":"Cz";else if(ue=="cz"||ue=="Cz")V.z=ue=="cz"?P.x+Oe:Oe,ue=ue=="cz"?"cq":"Cq";else if(ue=="cq"||ue=="Cq")V.q=ue=="cq"?P.y+Oe:Oe,ue=ue=="cq"?"cr":"Cr",we&&(te=="s"?ae="s":ae="S",ee=J[J.length-1],ee[2]=0,ee[3]=0,n(ee[4])&&(ee[4]=0),n(ee[5])&&(ee[5]=0),ee[6]=-ee[4],ee[7]=-ee[5],ee[8]="mirror",B.x=V.z,B.y=V.q,J[J.length]=[B.x,B.y,0,0,V.x-B.x,V.y-B.y,0,0,"free"],ue=ue=="cr"?"cx":"Cx");else if(ue=="cr"||ue=="Cr")V.r=ue=="cr"?P.x+Oe:Oe,ue=ue=="cr"?"cs":"Cs";else if(ue=="cs"||ue=="Cs")V.s=ue=="cs"?P.y+Oe:Oe,ee=J[J.length-1],J.length==1&&(ee[2]=0,ee[3]=0,ee[4]=0,ee[5]=0),ee[6]=V.x-ee[0],ee[7]=V.y-ee[1],ee[8]="free",B.x=V.r,B.y=V.s,J[J.length]=[B.x,B.y,0,0,V.z-B.x,V.q-B.y,0,0,"free"],ue=ue=="cs"?"cx":"Cx";else if(ue=="ax"||ue=="Ax")J.length>0?(P.x=J[J.length-1][0],P.y=J[J.length-1][1]):(P.x=0,P.y=0),fe.x=Oe,ue=ue=="ax"?"ay":"Ay";else if(ue=="ay"||ue=="Ay")fe.y=Oe,ue=ue=="ay"?"az":"Az";else if(ue=="az"||ue=="Az")fe.z=Oe,ue=ue=="az"?"aq":"Aq";else if(ue=="aq"||ue=="Aq")fe.q=Oe,ue=ue=="aq"?"ar":"Ar";else if(ue=="ar"||ue=="Ar")fe.r=Oe,ue=ue=="ar"?"as":"As";else if(ue=="as"||ue=="As")fe.s=ue=="as"?P.x+Oe:Oe,ue=ue=="as"?"at":"At";else if(ue=="at"||ue=="At"){fe.t=ue=="at"?P.y+Oe:Oe,m||(m=v());var Ie=m({px:P.x,py:P.y,cx:fe.s,cy:fe.t,rx:fe.x,ry:fe.y,xAxisRotation:fe.z,largeArcFlag:fe.q,sweepFlag:fe.r});t.loop(Ie,function(Re,_e){ee=J[J.length-1],J.length==1&&(ee[2]=0,ee[3]=0,ee[4]=0,ee[5]=0),_e==0&&J.length==1?(ee[6]=Re.x1-B.x-P.x,ee[7]=Re.y1-B.y-P.y):(ee[6]=Re.x1-B.x,ee[7]=Re.y1-B.y),ee[8]="free",B.x=Re.x,B.y=Re.y,J[J.length]=[B.x,B.y,0,0,Re.x2-B.x,Re.y2-B.y,0,0,"free"]}),ue=ue=="at"?"ax":"Ax"}}else Ce.push(Le),Le!="s"&&(we=!1),Ce.length>1&&(Le=="M"||Le=="m")&&(be(Ce),Le=="M"?(P.x=0,P.y=0):(P.x=J[J.length-1][0],P.y=J[J.length-1][1]),J=[],Ce=[],Ce.push(Le)),Le=="M"?ue="X":Le=="m"?ue="x":Le=="L"?(ue="Lx",r&&ie&&ie!="l"&&be(Ce),ie="l"):Le=="l"?(ue="lx",r&&ie&&ie!="l"&&be(Ce),ie="l"):Le=="H"?(ue="H",r&&ie&&ie!="l"&&be(Ce),ie="l"):Le=="h"?(ue="h",r&&ie&&ie!="l"&&be(Ce),ie="l"):Le=="V"?(ue="V",r&&ie&&ie!="l"&&be(Ce),ie="l"):Le=="v"?(ue="v",r&&ie&&ie!="l"&&be(Ce),ie="l"):Le=="C"?(ue="Cx",r&&ie&&ie!="c"&&be(Ce),ie="c"):Le=="c"?(ue="cx",r&&ie&&ie!="c"&&be(Ce),ie="c"):Le=="S"?(we=!0,ue="Cx",r&&ie&&ie!="c"&&be(Ce),ie="c"):Le=="s"?(we=!0,ue="cx",r&&ie&&ie!="c"&&be(Ce),ie="c"):Le=="Q"?(ue="Qx",r&&ie&&ie!="q"&&be(Ce),ie="q"):Le=="q"?(ue="qx",r&&ie&&ie!="q"&&be(Ce),ie="q"):Le=="T"?(we=!0,ue="Qx",r&&ie&&ie!="q"&&be(Ce),ie="q"):Le=="t"?(we=!0,ue="qx",r&&ie&&ie!="q"&&be(Ce),ie="q"):Le=="A"?(ue="Ax",r&&ie&&ie!="a"&&be(),ie="a"):Le=="a"?(ue="ax",r&&ie&&ie!="a"&&be(),ie="a"):(Le=="z"||Le=="Z")&&(Pe="blob")});function be(){te=Ce[Ce.length-1],J.length>=2&&(te=="z"||te=="Z")&&(Pe="blob"),Pe=="squiggle"?se=new t.Squiggle(G,z,J,null,null,null,null,l,null,null,null,null,null,null,null,null,null,null,null,null,null,a):se=new t.Blob(le,G,z,J,null,null,null,null,l,null,null,null,null,null,null,null,null,null,null,null,null,null,a),se.loc(0,0,x),te=Ce[Ce.length-1],ae=Ce[Ce.length-2],ye.indexOf(te)>=0?(pe[0]=J[J.length-1][0],pe[1]=J[J.length-1][1],P.x=J[J.length-1][0],P.y=J[J.length-1][1],J=[],J.push([pe[0],pe[1]])):(pe=[0,0],J=[[0,0]]),Ce=[],te!="z"&&te!="Z"&&Ce.push(te),B.x=0,B.y=0;var Le=F.getAttribute("transform");(Le||d)&&C(se,Le||d)}return h&&be(),J}x.processPath=function(F){return S(F,!1)},s!==!1&&t.styleTransforms(this,p),this.clone=function(){return x.cloneProps(new t.SVGContainer(e,r,i,l,a,s,this.group,c))}},t.extend(t.SVGContainer,t.Container,"clone","zimContainer",!1),t.CustomShape=function(e,r,i,l){t.zimCustomShapeCheck||(De("50.97"),t.zimCustomShapeCheck=!0),this.zimContainer_constructor(e,r,i,l,!1);var a=this;this.mouseChildren=!1,a._dashedOffset=5,Object.defineProperty(a,"color",{get:function(){return a._color},set:function(s){n(s)&&(s="black"),a._color=s,s&&s.type?a.specialColor(a.colorCommand,s,a):a.colorCommand.style=s}}),this.setColorRange=function(s,f){return n(f)?(a.startColor=a.color,a.endColor=s):n(s)?(a.startColor=a.color,a.endColor=f):(a.startColor=s,a.endColor=f),a},a._colorRange=0,Object.defineProperty(a,"colorRange",{get:function(){return a._colorRange},set:function(s){a._colorRange=s,!n(a.startColor)&&!n(a.endColor)&&(a.color=t.colorRange(a.startColor,a.endColor,s))}}),Object.defineProperty(a,"borderColor",{get:function(){return a._borderColor},set:function(s){a._borderColor=s,s&&!a.borderWidth&&(a.borderWidth=1),a.borderColorCommand?s&&s.type?a.specialColor(a.borderColorCommand,s,a):a.borderColorCommand.style=s:a.drawShape()}}),Object.defineProperty(a,"borderWidth",{get:function(){return a._borderWidth},set:function(s){s>0||(s=0),a._borderWidth=s,!a.borderWidthCommand||a._borderWidth==0?(a.borderWidthCommand=null,a.drawShape()):(a.borderWidthCommand.width=a._borderWidth,a._dashed&&(a.borderDashedCommand.segments=a._dashed,a.borderDashedCommand.offset=a._dashedOffset))}}),Object.defineProperty(a,"thickness",{get:function(){return a._thickness},set:function(s){s>0||(s=0),a._thickness=s,!a.thicknessCommand||a._thickness==0?a.drawShape():(a.thicknessCommand.width=a._thickness,a._dashed&&(a.dashedCommand.segments=a._dashed,a.dashedCommand.offset=a._dashedOffset))}}),Object.defineProperty(a,"dashed",{get:function(){return a._dashed},set:function(s){a._dashed=s,s&&!Array.isArray(a._dashed)&&(a.dashed=[10,10]);var f;if(a.type=="Squiggle"||a.type=="Line"){if(!a.thicknessCommand||a._thickness==0)return;f=a.dashedCommand}else{if(!a.borderWidthCommand||a._borderWidth==0)return;f=a.borderDashedCommand}f?a._dashed?(f.segments=a._dashed,f.offset=a._dashedOffset):(f.segments=null,f.offset=null):a.drawShape()}}),Object.defineProperty(a,"dashedOffset",{get:function(){return a._dashedOffset},set:function(s){isNaN(s)&&(s=5),a._dashedOffset=s;var f;if(a.type=="Squiggle"||a.type=="Line"){if(!a.thicknessCommand||a._thickness==0)return;f=a.dashedCommand}else{if(!a.borderWidthCommand||a._borderWidth==0)return;f=a.borderDashedCommand}f?a._dashed?(f.segments=a._dashed,f.offset=a._dashedOffset):(f.segments=null,f.offset=null):a.drawShape()}}),Object.defineProperty(a,"corner",{get:function(){return a._corner},set:function(s){a._corner=s,a.drawShape()}}),this.linearGradient=function(s,f,c,w,T,p){return this.linearGradientParams=Array.prototype.slice.call(arguments),this.colorCommand.linearGradient(s,f,c,w,T,p),this},this.radialGradient=function(s,f,c,w,T,p,x,P){return this.radialGradientParams=Array.prototype.slice.call(arguments),this.colorCommand.radialGradient(s,f,c,w,T,p,x,P),this},this.cloneAll=function(s,f,c,w){var T=this.getBounds();n(T)&&(T={x:null,y:null,width:null,height:null});var p=this.cloneChildren(this.cloneProps(new t.Container(T.x,T.y,T.width,T.height,f,c,w)),s);return p.mouseChildren=!1,p.type=this.type,p}},t.extend(t.CustomShape,t.Container,null,"zimContainer",!1),t.Circle=function(e,r,i,l,a,s,f,c,w,T,p){var x="radius, color, borderColor, borderWidth, dashed, percent, percentClose, strokeObj, style, group, inherit",P;if(P=st(t.Circle,arguments,x,this))return P;De("51"),this.zimCustomShape_constructor(null,null,null,null,!1),this.type="Circle",this.group=T;var m=w===!1?{}:t.getStyle(this.type,this.group,p);n(e)&&(e=m.radius!=null?m.radius:50),n(a)&&(a=m.dashed!=null?m.dashed:!1),n(i)&&(i=m.borderColor!=null?m.borderColor:null),n(l)&&(l=m.borderWidth!=null?m.borderWidth:null),i<0||l<0?i=l=null:i!=null&&l==null&&(l=1),n(r)&&(r=m.color!=null?m.color:l>0?"rgba(0,0,0,0)":t.black),n(s)&&(s=m.percent!=null?m.percent:100),n(f)&&(f=m.percentClose!=null?m.percentClose:!0),n(c)&&(c=m.strokeObj!=null?m.strokeObj:{});var v=I(e,r,i,l,s);this.veeObj={radius:v[0],color:v[1],borderColor:v[2],borderWidth:v[3],percent:v[4]};function I(){return arguments}e=t.Pick.choose(e),r=t.Pick.choose(r),i=t.Pick.choose(i),l=t.Pick.choose(l),s=t.Pick.choose(s);var g=this;g._radius=e,g._color=r,g._borderColor=i,g._borderWidth=l,g._dashed=a,g._dashed&&!Array.isArray(g._dashed)&&(g._dashed=[10,10]);var E=this.shape=new Ne.Shape;this.addChild(E);var A=E.graphics;g.drawShape=function(){A.c(),g.colorCommand=A.f(g._color).command,g._color&&g._color.type&&g.specialColor(g.colorCommand,g._color,g),(n(g._borderWidth)||g._borderWidth>0)&&(!n(g._borderColor)||!n(g._borderWidth))&&(n(g._borderColor)&&(g._borderColor=t.black),g.borderColorCommand=A.s(g._borderColor).command,g._borderColor&&g._borderColor.type&&g.specialColor(g.borderColorCommand,g._borderColor,g),g.borderWidthCommand=A.ss(g._borderWidth,c.caps,c.joints,c.miterLimit,c.ignoreScale).command,g._dashed&&(g.borderDashedCommand=A.sd(Array.isArray(g._dashed)?g._dashed:[10,10],g._dashedOffset).command));var y=g._radius*2;if(typeof s=="number"&&s>=0&&s<100){var C=360*s/100/2;A.arc(0,0,g._radius,(-C-90)*Math.PI/180,(C-90)*Math.PI/180,!1),f&&A.cp(),y=g._radius-Math.cos(C*Math.PI/180)*g._radius}else A.dc(0,0,g._radius);g.setBounds(-g._radius,-g._radius,g._radius*2,y)},g.drawShape(),r.type&&(g.color=r),Object.defineProperty(g,"radius",{get:function(){return g._radius},set:function(y){g._radius=y,g.drawShape()}}),Object.defineProperty(g,"percentage",{get:function(){return s},set:function(y){s=y,g.drawShape()}}),Object.defineProperty(g,"percentClose",{get:function(){return f},set:function(y){f=y,g.drawShape()}}),w!==!1&&t.styleTransforms(this,m),this.clone=function(y){var C=g.cloneProps(new t.Circle(y||!t.isPick(v[0])?g.radius:v[0],y||!t.isPick(v[1])?g.color:v[1],y||!t.isPick(v[2])?g.borderColor:v[2],y||!t.isPick(v[3])?g.borderWidth:v[3],g.dashed,y||!t.isPick(v[4])?s:v[4],f,c,w,this.group,p));return g.linearGradientParams&&C.linearGradient.apply(C,g.linearGradientParams),g.radialGradientParams&&C.radialGradient.apply(C,g.radialGradientParams),C}},t.extend(t.Circle,t.CustomShape,"clone","zimCustomShape",!1),t.Rectangle=function(e,r,i,l,a,s,f,c,w,T,p,x){var P="width, height, color, borderColor, borderWidth, corner, dashed, strokeObj, scaleDimensions, style, group, inherit",m;if(m=st(t.Rectangle,arguments,P,this))return m;De("52"),this.zimCustomShape_constructor(null,null,null,null,!1),this.type="Rectangle",this.group=p;var v=T===!1?p!=null?t.getStyle(null,null,x,this.group):{}:t.getStyle(this.type,this.group,x);n(e)&&(e=v.width!=null?v.width:null),n(r)&&(r=v.height!=null?v.height:n(e)?100:e),n(e)&&(e=r),n(s)&&(s=v.corner!=null?v.corner:0),n(f)&&(f=v.dashed!=null?v.dashed:!1),n(l)&&(l=v.borderColor!=null?v.borderColor:null),n(a)&&(a=v.borderWidth!=null?v.borderWidth:null),l<0||a<0?l=a=null:l!=null&&a==null&&(a=1),n(i)&&(i=v.color!=null?v.color:a>0?"rgba(0,0,0,0)":t.black),n(c)&&(c=v.strokeObj!=null?v.strokeObj:{}),n(w)&&(w=v.scaleDimensions!=null?v.scaleDimensions:!0);var I=g(e,r,i,l,a);this.veeObj={width:I[0],height:I[1],color:I[2],borderColor:I[3],borderWidth:I[4]};function g(){return arguments}e=t.Pick.choose(e),r=t.Pick.choose(r),i=t.Pick.choose(i),l=t.Pick.choose(l),a=t.Pick.choose(a);var E=this;E._color=i,E._borderColor=l,E._borderWidth=a,E._dashed=f,E._dashed&&!Array.isArray(E._dashed)&&(E._dashed=[10,10]),E._corner=s,E.scaleDimensions=w,E.setWidth=function(C){e=C},E.setHeight=function(C){r=C};var A=this.shape=new Ne.Shape;this.addChild(A);var y=A.graphics;E.drawShape=function(){if(y.c(),E.colorCommand=y.f(E._color).command,i&&i.type&&E.specialColor(E.colorCommand,i,E),(n(E._borderWidth)||E._borderWidth>0)&&(!n(E._borderColor)||!n(E._borderWidth))&&(n(E._borderColor)&&(E._borderColor=t.black),E.borderColorCommand=y.s(E._borderColor).command,E._borderColor&&E._borderColor.type&&E.specialColor(E.borderColorCommand,E._borderColor,E),E.borderWidthCommand=y.ss(E._borderWidth,c.caps,c.joints,c.miterLimit,c.ignoreScale).command,E._dashed&&(E.borderDashedCommand=y.sd(Array.isArray(E._dashed)?E._dashed:[10,10],E._dashedOffset).command)),Array.isArray(E._corner)){var C=E._corner;Array.isArray(C)&&C.length==2&&(C=[C,C,C,C]);for(var L=[],Y=!1,_=0;_<C.length;_++)Array.isArray(C[_])?(Y=!0,L.push(C[_])):L.push([C[_],C[_]]);C=L,Y?y.mt(0,C[0][1]).curveTo(0,0,C[0][0],0).lt(e-C[1][0],0).curveTo(e,0,e,C[1][1]).lt(e,r-C[2][1]).curveTo(e,r,e-C[2][0],r).lt(C[3][0],r).curveTo(0,r,0,r-C[3][1]).cp():y.rc(0,0,e,r,E._corner[0],E._corner[1],E._corner[2],E._corner[3])}else E._corner>0?y.rr(0,0,e,r,E._corner):y.r(0,0,e,r);E.setBounds(0,0,e,r),i.type&&(E.color=i)},E.drawShape(),(T!==!1||p!=null)&&t.styleTransforms(this,v),this.clone=function(C,L){var Y=n(L)?T:L,_=E.cloneProps(new t.Rectangle(C||!t.isPick(I[0])?e:I[0],C||!t.isPick(I[1])?r:I[1],C||!t.isPick(I[2])?E.color:I[2],C||!t.isPick(I[3])?E.borderColor:I[3],C||!t.isPick(I[4])?E.borderWidth:I[4],s,E._dashed,c,E.scaleDimensions,Y,this.group,x));return _}},t.extend(t.Rectangle,t.CustomShape,"clone","zimCustomShape",!1),t.Triangle=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m){var v="a, b, c, color, borderColor, borderWidth, corner, center, adjust, dashed, strokeObj, style, group, inherit",I;if(I=st(t.Triangle,arguments,v,this))return I;De("53"),this.zimCustomShape_constructor(null,null,null,null,!1),this.type="Triangle",this.group=P;var g=x===!1?{}:t.getStyle(this.type,this.group,m);n(e)&&(e=g.a!=null?g.a:100),n(r)&&(r=g.b!=null?g.b:e),n(i)&&(i=g.c!=null?g.c:e),r==-1&&(r=Math.sqrt(Math.pow(e,2)+Math.pow(i,2))),i==-1&&(i=Math.sqrt(Math.pow(e,2)+Math.pow(r,2))),n(f)&&(f=g.corner!=null?g.corner:0),n(c)&&(c=g.center!=null?g.center:!0),n(w)&&(w=g.adjust!=null?g.adjust:0),n(a)&&(a=g.borderColor!=null?g.borderColor:null),n(s)&&(s=g.borderWidth!=null?g.borderWidth:null),a<0||s<0?a=s=null:a!=null&&s==null&&(s=1),n(l)&&(l=g.color!=null?g.color:s>0?"rgba(0,0,0,0)":t.black),n(w)&&(w=g.adjust!=null?g.adjust:0),n(p)&&(p=g.strokeObj!=null?g.strokeObj:{});var E=A(e,r,i,l,a,s);this.veeObj={a:E[0],b:E[1],c:E[2],color:E[3],borderColor:E[4],borderWidth:E[5]};function A(){return arguments}e=t.Pick.choose(e),r=t.Pick.choose(r),i=t.Pick.choose(i),this.a=e,this.b=r,this.c=i,l=t.Pick.choose(l),a=t.Pick.choose(a),s=t.Pick.choose(s);var y=this;y._color=l,y._borderColor=a,y._borderWidth=s,y._dashed=T,y._dashed&&!Array.isArray(y._dashed)&&(y._dashed=[10,10]),y._corner=f;var C=[e,r,i];C.sort(function(X,R){return R-X});var L=C[0],Y=C[1],_=C[2],k=[C.indexOf(e),C.indexOf(r),C.indexOf(i)];if(L>Y+_){tt("zim display - Triangle(): invalid triangle lengths");return}var $=this.shape=new Ne.Shape;this.adjusted=w,this.addChild($);var O=$.graphics;y.drawShape=function(){var X=[];Array.isArray(y._corner)?X=y._corner:X.push(y._corner,y._corner,y._corner);for(var R=0;R<3;R++)(X[R]<0||typeof X[R]!="number")&&(X[R]=0);O.c(),y.colorCommand=O.f(y._color).command,y._color&&y._color.type&&y.specialColor(y.colorCommand,y._color,y),(n(y._borderWidth)||y._borderWidth>0)&&(!n(y._borderColor)||!n(y._borderWidth))&&(n(y._borderColor)&&(y._borderColor=t.black),y.borderColorCommand=O.s(y._borderColor).command,y._borderColor&&y._borderColor.type&&y.specialColor(y.borderColorCommand,y._borderColor,y),y.borderWidthCommand=O.ss(y._borderWidth,p.caps,p.joints,p.miterLimit,p.ignoreScale).command,y._dashed&&(y.borderDashedCommand=O.sd(Array.isArray(y._dashed)?y._dashed:[10,10],y._dashedOffset).command)),y.one={x:0,y:0},y.two={x:e,y:0};var Q=Math.acos((Math.pow(Y,2)+Math.pow(_,2)-Math.pow(L,2))/(2*Y*_))*180/Math.PI,K=Math.asin(Y*Math.sin(Q*Math.PI/180)/L)*180/Math.PI,q=180-Q-K,ne=[Q,K,q];y.angles=[ne[k[1]],ne[k[2]],ne[k[0]]];var U=y.angles[1],D=Math.cos(U*Math.PI/180)*r,d=Math.sin(U*Math.PI/180)*r,u=Math.max(e,e-D),o=d;y.setBounds(0,w,u,o),$.y=o,y.three={x:e-D,y:0-d};var S=e*X[0]/(X[0]+X[1]||1);O.mt(S,0).at(e,0,e-D,0-d,X[1]).at(e-D,0-d,0,0,X[2]).at(0,0,e,0,X[0]).lt(S,0),O.cp(),c&&(y.regX=u/2,y.regY=o/2),w&&(y.shape.y+=w)},y.drawShape(),l.type&&(y.color=l),x!==!1&&t.styleTransforms(this,g),this.clone=function(X,R){var Q=n(R)?x:R,K=y.cloneProps(new t.Triangle(X||!t.isPick(E[0])?e:E[0],X||!t.isPick(E[1])?r:E[1],X||!t.isPick(E[2])?i:E[2],X||!t.isPick(E[3])?y.color:E[3],X||!t.isPick(E[4])?y.borderColor:E[4],X||!t.isPick(E[5])?y.borderWidth:E[5],f,c,w,T,p,Q,this.group,m));return y.linearGradientParams&&K.linearGradient.apply(K,y.linearGradientParams),y.radialGradientParams&&K.radialGradient.apply(K,y.radialGradientParams),K}},t.extend(t.Triangle,t.CustomShape,"clone","zimCustomShape"),t.Poly=function(e,r,i,l,a,s,f,c,w,T,p){var x="radius, sides, pointSize, color, borderColor, borderWidth, dashed, strokeObj, style, group, inherit",P;if(P=st(t.Poly,arguments,x,this))return P;De("53.1"),this.zimCustomShape_constructor(null,null,null,null,!1),this.type="Poly",this.group=T;var m=w===!1?{}:t.getStyle(this.type,this.group,p);n(e)&&(e=m.radius!=null?m.radius:50),n(r)&&(r=m.sides!=null?m.sides:5),n(i)&&(i=m.pointSize!=null?m.pointSize:0),n(f)&&(f=m.dashed!=null?m.dashed:!1),n(a)&&(a=m.borderColor!=null?m.borderColor:null),n(s)&&(s=m.borderWidth!=null?m.borderWidth:null),a<0||s<0?a=s=null:a!=null&&s==null&&(s=1),n(l)&&(l=m.color!=null?m.color:s>0?"rgba(0,0,0,0)":t.black),n(c)&&(c=m.strokeObj!=null?m.strokeObj:{});var v=I(e,r,i,l,a,s);this.veeObj={radius:v[0],sides:v[1],pointSize:v[2],color:v[3],borderColor:v[4],borderWidth:v[5]};function I(){return arguments}e=t.Pick.choose(e),r=t.Pick.choose(r),i=t.Pick.choose(i),l=t.Pick.choose(l),a=t.Pick.choose(a),s=t.Pick.choose(s);var g=this;g._radius=e,g._color=l,g._sides=r,g._pointSize=i,g._borderColor=a,g._borderWidth=s,g._dashed=f,g._dashed&&!Array.isArray(g._dashed)&&(g._dashed=[10,10]);var E=this.shape=new Ne.Shape;this.addChild(E),E.rotation=-90;var A=E.graphics;g.drawShape=function(){A.c(),g.colorCommand=A.f(g._color).command,g._color&&g._color.type&&g.specialColor(g.colorCommand,g._color,g),(n(g._borderWidth)||g._borderWidth>0)&&(!n(g._borderColor)||!n(g._borderWidth))&&(n(g._borderColor)&&(g._borderColor=t.black),g.borderColorCommand=A.s(g._borderColor).command,g._borderColor&&g._borderColor.type&&g.specialColor(g.borderColorCommand,g._borderColor,g),g.borderWidthCommand=A.ss(g._borderWidth,c.caps,c.joints,c.miterLimit,c.ignoreScale).command,g._dashed&&(g.borderDashedCommand=A.sd(Array.isArray(g._dashed)?g._dashed:[10,10],g._dashedOffset).command)),A.dp(0,0,g._radius,g._sides,g._pointSize),g.setBounds(-g._radius,-g._radius,g._radius*2,g._radius*2)},g.drawShape(),l.type&&(g.color=l),Object.defineProperty(g,"radius",{get:function(){return g._radius},set:function(y){g._radius=y,g.drawShape()}}),Object.defineProperty(g,"sides",{get:function(){return g._sides},set:function(y){g._sides=y,g.drawShape()}}),Object.defineProperty(g,"pointSize",{get:function(){return g._pointSize},set:function(y){g._pointSize=y,g.drawShape()}}),w!==!1&&t.styleTransforms(this,m),this.clone=function(y){var C=g.cloneProps(new t.Poly(y||!t.isPick(v[0])?g.radius:v[0],y||!t.isPick(v[1])?g.sides:v[1],y||!t.isPick(v[2])?g.pointSize:v[2],y||!t.isPick(v[3])?g.color:v[3],y||!t.isPick(v[4])?g.borderColor:v[4],y||!t.isPick(v[5])?g.borderWidth:v[5],g.dashed,c,w,this.group,p));return g.linearGradientParams&&C.linearGradient.apply(C,g.linearGradientParams),g.radialGradientParams&&C.radialGradient.apply(C,g.radialGradientParams),C}},t.extend(t.Poly,t.CustomShape,"clone","zimCustomShape",!1),t.Line=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v){var I="length, thickness, color, startHead, endHead, dashed, strokeObj, lineType, lineOrientation, curveH, curveV, points, style, group, inherit",g;if(g=st(t.Line,arguments,I,this))return g;De("53.15"),this.zimCustomShape_constructor(null,null,null,null,!1),this.type="Line",this.group=m;var E=P===!1?{}:t.getStyle(this.type,this.group,v);n(e)&&(e=E.length!=null?E.length:100),n(s)&&(s=E.dashed!=null?E.dashed:!1),n(r)&&(r=E.thickness!=null?E.thickness:3),n(i)&&(i=E.color!=null?E.color:t.black),n(l)&&(l=E.startHead!=null?E.startHead:null),n(a)&&(a=E.endHead!=null?E.endHead:null),n(f)&&(f=E.strokeObj!=null?E.strokeObj:{}),n(c)&&(c=E.lineType!=null?E.lineType:"straight"),c!=="corner"&&c!="curve"&&(c="straight"),n(w)&&(w=E.lineOrientation!=null?E.lineOrientation:"auto"),w!=="vertical"&&w!="horizontal"&&(w="auto"),n(T)&&(T=E.curveH!=null?E.curveH:20),n(p)&&(p=E.curveV!=null?E.curveV:20),n(f)&&(f=E.strokeObj!=null?E.strokeObj:{});var A=y(e,i,r,l,a);this.veeObj={length:A[0],color:A[1],thickness:A[2],startHead:A[3],endHead:A[4]};function y(){return arguments}e=t.Pick.choose(e),i=t.Pick.choose(i),r=t.Pick.choose(r),l=t.Pick.choose(l),a=t.Pick.choose(a),l&&l.clone&&(l=l.clone()),a&&a.clone&&(a=a.clone());var C=this;C._length=e,C._color=i,C._thickness=r,C._dashed=s,C._dashed&&!Array.isArray(C._dashed)&&(C._dashed=[10,10]),C._startX=0,C._startY=0,C._endX=e,C._endY=0,C._startHead=l,C._endHead=a,C._points=x,C._lineOrientation=w,C.angle=0,C.lineType=c,C._startHead&&L("start",C._startHead),C._endHead&&L("end",C._endHead);function L(k,$){if($=="triangle"||$=="arrow"){var O=C["_"+k+"Head"]=new t.Triangle(r*4,r*4,r*4,i);O.rotation=90}else $=="circle"&&(C["_"+k+"Head"]=new t.Circle(r*2.2,i));n(C["_"+k+"Head"].startAngle)&&(C["_"+k+"Head"].startAngle=C["_"+k+"Head"].rotation)}l=C._startHead,a=C._endHead,l&&l.type=="Triangle"&&(l.startRegY=l.regY),a&&a.type=="Triangle"&&(a.startRegY=a.regY);var Y=this.shape=new Ne.Shape;this.addChild(Y);var _=Y.graphics;C.drawShape=function(k,$){_.c(),C.colorCommand=_.s(C._color).command,i&&i.type&&C.specialColor(C.colorCommand,i,C),C.thicknessCommand=_.ss(C._thickness,f.caps,f.joints,f.miterLimit,f.ignoreScale).command,C._dashed&&(C.dashedCommand=_.sd(Array.isArray(C._dashed)?C._dashed:[10,10],C._dashedOffset).command);var O,X;if(C._points){var R=C._points[0];C._startX=R[0],C._startY=R[1];var Q=C._points[C._points.length-1],K=[Q[Q.length-2],Q[Q.length-1]];C._endX=K[0],C._endY=K[1],_.mt(R[0],R[1]);for(var q=1;q<C._points.length;q++){var ne=C._points[q];q==1&&(O=[C._startX,C._startY,ne[0],ne[1]]),ne.length==2?_.lt(ne[0],ne[1]):ne.length==4?_.qt(ne[0],ne[1],ne[2],ne[3]):ne.length==6&&_.bt(ne[0],ne[1],ne[2],ne[3],ne[4],ne[5])}if(ne.length>=4)X=[ne[ne.length-4],ne[ne.length-3],C._endX,C._endY];else{var U=C._points[C._points.length-2];X=[U[U.lenth-2],U[U.lenth-1],C._endX,C._endY]}}else{var D=C._startX,d=C._startY,u=C._endX,o=C._endY,S;if(C.lineType=="straight"?(l&&l.type=="Triangle"&&(l.regY=0,S=t.dist(D,d,u,o),S!=0&&(D=D+C._startHead.height/2*(u-D)/S),S!=0&&(d=d+C._startHead.height/2*(o-d)/S)),a&&a.type=="Triangle"&&(a.regY=0,S=t.dist(D,d,u,o),S!=0&&(u=u-C._endHead.height/2*(u-D)/S),S!=0&&(o=o-C._endHead.height/2*(o-d)/S))):(k?C._lineOrientation=="horizontal"||C.autoOrientation=="horizontal"?l&&l.type=="Triangle"&&(l.regY=0,u>D?D=Math.min(u,D+C._startHead.height/2):D=Math.max(u,D-C._startHead.height/2)):l&&l.type=="Triangle"&&(l.regY=0,o>d?d=Math.min(o,d+C._startHead.height/2):d=Math.max(o,d-C._startHead.height/2)):l&&l.type=="Triangle"&&(l.regY=l.startRegY),$?C._lineOrientation=="horizontal"||C.autoOrientation=="horizontal"?a&&a.type=="Triangle"&&(a.regY=0,u>D?u-=C._endHead.height/2:u+=C._endHead.height/2):a&&a.type=="Triangle"&&(a.regY=0,o>d?o-=C._endHead.height/2:o+=C._endHead.height/2):a&&a.type=="Triangle"&&(a.regY=a.startRegY)),C.lineType=="straight")_.mt(D,d).lt(u,o),O=X=[D,d,u,o];else if(C.lineType=="corner"){var F=D+(u-D)*.4,h=d+(o-d)*.4;C._lineOrientation=="auto"&&(C.autoOrientation=Math.abs(D-u)>Math.abs(d-o)?"horizontal":"vertical"),C._lineOrientation=="horizontal"||C.autoOrientation=="horizontal"?(O=X=[D,d,F,d],_.mt(D,d).lt(F,d).lt(F,o).lt(u,o)):(O=X=[D,d,D,h],_.mt(D,d).lt(D,h).lt(u,h).lt(u,o))}else{var b=D>u?-1:1,ye=d>o?-1:1,B=D,N=d,re=Math.abs(D-u),le=Math.abs(d-o),G=Math.min(T,re*.5),z=Math.min(p,le*.5);C._lineOrientation=="auto"&&(C.autoOrientation=Math.abs(D-u)>Math.abs(d-o)?"horizontal":"vertical");var se,Oe,J,pe;C._lineOrientation=="horizontal"||C.autoOrientation=="horizontal"?(se=le-z*2,Oe=(re-G*2)/2,_.mt(B,N),Oe>0&&(B=B+Oe*b,_.lt(B,N)),pe=N,N=N+z*ye,B=B+G*b,_.qt(B,pe,B,N),O=X=[D,d,B,d],se>0&&(N=N+se*ye,_.lt(B,N)),N=N+z*ye,J=B,B=B+G*b,_.qt(J,N,B,N),Oe>0&&(B=B+Oe*b,_.lt(B,N))):(se=re-G*2,Oe=(le-z*2)/2,_.mt(B,N),Oe>0&&(N=N+Oe*ye,_.lt(B,N)),J=B,B=B+G*b,N=N+z*ye,_.qt(J,N,B,N),O=X=[D,d,D,N],se>0&&(B=B+se*b,_.lt(B,N)),B=B+G*b,pe=N,N=N+z*ye,_.qt(B,pe,B,N),Oe>0&&(N=N+Oe*ye,_.lt(B,N)))}}if(C.setBounds(Math.min(C._startX,C._endX),Math.min(C._startY,C._endY),Math.abs(C._startX-C._endX),Math.abs(C._startY-C._endY)),C._length=Math.sqrt(Math.pow(C._startX-C._endX,2)+Math.pow(C._startY-C._endY,2)),C.angle=Math.atan2(C._endY-C._startY,C._endX-C._startX)*180/Math.PI,C._startHead&&C._startHead.loc){C._startHead.loc(C._startX,C._startY,C);var Z=Math.atan2(O[3]-O[1],O[2]-O[0])*180/Math.PI;C._startHead.rotation=Z-180+C._startHead.startAngle}if(C._endHead&&C._endHead.loc){C._endHead.loc(C._endX,C._endY,C);var de=Math.atan2(X[3]-X[1],X[2]-X[0])*180/Math.PI;C._endHead.rotation=de+C._endHead.startAngle}},C.drawShape(),i.type&&(C.color=i),this.setPoints=function(k,$,O,X,R,Q){return Array.isArray(k)&&n($)?(C.points=k,C):(k&&!n(k.x)?(C._startX=n(k.x)?C._startX:k.x,C._startY=n(k.y)?C._startY:k.y,$&&(C._endX=n($.x)?C._endX:$.x,C._endY=n($.y)?C._endY:$.y)):(C._startX=n(k)?C._startX:k,C._startY=n($)?C._startY:$,C._endX=n(O)?C._endX:O,C._endY=n(X)?C._endY:X),C.drawShape(R,Q),C)},this.from=function(k,$,O){n(O)&&(O=!0);var X,R;if(k&&k.parent&&C.parent&&O){var Q=k.parent.localToLocal(k.x,k.y,C.parent);X=Q.x,R=Q.y}return k&&!n(k.x)?(C._startX=n(X)?n(k.x)?C._startX:k.x:X,C._startY=n(R)?n(k.y)?C._startY:k.y:R):(C._startX=n(k)?C._startX:k,C._startY=n($)?C._startY:$),C.drawShape(),C},this.to=function(k,$,O){n(O)&&(O=!0);var X,R;if(k&&k.parent&&C.parent&&O){var Q=k.parent.localToLocal(k.x,k.y,C.parent);X=Q.x,R=Q.y}return k&&!n(k.x)?(C._endX=n(X)?n(k.x)?C._endX:k.x:X,C._endY=n(R)?n(k.y)?C._endY:k.y:R):(C._endX=n(k)?C._endX:k,C._endY=n($)?C._endY:$),C.drawShape(),C},Object.defineProperty(C,"length",{get:function(){return C._length},set:function(k){var $=C.length!=0?k/C.length:0;if(!isNaN($)){var O=C.scaleX,X=C.scaleY;C.scaleX*=$,C.scaleY*=$;var R=C.localToGlobal(C._startX,C._startY),Q=C.localToGlobal(C._endX,C._endY);C.scaleX=O,C.scaleY=X;var K=C.globalToLocal(R.x,R.y),q=C.globalToLocal(Q.x,Q.y);C.setPoints(K,q)}}}),Object.defineProperty(C,"startPoint",{get:function(){return new t.Point(C._startX,C._startY)},set:function(k){C._startX=n(k.x)?C._startX:k.x,C._startY=n(k.y)?C._startY:k.y,C.drawShape()}}),Object.defineProperty(C,"endPoint",{get:function(){return new t.Point(C._endX,C._endY)},set:function(k){C._endX=n(k.x)?C._endX:k.x,C._endY=n(k.y)?C._endY:k.y,C.drawShape()}}),Object.defineProperty(C,"startHead",{get:function(){return C._startHead},set:function(k){C._startHead=k,C.drawShape()}}),Object.defineProperty(C,"endHead",{get:function(){return C._endHead},set:function(k){C._endHead=k,C.drawShape()}}),Object.defineProperty(C,"startX",{get:function(){return C._startX},set:function(k){C._startX=k||0,C.drawShape()}}),Object.defineProperty(C,"startY",{get:function(){return C._startY},set:function(k){C._startY=k||0,C.drawShape()}}),Object.defineProperty(C,"endX",{get:function(){return C._endX},set:function(k){C._endX=k||0,C.drawShape()}}),Object.defineProperty(C,"endY",{get:function(){return C._endY},set:function(k){C._endY=k||0,C.drawShape()}}),Object.defineProperty(C,"points",{get:function(){return C._points},set:function(k){k&&(C._points=k,C.drawShape())}}),Object.defineProperty(C,"lineOrientation",{get:function(){return C._lineOrientation},set:function(k){k&&(C._lineOrientation=k,C.drawShape())}}),P!==!1&&t.styleTransforms(this,E),this.clone=function(k){var $=k||!t.isPick(A[3])?C._startHead:A[3];$&&$.clone&&($=$.clone(),$.rotation=C._startHead.startAngle);var O=k||!t.isPick(A[4])?C._endHead:A[4];O&&O.clone&&(O=O.clone(),O.rotation=C._endHead.startAngle);var X=C.cloneProps(new t.Line(k||!t.isPick(A[0])?C.length:A[0],k||!t.isPick(A[2])?C.thickness:A[2],k||!t.isPick(A[1])?C.color:A[1],$,O,C.dashed,f,c,C._lineOrientation,T,p,t.copy(x),P,this.group,v));return C.points?X.setPoints(C.points):X.setPoints(C._startX,C._startY,C._endX,C._endY),C.linearGradientParams&&X.linearGradient.apply(X,C.linearGradientParams),C.radialGradientParams&&X.radialGradient.apply(X,C.radialGradientParams),X}},t.extend(t.Line,t.CustomShape,"clone","zimCustomShape",!1),t.Squiggle=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$){var O="color, thickness, points, length, controlLength, controlType, lockControlType, showControls, lockControls, handleSize, allowToggle, move, dashed, onTop, circleColor, circleBorderColor, stickColor, stickThickness, selectColor, selectPoints, editPoints, interactive, strokeObj, style, group, inherit",X;if(X=st(t.Squiggle,arguments,O,this))return X;De("53.2"),this.group=k;var R=_===!1?{}:t.getStyle("Squiggle",this.group,$);if(n(r)&&(r=R.thickness!=null?R.thickness:6),n(l)&&(l=R.length!=null?R.length:300),n(i)&&(i=R.points!=null?R.points:5),typeof i=="string"){var Q=new t.SVGContainer;i=Q.processPath(i)}var K=typeof i!="number",q=typeof i=="number"?i:i.length;if(q==0)return;n(a)&&(a=R.controlLength!=null?R.controlLength:l/q),this.zimCustomShape_constructor(l,a,null,null,!1),this.type="Squiggle",this.mouseChildren=!0,n(P)&&(P=R.dashed!=null?R.dashed:!1),n(e)&&(e=R.color!=null?R.color:t.blue),e.style&&(this.colorCommand=e,e=t.black),n(s)&&(s=R.controlType!=null?R.controlType:null);var ne=s;n(s)&&(s="mirror"),n(f)&&(f=R.lockControlType!=null?R.lockControlType:!1),n(L)&&(L=R.interactive!=null?R.interactive:!0),n(c)&&(c=R.showControls!=null?R.showControls:L);var U=c;n(w)&&(w=R.lockControls!=null?R.lockControls:!L),n(T)&&(T=R.handleSize!=null?R.handleSize:t.mobile()?20:10),n(p)&&(p=R.allowToggle!=null?R.allowToggle:L),n(x)&&(x=R.move!=null?R.move:L),n(v)&&(v=R.circleColor!=null?R.circleColor:t.light),n(I)&&(I=R.circleBorderColor!=null?R.circleBorderColor:t.dark),n(g)&&(g=R.stickColor!=null?R.stickColor:t.darker),n(E)&&(E=R.stickThickness!=null?R.stickThickness:1),n(A)&&(A=R.selectColor!=null?R.selectColor:t.white),n(y)&&(y=R.selectPoints!=null?R.selectPoints:L),this.circleColor=v,this.circleBorderColor=I,this.stickColor=g,this.stickThickness=E,n(m)&&(m=R.onTop!=null?R.onTop:!0),n(C)&&(C=R.editPoints!=null?R.editPoints:L),n(Y)&&(Y=R.strokeObj!=null?R.strokeObj:{});var D=d(e);this.veeObj={color:D[0]};function d(){return arguments}e=t.Pick.choose(e);var u=this,o;this.types=["mirror","straight","free","none"],this.interactive=L,this.num=q,this.onTop=m,this.move=x,this.editPoints=C,this.allowToggle=p,this.lockControlType=f,this.selectPoints=y,this.lockControls=w;var S,F,h;u._color=e,u._thickness=r,u._dashed=P,u._dashed&&!Array.isArray(u._dashed)&&(u._dashed=[10,10]);var b,ye,B,N,re=u.move,le=2,G,z;ne&&typeof i!="number"&&t.loop(i,function(oe){oe[8]=ne,ne=="none"&&(oe[4]=oe[5]=oe[6]=oe[7]=0)}),se();function se(){z&&z.removeAllEventListeners(),u.num=q=typeof i=="number"?i:i.length,q=Math.max(2,q),a=l/q,b=u.shape=new t.Shape({style:!1}).addTo(u);var oe=u.sticks=new t.Shape({style:!1}).addTo(u);T<=0&&oe.removeFrom();var Ce=b.graphics;Ce.c();var Me=oe.graphics;Me.c();var te=T/10*8,ae=T;u.selectPoints?(u.selectedBalls=new t.SelectionSet,u.selectedRect1s=new t.SelectionSet,u.selectedRect2s=new t.SelectionSet,u.selectionManager=new t.SelectionManager([u.selectedBalls,u.selectedRect1s,u.selectedRect2s],"ctrl",!1)):u.selectionManager=new t.SelectionManager(null,"ctrl");var we=t.mobile();z=u.controls=new t.Container({style:!1}).addTo(u),u.interactive&&z.drag({onTop:!we}),S=[],h=[],F=[];var ue,Pe,ie,be,Le,me,ee,Ie,Re;for(ue=0;ue<q;ue++){if(be=new t.Container({style:!1}).addTo(z),be.num=ue,typeof i=="number"){var _e=t.Pick.choose(a);ie=new t.Container(_e,r,null,null,!1).addTo(u).loc({x:ue*l/(q-1)-_e/2,y:ue%2*_e}),ee=new t.Circle(te,u.selectPoints&&u.selectedBalls.isSelected(ue)?A:u.circleColor,u.circleBorderColor,2,null,null,null,null,!1).centerReg(ie).loc({x:_e/2,y:0}),Le=new t.Rectangle(ae,ae,u.selectPoints&&u.selectedRect1s.isSelected(ue)?A:xe(s),T==0?null:t.dark,T==0?null:2,null,null,null,null,!1).centerReg(ie).loc({x:0,y:0}),me=new t.Rectangle(ae,ae,u.selectPoints&&u.selectedRect2s.isSelected(ue)?A:xe(s),T==0?null:t.dark,T==0?null:2,null,null,null,null,!1).centerReg(ie).loc({x:_e,y:0});var Ze=ie.localToLocal(ee.x,ee.y,z);ee.x=Ze.x,ee.y=Ze.y,ee.addTo(be,null,!1);var at=ie.localToLocal(Le.x,Le.y,z);Le.x=s=="none"?0:at.x-ee.x,Le.y=s=="none"?0:at.y-ee.y,Le.addTo(be,null,!1);var Be=ie.localToLocal(me.x,me.y,z);me.x=s=="none"?0:Be.x-ee.x,me.y=s=="none"?0:Be.y-ee.y,me.addTo(be,null,!1),be.x=ee.x,be.y=ee.y,ee.x=0,ee.y=0,s=="none"&&ee.addTo(be,null,!1)}else Re=i[ue],Ie=Re[8]?Re[8]:s,be.loc({x:Re[0],y:Re[1]}),ee=new t.Circle(te,u.circleColor,u.circleBorderColor,2,null,null,null,null,!1).centerReg({add:!1}).addTo(be).loc({x:Re[2],y:Re[3]}),Le=new t.Rectangle(ae,ae,xe(Ie),T==0?null:t.dark,T==0?null:2,null,null,null,null,!1).centerReg({add:!1}).addTo(be,0).loc({x:Re[4],y:Re[5]}),me=new t.Rectangle(ae,ae,xe(Ie),T==0?null:t.dark,T==0?null:2,null,null,null,null,!1).centerReg({add:!1}).addTo(be,0).loc({x:Re[6],y:Re[7]});ee.mySet=be,ee.rect1=Le,ee.rect2=me,ee.index=ue,we?ee.on("mousedown",et):ee.on("dblclick",ge),Le.ball=ee,Le.other=me,me.ball=ee,me.other=Le,T==0&&(ee.expand(10),Le.expand(10),me.expand(10)),we&&(ee.expand(),Le.expand(),me.expand()),Pe=[be,ee,Le,me,Re?Re[8]:s],S.push(Pe),F.push(ee),h.push(be)}var He=!1;function et(ce){He?(ce.preventDefault(),ge(ce)):(He=!0,setTimeout(function(){He=!1},300))}function ge(ce){if(!u.lockControlType){var Ve=ce.target,Se=S[Ve.index][4]?S[Ve.index][4]:s;Math.abs(Ve.rect1.x)<=2&&Math.abs(Ve.rect1.y)<=2&&Math.abs(Ve.rect2.x)<=2&&Math.abs(Ve.rect2.y)<=2&&(Se="none"),Se=="none"&&Ve.parent.addChildAt(Ve,0),Se=u.types[(u.types.indexOf(Se)+(u.shiftKey?-1:1)+u.types.length)%u.types.length],Se=="none"&&(Ve.rect1.x=Ve.rect1.y=Ve.rect2.x=Ve.rect2.y=0,Ve.parent.addChild(Ve),ce.stopImmediatePropagation()),S[Ve.index][4]=Se,Ve.rect1.color=xe(Se),Ve.rect2.color=xe(Se),u.drawShape(),e.type&&(u.color=e);var Ae=new Ne.Event("change");Ae.controlType="bezierSwitch",u.dispatchEvent(Ae),Ve.stage.update()}}function xe(ce){var Ve={straight:"#e472c4",free:"#ebcb35",none:"#50c4b7"};return Ve[ce]?Ve[ce]:"#993399"}var he=t.mobile();u.drawShape=function(){Ce.c();var ce=he?10:6,Ve,Se,Ae,Ye,Xe,Ue,rt,Te,$e,lt,Qe,ot,ft,ut,ze;if(r<ce)for(Ce.s("rgba(0,0,0,.01)").ss(ce),Ye=S[0][0],$e=Ye.localToLocal(S[0][1].x,S[0][1].y,b),Ce.mt($e.x,$e.y),Ve=0;Ve<S.length;Ve++)Se=Ve,Ae=(Ve+1)%S.length,Ye=S[Se][0],Xe=S[Se][1],Ue=S[Se][2],rt=S[Se][3],Te=S[Ae][0],lt=S[Ae][1],Qe=S[Ae][2],ft=Ye.localToLocal(rt.x,rt.y,b),ut=Te.localToLocal(Qe.x,Qe.y,b),ze=Te.localToLocal(lt.x,lt.y,b),Ve!=S.length-1&&Ce.bt(ft.x,ft.y,ut.x,ut.y,ze.x,ze.y);for(u.colorCommand||(u.colorCommand=Ce.s(u._color).command,e&&e.type&&u.specialColor(u.colorCommand,e,u)),u.thicknessCommand||(u.thicknessCommand=Ce.ss(u._thickness,Y.caps,Y.joints,Y.miterLimit,Y.ignoreScale).command),u._dashed&&(u.dashedCommand||(u.dashedCommand=Ce.sd(Array.isArray(u._dashed)?u._dashed:[10,10],u._dashedOffset).command)),Ye=S[0][0],$e=Ye.localToLocal(S[0][1].x,S[0][1].y,b),Ce.mt($e.x,$e.y),Me.c().s(u.stickColor).ss(u.stickThickness),Ve=0;Ve<S.length;Ve++)Se=Ve,Ae=(Ve+1)%S.length,Ye=S[Se][0],Xe=S[Se][1],Ue=S[Se][2],rt=S[Se][3],Te=S[Ae][0],lt=S[Ae][1],Qe=S[Ae][2],ft=Ye.localToLocal(rt.x,rt.y,b),ut=Te.localToLocal(Qe.x,Qe.y,b),ze=Te.localToLocal(lt.x,lt.y,b),Ve!=S.length-1&&Ce.bt(ft.x,ft.y,ut.x,ut.y,ze.x,ze.y),$e=Ye.localToLocal(Xe.x,Xe.y,b),ot=Ye.localToLocal(Ue.x,Ue.y,b),Ve==0&&(Ue.visible=0),Ve!=0&&Me.mt($e.x,$e.y).lt(ot.x,ot.y),Ve!=S.length-1&&Me.mt($e.x,$e.y).lt(ft.x,ft.y),Ve==S.length-1&&(rt.visible=0);u._dashed&&Ce.append(u.dashedCommand),Ce.append(u.thicknessCommand),Ce.append(u.colorCommand)},u.drawShape(),e.type&&(u.color=e);var Ge;z.on("mousedown",function(ce){if(o=ce.target.stage,!u.lockControls){if(u.selectPoints&&(u.keyFocus=!0),Ge={x:ce.target.x,y:ce.target.y},ce.target.rect1)ee=ce.target,ee.startX=ee.x,ee.startY=ee.y,ee.rect1.startX=ee.rect1.x,ee.rect1.startY=ee.rect1.y,ee.rect2.startX=ee.rect2.x,ee.rect2.startY=ee.rect2.y;else{var Ve=ce.target;Ve.startX=Ve.x,Ve.startY=Ve.y,ee=Ve.ball;var Se=ee.index,Ae=s;if(n(S[Se][4])||(Ae=S[Se][4]),Ae=="straight"){var Ye=Ve.other,Xe=Ye.x-ee.x,Ue=Ye.y-ee.y;Ye.stickLength=Math.sqrt(Math.pow(Xe,2)+Math.pow(Ue,2))}}if(u.selectPoints){var rt=u.selectionManager.currentSet;if(rt&&rt.selections&&rt.selections.length>0)for(ue=0;ue<rt.selections.length;ue++){var Te=u.pointObjects[rt.selections[ue]];Te[1].startX=Te[1].x,Te[1].startY=Te[1].y,Te[2].startX=Te[2].x,Te[2].startY=Te[2].y,Te[3].startX=Te[3].x,Te[3].startY=Te[3].y}}}}),u.selectPoints&&z.tap(function(ce){if(ce.target.rect1){var Ve=ce.target;u.selectedBalls.toggle(Ve.parent.num)}else{var Se=ce.target;Se.color="white",Ve=Se.ball,Ve.rect1==Se?u.selectedRect1s.toggle(Ve.parent.num):u.selectedRect2s.toggle(Ve.parent.num)}for(ue=0;ue<u.pointObjects.length;ue++){var Ae=u.pointObjects[ue];Ae[1].color=u.selectedBalls.isSelected(ue)?A:u.circleColor,Ae[2].color=u.selectedRect1s.isSelected(ue)?A:xe(Ae[4]),Ae[3].color=u.selectedRect2s.isSelected(ue)?A:xe(Ae[4])}o.update()}),z.on("pressmove",function(ce){if(!u.lockControls)if(u.selectPoints){var Ve=Oe();if(Ve.indexOf(ce.target)==-1)G(ce.target),u.drawShape();else if(Ve.length>0){for(var Se=ce.target.x-ce.target.startX,Ae=ce.target.y-ce.target.startY,Ye=0;Ye<Ve.length;Ye++){var Xe=Ve[Ye];Xe.x=Xe.startX+Se,Xe.y=Xe.startY+Ae,G(Xe)}u.drawShape()}}else G(ce.target),u.drawShape()}),z.on("pressup",function(ce){if(!u.lockControls){var Ve=ce.target.x!=Ge.x||ce.target.y!=Ge.y,Se=new Ne.Event("change");ce.target.rect1?(Se.controlType="bezierPoint",qe(ce.target)):Se.controlType="bezierHandle",Ve&&u.dispatchEvent(Se)}});function qe(ce){if(u.selectPoints){var Ve=Oe();if(Ve&&Ve.indexOf(ce)==-1)J(ce);else if(Ve&&Ve.length>0)for(var Se=0;Se<Ve.length;Se++)J(Ve[Se]);else J(ce)}else J(ce)}u.changeControl=function(ce,Ve,Se,Ae,Ye,Xe,Ue,rt,Te){var $e="index, type, rect1X, rect1Y, rect2X, rect2Y, circleX, circleY, update",lt;if(lt=st(u.changeControl,arguments,$e))return lt;if(n(ce)){for(ue=0;ue<S.length;ue++)u.changeControl(ue,Ve,Se,Ae,Ye,Xe,Ue,rt);return}var Qe=S[ce];Qe[4]=Ve,Ve=="none"?(n(Ue)||(Qe[2].x=Ue),n(rt)||(Qe[2].y=rt),Qe[2].x=Qe[1].x,Qe[2].y=Qe[1].y,Qe[3].x=Qe[1].x,Qe[3].y=Qe[1].y,Qe[1].parent.addChild(Qe[1])):(n(Se)||(Qe[2].x=Se),n(Ae)||(Qe[2].y=Ae),n(Ye)||(Qe[3].x=Ye),n(Xe)||(Qe[3].y=Xe),n(Ue)||(Qe[1].x=Ue),n(rt)||(Qe[1].y=rt),Qe[1].parent.addChildAt(Qe[1],0)),Te&&(u.update(),o&&o.update())},u.transformPoints=function(ce,Ve,Se,Ae,Ye){return n(Ye)&&(Ye=!0),u.points=t.transformPoints(u.points,ce,Ve,Se,Ae),Ye&&u.approximateBounds(),u},u.traverse=function(ce,Ve,Se,Ae,Ye){var Xe=t.copy(u.segmentRatios);Xe.unshift(0),n(Se)&&(Se=Ve+1);var Ue=Xe[Ve]*100,rt=Xe[Se]*100,Te;!Ye&&Ue>rt?Te=100-Ue+rt:!Ye&&Ue<rt?Te=rt-Ue:Ye&&Ue>rt?Te=-(Ue-rt):Ye&&Ue<rt&&(Te=-(100-rt+Ue));var $e=new Ne.Event("traversed");return $e.obj=ce,ce.animate({ease:"linear",props:{path:u,startPercent:Ue,percent:Te},time:Ae,call:function(){u.dispatchEvent($e)}}),u},u.reversePoints=function(){return i=t.copy(u.points),u.points=t.reversePoints(t.copy(u.points)),u.update(),u},u.appendPoints=function(ce,Ve){var Se=t.copy(u.points);return u.points=t.appendPoints(Se,ce,Ve),u.update(),u},u.prependPoints=function(ce,Ve){var Se=t.copy(u.points);return u.points=t.rependPoints(Se,i,Ve),u.update(),u},u.splitPoints=function(ce){var Ve=t.copy(u.points);if(!(ce<1||ce>Ve.length-1)){var Se=t.splitPoints(Ve,ce),Ae=Se[0],Ye=Se[1],Xe=u.clone();return u.points=Ae,u.update(),Xe.points=Ye,u.parent&&Xe.addTo(u.parent),Xe}},u.makeBlob=function(ce,Ve){n(ce)&&(ce="mirror"),n(Ve)&&(Ve=5);var Se=t.copy(u.points);t.loop(Se,function(Ye,Xe,Ue){Ye[8]||(Ye[8]="mirror"),Xe==0&&(ce=="free"&&(Ye[4]=Ye[5]=0),Ye[8]=ce),Xe==Ue-1&&(ce=="free"&&(Ye[6]=Ye[7]=0),Ye[8]=ce)}),Math.abs(Se[0][0]-Se[Se.length-1][0])<Ve&&Math.abs(Se[0][1]-Se[Se.length-1][1])<Ve&&(Se[0][4]=Se[Se.length-1][4],Se[0][5]=Se[Se.length-1][5],Se.pop());var Ae=new t.Blob({points:Se,borderColor:u.color,borderWidth:u.thickness,showControls:u.controlsVisible,interactive:u.interactive,onTop:u.onTop,dashed:u.dashed,stickColor:u.stickColor,stickThickness:u.stickThickness});return Ae},u.update=function(ce){return ce?u.points=u.pointsAdjusted:u.drawShape(),u.zimAnimateChanged=!0,u},u.interactive&&(x&&b.drag({onTop:!1}),ye=b.on("mousedown",function(ce){o=ce.target.stage,Ge={x:b.x,y:b.y},u.selectPoints&&(u.keyFocus=!0),Fe()}),B=b.on("pressmove",function(){z.x=b.x,z.y=b.y,oe.x=b.x,oe.y=b.y}),N=b.on("pressup",function(){var ce=b.x!=Ge.x||b.y!=Ge.y,Ve=b.localToLocal(u.regX,u.regY,u.parent);if(u.x=Ve.x,u.y=Ve.y,z.x=z.y=oe.x=oe.y=b.x=b.y=0,ce){var Se=new Ne.Event("change");Se.controlType="move",u.dispatchEvent(Se)}o&&o.update()}),u.move||Z(!0));function Fe(){if(u.onTop){var ce=u.parent.numChildren-1;u.parent.getChildAt(ce).type=="Keyboard"&&ce--,u.parent.setChildIndex(u,ce)}}u.toggleEvent=u.on("mousedown",function(){u.allowToggle&&(U||(u.showControls(),u.dispatchEvent("controlsshow")))}),u.added(function(){o=u.stage,u.toggleStageEvent&&o.off("stagemousedown",u.toggleStageEvent),u.toggleStageEvent=o.on("stagemousedown",function(ce){!u.allowToggle||!u.stage||U&&!u.hitTestPoint(ce.stageX/t.scaX,ce.stageY/t.scaY,!1)&&(u.hideControls(),u.dispatchEvent("controlshide"))})}),u.clickEvent=u.on("click",function(){u.ctrlKey&&setTimeout(function(){u.clone(!0).addTo(u.stage).mov(0,100),u.allowToggle&&(u.hideControls(),u.dispatchEvent("controlshide"));var ce=new Ne.Event("change");ce.controlType="move",u.dispatchEvent(ce),u.stage.update()},50)}),u.hideControls=function(){return u.toggled=!1,z.visible=!1,oe.visible=!1,U=!1,u.stage&&u.stage.update(),!u.allowToggle&&u.move&&Z(),u},c||u.hideControls(),u.showControls=function(){return u.toggled=!0,z.visible=!0,oe.visible=!0,U=!0,z.x=b.x,z.y=b.y,oe.x=b.x,oe.y=b.y,u.addChildAt(b,0),u.move&&!u.allowToggle&&pe(),u.stage&&u.stage.update(),u},u.toggle=function(ce){return ce===!0?u.showControls():ce===!1||U?u.hideControls():u.showControls(),u},u.recordData=function(ce){n(ce)&&(ce=!1);var Ve={type:"Squiggle",index:u.parent?u.parent.getChildIndex(u):-1,x:u.x,y:u.y,points:u.getPoints(),color:u.color,thickness:u.thickness,move:u.move,allowToggle:u.allowToggle,controlsVisible:U};return ce?JSON.stringify(Ve):Ve},u.setData=function(ce,Ve){if(!n(ce)){if(Ve)try{ce=JSON.parse(ce)}catch{return}var Se=ce.index;n(Se)&&(Se=-1),delete ce.index;var Ae=ce.points;n(Ae)||u.setPoints(Ae),delete ce.points,u.num=Ae.length;for(var Ye in ce)u[Ye]=ce[Ye];return u.parent&&u.parent.setChildIndex(u,Se),u.update(),u}},u.getPoints=function(ce){n(ce)&&(ce=!1);var Ve=u.points;if(ce){if(!u.pane){var Se=u.pane=new t.Pane({container:u.stage,width:Math.min(500,u.stage.width-20),height:Math.min(500,u.stage.height-20),draggable:!0}),Ae=u.textArea=new t.TextArea(Math.min(400,u.stage.width-70),Math.min(400,u.stage.height-70));Ae.centerReg(Se)}u.textArea.text=JSON.stringify(Ve),u.pane.show()}return Ve},u.recordPoints=u.getPoints,u.setPoints=function(ce){for(var Ve,Se,Ae=0;Ae<ce.length;Ae++)Ve=S[Ae],Se=ce[Ae],!n(Ve)&&(Ve[0].x=Se[0],Ve[0].y=Se[1],Ve[1].x=Se[2],Ve[1].y=Se[3],Ve[2].x=Se[4],Ve[2].y=Se[5],Ve[3].x=Se[6],Ve[3].y=Se[7],Ve[4]=Se[8]);return u.update(),u},_!==!1&&t.styleTransforms(u,R),u.clone=function(ce,Ve){var Se=[],Ae=!1;t.loop(u.pointControls,function(Xe){Xe.scaleX+Xe.scaleY+Xe.regX+Xe.regY+Xe.rotation!=2&&(Ae=!0),Se.push([Xe.scaleX,Xe.scaleY,Xe.regX,Xe.regY,Xe.rotation])});var Ye=u.cloneProps(new t.Squiggle(Ve?u.colorCommand:ce||!t.isPick(D[0])?u.color:D[0],u.thickness,u.getPoints(),l,a,s,f,z.visible,w,T,u.allowToggle,u.move,P,m,u.circleColor,u.circleBorderColor,u.stickColor,u.stickThickness,A,y,u.editPoints,L,Y,_,u.group,$));return Ae&&(t.loop(Ye.pointControls,function(Xe,Ue){Xe.scaleX=Se[Ue][0],Xe.scaleY=Se[Ue][1],Xe.regX=Se[Ue][2],Xe.regY=Se[Ue][3],Xe.rotation=Se[Ue][4]}),Ye.update()),u.linearGradientParams&&Ye.linearGradient.apply(Ye,u.linearGradientParams),u.radialGradientParams&&Ye.radialGradient.apply(Ye,u.radialGradientParams),Ye},u.shape.on("mousedown",function(ce){o=ce.target.stage,u.editPoints&&(u.controlsVisible?(u.pressX=ce.stageX/t.scaX,u.pressY=ce.stageY/t.scaX):(u.pressX=null,u.pressY=null))}),u.addPointFactor=10,u.addMinDistance=15,u.shape.on("pressup",function(ce){if(u.editPoints&&u.pressX&&Math.abs(u.pressX-ce.stageX/t.scaX)<le&&Math.abs(u.pressY-ce.stageY/t.scaY)<le){u.selectPoints&&(u.lastPoints=t.copy(u.points));var Ve=u.points,Se=u.globalToLocal(ce.stageX/t.scaX,ce.stageY/t.scaY),Ae=t.closestPointAlongCurve(Se,u.segmentPoints);if(u.editPoints=="anywhere")Ve.splice(Ae+1,0,[Se.x,Se.y,0,0,0,0,0,0]),u.points=Ve,u.changeControl({index:Ae+1,type:"mirror",update:!0});else{var Ye=u.pointsAdjusted,Xe=u.getSegmentPoint(Ye[Ae],Ye[(Ae+1)%Ye.length]),Ue=t.distanceAlongCurve(Xe),rt=Math.round(Ue/u.addPointFactor),Te=u.interpolate(rt,Ae,!1,Ve),$e=1e4,lt;if(t.loop(Te,function(ut,ze){var kt=t.dist(ut,Se);kt<$e&&($e=kt,lt=ze)}),$e<u.addMinDistance){var Qe=u.segmentRatios,ot=Qe[Ae],ft=Ae>0?Qe[Ae-1]:0;u.addPoint(100*(ft+(ot-ft)*(lt/(rt+1))))}}u.lastSelectedIndex=Ae+1,u.lastSelected=u.controls.getChildAt(u.lastSelectedIndex),u.stage.update()}}),u.controls.on("click",function(ce){u.lastSelected=ce.target.parent,u.lastSelectedIndex=u.controls.getChildIndex(ce.target.parent),u.editPoints&&u.selectionManager.shiftKey&&We(ce)});function We(ce){if(ce.target.type=="Circle"){var Ve=u.lastSelectedIndex=u.controls.getChildIndex(ce.target.parent);if(u.controls.numChildren<=2)return;var Se=u.points;u.selectPoints&&(u.lastPoints=t.copy(Se)),Se.splice(Ve,1),u.points=Se,u.stage.update(),u.lastSelected=u.lastSelectedIndex=null}}u.controls.hold(We),U||u.hideControls(),u.dispatchEvent("update")}function Oe(){var oe=[],Ce=u.selectionManager.currentSet;if(Ce&&Ce.selections&&Ce.selections.length>0)for(var Me=0;Me<Ce.selections.length;Me++){var te=u.pointObjects[Ce.selections[Me]];if(Ce==u.selectedBalls)oe.push(te[1]);else if(Ce==u.selectedRect1s)oe.push(te[2]);else if(Ce==u.selectedRect2s)oe.push(te[3]);else continue}return oe}function J(oe){if(oe.type=="Circle"){var Ce=oe,Me=Ce.mySet,te=Ce.rect1,ae=Ce.rect2;te.x-=Ce.x,te.y-=Ce.y,ae.x-=Ce.x,ae.y-=Ce.y,Me.x+=Ce.x,Me.y+=Ce.y,Ce.x=0,Ce.y=0}}u.selectionManager.on("keydown",function(oe){if(u.selectPoints&&u.keyFocus&&oe.keyCode>=37&&oe.keyCode<=40){var Ce=Oe();if(Ce.length>0){for(var Me=0;Me<Ce.length;Me++){var te=Ce[Me];oe.keyCode==37?te.x-=u.selectionManager.shiftKey?10:1:oe.keyCode==39?te.x+=u.selectionManager.shiftKey?10:1:oe.keyCode==38?te.y-=u.selectionManager.shiftKey?10:1:oe.keyCode==40&&(te.y+=u.selectionManager.shiftKey?10:1),G(te)}u.drawShape(),u.dispatchEvent("update"),u.stage&&u.stage.update()}}}),u.selectionManager.on("keyup",function(oe){if(u.selectPoints&&u.keyFocus&&oe.keyCode>=37&&oe.keyCode<=40){var Ce=Oe();if(Ce.length>0)for(var Me=0;Me<Ce.length;Me++)J(Ce[Me])}}),u.selectionManager.on("undo",function(){if(u.selectPoints&&u.keyFocus&&u.lastPoints){var oe=t.copy(u.lastPoints);u.lastPoints=t.copy(u.points),u.points=oe,u.stage&&u.stage.update()}}),G=function(oe){if(!u.lockControls){var Ce;if(oe.rect1){Ce=oe;var Me=Ce.x-Ce.startX,te=Ce.y-Ce.startY;Ce.rect1.x=Ce.rect1.startX+Me,Ce.rect1.y=Ce.rect1.startY+te,Ce.rect2.x=Ce.rect2.startX+Me,Ce.rect2.y=Ce.rect2.startY+te}else{var ae=oe,we=ae.other;Ce=ae.ball;var ue=Ce.index,Pe=s;if(n(S[ue][4])||(Pe=S[ue][4]),Pe=="straight"||Pe=="mirror"){var ie=ae.x-Ce.x,be=ae.y-Ce.y;if(Pe=="mirror")we.x=Ce.x-ie,we.y=Ce.y-be;else{var Le=Math.atan2(be,ie),me=-we.stickLength*Math.cos(Le+Math.PI),ee=-we.stickLength*Math.sin(Le+Math.PI);we.x=Ce.x-me,we.y=Ce.y-ee}}}}},Object.defineProperty(u,"move",{get:function(){return x},set:function(oe){x!=oe&&(x=oe,oe?pe():Z())}}),Object.defineProperty(u,"interactive",{get:function(){return L},set:function(oe){L=oe,U=L,u.allowToggle=L,u.editPoints=L,u.lockControls=!L,u.selectPoints=L,u.move=L;var Ce=u.points;u.points=Ce}}),Object.defineProperty(u,"allowToggle",{get:function(){return p},set:function(oe){p!=oe&&(p=oe,p?u.move&&pe():!U&&u.move&&Z())}});function pe(){u.move!="always"&&(re||(re=!0,b.drag({onTop:!1}),ye=b.on("mousedown",ye),B=b.on("pressmove",B),N=b.on("pressup",N)))}function Z(oe){u.move!="always"&&(!oe&&!re||(re=!1,b.noDrag(),b.off("mousedown",ye),b.off("pressmove",B),b.off("pressup",N)))}var de=w;Object.defineProperty(u,"lockControls",{get:function(){return de},set:function(oe){de=oe,oe?(u.controls.mouseChildren=!1,u.controls.mouseEnabled=!1):(u.controls.mouseChildren=!0,u.controls.mouseEnabled=!0)}}),u.lockControls=de,Object.defineProperty(u,"controlsVisible",{get:function(){return U},set:function(oe){U=oe,oe?u.showControls():u.hideControls()}}),j.KEYFOCUS!=null&&(t.KEYFOCUS=j.KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return t.KEYFOCUS==u},set:function(){t.KEYFOCUS=u}}),t.KEYFOCUS||V();function V(){if(u.selectPoints){u.keyFocus=!0;var oe=document.activeElement;oe&&oe.blur()}}Object.defineProperty(u,"points",{get:function(){for(var oe=[],Ce,Me,te=0;te<S.length;te++)Me=S[te],Ce=[t.decimals(Me[0].x),t.decimals(Me[0].y),t.decimals(Me[1].x),t.decimals(Me[1].y),t.decimals(Me[2].x),t.decimals(Me[2].y),t.decimals(Me[3].x),t.decimals(Me[3].y)],Me[4]&&Me[4]!=="mirror"&&Ce.push(Me[4]),oe.push(Ce);return oe},set:function(oe){var Ce=u.x,Me=u.y,te=u.visible,ae=[],we=!1;t.loop(u.pointControls,function(ue){ue.scaleX+ue.scaleY+ue.regX+ue.regY+ue.rotation!=2&&(we=!0),ae.push([ue.scaleX,ue.scaleY,ue.regX,ue.regY,ue.rotation])}),u.dispose(!0),i=oe,se(),u.lockControls=de,u.x=Ce,u.y=Me,u.visible=te,we&&(t.loop(u.pointControls,function(ue,Pe){ue.scaleX=ae[Pe][0],ue.scaleY=ae[Pe][1],ue.regX=ae[Pe][2],ue.regY=ae[Pe][3],ue.rotation=ae[Pe][4]}),u.update())}}),Object.defineProperty(u,"pointsAdjusted",{get:function(){var oe=[],Ce,Me,te,ae=u.pointObjects;return t.loop(ae.length,function(we){if(te=ae[we],Me=S[we],te[0].rotation==0&&te[0].scaleX==0&&te[0].scaleY==0)Ce=[t.decimals(Me[0].x),t.decimals(Me[0].y),t.decimals(Me[1].x),t.decimals(Me[1].y),t.decimals(Me[2].x),t.decimals(Me[2].y),t.decimals(Me[3].x),t.decimals(Me[3].y)];else{var ue=te[0].localToLocal(te[2].x,te[2].y,te[0].parent),Pe=te[0].localToLocal(te[3].x,te[3].y,te[0].parent);Ce=[t.decimals(Me[0].x),t.decimals(Me[0].y),t.decimals(Me[1].x),t.decimals(Me[1].y),t.decimals(ue.x-Me[0].x),t.decimals(ue.y-Me[0].y),t.decimals(Pe.x-Me[0].x),t.decimals(Pe.y-Me[0].y)]}Me[4]&&Me[4]!=="mirror"&&Ce.push(Me[4]),oe.push(Ce)}),oe},set:function(){dt&&tt("Squiggle() - pointsAdjusted is read only")}}),Object.defineProperty(u,"pointObjects",{get:function(){return S},set:function(){dt&&tt("Squiggle() - pointObjects is read only - but its contents can be manipulated - use squiggle.update() after changes")}}),Object.defineProperty(u,"pointControls",{get:function(){return h},set:function(){dt&&tt("Squiggle() - pointControls is read only - but its contents can be manipulated - use blob.update() after changes")}}),Object.defineProperty(u,"pointCircles",{get:function(){return F},set:function(){dt&&tt("Squiggle() - pointCircles is read only - but its contents can be manipulated - use blob.update() after changes")}}),Object.defineProperty(u,"segmentPoints",{get:function(){var oe=[],Ce=u.pointsAdjusted;return t.loop(Ce.length-1,function(Me){var te=u.getSegmentPoint(Ce[Me],Ce[Me+1]);oe.push(te)}),oe},set:function(){dt&&tt("Squiggle() - segmentPoints is read only")}}),Object.defineProperty(u,"segmentRatios",{get:function(){var oe=[],Ce=0;t.loop(u.segmentPoints,function(ae){var we=t.distanceAlongCurve(ae);oe.push(we),Ce+=we});var Me=[],te=0;return t.loop(oe,function(ae){var we=ae/Ce;te+=we,Me.push(te)}),Me},set:function(){dt&&tt("Squiggle() - segmentRatios is read only")}}),u.approximateBounds=function(oe,Ce,Me){n(oe)&&(oe=80),n(Me)&&(Me=0),oe/=u.num;var te=u.interpolate(oe,null,!0,null,!0),ae=t.boundsAroundPoints(te);if(u.setBounds(ae.x-Me,ae.y-Me,ae.width+Me*2,ae.height+Me*2),Ce){if(!u.parent)return dt&&tt("approximateBounds() - add to stage to first to see points"),u;u.hitPathPoints?u.hitPathPoints.removeAllChildren():u.hitPathPoints=new t.Container().addTo(),u.hitPathPoints.top();for(var we=0;we<te.length;we++){var ue=te[we];ue=u.localToGlobal(ue.x,ue.y),new t.Circle(3).loc(ue.x,ue.y,u.hitPathPoints)}}return u},u.getPointAngle=function(oe){var Ce=u.pointObjects[oe][0],Me=u.pointObjects[oe][2],te=u.pointObjects[oe][3],ae,we;return Ce==u.stage?(ae=new t.Point(Me.x,Me.y),we=new t.Point(te.x,te.y)):(ae=Ce.localToGlobal(Me.x,Me.y),we=Ce.localToGlobal(te.x,te.y)),t.angle(ae.x,ae.y,we.x,we.y)},u.getSegmentPoint=function(oe,Ce){if(!(n(oe)||n(Ce))){(oe[2]!=0||oe[3]!=0)&&(oe[4]-=oe[2],oe[5]-=oe[3],oe[6]-=oe[2],oe[7]-=oe[3],oe[0]+=oe[2],oe[1]+=oe[3],oe[2]=0,oe[3]=0),(Ce[2]!=0||Ce[3]!=0)&&(Ce[4]-=Ce[2],Ce[5]-=Ce[3],Ce[6]-=Ce[2],Ce[7]-=Ce[3],Ce[0]+=Ce[2],Ce[1]+=Ce[3],Ce[2]=0,Ce[3]=0);var Me={x:oe[0],y:oe[1]},te={x:oe[0]+oe[6],y:oe[1]+oe[7]},ae={x:Ce[0]+Ce[4],y:Ce[1]+Ce[5]},we={x:Ce[0],y:Ce[1]};return(z.x!=0||z.y!=0)&&(Me.x+=z.x,te.x+=z.x,ae.x+=z.x,we.x+=z.x,Me.y+=z.y,te.y+=z.y,ae.y+=z.y,we.y+=z.y),[Me,te,ae,we]}},u.getAdjacentSegmentData=function(oe){n(oe)&&(oe=0);var Ce=u.pointsAdjusted;return u.num==2?[[u.getSegmentPoint(Ce[0],Ce[1])],[0]]:oe==0?[[u.getSegmentPoint(Ce[0],Ce[1]),u.getSegmentPoint(Ce[1],Ce[2])],[0,1]]:oe>=u.num-2?[[u.getSegmentPoint(Ce[u.num-3],Ce[u.num-2]),u.getSegmentPoint(Ce[u.num-2],Ce[u.num-1])],[u.num-3,u.num-2]]:[[u.getSegmentPoint(Ce[oe-1],Ce[oe]),u.getSegmentPoint(Ce[oe],Ce[oe+1]),u.getSegmentPoint(Ce[oe+1],Ce[oe+2])],[oe-1,oe,oe+1]]},u.getCurvePoint=function(oe,Ce,Me,te,ae){(n(oe)||isNaN(oe))&&(oe=0),n(Ce)&&(Ce=u.segmentRatios),n(Me)&&(Me=u.segmentPoints),n(te)&&(te=!1),n(ae)&&(ae=!1);var we=Ce,ue=Me,Pe=t.loop(we,function(Ie,Re){if(Ie>=oe)return Re}),ie=Pe>0?we[Pe-1]:0,be=Pe>0?we[Pe]-we[Pe-1]:we[Pe];if(be){var Le=(oe-ie)/be,me=t.pointAlongCurve(ue[Pe],Le,te,!0),ee=u.localToGlobal(me.x,me.y);return ee.angle=me.angle,ee.z=Pe,n(ee)?void 0:ee}};function fe(oe,Ce,Me){return{x:oe.x+(Ce.x-oe.x)*Me,y:oe.y+(Ce.y-oe.y)*Me}}function ke(oe,Ce,Me,te,ae,we,ue,Pe){var ie=oe.length-1,be=0,Le=0;te==100&&u.type=="Squiggle"&&(te=99.99),te=(te+1e5)%100,t.loop(Me,function(xe,he){if(te/100<xe)return ie=he,Le=xe,!0;be=xe});var me=u.segmentPoints[ie],ee=Le>0?(te/100-be)/(Le-be):0,Ie=t.pointAlongCurve(me,ee,null,Pe),Re=[Ie.x,Ie.y,0,0];if(!we){if(ue){u.interpolatedPoints.push({x:Ie.x,y:Ie.y,r:te/100});return}if(ae!="none"){var _e=fe(me[0],me[1],ee),Ze=fe(me[1],me[2],ee),at=fe(me[2],me[3],ee),Be=fe(_e,Ze,ee),He=fe(Ze,at,ee);Re[4]=Be.x-Ie.x,Re[5]=Be.y-Ie.y,Re[6]=He.x-Ie.x,Re[7]=He.y-Ie.y;var et=u.localToLocal(_e.x,_e.y,Ce[ie]);oe[ie][6]=et.x,oe[ie][7]=et.y;var ge=u.localToLocal(at.x,at.y,Ce[(ie+1)%oe.length]);oe[(ie+1)%oe.length][4]=ge.x,oe[(ie+1)%oe.length][5]=ge.y}ae&&(Re[8]=ae),oe.splice(ie+1,0,Re)}}this.addPoint=function(oe,Ce){n(oe)&&(oe=100);var Me=u.points,te=u.segmentRatios,ae=u.pointControls;return Ce=Ce||ne,ke(Me,ae,te,oe,Ce),u.points=Me,u.num=Me.length,u},this.removePoint=function(oe){if(!(n(oe)||oe<0)){var Ce=t.copy(u.points);return Ce.splice(oe,1),u.points=Ce,u.stage&&u.stage.update(),u}},this.addPoints=function(oe,Ce,Me,te,ae,we,ue){n(we)&&(we=t.copy(u.points));var Pe=t.copy(u.segmentRatios),ie=0;if(ae&&(u.interpolatedPoints=[]),te)var be=Pe.length*oe;return t.loop(Pe,function(Le,me){ae&&ke(we,u.pointControls,u.segmentRatios,ie*100,Ce,!n(Me)&&me!=Me,ae,ue);var ee=te?Math.round(be*(Le-ie)):oe,Ie=1/(ee+1);t.loop(ee,function(Re){var _e=ie+(Le-ie)*Ie*(Re+1);ke(we,u.pointControls,u.segmentRatios,_e*100,Ce,!n(Me)&&me!=Me,ae,ue),!ae&&oe>0&&(u.points=we)}),ie=Le}),ae&&u.type=="Squiggle"&&ke(we,u.pointControls,u.segmentRatios,100,Ce,!1,ae,ue),u.stage&&u.stage.update(),u.num=we.length,u},this.interpolate=function(oe,Ce,Me,te,ae){return n(oe)&&(oe=1),u.addPoints(oe,"none",Ce,Me,!0,te,ae),u.interpolatedPoints},K&&u.approximateBounds(),this.dispose=function(oe,Ce,Me){if(u.shape){if(t.gD(u),o&&u.toggleStageEvent&&o.off("stagemousedown",u.toggleStageEvent),u.controls.noDrag(),u.controls.removeAllEventListeners(),u.selectPoints&&u.selectionManager&&u.selectionManager.dispose(),u.selectedBalls=null,u.selectedRect1s=null,u.selectedRect2s=null,u.selectionManager=null,u.off("mousedown",u.toggleEvent),u.off("click",u.clickEvent),oe){u.shape.dispose(),u.shape=null;for(var te=0;te<u.points.length;te++)u.pointObjects[te][0].removeAllEventListeners(),u.pointObjects[te][1].removeAllEventListeners(),u.pointObjects[te][2].removeAllEventListeners(),u.pointObjects[te][3].removeAllEventListeners();u.controls.removeFrom(u),u.sticks.dispose(),S=null,F=null}else u.removeAllEventListeners(),S=null,F=null,Me||this.zimCustomShape_dispose(!0);return!0}}},t.extend(t.Squiggle,t.CustomShape,["clone","dispose"],"zimCustomShape",!1),t.Blob=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O){var X="color, borderColor, borderWidth, points, radius, controlLength, controlType, lockControlType, showControls, lockControls, handleSize, allowToggle, move, dashed, onTop, circleColor, circleBorderColor, stickColor, stickThickness, selectColor, selectPoints, editPoints, interactive, strokeObj, style, group, inherit",R;if(R=st(t.Blob,arguments,X,this))return R;De("53.5"),this.group=$;var Q=k===!1?{}:t.getStyle("Blob",this.group,O);n(a)&&(a=Q.radius!=null?Q.radius:100),this.zimCustomShape_constructor(-a,-a,a*2,a*2,!1),this.type="Blob",this.mouseChildren=!0,n(m)&&(m=Q.dashed!=null?Q.dashed:!1),n(r)&&(r=Q.borderColor!=null?Q.borderColor:null),n(i)&&(i=Q.borderWidth!=null?Q.borderWidth:null),r<0||i<0?r=i=null:r!=null&&i==null&&(i=1),n(e)&&(e=Q.color!=null?Q.color:i>0?"rgba(0,0,0,0)":t.green),e.style&&(this.colorCommand=e,e=t.black),r&&r.style&&(this.borderColorCommand=r,r=t.black),n(l)&&(l=Q.points!=null?Q.points:4);var K=typeof l!="number",q=typeof l=="number"?l:l.length,ne=s;n(s)&&(s=Q.controlLength!=null?Q.controlLength:a*4/q),n(f)&&(f=Q.controlType!=null?Q.controlType:null);var U=f;n(f)&&(f="straight"),n(c)&&(c=Q.lockControlType!=null?Q.lockControlType:!1),n(Y)&&(Y=Q.interactive!=null?Q.interactive:!0),n(w)&&(w=Q.showControls!=null?Q.showControls:Y);var D=w;n(T)&&(T=Q.lockControls!=null?Q.lockControls:!Y),n(p)&&(p=Q.handleSize!=null?Q.handleSize:t.mobile()?20:10),n(x)&&(x=Q.allowToggle!=null?Q.allowToggle:Y),n(P)&&(P=Q.move!=null?Q.move:Y),n(I)&&(I=Q.circleColor!=null?Q.circleColor:t.light),n(g)&&(g=Q.circleBorderColor!=null?Q.circleBorderColor:t.dark),n(E)&&(E=Q.stickColor!=null?Q.stickColor:t.darker),n(A)&&(A=Q.stickThickness!=null?Q.stickThickness:1),n(y)&&(y=Q.selectColor!=null?Q.selectColor:t.white),n(C)&&(C=Q.selectPoints!=null?Q.selectPoints:Y),this.circleColor=I,this.circleBorderColor=g,this.stickColor=E,this.stickThickness=A,n(v)&&(v=Q.onTop!=null?Q.onTop:!0),n(L)&&(L=Q.editPoints!=null?Q.editPoints:Y),n(_)&&(_=Q.strokeObj!=null?Q.strokeObj:{});var d=u(e,r);this.veeObj={color:d[0],borderColor:d[1]};function u(){return arguments}e=t.Pick.choose(e),r=t.Pick.choose(r);var o=this;this.interactive=Y,this.num=q,this.editPoints=L,this.selectPoints=C,this.lockControls=T,this.onTop=v,this.move=P,this.allowToggle=x,this.lockControlType=c,this.types=["mirror","straight","free","none"];var S,F,h;o._color=e,o._borderColor=r,o._borderWidth=i,o._dashed=m,o._dashed&&!Array.isArray(o._dashed)&&(o._dashed=[10,10]);var b,ye,B,N,re,le=o.move,G=2,z,se;l=Oe(l);function Oe(te){(te=="circle"||te=="rectangle"||te=="triangle")&&(te=="circle"&&(te=new t.Circle(a)),te=="rectangle"&&(te=new t.Rectangle(a*2,a*2).centerReg({add:!1})),te=="triangle"&&(te=new t.Triangle(a*2,a*2,a*2)));var ae;if(te.type=="Circle"||te.type=="Rectangle"||te.type=="Triangle"||te.type=="Flare"){var we=te.getBounds();if(te.type=="Circle")ae=4,ne=s=a*2*.5523;else if(te.type=="Rectangle")te.centerReg({add:!1}),ae=[[we.x-we.width/2,we.y-we.height/2],[we.x+we.width/2,we.y-we.height/2],[we.x+we.width/2,we.y+we.height/2],[we.x-we.width/2,we.y+we.height/2]],o.setBounds(we.x-we.width/2,we.y-we.height/2,we.width,we.height),o.regX=te.regX-we.width/2,o.regY=te.regY-we.height/2;else if(te.type=="Triangle")ae=[[te.three.x-te.width/2,te.three.y+te.height/2+te.adjusted],[te.two.x-te.width/2,te.two.y+te.height/2+te.adjusted],[te.one.x-te.width/2,te.one.y+te.height/2+te.adjusted]],o.setBounds(we.x-we.width/2,we.y-we.height/2,we.width,we.height);else if(te.type=="Flare"){var ue=we.width/2+we.x,Pe=we.height/2+we.y;ae=[];var ie=t.copy(te.points),be={x:null,y:null};t.loop(ie,(Le,me)=>{var ee=Math.round(Le.x),Ie=Math.round(Le.y);ee==be.x&&Ie==be.y||(be={x:ee,y:Ie},ae.push([ee-ue,Le.y-Pe]))}),o.setBounds(-te.width/2,-te.height/2,te.width,te.height)}return ae}else return te}if(typeof l=="string"){var J=new t.SVGContainer;l=J.processPath(l),l[0][0]==l[l.length-1][0]&&l[0][1]==l[l.length-1][1]&&(l[0][4]=l[l.length-1][4],l[0][5]=l[l.length-1][5],l.pop())}U&&typeof l!="number"&&t.loop(l,function(te){te[8]=U,U=="none"&&(te[4]=te[5]=te[6]=te[7]=0)}),pe();function pe(){if(se&&se.removeAllEventListeners(),o.selectPoints?(o.selectedBalls=new t.SelectionSet,o.selectedRect1s=new t.SelectionSet,o.selectedRect2s=new t.SelectionSet,o.selectionManager=new t.SelectionManager([o.selectedBalls,o.selectedRect1s,o.selectedRect2s],"ctrl",!1)):o.selectionManager=new t.SelectionManager(null,"ctrl"),q=typeof l=="number"?l:l.length,q<=0)return;n(ne)&&(s=a*4/q),b=o.shape=new t.Shape({style:!1}).addTo(o);var te=o.sticks=new t.Shape({style:!1}).addTo(o);p<=0&&te.removeFrom();var ae=b.graphics;ae.c();var we=te.graphics;we.c();var ue=p/10*8,Pe=p,ie=t.mobile();se=o.controls=new t.Container({style:!1}).addTo(o),o.interactive&&se.drag({onTop:!ie}),S=[],h=[],F=[];var be,Le,me,ee,Ie,Re,_e,Ze,at;for(be=0;be<q;be++){if(ee=new t.Container({style:!1}).addTo(se),ee.num=be,typeof l=="number"){var Be=t.Pick.choose(s);me=new t.Container(Be,a,null,null,!1).reg(Be/2,a).addTo(o),me.rotation=be/q*360,_e=new t.Circle(ue,o.selectPoints&&o.selectedBalls.isSelected(be)?y:o.circleColor,o.circleBorderColor,2,null,null,null,null,!1).centerReg(me).loc({x:Be/2,y:0}),Ie=new t.Rectangle(Pe,Pe,o.selectPoints&&o.selectedRect1s.isSelected(be)?y:qe(f),p==0?null:t.dark,p==0?null:2,null,null,null,null,!1).centerReg(me).loc({x:0,y:0}),Re=new t.Rectangle(Pe,Pe,o.selectPoints&&o.selectedRect2s.isSelected(be)?y:qe(f),p==0?null:t.dark,p==0?null:2,null,null,null,null,!1).centerReg(me).loc({x:Be,y:0});var He=me.localToLocal(_e.x,_e.y,se);_e.x=He.x,_e.y=He.y,_e.addTo(ee,null,!1);var et=me.localToLocal(Ie.x,Ie.y,se);Ie.x=f=="none"?0:et.x-_e.x,Ie.y=f=="none"?0:et.y-_e.y,Ie.addTo(ee,null,!1);var ge=me.localToLocal(Re.x,Re.y,se);Re.x=f=="none"?0:ge.x-_e.x,Re.y=f=="none"?0:ge.y-_e.y,Re.addTo(ee,null,!1),ee.x=_e.x,ee.y=_e.y,_e.x=0,_e.y=0,f=="none"&&_e.addTo(ee,null,!1)}else at=l[be],Ze=at[8]?at[8]:f,ee.loc({x:at[0],y:at[1]}),_e=new t.Circle(ue,o.circleColor,o.circleBorderColor,2,null,null,null,null,!1).centerReg({add:!1}).addTo(ee).loc({x:at[2],y:at[3]}),Ie=new t.Rectangle(Pe,Pe,qe(Ze),p==0?null:t.dark,p==0?null:2,null,null,null,null,!1).centerReg({add:!1}).addTo(ee,0).loc({x:at[4],y:at[5]}),Re=new t.Rectangle(Pe,Pe,qe(Ze),p==0?null:t.dark,p==0?null:2,null,null,null,null,!1).centerReg({add:!1}).addTo(ee,0).loc({x:at[6],y:at[7]});_e.mySet=ee,_e.rect1=Ie,_e.rect2=Re,_e.index=be,p==0&&(_e.expand(10),Ie.expand(10),Re.expand(10)),ie?_e.on("mousedown",he):_e.on("dblclick",Ge),Ie.ball=_e,Ie.other=Re,Re.ball=_e,Re.other=Ie,ie&&(_e.expand(),Ie.expand(),Re.expand()),Le=[ee,_e,Ie,Re,at?at[8]:f],S.push(Le),F.push(_e),h.push(ee)}var xe=!1;function he(Se){xe?(Se.preventDefault(),Ge(Se)):(xe=!0,setTimeout(function(){xe=!1},300))}function Ge(Se){if(!o.lockControlType){var Ae=Se.target,Ye=S[Ae.index][4]?S[Ae.index][4]:f;Math.abs(Ae.rect1.x)<=2&&Math.abs(Ae.rect1.y)<=2&&Math.abs(Ae.rect2.x)<=2&&Math.abs(Ae.rect2.y)<=2&&(Ye="none"),Ye=="none"&&Ae.parent.addChildAt(Ae,0),Ye=o.types[(o.types.indexOf(Ye)+(o.shiftKey?-1:1)+o.types.length)%o.types.length],Ye=="none"&&(Ae.rect1.x=Ae.rect1.y=Ae.rect2.x=Ae.rect2.y=0,Ae.parent.addChild(Ae),Se.stopImmediatePropagation()),S[Ae.index][4]=Ye,Ae.rect1.color=qe(Ye),Ae.rect2.color=qe(Ye),o.drawShape();var Xe=new Ne.Event("change");Xe.controlType="bezierSwitch",o.dispatchEvent(Xe),Ae.stage.update()}}function qe(Se){var Ae={mirror:"#993399",free:"#ebcb35",none:"#50c4b7"};return Ae[Se]?Ae[Se]:"#e472c4"}o.drawShape=function(){var Se,Ae,Ye,Xe,Ue,rt,Te,$e,lt,Qe,ot,ft,ut;ae.c(),o.colorCommand||(o.colorCommand=ae.f(o._color).command,e&&e.type&&o.specialColor(o.colorCommand,e,o)),(n(o._borderWidth)||o._borderWidth>0)&&(!n(o._borderColor)||!n(o._borderWidth))&&(n(o._borderColor)&&(o._borderColor=t.black),o.borderColorCommand||(o.borderColorCommand=ae.s(o._borderColor).command,o._borderColor&&o._borderColor.type&&o.specialColor(o.borderColorCommand,o._borderColor,o)),o.borderWidthCommand||(o.borderWidthCommand=ae.ss(o._borderWidth,_.caps,_.joints,_.miterLimit,_.ignoreScale).command),o._dashed&&(o.borderDashedCommand||(o.borderDashedCommand=ae.sd(Array.isArray(o._dashed)?o._dashed:[10,10],o._dashedOffset).command))),Ye=S[0][0],Te=Ye.localToLocal(S[0][1].x,S[0][1].y,b),ae.mt(Te.x,Te.y),we.c().s(o.stickColor).ss(o.stickThickness);for(var ze=0;ze<S.length;ze++)Se=ze,Ae=(ze+1)%S.length,Ye=S[Se][0],_e=S[Se][1],Xe=S[Se][2],Ue=S[Se][3],rt=S[Ae][0],$e=S[Ae][1],lt=S[Ae][2],ot=Ye.localToLocal(Ue.x,Ue.y,b),ft=rt.localToLocal(lt.x,lt.y,b),ut=rt.localToLocal($e.x,$e.y,b),ae.bt(ot.x,ot.y,ft.x,ft.y,ut.x,ut.y),Te=Ye.localToLocal(_e.x,_e.y,b),Qe=Ye.localToLocal(Xe.x,Xe.y,b),we.mt(Te.x,Te.y).lt(Qe.x,Qe.y),we.mt(Te.x,Te.y).lt(ot.x,ot.y);ae.cp(),ae.append(o.colorCommand),o._dashed&&ae.append(o.borderDashedCommand),o.borderWidthCommand&&ae.append(o.borderWidthCommand),o.borderColorCommand&&ae.append(o.borderColorCommand)},o.drawShape(),e.type&&(o.color=e);var Fe;se.on("mousedown",function(Se){if(!o.lockControls){o.selectPoints&&(o.keyFocus=!0),Fe={x:Se.target.x,y:Se.target.y};var Ae;if(Se.target.rect1)Ae=Se.target,Ae.startX=Ae.x,Ae.startY=Ae.y,Ae.rect1.startX=Ae.rect1.x,Ae.rect1.startY=Ae.rect1.y,Ae.rect2.startX=Ae.rect2.x,Ae.rect2.startY=Ae.rect2.y;else{var Ye=Se.target;Ye.startX=Ye.x,Ye.startY=Ye.y,Ae=Ye.ball;var Xe=Ae.index,Ue=f;if(n(S[Xe][4])||(Ue=S[Xe][4]),Ue=="straight"){var rt=Ye.other,Te=rt.x-Ae.x,$e=rt.y-Ae.y;rt.stickLength=Math.sqrt(Math.pow(Te,2)+Math.pow($e,2))}}if(o.selectPoints){var lt=o.selectionManager.currentSet;if(lt&&lt.selections&&lt.selections.length>0)for(var Qe=0;Qe<lt.selections.length;Qe++){var ot=o.pointObjects[lt.selections[Qe]];ot[1].startX=ot[1].x,ot[1].startY=ot[1].y,ot[2].startX=ot[2].x,ot[2].startY=ot[2].y,ot[3].startX=ot[3].x,ot[3].startY=ot[3].y}}}}),o.selectPoints&&se.tap(function(Se){var Ae;if(Se.target.rect1)Ae=Se.target,o.selectedBalls.toggle(Ae.parent.num);else{var Ye=Se.target;Ye.color="white",Ae=Ye.ball,Ae.rect1==Ye?o.selectedRect1s.toggle(Ae.parent.num):o.selectedRect2s.toggle(Ae.parent.num)}for(var Xe=0;Xe<o.pointObjects.length;Xe++){var Ue=o.pointObjects[Xe];Ue[1].color=o.selectedBalls.isSelected(Xe)?y:o.circleColor,Ue[2].color=o.selectedRect1s.isSelected(Xe)?y:qe(Ue[4]),Ue[3].color=o.selectedRect2s.isSelected(Xe)?y:qe(Ue[4])}Se.target.stage.update()}),se.on("pressmove",function(Se){if(!o.lockControls)if(o.selectPoints){var Ae=Z();if(Ae.indexOf(Se.target)==-1)z(Se.target),o.drawShape();else if(Ae.length>0){for(var Ye=Se.target.x-Se.target.startX,Xe=Se.target.y-Se.target.startY,Ue=0;Ue<Ae.length;Ue++){var rt=Ae[Ue];rt.x=rt.startX+Ye,rt.y=rt.startY+Xe,z(rt)}o.drawShape()}}else z(Se.target),o.drawShape()}),se.on("pressup",function(Se){if(!o.lockControls){var Ae=Se.target.x!=Fe.x||Se.target.y!=Fe.y,Ye=new Ne.Event("change");Se.target.rect1?(Ye.controlType="bezierPoint",We(Se.target)):Ye.controlType="bezierHandle",Ae&&o.dispatchEvent(Ye)}});function We(Se){if(o.selectPoints){var Ae=Z();if(Ae&&Ae.indexOf(Se)==-1)de(Se);else if(Ae&&Ae.length>0)for(var Ye=0;Ye<Ae.length;Ye++)de(Ae[Ye]);else de(Se)}else de(Se)}o.changeControl=function(Se,Ae,Ye,Xe,Ue,rt,Te,$e,lt){var Qe="index, type, rect1X, rect1Y, rect2X, rect2Y, circleX, circleY, update",ot;if(ot=st(o.changeControl,arguments,Qe))return ot;if(n(Se)){for(var ft=0;ft<S.length;ft++)o.changeControl(ft,Ae,Ye,Xe,Ue,rt,Te,$e);return o}var ut=S[Se];return ut[4]=Ae,Ae=="none"?(n(Te)||(ut[1].x=Te),n($e)||(ut[1].y=$e),ut[2].x=ut[1].x,ut[2].y=ut[1].y,ut[3].x=ut[1].x,ut[3].y=ut[1].y,ut[1].parent.addChild(ut[1])):(n(Te)||(ut[1].x=Te),n($e)||(ut[1].y=$e),n(Ye)||(ut[2].x=Ye),n(Xe)||(ut[2].y=Xe),n(Ue)||(ut[3].x=Ue),n(rt)||(ut[3].y=rt),ut[1].parent.addChildAt(ut[1],0)),ut[2].color=qe(Ae),ut[3].color=qe(Ae),lt&&(o.update(),o.stage&&o.stage.update()),o},o.transformPoints=function(Se,Ae,Ye,Xe,Ue){return n(Ue)&&(Ue=!0),o.points=t.transformPoints(o.points,Se,Ae,Ye,Xe),Ue&&o.approximateBounds(),o},o.traverse=function(Se,Ae,Ye,Xe,Ue){var rt=t.copy(o.segmentRatios);rt.unshift(0),n(Ye)&&(Ye=Ae+1);var Te=rt[Ae]*100,$e=rt[Ye]*100,lt;!Ue&&Te>$e?lt=100-Te+$e:!Ue&&Te<$e?lt=$e-Te:Ue&&Te>$e?lt=-(Te-$e):Ue&&Te<$e&&(lt=-(100-$e+Te));var Qe=new Ne.Event("traversed");return Qe.obj=Se,Se.animate({ease:"linear",props:{path:o,startPercent:Te,percent:lt},time:Xe,call:function(){o.dispatchEvent(Qe)}}),o},o.reversePoints=function(Se){return n(Se)&&(Se=!0),l=t.copy(o.points),l.reverse(),Se&&l.unshift(l.pop()),t.loop(l,function(Ae){var Ye=Ae[6];Ae[6]=Ae[4],Ae[4]=Ye;var Xe=Ae[7];Ae[7]=Ae[5],Ae[5]=Xe}),o.points=l,o.update(),o},o.splitPoints=function(Se){var Ae=t.copy(o.points);if(!(Se<1||Se>Ae.length-1)){var Ye=t.copy(Ae.slice(0,Se+1)),Xe=t.copy(Ae.slice(Se));t.trimPointEnds(Ye),t.trimPointEnds(Xe);var Ue=o.clone();return o.points=Ye,o.update(),Ue.points=Xe,o.parent&&Ue.addTo(o.parent),Ue}},o.makeSquiggle=function(Se){var Ae=t.copy(o.points);n(Se)&&(Se=0),Se=(Se+Ae.length*1e3)%Ae.length;var Ye=t.copy(Ae.slice(Se)),Xe=t.copy(Ae.slice(0,Se+1));Ae=Ye.concat(Xe),t.trimPointEnds(Ae);var Ue=new t.Squiggle({points:Ae,color:o.borderColor,thickness:o.borderWidth,showControls:o.controlsVisible,interactive:o.interactive,onTop:o.onTop,dashed:o.dashed,stickColor:o.stickColor,stickThickness:o.stickThickness});return Ue},o.update=function(Se){return Se?o.points=o.pointsAdjusted:o.drawShape(),o.zimAnimateChanged=!0,o},o.move&&o.interactive&&b.drag({onTop:!1}),ye=b.on("mousedown",function(Se){re=Se.target.stage,Fe={x:b.x,y:b.y},o.selectPoints&&(o.keyFocus=!0),ce()}),B=b.on("pressmove",function(){se.x=b.x,se.y=b.y,te.x=b.x,te.y=b.y}),N=b.on("pressup",function(){var Se=b.x!=Fe.x||b.y!=Fe.y,Ae=b.localToLocal(o.regX,o.regY,o.parent);if(o.x=Ae.x,o.y=Ae.y,se.x=se.y=te.x=te.y=b.x=b.y=0,Se){var Ye=new Ne.Event("change");Ye.controlType="move",o.dispatchEvent(Ye)}re.update()}),P||fe(!0);function ce(){if(o.onTop){var Se=o.parent.numChildren-1;o.parent.getChildAt(Se).type=="Keyboard"&&Se--,o.parent.setChildIndex(o,Se)}}o.toggleEvent=o.on("mousedown",function(){o.allowToggle&&(D||(o.showControls(),o.dispatchEvent("controlsshow")))}),o.added(function(){re=o.stage,o.toggleStageEvent&&o.stage.off("stagemousedown",o.toggleStageEvent),o.toggleStageEvent=o.stage.on("stagemousedown",function(Se){!o.allowToggle||!o.stage||D&&!o.hitTestPoint(Se.stageX/t.scaX,Se.stageY/t.scaY,!1)&&(o.hideControls(),o.dispatchEvent("controlshide"))})}),o.clickEvent=o.on("click",function(){o.ctrlKey&&setTimeout(function(){o.clone(!0).addTo(o.stage).mov(100),o.allowToggle&&(o.hideControls(),o.dispatchEvent("controlshide"));var Se=new Ne.Event("change");Se.controlType="move",o.dispatchEvent(Se),o.stage.update()},50)}),o.hideControls=function(){return o.toggled=!1,se.visible=!1,te.visible=!1,D=!1,o.stage&&o.stage.update(),!o.allowToggle&&o.move&&fe(),o},D||o.hideControls(),o.showControls=function(){return o.toggled=!0,se.visible=!0,te.visible=!0,D=!0,se.x=b.x,se.y=b.y,te.x=b.x,te.y=b.y,o.addChildAt(b,0),o.move&&!o.allowToggle&&V(),o.stage&&o.stage.update(),o},o.toggle=function(Se){return Se===!0?o.showControls():Se===!1||D?o.hideControls():o.showControls(),o},o.recordData=function(Se){n(Se)&&(Se=!1);var Ae={type:"Blob",index:o.parent?o.parent.getChildIndex(o):-1,x:o.x,y:o.y,points:o.getPoints(),color:o.color,borderColor:o.borderColor,borderWidth:o.borderWidth,move:o.move,allowToggle:o.allowToggle,controlsVisible:D};return Se?JSON.stringify(Ae):Ae},o.setData=function(Se,Ae){if(!n(Se)){if(Ae)try{Se=JSON.parse(Se)}catch{return}var Ye=Se.index;n(Ye)&&(Ye=-1),delete Se.index;var Xe=Se.points;n(Xe)||o.setPoints(Xe),delete Se.points,this.num=Xe.length;for(var Ue in Se)o[Ue]=Se[Ue];return o.parent&&o.parent.setChildIndex(o,Ye),o}},o.getPoints=function(Se){n(Se)&&(Se=!1);var Ae=o.points;if(Se){if(!Ye){var Ye=o.pane=new t.Pane({displayClose:!1,container:o.stage,width:Math.min(500,o.stage.width-20),height:Math.min(500,o.stage.height-20),draggable:!0}),Xe=o.textArea=new t.TextArea(Math.min(400,o.stage.width-70),Math.min(400,o.stage.height-70));Xe.centerReg(Ye)}Ye.show(),Xe.text=JSON.stringify(Ae)}return Ae},o.recordPoints=o.getPoints,o.setPoints=function(Se){for(var Ae,Ye,Xe=0;Xe<Se.length;Xe++)Ae=S[Xe],Ye=Se[Xe],!n(Ae)&&(Ae[0].x=Ye[0],Ae[0].y=Ye[1],Ae[1].x=Ye[2],Ae[1].y=Ye[3],Ae[2].x=Ye[4],Ae[2].y=Ye[5],Ae[3].x=Ye[6],Ae[3].y=Ye[7],Ae[4]=Ye[8],Ae[2].color=qe(Ae[4]),Ae[3].color=qe(Ae[4]));return o.update(),o},k!==!1&&t.styleTransforms(o,Q),o.clone=function(Se,Ae){var Ye=[],Xe=!1;t.loop(o.pointControls,function(rt){rt.scaleX+rt.scaleY+rt.regX+rt.regY+rt.rotation!=2&&(Xe=!0),Ye.push([rt.scaleX,rt.scaleY,rt.regX,rt.regY,rt.rotation])});var Ue=o.cloneProps(new t.Blob(Ae?o.colorCommand:Se||!t.isPick(d[0])?o.color:d[0],Ae?o.borderColorCommand:Se||!t.isPick(d[1])?o.borderColor:d[1],o.borderWidth,o.getPoints(),a,s,f,c,se.visible,T,p,o.allowToggle,o.move,m,v,o.circleColor,o.circleBorderColor,o.stickColor,o.stickThickness,y,C,o.editPoints,Y,_,k,o.group,O));return Xe&&(t.loop(Ue.pointControls,function(rt,Te){rt.scaleX=Ye[Te][0],rt.scaleY=Ye[Te][1],rt.regX=Ye[Te][2],rt.regY=Ye[Te][3],rt.rotation=Ye[Te][4]}),Ue.update()),o.linearGradientParams&&Ue.linearGradient.apply(Ue,o.linearGradientParams),o.radialGradientParams&&Ue.radialGradient.apply(Ue,o.radialGradientParams),Ue},o.shapeMousedownEvent=o.shape.on("mousedown",function(Se){re=Se.target.stage,o.editPoints&&(o.controlsVisible?(o.pressX=Se.stageX/t.scaX,o.pressY=Se.stageY/t.scaY):(o.pressX=null,o.pressY=null))}),o.addPointFactor=10,o.addMinDistance=15,o.shapePressupEvent=o.shape.on("pressup",function(Se){if(o.editPoints&&o.pressX&&Math.abs(o.pressX-Se.stageX/t.scaX)<G&&Math.abs(o.pressY-Se.stageY/t.scaY)<G){o.selectPoints&&(o.lastPoints=t.copy(o.points));var Ae=o.points,Ye=o.globalToLocal(Se.stageX/t.scaX,Se.stageY/t.scaY),Xe=t.closestPointAlongCurve(Ye,o.segmentPoints);if(o.editPoints=="anywhere")Ae.splice(Xe+1,0,[Ye.x,Ye.y,0,0,0,0,0,0]),o.points=Ae,o.changeControl({index:Xe+1,type:"mirror",update:!0});else{var Ue=o.pointsAdjusted,rt=o.getSegmentPoint(Ue[Xe],Ue[(Xe+1)%Ue.length]),Te=t.distanceAlongCurve(rt),$e=Math.round(Te/o.addPointFactor),lt=o.interpolate($e,Xe,!1,Ae),Qe=1e4,ot;if(t.loop(lt,function(kt,Mt){if(Mt!=0){var xt=t.dist(kt,Ye);xt<Qe&&(Qe=xt,ot=Mt)}}),Qe<o.addMinDistance){var ft=o.segmentRatios,ut=ft[Xe],ze=Xe>0?ft[Xe-1]:0;o.addPoint(100*(ze+(ut-ze)*(ot/($e+1))))}}o.lastSelectedIndex=Xe+1,o.lastSelected=o.controls.getChildAt(o.lastSelectedIndex),o.stage.update()}}),o.controlsClickEvent=o.controls.on("click",function(Se){o.lastSelected=Se.target.parent,o.lastSelectedIndex=o.controls.getChildIndex(Se.target.parent),o.editPoints&&o.selectionManager.shiftKey&&Ve(Se)});function Ve(Se){if(Se.target.type=="Circle"){var Ae=o.lastSelectedIndex=o.controls.getChildIndex(Se.target.parent);if(o.controls.numChildren<=2)return;var Ye=o.points;o.selectPoints&&(o.lastPoints=t.copy(Ye)),Ye.splice(Ae,1),o.points=Ye,o.stage.update(),o.lastSelected=o.lastSelectedIndex=null}}o.controls.hold(Ve),D||o.hideControls(),o.dispatchEvent("update")}function Z(){var te=[],ae=o.selectionManager.currentSet;if(ae&&ae.selections&&ae.selections.length>0)for(var we=0;we<ae.selections.length;we++){var ue=o.pointObjects[ae.selections[we]];if(ae==o.selectedBalls)te.push(ue[1]);else if(ae==o.selectedRect1s)te.push(ue[2]);else if(ae==o.selectedRect2s)te.push(ue[3]);else continue}return te}function de(te){if(o.selectPoints&&te.type=="Circle"){var ae=te,we=ae.mySet,ue=ae.rect1,Pe=ae.rect2;ue.x-=ae.x,ue.y-=ae.y,Pe.x-=ae.x,Pe.y-=ae.y,we.x+=ae.x,we.y+=ae.y,ae.x=0,ae.y=0}}o.selectionManager.on("keydown",function(te){if(o.selectPoints&&o.keyFocus&&te.keyCode>=37&&te.keyCode<=40){var ae=Z();if(ae.length>0){for(var we=0;we<ae.length;we++){var ue=ae[we];te.keyCode==37?ue.x-=o.selectionManager.shiftKey?10:1:te.keyCode==39?ue.x+=o.selectionManager.shiftKey?10:1:te.keyCode==38?ue.y-=o.selectionManager.shiftKey?10:1:te.keyCode==40&&(ue.y+=o.selectionManager.shiftKey?10:1),z(ue)}o.drawShape(),o.dispatchEvent("update"),o.stage&&o.stage.update()}}}),o.selectionManager.on("keyup",function(te){if(o.selectPoints&&o.keyFocus&&te.keyCode>=37&&te.keyCode<=40){var ae=Z();if(ae.length>0)for(var we=0;we<ae.length;we++)de(ae[we])}}),o.selectionManager.on("undo",function(){if(o.selectPoints&&o.keyFocus&&o.lastPoints){var te=t.copy(o.lastPoints);o.lastPoints=t.copy(o.points),o.points=te,o.stage&&o.stage.update()}}),z=function(te){if(!o.lockControls){var ae;if(te.rect1){ae=te;var we=ae.x-ae.startX,ue=ae.y-ae.startY;ae.rect1.x=ae.rect1.startX+we,ae.rect1.y=ae.rect1.startY+ue,ae.rect2.x=ae.rect2.startX+we,ae.rect2.y=ae.rect2.startY+ue}else{var Pe=te,ie=Pe.other;ae=Pe.ball;var be=ae.index,Le=f;if(n(S[be][4])||(Le=S[be][4]),Le=="straight"||Le=="mirror"){var me=Pe.x-ae.x,ee=Pe.y-ae.y;if(Le=="mirror")ie.x=ae.x-me,ie.y=ae.y-ee;else{var Ie=Math.atan2(ee,me),Re=-ie.stickLength*Math.cos(Ie+Math.PI),_e=-ie.stickLength*Math.sin(Ie+Math.PI);ie.x=ae.x-Re,ie.y=ae.y-_e}}}}},Object.defineProperty(o,"move",{get:function(){return P},set:function(te){P!=te&&(P=te,te?V():fe())}}),Object.defineProperty(o,"interactive",{get:function(){return Y},set:function(te){Y=te,D=Y,o.allowToggle=Y,o.editPoints=Y,o.lockControls=!Y,o.selectPoints=Y,o.move=Y;var ae=o.points;o.points=ae}}),Object.defineProperty(o,"allowToggle",{get:function(){return x},set:function(te){x!=te&&(x=te,x?o.move&&V():!D&&o.move&&fe())}});function V(){o.move!="always"&&(le||(le=!0,b.drag({onTop:!1}),ye=b.on("mousedown",ye),B=b.on("pressmove",B),N=b.on("pressup",N)))}function fe(te){o.move!="always"&&(!te&&!le||(le=!1,b.noDrag(),b.off("mousedown",ye),b.off("pressmove",B),b.off("pressup",N)))}Object.defineProperty(o,"controlsVisible",{get:function(){return D},set:function(te){D=te,te?o.showControls():o.hideControls()}});var ke=T;Object.defineProperty(o,"lockControls",{get:function(){return ke},set:function(te){ke=te,te?(o.controls.mouseChildren=!1,o.controls.mouseEnabled=!1):(o.controls.mouseChildren=!0,o.controls.mouseEnabled=!0)}}),o.lockControls=ke,j.KEYFOCUS!=null&&(t.KEYFOCUS=j.KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return t.KEYFOCUS==o},set:function(){t.KEYFOCUS=o}}),o.selectPoints&&!t.KEYFOCUS&&oe();function oe(){o.keyFocus=!0;var te=document.activeElement;te&&te.blur()}Object.defineProperty(o,"points",{get:function(){for(var te=[],ae,we,ue=0;ue<S.length;ue++)we=S[ue],ae=[t.decimals(we[0].x),t.decimals(we[0].y),t.decimals(we[1].x),t.decimals(we[1].y),t.decimals(we[2].x),t.decimals(we[2].y),t.decimals(we[3].x),t.decimals(we[3].y)],we[4]&&we[4]!=="straight"&&ae.push(we[4]),te.push(ae);return te},set:function(te){var ae=o.x,we=o.y,ue=o.visible,Pe=[],ie=!1;t.loop(o.pointControls,function(be){be.scaleX+be.scaleY+be.regX+be.regY+be.rotation!=2&&(ie=!0),Pe.push([be.scaleX,be.scaleY,be.regX,be.regY,be.rotation])}),o.dispose(!0),l=Oe(te),o.shape&&(o.shape.graphics.clear(),o.sticks.graphics.clear(),o.controls.noDrag(),o.removeAllChildren(),delete o.shape,delete o.sticks,delete o.controls),o.visible=!1,pe(),o.lockControls=ke,o.x=ae,o.y=we,o.visible=ue,ie&&(t.loop(o.pointControls,function(be,Le){be.scaleX=Pe[Le][0],be.scaleY=Pe[Le][1],be.regX=Pe[Le][2],be.regY=Pe[Le][3],be.rotation=Pe[Le][4]}),o.update())}}),Object.defineProperty(o,"pointsAdjusted",{get:function(){var te=[],ae,we,ue,Pe=o.pointObjects;return t.loop(Pe.length,function(ie){if(ue=Pe[ie],we=S[ie],ue[0].rotation==0&&ue[0].scaleX==0&&ue[0].scaleY==0)ae=[t.decimals(we[0].x),t.decimals(we[0].y),t.decimals(we[1].x),t.decimals(we[1].y),t.decimals(we[2].x),t.decimals(we[2].y),t.decimals(we[3].x),t.decimals(we[3].y)];else{var be=ue[0].localToLocal(ue[2].x,ue[2].y,ue[0].parent),Le=ue[0].localToLocal(ue[3].x,ue[3].y,ue[0].parent);ae=[t.decimals(we[0].x),t.decimals(we[0].y),t.decimals(we[1].x),t.decimals(we[1].y),t.decimals(be.x-we[0].x),t.decimals(be.y-we[0].y),t.decimals(Le.x-we[0].x),t.decimals(Le.y-we[0].y)]}we[4]&&we[4]!=="mirror"&&ae.push(we[4]),te.push(ae)}),te},set:function(){dt&&tt("Blob() - pointsAdjusted is read only")}}),Object.defineProperty(o,"pointObjects",{get:function(){return S},set:function(){dt&&tt("Blob() - pointObjects is read only - but its contents can be manipulated - use blob.update() after changes")}}),Object.defineProperty(o,"pointControls",{get:function(){return h},set:function(){dt&&tt("Blob() - pointControls is read only - but its contents can be manipulated - use blob.update() after changes")}}),Object.defineProperty(o,"pointCircles",{get:function(){return F},set:function(){dt&&tt("Blob() - pointCircles is read only - but its contents can be manipulated - use blob.update() after changes")}}),Object.defineProperty(o,"segmentPoints",{get:function(){var te=o.pointsAdjusted,ae=[];return t.loop(te.length,function(we,ue){var Pe=o.getSegmentPoint(te[we],te[we<ue-1?we+1:0]);ae.push(Pe)}),ae},set:function(){dt&&tt("Blob() - segmentPoints is read only")}}),Object.defineProperty(o,"segmentRatios",{get:function(){var te=[],ae=0;t.loop(o.segmentPoints,function(Pe){var ie=t.distanceAlongCurve(Pe);te.push(ie),ae+=ie});var we=[],ue=0;return t.loop(te,function(Pe){var ie=Pe/ae;ue+=ie,we.push(ue)}),we},set:function(){dt&&tt("Blob() - segmentRatios is read only")}}),o.approximateBounds=function(te,ae){n(te)&&(te=80),te/=o.num;var we=o.interpolate(te,null,!0,null,!0),ue=t.boundsAroundPoints(we);if(o.setBounds(ue.x,ue.y,ue.width,ue.height),ae){if(!o.parent)return dt&&tt("approximateBounds() - add to stage to first to see points"),o;o.hitPathPoints?o.hitPathPoints.removeAllChildren():o.hitPathPoints=new t.Container().addTo(),o.hitPathPoints.top();for(var Pe=0;Pe<we.length;Pe++){var ie=we[Pe];ie=o.localToGlobal(ie.x,ie.y),new t.Circle(3).loc(ie.x,ie.y,o.hitPathPoints)}}return o},o.getPointAngle=function(te){var ae=o.pointObjects[te][0],we=o.pointObjects[te][2],ue=o.pointObjects[te][3],Pe,ie;return ae==o.stage?(Pe=new t.Point(we.x,we.y),ie=new t.Point(ue.x,ue.y)):(Pe=ae.localToGlobal(we.x,we.y),ie=ae.localToGlobal(ue.x,ue.y)),t.angle(Pe.x,Pe.y,ie.x,ie.y)},o.getSegmentPoint=function(te,ae){if(!(n(te)||n(ae))){(te[2]!=0||te[3]!=0)&&(te[4]-=te[2],te[5]-=te[3],te[6]-=te[2],te[7]-=te[3],te[0]+=te[2],te[1]+=te[3],te[2]=0,te[3]=0),(ae[2]!=0||ae[3]!=0)&&(ae[4]-=ae[2],ae[5]-=ae[3],ae[6]-=ae[2],ae[7]-=ae[3],ae[0]+=ae[2],ae[1]+=ae[3],ae[2]=0,ae[3]=0);var we={x:te[0],y:te[1]},ue={x:te[0]+te[6],y:te[1]+te[7]},Pe={x:ae[0]+ae[4],y:ae[1]+ae[5]},ie={x:ae[0],y:ae[1]};return(se.x!=0||se.y!=0)&&(we.x+=se.x,ue.x+=se.x,Pe.x+=se.x,ie.x+=se.x,we.y+=se.y,ue.y+=se.y,Pe.y+=se.y,ie.y+=se.y),[we,ue,Pe,ie]}},o.getAdjacentSegmentData=function(te){n(te)&&(te=0);var ae=o.pointsAdjusted;if(o.num==2)return[[o.getSegmentPoint(ae[0],ae[1]),o.getSegmentPoint(ae[1],ae[0])],[0,1]];if(te==0)return[[o.getSegmentPoint(ae[o.num-1],ae[0]),o.getSegmentPoint(ae[0],ae[1]),o.getSegmentPoint(ae[1],ae[2])],[o.num-1,0,1]];if(te>=o.num-1)return[[o.getSegmentPoint(ae[o.num-2],ae[o.num-1]),o.getSegmentPoint(ae[o.num-1],ae[0]),o.getSegmentPoint(ae[0],ae[1])],[o.num-2,o.num-1,0]];var we=te+2>=o.num?0:te+2;return[[o.getSegmentPoint(ae[te-1],ae[te]),o.getSegmentPoint(ae[te],ae[te+1]),o.getSegmentPoint(ae[te+1],ae[we])],[te-1,te,te+1]]},o.getCurvePoint=function(te,ae,we,ue){n(ae)&&(ae=o.segmentRatios),n(we)&&(we=o.segmentPoints),n(ue)&&(ue=!1);var Pe=ae,ie=we,be=t.loop(Pe,function(_e,Ze){if(_e>=te)return Ze}),Le=be>0?Pe[be-1]:0,me=be>0?Pe[be]-Pe[be-1]:Pe[be],ee=(te-Le)/me,Ie=t.pointAlongCurve(ie[be],ee,ue,!0);if(!n(Ie)){var Re=o.localToGlobal(Ie.x,Ie.y);return Re.angle=Ie.angle,Re.z=be,n(Re)?void 0:Re}};function Ce(te,ae,we){return{x:te.x+(ae.x-te.x)*we,y:te.y+(ae.y-te.y)*we}}function Me(te,ae,we,ue,Pe,ie,be,Le){var me=te.length-1,ee=0,Ie=0;ue==100&&o.type=="Squiggle"&&(ue=99.99),ue=(ue+1e5)%100,t.loop(we,function(qe,Fe){if(ue/100<qe)return me=Fe,Ie=qe,!0;ee=qe});var Re=o.segmentPoints[me],_e=Ie>0?(ue/100-ee)/(Ie-ee):0,Ze=t.pointAlongCurve(Re,_e,null,Le),at=[Ze.x,Ze.y,0,0];if(!ie){if(be){o.interpolatedPoints.push({x:Ze.x,y:Ze.y,r:ue/100});return}if(Pe!="none"){var Be=Ce(Re[0],Re[1],_e),He=Ce(Re[1],Re[2],_e),et=Ce(Re[2],Re[3],_e),ge=Ce(Be,He,_e),xe=Ce(He,et,_e);at[4]=ge.x-Ze.x,at[5]=ge.y-Ze.y,at[6]=xe.x-Ze.x,at[7]=xe.y-Ze.y;var he=o.localToLocal(Be.x,Be.y,ae[me]);te[me][6]=he.x,te[me][7]=he.y;var Ge=o.localToLocal(et.x,et.y,ae[(me+1)%te.length]);te[(me+1)%te.length][4]=Ge.x,te[(me+1)%te.length][5]=Ge.y}Pe&&(at[8]=Pe),te.splice(me+1,0,at)}}this.addPoint=function(te,ae){n(te)&&(te=100);var we=o.points,ue=o.segmentRatios,Pe=o.pointControls;return ae=ae||U,Me(we,Pe,ue,te,ae),o.points=we,o.num=we.length,o},this.removePoint=function(te){if(!(n(te)||te<0)){var ae=t.copy(o.points);return ae.splice(te,1),o.points=ae,o.stage&&o.stage.update(),o}},this.addPoints=function(te,ae,we,ue,Pe,ie,be){n(ie)&&(ie=t.copy(o.points));var Le=t.copy(o.segmentRatios),me=0;if(Pe&&(o.interpolatedPoints=[]),ue)var ee=Le.length*te;return t.loop(Le,function(Ie,Re){Pe&&Me(ie,o.pointControls,o.segmentRatios,me*100,ae,!n(we)&&Re!=we,Pe,be);var _e=ue?Math.round(ee*(Ie-me)):te,Ze=1/(_e+1);t.loop(_e,function(at){var Be=me+(Ie-me)*Ze*(at+1);Me(ie,o.pointControls,o.segmentRatios,Be*100,ae,!n(we)&&Re!=we,Pe,be),!Pe&&te>0&&(o.points=ie)}),me=Ie}),Pe&&o.type=="Squiggle"&&Me(ie,o.pointControls,o.segmentRatios,100,ae,null,Pe,be),o.stage&&o.stage.update(),o.num=ie.length,o},this.interpolate=function(te,ae,we,ue,Pe){return n(te)&&(te=1),o.addPoints(te,"none",ae,we,!0,ue,Pe),o.interpolatedPoints},K&&o.approximateBounds(),this.dispose=function(te,ae,we){if(o.shape){if(t.gD(o),re&&o.toggleStageEvent&&re.off("stagemousedown",o.toggleStageEvent),o.controls.noDrag(),o.controls.removeAllEventListeners(),o.selectPoints&&o.selectionManager&&o.selectionManager.dispose(),o.selectedBalls=null,o.selectedRect1s=null,o.selectedRect2s=null,o.selectionManager=null,o.off("mousedown",o.toggleEvent),o.off("click",o.clickEvent),te){o.shape.dispose(),o.shape=null;for(var ue=0;ue<o.points.length;ue++)o.pointObjects[ue][0].removeAllEventListeners(),o.pointObjects[ue][1].removeAllEventListeners(),o.pointObjects[ue][2].removeAllEventListeners(),o.pointObjects[ue][3].removeAllEventListeners();o.controls.removeFrom(o),o.sticks.dispose(),S=null,F=null}else o.removeAllEventListeners(),S=null,F=null,we||this.zimCustomShape_dispose(!0);return!0}}},t.extend(t.Blob,t.CustomShape,["clone","dispose"],"zimCustomShape",!1),hi=t.Blob,t.Flare=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O,X,R,Q,K,q,ne){var U="color, borderColor, borderWidth, crossAngle, thickness, thicknessA, thicknessB, pin, startX, startY, lengths, angles, anglesA, anglesB, anglesEnd, cross, crossColors, close, dashed, strokeObj, spineColor, spineBorderWidth, spineBorderColor, spineDashed, spineStrokeObj, closeColor, closeBorderWidth, closeBorderColor, closeDashed, closeStrokeObj, style, group, inherit",D;if(D=st(t.Flare,arguments,U,this))return D;De("53.6"),this.zimContainer_constructor(),this.type="Flare",this.group=q;var d=K===!1?{}:t.getStyle(this.type,this.group,ne),u=this;n(r)&&(r=d.borderColor!=null?d.borderColor:null),n(i)&&(i=d.borderWidth!=null?d.borderWidth:null),r<0||i<0?r=i=null:r!=null&&i==null&&(i=1),n(e)&&(e=d.color!=null?d.color:i>0?"rgba(0,0,0,0)":t.black),(n(i)||i>0)&&(!n(r)||!n(i))&&n(r)&&(r=t.black),n(l)&&(l=d.crossAngle!=null?d.crossAngle:0);var o=l;l-=90,n(a)&&(a=d.thickness!=null?d.thickness:null),n(s)&&(s=d.thicknessA!=null?d.thicknessA:null),n(f)&&(f=d.thicknessB!=null?d.thicknessB:null),n(a)?n(f)&&!n(s)?f=s:n(s)&&!n(f)?s=f:f=s=10:n(f)&&!n(s)?f=a-s:n(s)&&!n(f)?s=a-f:f=s=a/2,u.thickness=s+f,n(I)&&(I=d.cross!=null?d.cross:!0),n(g)&&(g=d.crossColors!=null?d.crossColors:null),!n(g)&&!Array.isArray(g)&&(g=[g]),n(E)&&(E=d.close!=null?d.close:!1),n(w)&&(w=d.startX!=null?d.startX:0),n(T)&&(T=d.startY!=null?d.startY:0),n(p)&&(p=d.lengths!=null?d.lengths:[200]),Array.isArray(p)||(p=[p]),n(x)&&(x=d.angles!=null?d.angles:[0]),Array.isArray(x)||(x=[x]),n(P)&&(P=d.anglesA!=null?d.anglesA:[10]),Array.isArray(P)||(P=[P]),n(m)&&(m=d.anglesB!=null?d.anglesB:t.copy(P)),Array.isArray(m)||(m=[m]),n(v)&&(v=d.anglesEnd!=null?d.anglesEnd:[0]),Array.isArray(v)||(v=[v]),n(y)&&(y=d.strokeObj!=null?d.strokeObj:{miterLimit:2}),n(Y)&&(Y=d.spineBorderColor!=null?d.spineBorderColor:null),n(L)&&(L=d.spineBorderWidth!=null?d.spineBorderWidth:null),Y<0||L<0?Y=L=null:Y!=null&&L==null&&(L=1),n(C)&&(C=d.spineColor!=null?d.spineColor:L>0?"rgba(0,0,0,0)":t.black),n(_)&&(_=d.spineDashed!=null?d.spineDashed:null),n(k)&&(k=d.spineStrokeObj!=null?d.spineStrokeObj:{miterLimit:2}),(n(L)||L>0)&&(!n(Y)||!n(L))&&n(Y)&&(Y=r||t.black),n(X)&&(X=d.closeBorderColor!=null?d.closeBorderColor:null),n(O)&&(O=d.closeBorderWidth!=null?d.closeBorderWidth:null),X<0||O<0?X=O=null:X!=null&&O==null&&(O=1),n($)&&($=d.closeColor!=null?d.closeColor:O>0?"rgba(0,0,0,0)":null),n(R)&&(R=d.closeDashed!=null?d.closeDashed:null),n(Q)&&(Q=d.closeStrokeObj!=null?d.closeStrokeObj:{miterLimit:2}),(n(O)||O>0)&&(!n(X)||!n(O))&&n(X)&&(X=r||t.black),this.thicknessA=s,this.thicknessB=f,this.cross=I,this.close=E,this.lengths=p,this.angles=x,this.anglesA=P,this.anglesB=m,this.anglesEnd=v,this.crossColors=g,S(p,x,P,m,v,I,g,E),e.type&&(u.color=e);function S(B,N,re,le,G,z,se,Oe){u.removeAllChildren();var J=u.shape=new t.Shape().addTo(u);if(u.colorCommand=J.c().f(e).command,e&&e.type&&u.specialColor(u.colorCommand,e,u),(n(i)||i>0)&&(!n(r)||!n(i))&&(n(r)&&(r=t.black),u.borderColorCommand=J.s(r).command,r&&r.type&&u.specialColor(u.borderColorCommand,r,u),u.borderWidthCommand=J.ss(i,y.caps,y.joints,y.miterLimit,y.ignoreScale).command,A&&(u.borderDashedCommand=J.sd([10,10],5).command)),J.mt(0,0),L>0){var pe=u.spineShape=new t.Shape().addTo(u);u.spineColorCommand=pe.c().f(C).command,C&&C.type&&u.specialColor(u.spineColorCommand,C,u),(n(L)||L>0)&&(!n(Y)||!n(L))&&(n(Y)&&(Y=t.black),u.spineBorderColorCommand=pe.s(Y).command,Y&&Y.type&&u.specialColor(u.spineBorderColorCommand,Y,u),u.spineBorderWidthCommand=pe.ss(L,k.caps,k.joints,k.miterLimit,k.ignoreScale).command,_&&(u.spineBorderDashedCommand=pe.sd([10,10],5).command))}if(!n($)){var Z=u.closeShape=new t.Shape().addTo(u);u.closeColorCommand=Z.c().f($).command,$&&$.type&&u.specialColor(u.closeColorCommand,$,u),(n(O)||O>0)&&(!n(X)||!n(O))&&(n(X)&&(X=t.black),u.closeBorderColorCommand=Z.s(X).command,X&&X.type&&u.specialColor(u.closeBorderColorCommand,X,u),u.closeBorderWidthCommand=Z.ss(O,Q.caps,Q.joints,Q.miterLimit,Q.ignoreScale).command,R&&(u.closeBorderDashedCommand=Z.sd([10,10],5).command)),J.mt(0,0)}var de=w,V=T,fe=l,ke=fe-180,oe=s,Ce=f,Me=Math.max(B.length,N.length,re.length,le.length,G.length),te,ae,we=ke,ue=[],Pe=[],ie=[];u.points=[];var be=u.pinPoints=[];t.loop(Me,function(ee){var Ie=Le(ee),Re=Math.cos(Ie.a*t.RAD),_e=Math.sin(Ie.a*t.RAD),Ze=new t.Point(de+Ie.A.x*Re-Ie.A.y*_e,V+Ie.A.x*_e+Ie.A.y*Re),at=new t.Point(de+Ie.B.x*Re-Ie.B.y*_e,V+Ie.B.x*_e+Ie.B.y*Re),Be=new t.Point(de+Ie.C.x*Re-Ie.C.y*_e,V+Ie.C.x*_e+Ie.C.y*Re),He=new t.Point(de+Ie.D.x*Re-Ie.D.y*_e,V+Ie.D.x*_e+Ie.D.y*Re);ue.push(Ze,at),Pe.unshift(Be,He),ie.push([Ze,at,Be,He]);var et=new t.Point(de+Ie.F.x*Re-Ie.F.y*_e,V+Ie.F.x*_e+Ie.F.y*Re),ge=new t.Point(de+Ie.E.x*Re-Ie.E.y*_e,V+Ie.E.x*_e+Ie.E.y*Re);ee==0&&u.pinPoints.push(et),u.pinPoints.push(ge),de=ge.x,V=ge.y,oe=Ie.tA,Ce=Ie.tB}),u.points=ue.concat(Pe),z?(u.crossCommands=[],t.loop(ie,function(ee,Ie){J.mt(ee[0].x,ee[0].y),!n(se)&&!n(se[Ie])&&(J.f(se[Ie]),u.crossCommands[Ie]=J.f(se[Ie]).command,se[Ie]&&se[Ie].type&&u.specialColor(u.crossCommands[Ie],se[Ie],u),J.mt(ee[0].x,ee[0].y)),J.lt(ee[1].x,ee[1].y).lt(ee[2].x,ee[2].y).lt(ee[3].x,ee[3].y).cp()}),Oe&&J.mt(ie[ie.length-1][1].x,ie[ie.length-1][1].y).lt(ie[ie.length-1][2].x,ie[ie.length-1][2].y).lt(ie[0][3].x,ie[0][3].y).lt(ie[0][0].x,ie[0][0].y).cp()):(t.loop(ue,function(ee,Ie){Ie==0?J.mt(ee.x,ee.y):J.lt(ee.x,ee.y)}),Oe&&(J.lt(ue[0].x,ue[0].y),J.cp()),t.loop(Pe,function(ee,Ie){Ie==0&&Oe?J.mt(ee.x,ee.y):J.lt(ee.x,ee.y)}),Oe&&J.lt(Pe[0].x,Pe[0].y),J.cp()),pe&&(t.loop(be,function(ee,Ie){Ie==0?pe.mt(ee.x,ee.y):pe.lt(ee.x,ee.y)}),Oe&&pe.lt(be[0].x,be[0].y).cp()),n($)||(t.loop(Pe,function(ee,Ie){Ie==0?Z.mt(ee.x,ee.y):Z.lt(ee.x,ee.y)}),Oe&&Z.lt(Pe[0].x,Pe[0].y).cp());function Le(ee){var Ie=N[ee],Re=B[ee],_e=re[ee],Ze=le[ee],at=G[ee];if(se)var Be=se[ee];n(Ie)&&(Ie=we,u.angles[ee]=Ie),n(Re)&&(Re=200,u.lengths[ee]=Re),n(_e)&&(_e=0,u.anglesA[ee]=_e),n(Ze)&&(Ze=0,u.anglesB[ee]=Ze),n(at)&&(at=0,u.anglesEnd[ee]=at),se&&n(Be)&&(Be=e,u.crossColors[ee]=Be),at=at+90;var He=180-at,et=Math.cos((we-Ie)*t.RAD),ge=Math.sin((we-Ie)*t.RAD),xe=new t.Point(0,0),he=new t.Point(Re,0);if(n(te))var Ge=new t.Point(Math.cos(fe*t.RAD)*oe,Math.sin(fe*t.RAD)*oe);else Ge=new t.Point(te.x*et-te.y*ge,te.x*ge+te.y*et);var qe=me(Re,Ge.x,Ge.y,_e,He),Fe=new t.Point(Re-qe.x,-qe.y),We;n(ae)?We=new t.Point(Math.cos(ke*t.RAD)*oe,Math.sin(ke*t.RAD)*Ce):We=new t.Point(ae.x*et-ae.y*ge,ae.x*ge+ae.y*et);var ce=me(Re,We.x,We.y,Ze,at),Ve=new t.Point(Re-ce.x,ce.y);return te=new t.Point(Fe.x-Re,Fe.y),ae=new t.Point(Ve.x-Re,Ve.y),we=Ie,{a:Ie,A:Ge,B:Fe,C:Ve,D:We,E:he,F:xe,tA:qe.t,tB:ce.t}}function me(ee,Ie,Re,_e,Ze){var at=Ze-90,Be=90-at,He=180-_e-Be,et=Math.tan(at*t.RAD)*Re,ge=ee-Ie-et,xe=ge/Math.sin(He*t.RAD)*Math.sin(_e*t.RAD),he=Math.sqrt(Math.pow(Re,2)+Math.pow(et,2)),Ge=xe+he,qe=Ge*Math.sin(at*t.RAD),Fe=Ge*Math.cos(at*t.RAD);return{x:qe,y:Fe,t:Ge}}}this.add=function(B,N,re,le,G,z,se,Oe){var J="lengths, angles, anglesA, anglesB, anglesEnd, cross, crossColors, close",pe;return(pe=st(u.add,arguments,J))?pe:(n(z)||(u.cross=z),n(Oe)||(u.close=Oe),n(B)||(Array.isArray(B)||(B=[B]),n(u.lengths)?u.lengths=B:u.lengths=u.lengths.concat(B)),n(N)||(Array.isArray(N)||(N=[N]),n(u.angles)?u.angles=N:u.angles=u.angles.concat(N)),n(re)||(Array.isArray(re)||(re=[re]),n(u.anglesA)?u.anglesA=re:u.anglesA=u.anglesA.concat(re)),n(le)||(Array.isArray(le)||(le=[le]),n(u.anglesB)?u.anglesB=le:u.anglesB=u.anglesB.concat(le)),n(G)||(Array.isArray(G)||(G=[G]),n(u.anglesEnd)?u.anglesEnd=G:u.anglesEnd=u.anglesEnd.concat(G)),n(se)||(n(u.crossColors)?dt&&tt("Flare() - must set crossColor for original object parameters"):(Array.isArray(se)||(se=[se]),n(u.crossColors)?u.crossColors=se:u.crossColors=u.crossColors.concat(se))),u.remake(),u)},this.remake=function(){return s=this.thicknessA,f=this.thicknessB,S(u.lengths,u.angles,u.anglesA,u.anglesB,u.anglesEnd,u.cross,u.crossColors,u.close),u},Object.defineProperty(u,"color",{get:function(){return e},set:function(B){n(B)&&(B=t.black),e=B,B&&B.type?u.specialColor(u.colorCommand,B,u):u.colorCommand.style=B}});var F,h;this.setColorRange=function(B,N){return n(N)?(F=u.color,h=B):n(B)?(F=u.color,h=N):(F=B,h=N),u};var b=0;Object.defineProperty(u,"colorRange",{get:function(){return b},set:function(B){b=B,!n(F)&&!n(h)&&(u.color=t.colorRange(F,h,B))}}),Object.defineProperty(u,"borderColor",{get:function(){return r},set:function(B){r=B,u.borderColorCommand?B&&B.type?u.specialColor(u.borderColorCommand,B,u):u.borderColorCommand.style=B:S()}}),Object.defineProperty(u,"borderWidth",{get:function(){return i},set:function(B){B>0||(B=0),i=B,!u.borderWidthCommand||i==0?S():(u.borderWidthCommand.width=i,A&&(u.borderDashedCommand.segments=[20,10],u.borderDashedCommand.offset=5))}}),Object.defineProperty(u,"spineColor",{get:function(){return C},set:function(B){n(B)&&(B=t.black),C=B,u.spineColorCommand?B&&B.type?u.specialColor(u.spineColorCommand,B,u):u.spineColorCommand.style=B:S()}}),Object.defineProperty(u,"spineBorderColor",{get:function(){return Y},set:function(B){Y=B,u.spineBorderColorCommand?B&&B.type?u.specialColor(u.spineBorderColorCommand,B,u):u.spineBorderColorCommand.style=B:S()}}),Object.defineProperty(u,"spineBorderWidth",{get:function(){return L},set:function(B){B>0||(B=0),L=B,!u.spineBorderWidthCommand||L==0?S():(u.spineBorderWidthCommand.width=L,_&&(u.spineBorderDashedCommand.segments=[20,10],u.spineBorderDashedCommand.offset=5))}}),Object.defineProperty(u,"closeColor",{get:function(){return $},set:function(B){n(B)&&(B=t.black),$=B,u.closeColorCommand?B&&B.type?u.specialColor(u.closeColorCommand,B,u):u.closeColorCommand.style=B:S()}}),Object.defineProperty(u,"closeBorderColor",{get:function(){return X},set:function(B){X=B,u.closeBorderColorCommand?B&&B.type?u.specialColor(u.closeBorderColorCommand,B,u):u.closeBorderColorCommand.style=B:S()}}),Object.defineProperty(u,"closeBorderWidth",{get:function(){return O},set:function(B){B>0||(B=0),O=B,!u.closeBorderWidthCommand||O==0?S():(u.closeBorderWidthCommand.width=O,R&&(u.closeBorderDashedCommand.segments=[20,10],u.closeBorderDashedCommand.offset=5))}}),Object.defineProperty(u,"pin",{get:function(){return c},set:function(B){B>0||(B=0),B>u.pinPoints.length-1&&(c=0),c=B;var N=u.pinPoints[c];N&&(u.regX=N.x,u.regY=N.y)}});var ye=t.boundsAroundPoints(u.points);this.setBounds(ye.x,ye.y,ye.width,ye.height),n(c)||(u.pin=c),this.mouseChildren=!1,K!==!1&&t.styleTransforms(this,d),this.clone=function(){return u.cloneProps(new t.Flare(e,r,i,o,t.copy(a),t.copy(s),t.copy(f),c,w,T,t.copy(p),t.copy(x),t.copy(P),t.copy(m),t.copy(v),I,t.copy(g),E,A,y,C,L,Y,_,k,$,O,X,R,Q,K,this.group,ne))}},t.extend(t.Flare,t.Container,["clone"],"zimContainer",!1),t.MultiFlare=function(e,r,i,l,a,s,f){var c="flares, pins, angles, endToEnd, style, group, inherit",w;if(w=st(t.MultiFlare,arguments,c,this))return w;De("53.7"),this.zimContainer_constructor(),this.type="MultiFlare",this.group=s;var T=a===!1?{}:t.getStyle(this.type,this.group,f),p=this;n(e)&&(e=T.flares!=null?T.flares:[]),Array.isArray(e)||(e=[e]),n(r)&&(r=T.pins!=null?T.pins:null),n(i)&&(i=T.angles!=null?T.angles:null),n(l)&&(l=T.endToEnd!=null?T.endToEnd:!1),p.flares=e,p.pins=r,p.angles=i,p.endToEnd=l,p.mouseChildren=!1,p.add=function(x,P){return n(x)||(n(P)&&(P=!0),Array.isArray(x)||(x=[x]),t.loop(x,function(m){P?p.flares.push(m.clone()):p.flares.push(m)}),p.remake(),p.stage&&p.stage.update()),p},p.remove=function(x){return n(x)||(Array.isArray(x)||(x=[x]),t.loop(x,function(P){var m=p.flares.indexOf(P);m>=0&&p.flares.splice(m,1)}),p.remake(),p.stage&&p.stage.update()),p},p.remake=function(){p.removeAllChildren(),t.loop(p.flares,function(x,P){if(r&&!n(r[P])&&(x.pin=r[P]),i&&!n(i[P])&&(x.rotation=i[P]),x.addTo(p),p.flares.push(x),l&&P>0){var m=e[P-1],v=m.pinPoints[m.pinPoints.length-1],I=m.localToLocal(v.x,v.y,p),g=x.pinPoints[0],E=x.localToLocal(g.x,g.y,p);x.mov(I.x-E.x,I.y-E.y)}})},p.remake(),a!==!1&&t.styleTransforms(this,T),this.clone=function(){return p.cloneProps(new t.MultiFlare(t.copy(e,!0),t.copy(r),t.copy(i),l,a,this.group,f))}},t.extend(t.MultiFlare,t.Container,["clone"],"zimContainer",!1),t.FlareBox=function(e,r,i,l,a,s,f,c,w,T,p){var x="width, height, color, borderColor, borderWidth, flares, corners, pins, style, group, inherit",P;if(P=st(t.FlareBox,arguments,x,this))return P;De("53.8"),this.group=T;var m=w===!1?{}:t.getStyle("FlareBox",this.group,p);n(e)&&(e=m.width!=null?m.width:220),n(r)&&(r=m.height!=null?m.height:80),this.zimContainer_constructor(e,r),this.type="FlareBox";var v=this;if(this.mouseChildren=!1,n(l)&&(l=m.borderColor!=null?m.borderColor:null),n(a)&&(a=m.borderWidth!=null?m.borderWidth:null),l<0||a<0?l=a=null:l!=null&&a==null&&(a=1),n(i)&&(i=m.color!=null?m.color:a>0?"rgba(0,0,0,0)":t.black),(n(a)||a>0)&&(!n(l)||!n(a))&&n(l)&&(l=t.black),n(s)&&(s=m.flares!=null?m.flares:null),n(f)&&(f=m.corners!=null?m.corners:null),n(c)&&(c=m.pins!=null?m.pins:null),v.backing=new t.Rectangle(e,r,i,l,a).addTo(this),!n(s)){if(s.type!="MultiFlare"){if(!Array.isArray(s)){if(s.type!="Flare")return;s=[s]}s=new t.MultiFlare(s,c)}s.addTo(v),v.multiFlare=s,v.flares=v.multiFlare.flares,s.loop(function(I,g){c&&!n(c[g])?I.pin=c[g]:n(I.pin)&&(I.pin=0),f&&!n(f[g])?I.corner=f[g]:n(I.corner)&&(I.corner=0),I.corner==1?I.loc(e,0):I.corner==2?I.loc(e,r):I.corner==3?I.loc(0,r):I.loc(0,0),I.rot((I.corner-I.pin)*90)}),w!==!1&&t.styleTransforms(this,m),this.clone=function(){return v.cloneProps(new t.FlareBox(e,r,i,l,a,t.copy(s,!0),t.copy(f),t.copy(c),w,this.group,p))}}},t.extend(t.FlareBox,t.Container,["clone"],"zimContainer",!1),t.Label=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O,X,R,Q,K,q,ne,U,D){var d="text, size, font, color, rollColor, shadowColor, shadowBlur, align, valign, bold, italic, variant, lineWidth, lineHeight, backing, outlineColor, outlineWidth, backgroundColor, backgroundBorderColor, backgroundBorderWidth, corner, backgroundDashed, padding, paddingH, paddingV, shiftH, shiftV, rollPersist, labelWidth, labelHeight, maxSize, splitWords, style, group, inherit",u;if(u=st(t.Label,arguments,d,this))return u;De("54"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Label",this.group=U;var o=ne===!1?{}:t.getStyle(this.type,this.group,D);n(e)&&(e=o.text!=null?o.text:"LABEL"),n(r)&&(r=o.size!=null?o.size:36),n(i)&&(i=o.font!=null?o.font:"arial"),n(l)&&(l=o.color!=null?o.color:t.black),n(T)&&(T=o.bold!=null?o.bold:!1),n(p)&&(p=o.italic!=null?o.italic:!1);var S=F(e,r,i,l,T,p);this.veeObj={text:S[0],size:S[1],font:S[2],color:S[3],bold:S[4],italic:S[5]};function F(){return arguments}e=t.Pick.choose(e);var h=!1;e===""&&(e=" ",h=!0),r=t.Pick.choose(r),i=t.Pick.choose(i),i=i.replace("+"," ");var b=["ttf","otf","woff2","woff","fnt"],ye=i.split(".");ye.length>0&&b.indexOf(ye[1])!=-1&&(i=ye[0]),l=t.Pick.choose(l),T=t.Pick.choose(T),p=t.Pick.choose(p),n(a)&&(a=o.rollColor!=null?o.rollColor:null),(n(s)||s=="ignore")&&(s=o.shadowColor!=null&&s!="ignore"?o.shadowColor:-1),(n(f)||f=="ignore")&&(f=o.shadowBlur!=null&&f!="ignore"?o.shadowBlur:14),n(c)&&(c=o.align!=null?o.align:"left"),n(w)&&(w=o.valign!=null?o.valign:"top"),(!n(I)||!n(o.outlineColor))&&n(g)&&(g=o.outlineWidth!=null?o.outlineWidth:Math.round(r*.2)),(!n(g)||!n(o.outlineWidth))&&n(I)&&(I=o.outlineColor!=null?o.outlineColor:t.black),n(g)&&(g=o.outlineWidth!=null?o.outlineWidth:0),(n(E)||E=="ignore")&&(E=o.backgroundColor!=null&&E!="ignore"?o.backgroundColor:null),n(A)&&(A=o.backgroundBorderColor!=null&&A!="ignore"?o.backgroundBorderColor:null),n(y)&&(y=o.backgroundBorderWidth!=null&&y!="ignore"?o.backgroundBorderWidth:null),(n(Y)||Y=="ignore")&&(Y=o.padding!=null&&Y!="ignore"?o.padding:10),n(_)&&(_=o.paddingH!=null?o.paddingH:Y),n(k)&&(k=o.paddingV!=null?o.paddingV:Y),n($)&&($=o.shiftH!=null?o.shiftH:0),n(O)&&(O=o.shiftV!=null?o.shiftV:0),n(x)&&(x=o.variant!=null?o.variant:!1),n(P)&&(P=o.lineWidth!=null?o.lineWidth:null),n(m)&&(m=o.lineHeight!=null?o.lineHeight:null),(n(v)||v=="ignore")&&(v=o.backing!=null&&v!="ignore"?o.backing.clone():null),n(X)&&(X=o.rollPersist!=null?o.rollPersist:!1),o.labelWidth!=null&&(P=o.labelWidth),n(R)||(P=R),c=="middle"&&(c="center"),n(Q)&&(Q=o.labelHeight!=null?o.labelHeight:null),n(K)&&(K=o.maxSize!=null?o.maxSize:null),r=K?Math.min(r,K):r,n(q)&&(q=o.splitWords!=null?o.splitWords:!1);var B=j.zdf&&j.zdf.retina,N=this;this.mouseChildren=!1,this.paddingV=k,this.paddingH=_,j.DIR&&j.DIR=="rtl"||!j.DIR&&t.DIR=="rtl"?c=="start"?c="right":c=="end"&&(c="left"):c=="start"?c="left":c=="end"&&(c="right");var re=[];re[0]=p?"italic":"normal",re[1]=x?"small-caps":"normal",re[2]=T?"bold":"normal",re[3]=r+"px",re[4]=i;var le=re.join(" ");e=String(e);var G,z=!1,se=P,Oe=Q;if(n(v)&&n(E)){var J=new Ne.Shape;N.hitArea=J}else se&&(se=se-_*2),Oe&&(Oe=Oe-k*2);function pe(ee){var Ie=new Ne.Text(ee,le,l);return Ie.lineWidth=se,Ie.lineHeight=m,Ie}G=pe(e);function Z(ee,Ie,Re){var _e=Math.ceil(se/Ie*Re.length),Ze=Re.substr(0,_e),at=pe(Ze),Be=at.getMeasuredWidth();if(Be>se)for(;Be>se;)_e--,Ze=Re.substr(0,_e),at=pe(Ze),Be=at.getMeasuredWidth();else if(Be<se){for(;Be<se;)_e++,Ze=Re.substr(0,_e),at=pe(Ze),Be=at.getMeasuredWidth();_e--,Ze=Re.substr(0,_e)}var He=Re.substr(_e,Re.length);return{endIndex:_e,start:Ze,end:He}}if(q&&se>r*1.2)for(var de=G.getMetrics(),V=0;de.width>se&&V<1e3;)V++,t.loop(de.lines,function(ee,Ie){ee=ee.replace(/^[\s\t]+/,"");var Re=pe(ee),_e=Re.getMeasuredWidth();if(_e>se){var Ze=Z(Re,_e,ee);return de.lines[Ie]=Ze.start,de.lines.length>Ie+1?(Ze.end.trim(),de.lines[Ie+1]=Ze.end+" "+de.lines[Ie+1]):de.lines.push(Ze.end),G=pe(de.lines.join(" ")),de=G.getMetrics(),!1}});if(this.label=G,G.textAlign=c,G.textBaseline="alphabetic",g>0){var fe=this.outlineLabel=G.clone();fe.color=I,fe.outline=g}s!=-1&&f>0&&(G.shadow=new Ne.Shadow(s,3,3,f)),this.addChild(G);function ke(){N.removeChild(N.background),N.background=new t.Rectangle(N.getBounds().width+_*2,N.getBounds().height+k*2,E,A,y,C,L,null,null,!1),t.center(N.background,N,0),N.setBounds(N.background.x,N.background.y,N.background.width,N.background.height)}function oe(){var ee=G.getBounds(),Ie=ee.y,Re=ee.height;if(se&&!Oe){var _e=ee.x,Ze=se;c=="right"?_e=ee.x-se+ee.width:c=="center"&&(_e=-se/2),G.setBounds(_e,Ie,Ze,Re),ee=G.getBounds()}var at;w=="baseline"?at=ee.y:w=="top"?(G.y=r-r/6,at=0):w=="center"||w=="middle"?(at=-ee.height/2,G.y=r*.3):at=-ee.height,N.setBounds(ee.x,at,o.width?o.width-Y*2:ee.width,o.height?o.height-Y*2:ee.height),N.hitArea&&N.hitArea.graphics.c().f("black").r(N.getBounds().x,N.getBounds().y,N.getBounds().width,N.getBounds().height),(w=="center"||w=="middle")&&(t.pos(G,null,0),t.mov(G,0,1)),Q||(v?z&&te():n(E)||ke()),w!="baseline"&&!B&&(G.y+=r/32),ae()}if(oe(),!n(v)){if(v.type=="Pattern"){if(N.backing=new t.Container(N.width+_*2,N.height+k*2,null,null,!1).centerReg(null,null,!1),s!=-1&&f>0){var Ce=new t.Rectangle(N.width+_*2-2,N.height+k-2,"#666",null,null,C,null,null,null,!1).center(N.backing);Ce.shadow=new Ne.Shadow(s,3,3,f)}var Me=new t.Rectangle(N.width+_*2,N.height+k*2,E,null,null,C,null,null,null,!1).addTo(N.backing);v.centerReg(Me),v.setMask(Me),N.backing.pattern=v}else N.backing=v;N.backing.center(N,0),v=N.backing,te(),z=!0}function te(){var ee=v.boundsToGlobal(),Ie=N.boundsToGlobal(ee,!0);N.setBounds(Ie.x,Ie.y,Ie.width,Ie.height)}function ae(){t.pos(G,c=="left"||c=="right"?v||N.background?_:0:null,w=="top"||w=="baseline"||w=="bottom"?v||N.background?k:0:null,c=="right",w=="bottom"),G.x+=$,G.y+=O}ae();function we(){fe&&(fe.x=G.x,fe.y=G.y,N.addChildAt(fe,N.background||N.backing?1:0))}we(),Object.defineProperty(N,"text",{get:function(){var ee=G.text==" "&&h?"":G.text;return ee},set:function(ee){h=!1,ee===""&&(ee=" ",h=!0),G.text=String(ee),G.setBounds(null),N.setBounds(null),oe(),fe&&(fe.text=String(ee)),!n(P)&&!n(Q)&&(me(),fe&&we())}}),Object.defineProperty(N,"size",{get:function(){return r},set:function(ee){r=K?Math.min(ee,K):ee,re[3]=r+"px",this.label.font=re.join(" "),fe&&(fe.font=re.join(" ")),G.setBounds(null),N.setBounds(null),oe(),we()}}),Object.defineProperty(N,"bold",{get:function(){return!!this.label.font.match("bold")},set:function(ee){T=ee,re[2]=ee?"bold":"normal",this.label.font=re.join(" "),fe&&(fe.font=re.join(" "))}}),Object.defineProperty(N,"italic",{get:function(){return!!this.label.font.match("italic")},set:function(ee){p=ee,re[0]=ee?"italic":"normal",this.label.font=re.join(" "),fe&&(fe.font=re.join(" "))}}),Object.defineProperty(N,"variant",{get:function(){return!!this.label.font.match("small-caps")},set:function(ee){x=ee,re[1]=ee?"small-caps":"normal",this.label.font=re.join(" "),fe&&(fe.font=re.join(" "))}}),Object.defineProperty(N,"font",{get:function(){return re[4]},set:function(ee){n(ee)||(i=ee,re[4]=ee,this.label.font=re.join(" "),fe&&(fe.font=re.join(" ")))}}),Object.defineProperty(N,"align",{get:function(){return c},set:function(ee){n(ee)||(c=ee,this.label.textAlign=c,fe&&(fe.textAlign=c),oe(),we())}}),Object.defineProperty(N,"valign",{get:function(){return w},set:function(ee){n(ee)||(w=ee,oe(),we())}}),Object.defineProperty(N,"color",{get:function(){return l},set:function(ee){a==l&&(a=ee),l=ee,G.color=l,!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&N.stage&&N.stage.update()}}),Object.defineProperty(N,"colorOnly",{get:function(){return l},set:function(ee){l=ee,G.color=l,!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&N.stage&&N.stage.update()}});var ue,Pe;this.setColorRange=function(ee,Ie){return n(Ie)?(ue=N.color,Pe=ee):n(ee)?(ue=N.color,Pe=Ie):(ue=ee,Pe=Ie),N};var ie=0;Object.defineProperty(N,"colorRange",{get:function(){return ie},set:function(ee){ie=ee,!n(ue)&&!n(Pe)&&(N.color=t.colorRange(ue,Pe,ee))}}),Object.defineProperty(N,"backgroundColor",{get:function(){return E},set:function(ee){E=ee,N.background?N.background.color=ee:N.backing?N.backing.color=ee:ke(),!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&N.stage&&N.stage.update()}}),Object.defineProperty(N,"outlineColor",{get:function(){return I},set:function(ee){I=ee,fe&&(fe.color=I),!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&N.stage&&N.stage.update()}}),Object.defineProperty(N,"rollColor",{get:function(){return a},set:function(ee){!N.mouseoverEvent&&ee&&be(),ee==null&&N.mouseoverEvent&&Le(),a=ee}}),this._enabled=!0,Object.defineProperty(N,"enabled",{get:function(){return N._enabled},set:function(ee){bt(N,ee),G.color=l,N.mouseChildren=!1,!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&N.stage&&N.stage.update()}}),this.showRollColor=function(ee){return n(ee)&&(ee=!0),ee?G.color=a:G.color=l,N.stage&&N.stage.update(),N};function be(){N.mouseoverEvent=N.on("mouseover",function(){N.showRollColor&&N.showRollColor()}),N.mouseoutEvent=N.on("mouseout",function(){N.rollPersist||N.showRollColor(!1)}),N.pressupEvent=N.on("pressup",function(){N.rollPersist&&N.showRollColor(!1)})}function Le(){N.off("mouseover",N.mouseoverEvent),N.off("mouseout",N.mouseoutEvent),N.off("pressup",N.pressupEvent)}a&&be(),Object.defineProperty(N,"labelWidth",{get:function(){return P},set:function(ee){ee>0&&(P=ee,se=P,(!n(v)||!n(E))&&se&&(se=se-_*2),N.label.lineWidth=se,fe&&(fe.lineWidth=se),G.setBounds(null),N.setBounds(null),oe(),Q&&me(),!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&N.stage&&N.stage.update())}}),Object.defineProperty(N,"labelHeight",{get:function(){return Q},set:function(ee){ee>0&&(Q=ee,Oe=Q,(!n(v)||!n(E))&&Oe&&(Oe=Oe-k*2),P&&me(),N.setBounds(null),!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&N.stage&&N.stage.update())}}),!n(P)&&!n(Q)&&me();function me(){N.size=K||200;for(var ee=0;m<Oe/2&&(N.height>Oe||N.width>se)&&(ee++,N.size=N.size/2,!(ee>50)););for(ee=0;N.height<=Oe&&N.width<=se&&(ee++,N.size=Math.ceil(N.size+1),!(ee>50)););N.size=N.size-1,we(),G.setBounds(null);var Ie=G.getBounds(),Re=Ie.y,_e=Ie.height;Oe&&(w=="bottom"?Re=Re-Oe+_e:(w=="center"||w=="middle")&&(Re=(Re+Re-Oe+_e)/2),_e=Oe),G.setBounds(Ie.x,Re,Ie.width,_e),N.setBounds(null),Ie=N.getBounds(),N.setBounds(Ie.x,Ie.y,Ie.width,Ie.height),v?z&&te():n(E)||ke()}ne!==!1&&t.styleTransforms(this,o),this.clone=function(ee){return N.cloneProps(new t.Label(ee||!t.isPick(S[0])?N.text:S[0],ee||!t.isPick(S[1])?r:S[1],ee||!t.isPick(S[2])?i:S[2],ee||!t.isPick(S[3])?l:S[3],a,s,f,c,w,ee||!t.isPick(S[4])?T:S[4],ee||!t.isPick(S[5])?p:S[5],x,P,m,n(v)?null:v.clone(ee),I,g,E,A,y,C,L,Y,_,k,$,O,X,R,Q,K,q,ne,this.group,D))}},t.extend(t.Label,t.Container,"clone","zimContainer"),t.LabelOnPath=function(e,r,i,l,a,s,f,c,w,T,p,x){var P="label, path, percentAngle, percents, showPath, allowToggle, interactive, onTop, rtl, style, group, inherit",m;if(m=st(t.LabelOnPath,arguments,P,this))return m;De("54.5"),this.zimContainer_constructor(null,null,null,null,!1),this.type="LabelOnPath",this.group=p;var v=T===!1?{}:t.getStyle(this.type,this.group,x);n(e)&&(e=v.label!=null?v.label:new t.Label("Label on Path")),n(r)&&(r=v.path!=null?v.path:new t.Squiggle({points:[[0,0,0,0,-86,57,86,-57],[300,150,0,0,-133,21,133,-21]]})),n(i)&&(i=v.percentAngle!=null?v.percentAngle:100),n(l)&&(l=v.percents!=null?v.percents:null),n(a)&&(a=v.showPath!=null?v.showPath:!0),n(s)&&(s=v.allowToggle!=null?v.allowToggle:!0),n(f)&&(f=v.interactive!=null?v.interactive:!0),n(c)&&(c=v.onTop!=null?v.onTop:!1),n(w)&&(w=v.rtl!=null?v.rtl:j.DIR=="rtl"||t.DIR=="rtl"),w&&r.reversePoints();var I=e.color;r.addTo(this);var g=this;this.path=r,this.allowToggle=s,r.interactive=f,typeof e=="string"&&(e=new t.Label(e));var E=r.alpha;a||r.alp(0),r.onTop=c;var A=this.letters=new t.Container().addTo(this);if(!l){l=[];for(var y=0;y<e.text.length;y++)l.push(t.decimals(1/(e.text.length-(r.type=="Blob"?0:1))*100*y))}this.percents=l;function C(){var Y;for(Y=A.numChildren-1;Y>=0;Y--)A.getChildAt(Y).dispose();for(g.numLetters=e.text.length,Y=0;Y<g.numLetters;Y++){var _=e.clone();_.text=e.text[Y],_.centerReg(A).reg(null,_.height),_.text!=""&&_.text!=" "&&_.expand(0),g.allowToggle&&_.cur("pointer"),_.on("mousedown",function(){g.allowToggle&&g.toggle()})}g.resize()}this.resize=function(){for(var Y=r.segmentRatios,_=r.segmentPoints,k=0;k<this.numLetters;k++){var $=r.getCurvePoint(l[k]/100,Y,_,!0);if($){var O=this.globalToLocal($.x,$.y);O&&(A.getChildAt(k).loc(O).rot(($.angle>180?$.angle-360:$.angle)*i/100),w&&(A.getChildAt(k).rotation+=180))}}return this},C(),this.showPath=function(Y){return this.toggle(!0),r.toggle(Y),this},this.hidePath=function(){return this.toggle(!1),this},Object.defineProperty(g,"text",{get:function(){return e.text},set:function(Y){e.text=Y,l=[];for(var _=0;_<e.text.length;_++)l.push(t.decimals(1/(e.text.length-(r.type=="Blob"?0:1))*100*_));C()}}),Object.defineProperty(this,"color",{get:function(){return I},set:function(Y){I=Y;for(var _=0;_<g.letters.numChildren;_++)g.letters.getChildAt(_).color=I;g.stage&&g.stage.update()}}),Object.defineProperty(g,"interactive",{get:function(){return f},set:function(Y){f=Y,r.interactive=Y,this.ticker&&t.Ticker.remove(this.ticker),f&&(this.ticker=t.Ticker.add(function(){g.resize()}))}}),this.interactive&&(this.ticker=t.Ticker.add(function(){g.resize()}));var L=g.toggled=a;this.toggle=function(Y){if(this.allowToggle)return n(Y)?L=!L:Y?L=!0:L=!1,L?(r.alp(E),this.interactive&&(r.showControls(),A.mouseEnabled=!1,A.mouseChildren=!1,A.cur("default"),this.controlHideEvent&&r.off("controlshide",this.controlHideEvent),this.controlHideEvent=r.on("controlshide",function(){A.mouseEnabled=!0,A.mouseChildren=!0,A.cur("pointer"),E=r.alpha,r.alp(0),L=!1,g.toggled=L,g.stage&&g.stage.update()},null,!0))):(E=r.alpha,r.alp(0),A.mouseEnabled=!0,A.mouseChildren=!0,A.cur("pointer")),g.toggled=L,g.stage&&g.stage.update(),g},g.toggle(!0),T!==!1&&t.styleTransforms(this,v),this.clone=function(){return g.cloneProps(new t.LabelOnPath(g.label.clone(),g.path.clone(),i,t.copy(l),a,s,f,c,w,T,this.group,x))},this.dispose=function(Y,_,k){return this.ticker&&t.Ticker.remove(this.ticker),k||this.zimContainer_dispose(!0),!0}},t.extend(t.LabelOnPath,t.Container,["clone","dispose"],"zimContainer",!1),t.LabelOnArc=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E){var A="label, size, font, color, radius, flip, spacing, letterSpacing, angles, showCircle, arcColor, arcBorderColor, arcBorderWidth, radiusSpread, rtl, style, group, inherit",y;if(y=st(t.LabelOnArc,arguments,A,this))return y;De("54.55"),this.group=g;var C=I===!1?{}:t.getStyle("LabelOnArc",this.group,E);n(r)&&(r=C.size!=null?C.size:30),n(e)&&(e=C.label!=null?C.label:new t.Label("Label on Arc",r)),n(i)&&(i=C.font!=null?C.font:"verdana"),n(l)&&(l=C.color!=null?C.color:t.white),n(a)&&(a=C.radius!=null?C.radius:100),n(s)&&(s=C.flip!=null?C.flip:!1),n(f)&&(f=C.spacing!=null?C.spacing:0),n(c)&&(c=C.letterSpacing!=null?C.letterSpacing:5),n(w)&&(w=C.angles!=null?C.angles:null);var L=!n(w),Y=t.copy(w);n(T)&&(T=C.showCircle!=null?C.showCircle:!1),n(p)&&(p=C.arcColor!=null?C.arcColor:null),n(x)&&(x=C.arcBorderColor!=null?C.arcBorderColor:null),n(P)&&(P=C.arcBorderWidth!=null?C.arcBorderWidth:null),n(m)&&(m=C.radiusSpread!=null?C.radiusSpread:!1),n(v)&&(v=C.rtl!=null?C.rtl:j.DIR=="rtl"||t.DIR=="rtl");var _=this.outerRadius=a+f+e.height;this.innerRadius=a+f,this.zimContainer_constructor(-_,-_,_*2,_*2,!1),this.type="LabelOnArc";var k=this;e.type!="Label"&&(e=new t.Label(e,r,i,l)),e.text;var $,O,X,R,Q,K;function q(){if(k.disposeAllChildren(),s){var D=e.text.split("").reverse().join("");e.text=D}$=k.letters=new t.Container(k.width,k.height).centerReg(k),k.numLetters=e.text.length,k.letterHeight=e.height,O=k.labels=[];var d;for(d=0;d<k.numLetters;d++){var u=e.clone();O.push(u),u.text=e.text[d],u.letterHolder=new t.Container(u.width,u.height),u.centerReg(u.letterHolder).rot(s?180:0)}if(v&&O.reverse(),R=k.circle=new t.Circle(a),T&&R.addTo(k),X=k.arc=new t.Shape().addTo(k),ne(),w){for(Q=0,d=0;d<w.length;d++)Q+=w[d];Q+=w[w.length-1]/2}U()}q();function ne(){Q=0,K=[0];for(var D=0;D<k.numLetters;D++){var d=O[D],u=Math.atan((d.width+c)/2/(a+f))*180/Math.PI*2;K.push(u),Q+=u,d.letterHolder.centerReg($).reg(null,a+f+d.height+(s?d.height*.13:0))}k.circle.radius=a,(p||x||P)&&(P>0&&n(x)?x=t.black:n(P)&&!n(x)&&(P=2),X.graphics.c().f(null).s(x).ss(P).arc(0,0,a,(k.startAngle-90)*Math.PI/180,(k.startAngle-90+Q)*Math.PI/180))}function U(){var D;if(!L)for(w=[],D=0;D<K.length-1;D++)w[D]=Math.round((K[D]+K[D+1])/2*100)/100;k.angles=w,k.startAngle=-Q/2;var d=k.startAngle;for(D=0;D<$.numChildren;D++){var u=$.getChildAt(D);d=u.rotation=d+w[D]}}Object.defineProperty(this,"radius",{get:function(){return a},set:function(D){a=D,ne(),!L&&!m&&U()}}),Object.defineProperty(this,"color",{get:function(){return l},set:function(D){l=D;for(var d=0;d<k.labels.length;d++)k.labels[d].color=l;k.stage&&k.stage.update()}}),Object.defineProperty(k,"text",{get:function(){return e.text},set:function(D){e.text=D,Y?w=t.copy(Y):w=null,q()}}),I!==!1&&t.styleTransforms(this,C),this.clone=function(){return k.cloneProps(new t.LabelOnArc(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,this.group,E))}},t.extend(t.LabelOnArc,t.Container,"clone","zimContainer",!1),t.LabelLetters=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v){var I="label, align, valign, letterSpacing, letterSpacings, lineSpacing, lineSpacings, lineHeight, lineAlign, lineValign, cache, rtl, style, group, inherit",g;if(g=st(t.LabelLetters,arguments,I,this))return g;De("54.57"),this.group=m;var E=P===!1?{}:t.getStyle("LabelLetters",this.group,v);n(e)&&(e=E.label!=null?E.label:new t.Label("Label Letters")),n(r)&&(r=E.align!=null?E.align:"center"),n(i)&&(i=E.valign!=null?E.valign:"center"),n(l)&&(l=E.letterSpacing!=null?E.letterSpacing:5),n(a)&&(a=E.letterSpacings!=null?E.letterSpacings:null),n(c)&&(c=E.lineHeight!=null?E.lineHeight:null),n(s)&&(s=E.lineSpacing!=null?E.lineSpacing:5),n(f)&&(f=E.lineSpacings!=null?E.lineSpacings:null),n(x)&&(x=E.rtl!=null?E.rtl:!1),n(w)&&(w=E.lineAlign!=null?E.lineAlign:x?"right":"left"),n(T)&&(T=E.lineValign!=null?E.lineValign:"bottom"),n(p)&&(p=E.cache!=null?E.cache:!1),this.zimContainer_constructor(null,null,null,null,!1),this.type="LabelLetters";var A=this,y=A.letterData=[],C,L;e.type!="Label"?(L=Y(e),y=L.data,e=new t.Label(L.text)):(L=Y(e.text),y=L.data,e.text=L.text),A.text=L.original,A._color=e.color,j.DIR&&j.DIR=="rtl"||!j.DIR&&t.DIR=="rtl"?w=="start"?w="right":w=="end"&&(w="left"):w=="start"?w="left":w=="end"&&(w="right");function Y(fe){var ke=[];function oe(Pe){return Pe.split("").reverse().join("")}if(x){Oe=-1,fe=fe.replace(/[\u0591-\u07FF]+/ig,oe),fe=fe.replace(/([^\u0591-\u07FF ])([\u0591-\u07FF])/ig,"$1-!!-$2"),fe=fe.replace(/([\u0591-\u07FF])([^\u0591-\u07FF ])/ig,"$1-!!-$2"),fe=fe.replace(/([^\u0591-\u07FF]) ([\u0591-\u07FF])/ig,"$1-!!- -!!-$2"),fe=fe.replace(/([\u0591-\u07FF]) ([^\u0591-\u07FF])/ig,"$1-!!- -!!-$2");var Ce=fe.split(/-!!-/g);t.loop(Ce,function(Pe,ie){Pe.match(/[\u0591-\u07FF]/i)&&(Ce[ie]=Pe.split(" ").reverse().join(" "))}),fe=Ce.join("")}fe=fe.replace(/\n|\r/g,"<br>"),fe=fe.replace(/<strong>|<strong \/>|<strong\/>/gi,"<b>"),fe=fe.replace(/<\/strong>/gi,"</b>"),fe=fe.replace(/<em>|<em \/>|<em\/>/gi,"<i>"),fe=fe.replace(/<\/em>/gi,"</i>"),fe=fe.replace(/\\n|\\r/g,"<br>"),fe=fe.replace(/<br>|<br \/>|<br\/>(<\/br>)?/gi,"<br>"),fe=fe.replace(/<b/gi,"<b"),fe=fe.replace(/<i/gi,"<i"),fe=fe.replace(/<u/gi,"<u"),fe=fe.replace(/<br/gi,"<br"),fe=fe.replace(/<a/gi,"<a"),fe=fe.replace(/<font/gi,"<font");var Me=[/<(a|i|u|f|br|\/a|\/i|\/u|\/f|\/b)[^>]*>/g,/<(a|i|u|f|br|\/a|\/i|\/u|\/f|b)[^>]*>/g,/<(b|i|u|f|br|\/b|\/i|\/u|\/f|\/a)[^>]*>/g,/<(b|i|u|f|br|\/b|\/i|\/u|\/f|a)[^>]*>/g,/<(b|a|u|f|br|\/b|\/a|\/u|\/f|\/i)[^>]*>/g,/<(b|a|u|f|br|\/b|\/a|\/u|\/f|i)[^>]*>/g,/<(b|a|i|f|br|\/b|\/a|\/i|\/f|\/u)[^>]*>/g,/<(b|a|i|f|br|\/b|\/a|\/i|\/f|u)[^>]*>/g,/<(b|a|i|u|br|\/b|\/a|\/i|\/u|\/f)[^>]*>/g,/<(b|a|i|u|br|\/b|\/a|\/i|\/u|f)[^>]*>/g],te=["b","a","i","u","font"],ae;t.loop(te,function(Pe,ie){ae=fe.replace(Me[ie*2],"");var be;Pe=="font"?be=ae.split("<font "):Pe=="a"?be=ae.split("<a "):be=ae.split("<"+Pe+">"),ue(be,Pe,0),ae=fe.replace(Me[ie*2+1],""),be=ae.split("</"+Pe+">"),ue(be,Pe,1)}),ae=fe.replace(/<br>/gi,"@^#"),ae=ae.replace(/<(b|a|i|u|f|\/b|\/a|\/i|\/u|\/f)[^>]*>/g,"");var we=ae.split("@^#");C=we.join(`
`),ae=we.join(""),ue(we,"br",0);function ue(Pe,ie,be){if(Pe.length>1)if((ie=="font"||ie=="a")&&be==0){var Le=Pe[0].length;t.loop(Pe,function(ee,Ie){if(Ie!=0){var Re=ke[Le];Re||(ke[Le]=[]),Re=ke[Le];var _e=ee.split(">");Re[be]?Re[be].push(ie+" "+_e[0]):Re[be]=[ie+" "+_e[0]],Le+=_e[1].length}})}else{Pe.pop();var me=0;t.loop(Pe,function(ee){me+=ee.length;var Ie=ke[me];Ie||(ke[me]=[]),Ie=ke[me],Ie[be]?Ie[be].push(ie):Ie[be]=[ie]})}}return{text:ae,data:ke,original:C}}A.numLetters=e.text.length;var _=!n(a);a&&!Array.isArray(a)&&(a=null);var k;if(a)for(k=0;k<A.numLetters;k++)n(a[k])&&(a[k]=l);else for(a=[],k=0;k<A.numLetters;k++)a.push(l);if(A.letterSpacings=a,f&&!Array.isArray(f)&&(f=null),f)for(k=0;k<A.numLetters-1;k++)n(f[k])&&(f[k]=s);else for(f=[],k=0;k<A.numLetters-1;k++)f.push(s);A.lineSpacings=f,A.labels=[],A.lines=[[]];var $=[],O=[],X=[0],R=0,Q=0,K=0,q=0,ne=0,U=y,D=!1,d=!1,u=!1,o=!1,S=!1,F=!1,h=!1,b=!1,ye=!1,B=!1,N=!1,re=!1;for(A.rolls=[[]],k=0;k<A.numLetters;k++){o=!1,U[k]&&(U[k][1]&&(U[k][1].indexOf("b")>=0&&(D=!1),U[k][1].indexOf("i")>=0&&(d=!1),U[k][1].indexOf("u")>=0&&(u=!1),t.loop(U[k][1],function(fe){if(fe.match(/^font/i)){S=!1,N=!1,re&&A.rolls.push([]),re=!1,F=!1,b=!1,h=!1;return}if(fe.match(/^a/i)){ye=!1,B=!1;return}})),U[k][0]&&(U[k][0].indexOf("b")>=0&&(D=!0),U[k][0].indexOf("i")>=0&&(d=!0),U[k][0].indexOf("u")>=0&&(u=!0),o=0,t.loop(U[k][0],function(fe){fe=="br"&&o++}),t.loop(U[k][0],function(fe){var ke,oe;if(fe.match(/^font/i)){ke=fe.match(/ color\s?=\s?(\S*)/i),ke&&(S=ke[1],oe=t.colors.indexOf(S),oe>=0&&(S=t.colorsHex[oe]),S=S.replace(/'/g,"")),ke=fe.match(/size\s?=\s?(\S*)/i),ke&&(F=ke[1]),ke=fe.match(/backgroundColor\s?=\s?(\S*)/i),ke&&(N=ke[1],oe=t.colors.indexOf(N),oe>=0&&(N=t.colorsHex[oe]),N=N.replace(/'/g,"")),ke=fe.match(/rollBackgroundColor\s?=\s?(\S*)/i),ke&&(re=ke[1],oe=t.colors.indexOf(re),oe>=0&&(re=t.colorsHex[oe]),re=re.replace(/'/g,"")),ke=fe.match(/group\s?=\s?(\S*)/i),ke&&(h=ke[1]),ke=fe.match(/family\s?=\s?(.*)/i),ke&&(b=ke[1],b=b.split(/\ssize\s?=|\scolor\s?=|\sgroup\s?=/i)[0]);return}if(fe.match(/^a/i)){ke=fe.match(/href\s?=\s?(\S*)/i),ke&&(ye=ke[1]),ke=fe.match(/target\s?=\s?(\S*)/i),ke&&(B=ke[1]);return}})));var le;h?le=new t.Label({text:e.text[k],group:h}):(le=e.clone(),le.text=e.text[k]),A.labels.push(le),D&&(le.bold=!0),d&&(le.italic=!0),S&&(le.color=S),N&&(le.backgroundColor=N);var G=_||n(le.backgroundColor)?a[k]:-.5;re&&(le.rollIndex=A.rolls.length-1,le.zrbc=re,le.zobc=le.backgroundColor,A.rolls[le.rollIndex].push(le),le.expand(0),le.on("mouseover",z),le.on("mouseout",se)),ye&&(le.expand(G,0),le.zurl=ye,le.ztar=B,le.cur(),le.on("click",function(fe){var ke=fe.currentTarget;se(fe),ke.ztar||(ke.ztar="_self"),nr(ke.zurl,ke.ztar)})),b&&(le.font=b),F&&(le.size=F),o&&(R+=(n(c)?K:c)+f[q],X.push(R),O.push(n(c)?K:c),$.push(Q),ne=Math.max(ne,Q)),o&&(o>1&&t.loop(o-1,function(){A.lines.push([]),R+=(n(c)?K:c)+f[q],X.push(R),O.push(n(c)?K:c),$.push(0),q++}),K=0,Q=0,A.lines.push([]),q++),Q+=le.width+G,K=Math.max(K,le.height),k==A.numLetters-1&&($.push(Q),O.push(K),ne=Math.max(ne,Q)),A.lines[q].push(le),u&&(le.underline=new t.Line(le.width+G+1,1,le.color).center(le,this).mov(0,le.height/2))}function z(fe){var ke=fe.currentTarget,oe=A.rolls[ke.rollIndex];t.loop(oe,function(Ce){Ce.backgroundColor=ke.zrbc}),ke.stage&&ke.stage.update()}function se(fe){var ke=fe.currentTarget,oe=A.rolls[ke.rollIndex];t.loop(oe,function(Ce){Ce.backgroundColor=ke.zobc}),ke.stage&&ke.stage.update()}for(var Oe=0,J=0;J<A.lines.length;J++){var pe=A.lines[J];Q=$[J],K=O[J],R=X[J];var Z,de;for(w=="left"?Z=0:w=="right"?Z=ne-Q:Z=(ne-Q)/2,de=R,k=0;k<pe.length;k++){Oe++,p&&le.cache(),le=pe[k],le.regX=r=="left"?0:r=="right"?le.width:le.width/2,le.regY=i=="top"?0:i=="bottom"?le.height:le.height/2;var V=de+(i=="top"?0:i=="bottom"?le.height:le.height/2);T=="center"||T=="middle"?V+=(O[J]-le.height)/2:T=="bottom"&&(V+=O[J]-le.height),G=_||n(le.backgroundColor)?a[Oe-1]:-.5,r=="left"?(le.loc(Z,V,this),Z=le.x+le.width+G):r=="right"?(le.loc(Z+le.width,V,this),Z=le.x+G):(le.loc(Z+le.width/2,V,this),Z=le.x+le.width/2+G)}}this.getBounds()||this.setBounds(0,0,0,0),this.regX=this.getBounds().x,this.regY=this.getBounds().y,Object.defineProperty(this,"color",{get:function(){return this._color},set:function(fe){this._color=fe;for(var ke=0;ke<A.numChildren;ke++)A.getChildAt(ke).color=this._color;A.stage&&A.stage.update()}}),this.dispose=function(){t.gD(this),t.loop(A.labels,function(fe){fe.removeFrom(),fe.dispose()}),A.removeFrom()},P!==!1&&t.styleTransforms(this,E),this.clone=function(){return A.cloneProps(new t.LabelLetters(e,r,i,l,a,s,f,c,w,T,p,x,P,this.group,v))}},t.extend(t.LabelLetters,t.Container,"clone","zimContainer",!1),t.Emoji=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g){var E="code, size, monochrome, italic, backgroundColor, backgroundBorderColor, backgroundBorderWidth, corner, backing, padding, paddingH, paddingV, shiftH, shiftV, style, group, inherit",A;if(A=st(t.Emoji,arguments,E,this))return A;De("54.58"),this.group=I;var y=v===!1?{}:t.getStyle("Emoji",this.group,g);n(e)&&(e=y.code!=null?y.code:"\u{1F642}"),n(r)&&(r=y.size!=null?y.size:30),n(i)&&(i=y.monochrome!=null?y.monochrome:!1),n(l)&&(l=y.italic!=null?y.italic:!1),(n(a)||a=="ignore")&&(a=y.backgroundColor!=null&&a!="ignore"?y.backgroundColor:null),n(s)&&(s=y.backgroundBorderColor!=null&&s!="ignore"?y.backgroundBorderColor:null),n(f)&&(f=y.backgroundBorderWidth!=null&&f!="ignore"?y.backgroundBorderWidth:null),(n(T)||T=="ignore")&&(T=y.padding!=null&&T!="ignore"?y.padding:10),n(p)&&(p=y.paddingH!=null?y.paddingH:T),n(x)&&(x=y.paddingV!=null?y.paddingV:T),n(P)&&(P=y.shiftH!=null?y.shiftH:0),n(m)&&(m=y.shiftV!=null?y.shiftV:0);var C=L(e,r);this.veeObj={code:C[0],size:C[1]};function L(){return arguments}e=t.Pick.choose(e),r=t.Pick.choose(r),e.substring(0,2)=="U+"&&(e=t.unicodeToUTF(e)),this.zimLabel_constructor(e,r,null,null,null,null,null,null,null,null,l,null,null,null,w,null,null,a,null,null,c,null,T,p,x,P,m),this.type="Emoji",this.code=e,this.size=r;var Y=this,_=this.getBounds(),k=5,$=3;this.bounds=this.setBounds(_.x+$,_.y-k+1,_.width-$*2,_.height+k),i&&(this.saturation=-100);var O=i;Object.defineProperty(Y,"monochrome",{get:function(){return O},set:function(X){X!=O&&(O=X,X&&(this.saturation=X?-100:0))}}),this.cache=function(X,R,Q,K){return n(X)?(R=this.getBounds(),this.zimLabel_cache(R.x-20,R.y-20,R.width+40,R.height+40)):this.zimLabel_cache(X,R,Q,K),Y.z_bc=Y.canvas=Y.cacheCanvas,this},v!==!1&&t.styleTransforms(this,y),this.clone=function(X){return Y.cloneProps(new t.Emoji(X||!t.isPick(C[0])?e:C[0],X||!t.isPick(C[1])?Y.size:C[1],i,l,a,s,f,c,w,T,p,x,P,m,v,Y.group,g))}},t.extend(t.Emoji,t.Label,["clone","cache"],"zimLabel",!1),t.Button=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O,X,R,Q,K,q,ne,U,D,d,u,o,S,F,h,b,ye,B,N,re,le,G,z,se,Oe,J,pe,Z,de,V,fe,ke,oe,Ce,Me,te,ae,we,ue,Pe,ie,be){var Le="width, height, label, backgroundColor, rollBackgroundColor, downBackgroundColor, color, rollColor, downColor, borderColor, borderWidth, rollBorderColor, downBorderColor, backing, rollBacking, downBacking, icon, rollIcon, downIcon, corner, dashed, shadowColor, shadowBlur, gradient, gloss, align, valign, indent, indentH, indentV, hitPadding, autoPadding, autoPaddingH, autoPaddingV, rollPersist, toggle, toggleBackgroundColor, rollToggleBackgroundColor, downToggleBackgroundColor, toggleColor, rollToggleColor, downToggleColor, toggleBacking, rollToggleBacking, downToggleBacking, toggleIcon, rollToggleIcon, downToggleIcon, toggleEvent, wait, waitTime, waitBackgroundColor, rollWaitBackgroundColor, downWaitBackgroundColor, waitColor, rollWaitColor, downWaitColor, waitBacking, rollWaitBacking, downWaitBacking, waitIcon, rollWaitIcon, downWaitIcon, waitModal, waitEnabled, style, group, inherit",me;if(me=st(t.Button,arguments,Le,this))return me;De("55"),this.group=ie;var ee=Pe===!1?{}:t.getStyle("Button",ie,be);n(e)&&(e=ee.width!=null?ee.width:200),n(r)&&(r=ee.height!=null?ee.height:60),n(j.M)&&(j.M=t.mobile());var Ie=f,Re=c,_e=w;n(f)&&(f=ee.color!=null?ee.color:t.white),n(c)&&(c=ee.rollColor!=null?ee.rollColor:t.white),n(q)&&(q=ee.autoPadding!=null?ee.autoPadding:20),n(ne)&&(ne=ee.autoPaddingH!=null?ee.autoPaddingH:q),n(U)&&(U=ee.autoPaddingV!=null?ee.autoPaddingV:q),n($)&&($=ee.align!=null?ee.align:"center"),n(O)&&(O=ee.valign!=null?ee.valign:"center"),n(i)&&(n(g)?i=ee.label!=null?ee.label:"PRESS":i=""),typeof i=="string"||typeof i=="number"?i=new t.Label({text:i,size:ee.size!=null?ee.size:36,font:ee.font!=null?ee.font:"arial",color:ee.color!=null&&Ie==null?ee.color:f,rollColor:ee.rollColor&&Re==null!=null?ee.rollColor:c,align:$,valign:O,rollPersist:ee.rollPersist!=null?ee.rollPersist:!1,backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",shiftV:ee.shiftV!=null?ee.shiftV:0,shiftH:ee.shiftH!=null?ee.shiftH:0,style:!1,group:this.group}):(n(Ie)||(i.color=Ie),f=i.color,(n(i.rollColor)||!n(Re))&&(i.rollColor=c),c=i.rollColor),n(w)&&(w=ee.downColor!=null?ee.downColor:c),e=="auto"&&(e=i.width+ne*2),r=="auto"&&(r=i.height+U*2),this.zimContainer_constructor(e,r,null,null,!1),this.type="Button",n(l)&&(l=ee.backgroundColor!=null?ee.backgroundColor:t.purple),n(a)&&(a=ee.rollBackgroundColor!=null?ee.rollBackgroundColor:l.lighten(.2)),n(s)&&(s=ee.downBackgroundColor!=null?ee.downBackgroundColor:a);var Ze=at(l,a,s,f,c,w);this.veeObj={backgroundColor:Ze[0],rollBackgroundColor:Ze[1],downBackgroundColor:Ze[2],color:Ze[3],rollColor:Ze[4],downColor:Ze[5]};function at(){return arguments}l=nt(l),a=nt(a),s=nt(s),f=nt(f),c=nt(c),w=nt(w);var Be=T,He=p;n(T)&&(T=ee.borderColor!=null?ee.borderColor:null),n(p)&&(p=ee.borderWidth!=null?ee.borderWidth:null),T<0||p<0?T=p=null:T!=null&&p==null&&(p=1),n(x)&&(x=ee.rollBorderColor!=null?ee.rollBorderColor:T),n(P)&&(P=ee.downBorderColor!=null?ee.downBorderColor:x),n(y)&&(y=ee.corner!=null?ee.corner:10),n(L)&&(L=ee.shadowColor!=null?ee.shadowColor:"rgba(0,0,0,.3)"),n(Y)&&(Y=ee.shadowBlur!=null?ee.shadowBlur:14),n(K)&&(K=ee.hitPadding!=null?ee.hitPadding:0),n(X)&&(X=ee.indent!=null?ee.indent:10),n(R)&&(R=ee.indentH!=null?ee.indentH:X),n(Q)&&(Q=ee.indentV!=null?ee.indentV:X),n(_)&&(_=ee.gradient!=null?ee.gradient:0),n(k)&&(k=ee.gloss!=null?ee.gloss:0);var et=(!n(d)||!n(ye)||!n(B)||!n(N)||!n(re)||!n(le)||!n(G))&&n(se)&&n(ke)&&n(oe);et&&n(z)&&(z=j.M?"mousedown":"click"),n(D)&&(D=ee.rollPersist!=null?ee.rollPersist:!1),this.rollPersist=D,n(C)&&(C=ee.dashed!=null?ee.dashed:!1),!n(d)&&d.type=="Label"&&dt&&tt("Button() - do not pass Label to toggle parameter - just pass a String"),n(u)&&(u=ee.toggleBackgroundColor!=null?ee.toggleBackgroundColor:l),n(o)&&(o=ee.rollToggleBackgroundColor!=null?ee.rollToggleBackgroundColor:a),n(S)&&(S=ee.downToggleBackgroundColor!=null?ee.downToggleBackgroundColor:o),n(F)&&(F=ee.toggleColor!=null?ee.toggleColor:i.color),n(h)&&(h=ee.rollToggleColor!=null?ee.rollToggleColor:i.rollColor),n(b)&&(b=ee.downToggleColor!=null?ee.downToggleColor:i.rollToggleColor),n(J)&&(J=ee.waitBackgroundColor!=null?ee.waitBackgroundColor:l),n(pe)&&(pe=ee.rollWaitBackgroundColor!=null?ee.rollWaitBackgroundColor:a),n(Z)&&(Z=ee.downWaitBackgroundColor!=null?ee.downWaitBackgroundColor:a),n(de)&&(de=ee.waitColor!=null?ee.waitColor:i.color),n(V)&&(V=ee.rollWaitColor!=null?ee.rollWaitColor:i.rollColor),n(fe)&&(fe=ee.downWaitColor!=null?ee.downWaitColor:V);var ge=this;this.mouseChildren=!1,this.cur("pointer"),ge.focus=!1,ge.rolled=!1;var xe=wt(Oe);n(m)&&(m=ee.backing!=null?ee.backing.clone():null),n(m)?ge.backing=new t.Rectangle(e,r,l,null,null,y,C,null,null,!1).centerReg(null,null,!1):ge.backing=m,ge.rollBacking=n(v)?ee.rollBacking!=null?ee.rollBacking.clone():null:v,ge.downBacking=n(I)?ee.downBacking!=null?ee.downBacking.clone():null:I,ge.waitBacking=n(ke)?ee.waitBacking!=null?ee.waitBacking.clone():null:ke,ge.rollWaitBacking=n(oe)?ee.rollWaitBacking!=null?ee.rollWaitBacking.clone():null:oe,ge.downWaitBacking=n(Ce)?ee.downWaitBacking!=null?ee.downWaitBacking.clone():null:Ce,ge.toggleBacking=n(ye)?ee.toggleBacking!=null?ee.toggleBacking.clone():null:ye,ge.rollToggleBacking=n(B)?ee.rollToggleBacking!=null?ee.rollToggleBacking.clone():null:B,ge.downToggleBacking=n(N)?ee.downToggleBacking!=null?ee.downToggleBacking.clone():null:N;var he=["backing","rollBacking","downBacking","toggleBacking","rollToggleBacking","downToggleBacking","waitBacking","rollWaitBacking","downWaitBacking"],Ge,qe,Fe;for(Fe=0;Fe<he.length;Fe++)Ge=he[Fe],qe=ge[Ge],qe&&(qe.type=="Pattern"?qe=We(Ge,qe):L!=-1&&Y>0&&(qe.shadow=new Ne.Shadow(L,3,3,Y)),qe.x=e/2,qe.y=r/2);ge.addChild(ge.backing),p&&(ge.border=new t.Rectangle(e,r,"rgba(0,0,0,0)",T,p,y,C,null,null,!1),ge.addChild(ge.border));function We(vt,Lt){if(ge[vt]=new t.Container(e,r,null,null,!1).centerReg(null,null,!1),L!=-1&&Y>0){var Vt=new t.Rectangle(e-2,r-2,"#666",null,null,y,null,null,null,!1).center(ge[vt]);Vt.shadow=new Ne.Shadow(L,3,3,Y)}var Jt=ge[vt].mask=new t.Rectangle(e,r,vt.indexOf("roll")>=0?a:l,null,null,y,null,null,null,!1).addTo(ge[vt]);return Lt.centerReg(Jt),Lt.setMask(Jt.shape),ge[vt].pattern=Lt,ge[vt]}ge.icon=n(g)?ee.icon!=null?ee.icon.clone():null:g,ge.rollIcon=n(E)?ee.rollIcon!=null?ee.rollIcon.clone():null:E,ge.downIcon=n(A)?ee.downIcon!=null?ee.downIcon.clone():null:A,ge.waitIcon=n(Me)?ee.waitIcon!=null?ee.waitIcon.clone():null:Me,ge.rollWaitIcon=n(te)?ee.rollWaitIcon!=null?ee.rollWaitIcon.clone():null:te,ge.downWaitIcon=n(ae)?ee.downWaitIcon!=null?ee.downWaitIcon.clone():null:ae,ge.toggleIcon=n(re)?ee.toggleIcon!=null?ee.toggleIcon.clone():null:re,ge.rollToggleIcon=n(le)?ee.rollToggleIcon!=null?ee.rollToggleIcon.clone():null:le,ge.downToggleIcon=n(G)?ee.downToggleIcon!=null?ee.downToggleIcon.clone():null:G;var ce=["icon","rollIcon","downIcon","toggleIcon","rollToggleIcon","downToggleIcon","waitIcon","rollWaitIcon","downWaitIcon"];for(Fe=0;Fe<ce.length;Fe++){var Ve=ce[Fe],Se=ge[Ve];Se&&(Se.x=e/2,Se.y=r/2)}if(ge.icon&&ge.addChild(ge.icon),Array.isArray(y)||(y=[y,y,y,y]),_>0){var Ae=new Ne.Shape;Ae.graphics.lf(["rgba(255,255,255,"+_+")","rgba(0,0,0,"+_+")"],[0,1],0,0,0,r-p),Ae.graphics.rc(p/2,p/2,e-p,r-p,y[0],y[1],y[2],y[3]),this.addChild(Ae)}if(k>0){var Ye=new Ne.Shape;Ye.graphics.f("rgba(255,255,255,"+k+")"),Ye.graphics.rc(p/2,p/2,e-p,(r-p)/2,y[0],y[1],0,0),Ye.graphics.f("rgba(0,0,0,"+k+")"),Ye.graphics.rc(p/2,r/2,e-p,(r-p)/2,0,0,y[2],y[3]),this.addChild(Ye)}var Xe,Ue;K>0&&rt();function rt(){Ue=new Ne.Shape,Ue.graphics.f("#000").r(-K,-K,e+K*2,r+K*2),ge.hitArea=Xe=Ue}this.addChild(i),i.center(this),i.y+=1,this.label=i,t.pos(i,$=="left"||$=="right"?R:null,O=="top"||O=="bottom"?Q:null,$=="right",O=="bottom");var Te=i.color;if(this.toggled=!1,et){var $e=i.text,lt=i.color,Qe=i.rollColor;this.on(z,function(){ge.toggled=!ge.toggled,ot()})}function ot(){ge.toggled?(n(d)||(ge.label.text=d===!0?$e:d),n(F)||(ge.label.colorOnly=Te=F),n(h)||(ge.label.rollColor=h),ge.rolled?(ge.rollToggleBacking?Et("rollToggleBacking"):ge.toggleBacking&&Et("toggleBacking"),ge.rollToggleIcon?Et("rollToggleIcon"):ge.toggleIcon&&Et("toggleIcon"),n(m)&&n(ge.rollToggleBacking)&&(ge.backing.color=o)):(ge.toggleBacking&&Et("toggleBacking"),ge.toggleIcon&&Et("toggleIcon"),n(m)&&(ge.backing.color=u))):(ge.label.colorOnly=Te=lt,ge.label.rollColor=Qe,ge.rolled&&ge.label.showRollColor(!0),ge.label.text=$e,ft()),ge.stage&&ge.stage.update()}function ft(){ge.pressed?(n(m)&&ge.backing&&!ge.downBacking&&(ge.backing.color=s),ge.downBacking?Et("downBacking"):ge.rollBacking?Et("rollBacking"):ge.backing&&Et("backing"),ge.downIcon?Et("downIcon"):ge.rollIcon?Et("rollIcon"):ge.icon?Et("icon"):Et("icon",null)):ge.rolled?(n(m)&&ge.backing&&!ge.rollBacking&&(ge.backing.color=a),ge.rollBacking?Et("rollBacking"):ge.backing&&Et("backing"),ge.rollIcon?Et("rollIcon"):ge.icon?Et("icon"):Et("icon",null)):(n(m)&&ge.backing&&(ge.backing.color=l),ge.backing&&Et("backing"),ge.icon,Et("icon"))}this.toggle=function(vt){return et?(n(vt)?ge.toggled=!ge.toggled:ge.toggled=vt,ot(),ge):(dt&&tt("Button() - can't toggle with wait parameters provided"),ge)};var ut=!1;ge.waiting=!1;var ze=!1,kt,Mt,xt=ge.label.color,Yt=ge.label.rollColor,Dt,Ht,nn=this.on("mousedown",function(){ut=!0,jt()});function jt(){(!n(se)||!n(ke)||!n(oe))&&!ge.waiting&&(ze=!0,n(ue)&&(ue=!0),we&&(Ht=ge.stage.on("stagemousedown",function(vt){ge.hitTestPoint(vt.stageX/t.scaX,vt.stageY/t.scaY)||ge.clearWait()},null,!0)),setTimeout(function(){ge.waiting=!0},50),Mt=i.text,n(de)||(ge.label.colorOnly=Te=de),n(V)||(ge.label.rollColor=V),Dt=ge.enabled,!ue&&ge.enabled&&(ge.enabled=!1),n(se)||(ge.label.text=se),ge.rolled?(n(m)&&!ge.rollWaitBacking&&(ge.backing.color=pe),ge.rollWaitBacking?Et("rollWaitBacking"):ge.waitBacking&&Et("waitBacking"),ge.rollWaitIcon?Et("rollWaitIcon"):ge.waitIcon&&Et("waitIcon")):(n(m)&&!ge.waitBacking&&(ge.backing.color=J),ge.waitBacking&&Et("waitBacking"),ge.waitIcon&&Et("waitIcon")),n(Oe)&&(Oe=xe=="s"?5:5e3),kt&&kt.clear(),kt=t.timeout(Oe,function(){ge.enabled||(ge.enabled=Dt),ge.clearWait(),ge.dispatchEvent("waited")}),ge.stage&&ge.stage.update())}this.wait=jt,this.clearWait=function(){return kt&&(Ht&&ge.stage.off("stagemousedown",Ht),kt.clear(),ge.label.text=Mt,ft(),ge.label.colorOnly=Te=xt,ge.label.rollColor=Yt,setTimeout(function(){ge.waiting=!1},55),ze=!1,ge.stage&&ge.stage.update()),ge},this.removeWait=function(){return ge.clearWait(),se=null,ge.waitBacking=null,ge.rollWaitBacking=null,ge.off("mousedown",nn),ge};function Et(vt,Lt){var Vt;if(vt.indexOf("con")>=0){for(Vt=0;Vt<ce.length;Vt++){var Jt=ce[Vt],tn=ge[Jt];ge.removeChild(tn)}ge[vt]&&ge.addChildAt(ge[vt],1)}else{if(!ge[vt]&&!Lt)return;for(Vt=0;Vt<he.length;Vt++){var Zt=he[Vt],an=ge[Zt];ge.removeChild(an)}ge[vt]&&ge.addChildAt(ge[vt],0)}}var Qt=!1;this.on("mouseover",function(vt){ge.stage&&ge.stage.frame.leftMouseDown&&!gt||Je()});function Je(){ge.rolled=!0,Qt=!0,ze?(ge.pressed&&ge.downWaitBacking?Et("downWaitBacking"):ge.pressed&&ge.downBacking?Et("downBacking"):ge.rollWaitBacking?Et("rollWaitBacking"):ge.waitBacking?Et("waitBacking"):ge.rollBacking?Et("rollBacking"):Et("backing"),ge.pressed&&ge.downWaitIcon?Et("downWaitIcon"):ge.rollWaitIcon?Et("rollWaitIcon"):ge.waitIcon?Et("waitIcon"):ge.rollIcon?Et("rollIcon"):Et("icon",!0)):et&&ge.toggled?(ge.pressed&&ge.downToggleBacking?Et("downToggleBacking"):ge.pressed&&ge.downBacking?Et("downBacking"):ge.rollToggleBacking?Et("rollToggleBacking"):ge.toggleBacking?Et("toggleBacking"):ge.rollBacking?Et("rollBacking"):Et("backing"),ge.pressed&&ge.downToggleIcon?Et("downToggleIcon"):ge.rollToggleIcon?Et("rollToggleIcon"):ge.toggleIcon?Et("toggleIcon"):ge.rollIcon?Et("rollIcon"):Et("icon",!0)):(ge.pressed&&ge.downBacking?Et("downBacking"):ge.rollBacking?Et("rollBacking"):Et("backing"),ge.pressed&&ge.downIcon?Et("downIcon"):ge.rollIcon?Et("rollIcon"):Et("icon",!0)),ge.pressed?n(m)&&ge.backing?ge.backing.color=s:m&&!n(m.mask)&&ge.backing&&(ge.backing.mask.color=s):n(m)&&ge.backing?ge.backing.color=a:m&&!n(m.mask)&&ge.backing&&(ge.backing.mask.color=a),ge.border&&(ge.border.borderColor=ge.pressed?P:x),ge.pressed?ge.label.colorOnly=w:ge.label.showRollColor?ge.label.showRollColor():ge.label.colorOnly=Te,ge.stage&&ge.stage.update()}var gt=!1;this.on("mousedown",function(){ge.pressed=gt=!0,Je(),ge.rolled}),this.on("pressup",function(){ge.pressed=gt=ut=!1,Qt?Je():ge.rollPersist&&mt(),j.M&&Ot()}),this.on("pressmove",function(){var vt=ge.stage?ge.stage.frame:j.zdf,Lt=ge.hitTestPoint(vt.mouseX,vt.mouseY);gt&&!Lt?(Ot(),gt=!1):!gt&&Lt&&(Je(),gt=!0)}),this.on("mouseout",Ot);function Ot(){Qt=!1,ge.rollPersist&&ut||mt()}function mt(){ge.rolled=!1,ze||ge.waiting?(n(m)&&ge.backing&&n(ge.waitBacking)&&(ge.backing.color=n(J)?l:J),ge.waitBacking?Et("waitBacking"):ge.backing&&Et("backing"),ge.waitIcon?Et("waitIcon"):ge.icon?Et("icon"):Et("icon",null)):ge.toggled&&et?(n(m)&&ge.backing&&n(ge.toggleBacking)&&(ge.backing.color=u),ge.toggleBacking?Et("toggleBacking"):ge.backing&&Et("backing"),ge.toggleIcon?Et("toggleIcon"):ge.icon?Et("icon"):Et("icon",null)):(n(m)&&ge.backing?ge.backing.color=l:m&&!n(m.mask)&&ge.backing&&(ge.backing.mask.color=l),ge.backing&&Et("backing"),ge.icon?Et("icon"):Et("icon",null)),ge.border&&(ge.border.borderColor=T),ge.label.colorOnly=Te,ge.label.showRollColor&&ge.label.showRollColor(!1),ge.stage&&ge.stage.update()}ge.removeRoll=mt,ge.rollBacking&&ge.rollBacking.removeFrom(),Object.defineProperty(ge,"text",{get:function(){var vt=i.text==" "?"":i.text;return vt},set:function(vt){i.text=vt,$e&&($e=vt),i.center(this),i.y+=1,t.pos(i,$=="left"||$=="right"?R:null,O=="top"||O=="bottom"?Q:null,$=="right",O=="bottom")}}),Object.defineProperty(ge,"color",{get:function(){return f},set:function(vt){f=vt,lt&&(lt=f),ge.label&&!n(ge.label.color)&&(ge.label.color=Te=f),!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&ge.stage&&ge.stage.update()}}),Object.defineProperty(ge,"rollColor",{get:function(){return c},set:function(vt){c=vt,Qe&&(Qe=c),ge.label&&(ge.label.rollColor=c)}}),Object.defineProperty(ge,"downColor",{get:function(){return w},set:function(vt){w=vt,originalDownColor&&(originalDownColor=w),ge.label&&(ge.label.downColor=w)}}),Object.defineProperty(ge,"backgroundColor",{get:function(){return l},set:function(vt){l=vt,ge.backing.color?ge.backing.color=l:ge.backing.mask&&(ge.backing.mask.color=l),!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&ge.stage&&ge.stage.update()}}),Object.defineProperty(ge,"rollBackgroundColor",{get:function(){return a},set:function(vt){a=vt,ge.rollBacking&&ge.rollBacking.color?ge.rollBacking.color=a:ge.rollBacking&&ge.rollBacking.mask&&(ge.rollBacking.mask.color=a)}}),Object.defineProperty(ge,"toggleBackgroundColor",{get:function(){return u},set:function(vt){u=vt,ge.toggleBacking&&ge.toggleBacking.color?ge.toggleBacking.color=u:ge.toggleBacking&&ge.toggleBacking.mask&&(ge.toggleBacking.mask.color=u)}}),Object.defineProperty(ge,"rollToggleBackgroundColor",{get:function(){return o},set:function(vt){o=vt,ge.rollToggleBacking&&ge.rollToggleBacking.color?ge.rollToggleBacking.color=o:ge.rollToggleBacking&&ge.rollToggleBacking.mask&&(ge.rollToggleBacking.mask.color=o)}}),Object.defineProperty(ge,"downBackgroundColor",{get:function(){return s},set:function(vt){s=vt,ge.downBacking&&ge.downBacking.color?ge.downBacking.color=s:ge.downBacking&&ge.downBacking.mask&&(ge.downBacking.mask.color=s)}}),Object.defineProperty(ge,"borderColor",{get:function(){return T},set:function(vt){T=vt,ge.rolled||(ge.backing&&ge.backing.borderColor&&(ge.backing.borderColor=vt),ge.border&&(ge.border.borderColor=vt))}}),Object.defineProperty(ge,"rollBorderColor",{get:function(){return x},set:function(vt){x=vt,ge.rolled&&(ge.backing&&ge.backing.borderColor&&(ge.backing.borderColor=vt),ge.border&&(ge.border.borderColor=vt))}}),Object.defineProperty(ge,"hitPadding",{get:function(){return K},set:function(vt){K=vt,K==0?Xe&&(this.hitArea=null):rt()}}),this._enabled=!0,this.startMouseChildren=this.mouseChildren,Object.defineProperty(ge,"enabled",{get:function(){return ge._enabled},set:function(vt){ge._enabled&&(ge.startMouseChildren=ge.mouseChildren),vt?(bt(ge,vt),ge.mouseChildren=ge.startMouseChildren):(mt(),bt(ge,vt));var Lt=i.color;i.color=Te=Lt,!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&ge.stage&&ge.stage.update()}}),this.setBacking=function(vt,Lt){_t(vt,Lt)},this.setIcon=function(vt,Lt){_t(vt,Lt)};function _t(vt,Lt){return n(vt)||(ge.contains(ge[vt])&&(ge.removeChild(ge[vt]),Lt&&ge.addChildAt(Lt,vt.indexOf("con")>=0?ge.numChildren-1:0),ge.stage&&ge.stage.update()),Lt?(n(m)&&vt=="backing"&&(m=Lt),Lt.type=="Pattern"&&(Lt=We(vt,Lt)),ge[vt]=Lt,ge[vt].x=e/2,ge[vt].y=r/2):ge[vt]=null,ft()),ge}Pe!==!1&&t.styleTransforms(this,ee),this.clone=function(vt){var Lt=new t.Button(e,r,i.clone(),vt||!t.isPick(Ze[0])?l:Ze[0],vt||!t.isPick(Ze[1])?a:Ze[1],vt||!t.isPick(Ze[2])?s:Ze[2],vt||!t.isPick(Ze[3])?f:Ze[3],vt||!t.isPick(Ze[4])?c:Ze[4],vt||!t.isPick(Ze[5])?w:Ze[5],Be,He,x,P,n(m)?null:ge.backing.clone(),n(v)?null:ge.rollBacking.clone(),n(I)?null:ge.downBacking.clone(),n(g)?null:g.clone(),n(E)?null:E.clone(),n(A)?null:A.clone(),y,C,L,Y,_,k,$,O,X,R,Q,K,q,ne,U,D,d,u,o,S,F,h,b,n(ye)?null:ye.clone(),n(B)?null:B.clone(),n(N)?null:N.clone(),n(re)?null:re.clone(),n(le)?null:le.clone(),n(G)?null:G.clone(),z,se,Oe,J,pe,Z,de,V,fe,n(ke)?null:ke.clone(),n(oe)?null:oe.clone(),n(Ce)?null:Ce.clone(),n(Me)?null:Me.clone(),n(te)?null:te.clone(),n(ae)?null:ae.clone(),we,ue,Pe,this.group,be);return ge.cloneProps(Lt)},this.doDispose=function(vt,Lt,Vt){return ge.icon&&ge.icon.dispose(),ge.rollIcon&&ge.rollIcon.dispose(),ge.downIcon&&ge.downIcon.dispose(),ge.waitIcon&&ge.waitIcon.dispose(),ge.rollWaitIcon&&ge.rollWaitIcon.dispose(),ge.downWaitIcon&&ge.downWaitIcon.dispose(),ge.toggleIcon&&ge.toggleIcon.dispose(),ge.rollToggleIcon&&ge.rollToggleIcon.dispose(),ge.downToggleIcon&&ge.downToggleIcon.dispose(),ge.icon=ge.rollIcon=ge.downIcon=ge.waitIcon=ge.rollWaitIcon=ge.downWaitIcon=ge.toggleIcon=ge.rollToggleIcon=ge.downToggleIcon=null,Vt||this.zimContainer_dispose(!0),!0}},t.extend(t.Button,t.Container,["clone","dispose"],"zimContainer",!1),t.Button.prototype.dispose=function(e){return this.doDispose(null,null,e)},t.CheckBox=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I){var g="size, label, startChecked, color, backgroundColor, borderColor, borderWidth, corner, margin, indicatorType, indicatorColor, tap, rtl, style, group, inherit",E;if(E=st(t.CheckBox,arguments,g,this))return E;De("56"),this.zimContainer_constructor(null,null,null,null,!1),this.type="CheckBox",this.group=v;var A=m===!1?{}:t.getStyle(this.type,this.group,I);n(e)&&(e=A.size!=null?A.size:60),n(r)&&(r=A.label!=null?A.label:null),n(i)&&(i=A.startChecked!=null?A.startChecked:!1),n(l)&&(l=A.color!=null?A.color:t.darker),n(a)&&(a=A.backgroundColor!=null?A.backgroundColor:t.white.toAlpha(.8)),n(s)&&(s=A.borderColor!=null?A.borderColor:t.darker),n(f)&&(f=A.borderWidth!=null?A.borderWidth:e/10),s<0||f<0?s=f=null:s!=null&&f==null&&(f=e/10),n(c)&&(c=A.corner!=null?A.corner:0),n(w)&&(w=A.margin!=null?A.margin:e/5),T!="box"&&T!="square"&&T!="x"&&(T=A.indicatorType!=null?A.indicatorType:"check"),n(p)&&(p=A.indicatorColor!=null?A.indicatorColor:f>0?s:t.black),this.setBounds(-w,-w,e+w*2,e+w*2),n(x)&&(x=A.tap!=null?A.tap:!1),n(P)&&(P=A.rtl!=null?A.rtl:j.DIR=="rtl");var y=this;this.cur("pointer");var C=L(r,i);this.veeObj={label:C[0],startChecked:C[1]};function L(){return arguments}r=t.Pick.choose(r),i=t.Pick.choose(i);var Y=i;(typeof r=="string"||typeof r=="number")&&(r=new t.Label({text:r,size:e*5/6,color:l,valign:"center",align:P?"right":"left",backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",style:m,group:this.group}));var _=this.box=new t.Rectangle(e,e,a,null,null,c),k=this.box2=new t.Rectangle(e*5/7,e*5/7,"rgba(0,0,0,0)",s,f,c);k.x=e/7,k.y=e/7,this.addChild(_,k);var $=e;r&&(r.center(y),this.label=r,P?(r.x=-w,this.setBounds(-r.width-w*2,-w,e+w*3+r.getBounds().width,Math.max(e+w*2,r.getBounds().height)),$=e+r.width+w,this.regX=e):(r.x=y.getBounds().width,this.setBounds(-w,-w,e+w*4+r.getBounds().width,Math.max(e+w*2,r.getBounds().height)),$=r.x+r.width));var O=new t.Shape({style:!1}),X=O.graphics;X.f("rgba(0,0,0,.01)").r(this.getBounds().x,this.getBounds().y,$+w*2,this.getBounds().height),this.hitArea=O;var R=new t.Shape({style:!1}),Q=R.graphics;T=="check"?Q.f(p).p("AnQAdICBiaIEEDZIF8nfICfB4In/KPg"):T=="box"||T=="square"?Q.f(p).dr(-35,-35,70,70):Q.f(p).p("AmJEVIEUkTIkXkWIB4h5IEWEYIETkTIB4B3IkTESIEQERIh4B4IkRkRIkSEVg");var K=95;R.setBounds(-K/2,-K/2,K,K);var q=e/(K+66);R.scaleX=R.scaleY=q,R.alpha=.9,R.x=e/2,R.y=e/2,Y&&this.addChild(R),x?this.tap(ne):this.on((Pt?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",ne),Object.defineProperty(y,"checked",{get:function(){return Y},set:function(U){y.setChecked(U)}}),this.toggle=function(U){n(U)&&(U=!Y),y.setChecked(U)},Object.defineProperty(y,"toggled",{get:function(){return Y},set:function(U){y.setChecked(U)}}),Object.defineProperty(y,"text",{get:function(){return r?r.text:null},set:function(U){r&&(r.text=U,!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&y.stage&&y.stage.update())}}),Object.defineProperty(R,"indicatorColor",{get:function(){return p},set:function(U){Y&&y.removeChild(R),R=new Ne.Shape,Q=R.graphics,p=U,Q.f(p).p("AnQAdICBiaIEEDZIF8nfICfB4In/KPg"),R.scaleX=R.scaleY=q,R.alpha=.9,R.x=e/2,R.y=e/2,Y&&y.addChild(R),!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&y.stage&&y.stage.update()}}),Object.defineProperty(y,"indicator",{get:function(){return R},set:function(){tt("ZIM CheckBox - check is read only")}}),this._enabled=!0,Object.defineProperty(y,"enabled",{get:function(){return y._enabled},set:function(U){bt(y,U)}});function ne(){Y=!Y,y.setChecked(Y),y.dispatchEvent("change")}this.setChecked=function(U){return n(U)&&(U=!0),Y=U,Y?y.addChild(R):y.removeChild(R),!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&y.stage&&y.stage.update(),y},m!==!1&&t.styleTransforms(this,A),this.clone=function(U){return y.cloneProps(new t.CheckBox(e,U||!t.isPick(C[0])?r?r.clone():null:C[0],U||!t.isPick(C[1])?i:C[1],l,a,s,f,c,w,T,p,x,P,m,this.group,I))}},t.extend(t.CheckBox,t.Container,"clone","zimContainer",!1),t.RadioButtons=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I){var g="size, buttons, vertical, color, backgroundColor, borderColor, borderWidth, spacing, margin, always, indicatorColor, selectedIndex, rtl, style, group, inherit",E;if(E=st(t.RadioButtons,arguments,g,this))return E;De("57"),this.zimContainer_constructor(null,null,null,null,!1),this.type="RadioButtons",this.group=v;var A=m===!1?{}:t.getStyle(this.type,this.group,I);n(e)&&(e=A.size!=null?A.size:60),e=Math.max(5,e),n(r)&&(r=A.buttons!=null?A.buttons:["A","B","C"]),n(i)&&(i=A.vertical!=null?A.vertical:!0),n(l)&&(l=A.color!=null?A.color:t.darker),n(a)&&(a=A.backgroundColor!=null?A.backgroundColor:"rgba(255,255,255,.8)"),n(s)&&(s=A.borderColor!=null?A.borderColor:t.darker),n(f)&&(f=A.borderWidth!=null?A.borderWidth:e/9),s<0||f<0?s=f=null:s!=null&&f==null&&(f=e/10),n(c)&&(c=i?A.spacing!=null?A.spacing:e*.2:A.spacing!=null?A.spacing:e),n(w)&&(w=A.margin!=null?A.margin:e/5),n(T)&&(T=A.always!=null?A.always:!1),n(p)&&(p=A.indicatorColor!=null?A.indicatorColor:f>0?s:t.black),n(P)&&(P=A.rtl!=null?A.rtl:j.DIR=="rtl");var y=this;this.cur("pointer"),this.labels=[],this.indicators=[];var C=0,L;if(typeof r=="string"){var Y=r;r=[];for(var _=0;_<Y.length;_++)r.push({label:Y[_]})}var k=new t.Container({style:!1});this.addChild(k);function $(K){var q=k.getChildIndex(K.target);T&&y.selectedIndex==q||(y.setSelected(q),y.dispatchEvent("change"))}R();for(var O,X=0;X<k.numChildren;X++)O=k.getChildAt(X),O.on((Pt?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",$);function R(){var K,q=!1,ne;for(ne=r.length-1;ne>=0;ne--)K=r[ne],K.selected&&K.selected===!0&&(q?K.selected="false":(q=!0,y.id=K.id));k.removeAllChildren(),y.buttons=[];var U,D=0;for(ne=0;ne<r.length;ne++){if(K=r[ne],typeof K=="string"||typeof K=="number"){var d={selected:!1,label:new t.Label({text:K,size:e*5/6,color:A.color!=null?A.color:l,valign:"center",backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",style:m,group:y.group})};K=d}(K.label&&typeof K.label=="string"||typeof K.label=="number")&&(K.label=new t.Label({text:K.label,size:A.size!=null?A.size:e*5/6,color:A.color!=null?A.color:l,valign:"center",style:m})),y.labels.push(K.label),K.index=ne,r[ne]=K,U=Q(K.selected,K.label),U.type="RadioButton",U.obj=K,K.selected&&(L=U.obj),k.addChild(U),i?(U.y=D,D+=U.getBounds().height+c):(U.x=D,D+=U.getBounds().width+c)}}function Q(K,q){var ne=new t.Container({style:!1});y.buttons.push(ne),ne.mouseChildren=!1,ne.setBounds(-w,-w,e+w*2,e+w*2);var U=new t.Shape({style:!1}),D=U.graphics;D.f(a).dc(e/2,e/2,e/1.85),D.s(s).ss(f).dc(e/2,e/2,e/2-e/2/5),ne.addChild(U);var d=ne.check=new t.Circle(e/5.2,p,null,null,null,null,null,null,!1);y.indicators.push(d),d.mouseEnabled=!1,d.alpha=.95,d.regX=d.regY=-e/2;var u=e;q&&(C==0&&(C=q.width),ne.addChild(q),q.y=e/2,ne.text=q.text,P?(q.x=-q.width-w,ne.setBounds(-q.width-w,-w,e+w*2+q.getBounds().width,Math.max(e+w*2,q.getBounds().height)),u=q.width+w+e):(q.x=ne.getBounds().width,ne.setBounds(-w,-w,e+w*2+q.getBounds().width,Math.max(e+w*2,q.getBounds().height)),u=q.x+q.width)),K&&(ne.addChild(d),y.label=q,y.label&&(y.text=q.text));var o=new t.Shape({style:!1});return D=o.graphics,D.f("rgba(0,0,0,.01)").r(ne.getBounds().x,ne.getBounds().y,u+w*2,ne.getBounds().height),ne.hitArea=o,ne}this.getBounds()||this.setBounds(0,0,e,e),P?(this.setBounds(-w*2-C,-w,this.getBounds().width+w*2,this.getBounds().height),this.regX=i?e+w:this.getBounds().width-C-w*3):this.setBounds(-w,-w,this.getBounds().width+w*2,this.getBounds().height),this.setSelected=function(K){if(n(K)&&(K=-1),!(K!=-1&&!k.getChildAt(K))){for(var q,ne=0;ne<k.numChildren;ne++)q=k.getChildAt(ne),q.removeChild(q.check);if(K>=0){q=k.getChildAt(K);var U=-2;L&&(U=L.index),L=q.obj}return K==-1||U==L.index?(L=null,y.id=null,y.label=null,y.text=""):(q.addChild(q.check),y.id=L.id,y.label=L.label,y.label&&(y.text=y.label.text)),!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&y.stage&&y.stage.update(),y}},Object.defineProperty(y,"selected",{get:function(){return L},set:function(){tt("ZIM RadioButton - selected is read only")}}),Object.defineProperty(y,"selectedIndex",{get:function(){return L?L.index:-1},set:function(K){var q=K;y.selectedIndex!=K&&y.setSelected(q)}}),this._enabled=!0,Object.defineProperty(y,"enabled",{get:function(){return y._enabled},set:function(K){bt(y,K)}}),n(x)&&(x=A.selectedIndex!=null?A.selectedIndex:0),y.selectedIndex=x,m!==!1&&t.styleTransforms(this,A),this.clone=function(){for(var K=t.copy(r),q=0;q<K.length;q++)K[q].label=K[q].label.clone();return y.cloneProps(new t.RadioButtons(e,K,i,l,a,s,f,c,w,T,p,x,P,m,this.group,I))}},t.extend(t.RadioButtons,t.Container,"clone","zimContainer",!1),t.Toggle=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L){var Y="width, height, label, startToggled, backgroundColor, margin, indicatorType, indicatorColor, tap, toggleBackgroundColor, color, borderColor, borderWidth, corner, indicatorCorner, shadowColor, shadowBlur, time, labelLeft, style, group, inherit",_;if(_=st(t.Toggle,arguments,Y,this))return _;De("57.5"),this.group=C;var k=y===!1?{}:t.getStyle("Toggle",this.group,L);n(e)&&(e=k.width!=null?k.width:80),n(r)&&(r=k.height!=null?k.height:50),this.zimContainer_constructor(e,r,null,null,!1),this.type="Toggle",n(a)&&(a=k.backgroundColor!=null?k.backgroundColor:t.purple),n(s)&&(s=k.margin!=null?k.margin:10),n(f)&&(f=k.indicatorType!=null?k.indicatorType:"circle"),n(c)&&(c=k.indicatorColor!=null?k.indicatorColor:t.white),n(T)&&(T=k.toggleBackgroundColor!=null?k.toggleBackgroundColor:a.lighten(.3)),n(p)&&(p=k.color!=null?k.color:t.darker),n(x)&&(x=k.borderColor!=null?k.borderColor:null),n(P)&&(P=k.borderWidth!=null?k.borderWidth:null),x<0||P<0?x=P=null:x!=null&&P==null&&(P=1),n(m)&&(m=k.corner!=null?k.corner:f!="circle"?0:25),n(v)&&(v=k.indicatorCorner!=null?k.indicatorCorner:0),n(I)&&(I=k.shadowColor!=null?k.shadowColor:"rgba(0,0,0,.3)"),n(g)&&(g=k.shadowBlur!=null?k.shadowBlur:14),n(l)&&(l=k.startToggled!=null?k.startToggled:!1);var $=wt(E);n(E)&&(E=k.time!=null?k.time:$=="s"?.1:100),n(i)&&(i=k.label!=null?k.label:null),n(A)&&(A=k.labelLeft!=null?k.labelLeft:null);var O=this;O.cur("pointer"),(typeof i=="string"||typeof i=="number")&&(i=this.label=new t.Label({text:i,size:k.size||r*5/6,color:p,valign:"center",backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",group:this.group})),(typeof A=="string"||typeof A=="number")&&(A=this.labelLeft=new t.Label({text:A,size:k.size||r*5/6,color:p,valign:"center",backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",group:this.group})),this.background=new t.Rectangle(e,r,a,x,P,m).addTo(this),f=="rectangle"||f=="square"?this.indicator=new t.Rectangle(r*.65,r*.65,c,null,null,v).center(this.background).pos(r*.2,null,l):this.indicator=new t.Circle(r*.35,c).center(this.background).pos(r*.175,null,l);var X=l;O.background.color=X?T:a,I!=-1&&g>0&&(this.background.shadow=new Ne.Shadow(I,3,3,g)),i&&(this.addChild(i),i.x=e+2+s+P,i.y=r/2,this.label=i,this.setBounds(-s,-s,e+s*3+P+i.getBounds().width,Math.max(r+s*2,i.getBounds().height))),A&&(this.addChild(A),A.x=0,O.background.x+=A.width+3+s+P,O.label.x+=A.width+3+s+P,A.y=r/2,this.labelLeft=A,this.setBounds(-s,-s,O.getBounds().width+A.width+3+s+P,O.getBounds().height)),this.expand(t.mobile()?20:10),this.tap(function(K){if(A){var q=O.localToGlobal(A.width+3+s+P+e/2,0);if(K.stageX/t.scaX<q.x-e/2&&!X||K.stageX/t.scaX>=q.x+e/2&&X)return}X=!X,Q(),O.dispatchEvent("change")},t.mobile()?20:10);var R=new t.Swipe(this,20,$=="s"?.2:200);R.on("swipe",function(K){if(K.swipeX!=0){{if(K.swipeX==1&&X)return;if(K.swipeX==-1&&!X)return}X=!X,Q(),O.dispatchEvent("change")}});function Q(K){var q=O.indicator.x,ne=E;if(K===!0&&(ne=0),f=="rectangle"||f=="square"?(O.indicator.pos(r*.2,null,X),E>0&&O.indicator.animate({props:{x:q},from:!0,time:ne})):(O.indicator.pos(r*.175,null,X),E>0&&O.indicator.animate({props:{x:q},from:!0,time:ne})),O.background.color=X?T:a,O.text=X?O.label?O.label.text:"on":O.labelLeft?O.labelLeft.text:"off",O.zimAccessibility){var U="Toggle set to "+(X?O.label?O.label.text+".":"on.":O.labelLeft?O.labelLeft.text+".":"off.");setTimeout(function(){O.zimAccessibility.talk(U)},50)}}Object.defineProperty(O,"textLeft",{get:function(){return A?A.text:null},set:function(K){A&&(A.text=K,!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&O.stage&&O.stage.update())}}),O.toggle=function(K,q){var ne=X;return n(K)&&(K=!0),X=K,ne!=X&&Q(q),O},O.text=X?O.label?O.label.text:"on":O.labelLeft?O.labelLeft.text:"off",Object.defineProperty(O,"toggled",{get:function(){return X},set:function(K){O.toggle(K)}}),this._enabled=!0,Object.defineProperty(O,"enabled",{get:function(){return O._enabled},set:function(K){bt(O,K)}}),y!==!1&&t.styleTransforms(this,k),this.clone=function(){return O.cloneProps(new t.Toggle(e,r,i?i.clone():"",l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A?A.clone():"",y,this.group,L))}},t.extend(t.Toggle,t.Container,"clone","zimContainer",!1),t.Tip=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O,X,R,Q,K,q,ne,U,D,d,u,o,S,F,h,b,ye,B,N){var re="text, tipAlign, tipValign, margin, marginH, marginV, outside, target, delay, time, mouseClose, size, font, color, rollColor, shadowColor, shadowBlur, align, valign, lineWidth, lineHeight, backing, outlineColor, outlineWidth, backgroundColor, backgroundBorderColor, backgroundBorderWidth, corner, backgroundDashed, padding, paddingH, paddingV, shiftH, shiftV, rollPersist, labelWidth, labelHeight, maxSize, bold, italic, variant, splitWords, style, group, inherit",le;if(le=st(t.Tip,arguments,re,this))return le;De("57.6"),this.group=B;var G=ye===!1?{}:t.getStyle("Tip",this.group,N);n(e)&&(e=G.text!=null?G.text:"Here's a tip!"),n(l)&&(l=G.margin!=null?G.margin:40),n(a)&&(a=G.marginH!=null?G.marginH:l),n(s)&&(s=G.marginV!=null?G.marginV:l),n(r)&&(r=G.tipAlign!=null?G.tipAlign:"right"),n(i)&&(i=G.tipValign!=null?G.tipValign:"bottom"),n(f)&&(f=G.outside!=null?G.outside:!1),n(k)&&(k=G.backgroundColor!=null?G.backgroundColor:t.blue),n(m)&&(m=G.color!=null?G.color:t.white),n(X)&&(X=G.corner!=null?G.corner:25),n(R)&&(R=G.backgroundDashed!=null?G.backgroundDashed:null),n(Q)&&(Q=G.padding!=null?G.padding:10),n(K)&&(K=G.paddingH!=null?G.paddingH:Q),n(q)&&(q=G.paddingV!=null?G.paddingV:Q),(n(I)||I=="ignore")&&(I=G.shadowColor!=null&&I!="ignore"?G.shadowColor:"rgba(0,0,0,.3)"),(n(g)||g=="ignore")&&(g=G.shadowBlur!=null&&g!="ignore"?G.shadowBlur:1),n(w)&&(w=G.delay!=null?G.delay:0);var z=wt(T);n(T)&&(T=G.time!=null?G.time:z=="s"?2:2e3),n(p)&&(p=G.mouseClose!=null?G.mouseClose:!0),this.zimLabel_constructor(e,x,P,m,v,null,null,E,A,S,F,h,y,C,L,Y,_,k,$,O,X,R,Q,K,q,ne,U,D,d,u,o,b,ye,B,t.copy(G)),this.type="Tip",f&&(a=-a,s=-s);var se=this;se.tipAlign=r,se.tipValign=i,this.background.sha(I,3,5,g),this.show=function(Oe,J){var pe=wt(J);if(n(Oe)&&(Oe=w),n(J)&&(J=T),n(c))if(j.zdf)c=j.zdf.stage;else return se;else if(c.getBounds){if(n(c.stage))return tt("zim display - Waiter(): The container must have a stage property"),se}else return tt("zim Tip(): Please pass in a reference to a container with bounds set as parameter to Tip"),se;Oe>0?se.showID=t.timeout(Oe,Z):Z();function Z(){var de;c.boundsToGlobal?de=c.boundsToGlobal():de=c.getBounds();var V=new t.Container(de.x,de.y,de.width,de.height);V.zimTemp=!0,V.loc(0,0,c.stage),se.pos(a,s,se.tipAlign,se.tipValign,V),f&&(se.tipAlign=="right"?se.x+=se.width:se.tipAlign=="left"&&(se.x-=se.width),se.tipValign=="bottom"?se.y+=se.height:se.tipValign=="top"&&(se.y-=se.height)),se.addTo(V.stage),V.zimTemp&&V.removeFrom&&(V.removeFrom(),V=null),V=se.stage,se.timeoutID&&se.timeoutID.clear(),se.timeoutID=t.timeout(J,function(){se.hide(),V.stage.update()}),p&&(se.upID&&V.stage.off("stagemouseup",se.upID),se.upID=V.stage.on("stagemouseup",function(){se.hide(),V.stage&&V.stage.update()})),V.stage&&V.stage.update()}return se},this.hide=function(){return this.removeFrom(),this.timeoutID&&this.timeoutID.clear(),this.upID&&c.stage&&c.stage.off("stagemouseup",this.upID),se},this.clear=function(){se.showID&&se.showID.clear(),se.hide()},this.dispose=function(Oe,J,pe){se.upID&&se.stage&&se.stage.off("stagemouseup",se.upID),pe||this.zimLabel_dispose(!0)},ye!==!1&&t.styleTransforms(this,G),this.clone=function(){return se.cloneProps(new t.Tip(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O,X,R,Q,K,q,ne,U,D,d,u,o,b,ye,this.group,N))}},t.extend(t.Tip,t.Label,["dispose","clone"],"zimLabel",!1),t.Pane=function(F,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O,X,R,Q){var K="content, backgroundColor, color, width, height, draggable, resets, modal, corner, backdropColor, shadowColor, shadowBlur, center, displayClose, backdropClose, backing, fadeTime, container, titleBar, titleBarColor, titleBarBackgroundColor, titleBarHeight, close, closeColor, autoPadding, autoPaddingH, autoPaddingV, style, group, inherit";if(F&&!F.header&&!F.message&&!F.display&&!F.buttons){var q;if(q=st(t.Pane,arguments,K,this))return q}De("58"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Pane";var ne="zim display - Pane(): Please pass in a reference to a container with bounds set as first parameter";if(n(E))if(j.zdf)E=j.zdf.stage;else{tt(ne);return}else if(E.getBounds){if(n(E.getStage)){tt("zim display - Pane(): The container must have a stage property");return}}else{tt(ne);return}this.group=R;var U=X===!1?{}:t.getStyle(this.type,this.group,Q);n(l)&&(l=U.width!=null?U.width:"auto"),n(a)&&(a=U.height!=null?U.height:"auto"),n(F)&&(F=U.content!=null?U.content:" "),(typeof F=="string"||typeof F=="number")&&(F=new t.Label({text:F,size:U.size!=null?U.size:40,align:U.align!=null?U.align:"center",valign:U.valign!=null?U.valign:"center",color:U.color!=null?U.color:i,backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",group:this.group}).noMouse());var D=this.content=F;n(r)&&(r=U.backgroundColor!=null?U.backgroundColor:t.white),n(s)&&(s=U.draggable!=null?U.draggable:!1),n(f)&&(f=U.resets!=null?U.resets:!0),n(c)&&(c=U.modal!=null?U.modal:!0),n(w)&&(w=U.corner!=null?U.corner:20),n(A)&&(A=U.titleBar!=null?U.titleBar:null),n(y)&&(y=U.titleBarColor!=null?U.titleBarColor:null),n(C)&&(C=U.titleBarBackgroundColor!=null?U.titleBarBackgroundColor:null),n(L)&&(L=U.titleBarHeight!=null?U.titleBarHeight:null),n(T)&&(T=U.backdropColor!=null?U.backdropColor:"rgba(0,0,0,.2)"),n(p)&&(p=U.shadowColor!=null?U.shadowColor:"rgba(0,0,0,.3)"),n(x)&&(x=U.shadowBlur!=null?U.shadowBlur:20),n(P)&&(P=U.center!=null?U.center:!0),n(m)&&(m=U.displayClose!=null?U.displayClose:!0),s&&(m=!1),n(v)&&(v=U.backdropClose!=null?U.backdropClose:!0),n(g)&&(g=U.fadeTime!=null?U.fadeTime:0),n(Y)&&(Y=U.close!=null?U.close:!1),n(_)&&(_=U.closeColor!=null?U.closeColor:t.grey),n(k)&&(k=U.autoPadding!=null?U.autoPadding:70),n($)&&($=U.autoPaddingH!=null?U.autoPaddingH:k),n(O)&&(O=U.autoPaddingV!=null?U.autoPaddingV:k);var d=this.backdrop=new t.Shape({style:!1}),u=d.graphics;u.f(T),u.drawRect(-5e3,-5e3,1e4,1e4);var o=this;if(this.add=function(Z,de,V,fe){var ke="obj, index, center, replace",oe;return(oe=st(o.add,arguments,ke,o))?oe:(n(V)&&(V=!0),n(fe)&&(fe=!0),typeof Z=="string"&&(Z=new zr(Z,null,null,i).noMouse()),fe&&o.contentContainer.removeAllChildren(),V?Z.center(o.contentContainer,de):Z.addTo(o.contentContainer,de),o)},D){var S=t.makeContent(D,l,t.dark),h=["header","message","text","display","buttons","config"];h.forEach(function(de){S[de]&&(o[de]=S[de])}),o.label=o.message,l=="auto"&&(l=S.width+$*2),a=="auto"&&(a=S.height+O*2)}var F=o.contentContainer=new t.Container(l,a);S&&o.add(S,null,!0),this.setBounds(-l/2,-a/2,l,a);var h=["header","message","text","display","buttons","config"];F&&h.forEach(function(Z){F[Z]&&(o[Z]=F[Z])}),o.label=o.message,o.container=E,d.on((Pt?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",v?ye:function(Z){Z.stopImmediatePropagation()});var b=new t.Dictionary(!0);function ye(Z){o.dispatchEvent("closing"),setTimeout(function(){se(),o.dispatchEvent("close")},10),Z.stopImmediatePropagation()}d.on("mousedown",function(Z){Z.stopImmediatePropagation()}),this.addChild(d),c||d.noMouse();var B;if(n(I))B=this.backing=new t.Rectangle({width:l,height:a,color:r,corner:w,style:!1});else{if(I.type=="Pattern"){var N=I;B=new t.Rectangle(l,a,r,null,null,w,null,null,null,!1),N.centerReg(B),N.setMask(B.shape)}else B=I;o.display=o.backing=B}if(m&&(B.cur("pointer"),B.on((Pt?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",ye)),p!=-1&&x>0&&(B.shadow=new Ne.Shadow(p,8,8,x)),B.on("click",function(Z){Z.stopImmediatePropagation()}),this.resetX,this.resetY,s){B.cur("pointer");var re,le;B.on("mousedown",function(Z){isNaN(o.resetX)&&(o.resetX=o.x),isNaN(o.resetY)&&(o.resetY=o.y),re=Z.stageX/t.scaX-o.x,le=Z.stageY/t.scaY-o.y,B.cur("pointer")}),B.on("pressmove",function(Z){var de=pe(Z.stageX/t.scaX-re,Z.stageY/t.scaY-le);o.x=de.x,o.y=de.y;for(var V,fe=0;fe<o.numChildren;fe++)V=o.getChildAt(fe),(V.type=="TextArea"||V.type=="Loader"||V.type=="Tag")&&V.resize();o.stage.update()}),this.on("pressup",function(){B.cur("pointer"),o.stage&&o.stage.update()})}if(B.centerReg(this),F&&F.center(this),!n(A)){typeof A=="string"&&(A=new t.Label(A,null,null,y));var G=o.titleBarLabel=A;n(L)&&(L=G.height*1.5),n(y)&&(y=t.black),n(C)&&(C="rgba(0,0,0,.2)"),o.titleBar=A=new t.Container(l,L,null,null,!1).centerReg(o).mov(0,-a/2+L/2),A.mouseEnabled=!1,A.mouseChildren=!1,o.titleBar.backing=new t.Rectangle(l,L,C,null,null,[w*.95,w*.95,0,0],null,null,null,!1).addTo(A),G.center(A).pos({x:Math.max(w/2,10),reg:!0})}Y&&(Y=o.close=new t.Shape(-40,-40,80,80,null,!1),Y.graphics.f(_).p("AmJEVIEUkTIkXkWIB4h5IEWEYIETkTIB4B3IkTESIEQERIh4B4IkRkRIkSEVg"),A?Y.addTo(o).scaleTo(A,null,50).mov(l/2-Math.max(w/2,10)-Y.width/2,-a/2+L/2).expand(40):Y.addTo(o).sca(.3).mov(l/2-Y.width-3,-a/2+Y.height).expand(40),Y.cur("pointer"),Y.expand(),Y.on((Pt?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",ye)),Object.defineProperty(o,"text",{get:function(){if(o.message){var Z=o.message.text==" "?"":o.message.text;return Z}else if(o.content.text){var Z=o.content.text==" "?"":o.content.text;return Z}},set:function(Z){o.message?o.message.text=Z:o.content.text&&(o.content.text=Z)}}),this._enabled=!0,Object.defineProperty(o,"enabled",{get:function(){return o._enabled},set:function(Z){bt(o,Z)}}),this.hide=function(Z,de){return n(Z)||(o.closeParams=Z),se(),de&&(o.dispatchEvent("close"),o.dispatchEvent("change")),o},this.on("removed",z);function z(){o.toggled=!1;var Z,de;for(de=0;de<o.numChildren;de++)if(Z=o.getChildAt(de),Z.type=="TextArea"||Z.type=="Loader"||Z.type=="Tag"){var V={obj:Z,depth:o.getChildIndex(Z)};b.add(Z,V)}for(de=o.numChildren-1;de>=0;de--)Z=o.getChildAt(de),(Z.type=="TextArea"||Z.type=="Loader"||Z.type=="Tag")&&o.removeChild(Z);if(!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&o.container.stage.update(),f&&(isNaN(o.resetX)||(o.x=o.resetX),isNaN(o.resetY)||(o.y=o.resetY)),o.zimAccessibility){var fe=o.zimAccessibility;fe.resize(o),Oe?Oe.focus():o.zimTabTag.nextSibling.focus(),setTimeout(function(){fe.talk("Pane has been closed.")},50)}}function se(){g>0?o.animate({obj:{alpha:0},time:g,call:function(){Z(),o.dispatchEvent("fadedout")}}):Z();function Z(){o.container.removeChild(o),o.closeCall&&o.closeCall(o.closeParams),!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&o.container.stage.update(),f&&(isNaN(o.resetX)||(o.x=o.resetX),isNaN(o.resetY)||(o.y=o.resetY))}}var Oe;this.show=function(Z,de){return n(Z)||(o.closeCall=Z),n(de)||(o.closeParams=de),P&&isNaN(o.resetX)&&(o.x=o.container.getBounds().width/2,o.y=o.container.getBounds().height/2),o.container.addChild(o),g>0?(o.alpha=0,o.animate({props:{alpha:1},time:g,call:function(){o.dispatchEvent("fadedin")}})):setTimeout(function(){o.container.stage&&o.container.stage.update()},10),o},this.on("added",J);function J(){for(var Z=0;Z<b.length;Z++)o.addChildAt(b.values[Z].obj,b.values[Z].depth);if(o.zimAccessibility){var de=o.zimAccessibility;setTimeout(function(){de.activatedObject&&(Oe=de.activatedObject.zimTabTag)},50),de.resize(o),de.tabIndex=o.zimTabIndex}o.toggled=!0}function pe(Z,de){return Z=Math.max(l/2,Math.min(o.container.getBounds().width-l/2,Z)),de=Math.max(a/2,Math.min(o.container.getBounds().height-a/2,de)),{x:Z,y:de}}this.toggle=function(Z){return Z===!0?o.show():Z===!1||o.container.contains(o)?o.hide():o.show(),o},X!==!1&&t.styleTransforms(this,U),this.clone=function(){var Z=o.contentContainer.x,de=o.contentContainer.y,V=o.cloneProps(new t.Pane(t.copy(F),r,i,l,a,s,f,c,w,T,p,x,P,m,v,n(I)?null:I.clone(),g,o.container,A,y,C,L,Y,_,k,$,O,X,this.group,Q));return V.contentContainer.x=Z,V.contentContainer.y=de,V}},t.extend(t.Pane,t.Container,"clone","zimContainer",!1),t.Panel=function(e,r,o,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O){var X="width, height, content, titleBar, titleBarColor, titleBarBackgroundColor, titleBarHeight, backgroundColor, borderColor, borderWidth, corner, close, closeColor, next, nextColor, extraButton, collapse, collapseColor, collapsed, align, shadowColor, shadowBlur, draggable, boundary, style, group, inherit",R;if(R=st(t.Panel,arguments,X,this))return R;De("57.7"),this.group=$;var Q=k===!1?{}:t.getStyle("Panel",this.group,O);n(e)&&(e=Q.width!=null?Q.width:250),n(r)&&(r=Q.height!=null?Q.height:300),this.zimContainer_constructor(e,r,null,null,!1),this.type="Panel",n(o)&&(o=Q.content!=null?Q.content:null);var K=this.content=o;n(l)&&(l=Q.titleBar!=null?Q.titleBar:"PANEL"),n(a)&&(a=Q.titleBarColor!=null?Q.titleBarColor:t.white),n(s)&&(s=Q.titleBarBackgroundColor!=null?Q.titleBarBackgroundColor:t.grey),n(f)&&(f=Q.titleBarHeight!=null?Q.titleBarHeight:30),n(c)&&(c=Q.backgroundColor!=null?Q.backgroundColor:t.lighter),n(w)&&(w=Q.borderColor!=null?Q.borderColor:t.pewter),n(T)&&(T=Q.borderWidth!=null?Q.borderWidth:null),w<0||T<0?w=T=null:w!=null&&T==null&&(T=1),n(p)&&(p=Q.corner!=null?Q.corner:5),n(y)&&(y=Q.align!=null?Q.align:"left"),n(C)&&(C=Q.shadowColor!=null?Q.shadowColor:"rgba(0,0,0,.3)"),n(L)&&(L=Q.shadowBlur!=null?Q.shadowBlur:14),n(Y)&&(Y=Q.draggable!=null?Q.draggable:!1),n(_)&&(_=Q.boundary!=null?Q.boundary:null),n(x)&&(x=Q.close!=null?Q.close:!1),n(P)&&(P=Q.closeColor!=null?Q.closeColor:n(a)?t.grey:a),n(m)&&(m=Q.next!=null?Q.next:t.vee(l)),n(v)&&(v=Q.nextColor!=null?Q.nextColor:n(a)?t.grey:a),Array.isArray(p)||(p=[p,p,p,p]),n(g)&&(g=Q.collapse!=null?Q.collapse:!1),n(E)&&(E=Q.collapseColor!=null?Q.collapseColor:n(a)?t.grey:a),n(A)&&(A=Q.collapsed!=null?Q.collapsed:!1);var q=this,ne=this.background=new t.Rectangle(e,r,c,w,T,p).addTo(this);C!=-1&&L>0&&(this.background.shadow=new Ne.Shadow(C,3,3,L));var U=l,D=t.Pick.choose(U),d=t.Pick.choose(a),u=t.Pick.choose(s),o=q.contentContainer=new t.Container(e,r-f).addTo(q).mov(0,f);typeof D=="string"&&(D=new t.Label({text:D,color:d,size:Q.size!=null?Q.size:20,bold:Q.bold!=null?Q.bold:!1,backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",group:this.group}));var S=q.titleBarLabel=D;n(u)&&(u="rgba(0,0,0,.2)"),q.titleBar=l=new t.Container(e,f,null,null,!1).loc(0,0,q);var F=q.titleBar.backing=new t.Rectangle(e+T,f,u,null,null,[p[0]*.95,p[1]*.95,0,0],!0,null,null,!1).center(l);if(l&&B(),q.label=D,q.text=D.text,x){var h=q.closeIcon=new t.Shape(-40,-40,80,80,null,!1);h.graphics.f(P).p("AmJEVIEUkTIkXkWIB4h5IEWEYIETkTIB4B3IkTESIEQERIh4B4IkRkRIkSEVg"),l?(h.centerReg(l).scaleTo(l,null,50),h.pos(Math.max(p[1]/2,15),null,!0)):h.addTo(q).sca(.3).mov(e/2-h.width-3,-r/2+x.height),h.expand(40),h.cur("pointer"),h.on((Pt?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){var G=q.stage;q.removeFrom(),q.dispatchEvent("close"),G.update()})}if(this.add=function(G,z,se,Oe){var J="obj, index, center, replace",pe;return(pe=st(q.add,arguments,J,q))?pe:(Oe&&q.contentContainer.removeAllChildren(),se?G.center(q.contentContainer,z):G.addTo(q.contentContainer,z),q)},K){var b=t.makeContent(K,e),ye=["header","message","text","display","buttons","config"];ye.forEach(function(G){b[G]&&(q[G]=b[G])}),q.label=q.message,q.add(b,null,!0)}this.nextPanel=function(G,z){var se=n(G)||n(U.array)?t.Pick.choose(U):U.array[G],Oe=n(G)||n(a.array)?t.Pick.choose(a):a.array[G],J=n(G)||n(s.array)?t.Pick.choose(s):s.array[G],pe=n(G)||n(c.array)?t.Pick.choose(c):c.array[G],Z=n(G)||n(w.array)?t.Pick.choose(w):w.array[G];typeof se=="string"&&(se=new t.Label({text:se,color:Oe,size:Q.size!=null?Q.size:20,backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",group:this.group})),q.label=se,q.text=se.text,S.removeFrom(),S=q.titleBarLabel=se,B(),F.color=J,q.background.color=pe,q.background.borderColor=Z,z&&q.dispatchEvent("change"),!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&q.stage&&q.stage.update()};function B(){y=="right"?S.center(l).pos(Math.max(p[0]/2,10),null,!0):y=="center"||y=="middle"?S.center(l):S.center(l).loc(Math.max(p[0]/2,10)),S.mov(0,2)}if(Y&&(l.cur("pointer"),l.on("mousedown",function(){q.drag({rect:_,currentTarget:!0})}),l.on("pressup",function(){q.noDrag(!1)})),m>0){var N=q.nextIcon=new t.Shape(-20,-20,40,40,null,!1);N.graphics.f(a).p("AiJieIETCeIkTCfg"),N.centerReg(l).scaleTo(l,null,70).alp(.8).hov(1).expand(),N.pos(Math.max(p[1]/2,15),null,!0),h&&N.mov(-h.width-8),N.cur("pointer"),N.on((Pt?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){q.nextPanel(),q.dispatchEvent("change")})}if(n(I)||(I=q.extraButton=new t.Button({label:"R",width:50,height:50,corner:5,group:"PanelExtra"}).scaleTo(l,null,70).centerReg(l).expand(),I.pos(Math.max(p[1]/2,15),null,!0),h&&I.mov(-h.width-8),N&&I.mov(-N.width-8)),g){le=A,q.collapse=function(G){if(n(G)&&(G=!0),G==le)return q;G?(re.rot(180),ne.visible=!1,o.visible=!1,le=!0,q.dispatchEvent("collapse")):(re.rot(0),ne.visible=!0,o.visible=!0,le=!1,q.dispatchEvent("expand")),q.stage&&q.stage.update()},q.collapseEvent=q.titleBar.on("dblclick",function(){q.collapsed=!q.collapsed}),n(E)&&(E=t.grey);var re=q.collapseIcon=new t.Triangle(90,90,90,t.faint,E,16);re.centerReg(q).scaleTo(l,null,41).pos({x:e-Math.max(p[1]/2,15)-re.width/2-4,y:f/2,reg:!0}).expand(40),I&&re.mov(-I.width-8),h&&re.mov(-h.width-8),N&&re.mov(-N.width-8),re.cur("pointer"),re.expand();var le=!1;re.on((Pt?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){le?q.collapse(!1):q.collapse(!0)})}q.overlay=new t.Rectangle(e,r,null,null,null,p).alp(.3),Object.defineProperty(q,"panelHeight",{get:function(){return q.background.height},set:function(G){ne.removeFrom(),ne=this.background=new t.Rectangle(e,G,c,w,T,p).addTo(this).bot(),C!=-1&&L>0&&(this.background.shadow=new Ne.Shadow(C,3,3,L)),q.setBounds(e,G),!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&q.stage&&q.stage.update()}}),Object.defineProperty(q,"collapsed",{get:function(){return le},set:function(G){q.collapse&&q.collapse(G)}}),this._enabled=!0,Object.defineProperty(q,"enabled",{get:function(){return q._enabled},set:function(G){bt(q,G),G?q.overlay.removeFrom():q.overlay.addTo(q),!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&q.stage&&q.stage.update()}}),A&&(A=!1,q.collapsed=!0),k!==!1&&t.styleTransforms(this,Q),this.clone=function(){return q.cloneProps(new t.Toggle(e,r,l?l.clone():"",a,s,f,c,w,T,p,x,P,m,v,I,g,E,q.collapsed,y,C,L,Y,_,k,this.group,O))},this.doDispose=function(G,z,se){return g&&this.titleBar.off("dblclick",this.collapseEvent),se||this.zimContainer_dispose(!0),!0}},t.extend(t.Panel,t.Container,["clone","dispose"],"zimContainer",!1),t.Panel.prototype.dispose=function(e){return this.doDispose(null,null,e)},t.Window=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O,X,R,Q,K,q,ne,U,D,d,u,o,S,F,h,b,ye,B,N,re,le,G,z,se){var Oe="width, height, content, backgroundColor, borderColor, borderWidth, padding, corner, swipe, scrollBarActive, scrollBarDrag, scrollBarColor, scrollBarAlpha, scrollBarFade, scrollBarH, scrollBarV, slide, slideFactor, slideSnap, slideSnapDamp, interactive, shadowColor, shadowBlur, paddingH, paddingV, scrollWheel, damp, titleBar, titleBarColor, titleBarBackgroundColor, titleBarHeight, draggable, boundary, onTop, close, closeColor, cancelCurrentDrag, fullSize, fullSizeColor, resizeHandle, collapse, collapseColor, collapsed, optimize, resizeBoundary, resizeVisible, continuous, style, group, inherit",J;if(J=st(t.Window,arguments,Oe,this))return J;De("58.1"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Window",this.group=z;var pe=G===!1?{}:t.getStyle(this.type,this.group,se);n(e)&&(e=pe.width!=null?pe.width:300),n(r)&&(r=pe.height!=null?pe.height:200),n(l)&&(l=pe.backgroundColor!=null?pe.backgroundColor:t.dark);var Z=a,de=s;n(a)&&(a=pe.borderColor!=null?pe.borderColor:t.silver),n(s)&&(s=pe.borderWidth!=null?pe.borderWidth:1),n(f)&&(f=pe.padding!=null?pe.padding:0),n(c)&&(c=pe.corner!=null?pe.corner:0),n(w)&&(w=pe.swipe!=null?pe.swipe:!0),n(T)&&(T=pe.scrollBarActive!=null?pe.scrollBarActive:!0),n(p)&&(p=pe.scrollBarDrag!=null?pe.scrollBarDrag:!1),n(x)&&(x=pe.scrollBarColor!=null?pe.scrollBarColor:a),n(P)&&(P=pe.scrollBarAlpha!=null?pe.scrollBarAlpha:.3),n(m)&&(m=pe.scrollBarFade!=null?pe.scrollBarFade:!0),n(v)&&(v=pe.scrollBarH!=null?pe.scrollBarH:!0),n(I)&&(I=pe.scrollBarV!=null?pe.scrollBarV:!0),p&&(m=pe.scrollBarFade!=null?pe.scrollBarFade:!1),n(g)&&(g=pe.slide!=null?pe.slide:!0),n(E)&&(E=pe.slideFactor!=null?pe.slideFactor:.9),n(A)&&(A=pe.slideSnap!=null?pe.slideSnap:"vertical"),n(C)&&(C=pe.interactive!=null?pe.interactive:!0),n(L)&&(L=pe.shadowColor!=null?pe.shadowColor:"rgba(0,0,0,.3)"),n(Y)&&(Y=pe.shadowBlur!=null?pe.shadowBlur:20),n(k)&&(k=pe.paddingV!=null?pe.paddingV:f),n(_)&&(_=pe.paddingH!=null?pe.paddingH:f),n($)&&($=pe.scrollWheel!=null?pe.scrollWheel:!0),n(O)&&(O=pe.damp!=null?pe.damp:null),n(X)&&(X=pe.titleBar!=null?pe.titleBar:null),n(R)&&(R=pe.titleBarColor!=null?pe.titleBarColor:null),n(Q)&&(Q=pe.titleBarBackgroundColor!=null?pe.titleBarBackgroundColor:null),n(K)&&(K=pe.titleBarHeight!=null?pe.titleBarHeight:null),n(q)&&(q=pe.draggable!=null?pe.draggable:null),n(ne)&&(ne=pe.boundary!=null?pe.boundary:null),n(U)&&(U=pe.onTop!=null?pe.onTop:null),n(D)&&(D=pe.close!=null?pe.close:null),n(d)&&(d=pe.closeColor!=null?pe.closeColor:null),n(u)&&(u=pe.cancelCurrentDrag!=null?pe.cancelCurrentDrag:!1),n(o)&&(o=pe.fullSize!=null?pe.fullSize:null),n(S)&&(S=pe.fullSizeColor!=null?pe.fullSizeColor:null),n(F)&&(F=pe.resizeHandle!=null?pe.resizeHandle:null),n(h)&&(h=pe.collapse!=null?pe.collapse:!1),n(b)&&(b=pe.collapseColor!=null?pe.collapseColor:null),n(ye)&&(ye=pe.collapsed!=null?pe.collapsed:!1),n(B)&&(B=pe.optimize!=null?pe.optimize:!0),n(N)&&(N=pe.resizeBoundary!=null?pe.resizeBoundary:null),n(re)&&(re=pe.resizeVisible!=null?pe.resizeVisible:!1),n(le)&&(le=pe.continuous!=null?pe.continuous:!1),le!="horizontal"&&le!="vertical"&&(le=!1),this.continuous=le,X===!1&&(X=null),n(X)||(n(K)&&(K=30),r=r-K);var V=this;V.optimize=B,this.scrollX=this.scrollY=this.scrollXMax=this.scrollYMax=0;var fe=this.backing=new t.Shape({style:!1});this.addChild(fe);var ke=new Ne.Shape;ke.type="WindowBacking";var oe=ke.graphics;if(this.addChild(ke),i)var Ce=V.content=i;i=this.contentContainer=new t.Container({style:!1}),this.addChild(i),i.mask=ke;var Me;if(!C)var te=new Ne.Shape;if(s>0){var ae=new Ne.Shape;this.addChild(ae)}var we=X?0:c,ue=0;function Pe(){V.setBounds(0,0,e,r),fe.graphics.c().f(l).rc(0,0,e,r,we,we,c,c),L!=-1&&Y>0&&(fe.shadow=new Ne.Shadow(L,4,4,Y)),s>0&&(c?ae.graphics.c().s(a).ss(s,"square","miter").rc(0,0,e,r,we,we,c,c):ae.graphics.c().s(a).ss(s,"square","miter").dr(0,0,e,r)),n(qe)||(qe.widthOnly=V.width+s,Ge.widthOnly=V.width+s-1,V.setBounds(0,-K,V.width,r+K)),Fe&&(X?(Fe.pos({x:e-Math.max(c/2,10)-Fe.width/2,y:K/2,reg:!0}),Ge.widthOnly=Fe.x-15,ue=V.width-Ge.width):Fe.pos(Math.max(c/2,10)/2,Fe.height/2,!0,!1,V)),Xe&&(Xe.pos({x:e-Math.max(c/2,10)-Xe.width/2,y:K/2,reg:!0}),Fe&&Xe.mov(-Fe.width-10),X&&(Ge.widthOnly=Xe.x-15),ue=V.width-Ge.width),Te&&(Te.pos({x:e-Math.max(c/2,10)-Te.width/2,y:K/2,reg:!0}),Fe&&Te.mov(-Fe.width-10),Xe&&Te.mov(-Xe.width-10),X&&(Ge.widthOnly=Te.x-15),ue=V.width-Ge.width)}Pe();var ie=this.scrollBar={};if(ie.color=x,ie.size=6,ie.minSize=ie.size*2,ie.spacing=3.5+s/2,ie.margin=0,ie.corner=ie.size/2,ie.showTime=.5,ie.fadeTime=3,T){var be=ie.horizontal=new t.Shape({style:!1}),Le=be.graphics;be.alpha=P,this.addChild(be),p&&be.drag({localBoundary:!0});var me=ie.vertical=new t.Shape({style:!1}),ee=me.graphics;me.alpha=P,this.addChild(me),p&&me.drag({localBoundary:!0})}var Ie,Re,_e,Ze,at,Be,He,et,ge,xe=!1;if(this.update=function(){T&&(Le.clear(),ee.clear()),at=T?ie.size+ie.spacing*2:0,Be=i.getBounds()?i.getBounds().width:0,He=i.getBounds()?i.getBounds().height:0,_e=v&&Be>e-_&&(T||w===!0||w=="auto"||w=="horizontal"),Ze=I&&He>r-k&&(T||w===!0||w=="auto"||w=="vertical"),V.scrollXMax=Be+_*2-e+(Ze?at+ie.margin:0),V.scrollYMax=He+k*2-r+(_e?at+ie.margin:0),oe.clear();var yt=s/2,je=s/2,ht=e-(Ze&&T?ie.size+ie.spacing*2:0)-(Ze?0:s),Gt=r-(_e&&T?ie.size+ie.spacing*2:0)-(_e?0:s),Kt=c*(.1+c/100);oe.f("rgba(0,0,0,0)").rc(yt,je,ht,Gt,_e&&T&&!X?Kt:we,Ze&&T&&!X?Kt:we,Ze&&T?Kt:Math.max(Kt,c-s/2),_e&&T?Kt:Math.max(Kt,c-s/2)),ke.setBounds(V.getBounds().x,V.getBounds().y,V.getBounds().width,V.getBounds().height),t.expand(ke,0),C||(te.graphics.c().f("red").dr(yt,je,ht,Gt),i.hitArea=te);var $t=Math.max(c,Math.min(ie.corner,ie.spacing)),Ut=$t+s/2,Tt=$t+(Ze?at:0)+s/2,Bt=$t+s/2,gn=$t+(_e?at:0)+s/2,hn,en;_e&&T&&(hn=Math.max(ie.minSize,(e-Ut-Tt)*(e-Ut-Tt)/(Be+_+ie.margin)),Le.f(ie.color).rr(0,0,hn,ie.size,ie.corner),be.x=Ut,be.y=r-ie.size-ie.spacing,Ie=new t.Proportion(-V.scrollXMax,0,Ut,e-hn-Tt,-1),p&&(be.setBounds(0,0,hn,ie.size),en=new Ne.Rectangle(Ut,be.y,e-hn-Ut-Tt,0),be.dragBoundary(en),be.proportion=new t.Proportion(en.x,en.x+en.width,0,-V.scrollXMax),be.off("pressmove",et),et=be.on("pressmove",function(){V.dispatchEvent("scrolling"),te&&(te.x=-i.x,te.y=-i.y),i.x=be.proportion.convert(be.x),xt()}))),Ze&&T&&(hn=Math.max(ie.minSize,(r-Bt-gn)*(r-Bt-gn)/(He+k+ie.margin)),ee.f(ie.color).rr(0,0,ie.size,hn,ie.corner),me.x=e-ie.size-ie.spacing,me.y=Bt,Re=new t.Proportion(-V.scrollYMax,0,Bt,r-hn-gn,-1),p&&(me.setBounds(0,0,ie.size,hn),en=new Ne.Rectangle(me.x,Bt,0,r-hn-Bt-gn),me.dragBoundary(en),me.proportion=new t.Proportion(en.y,en.y+en.height,0,-V.scrollYMax),me.off("pressmove",ge),ge=me.on("pressmove",function(){O&&(xe=!0),V.dispatchEvent("scrolling"),te&&(te.x=-i.x,te.y=-i.y),O?Zt=me.proportion.convert(me.y):i.y=me.proportion.convert(me.y),xt()}))),Yt(),clearTimeout(V.d2Timeout),V.d2Timeout=setTimeout(function(){be&&be.proportion&&(i.x=be.proportion.convert(be.x)),me&&me.proportion&&(i.y=me.proportion.convert(me.y))},50),clearTimeout(V.dTimeout),V.dTimeout=setTimeout(function(){ze()},300),ze(),xt()},this.resize=function(yt,je){n(yt)&&(yt=e),n(je)&&(je=r);var ht=Math.max(20,c*2);X&&(ht=Math.max(ue,ht)),yt<ht&&(yt=ht),je<20&&(je=20),e=yt,r=je,Pe();for(var Gt=0;Gt<i.numChildren;Gt++){var Kt=i.getChildAt(Gt);Kt.type=="Wrapper"&&ot(Kt)}return F&&Qe(),V.update(),Zt=i.y,O&&zt.immediate(Zt),V.dispatchEvent("resize"),V},!n(X)){n(q)&&(q=!0),typeof X=="string"&&(X=new t.Label({text:X,color:R,size:pe.size!=null?pe.size:20,backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",group:this.group}));var he=V.titleBarLabel=X;he.noMouse(),n(Q)&&(Q="rgba(0,0,0,.2)"),V.titleBar=X=new t.Container(e,K,null,null,!1).centerReg(V).mov(0,-r/2-K/2);var Ge=new t.Rectangle(X.width-1,X.height,red).alp(0).addTo(X);he.setMask(Ge,!0);var qe=V.titleBar.backing=new t.Rectangle(e+s,K,Q,null,null,[c*.95,c*.95,0,0],!0,null,!1,!1).center(X);he.center(X).pos({x:Math.max(c/2,Math.max(10,f)),reg:!0}),V.regX=0,V.regY=-K,V.setBounds(0,-K,e,r+K),q?(X.cur("pointer"),X.on("mousedown",function(){V.drag({rect:ne,currentTarget:!0,onTop:U})}),X.on("pressup",function(){V.noDrag(!1)})):X.on("mousedown",function(){})}if(D){n(d)&&(d=t.grey);var Fe=V.closeIcon=new t.Shape(-40,-40,80,80,null,!1);Fe.graphics.f(d).p("AmJEVIEUkTIkXkWIB4h5IEWEYIETkTIB4B3IkTESIEQERIh4B4IkRkRIkSEVg"),X?Fe.centerReg(V).scaleTo(X,null,50).pos({x:e-Math.max(c/2,10)-Fe.width/2,y:K/2,reg:!0}).expand(40):Fe.sca(.3).pos(Math.max(c/2,10)/2,Fe.height/2,!0,!1,V).expand(40),Fe.cur("pointer"),Fe.expand(),Fe.on((Pt?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){var yt=V.stage;V.removeFrom(),V.dispatchEvent("close"),yt&&yt.update()})}var We,ce,Ve,Se,Ae,Ye;if(!n(X)){if(o){V.fullSize=function(yt){if(n(yt)&&(yt=!0),yt==ce||!V.parent)return V;yt?(Ve=V.width,Se=V.height,Ae=V.x,Ye=V.y,V.resize(V.parent.width,V.parent.height),V.x=0,V.y=0,ce=!0,Ue.alpha=1,Xe.getChildAt(0).alpha=.01,V.dispatchEvent("fullsize")):(V.resize(Ve,Se-X.height),V.x=Ae,V.y=Ye,ce=!1,Ue.alpha=0,Xe.getChildAt(0).alpha=1,V.dispatchEvent("originalsize")),V.stage&&V.stage.update()},n(S)&&(S=t.grey);var Xe=V.fullSizeIcon=new t.Rectangle(80,80,t.faint,S,16),Ue=new t.Shape().s(S).ss(16).mt(-19.6,-20.6).lt(-19.6,-40).lt(40,-40).lt(40,20.7).lt(19.6,20.7).lt(19.6,40).lt(-40,40).lt(-40,-20.6).lt(-19.6,-20.6).lt(19.6,-20.6).lt(19.6,20.7).addTo(Xe).mov(40,40).alp(0);Xe.centerReg(V).scaleTo(X,null,42).pos({x:e-Math.max(c/2,10)-Xe.width/2,y:K/2,reg:!0}).expand(40),Fe&&Xe.mov(-Fe.width-10),Xe.cur("pointer"),Xe.expand(),ce=!1,Ve=e,Se=r,Ae=V.x,Ye=V.y,Xe.on((Pt?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){ce?V.fullSize(!1):V.fullSize(!0)})}var rt=t.copy(V.getBounds(),!0);if(h){We=ye,V.collapse=function(yt){if(n(yt)&&(yt=!0),yt==We)return V;yt?(Te.rot(180),V.backing.visible=!1,V.contentContainer.visible=!1,ke.visible=!1,be&&(be.visible=!1),be&&(me.visible=!1),ae&&(ae.visible=!1),We=!0,qe.sha(L,5,5,Y),F&&(V.resizeHandle.visible=!1),V.setBounds(rt.x,rt.y,rt.width,X.height),V.dispatchEvent("collapse")):(Te.rot(0),V.backing.visible=!0,V.contentContainer.visible=!0,ke.visible=!0,be&&(be.visible=!0),be&&(me.visible=!0),ae&&(ae.visible=!0),We=!1,qe.sha(null),F&&(V.resizeHandle.visible=!0),V.setBounds(rt.x,rt.y,rt.width,rt.height),V.dispatchEvent("expand")),V.stage&&V.stage.update()},n(b)&&(b=t.grey);var Te=V.collapseIcon=new t.Triangle(90,90,90,t.faint,b,16);Te.centerReg(V).scaleTo(X,null,42).pos({x:e-Math.max(c/2,10)-Te.width/2,y:K/2,reg:!0}).expand(40),Fe&&Te.mov(-Fe.width-10),Xe&&Te.mov(-Xe.width-10),Te.cur("pointer"),Te.expand(),We=!1,Ve=e,Se=r,Ae=V.x,Ye=V.y,Te.on((Pt?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){We?V.collapse(!1):V.collapse(!0)})}}if(F){var $e=new jr().loc(0,0,V).mov(V.width,V.height-(V.titleBar?V.titleBar.height:0)),lt=V.resizeHandle=new t.Rectangle(25,25,t.grey,t.white).alp(re?.5:.01).centerReg().rot(45).loc(0,0,$e).drag({boundary:N,localBoundary:!0});lt.on("mouseover",function(){lt.alp(.5),lt.stage&&lt.stage.update()}),lt.on("mousedown",function(){lt.pressing=!0}),lt.on("mouseout",function(){lt.pressing||(re||lt.alp(.01),lt.stage&&lt.stage.update())}),lt.on("pressmove",function(){V.resize(Math.max(50,$e.x+lt.x),Math.max(50,$e.y+lt.y))}),lt.on("pressup",function(){lt.pressing=!1,re||lt.alp(.01),Qe(),lt.stage&&lt.stage.update()}),V.titleBar&&V.titleBar.on("pressup",Qe)}function Qe(yt){V.resizeHandle.loc(0,0,$e).top().mov(-$e.x+V.width,-$e.y+V.height-(V.titleBar?V.titleBar.height:0))}function ot(yt){yt.align=="right"?(yt.x=_,yt.resize(V.width-(Ze?ie.size+ie.spacing*2:_)-_*2)):(yt.align=="center"||yt.align=="middle",yt.resize(V.width-(Ze?ie.size+ie.spacing*2:0)-_*2)),yt.alpha=yt.wrapperLastAlpha}if(Pe(),this.add=function(yt,je,ht,Gt){var Kt="obj, index, center, replace",$t;if($t=st(V.add,arguments,Kt,V))return $t;var Ut=yt;if(!Ut.getBounds()){tt("Window.add() - please add content with bounds set");return}return yn(Ut),n(je)&&(je=i.numChildren),Gt&&(je=0,V.removeAll()),ht?(Ut.center(V).addTo(i,je).mov(0,K?K/2:0),i.height>V.height-(K||0)&&Ut.loc(null,0),i.width>V.width&&Ut.loc(0)):Ut.addTo(i,je),Ut.type=="Wrapper"&&(me.alpha=0,v=!1,Ut.wrapperLastAlpha=Ut.alpha,Ut.alpha=0,this.added(function(){ot(Ut),V.resize(),be.alpha=1,me.alpha=1})),Ut.x==0&&(Ut.x=_),Ut.y==0&&(Ut.y=k),V.update(),V},Ce){var ft=t.makeContent(Ce,e),ut=["header","message","text","display","buttons","config"];ut.forEach(function(yt){ft[yt]&&(V[yt]=ft[yt])}),V.label=V.message,V.add(ft,0,!0)}this.remove=function(yt){return i.removeChild(yt),V.update(),V},this.removeAll=function(){return i.removeAllChildren(),V.update(),V};function ze(yt){le||(n(Me)&&(Me=V.stage||j.zdf.stage),n(yt)&&(yt=!0),yt?t.dragBoundary(i,new Ne.Rectangle(0,0,_e?-V.scrollXMax:0,Ze?-V.scrollYMax:0)):t.dragBoundary(i,new Ne.Rectangle(-1e3,-1e3,Me.width+2e3,Me.height+2e3)))}var kt=!1;w&&i.on("mousedown",function(){kt||t.Ticker.add(Mt,i.stage),kt=!0,_e&&T&&m&&t.animate(be,{alpha:P},ie.showTime),Ze&&T&&m&&t.animate(me,{alpha:P},ie.showTime)});function Mt(){Zt=i.y,O&&zt.immediate(Zt),T?Yt():V.dispatchEvent("scrolling")}function xt(){V.optimize&&(Me=V.stage,i.loop(function(yt){!yt.hitTestBounds||!yt.stage||(yt.hitTestBounds(V,300)?(yt.visible=!0,yt.loop&&yt.loop(function(je){je.hitTestBounds&&(je.hitTestBounds(V,300)?je.visible=!0:je.visible=!1)})):yt.visible=!1)}))}function Yt(){xt(),V.dispatchEvent("scrolling"),te&&(te.x=-i.x,te.y=-i.y),_e&&T&&(be.x=Ie.convert(i.x)),Ze&&T&&(me.y=Re.convert(i.y))}this.on("added",function(){Dt(50)},null,!0);function Dt(yt){n(yt)&&(yt=100),yn(V),w&&setTimeout(function(){i&&(t.drag({obj:i,currentTarget:!0,axis:le,localBoundary:!0,slide:g,slideFactor:E,slideSnap:v&&(w===!0||w=="auto"||w=="horizontal")||I&&(w===!0||w=="auto"||w=="vertical")?A:!1}),i.removeAllEventListeners("slidestart"),i.on("slidestart",function(){V.dispatchEvent("slidestart")}),i.removeAllEventListeners("slidestop"),!T&&B&&(V.zDE&&i.off(V.zDE),V.zDE=i.on("mousedown",()=>{V.zTI&&t.Ticker.remove(xt)}),V.zME&&i.off(V.zME),V.zME=i.on("pressmove",xt),V.zSTA&&i.off(V.zSTA),V.zSTA=i.on("slidestart",function(){V.zTI=t.Ticker.add(xt)}),V.zSTO&&i.off(V.zSTO),V.zSTO=i.on("slidestop",function(je){V.zTI&&t.Ticker.remove(V.zTI)})),i.on("slidestop",function(je){g&&nn(je),V.dispatchEvent("slidestop")}),i.getBounds()&&i.getBounds().width>0&&ze())},yt)}this.cancelCurrentDrag=function(){V.contentContainer&&V.contentContainer.noDrag(!1),setTimeout(function(){i&&(t.drag({obj:i,currentTarget:!0,localBoundary:!0,slide:g,slideFactor:E,slideSnap:v&&(w===!0||w=="auto"||w=="horizontal")||I&&(w===!0||w=="auto"||w=="vertical")?A:!1}),i.getBounds()&&i.getBounds().width>0&&ze())},300)};var Ht;this.added(function(yt){Me=yt,Ht=Me.on("stagemousemove",function(je){V.windowMouseX=je.stageX/t.scaX,V.windowMouseY=je.stageY/t.scaY})}),g?i.on("slidestop",nn):i.on("mousedown",function(){i.stage.on("stagemouseup",nn,null,!0)}),u&&(V.blurEvent=function(){V.cancelCurrentDrag(),nn()},document.WW.addEventListener("blur",V.blurEvent));function nn(){t.Ticker.remove(Mt),kt=!1,_e&&m&&T&&t.animate(be,{alpha:0},ie.fadeTime),Ze&&m&&T&&t.animate(me,{alpha:0},ie.fadeTime)}var jt=!1,Et,Qt=0,Je=0,gt=0,Ot=0,mt=300,_t=2;function vt(){Et=Date.now(),t.Ticker.add(Vt,i.stage)}function Lt(){jt||(V.dispatchEvent("hoverout"),jt=!0),t.Ticker.remove(Vt)}function Vt(){if(!i.stage){jt||(V.dispatchEvent("hoverout"),jt=!0),t.Ticker.remove(Vt);return}Math.abs(Qt-V.windowMouseX)>_t||Math.abs(Je-V.windowMouseY)>_t?(jt||(V.dispatchEvent("hoverout"),jt=!0),Et=Date.now(),Qt=V.windowMouseX,Je=V.windowMouseY):Date.now()-Et>mt&&((Math.abs(gt-V.windowMouseX)>_t||Math.abs(Ot-V.windowMouseY)>_t)&&(V.contentMouse=i.globalToLocal(V.windowMouseX,V.windowMouseY),V.dispatchEvent("hoverover"),gt=V.windowMouseX,Ot=V.windowMouseY,jt=!1),Et=Date.now())}if(C){var Jt,tn;i.on("mousedown",function(yt){Me=yt.target.stage,Jt=yt.stageX/t.scaX,tn=Date.now()}),i.on("click",function(yt){Date.now()-tn<600&&Math.abs(yt.stageX/t.scaX-Jt)<5&&(V.contentMouse=i.globalToLocal(yt.stageX/t.scaX,yt.stageY/t.scaY),V.dispatchEvent("select"))}),i.on("mouseover",vt),i.on("mouseout",Lt)}var Zt=V.scrollY;V.scrollWindow=function(je){if(Ze&&V.stage&&V.hitTestPoint(V.windowMouseX,V.windowMouseY)&&V.contains(V.stage.getObjectUnderPoint(V.windowMouseX*t.scaX,V.windowMouseY*t.scaY))){n(je)&&(je=event);var ht=je.detail?je.detail*-19:je.wheelDelta;n(ht)&&(ht=je.deltaY*-19),Zt+=ht,Zt=Math.max(-V.scrollYMax,Math.min(0,Zt)),O||(V.scrollY=Zt,i.stage.update()),xe=!1}B&&xt()},$&&(j.addEventListener("mousewheel",V.scrollWindow),j.addEventListener("wheel",V.scrollWindow),j.addEventListener("DOMMouseScroll",V.scrollWindow));var an=!1,zt;function yn(yt){O&&!an&&yt.stage&&(an=!0,zt=new t.Damp(V.scrollY,O),V.dampTicker=t.Ticker.add(function(){if(!kt){if(V.scrollY!=null&&Zt!=null&&V.scrollY!=Zt&&Math.round(V.scrollY)==Math.round(Zt)){xe=!1;return}n(Zt)||(i.y=zt.convert(Zt)),xe||Yt()}},yt.stage))}this._enabled=!0,Object.defineProperty(V,"enabled",{get:function(){return V._enabled},set:function(yt){yt?Dt():(clearTimeout(V.dTimeout),t.noDrag(i)),bt(V,yt)}}),this._scrollEnabled=!0,Object.defineProperty(V,"scrollEnabled",{get:function(){return V._scrollEnabled},set:function(yt){yt?(Dt(),p&&(et&&(be.mouseEnabled=!0),ge&&(me.mouseEnabled=!0)),j.addEventListener("mousewheel",V.scrollWindow),j.addEventListener("wheel",V.scrollWindow),j.addEventListener("DOMMouseScroll",V.scrollWindow)):(clearTimeout(V.dTimeout),t.noDrag(i),p&&(et&&(be.mouseEnabled=!1),ge&&(me.mouseEnabled=!1)),j.removeEventListener("mousewheel",V.scrollWindow),j.removeEventListener("wheel",V.scrollWindow),j.removeEventListener("DOMMouseScroll",V.scrollWindow)),V._scrollEnabled=yt}}),Object.defineProperty(V,"scrollX",{get:function(){return i.x},set:function(yt){i.x=yt,clearTimeout(V.d2Timeout),i.zimDragImmediate&&i.zimDragImmediate(i.x,i.y),Yt()}}),Object.defineProperty(V,"scrollY",{get:function(){return i.y},set:function(yt){i.y=yt,i.y=Zt=yt,O&&zt.immediate(Zt),clearTimeout(V.d2Timeout),i.zimDragImmediate&&i.zimDragImmediate(i.x,i.y),Yt()}}),Object.defineProperty(V,"backgroundColor",{get:function(){return l},set:function(yt){l=yt,Pe()}}),Object.defineProperty(V,"borderColor",{get:function(){return a},set:function(yt){a=yt,Pe()}}),Object.defineProperty(V,"borderWidth",{get:function(){return s},set:function(yt){s=yt,Pe()}}),Object.defineProperty(V,"fullSized",{get:function(){return ce},set:function(yt){V.fullSize&&V.fullSize(yt)}}),Object.defineProperty(V,"collapsed",{get:function(){return We},set:function(yt){V.collapse&&V.collapse(yt)}}),ye&&(We=!1,V.collapsed=!0),V.titleBar&&(V.collapseEvent=V.titleBar.on("dblclick",function(){V.collapsed=!V.collapsed})),G!==!1&&t.styleTransforms(this,pe),this.clone=function(yt){n(yt)&&(yt=!0);var je=V.cloneProps(new t.Window(e,r,null,l,Z,de,f,c,w,T,p,ie.color,P,m,v,I,g,E,A,y,C,L,Y,_,k,X,R,Q,K,q,ne,U,D,d,u,o,S,F,h,b,ye,B,N,re,le,G,z,se));return yt&&(V.contentContainer.cloneChildren(je.contentContainer),je.update()),je},this.doDispose=function(yt,je,ht){return $&&(j.removeEventListener("mousewheel",V.scrollWindow),j.removeEventListener("wheel",V.scrollWindow),j.removeEventListener("DOMMouseScroll",V.scrollWindow)),i&&(V.zDE&&i.off(V.zDE),V.zME&&i.off(V.zME),V.zSTA&&i.off(V.zSTA),V.zSTO&&i.off(V.zSTO),V.zTI&&t.Ticker.remove(V.zTI)),V.titleBar&&V.titleBar.removeAllEventListeners(),Ht&&Me&&Me.off("stagemousemove",Ht),V.resizeHandle&&V.resizeHandle.removeAllEventListeners(),V.blurEvent&&j.removeEventListener("blur",V.blurEvent),typeof Vt<"u"&&t.Ticker.remove(Vt),n(Mt)||t.Ticker.remove(Mt),ht||this.zimContainer_dispose(!0),i=V.contentContainer=null,!0}},t.extend(t.Window,t.Container,["clone","dispose"],"zimContainer",!1),t.Window.prototype.dispose=function(e){return this.doDispose(null,null,e)},pi=t.Window,t.Page=function(e,r,i,l,a,s,f,c,w,T,p){var x="width, height, color, color2, angle, pattern, scalePattern, cache, style, group, inherit",P;if(P=st(t.Page,arguments,x,this))return P;De("58.3"),this.group=T;var m=w===!1?{}:t.getStyle("Page",this.group,p);n(e)&&(e=m.width!=null?m.width:j.zdf.width),n(r)&&(r=m.height!=null?m.height:j.zdf.height),this.zimContainer_constructor(0,0,e,r,!1),this.type="Page";var v=this;n(a)&&(a=m.angle!=null?m.angle:90),n(i)&&(i=m.color!=null?m.color:t.light),n(l)&&(l=m.color2!=null?m.color2:null),n(s)&&(s=m.pattern!=null?m.pattern:null),n(f)&&(f=m.scalePattern!=null?m.scalePattern:"fill"),n(c)&&(c=m.cache!=null?m.cache:!1),n(l)||(i=new t.GradientColor([i,l],[0,1],a),l=null);var I=this.backing=new t.Rectangle({width:e,height:r,color:i,scaleDimensions:!1,style:!1}).addTo(this);n(c)&&(!n(l)||!n(s))&&(c=!0),c&&I.cache(),n(s)||(this.pattern=s.addTo(this),f&&s.scaleTo(this,100,100,f).center(this),c&&s.cache()),Object.defineProperty(v,"color",{get:function(){return i},set:function(g){n(g)&&(g=t.black),i=g,v.backing.color=g}}),w!==!1&&t.styleTransforms(this,m),this.clone=function(g){n(g)&&(g=!1),i.type&&(l=null);var E=v.cloneProps(new t.Page(e,r,i,l,vertical,s,f,c,w,T,p));return g&&v.cloneChildren(E),E}},t.extend(t.Page,t.Container,["clone"],"zimContainer",!1),t.Central=function(e,r,i,l,a){De("58.4"),this.group=l;var s=i===!1?{}:t.getStyle("Central",this.group,a);n(e)&&(e=s.width!=null?s.width:1024),n(r)&&(r=s.height!=null?s.height:768),this.zimContainer_constructor(-e/2,-r/2,e,r);var f=this,c=zimDefaultFrame;f.resizeEvent=c.on("resize",function(){f.scale=c.height/r,f.parent&&f.centerReg(f.parent)}),f.added(function(){f.parent&&f.centerReg(f.parent)}),f.dispose=function(w,T,p){return c.off("resize",f.resizeEvent),f.zimContainer_dispose(w,T,p)},i!==!1&&t.styleTransforms(this,s)},t.extend(t.Central,t.Container,["dispose"],"zimContainer",!1),t.Layer=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O,X,R,Q){var K="width, height, titleBar, titleBarContainer, backgroundColor, rollBackgroundColor, selectedBackgroundColor, selectedRollBackgroundColor, color, rollColor, selectedColor, selectedRollColor, borderWidth, borderColor, dashed, transformObject, titleBarWidth, titleBarHeight, titleBarX, titleBarY, titleBarDraggable, close, closeColor, closeBackgroundColor, closeIndicatorColor, anchor, onTop, style, group, inherit",q;if(q=st(t.Layer,arguments,K,this))return q;De("58.5"),this.group=R;var ne=X===!1?{}:t.getStyle("Layer",this.group,Q);n(e)&&(e=ne.width!=null?ne.width:500),n(r)&&(r=ne.height!=null?ne.height:500),this.zimContainer_constructor(0,0,e,r,!1),this.type="Layer";var U=this;U.distX=40,U.distY=0,n(i)&&(i=ne.titleBar!=null?ne.titleBar:"LAYER");var D=i,d=i,u=!0;n(a)&&(a=ne.backgroundColor!=null?ne.backgroundColor:t.lighter),n(s)&&(s=ne.rollBackgroundColor!=null?ne.rollBackgroundColor:t.white),n(f)&&(f=ne.selectedBackgroundColor!=null?ne.selectedBackgroundColor:t.granite),n(w)&&(w=ne.color!=null?ne.color:t.granite),n(T)&&(T=ne.rollColor!=null?ne.rollColor:t.granite),n(p)&&(p=ne.selectedColor!=null?ne.selectedColor:t.moon),n(P)&&(P=ne.borderWidth!=null?ne.borderWidth:1),n(m)&&(m=ne.borderColor!=null?ne.borderColor:a),(m<0||P<0)&&(m=P=null),n(v)&&(v=ne.dashed!=null?ne.dashed:!0),n(I)&&(I=ne.titleBar!=null?ne.titleBar:null),n(g)&&(g=ne.titleBarWidth!=null?ne.titleBarWidth:100);var o=g;if(n(E)&&(E=ne.titleBarHeight!=null?ne.titleBarHeight:40),n(A)&&(A=ne.titleBarX!=null?ne.titleBarX:null),n(y)&&(y=ne.titleBarY!=null?ne.titleBarY:null),n(C)&&(C=ne.titleBarDraggable!=null?ne.titleBarDraggable:!0),n(L)&&(L=ne.close!=null?ne.close:!0),n(Y)&&(Y=ne.closeColor!=null?ne.closeColor:f),n(_)&&(_=ne.closeBackgroundColor!=null?ne.closeBackgroundColor:f),n(k)&&(k=ne.closeIndicatorColor!=null?ne.closeIndicatorColor:p),n($)&&($=ne.anchor!=null?ne.anchor:!0),n(O)&&(O=ne.onTop!=null?ne.onTop:!0),C||($=!1),U.anchor=$,L&&(g+=30),I=t.merge({borderColor:f},I,{onTop:O,events:!0,visible:!1,ghostColor:m,ghostWidth:P,ghostDashed:v,ghostHidden:!0}),n(l)&&(l=ne.titleBarContainer!=null?ne.titleBarContainer:null),n(l))if(j.zdf)l=j.zdf.stage;else{tt("zim Layer(): Please pass in a reference to a container with bounds set.");return}U.active=!1,U.turnOff=function(){U.active=!1,L&&(U.checkBox.visible=!1),U.transformControls.remove(),U.mouseChildren=!0,U.button.backgroundColor=a,U.button.rollBackgroundColor=s,U.button.color=w,U.button.rollColor=w,U.transformControls.allowToggleOff(),U.resizeChildren&&U.resizeChildren()},U.turnOn=function(){U.active=!0,L&&(U.checkBox.visible=!0,U.checkBox.checked=!0),U.button.backgroundColor=f,U.button.rollBackgroundColor=f,U.button.color=p,U.button.rollColor=p,U.mouseChildren=!1,U.transformControls.add(),U.transformControls.allowToggleOn()};var S;U.titleBarPos=function(b,ye){if(U.titleBar)return U.titleBar.pos?(U.titleBar.pos(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9]),S.update()):(U.distX=b,U.distY=ye),u=!1,U};var F=U.visible;U.visible=!1;var h=wt();this.added(function(b){S=b,U.transform(I),P>=0&&U.transformControls.hideGhost(),setTimeout(function(){function ye(){return U.localToLocal(0,0,l)}U.visible=F,P>=0&&setTimeout(function(){U.transformControls.showGhost(),U.stage&&U.stage.update()},200),S=b;var B=U.titleBar=new t.Container(g,E).reg(0,E).loc(U,null,l).mov(U.distX,U.distY);C&&B.drag({all:!0,boundary:new t.Boundary(0,E,l.width-g,l.height-E),localBoundary:!0}),(U.distX!=40||U.distY!=0)&&B.pos(U.distX,U.distY),L&&(U.checkBox=new t.CheckBox({borderColor:Y,backgroundColor:_,indicatorColor:k,size:20,startChecked:!0}).center(B).pos(0,null,!0).change(function(){U.turnOff(),U.dispatchEvent("transformhide")}),U.checkBox.visible=!1),B.mouseChildren=!0,B.layer=U,U.resetTitleBar=function(){U.distX=40,U.distY=0,u=!0,U.move(!0),U.stage&&U.stage.update()},(typeof d=="string"||typeof d=="number")&&(d=new t.Label({text:d,color:w,rollColor:T,size:ne.size!=null?ne.size:18,group:this.group})),U.label=d,U.label.center(B),U.button=new t.Button({shadowBlur:-1,width:o,height:E-1,label:U.label,color:w,rollColor:T,backgroundColor:a,rollBackgroundColor:s,corner:ne.corner!=null?ne.corner:0,inherit:t.copy(ne)}).addTo(B),U.button.on("mousedown",function(){l.loop(function(J){J&&J!=B&&J.layer&&J.layer.turnOff&&J.layer.active&&J.layer.turnOff()}),U.active||(U.turnOn(),U.dispatchEvent("transformshow")),B.top()}),U.button.on("pressmove",function(){N()}),U.button.on("pressup",function(){N(!0);var J=U.localToLocal(0,0,l);U.distX=B.x-J.x,U.distY=B.y-J.y,B.top(),!le()&&C&&(J=U.localToGlobal(0,0),U.button.hitTestPoint(J.x,J.y)&&U.resetTitleBar())});function N(J){if(u&&C){var pe=l.localToLocal(B.x-U.distX,B.y-U.distY,U.parent),Z=U.localToLocal(U.regX,U.regY,U.parent),de=U.localToLocal(0,0,U.parent);U.x=pe.x+(Z.x-de.x),U.y=pe.y+(Z.y-de.y),U.transformControls.resize(J),re(U),U.stage&&U.stage.update()}}function re(J){J.loop(function(pe){pe.type=="Layer"&&(U.titleBarDraggable&&pe.move(),pe.transformControls.ghost&&pe.transformControls.resize(),re(pe))})}U.button.on("dblclick",function(){C&&U.resetTitleBar()}),U.turnOff(),U.on("transformed",function(J){(J.transformType=="move"||J.transformType=="size"||J.transformType=="stretch"||J.transformType=="rotate")&&(C&&U.move(),re(U))});function le(){if(B.x==0||B.y==B.height||B.x==l.width-B.width||B.y==l.height)return!0}U.move=function(J){!J&&!u&&U.anchor&&le()||(B.loc(ye()).mov(U.distX,U.distY),B.x<0&&(u=!1,B.x=0),B.y<B.height&&(u=!1,B.y=B.height),B.x>l.width-B.width&&(u=!1,B.x=l.width-B.width),B.y>l.height&&(u=!1,B.y=l.height),U.anchor||(u=!0))},U.on("transformhide",function(){U.turnOff(),l.loop(function(J){J&&J!=B&&J.layer&&J.layer.turnOff&&J.layer.active&&J.layer.turnOff()})}),U.resizeChildren=function(J){U.transformControls.resize(J),U.loop(function(pe){pe.transformControls&&(pe.transformControls.visible&&pe.transformControls.hide(),pe.type=="Layer"?pe.resizeChildren():pe.transformControls.resize())})},U.resize=function(J){return U.move(),U.resizeChildren(J),U},U.toggled=!1;function G(){U.toggled?(l.loop(function(J){J&&J!=B&&J.layer&&J.layer.turnOff&&J.layer.active&&J.layer.turnOff()}),U.turnOn(),U.dispatchEvent("transformshow")):(B.top(),U.turnOff(),l.loop(function(J){J&&J!=B&&J.layer&&J.layer.turnOff&&J.layer.active&&J.layer.turnOff()}),U.dispatchEvent("transformhide")),U.stage&&U.stage.update()}if(U.toggle=function(J){return n(J)?U.toggled=!U.toggled:U.toggled=J,G(),U},Object.defineProperty(U,"titleBarDraggable",{get:function(){return C},set:function(J){C=J,C?B.drag({all:!0,boundary:t.Boundary(0,40,l.width-g,l.height-E),localBoundary:!0}):B.noDrag(!1)}}),U.stageUpEvent=S.on("stagemouseup",function(){U.transformControls.visible&&B.top()}),!n(A)||!n(y)){u=!1;var z=n(A)?B.x:A,se=n(y)?B.y-E:y;U.titleBarStartX=A,U.titleBarStartY=y,U.titleBarPos(z,se);var Oe=U.parent.localToLocal(U.x,U.y,l);U.distX=B.x-Oe.x,U.distY=B.y-Oe.y}},50)},h=="s"?.05:50),X!==!1&&t.styleTransforms(this,ne),this.clone=function(){return U.cloneProps(new t.Layer(e,r,D,l,a,s,f,c,w,T,p,x,P,m,v,I,o,E,A,y,C,L,Y,_,k,$,O,X,this.group,Q))},this.dispose=function(b,ye,B){return U.stageUpEvent&&S.off("stagemouseup",U.stageUpEvent),l&&l.loop(function(N){N.layer=null}),U.transformControls.dispose(),U.transformControls=null,B||this.zimContainer_dispose(!0),U.titleBar.layer=null,U.titleBar.dispose(),U.checkBox=U.button=null,i=U.titleBar=I=null,!0}},t.extend(t.Layer,t.Container,["clone","dispose"],"zimContainer",!1),t.Waiter=function(e,r,i,l,a,s,f,c,w,T,p){var x="container, speed, foregroundColor, backgroundColor, corner, shadowColor, shadowBlur, fadeTime, style, group, inherit",P;if(P=st(t.Waiter,arguments,x,this))return P;De("59"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Waiter",this.group=T;var m=w===!1?{}:t.getStyle(this.type,this.group,p),v=wt(r);n(r)&&(r=m.speed!=null?m.speed:v=="s"?.6:600),n(i)&&(i=m.foregroundColor!=null?m.foregroundColor:t.white),n(l)&&(l=m.backgroundColor!=null?m.backgroundColor:"orange"),n(a)&&(a=m.corner!=null?m.corner:16),n(s)&&(s=m.shadowColor!=null?m.shadowColor:"rgba(0,0,0,.3)"),n(f)&&(f=m.shadowBlur!=null?m.shadowBlur:14),n(c)&&(c=m.fadeTime!=null?m.fadeTime:0);var I=40,g=3,E=I*.6/2,A=(I-E*2)/2,y=g*(E*2+A)+A;this.setBounds(-y/2,-I/2,y,I);var C=this,L,Y=this.display=new t.Shape({style:!1});this.addChild(Y),Y.setBounds(0,0,y,I),Y.regX=y/2,Y.regY=I/2;var _=Y.graphics;_.f(l);var k=a;Array.isArray(k)||(k=[a,a,a,a]),_.rc(0,0,y,I,k[0],k[1],k[2],k[3]),s!=-1&&f>0&&(Y.shadow=new Ne.Shadow(s,3,3,f)),Y.on("click",function(K){K.stopImmediatePropagation()});var $=new t.Container({style:!1});this.addChild($);for(var O,X=0;X<g;X++)O=new Ne.Shape,O.graphics.f(i).dc(0,0,E),O.x=(X-(g-1)/2)*(E*2+A),$.addChild(O),O.cache(-E,-E,E*2,E*2),O.alpha=0;this.hide=function(){c>0?C.animate({obj:{alpha:0},time:c,call:K}):K();function K(){if(C.parent&&C.parent.removeChild(C),L=C.stage,L&&L.update(),C.zimAccessibility){var q=C.zimAccessibility;q.resize(C),R?R.focus():C.zimTabTag.nextSibling.focus(),setTimeout(function(){q.talk("Waiter has finished.")},50)}}return C.toggled=!1,C};var R,Q=[];this.show=function(){var K="zim display - Waiter(): Please pass in a reference to a container with bounds set as first parameter to Waiter";if(n(e))if(j.zdf)e=j.zdf.stage;else{tt(K);return}else if(e.getBounds){if(n(e.stage)){tt("zim display - Waiter(): The container must have a stage property");return}}else{tt(K);return}for(var q,ne=0,U=r*(v=="s"?1e3:1),D=0;D<$.numChildren;D++)$&&Q.push(setTimeout(function(){q=$.getChildAt(ne),Ne.Tween.get(q,{loop:!0}).to({alpha:1},U/g/2).wait(U/g).to({alpha:0},U/g).wait(U-U/g-U/g/2),ne++},D*U/g));if(C.ticker=Ne.Ticker.on("tick",function(){e.stage.update()}),C.x=e.getBounds().width/2,C.y=e.getBounds().height/2,e.addChild(C),c>0&&(C.alpha=0,C.animate({alpha:1},c)),C.zimAccessibility){var d=C.zimAccessibility;setTimeout(function(){d.activatedObject&&(R=d.activatedObject.zimTabTag)},50),d.resize(C),d.talk(C.zimTabTag.getAttribute("aria-label"))}return C.toggled=!0,C},C.toggle=function(K){return K===!0?C.show():K===!1||C.parent?C.hide():C.show(),C},w!==!1&&t.styleTransforms(this,m),this.clone=function(){return C.cloneProps(new t.Waiter(e,r,i,l,a,s,f,c,w,this.group,p))},this.dispose=function(K,q,ne){C.ticker&&Ne.Ticker.off("tick",C.ticker),Ne.Tween.removeTweens(C),C.removeFrom();for(var U=0;U<$.numChildren;U++){var D=$.getChildAt(U);clearInterval(Q[U]),Ne.Tween.removeTweens(D)}return ne||this.zimContainer_dispose(!0),!0}},t.extend(t.Waiter,t.Container,["clone","dispose"],"zimContainer",!1),t.ProgressBar=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L){var Y="barType, foregroundColor, backgroundColor, borderColor, borderWidth, padding, label, color, labelPosition, percentage, corner, shadowColor, shadowBlur, backing, delay, fastClose, container, autoHide, width, style, group, inherit",_;if(_=st(t.ProgressBar,arguments,Y,this))return _;De("59.5"),this.zimContainer_constructor(null,null,null,null,!1),this.type="ProgressBar",this.group=C;var k=y===!1?{}:t.getStyle(this.type,this.group,L);n(r)&&(r=k.foregroundColor!=null?k.foregroundColor:t.green),n(i)&&(i=k.backgroundColor!=null?k.backgroundColor:t.charcoal),n(l)&&(l=k.borderColor!=null?k.borderColor:i),n(a)&&(a=k.borderWidth!=null?k.borderWidth:null),n(w)&&(w=k.labelPosition!=null?k.labelPosition:"bottom"),n(e)&&(e=k.barType!=null?k.barType:"circle"),n(s)&&(s=k.padding!=null?k.padding:e=="circle"?2:-.5),n(p)&&(p=k.corner!=null?k.corner:15),n(x)&&(x=k.shadowColor!=null?k.shadowColor:"rgba(0,0,0,.3)"),n(P)&&(P=k.shadowBlur!=null?k.shadowBlur:14),n(m)&&(m=k.backing!=null?k.backing.clone():null),n(I)&&(I=k.fastClose!=null?k.fastClose:!0),l<0||a<0?l=a=null:l!=null&&a==null&&(e=="circle"?a=10:a=2);var $=wt(v);n(v)&&(v=k.delay!=null?k.delay:$=="s"?.1:100),n(E)&&(E=k.autoHide!=null?k.autoHide:!0),n(f)&&(f=k.label!=null?k.label:null),n(c)&&(c=k.color!=null?k.color:r),n(A)&&(A=k.width!=null?k.width:e=="circle"?40:200),(typeof f=="string"||typeof f=="number")&&(f=new t.Label({text:f,color:c,backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",group:this.group})),!n(T)&&n(f)&&(f=new t.Label("")),this.label=f;var O=30,X=this,R=0;X.visible=!1,setTimeout(function(){X.visible=!0,X.stage&&X.stage.update()},v);var Q;if(e=="circle")A=A/2,m=this.backing=new t.Circle(A,"rgba(0,0,0,0)",i,a,null,null,null,null,!1).addTo(X),Q=this.bar=new t.Shape({style:!1}).addTo(X).loc(m.x,m.y).rot(-90);else{if(x!=-1&&P>0){var K=new t.Rectangle(A-2,O-2,i,null,null,p,null,null,null,!1).addTo(this);K.shadow=new Ne.Shadow(x,3,3,P)}m=D(m);var q=p;Array.isArray(q)||(q=[p,p,p,p]);var ne=(s+a/2)*1.2;Q=this.bar=new t.Rectangle(A-(s+a/2)*1.8,O-(s+a/2)*1.8,r,null,null,[q[0]-ne,q[1]-ne,q[2]-ne,q[3]-ne],null,null,null,!1).center(this);var U=this.mask=new t.Rectangle(A-(s+a/2)*1.8,O-(s+a/2)*1.8,null,null,null,null,null,null,null,!1).center(this).alp(0).sca(0,1);Q.setMask(U)}function D(S){var F;if(X.backing?(F=X.getChildIndex(X.backing),X.removeChild(X.backing)):F=X.numChildren,X.border&&X.removeChild(X.border),!n(S)&&S.type=="Pattern"){var h=S;S=X.backing=new t.Rectangle(A,O,i,null,null,p,null,null,null,!1).addTo(X,F),S.pattern=h,h.center(S),h.setMask(S.shape),a&&(X.border=new t.Rectangle(A,O,"rgba(0,0,0,0)",l,a,p,null,null,null,!1).addTo(X,F+1))}else S=X.backing=n(S)?new t.Rectangle(A,O,i,l,a,p,null,null,null,!1).addTo(X,F):m.addTo(X,F);return S}X.setBacking=function(S){D(S),X.stage&&X.stage.update()},m.on("click",function(S){S.stopImmediatePropagation()}),n(f)||(f.scaleX=f.scaleY=.8,f.startText=f.text,n(T)||(f.text=f.startText+"  0%"),f.center(X),w=="above"?f.y-=60:f.y+=60,f.alpha=.8),this.hide=function(){var S=X.stage;if(X.parent&&X.parent.removeChild(X),X.backing.type=="Pattern"&&X.backing.pauseInterval&&X.backing.pauseInterval(),S&&S.update(),X.zimAccessibility){var F=X.zimAccessibility;F.resize(X),d?d.focus():X.zimTabTag.nextSibling.focus(),setTimeout(function(){F.talk("Progress Bar has finished.")},50)}return X.toggled=!1,X};var d;this.show=function(){var S="zim display - ProgressBar(): Please pass in a reference to a container with bounds set as first parameter of the ProgressBar";if(n(g))if(j.zdf)g=j.zdf.stage;else{tt(S);return}else if(g.getBounds){if(n(g.stage)){tt("zim display - Waiter(): The container must have a stage property");return}}else{tt(S);return}if(X.timeOut&&clearTimeout(X.timeOut),u(0),X.zimActiveLoader&&X.zimActiveLoader.on("progress",function(h){R=h.progress*100,u(R)}),X.center(g),X.backing.type=="Pattern"&&X.backing.pauseInterval&&X.backing.pauseInterval(!1),X.zimAccessibility){var F=X.zimAccessibility;setTimeout(function(){F.activatedObject&&(d=F.activatedObject.zimTabTag)},50),F.resize(X),F.talk(X.zimTabTag.getAttribute("aria-label"))}return X.toggled=!0,X},X.toggle=function(S){return S===!0?X.show():S===!1||X.parent?X.hide():X.show(),X},X.run=function(S,F){n(F)||(E=F),n(S)&&(S=$=="s"?3:3e3),It(S,$);var h=S*($=="s"?1e3:1);X.runInterval&&clearInterval(X.runInterval),X.percent=0;var b=Date.now();return X.runInterval=setInterval(function(){X.percent=(Date.now()-b)/h*100,X.percent>=100&&(X.percent=100,clearInterval(X.runInterval))},30),X},X.dispatched=!1;function u(S){e=="circle"?Q.graphics.c().mt(0,0).s(r).ss(a-s*2+.5).a(0,0,A,0,360*S/100*Math.PI/180):(U.sca(S/100,1),Q.setMask(U)),n(T)||(f.text=f.startText+" "+Math.min(Math.round(S),100)+"%"),E&&I&&Math.round(S)>=100&&(X.timeOut=setTimeout(function(){X.hide()},200)),!X.dispatched&&Math.round(S)>=100&&(X.dispatchEvent("complete"),X.dispatched=!0,setTimeout(function(){X&&(X.dispatched=!1)},100)),X.stage&&X.stage.update()}Object.defineProperty(X,"percent",{get:function(){return R},set:function(S){R=S,u(S)}});var o=X.getBounds();X.setBounds(o.x-5,o.y-5,o.width+10,o.height+10),y!==!1&&t.styleTransforms(this,k),this.clone=function(){return X.cloneProps(new t.ProgressBar(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,this.group,L))},this.dispose=function(S,F,h){return X.backing.type=="Pattern"&&X.backing.clearInterval&&X.backing.clearInterval(),X.runInterval&&clearInterval(X.runInterval),h||this.zimContainer_dispose(!0),!0}},t.extend(t.ProgressBar,t.Container,["clone","dispose"],"zimContainer",!1),t.Indicator=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C){var L="width, height, num, foregroundColor, backgroundColor, borderColor, borderWidth, backdropColor, corner, indicatorType, fill, scale, lightScale, interactive, shadowColor, shadowBlur, selectedIndex, backgroundAlpha, style, group, inherit",Y;if(Y=st(t.Indicator,arguments,L,this))return Y;De("60"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Indicator",this.group=y;var _=A===!1?{}:t.getStyle(this.type,this.group,C);n(e)&&(e=_.width!=null?_.width:300),n(r)&&(r=_.height!=null?_.height:50),n(i)&&(i=_.num!=null?_.num:6),n(T)&&(T=_.indicatorType!=null?_.indicatorType:"dot"),n(l)&&(l=_.foregroundColor!=null?_.foregroundColor:T=="star"?t.yellow:T=="heart"?t.red:t.orange),n(a)&&(a=_.backgroundColor!=null?_.backgroundColor:t.granite),a<0&&(a=_.backgroundColor!=null?_.backgroundColor:"rgba(0,0,0,.01)"),n(s)&&(s=_.borderColor!=null?_.borderColor:null),n(f)&&(f=_.borderWidth!=null?_.borderWidth:null),s<0||f<0?s=f=null:s!=null&&f==null&&(f=1),n(c)&&(c=_.backdropColor!=null?_.backdropColor:-1),n(w)&&(w=_.corner!=null?_.corner:0),n(p)&&(p=_.fill!=null?_.fill:!1),n(x)&&(x=_.scale!=null?_.scale:1),n(P)&&(P=_.lightScale!=null?_.lightScale:1),n(m)&&(m=_.interactive!=null?_.interactive:!1),n(v)&&(v=_.shadowColor!=null?_.shadowColor:"rgba(0,0,0,.3)"),n(I)&&(I=_.shadowBlur!=null?_.shadowBlur:5),n(E)&&(E=_.backgroundAlpha!=null?_.backgroundAlpha:.2);var k=(Pt?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",$=this;this.lights=[];var O;if(c!=-1){var X=$.backdrop=new t.Rectangle(e,r,c,s,f,w,null,null,null,!1);this.addChild(X)}var R=this.lightsContainer=new t.Container({style:!1});this.addChild(R);var Q,K=r*.5,q=e/(i+1),ne=new Ne.Shape,U=!1;T=="square"||T=="box"||T.type=="Emoji"?ne.graphics.f("black").dr(-q/2/P+K/2,-r/2+K/2,q/P,r):ne.graphics.f("black").dr(-q/2/P,-r/2,q/P,r);for(var D=0;D<i;D++)T=="square"||T=="box"?(Q=new t.Rectangle(K,K,a,s,f,null,null,null,null,!1),Q.regX=Q.width/2,Q.regY=Q.height/2):T=="star"?Q=new t.Poly(K*.6,5,.5,a,s,f,null,null,!1):T=="heart"?Q=new t.Blob({points:[[0,-40.7,0,0,-57.3,-76.6,41.8,-80.3,"mirror"],[100,0,0,0,23.7,-45.4,-23.7,45.4,"mirror"],[0,100,0,0,0,0,0,0,"mirror"],[-100,0,0,0,21.9,48.2,-21.9,-48.2,"mirror"]],color:a,interactive:!1}).transformPoints("scale",.15):T.type=="Emoji"?(U=!0,Q=T.clone().reg("center","center"),Q.myCache=!1):Q=new t.Circle(K/2,a,s,f,null,null,null,null,!1),this.lights.push(Q),Q.znum=D,Q.scaleX=Q.scaleY=P,Q.hitArea=ne,Q.x=q+q*D,Q.y=r/2,R.addChild(Q);R.setBounds(0,0,e,r),R.regX=R.x=e/2,R.regY=R.y=r/2,this.addChild(R),v!=-1&&I>0&&(R.shadow=new Ne.Shadow(v,2,2,I)),m&&(R.cur("pointer"),$.lightsEvent=R.on(k,function(u){if(O==u.target.znum){if(O>0)return;if(O==0){O=-1,d(O),$.dispatchEvent("change");return}}O=u.target.znum,d(O),$.dispatchEvent("change")})),R.scaleX=R.scaleY=x;function d(u){u>=i&&(u=-1);for(var o,S=0;S<i;S++){p&&S<u?o=l:o=a,S==u&&(o=l);var F=R.getChildAt(S);U&&(F.alpha=o==l?1:E),F.color=o}$.zimAccessibility&&$.zimAccessibility.changeTitle($),!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&$.stage&&$.stage.update()}Object.defineProperty(this,"selectedIndex",{get:function(){return O},set:function(u){O=Math.floor(u),O=t.constrain(O,-1,i-1),d(O)}}),Object.defineProperty(this,"num",{get:function(){return i},set:function(){dt&&tt("Indicator() - num is read only")}}),this._enabled=!0,Object.defineProperty($,"enabled",{get:function(){return $._enabled},set:function(u){bt($,u)}}),n(g)&&(g=_.selectedIndex!=null?_.selectedIndex:0),$.selectedIndex=g,A!==!1&&t.styleTransforms(this,_),this.dispose=function(u,o,S){S||($.lightsEvent&&R.off(k,$.lightsEvent),this.zimContainer_dispose())},this.clone=function(){return $.cloneProps(new t.Indicator(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,this.group,C))}},t.extend(t.Indicator,t.Container,["clone","dispose"],"zimContainer",!1),t.TextInput=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O,X,R,Q,K,q,ne,U,D,d,u,o,S,F,h){var b="width, height, placeholder, text, size, font, color, backgroundColor, borderColor, borderWidth, maxLength, password, selectionColor, selectionAlpha, cursorColor, cursorSpeed, shadowColor, shadowBlur, align, corner, padding, paddingH, paddingV, shiftH, shiftV, scrollBarActive, scrollBarDrag, scrollBarColor, scrollBarAlpha, scrollBarFade, scrollBarH, scrollBarV, readOnly, inputType, rtl, uppercase, placeholderInstant, keyboardShift, style, group, inherit",ye;if(ye=st(t.TextInput,arguments,b,this))return ye;De("54.2"),this.group=F;var B=S===!1?{}:t.getStyle("TextInput",this.group,h);n(a)&&(a=B.size!=null?B.size:36),(n(C)||C=="ignore")&&(C=B.padding!=null&&C!="ignore"?B.padding:5),n(L)&&(L=B.paddingH!=null?B.paddingH:C),n(Y)&&(Y=B.paddingV!=null?B.paddingV:C),n(e)&&(e=B.width!=null?B.width:300),n(r)&&(r=B.height!=null?B.height:a+Y*2),n(i)&&(i=B.placeholder!=null?B.placeholder:null),n(l)&&(l=B.text!=null?B.text:""),n(s)&&(s=B.font!=null?B.font:"arial"),n(f)&&(f=B.color!=null?B.color:t.dark),n(c)&&(c=B.backgroundColor!=null?B.backgroundColor:t.lighter),n(w)&&(w=B.borderColor!=null?B.borderColor:null),n(T)&&(T=B.borderWidth!=null?B.borderWidth:null);var N=re(e,r,i,l,f,c,w);this.veeObj={width:N[0],height:N[1],placeholder:N[2],text:N[3],color:N[4],backgroundColor:N[5],borderColor:N[6]};function re(){return arguments}e=t.Pick.choose(e),r=t.Pick.choose(r),i=t.Pick.choose(i),l=t.Pick.choose(l),f=t.Pick.choose(f),c=t.Pick.choose(c),w=t.Pick.choose(w),n(P)&&(P=B.selectionColor!=null?B.selectionColor:f),n(m)&&(m=B.selectionAlpha!=null?B.selectionAlpha:.2),n(v)&&(v=B.cursorColor!=null?B.cursorColor:f),n(I)&&(I=B.cursorSpeed!=null?B.cursorSpeed:.5),n(g)&&(g=B.shadowColor!=null?B.shadowColor:"rgba(0,0,0,.3)"),n(E)&&(E=B.shadowBlur!=null?B.shadowBlur:20),n(A)&&(A=B.align!=null?B.align:"left"),n(y)&&(y=B.corner!=null?B.corner:0),n(_)&&(_=B.shiftH!=null?B.shiftH:0),n(x)&&(x=B.password!=null?B.password:!1),n(k)&&(k=B.shiftV!=null?B.shiftV:x?a*.25:0),n(p)&&(p=B.maxLength!=null?B.maxLength:A=="center"?Math.floor(e/a)*1.8:null),n($)&&($=B.scrollBarActive!=null?B.scrollBarActive:!1),n(O)&&(O=B.scrollBarDrag!=null?B.scrollBarDrag:!1),n(X)&&(X=B.scrollBarColor!=null?B.scrollBarColor:w),n(R)&&(R=B.scrollBarAlpha!=null?B.scrollBarAlpha:.3),n(Q)&&(Q=B.scrollBarFade!=null?B.scrollBarFade:!0),n(K)&&(K=B.scrollBarH!=null?B.scrollBarH:!0),n(q)&&(q=B.scrollBarV!=null?B.scrollBarV:!0),n(ne)&&(ne=B.readOnly!=null?B.readOnly:!1),n(U)&&(U=B.inputType!=null?B.inputType:"text"),O&&(Q=B.scrollBarFade!=null?B.scrollBarFade:!1),n(D)&&(D=B.rtl!=null?B.rtl:j.DIR=="rtl"||t.DIR=="rtl"?"rtl":null),n(d)&&(d=B.uppercase!=null?B.uppercase:null),n(o)&&(o=B.keyboardShift!=null?B.keyboardShift:null),d&&(l&&(l=l.toUpperCase()),i&&(i=i.toUpperCase())),n(u)&&(u=B.placeholderInstant!=null?B.placeholderInstant:!0);function le(){return j.DIR&&j.DIR=="rtl"||!j.DIR&&t.DIR=="rtl"?A=="start"?A="right":A=="end"&&(A="left"):A=="start"?A="left":A=="end"&&(A="right"),A}A=le(A),this.zimWindow_constructor(e,r,null,c,w,T,C,y,!1,$,O,X,R,Q,K,q,!1,null,null,!1,!0,g,E,L,Y,!0,null,null,null,null,null,!1,null,null,null,null,null,null,null,null,null,null,null,null,S,F,t.copy(B)),this.type="TextInput";var G=this;this.placeholderLabel=new t.Label({text:i||"",size:a,color:f,font:s,shiftH:_,shiftV:k,valign:"top"}).alp(.5),l==""&&this.add(this.placeholderLabel);var z=new t.Rectangle({width:e-C*2,height:r-C*2,color:t.clear,style:!1}).center(this);this.cur("text");var se=this.label=new t.TextInput.LabelInput(l,a,p,x,P,m,v,I,s,f,null,null,null,A,"top",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,_,k,null,null,null,null,U,D,d,u,S,F,h);this.add(se),se.setMask(z),this.htmlTag=this.label.hiddenInput,this.selection=this.label.selection,this.blinker=this.label.blinker,A=="right"?(se.x=e-L,this.placeholderLabel.x=e-this.placeholderLabel.width-L):A=="center"&&(se.x=e/2,this.placeholderLabel.x=(e-this.placeholderLabel.width)/2),se.ogx=se.x,G.placeholderLabel.x=se.x,G.placeholderLabel.align=A;var Oe=new t.Rectangle({width:C,height:r,color:t.clear,style:!1}).addTo(this).expand(0);Oe.on("mousedown",function(fe){se.onMousedown(fe),fe.stopImmediatePropagation()}),Oe.on("pressmove",function(fe){se.onPressmove(fe),fe.stopImmediatePropagation()}),Oe.on("dblclick",function(fe){se.onDblclick(fe),fe.stopImmediatePropagation()});var J=new t.Rectangle({width:C,height:r,color:t.clear,style:!1}).pos(0,0,t.RIGHT,t.TOP,this).expand(0);J.on("mousedown",function(fe){se.onMousedown(fe),fe.stopImmediatePropagation()}),J.on("pressmove",function(fe){se.onPressmove(fe),fe.stopImmediatePropagation()}),J.on("dblclick",function(fe){se.onDblclick(fe),fe.stopImmediatePropagation()});var pe=se.text;this.on("mousedown",function(fe){se.onMousedown(fe),pe=se.text}),this.on("pressmove",function(fe){se.onPressmove(fe),fe.stopImmediatePropagation()}),this.on("dblclick",function(fe){se.onDblclick(fe),fe.stopImmediatePropagation()}),this.added(function(fe){fe.on("stagemousedown",function(ke){G.hitTestPoint(ke.stageX,ke.stageY)||(se.focus=!1,se.text!=pe&&G.dispatchEvent("change"),pe=se.text)})});var Z=G.stage?stage.y:0;this.label.on("focus",function(){if(j.M&&o){G.re&&G.stage.frame.off("resize",G.re),G.re=G.stage.frame.on("resize",function(){G.stage&&fe>G.stage.height/4&&(G.stage.y=G.stage.scaleY*(G.stage.height/4-fe),G.stage.update())});var fe=G.label.localToGlobal(0,0).y;G.stage&&fe>G.stage.height/4&&(G.stage.y=G.stage.scaleY*(G.stage.height/4-fe),G.stage.update())}u&&G.placeholderLabel.parent&&(G.placeholderLabel.removeFrom(),G.stage&&G.stage.update()),G.dispatchEvent("focus")}),this.label.on("blur",function(){j.M&&o&&G.stage&&(G.re&&G.stage.frame.off("resize",G.re),G.stage.y=Z,G.stage.update()),u&&se.text==""&&!G.placeholderLabel.parent&&(G.add(G.placeholderLabel),G.stage&&G.stage.update()),G.dispatchEvent("blur")});function de(){se.text!=""&&G.placeholderLabel.parent&&(G.placeholderLabel.removeFrom(),G.stage&&G.stage.update()),se.text==""&&!G.placeholderLabel.parent&&(G.add(G.placeholderLabel),G.stage&&G.stage.update())}this.label.on("input",function(){de(),G.dispatchEvent("input")}),this.label.on("keydown",function(fe){this.label.deleteKey=fe.detail==46,G.dispatchEvent("keydown")}),this.label.on("blinker",function(){var fe=G.localToGlobal(0,0).x,ke=fe+e-L-se.blinker.width,oe=se.blinker,Ce=oe.localToGlobal(0,0).x,Me=se.localToGlobal(0,0).x-1,te=se.x+se.blinker.x,ae=t.constrain(te,L,e-L-se.blinker.width);if(te!=ae&&(se.x-=te-ae),A=="left")se.width<G.width?se.x=se.ogx:ke<Ce||se.oldWidth==se.width?se.x-=te-ae:se.oldWidth>se.width&&this.label.deleteKey!=!0&&(se.x+=Math.abs(oe.oldX-Ce)+se.blinker.width+L);else if(A=="right")se.width<G.width?se.x=se.ogx:ke<Ce||se.oldWidth==se.width?se.x-=te-ae:se.oldWidth>se.width&&this.label.deleteKey==!0&&Ce<Me-G.width&&(se.x-=Math.abs(oe.oldX-Ce)+se.blinker.width+L);else if(A=="center"){if(se.width<G.width)se.x=se.ogx;else if(ke<Ce)se.x-=te-ae;else if(se.oldWidth==se.width)se.x-=te-ae;else if(se.oldWidth>se.width&&ke>Ce){var we=fe+G.width*.5;this.label.deleteKey!=!0?se.x+=se.blinker.width+L:se.x-=se.blinker.width+L}}se.oldWidth=se.width,oe.oldX=Ce,G.stage&&G.stage.update()}),Object.defineProperty(G,"text",{get:function(){return se.hiddenInput.value},set:function(fe){pe=fe,se.setText(fe),de(),!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&G.stage&&G.stage.update()}}),j.KEYFOCUS!=null&&(t.KEYFOCUS=j.KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return t.KEYFOCUS==G},set:function(){t.KEYFOCUS=G}}),t.KEYFOCUS||V(),this.on("mousedown",function(){V()});function V(){G.keyFocus=!0}Object.defineProperty(G,"readOnly",{get:function(){return ne},set:function(fe){ne=fe,G.htmlTag.setAttribute("readonly",ne)}}),ne&&(G.readOnly=!0),Object.defineProperty(G,"focus",{get:function(){return se.focus},set:function(fe){se.focus=fe}}),Object.defineProperty(G,"color",{get:function(){return se.color},set:function(fe){se.color=latestColor=fe,!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&G.stage&&G.stage.update()}}),Object.defineProperty(G,"size",{get:function(){return se.size},set:function(fe){se.size=fe,se.hiddenInput.style.fontSize=fe+"px",!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&G.stage&&G.stage.update()}}),Object.defineProperty(G,"align",{get:function(){return se.align},set:function(fe){se.align=A=le(fe),A=="right"?se.x=e-se.width:A=="center"?se.x=e/2:se.x=0,G.placeholderLabel.x=se.x,G.placeholderLabel.align=A,!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&G.stage&&G.stage.update()}}),Object.defineProperty(G,"font",{get:function(){return se.font},set:function(fe){se.font=fe,!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&G.stage&&G.stage.update()}}),Object.defineProperty(G,"selectionAlpha",{get:function(){return se.selectionAlpha},set:function(fe){se.selectionAlpha=fe,se.selection.alpha!=0&&(se.selection.alpha=fe),!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&G.stage&&G.stage.update()}}),S!==!1&&t.styleTransforms(this,B),this.clone=function(fe){return G.cloneProps(new t.TextInput(fe||!t.isPick(N[0])?e:N[0],fe||!t.isPick(N[1])?r:N[1],fe||!t.isPick(N[2])?i:N[2],fe||!t.isPick(N[3])?l:N[3],a,s,fe||!t.isPick(N[4])?f:N[4],fe||!t.isPick(N[5])?c:N[5],fe||!t.isPick(N[6])?w:N[6],T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O,X,R,Q,K,q,ne,U,D,d,u,o,S,this.group,h))}},t.extend(t.TextInput,t.Window,"clone","zimWindow",!1),t.TextInput.LabelInput=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O,X,R,Q,K,q,ne,U,D,d,u,o,S,F,h,b,ye){this.zimLabel_constructor(e,r,w,T,null,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O,X,R,Q,K,q,ne,null,D,d,null,u,h,b,ye),this.type="LabelInput",n(T)&&(T=t.dark),n(a)&&(a=T),n(s)&&(s=.2),this.selectionAlpha=s,n(f)&&(f=T),n(c)&&(c=.5),this.hiddenInput=document.createElement("INPUT"),this.hiddenInput.setAttribute("id",t.makeID()),this.hiddenInput.value=e,o=="text"&&l&&(o="password"),this.hiddenInput.type=o,o=="number"&&(this.hiddenInput.pattern="[^(0-9).-+*/%$]*",this.hiddenInput.inputmode="numeric"),i>0&&(this.hiddenInput.maxLength=i),this.hiddenInput.autocapitalize="off",this.hiddenInput.autocorrect="off",this.hiddenInput.autocomplete="off",this.hiddenInput.spellcheck=!1,this.hiddenInput.style.position="absolute",this.hiddenInput.style.overflow="hidden",this.hiddenInput.style.touchAction="none",this.hiddenInput.style.left="-99999px",this.hiddenInput.style.top="-99999px",this.hiddenInput.style.zIndex=-999,this.hiddenInput.style.opacity=0,this.hiddenInput.style.width="1px",this.hiddenInput.style.height="1px",this.hiddenInput.style.fontSize="1px",this.onFocus=function(){this.stage&&(N=this.stage.frame),N.zil&&j.removeEventListener("keydown",N.zil[0]),this.blinker.alp(1).replayTween(),this.selection.alp(.2),this.positionBlinkerAndSelection(),this.dispatchEvent("focus")},this.onBlur=function(){this.stage&&(N=this.stage.frame),N.zil&&j.addEventListener("keydown",N.zil[0]),this.positionBlinkerAndSelection(),this.blinker.pauseAnimate(!0).alp(0),this.selection.alp(0),this.hiddenInput.type=o,this.dispatchEvent("blur")},this.onInput=function(){F&&(this.hiddenInput.value=this.hiddenInput.value.toUpperCase());var re=this.hiddenInput.value;o=="number"&&(re=re.replace(/[^(0-9).\-+*/%$]*/g,""),this.hiddenInput.value=re),this.text=this.hiddenInput.type=="password"?re.replace(/./g,"*"):re,this.measureText(),this.dispatchEvent("input")},this.onSelect=function(){this.positionBlinkerAndSelection(),this.focus&&this.blinker.replayTween()};var B=this;this.onKeydown=function(re){this.deleteKey=re.code=="Backspace"||re.code=="Delete",this.blinker.replayTween(),setTimeout(function(){let le=new CustomEvent("keydown",{detail:re.keyCode});B.positionBlinkerAndSelection.call(B),B.dispatchEvent(le)},10)},this.onMousedown=function(re){var le=this.text.length,G=this.eventPositionGlobalToLocal(re);this.focus||(this.hiddenInput.focus(),(o=="number"||o=="email")&&(this.hiddenInput.type="text"));var z=this.mapPointToIndex(G);S?this.hiddenInput.setSelectionRange(le-z,le-z):this.hiddenInput.setSelectionRange(z,z),this.positionBlinkerAndSelection()},this.onPressmove=function(re){var le=this.text.length;this.focus||this.hiddenInput.focus();var G=this.eventPositionGlobalToLocal(re),z;S?z=le-this.mapPointToIndex(G):z=this.mapPointToIndex(G),this.hiddenInput.selectionStart===this.hiddenInput.selectionEnd?this.hiddenInput.selectionStart<=z?this.hiddenInput.setSelectionRange(this.hiddenInput.selectionStart,z,S?"backward":"forward"):this.hiddenInput.setSelectionRange(z,this.hiddenInput.selectionEnd,S?"forward":"backward"):this.hiddenInput.selectionDirection===(S?"backward":"forward")?this.hiddenInput.setSelectionRange(this.hiddenInput.selectionStart,z,S?"backward":"forward"):this.hiddenInput.setSelectionRange(z,this.hiddenInput.selectionEnd,S?"forward":"backward"),this.positionBlinkerAndSelection()},this.onDblclick=function(){this.hiddenInput.select(),this.positionBlinkerAndSelection()},this.positionBlinkerAndSelection=function(){var re=this.text.length;if(this.focus){var le=this.backing||this.background?this.paddingH:0,G=this.backing||this.background?this.paddingV:0;if(this.hiddenInput.selectionStart!==this.hiddenInput.selectionEnd){var z,se;S?(z=this.textWidthArray[re-this.hiddenInput.selectionStart],se=this.textWidthArray[re-this.hiddenInput.selectionEnd],this.selection.widthOnly=se-z,this.selection.pos(se+le-1+q,G+ne)):(z=this.textWidthArray[this.hiddenInput.selectionStart],se=this.textWidthArray[this.hiddenInput.selectionEnd],this.selection.widthOnly=se-z,this.selection.pos(z+le-1+q,G+ne)),this.selection.heightOnly=this.textHeight,this.selection.alp(this.selectionAlpha)}else this.selection.alp(0);this.blinker.heightOnly=this.textHeight;var Oe=this.hiddenInput.selectionDirection==="backward"?this.hiddenInput.selectionStart:this.hiddenInput.selectionEnd;Oe||(Oe=0),S&&(Oe=re-Oe),this.blinker.pos(this.textWidthArray[Oe]+le-1+(m=="right"&&this.text==""?this.width:m=="center"&&this.text==""?this.width/2:0)+q,G+ne),this.dispatchEvent("blinker")}this.stage&&this.stage.update()},this.eventPositionGlobalToLocal=function(re){var le=this.globalToLocal(re.stageX/t.scaX,re.stageY/t.scaY);return m=="right"?le.x-=this.label.x-this.width:m=="center"?le.x-=(this.label.x-this.width)/2:le.x-=this.label.x,le.y-=this.label.y,le},this.mapPointToIndex=function(re){for(var le=this.textWidthArray.length-1,G=0;G<this.textWidthArray.length-1;G++){var z=(this.textWidthArray[G]+this.textWidthArray[G+1])/2;if(re.x<=z){le=G;break}}return le},this.measureText=function(){var re=this.label.clone(),le=this.text;S&&(le=le.split("").reverse().join(""));for(var G=0;G<le.length&&G<this.previousMeasuredText.length&&le[G]===this.previousMeasuredText[G];)G++;for(this.textWidthArray=this.textWidthArray.slice(0,G+1),G++;G<=le.length;G++)re.text=le.slice(0,G),this.textWidthArray.push(re.getMeasuredWidth());this.previousMeasuredText=le,this.textHeight=re.getMeasuredLineHeight()},this.setText=function(re){F&&(re=re.toUpperCase()),this.hiddenInput.value=re,this.onInput()},Object.defineProperty(this,"focus",{get:function(){return document.activeElement===B.hiddenInput},set:function(re){re===!0?B.hiddenInput.focus():B.hiddenInput.blur()}});var N;this.added(function(re){N=re.frame,B.hiddenInput.addEventListener("focus",B.onFocus.bind(B)),B.hiddenInput.addEventListener("blur",B.onBlur.bind(B))}),this.hiddenInput.addEventListener("input",this.onInput.bind(this)),this.hiddenInput.addEventListener("select",this.onSelect.bind(this)),this.hiddenInput.addEventListener("keydown",this.onKeydown.bind(this)),document.body.appendChild(this.hiddenInput),this.on("mousedown",this.onMousedown.bind(this)),this.on("pressmove",this.onPressmove.bind(this)),this.on("dblclick",this.onDblclick.bind(this)),this.cur("text"),this.blinker=new t.Rectangle({width:2,height:1,color:f,style:!1}).animate({obj:{alpha:0},wait:c,time:.1,rewind:!0,rewindWait:c,loop:!0,loopWait:c}).pauseAnimate(!0).alp(0).addTo(this),this.selection=new t.Rectangle({width:1,height:1,color:a,style:!1}).alp(0).addTo(this),this.textWidthArray=[0],this.previousMeasuredText="",this.textHeight=null,this.measureText()},t.extend(t.TextInput.LabelInput,t.Label,null,"zimLabel",!1),t.List=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O,X,R,Q,K,q,ne,U,D,d,u,o,S,F,h,b,ye,B,N,re,le,G,z,se,Oe,J,pe,Z,de,V,fe,ke,oe,Ce,Me,te,ae,we,ue,Pe,ie,be,Le,me,ee,Ie,Re,_e,Ze,at,Be,He,et){var ge="width, height, list, viewNum, vertical, currentSelected, align, valign, labelAlign, labelValign, labelIndent, labelIndentH, labelIndentV, indent, spacing, backgroundColor, rollBackgroundColor, downBackgroundColor, selectedBackgroundColor, selectedRollBackgroundColor, backdropColor, color, rollColor, downColor, selectedColor, selectedRollColor, borderColor, borderWidth, padding, corner, swipe, scrollBarActive, scrollBarDrag, scrollBarColor, scrollBarAlpha, scrollBarFade, scrollBarH, scrollBarV, scrollBarOverlay, slide, slideFactor, slideSnap, slideSnapDamp, shadowColor, shadowBlur, paddingH, paddingV, scrollWheel, damp, titleBar, titleBarColor, titleBarBackgroundColor, titleBarHeight, draggable, boundary, onTop, close, closeColor, collapse, collapseColor, collapsed, excludeCustomTap, organizer, checkBox, pulldown, clone, cancelCurrentDrag, selectedIndex, noScale, pulldownToggle, optimize, keyEnabled, resizeHandle, resizeBoundary, resizeVisible, continuous, style, group, inherit",xe;if(xe=st(t.List,arguments,ge,this))return xe;De("60.5"),this.group=He;var he=Be===!1?{}:t.getStyle("List",this.group,et);n(e)&&(e=he.width!=null?he.width:300);var Ge=r;n(r)&&(r=he.height!=null?he.height:n(ae)?200:200+ae.height),n(i)&&(i=i=he.list!=null?he.list:["Option 1","Option 2","Option 3","Option 4","Option 5","Option 6","Option 7","Option 8","Option 9","Option 10"]),i.length==0&&(i=["%-&"]),this.originalList=i,n(l)&&(l=he.viewNum!=null?he.viewNum:5),n(a)&&(a=he.vertical!=null?he.vertical:!0),n(s)&&(s=he.currentSelected!=null?he.currentSelected:!0);var qe=!n(f)||!n(w);n(we)&&(we=he.checkBox!=null?he.checkBox:!1),n(f)&&(f=he.align!=null?he.align:we?"left":"center"),n(c)&&(c=he.valign!=null?he.valign:"center"),n(w)&&(w=he.labelAlign!=null?he.labelAlign:f),n(T)&&(T=he.labelValign!=null?he.labelValign:c),n(m)&&(m=he.indent!=null?he.indent:we?0:10),n(p)&&(p=he.labelIndent!=null?he.labelIndent:m),n(x)&&(x=he.labelIndentH!=null?he.labelIndentH:p),n(P)&&(P=he.labelIndentV!=null?he.labelIndentV:p),n(v)&&(v=he.spacing!=null?he.spacing:2),n(C)&&(C=he.backdropColor!=null?he.backdropColor:t.dark),n(I)&&(I=he.backgroundColor!=null?he.backgroundColor:t.tin),n(g)&&(g=he.rollBackgroundColor!=null?he.rollBackgroundColor:t.grey),n(E)&&(E=he.downBackgroundColor!=null?he.downBackgroundColor:g),n(A)&&(A=he.selectedBackgroundColor!=null?he.selectedBackgroundColor:t.charcoal),n(y)&&(y=he.selectedRollBackgroundColor!=null?he.selectedRollBackgroundColor:t.grey),n(L)&&(L=he.color!=null?he.color:t.white),n(Y)&&(Y=he.rollColor!=null?he.rollColor:L),n(_)&&(_=he.downColor!=null?he.downColor:Y),n(k)&&(k=he.selectedColor!=null?he.selectedColor:L),n($)&&($=he.selectedRollColor!=null?he.selectedRollColor:Y),n(C)&&(C=he.backdropColor!=null?he.backdropColor:C);var Fe=O,We=X;n(O)&&(O=he.borderColor!=null?he.borderColor:t.silver),n(X)&&(X=he.borderWidth!=null?he.borderWidth:1),n(R)&&(R=he.padding!=null?he.padding:v),n(Q)&&(Q=he.corner!=null?he.corner:0),n(K)&&(K=he.swipe!=null?he.swipe:!0),n(q)&&(q=he.scrollBarActive!=null?he.scrollBarActive:!0),n(ne)&&(ne=he.scrollBarDrag!=null?he.scrollBarDrag:!0),n(U)&&(U=he.scrollBarColor!=null?he.scrollBarColor:O),n(D)&&(D=he.scrollBarAlpha!=null?he.scrollBarAlpha:.3),n(d)&&(d=he.scrollBarFade!=null?he.scrollBarFade:!0),n(u)&&(u=he.scrollBarH!=null?he.scrollBarH:!a),n(o)&&(o=he.scrollBarV!=null?he.scrollBarV:a),ne&&(d=he.scrollBarFade!=null?he.scrollBarFade:!1),n(S)&&(S=he.scrollBarOverlay!=null?he.scrollBarOverlay:!0),n(F)&&(F=he.slide!=null?he.slide:!0),n(h)&&(h=he.slideFactor!=null?he.slideFactor:.95),n(b)&&(b=he.slideSnap!=null?he.slideSnap:a?"vertical":"horizontal"),n(B)&&(B=he.shadowColor!=null?he.shadowColor:"rgba(0,0,0,.3)"),n(N)&&(N=he.shadowBlur!=null?he.shadowBlur:20),n(le)&&(le=he.paddingV!=null?he.paddingV:R),n(re)&&(re=he.paddingH!=null?he.paddingH:R),n(G)&&(G=he.scrollWheel!=null?he.scrollWheel:!0),n(se)&&(se=he.titleBar!=null?he.titleBar:null),n(Oe)&&(Oe=he.titleBarColor!=null?he.titleBarColor:null),n(J)&&(J=he.titleBarBackgroundColor!=null?he.titleBarBackgroundColor:null),n(pe)&&(pe=he.titleBarHeight!=null?he.titleBarHeight:35),n(Z)&&(Z=he.draggable!=null?he.draggable:null),n(de)&&(de=he.boundary!=null?he.boundary:null),n(V)&&(V=he.onTop!=null?he.onTop:null),n(fe)&&(fe=he.close!=null?he.close:null),n(ke)&&(ke=he.closeColor!=null?he.closeColor:null),n(oe)&&(oe=he.collapse!=null?he.collapse:null),n(Ce)&&(Ce=he.collapseColor!=null?he.collapseColor:null),n(te)&&(te=he.excludeCustomTap!=null?he.excludeCustomTap:!1),n(we)&&(we=he.checkBox!=null?he.checkBox:!1),n(ue)&&(ue=he.pulldown!=null?he.pulldown:!1),n(me)&&(me=he.pulldownToggle!=null?he.pulldownToggle:!1),n(Le)&&(Le=he.noScale!=null?he.noScale:!1),n(Pe)&&(Pe=he.clone!=null?he.clone:!1),n(ee)&&(ee=he.optimize!=null?he.optimize:!0),n(Ie)&&(Ie=he.keyEnabled!=null?he.keyEnabled:null),n(Re)&&(Re=he.resizeHandle!=null?he.resizeHandle:null),n(_e)&&(_e=he.resizeBoundary!=null?he.resizeBoundary:null),n(Ze)&&(Ze=he.resizeVisible!=null?he.resizeVisible:!1),n(at)&&(at=he.continuous!=null?he.continuous:!1),se===!1&&(se=null),this.vertical=a;var ce=this,Ve=r;j.DIR&&j.DIR=="rtl"||!j.DIR&&t.DIR=="rtl"?f=="start"?f="right":f=="end"&&(f="left"):f=="start"?f="left":f=="end"&&(f="right");var Se;at?(ce.continuous=!0,Se=t.copy(i),t.loop(i.length,function(Je){i[Je].clone?Se.push(i[Je].clone()):Se.push(i[Je])})):Se=i,we&&t.loop(Se,function(Je,gt){Se[gt]!="%-&"&&(Se[gt]=t.List.checkItem(Je,null,e,"left",10,10,v,L,Y,k,$,I,g,A,y))});var Ae=wt(),Ye;if(Se.constructor=={}.constructor){var Xe=n(Se.shade)?n(he.shade)?.2:he.shade:Se.shade,Ue=n(Se.dim)?n(he.dim)?.1:he.dim:Se.dim,rt=n(Se.shift)?n(he.shift)?15:he.shift:Se.shift,Te=n(Se.bloom)?n(he.bloom)?!1:he.bloom:Se.bloom,$e=n(Se.whither)?n(he.whither)?!1:he.whither:Se.whither,lt=n(Se.open)?n(he.open)?!1:he.open:Se.open,Qe=n(Se.expander)?n(he.expander)?"plus":he.expander:Se.expander;Qe=Qe.toLowerCase(),Qe=="arrows"&&(Qe="arrow"),Qe!="none"&&Qe!="arrow"&&(Qe="plus"),Te===!0&&(Te=Ae=="s"?.01:10),$e===!0&&($e=Ae=="s"?.01:10),It(Te),It($e),rt===!0&&(rt=15),Xe===!0&&(Xe=.2),Ue===!0&&(Ue=.1);var ot=n(Se.subStyles)?n(he.subStyles)?{}:he.subStyles:Se.subStyles;n(Se.menu)||(Se=Se.menu),Ye=ce.tree=new t.Hierarchy(Se),Se=Ye.getLinearList(),qe||(f=w="left")}ue&&(l=n(Ye)?Se.length:Ye.length,n(Ge)&&(r=l*e/620*100+(l+1)*v+(n(se)?0:pe)),X=0,A=I,C=t.clear,K=!1);var ft=0,ut=0;t.loop(Se,function(Je){Je.type=="ListItem"&&(Je.width=e-v*2),Le&&(Je.width&&(ft+=Je.width),Je.height&&(ut+=Je.height))}),ft&&(ft+=v*(Se.length-1)),ut&&(ut+=v*(Se.length-1)),this.align=f,this.valign=c,this.indent=m,n(ae)||(r=r-ae.height,ae.list=ce,ce.organizer=ae,ae.setButtons(),pe+=ae.height),at&&(q=!1),this.zimWindow_constructor(e,r,null,C,O,X,R,Q,K,q,ne,U,D,d,u,o,F,h,b,ye,!0,B,N,re,le,G,z,se,Oe,J,pe,Z,de,V,fe,ke,ie,!1,null,Re,oe,Ce,Me,ee,_e,Ze,at?a?"vertical":"horizontal":null,Be,He,t.copy(he)),this.type="List",n(se)||(this.titleBarLabel.pos(null,pe-30,null,!0),n(pe)&&(pe=30),r=r-pe),n(ae)||ae.addTo(ce).loc(0,-ae.height),ft&&Le?(ce.itemWidth=a?e-(q?S?0:6:0):ft/Se.length,ce.itemHeight=a?ut/Se.length:r-(q?S?0:6:0)):(ce.itemWidth=a?e-(q?S?0:6:0):e/l,ce.itemHeight=a?r/l:r-(q?S?0:6:0));var ze,kt=t.copy(he);delete kt.borderWidth,delete kt.borderColor;function Mt(Je){ze=ce.tabs=new t.Tabs({width:a?ce.itemWidth:ce.itemWidth*Se.length,height:a?ce.itemHeight*Se.length:ce.itemHeight,tabs:Je,spacing:v,vertical:a,backgroundColor:I,rollBackgroundColor:g,downBackgroundColor:E,selectedBackgroundColor:A,selectedRollBackgroundColor:y,color:L,rollColor:Y,downColor:_,selectedColor:k,selectedRollColor:$,backdropColor:C,currentEnabled:!0,currentSelected:s,align:f,valign:c,labelAlign:w,labelValign:T,labelIndent:p,labelIndentH:x,labelIndentV:P,indent:m,useTap:!0,excludeCustomTap:te,keyWrap:!1,keyEnabled:Ie,style:Be,group:He,inherit:kt}).siz(a?e-re*2:null,a?null:r-le*2).mov(a?0:re,a?le:0),ce.add(ze),t.loop(ze.labels,function(gt){gt&&(gt.backgroundColor=t.clear)})}Mt(t.copy(Se,Pe)),at&&ce.on("scrolling",function(){var Je=ce.tabs.localToLocal(0,0,ce);a&&(Je.y>=-ce.tabs.buttons[0].height&&(ce.tabs.y-=ce.tabs.height/2+v/2),Je.y-ce.tabs.buttons[ce.tabs.buttons.length-1].height<=r-ce.tabs.height&&(ce.tabs.y+=ce.tabs.height/2+v/2))});function xt(Je,gt,Ot){Je.listZID=gt,Je.label&&(Xe&&new t.Rectangle(rt*(Ot.level+1),Je.height).alp(Xe).pos(0,0,ce.align=="right",!1,Je),Ue&&new t.Rectangle(Je.width,Je.height).alp((Ot.level+1)*Ue).addTo(Je).bot().ord(1),rt&&ce.align!="center"&&(Je.label.x+=(ce.align=="right"?-1:1)*rt*(Ot.level+1)));var mt=Ye.getData(gt);mt.obj=Je,mt.list&&!t.isEmpty(mt.list)&&(Je.expander=new t.Label({size:Qe=="arrow"?22:36,text:mt.open?Qe=="arrow"?"\u25B2":"-":Qe=="arrow"?"\u25BC":"+",align:"center",color:t.convertColor(L,"rgba",.6)}).center(Je).alp(Qe=="none"?0:.7).pos(15,null,ce.align!="right").mov(0,mt.open?-3:0))}function Yt(){if(!(!ce.selected||!ce.selected.expander)){var Je=Ye.getData(ce.selected.listZID),gt;if(Je.open){ce.selected.expander&&(ce.selected.expander.text=Qe=="arrow"?"\u25BC":"+",ce.selected.expander.mov(0,3)),Je.open=!1;var Ot=Ye.getNextSibling(ce.selected.listZID),mt;n(Ot)?mt=ce.items.length-1:mt=t.loop(ce.items,function(Jt,tn){if(Jt.listZID==Ot)return tn-1}),$e?(gt=0,ce.enabled=!1,t.interval($e,function(Jt){ce.removeAt(1,ce.selectedIndex+mt-ce.selectedIndex-gt),gt++,Jt.total==Jt.count+1&&(ce.enabled=!0,ce.dispatchEvent("collapsed"))},mt-ce.selectedIndex,!0)):(ce.removeAt(mt-ce.selectedIndex,ce.selectedIndex+1),ce.dispatchEvent("collapsed"))}else{Je.open=!0,ce.selected.expander&&(ce.selected.expander.text=Qe=="arrow"?"\u25B2":"-",ce.selected.expander.mov(0,-3));var _t=Ye.getLinearList(Je.list),vt=Ye.getLinearIDs(Je.list),Lt;if(Je.opened)Array.isArray(_t)&&(Te?(gt=0,ce.enabled=!1,t.interval(Te,function(Jt){ce.addAt(_t[gt],ce.selectedIndex+1+gt),Lt=new Ne.Event("bloom"),Lt.item=_t[gt],ce.dispatchEvent(Lt),Jt.total==Jt.count+1&&(ce.enabled=!0,Lt=new Ne.Event("expanded"),Lt.items=_t,ce.dispatchEvent(Lt)),gt++},_t.length,!0)):(ce.addAt(_t,ce.selectedIndex+1),Lt=new Ne.Event("expanded"),Lt.items=_t,ce.dispatchEvent(Lt)));else{Je.opened=!0;var Vt=ot[Je.level];n(Vt)&&(Vt={}),Array.isArray(_t)&&(Te?(gt=0,ce.enabled=!1,t.interval(Te,function(Jt){ce.addAt(_t[gt],ce.selectedIndex+1+gt,{backgroundColor:Vt.backgroundColor,color:Vt.color,rollBackgroundColor:Vt.rollBackgroundColor,rollColor:Vt.rollColor,selectedBackgroundColor:Vt.selectedBackgroundColor,selectedColor:Vt.selectedColor,selectedRollBackgroundColor:Vt.selectedRollBackgroundColor,selectedRollColor:Vt.selectedRollColor});var tn=vt[gt],Zt=ce.items[ce.selectedIndex+1+gt];Vt.borderColor&&(Zt.borderColor=Vt.borderColor),xt(Zt,tn,Je),Zt.label&&(Zt.label.backgroundColor=t.clear),Lt=new Ne.Event("bloom"),Lt.item=Zt,ce.dispatchEvent(Lt),Jt.total==Jt.count+1&&(ce.enabled=!0,Lt=new Ne.Event("expanded"),Lt.items=_t,ce.dispatchEvent(Lt)),gt++,ce.stage&&ce.stage.update()},_t.length,!0)):(ce.addAt(_t,ce.selectedIndex+1,{backgroundColor:Vt.backgroundColor,color:Vt.color,rollBackgroundColor:Vt.rollBackgroundColor,rollColor:Vt.rollColor,selectedBackgroundColor:Vt.selectedBackgroundColor,selectedColor:Vt.selectedColor,selectedRollBackgroundColor:Vt.selectedRollBackgroundColor,selectedRollColor:Vt.selectedRollColor}),t.loop(vt,function(Jt,tn){var Zt=ce.items[ce.selectedIndex+1+tn];xt(Zt,Jt,Je),Zt.label&&(Zt.label.backgroundColor=t.clear)}),Lt=new Ne.Event("expanded"),Lt.items=_t,ce.dispatchEvent(Lt)))}}}}ce.expandList=function(Je){return ce.selectedIndex=Je,ce.selected&&Yt(),ce.selected};var Dt;if(Ye){me&&ce.added(function(Je){Dt=Je,ce.stageToggleEvent=Dt.on("stagemousedown",function(){var gt=Dt.getObjectUnderPoint(Dt.frame.mouseX,Dt.frame.mouseY);if(!(gt&&ce.contains(gt))&&!(!ce.enabled||!ce.selected)){var Ot=Ye.getData(ce.selected.listZID);Ot.open&&Yt()}})});var Ht=Ye.getLinearIDs();t.loop(Ht,function(Je,gt){ce.tabs.buttons[gt].listZID=Je}),t.loop(ce.tabs.buttons,function(Je){var gt=Ye.getData(Je.listZID);t.isEmpty(gt.list)||(Je.expander=new t.Label({size:Qe=="arrow"?22:36,text:Qe=="arrow"?"\u25BC":"+",align:"center",color:t.convertColor(L,"rgba",.6)}).center(Je).alp(Qe=="none"?0:.7).pos(15,null,ce.align!="right"))});var nn=lt;ce.toggle=function(Je){if(n(Je))Je=!nn;else if(Je==nn)return;ce.selectedIndex=0,nn=Je,Yt()},Object.defineProperty(ce,"toggled",{get:function(){return nn},set:function(Je){nn!=Je&&ce.toggle()}}),ce.tap(Yt)}var jt;ze.tap(function(Je){Je.target.selectedIndex!=ce.selectedIndex&&(ce.selectedIndex=ze.selectedIndex,ce.dispatchEvent("change"),me&&(ce.selectedIndex=0),Je.preventDefault())}),ze.on("keychange",function(Je){if(Je.target.selectedIndex!=ce.selectedIndex){ce.selectedIndex=ze.selectedIndex;var gt;setTimeout(function(){a?(gt=ce.selected.y+ce.scrollY,(gt<0||gt>ce.height-ce.selected.height)&&ce.animateTo(ce.selectedIndex,Ae=="ms"?100:.1)):(gt=ce.selected.x+ce.scrollX,(gt<0||gt>ce.width-ce.selected.width)&&ce.animateTo(ce.selectedIndex,Ae=="ms"?100:.1))},100),ce.dispatchEvent("change")}}),this.getItemIndex=function(Je){return ce.items.indexOf(Je)},this.animateTo=function(Je,gt){n(Je)&&(Je=0),n(gt)&&(gt=.05);var Ot=wt(gt);ce.selectedIndex=Je;var mt=Et(Je),_t;return a?(_t=Math.abs(ce.scrollY-mt)/ce.itemHeight,ce.animate({scrollY:mt},_t*gt/(Ot=="s"?1:1e3))):(_t=Math.abs(ce.scrollX-mt)/ce.itemWidth,ce.animate({scrollX:mt},_t*gt/(Ot=="s"?1:1e3))),ce},this.addAt=function(Je,gt,Ot,mt){if(n(Je))return ce;if(ce.tabs.loop(function(vt){vt.visible=!0}),Je.type=="ListItem"?Je.width=e-v*2:Array.isArray(Je)&&t.loop(Je,function(vt){vt.type=="ListItem"&&(vt.width=e-v*2)}),mt)if(Array.isArray(Je)){var _t=[];t.loop(Je,function(vt){vt.clone?_t.push(Je.clone()):_t.push(t.copy(Je,mt))}),ce.tabs.addAt(_t,gt,Ot)}else Je.clone?ce.tabs.addAt(Je.clone(),gt,Ot):ce.tabs.addAt(t.copy(Je,mt),gt,Ot);else we&&(Array.isArray(Je)||(Je=[Je]),t.loop(Je,function(vt,Lt){typeof vt=="string"&&(Je[Lt]=t.List.checkItem(vt,null,e,"left",10,10,v,L,Y,k,$,I,g,A,y))})),ce.tabs.addAt(Je,gt,Ot);return ce.update(),ce},this.removeAt=function(Je,gt){at&&ce.tabs.removeAt(Je,gt+i.length),ce.tabs.removeAt(Je,gt),ce.tabs.loop(function(mt){mt.visible=!0}),jt=ce.tabs.selectedIndex;var Ot=ze.getBounds();return ze.setBounds(0,0,Ot.width,Ot.height),Ot.height<r&&(ce.scrollY=0),ce.update(),ce},Se[0]=="%-&"&&Se.length==1&&ce.removeAt(1,0),this.clear=function(){return ce.tabs.removeAt(ce.length,0),ce.contentContainer.x=0,ce.contentContainer.y=0,ce.update(),ce},this.setCheck=function(Je,gt){n(Je)&&(Je=0),n(gt)&&(gt=!0),ce.items[Je].checkBox.checked=gt,ce.items[Je].content.zimOut()},this.getCheck=function(Je){return n(Je)&&(Je=0),ce.items[Je].checkBox.checked},this.setChecks=function(Je){return t.loop(ce.items,function(gt){gt.checkBox.checked=Je,gt.content.zimOut()}),ce},Object.defineProperty(ce,"items",{get:function(){return ce.tabs.buttons},set:function(){dt&&tt("List() - items is read only - use addAt() and removeAt() to change")}}),Object.defineProperty(ce,"list",{get:function(){return ce.tabs.buttons},set:function(){dt&&tt("List() - list is read only - use addAt() and removeAt() to change")}}),Object.defineProperty(ce,"length",{get:function(){return ce.tabs.buttons.length},set:function(){dt&&tt("List() - length is read only")}}),Object.defineProperty(ce,"selectedIndex",{get:function(){return at?(jt+i.length)%i.length:jt},set:function(Je){ze.selectedIndex=Je,ce.label=ze.label,ce.selected=ze.selected,jt=Je,!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&ce.stage&&ce.stage.update()}}),s&&(ce.selectedIndex=0),Object.defineProperty(ce,"selectedIndexPlusPosition",{get:function(){return at?(jt+i.length)%i.length:jt},set:function(Je){ce.selectedIndex=Je,jt=Je,a?ce.scrollY=Et(Je)-2:ce.scrollX=Et(Je),!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&ce.stage&&ce.stage.update()}});function Et(Je){if(a){var gt=-(ce.itemHeight+v)*Je+r/2-ce.itemHeight/2;return(ce.itemHeight+v)*ce.length<r&&(gt=0),gt>0&&(gt=0),(ce.itemHeight+v)*ce.length>r&&gt<-ce.tabs.height+r-le*2&&(gt=-ce.tabs.height+r-le*2),gt}else{var Ot=-(ce.itemWidth+v)*Je+e/2-ce.itemWidth/2;return(ce.itemWidth+v)*ce.length<e&&(Ot=0),Ot>0&&(Ot=0),(ce.itemWidth+v)*ce.length>e&&Ot<-ce.tabs.width+e-re*2&&(Ot=-ce.tabs.width+e-re*2),Ot}}Object.defineProperty(ce,"text",{get:function(){return ce.label?ce.label.text:null},set:function(Je){ce.label&&(ce.label.text=Je)}}),Object.defineProperty(ce,"bloom",{get:function(){return Te},set:function(Je){Te=Je}}),Object.defineProperty(ce,"currentValue",{get:function(){return ce.label?ce.label.text:null},set:function(Je){var gt=t.loop(ce.list,function(Ot,mt){var _t;Ot.label&&(_t=Ot.label.text),Ot.type=="Label"&&(_t=Ot.text);var vt=new RegExp(Je,"i");if(_t&&_t.match(vt))return mt});gt!==!0&&(ce.selectedIndexPlusPosition=gt)}}),Object.defineProperty(ce,"itemDown",{get:function(){return ce.tabs.buttonDown},set:function(){}}),Object.defineProperty(ce,"itemsText",{get:function(){for(var Je=[],gt=0;gt<ce.tabs.buttons.length;gt++){var Ot=ce.tabs.buttons[gt].label;Ot&&!n(Ot.text)?Je.push(Ot.text):Je.push(null)}return Je},set:function(){dt&&tt("List() - itemsText is read only")}}),s&&(ce.selectedIndex=0),Object.defineProperty(ce,"checkBoxes",{get:function(){for(var Je=[],gt=0;gt<ce.tabs.buttons.length;gt++){var Ot=ce.tabs.buttons[gt].checkBox;Je.push(Ot)}return Je},set:function(){dt&&tt("List() - checkBoxes is read only")}}),Object.defineProperty(ce,"accordionIndex",{get:function(){var Je=ce.selected.listZID;return Je?Number(Je.split("id")[1]):null},set:function(){dt&&tt("List() - accordionIndex is read only")}}),this.last=function(){return this.selectedIndexPlusPosition=this.length-1,this},this.first=function(){return this.selectedIndexPlusPosition=0,this},this.openAtLevel=function(Je){if(!n(Je)){var gt=[];t.loop(Je,function(mt){gt.push(mt)});var Ot=ce.bloom;ce.bloom=!1,t.interval(.01,function(mt){var _t=ce.items[mt.count];_t?gt.indexOf(ce.tree.getData(_t.listZID).level)!=-1&&ce.expandList(mt.count):(mt.clear(),ce.bloom=Ot)},null,!0,!1,"s")}};var Qt;this.openAtNum=function(Je){if(!n(Je)){if(!Qt){let Jt=function(tn,Zt){for(gt in tn)Qt[gt]=Zt,Jt(tn[gt].list,gt)};var gt;Qt={},Jt(ce.tree.data);var Ot={};for(var mt in Qt){Ot[mt]||(Ot[mt]=[]);for(var _t=Qt[mt];_t;)Ot[mt].unshift(_t),_t=Qt[_t];Ot[mt].push(mt)}}var vt="id"+Je,Lt=Ot[vt],Vt=ce.bloom;ce.bloom=!1,Ti(.01,function(Jt){var tn=ce.items[Jt.count];tn?Lt.indexOf(tn.listZID)!=-1&&ce.expandList(Jt.count):(Jt.clear(),ce.bloom=Vt)},null,!0,!1,"s")}},lt&&Yt&&ce.openAtLevel(1e4),n(be)&&(be=he.selectedIndex!=null?he.selectedIndex:0),ce.selectedIndex=be,Be!==!1&&t.styleTransforms(this,he),this.clone=function(){return ce.cloneProps(new t.List(e,Ve,t.copy(ce.originalList,!0),l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,Fe,We,R,t.copy(Q),K,q,ne,U,D,d,u,o,S,F,h,b,ye,B,N,re,le,G,z,se,Oe,J,pe,Z,de,V,fe,ke,oe,Ce,Me,te,ae,we,ue,Pe,ie,be,Le,me,ee,Ie,Re,_e,Ze,at,Be,this.group,et))},this.dispose=function(Je,gt,Ot){return Ot||(ce.stageToggleEvent&&Dt.off("stagemousedown",ce.stageToggleEvent),ce.organizer&&ce.organizer.dispose(),this.zimWindow_dispose()),!0}},t.extend(t.List,t.Window,["clone","dispose"],"zimWindow",!1),t.List.makeBase=function(e,r,i,l){n(l)&&(l=t.dark),e.backing=new t.Rectangle(e.width,e.height,l).center(e),r.type=="Label"?e.label=r:e.label=new t.Label(r,null,null,t.white),e.text=e.label.text,e.label.center(e).loc(i)},t.List.slider=function(e,r,i,l,a,s,f,c,w,T,p,x,P){var m="label, min, max, val, call, step, obj, property, paddingLeft, paddingRight, factor, offset, backgroundColor",v;if(v=st(t.List.slider,arguments,m))return v;var I=new t.Container(620,100);return I.type="ListItem",I.listItem="Slider",n(w)&&(w=20),n(T)&&(T=30),n(p)&&(p=1),n(x)&&(x=0),t.List.makeBase(I,e,w,P),I.slider=new t.Slider({inside:!0,barWidth:40,barLength:150,barColor:t.blue,min:r,max:i,step:s}).sca(1.5).center(I).mov(20).change(function(){I.stepper.currentValue=x+Math.round(I.slider.currentValue*p*1e3)/1e3,f&&c&&(f[c]=I.slider.currentValue),a&&typeof a=="function"&&a(I.slider.currentValue,I.parent),I.slider.stage&&I.slider.stage.update()}),n(l)||(I.slider.currentValue=l),I.stepper=new t.Stepper({corner:0,arrows:!1,stepperType:"number",min:x+r*p,max:x+i*p,step:s}).center(I).pos(T,null,!0).change(function(){}),n(l)||(I.stepper.currentValue=x+l*p),I},t.List.checkBox=function(e,r,i,l,a,s,f,c){var w="label, checked, call, obj, property, paddingLeft, paddingRight, backgroundColor",T;if(T=st(t.List.checkBox,arguments,w))return T;var p=new t.Container(620,100);return p.type="ListItem",p.listItem="CheckBox",n(s)&&(s=20),n(f)&&(f=30),t.List.makeBase(p,e,s,c),p.checkBox=new t.CheckBox({startChecked:r,label:""}).sca(1.2).center(p).pos(256+f,null,!0).change(function(){l&&a&&(l[a]=p.checkBox.checked),i&&typeof i=="function"&&i(p.checkBox.checked,p.parent),p.checkBox.stage&&p.checkBox.stage.update()}),p},t.List.colorPicker=function(e,r,i,l,a,s,f,c,w){var T="label, color, picker, call, obj, property, paddingLeft, paddingRight, backgroundColor",p;if(p=st(t.List.colorPicker,arguments,T))return p;var x=new t.Container(620,100);return x.type="ListItem",x.listItem="ColorPicker",n(f)&&(f=20),n(c)&&(c=30),t.List.makeBase(x,e,f,w),n(r)&&(r=t.pink),x.colorPicker=i||new t.ColorPicker({alphaPicker:!1,selectedColor:r}),x.swatch=new t.Rectangle(132,66,r,t.lighter,5).center(x).pos(270,null,!0).cur(),x.swatch.on("mousedown",function(){x.colorPicker.selectedColor=x.swatch.color,x.colorPicker.show()}),x.colorLabel=new t.Label(x.swatch.color.toUpperCase(),40,null,t.light).center(x).pos(c,null,!0),x.colorPicker.on("close",function(){var P=x.colorPicker.stage;x.colorPicker.hide(),P&&P.update()}),x.colorPicker.on("change",function(){var P=x.colorPicker.stage;x.swatch.color=x.colorPicker.selectedColor,x.colorLabel.text=x.swatch.color.toUpperCase(),x.colorPicker.hide(),a&&s&&(a[s]=x.colorPicker.selectedColor),l&&typeof l=="function"&&l(x.colorPicker.selectedColor,x.parent),P&&P.update()}),x},t.List.checkItem=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g){var E="label, size, width, align, paddingH, paddingV, spacing, color, rollColor, selectedColor, selectedRollColor, backgroundColor, rollBackgroundColor, selectedBackgroundColor, selectedRollBackgroundColor, group, inherit",A;if(A=st(t.List.checkItem,arguments,E))return A;var y=t.getStyle("CheckBox",I,g);n(r)&&(r=y.size!=null?y.size:20);var C=t.getStyle("List",I,g);n(i)&&(i=300),n(a)&&(a=10),n(s)&&(s=10),n(l)&&(l=C.align!=null?C.align:"center"),n(f)&&(f=C.spacing!=null?C.spacing:2),n(x)&&(x=C.backgroundColor!=null?C.backgroundColor:t.tin),n(P)&&(P=C.rollBackgroundColor!=null?C.rollBackgroundColor:t.grey),n(m)&&(m=C.selectedBackgroundColor!=null?C.selectedBackgroundColor:t.charcoal),n(v)&&(v=C.selectedRollBackgroundColor!=null?C.selectedRollBackgroundColor:t.grey),n(c)&&(c=C.color!=null?C.color:t.white),n(w)&&(w=C.rollColor!=null?C.rollColor:c),n(T)&&(T=C.selectedColor!=null?C.selectedColor:c),n(p)&&(p=C.selectedRollColor!=null?C.selectedRollColor:w);var L=new t.Container;return L.type="CheckItem",L.checkBox=new t.CheckBox({size:r,label:e,color:c,tap:!0}),L.backing=new t.Rectangle(i-f*2,L.checkBox.height+s*2,x).addTo(L),L.checkBox.center(L),l!="center"&&l!="middle"&&L.checkBox.pos(a,null,l=="right"),L.backing.tap(function(){L.checkBox.toggle(),L.zimOut()}),L.checkBox.change(function(){L.zimOut()}),L.zimOver=function(){L.backing.color=L.checkBox.checked?v:P,L.checkBox.label.color=L.checkBox.checked?p:w,L.stage&&L.stage.update()},L.zimOut=function(){L.backing.color=L.checkBox.checked?m:x,L.checkBox.label.color=L.checkBox.checked?T:c,L.stage&&L.stage.update()},L.backing.on("mouseover",L.zimOver),L.checkBox.on("mouseover",L.zimOver),L.backing.on("mouseout",L.zimOut),L.checkBox.on("mouseout",L.zimOut),L},t.Stepper=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O,X,R,Q,K,q,ne,U,D,d,u,o,S){var F="list, width, backgroundColor, borderColor, borderWidth, label, color, vertical, arrows, corner, shadowColor, shadowBlur, continuous, display, press, hold, holdDelay, holdSpeed, draggable, dragSensitivity, dragRange, stepperType, min, max, step, step2, arrows2, arrows2Scale, keyEnabled, keyArrows, rightForward, downForward, selectedIndex, currentValue, arrowColor, arrowScale, style, group, inherit",h;if(h=st(t.Stepper,arguments,F,this))return h;De("61"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Stepper",this.group=o;var b=u===!1?{}:t.getStyle(this.type,this.group,S);n(e)&&(e=b.list!=null?b.list:[]),n(r)&&(r=b.width!=null?b.width:100),n(i)&&(i=b.backgroundColor!=null?b.backgroundColor:t.white),n(l)&&(l=b.borderColor!=null?b.borderColor:null),n(a)&&(a=b.borderWidth!=null?b.borderWidth:null),l<0||a<0?l=a=null:l!=null&&a==null&&(a=1),n(f)&&(f=b.color!=null?b.color:t.grey),n(s)&&(s=b.label!=null?b.label:""),(typeof s=="string"||typeof s=="number")&&(s=new t.Label({text:s,size:b.size!=null?b.size*2:40,color:f,align:b.align!=null?b.align:"center",valign:b.valign!=null?b.valign:"center",backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",group:this.group}).loc(0,0)),n(c)&&(c=b.vertical!=null?b.vertical:!1),n(w)&&(w=b.arrows!=null?b.arrows:!0),n(T)&&(T=b.corner!=null?b.corner:16),n(p)&&(p=b.shadowColor!=null?b.shadowColor:"rgba(0,0,0,.3)"),n(x)&&(x=b.shadowBlur!=null?b.shadowBlur:14),n(P)&&(P=b.continuous!=null?b.continuous:!1),n(m)&&(m=b.display!=null?b.display:!0),n(v)&&(v=b.press!=null?b.press:!0),n(I)&&(I=b.hold!=null?b.hold:!0);var ye=wt(g);n(g)&&(g=b.holdDelay!=null?b.holdDelay:ye=="s"?.4:400),n(E)&&(E=b.holdSpeed!=null?b.holdSpeed:ye=="s"?.2:200),It(E,ye),n(A)&&(A=b.draggable!=null?b.draggable:!0),(n(y)||y<=0)&&(y=b.dragSensitivity!=null?b.dragSensitivity:.1),n(C)&&(C=b.dragRange!=null?b.dragRange:200),n(L)&&(L=b.stepperType!=null?b.stepperType:e.length>0?"list":"number"),n(Y)&&(Y=b.min!=null?b.min:0),n(_)&&(_=b.max!=null?b.max:10),n(k)&&(k=b.step!=null?b.step:1),n($)&&($=b.step2!=null?b.step2:k),n(O)&&$!=k&&L=="number"&&(O=b.arrows2!=null?b.arrows2:!0),n(X)&&(X=b.arrows2Scale!=null?b.arrows2Scale:.5),n(R)&&(R=b.keyEnabled!=null?b.keyEnabled:!0),n(Q)&&(Q=b.keyArrows!=null?b.keyArrows:!0),n(K)&&(K=b.rightForward!=null?b.rightForward:!0),n(q)&&(q=b.downForward!=null?b.downForward:L!="number"),n(D)&&(D=b.arrowColor!=null?b.arrowColor:i),n(d)&&(d=b.arrowScale!=null?b.arrowScale:1);var B=this,N,re=60,le=re/4;i=nt(i);var G=k,z,se=1,Oe;if(L=="number"){if(Y=Number(Y),_=Number(_),isNaN(Y)&&(Y=0),isNaN(_)&&(_=100),_<Y){se=-1;var J=_;_=Y,Y=J,z=_}else z=Y;this.min=Y,this.max=_,0>Y&&0<_&&(z=0),k=Math.abs(k),Oe=Math.max(de(k),de($))}else if(L=="letter"){e="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),typeof Y!="string"&&(Y="A"),typeof _!="string"&&(_="Z"),Y=Y.substr(0,1).toUpperCase(),_=_.substr(0,1).toUpperCase();var pe=e.indexOf(Y);pe<0&&(Y="A",pe=0);var Z=e.indexOf(_);Z<0&&(_="Z",Z=e.length),Z<pe&&(e.reverse(),pe=e.length-1-pe,Z=e.length-1-Z),e=e.splice(pe,Z-pe+1)}else L="list";function de(Fe){var We=String(Fe).split(".")[1];return We?We=We.length:We=0,We}var V,fe=0,ke=0;A&&this.on("mousedown",function(Fe){B.zimAccessibility&&B.zimAccessibility.aria||(this.stage.mouseMoveOutside=!0,fe=Fe.rawX/t.scaX,ke=Fe.rawY/t.scaY,V=this.stage.on("stagemousemove",function(We){fe=We.rawX/t.scaX,ke=We.rawY/t.scaY}))},null,!0),this.label=s,s.mouseChildren=!1,s.mouseEnabled=!1;var oe,Ce,Me,te,ae,we,ue,Pe,ie,be,Le,me,ee;if(w&&(Me=this.containerPrev=new t.Container({style:!1}),this.addChild(Me),te=this.arrowPrev=new t.Triangle(re,re*.8,re*.8,D,null,null,null,null,null,null,null,!1).sca(d),p!=-1&&x>0&&(Me.shadow=new Ne.Shadow(p,3,3,x)),Me.addChild(te),Me.expand(),Me.cur("pointer"),Me.on("mousedown",function(Fe){if(!(B.zimAccessibility&&B.zimAccessibility.aria)){G=k;var We=c?q?1:-1:K?-1:1;at(We),_e(We,null,null,Fe.stageX/t.scaX,Fe.stageY/t.scaY)}}),I&&Me.on("pressup",Ze),c?(Me.rotation=180,Me.x=r/2,m?Me.y=Me.height+le+re+Me.height/2+le:Me.y=Me.height*2):(Me.rotation=-90,Me.x=Me.height/2,Me.y=re/2)),m){var Ie=this.textBox=new t.Rectangle(r,re,i,l,a,T,null,null,null,!1);Ie.cur("pointer"),this.addChild(Ie),p!=-1&&x>0&&(Ie.shadow=new Ne.Shadow(p,3,3,x)),w&&(c?w&&(Ie.y=te.height+le):w&&(Ie.x=te.height+le)),this.addChild(s),e.length>0&&(N=0,s.text=e[N]),s.center(B);var Re;Ie.on("mousedown",function(Fe){B.zimAccessibility&&B.zimAccessibility.aria||(Re=B.currentValue,v&&at(1),_e(1,!0,null,Fe.stageX/t.scaX,Fe.stageY/t.scaY))}),Ie.on("pressup",function(){B.zimAccessibility&&B.zimAccessibility.aria})}else e.length>0&&(N=0);w&&(ae=this.containerNext=new t.Container({style:!1}),this.addChild(ae),we=this.arrowNext=new t.Triangle(re,re*.8,re*.8,D,null,null,null,null,null,null,null,!1).sca(d),p!=-1&&x>0&&(ae.shadow=new Ne.Shadow(p,3,3,x)),ae.addChild(we),ae.expand(),ae.cur("pointer"),ae.on("mousedown",function(Fe){if(!(B.zimAccessibility&&B.zimAccessibility.aria)){G=k;var We=c?q?-1:1:K?1:-1;at(We),_e(We,null,null,Fe.stageX/t.scaX,Fe.stageY/t.scaY)}}),I&&ae.on("pressup",Ze),c?(ae.rotation=0,ae.x=r/2,ae.y=ae.getBounds().height/2):(ae.rotation=90,m?ae.x=Ie.x+Ie.getBounds().width+ae.getBounds().height/2+le:ae.x=Me.x+Me.getBounds().width,ae.y=re/2));function _e(Fe,We,ce,Ve,Se){if(I){Le=Ve,me=Se,Le==0&&(Le=1),me==0&&(me=1),A||(y=1);var Ae=E*(ye=="s"?1e3:1),Ye=g*(ye=="s"?1e3:1),Xe=Ae;ee=new t.Proportion(0,C,Ae,Ae*y),oe=setTimeout(function(){function Ue(){Ce=setTimeout(function(){var rt=Fe;if(A){var Te=Math.abs(fe-Le),$e=Math.abs(ke-me);c?(!We&&!ce&&(Te=0),ce&&($e=0)):(!We&&!ce&&($e=0),ce&&(Te=0)),(Te>=10||$e>=10)&&(Te>$e?(G=c?$:k,rt=fe-Le>0?1:-1,K||rt*-1,Xe=ee.convert(Math.abs(Le-fe))):(G=c?k:$,rt=ke-me>0?1:-1,(L=="number"||!q)&&(rt*=-1),Xe=ee.convert(Math.abs(me-ke))))}at(rt),Ue()},Xe)}Ue()},Ye)}}I&&m&&Ie.on("pressup",Ze);function Ze(){B.zimAccessibility&&B.zimAccessibility.aria||(clearTimeout(oe),clearTimeout(Ce))}O&&(ue=this.prev2=new t.Container({style:!1}),Pe=this.arrowPrev2=new t.Triangle(re,re*.8,re*.8,"rgba(0,0,0,.2)",D,2,null,null,null,null,null,!1),ue.addChild(Pe),ue.expand(),ue.cur("pointer"),ue.sca(X),ue.alpha=.5,ue.on("mousedown",function(Fe){if(!(B.zimAccessibility&&B.zimAccessibility.aria)){G=$;var We=c?K?-1:1:q?1:-1;at(We),_e(We,null,!0,Fe.stageX/t.scaX,Fe.stageY/t.scaY)}}),I&&ue.on("pressup",Ze),ie=this.next2=new t.Container({style:!1}),be=this.arrowNext2=new t.Triangle(re,re*.8,re*.8,"rgba(0,0,0,.2)",D,2,null,null,null,null,null,!1),ie.addChild(be),ie.expand(),ie.cur("pointer"),ie.sca(X),ie.alpha=.5,ie.on("mousedown",function(Fe){if(!(B.zimAccessibility&&B.zimAccessibility.aria)){G=$;var We=c?K?1:-1:q?-1:1;at(We),_e(We,null,!0,Fe.stageX/t.scaX,Fe.stageY/t.scaY)}}),I&&ie.on("pressup",Ze),c?(ue.y=this.height/2,ue.x=-ue.width/2-le*Math.max(.2,Math.min(1,X)),ue.rotation=270,ie.y=this.height/2,ie.x=this.width+ie.width/2+le*Math.max(.2,Math.min(1,X)),ie.rotation=90):(ie.x=this.width/2,ie.y=-ie.height/2-le*Math.max(.2,Math.min(1,X)),ie.rotation=0,ue.x=this.width/2,ue.y=this.height+ue.height/2+le*Math.max(.2,Math.min(1,X)),ue.rotation=180),this.addChild(ue,ie)),Object.defineProperty(this,"stepperArray",{get:function(){if(L=="number"){e=[];for(var Fe=B.min;Fe<=B.max;Fe+=Math.min(k,$))e.push(Number(t.decimals(Fe,Oe,null,!1)));e.push(_)}return e},set:function(Fe){e=Fe;var We=B.selectedIndex;B.selectedIndex=We}}),Object.defineProperty(this,"min",{get:function(){return Y},set:function(Fe){if(L=="number"){B.currentValue<Fe&&(B.currentValue=Fe),Y=Fe;var We=B.selectedIndex;B.selectedIndex=We}else Y=Fe}}),Object.defineProperty(this,"max",{get:function(){return _},set:function(Fe){if(L=="number"){B.currentValue>Fe&&(B.currentValue=Fe),_=Fe;var We=B.selectedIndex;B.selectedIndex=We}else _=Fe}}),et(L=="number"?z:e[N],L=="number"?z:N);function at(Fe){var We;if(L=="number"){z=Number(z);var ce=z;z+=Number(G*Fe*se),z=t.decimals(z,Oe),P?z>B.max?z=B.min:z<B.min&&(z=B.max):(z>B.max?(z=k==1?B.max:ce,m&&Ie.cur("default")):m&&Ie.cur("pointer"),z<B.min&&(z=k==1?B.min:ce))}else{if(We=N+Fe,P)We>e.length-1&&(We=0),We<0&&(We=e.length-1);else{if(We>e.length-1){m&&Ie.cur("default");return}else m&&Ie.cur("pointer");if(We<0)return}N=We}et(L=="number"?z:e[N],L=="number"?z:N),B.currentValue!=Re&&B.dispatchEvent("change"),Re=B.currentValue}Object.defineProperty(this,"selectedIndex",{get:function(){return L=="number"?B.stepperArray.indexOf(B.currentValue):N},set:function(Fe){n(Fe)||(L=="number"?(N=Math.min(B.stepperArray.length-1,Math.max(0,Fe)),z=B.stepperArray[N],et(z,z)):(Fe=Math.min(e.length-1,Math.max(0,Fe)),N=Fe,et(e[N],N)))}}),Object.defineProperty(this,"currentValue",{get:function(){return L=="number"?Number(z):e[N]},set:function(Fe){if(!n(Fe))if(L=="number"){if(Fe=Number(Fe),B.max>B.min){if(Fe>B.max||Fe<B.min)return}else if(Fe<B.max||Fe>B.min)return;var We=B.stepperArray.indexOf(Fe);if(We<0)return;N=We,z=Number(B.stepperArray[N]),et(z,z)}else{if(e.indexOf(Fe)>-1)Fe=e.indexOf(Fe);else return;if(Fe==B.selectedIndex)return;N=Fe,et(e[N],N)}}}),Object.defineProperty(this,"currentValueEvent",{get:function(){return B.currentValue},set:function(Fe){String(Fe)!=String(B.currentValue)&&(B.currentValue=Fe,B.dispatchEvent("change"))}}),Object.defineProperty(this,"continuous",{get:function(){return P},set:function(Fe){P=Fe,L=="number"?et(z,z):et(e[B.selectedIndex],B.selectedIndex)}}),this._enabled=!0,Object.defineProperty(B,"enabled",{get:function(){return B._enabled},set:function(Fe){bt(B,Fe),Fe?(L=="number"?et(z,z):et(e[B.selectedIndex],B.selectedIndex),j.addEventListener("keydown",B.keyDownEvent)):(ge(),xe(),j.removeEventListener("keydown",B.keyDownEvent),m&&(s.mouseChildren=!1),m&&(s.mouseEnabled=!1)),ae&&!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&ae.stage?ae.stage.update():s&&!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&s.stage&&s.stage.update()}}),j.KEYFOCUS!=null&&(t.KEYFOCUS=j.KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return t.KEYFOCUS==B},set:function(){t.KEYFOCUS=B}}),t.KEYFOCUS||Be(),this.on("mousedown",function(){Be()});function Be(){B.keyFocus=!0;var Fe=document.activeElement;Fe&&Fe.blur()}function He(){Me.alpha=1,te.color=D,Me.cur("pointer"),ae.alpha=1,we.color=D,ae.cur("pointer"),P||(L=="number"?(N==B.min&&(se>0?ge():xe()),N==B.max&&(se>0?xe():ge())):(N==0&&(c?xe():ge()),N==e.length-1&&(c?ge():xe())))}function et(Fe,We){N=We,m&&(L=="number"&&Fe!=0&&Oe>0&&(Fe=t.decimals(Fe,Oe,!0)),s.text=Fe,s.center(B)),w&&He(),ae&&!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&ae.stage?ae.stage.update():s&&!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&s.stage&&s.stage.update(),B.zimAccessibility&&B.zimAccessibility.changeTitle(B,null,!0)}function ge(){w&&(Me.alpha=.8,te.color=t.fog,Me.cur("default"))}function xe(){w&&(ae.alpha=.8,we.color=t.fog,ae.cur("default"))}var he,Ge=!0,qe="";this.on("mousedown",function(){Ge=!0,qe="",!(B.zimAccessibility&&B.zimAccessibility.aria)&&(B.focus=!0,he=!1)}),this.keyDownEvent=function(Fe){if(B.stage&&(B.zimAccessibility&&B.focus||!B.zimAccessibility&&B.keyFocus)){Fe||(Fe=event);var We=Fe.keyCode;if(Q&&We>=37&&We<=40){var ce=q?40:38,Ve=K?39:37,Se=q?38:40,Ae=K?37:39;We==ce||We==Ve?(c&&We==ce||!c&&We==Ve?G=k:G=$,at(1)):(We==Se||We==Ae)&&(c&&We==Se||!c&&We==Ae?G=k:G=$,at(-1))}if(R)if(L=="number"){var Ye=null,Xe=null;if(We==8){var Ue=String(qe).split("");Ue.pop(),Ye=Ue.pop(),qe=Ue.join("")}if(!Fe.shiftKey&&We>=48&&We<=57?Ye=We-48:We>=96&&We<=105?Ye=We-96:We==190?(qe=String(qe)+".",Xe=!0):We==173||We==189?(B.currentValue=B.currentValue*-1,B.currentValue!=Re&&B.dispatchEvent("change"),Re=B.currentValue,he=!he):We==46&&(Ge=!0,qe=""),n(Ye)&&n(Xe)){Ge=!0,qe="";return}if(n(Ye)||(Ge?(Ge=!1,qe=Ye):qe=Ye=+(qe+""+Ye),Ye<Y||Ye>_))return;B.currentValue=Ye,B.currentValue!=Re&&B.dispatchEvent("change"),Re=B.currentValue}else Ge=!0,qe="",B.currentValue=String.fromCharCode(Fe.keyCode),B.currentValue!=Re&&B.dispatchEvent("change"),Re=B.currentValue}},j.addEventListener("keydown",this.keyDownEvent),this.next=function(){at(1)},this.prev=function(){at(-1)},n(ne)&&(ne=b.selectedIndex!=null?b.selectedIndex:0),B.selectedIndex=ne,n(U)&&(U=b.currentValue!=null?b.currentValue:null),n(U)||(B.currentValue=U),u!==!1&&t.styleTransforms(this,b),this.clone=function(){return B.cloneProps(new t.Stepper(e,r,i,l,a,s.clone(),f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O,X,R,Q,K,q,ne,U,D,d,u,this.group,S))},this.dispose=function(Fe,We,ce){return j.removeEventListener("keydown",B.keyDownEvent),B.removeAllEventListeners(),B.stage&&B.stage.off(V),ce||this.zimContainer_dispose(!0),Me=this.containerPrev=te=this.arrowPrev=null,ae=this.containerNext=we=this.arrowNext=null,Ie=this.textBox=s=this.label=null,!0}},t["zut"]=function(e){if(!n(e)&&e["key"])t.async("https://zimjs.com/gamdata.php?id="+e["key"]+"&player="+e["player"]+"&score="+e["score"]+"&reverse="+e["info"]["reverse"]+"&total="+e["info"]["total"]+"&allowZero="+e["info"]["allowZero"],e["info"]["type"]);else return!0},t.extend(t.Stepper,t.Container,["clone","dispose"],"zimContainer",!1),t.Slider=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O,X,R,Q,K,q,ne,U,D,d,u){var o="min, max, step, button, barLength, barWidth, barColor, vertical, useTicks, tickColor, tickStep, semiTicks, tickScale, semiTickScale, accentSize, accentOffset, accentColor, accentBackgroundColor, accentDifference, sound, inside, keyArrows, keyArrowsStep, keyArrowsH, keyArrowsV, damp, currentValue, expand, expandVertical, expandBar, expandBarVertical, useLabels, labelMargin, labelColor, style, group, inherit",S;if(S=st(t.Slider,arguments,o,this))return S;De("62"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Slider",this.group=d;var F=D===!1?{}:t.getStyle(this.type,this.group,u);if(n(e)&&(e=F.min!=null?F.min:0),n(r)&&(r=F.max!=null?F.max:10),r-e==0){tt("ZIM Slider range must not be 0");return}n(y)&&(y=F.sound!=null?F.sound:!1),n(i)&&(i=F.step!=null?F.step:0),n(l)&&(l=F.button!=null?F.button:y?"aztec":null),l&&l.type=="Button"&&(l=l.clone()),n(a)&&(a=F.barLength!=null?F.barLength:300),n(s)&&(s=F.barWidth!=null?F.barWidth:3),n(f)&&(f=F.barColor!=null?F.barColor:y?t.lighter:t.granite),n(c)&&(c=F.vertical!=null?F.vertical:!!y),n(w)&&(w=F.useTicks!=null?F.useTicks:!!y),n(p)&&(p=F.tickStep!=null?F.tickStep:i||(w||y?(r-e)/40:0)),n(x)&&(x=F.semiTicks!=null?F.semiTicks:p?3:0),n(T)&&(T=F.tickColor!=null?F.tickColor:y?t.tin:f),n(P)&&(P=F.tickScale!=null?F.tickScale:y?1.25:1),n(m)&&(m=F.semiTickScale!=null?F.semiTickScale:1),n(v)&&(v=F.accentSize!=null?F.accentSize:y?10:0),n(I)&&(I=F.accentOffset!=null?F.accentOffset:y?-(v+s)/2:0),n(g)&&(g=F.accentColor!=null?F.accentColor:t.pink),n(E)&&(E=F.accentBackgroundColor!=null?F.accentBackgroundColor:y?t.blue:t.clear),n(A)&&(A=F.accentDifference!=null?F.accentDifference:-.5),n(C)&&(C=F.inside!=null?F.inside:!1),n(L)&&(L=F.keyArrows!=null?F.keyArrows:!0),n(_)&&(_=F.keyArrowsH!=null?F.keyArrowsH:!0),n(k)&&(k=F.keyArrowsV!=null?F.keyArrowsV:!0),n(Y)&&(Y=F.keyArrowsStep!=null?F.keyArrowsStep:(r-e)/100),n($)&&($=F.damp!=null?F.damp:!1),n(O)&&(O=F.currentValue!=null?F.currentValue:!1),n(X)&&(X=F.expand!=null?F.expand:t.mobile()?10:null),n(R)&&(R=F.expandVertical!=null?F.expandVertical:X),n(Q)&&(Q=F.expandBar!=null?F.expandBar:null),n(K)&&(K=F.expandBarVertical!=null?F.expandBarVertical:X),n(q)&&(q=F.useLabels!=null?F.useLabels:!1),n(ne)&&(ne=F.labelMargin!=null?F.labelMargin:20),n(U)&&(U=F.labelColor!=null?F.labelColor:t.dark);var h,b=this,ye=B(e,r,i,O);this.veeObj={min:ye[0],max:ye[1],step:ye[2],currentValue:ye[3]};function B(){return arguments}e=t.Pick.choose(e),r=t.Pick.choose(r),i=t.Pick.choose(i);var N=i;O=t.Pick.choose(O);var re;v&&(b.accentBacking=new t.Rectangle(a-.25,v+A,E).addTo(this).rot(c?90:0).mov(c?-I-s/2+A/2:.25,c?0:I+s/2-A/2),re=b.accent=new t.Rectangle(a,v,g).sca(0,1).rot(c?-90:0).mov(c?-I-v-s/2:0,c?a:I+s/2).addTo(this));function le(){re.sca((b.currentValue-b.min)/Math.abs(b.max-b.min),1)}var G=!(!n(F.backing)&&F.backing.type!="Pattern");function z(Xe,Ue,rt){var Te=new t.Shape(Ue,rt);return Te.f(Xe).s(F.borderColor!=null?F.borderColor:t.tin).ss(F.borderWidth!=null?F.borderWidth:3).mt(2,0).lt(Ue+2,rt*.2).lt(Ue+2,rt*.8).lt(2,rt).cp().centerReg({add:!1}),Te}if(n(l)||typeof l=="string"){var se=30,Oe=40;c&&(se=50,Oe=40);var J;if(l=="pill"||l=="aztec"||l=="circle"||l=="grip"){if(l=="pill")J={width:c?40:18,height:c?18:40,borderColor:t.tin,borderWidth:3,corner:8};else if(l=="aztec"){se=F.width!=null?F.width:Math.max(se,Oe)*.9,Oe=F.height!=null?F.height:Math.min(se,Oe)*.6;var pe=z(F.backgroundColor!=null?F.backgroundColor:t.lighter,se,Oe).rot(c?0:-90),Z=z(F.rollBackgroundColor!=null?F.rollBackgroundColor:t.white,se,Oe).rot(c?0:-90);J={width:se,height:Oe,backing:pe,rollBacking:Z},F.borderWidth=0,F.borderColor=0}else l=="circle"&&(se=F.width!=null?F.width:30,Oe=F.height!=null?F.height:30,J={width:se,height:se,corner:F.corner!=null?F.corner:se/2});b.buttonType=l}var de=F.borderColor!=null?F.borderColor:J?J.borderColor:G?t.granite:null;if(l=new t.Button({width:F.width!=null?F.width:J?J.width:se,height:F.height!=null?F.height:J?J.height:Oe,label:"",backgroundColor:F.backgroundColor!=null?F.backgroundColor:t.white,rollBackgroundColor:F.rollBackgroundColor!=null?F.rollBackgroundColor:n(F.backgroundColor)||F.backgroundColor==t.white?t.moon:F.backgroundColor.lighten(.2),borderColor:de,rollBorderColor:F.rollBorderColor!=null?F.rollBorderColor:de,borderWidth:F.borderWidth!=null?F.borderWidth:J?J.borderWidth:G?1:null,corner:F.corner!=null?F.corner:J?J.corner:0,backing:F.backing!=null?F.backing.clone():J?J.backing:null,rollBacking:F.rollBacking!=null?F.rollBacking.clone():J?J.rollBacking:null,shadowColor:F.shadowColor!=null?F.shadowColor:null,shadowBlur:F.shadowBlur!=null?F.shadowBlur:null,hitPadding:30,style:!1}),b.buttonType=="circle")l.scaleY=Oe/se,c||l.rot(-90);else if(b.buttonType=="grip"){var V=[1,1,1],fe=.4;t.loop(V,function(Xe,Ue,rt){c?new t.Line(l.width*.62,Xe,l.borderColor?l.borderColor:t.grey).pos(0,l.height*fe/2+(Ue+1)*(l.height*(1-fe))/(rt+1),t.CENTER,t.TOP,l):new t.Line(l.height*.62,Xe,l.borderColor?l.borderColor:t.grey).rot(90).pos(l.width*fe/2+(Ue+1)*(l.width*(1-fe))/(rt+1),0,t.LEFT,t.CENTER,l)})}}l.rollPersist=!0,(!n(X)||!n(R))&&l.expand(X,R);var ke,oe;c?(ke=l.width,C?(oe=a,this.setBounds(0,0,ke,oe)):(oe=a+l.height,this.setBounds(-l.width/2,-l.height/2,ke,oe))):(oe=Math.max(l.height,s),C?(ke=a,this.setBounds(0,0,ke,oe)):(ke=a+l.width,this.setBounds(-l.width/2,-l.height/2,ke,oe)));var Ce=e,Me=0;this.button=l,this.cur("pointer");var te,ae,we,ue,Pe;if(w){ue=this.ticks=new t.Shape({style:!1}),this.addChild(ue),Pe=ue.graphics,Pe.ss(1).s(T);var ie=Math.round((r-e)/(p||i)),be=(r-e)/ie;p?(be!=p&&dt&&tt("Slider() - non-divisible step ("+p+") adjusted to "+be),p=be):(be!=i&&dt&&tt("Slider() - non-divisible step ("+i+") adjusted to "+be),i=be);var Le;C?Le=(a-(c?l.height:l.width))/Math.abs(ie):Le=a/Math.abs(ie)}var me,ee,Ie,Re,_e,Ze,at;if(c){if(me=C?l.height/2:0,te=this.bar=new t.Rectangle(s,a,f,null,null,null,null,null,null,!1),Q?te.expand(Q,K):te.expand(20,0),te.centerReg(this),l.centerReg(this),we=te.getBounds(),ae=new Ne.Rectangle(te.x,we.y+me,0,we.height-me*2),w){for(q&&(ee=b.labels=new t.Container().addTo(b)),Ie=0;Ie<=Math.abs(ie);Ie++)Re=Ie%(x+1)==0,_e=Re?25*P:15*m,Ze=me+Le*Ie,Pe.mt(0,Ze).lt(_e,Ze),q&&(x&&Re||!x)&&(at=Math.max(t.countDecimals(N),t.countDecimals(e),t.countDecimals(r)),new t.Label({text:t.decimals(r-(r-e)/Math.abs(ie)*Ie,at+1),size:F.size?F.size:10,color:U,align:"left",valign:"center"}).centerReg({add:!1}).reg(0).loc(_e+ne+2,Ze-1,ee));ue.x=te.x+15}}else if(me=C?l.width/2:0,te=this.bar=new t.Rectangle(a,s,f,null,null,null,null,null,null,!1),Q?te.expand(Q,K):te.expand(0,20),te.centerReg(this),l.centerReg(this),we=te.getBounds(),ae=new Ne.Rectangle(we.x+me,te.y,we.width-me*2,0),w){for(q&&(ee=b.labels=new t.Container().addTo(b)),Ie=0;Ie<=Math.abs(ie);Ie++)Re=Ie%(x+1)==0,_e=me+Le*Ie,Ze=-(Re?25*P:15*m),Pe.mt(_e,0).lt(_e,Ze),q&&(x&&Re||!x)&&(at=Math.max(t.countDecimals(N),t.countDecimals(e),t.countDecimals(r)),new t.Label({text:t.decimals(e+(r-e)/Math.abs(ie)*Ie,at+1),size:F.size?F.size:10,color:U,align:"center",valign:"center"}).centerReg({add:!1}).loc(_e,Ze-ne,ee));ue.y=te.y-10}l.x=ae.x,l.y=ae.y;function Be(Xe){return i==0?Xe:Math.round(Xe/i)*i}var He,et;l.on("mousedown",function(Xe){h=Xe.target.stage,b.focus=!0;var Ue=b.globalToLocal(Xe.stageX/t.scaX,Xe.stageY/t.scaY);He=Ue.x-l.x,et=Ue.y-l.y,h&&(h.mouseMoveOutside=!0)}),l.on("pressmove",function(Xe){ge(Xe)});function ge(Xe){var Ue=b.globalToLocal(Xe.stageX/t.scaX,Xe.stageY/t.scaY),rt=Ge(Ue.x-He,Ue.y-et,ae);c?(l.x=rt.x,Ce=Be((rt.y-ae.y)/ae.height*(e-r)),l.y=ae.y+Ce*ae.height/(e-r),Ce+=r,l.y!=Me&&b.dispatchEvent("change"),Me=l.y):(Ce=Be((rt.x-ae.x)/ae.width*(r-e)),l.x=ae.x+Ce*ae.width/(r-e),Ce+=e,l.y=rt.y,l.x!=Me&&b.dispatchEvent("change"),Me=l.x),re&&le(),he(),!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&b.stage&&b.stage.update()}function xe(Xe){return Xe>0?1:-1}function he(){b.zimAccessibility&&b.zimAccessibility.changeTitle(b,null,!0)}function Ge(Xe,Ue,rt){return Xe=Math.max(rt.x,Math.min(rt.x+rt.width,Xe)),Ue=Math.max(rt.y,Math.min(rt.y+rt.height,Ue)),{x:Xe,y:Ue}}te.on("mousedown",function(Xe){h=Xe.target.stage,He=0,et=0,!(b.zimAccessibility&&b.zimAccessibility.aria)&&ge(Xe)});var qe,Fe;$&&(qe=e,Fe=new t.Damp(qe,$),b.ticker=t.Ticker.add(function(){qe=Fe.convert(Ce)})),Object.defineProperty(this,"currentValue",{get:function(){return $?qe:Ce},set:function(Xe){n(Xe)||(e<r?(Xe<e&&(Xe=e),Xe>r&&(Xe=r)):(Xe>e&&(Xe=e),Xe<r&&(Xe=r)),Ce=Xe=Be(Xe),Fe&&Fe.immediate(Ce),c?(l.y=(Xe-r)/(e-r)*ae.height+me,Me=l.y):(l.x=(Xe-e)/(r-e)*ae.width+me,Me=l.x),re&&le(),he(),!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&b.stage&&b.stage.update())}}),Object.defineProperty(this,"currentValueEvent",{get:function(){return $?qe:Ce},set:function(Xe){Xe!=b.currentValue&&(b.currentValue=Xe,b.dispatchEvent("change"))}}),Object.defineProperty(this,"min",{get:function(){return e},set:function(){dt&&tt("Slider() - min is read only")}}),Object.defineProperty(this,"max",{get:function(){return r},set:function(){dt&&tt("Slider() - max is read only")}}),Object.defineProperty(this,"step",{get:function(){return i},set:function(){dt&&tt("Slider() - step is read only")}}),Object.defineProperty(this,"keyArrowsH",{get:function(){return _},set:function(Xe){_=Xe}}),Object.defineProperty(this,"keyArrowsV",{get:function(){return k},set:function(Xe){k=Xe}}),j.KEYFOCUS!=null&&(t.KEYFOCUS=j.KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return t.KEYFOCUS==b},set:function(){t.KEYFOCUS=b}}),L&&!t.KEYFOCUS&&We(),this.on("mousedown",function(){L&&We()});function We(){b.keyFocus=!0;var Xe=document.activeElement;Xe&&Xe.blur()}var ce=!1,Ve=!1,Se=!1,Ae=!1;this.keyDownEvent=function(Xe){b.stage&&(b.zimAccessibility&&b.focus||!b.zimAccessibility&&b.keyFocus)&&(Xe.keyCode==37&&_?ce=!0:Xe.keyCode==40&&k?Ve=!0:Xe.keyCode==39&&_?Se=!0:Xe.keyCode==38&&k&&(Ae=!0),b.keyInterval==null&&(ce||Ve||Se||Ae)&&(Ye(),b.keyTimeout=setTimeout(function(){b.keyInterval==null&&(ce||Ve||Se||Ae)&&(b.keyInterval=setInterval(Ye,40))},140)))};function Ye(){(ce||Ve)&&(i>0?b.currentValueEvent-=i*xe(r-e):b.currentValueEvent-=Y*xe(r-e)),(Se||Ae)&&(i>0?b.currentValueEvent+=i*xe(r-e):b.currentValueEvent+=Y*xe(r-e))}j.addEventListener("keydown",this.keyDownEvent),b.keyUpEvent=function(Xe){Xe.keyCode==37?ce=!1:Xe.keyCode==40?Ve=!1:Xe.keyCode==39?Se=!1:Xe.keyCode==38&&(Ae=!1),b.keyInterval!=null&&!ce&&!Ve&&!Se&&!Ae&&(clearInterval(b.keyInterval),b.keyInterval=null)},j.addEventListener("keyup",this.keyUpEvent),this._enabled=!0,Object.defineProperty(b,"enabled",{get:function(){return b._enabled},set:function(Xe){bt(b,Xe),Xe?(j.addEventListener("keydown",b.keyDownEvent),j.addEventListener("keyup",b.keyUpEvent)):(j.removeEventListener("keydown",b.keyDownEvent),j.removeEventListener("keyup",b.keyUpEvent))}}),n(O)||(b.currentValue=O),t.setSwipe(this,!1),D!==!1&&t.styleTransforms(this,F),this.clone=function(Xe){return b.cloneProps(new t.Slider(Xe||!t.isPick(ye[0])?b.min:ye[0],Xe||!t.isPick(ye[1])?b.max:ye[1],Xe||!t.isPick(ye[2])?b.step:ye[2],l.clone(),a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,Xe||!t.isPick(ye[3])?b.currentValue:ye[3],X,R,Q,K,q,ne,U,D,this.group,u))},this.dispose=function(Xe,Ue,rt){return j.removeEventListener("keydown",b.keyDownEvent),j.removeEventListener("keyup",b.keyUpEvent),rt||this.zimContainer_dispose(!0),!0}},t.extend(t.Slider,t.Container,["clone","dispose"],"zimContainer",!1),t.Selector=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y){var C="tile, borderColor, borderWidth, backgroundColor, corner, dashed, paddingH, paddingV, speed, diagonal, dim, multi, keyArrows, behind, resizeScale, selectedIndex, liveIndex, style, group, inherit",L;if(L=st(t.Selector,arguments,C,this))return L;De("62.5"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Selector",this.group=A;var Y=E===!1?{}:t.getStyle(this.type,this.group,y),_=wt();n(e)&&(e=Y.tile!=null?Y.tile:new t.Tile(new t.Circle(20,t.red),4,4,10,10)),n(r)&&(r=Y.borderColor!=null?Y.borderColor:t.white),n(i)&&(i=Y.borderWidth!=null?Y.borderWidth:2),n(l)&&(l=Y.backgroundColor!=null?Y.backgroundColor:"rgba(0,0,0,.1)"),n(a)&&(a=Y.corner!=null?Y.corner:10),n(s)&&(s=Y.dashed!=null?Y.dashed:!1),n(f)&&(f=Y.padding!=null?Y.padding:e.spacingH/2),n(c)&&(c=Y.paddingV!=null?Y.paddingV:e.spacingV/2),n(w)&&(w=Y.speed!=null?Y.speed:2),n(T)&&(T=Y.diagonal!=null?Y.diagonal:!1),n(p)&&(p=Y.dim!=null?Y.dim:!1),n(x)&&(x=Y.multi!=null?Y.multi:!1),x&&(w=0),n(P)&&(P=Y.keyArrows!=null?Y.keyArrows:!0),n(m)&&(m=Y.behind!=null?Y.behind:!1),n(v)&&(v=Y.resizeScale!=null?Y.resizeScale:!1),n(I)&&(I=Y.selectedIndex!=null?Y.selectedIndex:null),n(g)&&(g=Y.liveIndex!=null?Y.liveIndex:!1),this.liveIndex=g;var k=[],$=[];t.loop(e.items.length,function(){k.push(nt(r)),$.push(nt(l))});var O=this;if(!(n(I)&&x)){var X=I,R=n(I)||I<0?0:I,Q=e.getChildAt(R);O.currentItem=e.getChildAt(R),I=X,n(I)&&(I=Y.selectedIndex!=null?Y.selectedIndex:0)}var K,q,ne;K=Q||e.getChildAt(0),K&&(q=K.width+f*2,ne=K.height+c*2),O.tile=e.addTo(O).cur();var U;if(x){var D=this.selectors=[];t.loop(10,function(){U=new t.Rectangle(q,ne,t.faint,t.faint,i,a,s,{ignoreScale:!v}).centerReg(O,m?0:1),U.visible=!1,D.push(U),U.mouseEnabled=!1}),this.selector=U}else U=this.selector=new t.Rectangle(q,ne,t.faint,t.faint,i,a,s,{ignoreScale:!v}).centerReg(O),U.loc(e.width/2,K.y+c,O,m?0:1),U.visible=!1;I<0||n(Q)||(U.loc(K.x+f,K.y+c,O,m?0:1),U.color=$[I],U.borderColor=k[I],U.visible=!0),e.mov(f,c),this.setBounds(e.width+f*2,e.height+c*2);var d={};this.tileDown=e.on("mousedown",function(S){var F=U;if(!(x&&(F=D.shift(),n(F)))){F.visible=!0;for(var h=S.target,b=0;h.parent!=e&&b<10;)h=h.parent,b++;if(h.parent==e&&u(h,null,F),x){var ye="id"+Math.abs(S.pointerID+1);d[ye]={index:I,item:Q,selector:F}}}}),x&&(this.tileMove=e.on("pressmove",function(S){var F="id"+Math.abs(S.pointerID+1),h=d[F];if(!n(h)){var b=e.itemUnderPoint(S.stageX/t.scaX,S.stageY/t.scaY);if(h.item!=b){if(O.upItem=h.item,O.upIndex=h.index,O.downItem=h.item=b,O.downIndex=h.index=b?b.tileNum:null,O.dispatchEvent("change"),n(b))h.selector.visible=!1;else{var ye=e.localToLocal(b.x,b.y,O);h.selector.loc(ye.x,ye.y).siz(b.width+f*2,b.height+c*2),h.selector.color=$[h.index],h.selector.borderColor=k[h.index],h.selector.visible=!0}O.stage.update()}}}),this.tileUp=e.on("pressup",function(S){var F="id"+Math.abs(S.pointerID+1),h=d[F];n(h)||(O.downIndex=O.downItem=null,O.upIndex=h.index,O.upItem=h.item,D.push(h.selector),h.selector.visible=!1,O.dispatchEvent("change"),O.stage&&!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&O.stage.update(),delete d[F])})),O.noAnimate=!1;function u(S,F,h,b){n(h)&&(h=U),Q=S,I=S.tileNum,h.color=$[I],h.borderColor=k[I],x&&(O.upItem=O.upIndex=null,O.downItem=Q,O.downIndex=I),O.animating=!0;var ye=e.localToLocal(S.x,S.y,O),B=Math.abs(ye.x-U.x),N=Math.abs(ye.y-U.y),re=O.noAnimate||F?0:w;if(O.noAnimate=!1,re==0)h.loc(ye.x,ye.y).siz(S.width+f*2,S.height+c*2),O.animating=!1,O.dispatchEvent("change");else{if(T||(B+N)*re<=0?h.animate({x:ye.x,y:ye.y},(N+B)*re):(h.stopAnimate(),B>=N?h.animate([{props:{x:ye.x},time:Math.max(_=="s"?.1:100,B*re/(_=="s"?1e3:1))},{props:{y:ye.y},time:Math.max(_=="s"?.1:100,N*re/(_=="s"?1e3:1))}]):h.animate([{props:{y:ye.y},time:Math.max(_=="s"?.1:100,N*re/(_=="s"?1e3:1))},{props:{x:ye.x},time:Math.max(_=="s"?.1:100,B*re/(_=="s"?1e3:1))}])),h.animate({props:{widthOnly:S.width+f*2,heightOnly:S.height+c*2},time:Math.max(_=="s"?.2:200,(N+B)*re/(_=="s"?1e3:1)),events:O.liveIndex,call:function(){O.animating=!1,b?O.dispatchEvent("changeset"):O.dispatchEvent("change")}}),O.liveIndex){var le=null;h.on("animation",function(){var z=h.parent.localToGlobal(h.x,h.y),se=e.itemUnderPoint(z.x,z.y);se.tileNum!=le&&(I=se.tileNum,b?O.dispatchEvent("changeset"):O.dispatchEvent("change"),le=se.tileNum)})}if(p){if(p===!0)var G=.7;else G=t.constrain(p,0,1);e.animate({props:{alpha:G},rewind:!0,time:(N+B)*w*.7/(_=="s"?1e3:1)})}}e.stage&&e.stage.update()}P&&O.added(function(){O.keyEvent=O.stage.frame.on("keydown",function(S){if(O.stage&&O.enabled&&!O.animating&&(O.zimAccessibility&&O.focus||!O.zimAccessibility&&O.keyFocus)){var F=t.loop(e.items2D,function(B,N){var re=t.loop(B,function(le,G){if(le==Q)return[G,N]});if(Array.isArray(re))return re});F===!0&&(F=[0,0]);var h=e.items2D[F[1]].length,b=e.items2D.length,ye;S.keyCode=="39"?(ye=(F[0]+1)%h,u(e.items2D[F[1]][ye],ye<F[0])):S.keyCode=="37"?(ye=(F[0]-1+h)%h,u(e.items2D[F[1]][ye],ye>F[0])):S.keyCode=="38"?(ye=(F[1]-1+b)%b,u(e.items2D[ye][F[0]],ye>F[1])):S.keyCode=="40"&&(ye=(F[1]+1)%b,u(e.items2D[ye][F[0]],ye<F[1]))}})}),Object.defineProperty(this,"selectedIndex",{get:function(){return I},set:function(S){n(S)&&(O.currentItem=null),O.currentItem=e.items[Math.round(S)]}}),Object.defineProperty(this,"text",{get:function(){return Q.text},set:function(){dt&&tt("Selector() - text is read only")}}),Object.defineProperty(this,"currentItem",{get:function(){return Q},set:function(S){if(n(S)){Q=null,I=null,U.visible=!1,O.selectedCol=null,O.selectedRow=null;return}U.visible=!0,O.lastItem=Q,O.lastIndex=I,O.lastCol=O.selectedCol,O.lastRow=O.selectedRow,O.selectedCol=S.tileCol,O.selectedRow=S.tileRow,I=S.tileNum,Q=S,u(Q,null,null,!0)}}),this._enabled=!0,Object.defineProperty(O,"enabled",{get:function(){return O._enabled},set:function(S){S?O.mouse():O.noMouse(),O._enabled=S}}),j.KEYFOCUS!=null&&(t.KEYFOCUS=j.KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return t.KEYFOCUS==O},set:function(){t.KEYFOCUS=O}}),t.KEYFOCUS||o(),this.on("mousedown",function(){o()});function o(){O.keyFocus=!0;var S=document.activeElement;S&&S.blur()}E!==!1&&t.styleTransforms(this,Y),this.clone=function(S){if(S)for(var F=[],h=0;h<O.tile.items.length;h++)F.push(O.tile.items[h].clone(!0));return O.cloneProps(new t.Selector(S?t.series(F):e.clone?e.clone():e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,this.style,this.group))},this.dispose=function(S,F,h){O.keyEvent&&O.stage&&O.stage.frame.off("keydown",O.keyEvent),e.off(O.tileDown),e.dispose(),x&&(e.off(O.tileMove),e.off(O.tileUp)),h||this.zimContainer_dispose(!0)}},t.extend(t.Selector,t.Container,["clone","dispose"],"zimContainer",!1),t.Dial=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O,X,R,Q,K,q,ne,U,D,d,u,o,S,F,h,b){var ye="min, max, step, width, backgroundColor, indicatorColor, indicatorScale, indicatorType, useTicks, innerTicks, tickColor, tickStep, semiTicks, tickScale, semiTickScale, innerCircle, innerScale, innerColor, inner2Color, accentSize, accentOffset, accentColor, accentBackgroundColor, accentDifference, sound, linear, gap, limit, keyArrows, keyArrowsStep, keyArrowsH, keyArrowsV, continuous, continuousMin, continuousMax, damp, currentValue, useLabels, labelMargin, style, group, inherit",B;if(B=st(t.Dial,arguments,ye,this))return B;De("63"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Dial",this.group=h;var N=F===!1?{}:t.getStyle(this.type,this.group,b);if(n(e)&&(e=N.min!=null?N.min:0),n(r)&&(r=N.max!=null?N.max:10),r-e==0){tt("ZIM Dial range must not be 0");return}n(k)&&(k=N.sound!=null?N.sound:!1),n(i)&&(i=N.step!=null?N.step:k?0:1),n(l)&&(l=N.width!=null?N.width:100),n(a)&&(a=N.backgroundColor!=null?N.backgroundColor:t.granite),n(s)&&(s=N.indicatorColor!=null?N.indicatorColor:k?t.white:t.licorice),n(f)&&(f=N.indicatorScale!=null?N.indicatorScale:1),n(c)&&(c=N.indicatorType!=null?N.indicatorType:k?"aztec":"arrow"),n(w)&&(w=N.useTicks!=null?N.useTicks:i!=0),n(T)&&(T=N.innerTicks!=null?N.innerTicks:!1),n(x)&&(x=N.tickStep!=null?N.tickStep:i||(w?.25:0)),n(P)&&(P=N.semiTicks!=null?N.semiTicks:k?3:0),n(p)&&(p=N.tickColor!=null?N.tickColor:k?t.tin:a),n(m)&&(m=N.tickScale!=null?N.tickScale:k?1.25:1),n(v)&&(v=N.semiTickScale!=null?N.semiTickScale:1.25),n(I)&&(I=N.innerCircle!=null?N.innerCircle:!0),n(E)&&(E=N.innerColor!=null?N.innerColor:k?t.pink:"rgba(0,0,0,.2)"),n(A)&&(A=N.inner2Color!=null?N.inner2Color:k?t.light:"rgba(0,0,0,.1)"),n(g)&&(g=N.innerScale!=null?N.innerScale:k?.4:.5),n(y)&&(y=N.accentSize!=null?N.accentSize:k?l/2*.15:0),n(C)&&(C=N.accentOffset!=null?N.accentOffset:l/2*.45),n(_)&&(_=N.accentDifference!=null?N.accentDifference:-.25),n(L)&&(L=N.accentColor!=null?N.accentColor:t.pink),n(Y)&&(Y=N.accentBackgroundColor!=null?N.accentBackgroundColor:k?t.blue:t.clear),n(O)&&(O=N.gap!=null?N.gap:k?.25:0),n($)&&($=N.linear!=null?N.linear:k),O&&($=!0,ne=!1),n(X)&&(X=N.limit!=null?N.limit:!0),n(R)&&(R=N.keyArrows!=null?N.keyArrows:!0),n(Q)&&(Q=N.keyArrowsStep!=null?N.keyArrowsStep:(r-e)/100),n(K)&&(K=N.keyArrowsH!=null?N.keyArrowsH:!0),n(q)&&(q=N.keyArrowsV!=null?N.keyArrowsV:!0),n(ne)&&(ne=N.continuous!=null?N.continuous:!1),ne&&(X=N.limit!=null?N.limit:!1),n(d)&&(d=N.damp!=null?N.damp:!1),n(u)&&(u=N.currentValue!=null?N.currentValue:!1),n(o)&&(o=N.useLabels!=null?N.useLabels:!1),n(S)&&(S=N.labelMargin!=null?N.labelMargin:10),X==!1&&(d=null);var re=this;this.cur("pointer");var le=G(e,r,i,u);this.veeObj={min:le[0],max:le[1],step:le[2],currentValue:le[3]};function G(){return arguments}e=t.Pick.choose(e),r=t.Pick.choose(r),i=t.Pick.choose(i);var z=i;u=t.Pick.choose(u);var se=l/2,Oe=l,J=e,pe=0,Z;if(y){var de=l/2+C+y/2,V=360*O/2;re.accentBacking=new t.Shape(-se,-se,se*2,se*2).addTo(this).s(Y).ss(y+_).a(0,0,de,(V-90)*t.RAD,(360-V-90)*t.RAD),Z=re.accent=new t.Shape(-se,-se,se*2,se*2).addTo(this)}function fe(){Z.c().s(L).ss(y),$?Z.a(0,0,de,(V-90)*t.RAD,(Le.rotation-V*2)*t.RAD):Z.a(0,0,de,(V-90)*t.RAD,(Le.rotation-90)*t.RAD)}var ke=this.backing=new t.Circle(se,a,null,null,null,null,null,null,!1);if(y?ke.center(this):this.addChild(ke),I){var oe=this.inner=new t.Circle(se*g,E,null,null,null,null,null,null,!1);this.addChild(oe);var Ce=this.inner2=new t.Circle(se*(g-.1),A,null,null,null,null,null,null,!1);this.addChild(Ce)}k&&(re.rotation=180);var Me=Math.abs(r-e)/(x||i)+(O?1:0),te=i?Math.abs(r-e)/i:0;if(w){var ae=this.ticks=new t.Container({style:!1});if(this.addChild(ae),o)var we=re.labels=new t.Container(l*2,Oe*2).centerReg(re);for(var ue=0;ue<Me;ue++){var Pe=ue%(P+1)==0,ie=new t.Rectangle(1,se*(Pe?.2*m:.1*v),p,null,null,null,null,null,null,!1);if(ie.regY=se+(T?g-.05:ie.height+se*.1),ie.regX=.5,ie.rotation=(360-360*O)/(Me-(O?1:0))*ue+360*O/2,ae.addChild(ie),o&&(P&&Pe||!P)){var be=Math.max(t.countDecimals(z),t.countDecimals(e),t.countDecimals(r));new t.Label({text:t.decimals(e+(r-e)/Math.abs(te)*ue,be+1),size:N.size?N.size:10,align:"center",valign:"center"}).centerReg({add:!1}).loc(0,-S-1,ie).addTo(we)}}re.expand(ie.height)}this.setBounds(-se,-se,l,l);var Le,me;if(c=="dot"||c=="circle")Le=this.indicator=new t.Container({style:!1}),me=this.indicatorShape=new t.Circle(se*.19,s,null,null,null,null,null,null,!1),Le.addChild(me),t.sca(Le,f),Le.regY=se-Le.getBounds().width*f/2-se*.07;else if(c=="line"||c=="rectangle")Le=this.indicator=new t.Container({style:!1}),me=this.indicatorShape=new t.Rectangle(se*.1,se*.3,s,null,null,null,null,null,null,null,null,!1),Le.addChild(me),t.sca(Le,f),Le.regY=se-Le.getBounds().width*f/2-se*.07,Le.regX=se*.05;else if(c=="aztec"){Le=this.indicator=new t.Container({style:!1});var ee=se*.05,Ie=se*.1,Re=se*.42;me=this.indicatorShape=new t.Shape(-Ie,0,Ie*2,Re).f(s).mt(-ee,0).lt(ee,0).lt(Ie,Re).lt(-Ie,Re).cp(),Le.addChild(me),t.sca(Le,f),Le.regY=se-Le.getBounds().width*f/2-se*.04}else Le=this.indicator=new t.Container({style:!1}),me=this.indicatorShape=new t.Triangle(se*.4,se*.4,se*.4,s,null,null,null,null,null,null,null,!1),Le.addChild(me),t.sca(Le,f),Le.regY=se-Le.getBounds().height*f*(T?.85:.75),T&&(me.rotation=180);Le.regY/=f,this.addChild(Le);function _e(Qe){return i==0?Qe:Math.round(Qe/i)*i}var Ze,at,Be,He,et=0;if(ne)var ge=0,xe=0,he=0,Ge=!1,qe=!1,Fe=!0;if($)this.on("mousedown",function(Qe){if(!(re.zimAccessibility&&re.zimAccessibility.aria)){var ot=Ze=Le.rotation,ft=re.parent.globalToLocal(Qe.stageX/t.scaX,Qe.stageY/t.scaY);Be=re.on("pressmove",function(ut){var ze=re.parent.globalToLocal(ut.rawX/t.scaX,ut.rawY/t.scaY);Le.rotation=ot=Ze+(ft.y-ze.y)*100/(this.width||1),X&&(ot>360-360*O/2||ot<0+360*O/2)&&(ot=t.constrain(ot,360*O/2,360-360*O/2),ft=re.parent.globalToLocal(ut.rawX/t.scaX,ut.rawY/t.scaY),Ze=ot),Se(ot)}),He=this.on("pressup",function(){re.off("pressmove",Be),re.off("pressup",He)})}});else{var We=!0;this.on("mousedown",function(Qe){if(!(re.zimAccessibility&&re.zimAccessibility.aria)){Ze=Le.rotation;var ot=re.parent.globalToLocal(Qe.stageX/t.scaX,Qe.stageY/t.scaY),ft=ot.x-re.x,ut=re.y-ot.y;at=Math.atan2(ft,ut)*180/Math.PI;var ze=new Date().getTime();Be=re.on("pressmove",function(kt){if(Ge){var Mt=re.parent.globalToLocal(kt.rawX/t.scaX,kt.rawY/t.scaY),xt=Mt.x-re.x,Yt=re.y-Mt.y;at=Math.atan2(xt,Yt)*180/Math.PI,Ze=Le.rotation}Mt=re.parent.globalToLocal(kt.rawX/t.scaX,kt.rawY/t.scaY),xt=Mt.x-re.x,Yt=re.y-Mt.y;var Dt=Math.atan2(xt,Yt)*180/Math.PI,Ht=Ze+Dt-at;Ht=(Ht+360*1e4)%360,X&&We&&(Ht-et>180&&re.currentValue!=r?Ht=0:Ht-et<-180&&(Ht=359)),We=!0,Se(Ht),et=Ht}),He=this.on("pressup",function(kt){re.currentValue!=re.min&&re.currentValue!=re.max&&(We=!1);var Mt=new Date().getTime()-ze;if(Mt<200){ot=re.parent.globalToLocal(kt.rawX/t.scaX,kt.rawY/t.scaY),ft=ot.x-re.x,ut=re.y-ot.y;var xt=Math.atan2(ft,ut)*180/Math.PI-re.rotation;Se(xt)}Ze=Le.rotation,re.off("pressmove",Be),re.off("pressup",He)})}})}function ce(Qe){return Qe>0?1:-1}function Ve(){re.zimAccessibility&&re.zimAccessibility.changeTitle(re,null,!0)}function Se(Qe){if(ne){qe&&(ge=Qe,qe=!1),Qe>ge+180?he-=360:Qe<ge-180&&(he+=360),xe=he+Qe,Fe=!1;var ot=re.currentValue;return re.currentValue=_e(xe*(r-e)/360),ot!=re.currentValue&&re.dispatchEvent("change"),ge=Qe,Fe=!0,Z&&fe(),!0}var ft;Qe<0&&(Qe+=360),Qe=Qe%360,i!=0?(Qe=Math.min(Qe,360),ft=_e((Qe-360*O/2)/(360-360*O)*(r-e)),Le.rotation=360*O/2+ft*(360-360*O)/(r-e)):(Le.rotation=Qe,ft=(Qe-360*O/2)/(360-360*O)*(r-e)),ft!=pe&&(pe=ft,J=ft+e,Z&&fe(),re.dispatchEvent("change"),!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&re.stage&&re.stage.update()),Ve()}var Ae,Ye;d&&(Ae=e,Ye=new t.Damp(Ae,d),re.ticker=t.Ticker.add(function(){Ae=Ye.convert(J)})),Object.defineProperty(this,"currentValue",{get:function(){return d?Ae:J},set:function(Qe){n(Qe)||(ne?(Ge=!1,!n(U)&&!n(D)?U<D?(Qe<U&&(Qe=U,Ge=!0),Qe>D&&(Qe=D,Ge=!0)):(Qe>U&&(Qe=U,Ge=!0),Qe<D&&(Qe=D,Ge=!0)):n(U)?n(D)||Qe>D&&(Qe=D,Ge=!0):Qe<U&&(Qe=U,Ge=!0),Fe&&(qe=!0,he=Math.floor(Qe/(r-e))*360)):e<r?(Qe<e&&(Qe=X?e:r),Qe>r&&(Qe=X?r:e)):(Qe>e&&(Qe=X?e:r),Qe<r&&(Qe=X?r:e)),J=Qe,Qe=_e(Qe),d&&d.immediate(J),Le.rotation=O*360/2+(Qe-e)*(360-O*360)/(r-e),Le.rotation=(Le.rotation+360*1e4)%360,pe=Qe-e,et=Le.rotation,Z&&fe(),Ve(),!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&re.stage&&re.stage.update())}}),Object.defineProperty(this,"currentValueEvent",{get:function(){return d?Ae:J},set:function(Qe){Qe!=re.currentValue&&(re.currentValue=Qe,re.dispatchEvent("change"))}}),Object.defineProperty(this,"min",{get:function(){return e},set:function(Qe){ne?e=Qe:dt&&tt("Dial() - min is read only")}}),Object.defineProperty(this,"max",{get:function(){return r},set:function(Qe){ne?r=Qe:dt&&tt("Dial() - max is read only")}}),Object.defineProperty(this,"continuous",{get:function(){return ne},set:function(){dt&&tt("Dial() - continuous is read only")}}),Object.defineProperty(this,"continuousMin",{get:function(){return U},set:function(Qe){U=Qe,re.currentValue<U&&(re.currentValue=U)}}),Object.defineProperty(this,"continuousMax",{get:function(){return D},set:function(Qe){D=Qe,re.currentValue>D&&(re.currentValue=D)}}),Object.defineProperty(this,"step",{get:function(){return i},set:function(){dt&&tt("Dial() - step is read only")}}),Object.defineProperty(this,"keyArrowsH",{get:function(){return K},set:function(Qe){K=Qe}}),Object.defineProperty(this,"keyArrowsV",{get:function(){return q},set:function(Qe){q=Qe}}),j.KEYFOCUS!=null&&(t.KEYFOCUS=j.KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return t.KEYFOCUS==re},set:function(){t.KEYFOCUS=re}}),R&&!t.KEYFOCUS&&Xe(),this.on("mousedown",function(){R&&Xe()});function Xe(){re.keyFocus=!0;var Qe=document.activeElement;Qe&&Qe.blur()}var Ue=!1,rt=!1,Te=!1,$e=!1;this.keyDownEvent=function(Qe){re.stage&&(re.zimAccessibility&&re.focus||!re.zimAccessibility&&re.keyFocus)&&(Qe.keyCode==37&&K?Ue=!0:Qe.keyCode==40&&q?rt=!0:Qe.keyCode==39&&K?Te=!0:Qe.keyCode==38&&q&&($e=!0),re.keyInterval==null&&(Ue||rt||Te||$e)&&(lt(),re.keyTimeout=setTimeout(function(){re.keyInterval==null&&(Ue||rt||Te||$e)&&(re.keyInterval=setInterval(lt,40))},140)))};function lt(){(Ue||rt)&&(i>0?re.currentValueEvent-=i*ce(r-e):re.currentValueEvent-=Q*ce(r-e)),(Te||$e)&&(i>0?re.currentValueEvent+=i*ce(r-e):re.currentValueEvent+=Q*ce(r-e))}j.addEventListener("keydown",this.keyDownEvent),re.keyUpEvent=function(Qe){Qe.keyCode==37?Ue=!1:Qe.keyCode==40?rt=!1:Qe.keyCode==39?Te=!1:Qe.keyCode==38&&($e=!1),re.keyInterval!=null&&!Ue&&!rt&&!Te&&!$e&&(clearInterval(re.keyInterval),re.keyInterval=null)},j.addEventListener("keyup",this.keyUpEvent),this._enabled=!0,Object.defineProperty(re,"enabled",{get:function(){return re._enabled},set:function(Qe){Qe?(j.addEventListener("keydown",re.keyDownEvent),j.addEventListener("keyup",re.keyUpEvent)):(j.removeEventListener("keydown",re.keyDownEvent),j.removeEventListener("keyup",re.keyUpEvent)),re._enabled=Qe}}),n(u)&&(u=N.currentValue!=null?N.currentValue:e),re.currentValue=u,F!==!1&&t.styleTransforms(this,N),this.clone=function(Qe){return re.cloneProps(new t.Dial(Qe||!t.isPick(le[0])?re.min:le[0],Qe||!t.isPick(le[1])?re.max:le[1],Qe||!t.isPick(le[2])?re.step:le[2],l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O,X,R,Q,K,q,ne,U,D,d,Qe||!t.isPick(le[3])?re.currentValue:le[3],o,S,F,this.group,b))},this.dispose=function(Qe,ot,ft){return j.removeEventListener("keydown",re.keyDownEvent),j.removeEventListener("keyup",re.keyUpEvent),ft||this.zimContainer_dispose(!0),!0}},t.extend(t.Dial,t.Container,["clone","dispose"],"zimContainer",!1),t.Tabs=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O,X,R,Q,K,q,ne,U,D,d,u,o,S,F,h,b,ye,B,N,re,le,G,z){var se="width, height, tabs, backgroundColor, rollBackgroundColor, downBackgroundColor, selectedBackgroundColor, selectedRollBackgroundColor, color, rollColor, downColor, selectedColor, selectedRollColor, vertical, spacing, currentEnabled, currentSelected, corner, base, keyEnabled, gradient, gloss, backing, rollBacking, wait, waitTime, waitBackgroundColor, rollWaitBackgroundColor, waitColor, rollWaitColor, waitModal, waitEnabled, backdropColor, align, valign, labelAlign, labelValign, labelIndent, labelIndentH, labelIndentV, indent, useTap, excludeCustomTap, selectedIndex, styleLabels, keyWrap, style, group, inherit",Oe;if(Oe=st(t.Tabs,arguments,se,this))return Oe;De("65");var J=le===!1?{}:t.getStyle("Tabs",G,z);n(m)&&(m=J.vertical!=null?J.vertical:!1),n(e)&&(e=J.width!=null?J.width:null);var pe=!n(e);if(n(e)&&(e=m?60:240),n(r)&&(r=J.height!=null?J.height:m?240:60),this.zimContainer_constructor(null,null,null,null,!0),this.type="Tabs",this.group=G,(n(i)||i.length<=0)&&(i=J.tabs!=null?J.tabs:[1,2,3,4]),n(l)&&(l=J.backgroundColor!=null?J.backgroundColor:t.tin),n(a)&&(a=J.rollBackgroundColor!=null?J.rollBackgroundColor:t.grey),n(s)&&(s=J.downBackgroundColor!=null?J.downBackgroundColor:a),n(f)&&(f=J.selectedBackgroundColor!=null?J.selectedBackgroundColor:t.dark),n(c)&&(c=J.selectedRollBackgroundColor!=null?J.selectedRollBackgroundColor:a),n(w)&&(w=J.color!=null?J.color:t.white),n(T)&&(T=J.rollColor!=null?J.rollColor:w),n(p)&&(p=J.downColor!=null?J.downColor:T),n(x)&&(x=J.selectedColor!=null?J.selectedColor:w),n(P)&&(P=J.selectedRollColor!=null?J.selectedRollColor:T),n(Y)&&(Y=J.backing!=null?J.backing.clone():null),n(_)&&(_=J.rollBacking!=null?J.rollBacking.clone():null),n(U)&&(U=J.align!=null?J.align:"center"),n(D)&&(D=J.valign!=null?J.valign:"center"),n(d)&&(d=J.labelAlign!=null?J.labelAlign:U),n(u)&&(u=J.labelValign!=null?J.labelValign:D),n(h)&&(h=J.indent!=null?J.indent:10),n(o)&&(o=J.labelIndent!=null?J.labelIndent:h),n(S)&&(S=J.labelIndentH!=null?J.labelIndentH:o),n(F)&&(F=J.labelIndentV!=null?J.labelIndentV:o),n(I)&&(I=J.currentEnabled!=null?J.currentEnabled:!1),n(g)&&(g=J.currentSelected!=null?J.currentSelected:!0),g||(I=!0),n(v)&&(v=J.spacing!=null?J.spacing:1),n(E)&&(E=J.corner!=null?J.corner:0),n(C)&&(C=J.gradient!=null?J.gradient:null),n(L)&&(L=J.gloss!=null?J.gloss:null),n(A)&&(A=J.base!=null?J.base:E==0&&!Array.isArray(E)?"none":m?"left":"bottom"),n(y)&&(y=J.keyEnabled!=null?J.keyEnabled:!0),n(b)&&(b=J.useTap!=null?J.useTap:!1),n(ye)&&(ye=J.excludeCustomTap!=null?J.excludeCustomTap:!1),n(ne)&&(ne=J.backdropColor!=null?J.backdropColor:null),n(N)&&(N=J.styleLabels!=null?J.styleLabels:!1),n(re)&&(re=J.keyWrap!=null?J.keyWrap:!0),A!="none"&&E!=0&&!Array.isArray(E))switch(A){case"bottom":E=[E,E,0,0];break;case"left":E=[0,E,E,0];break;case"top":E=[0,0,E,E];break;case"right":E=[E,0,0,E];break}else Array.isArray(E)||(E=[E,E,E,E]);var Z=this;this.keyEnabled=y;var de=0,V=[],fe=[],ke,oe,Ce=i.length,Me=(e-v*(Ce-1))/Ce,te=(r-v*(Ce-1)-2)/Ce;if(!n(ne)){var ae=this.backdrop=new t.Rectangle(e,r,ne,null,null,null,null,null,null,!1);this.addChild(ae)}var we=!1,ue;function Pe(xe){for(var he=0;he<xe.length;he++){var Ge=xe[he];if(Ge.constructor==={}.constructor){ue&&ue!="TabObject"&&(we=!0),ue="TabObject",Ge.type="TabObject";continue}typeof Ge=="string"||typeof Ge=="number"||Ge.type=="Label"?(xe[he]={type:"TabObject",label:String(Ge!=null)||Ge.type=="Label"?Ge:"1"},ue&&ue!="TabObject"&&(we=!0),ue="TabObject"):(ue&&ue=="TabObject"&&(we=!0),ue="Other")}}Pe(i);for(var ie=0,be,Le=0,me=0;me<i.length;me++)oe=i[me],m?pe&&(oe.width=oe.width?oe.width:e):(n(oe.width)&&Le++,ie+=n(oe.width)?Me:oe.width);if(!m){if(ie>e-v*(Ce-1))for(me=0;me<i.length;me++)oe=i[me],oe.width=(e-v*(Ce-1))/ie*(n(oe.width)?Me:oe.width);else if(Math.round(ie)<Math.round(e-v*(Ce-1))&&Le>0)for(be=(Ce*Me-(ie-Le*Me))/Le,me=0;me<i.length;me++)oe=i[me],oe.width=n(oe.width)?be:oe.width}function ee(xe,he){for(me=0;me<xe.length;me++)oe=xe[me],oe!=""&&oe.type=="TabObject"&&(n(oe.label)&&(oe.label=" "),(typeof oe.label=="string"||typeof oe.label=="number")&&(oe.label=new t.Label({text:oe.label,size:J.size!=null?J.size:m?te/2:r/2,font:J.font!=null?J.font:null,style:N,valign:u,inherit:he})))}ee(i,N?J:null);var Ie=0;for(me=0;me<i.length;me++)oe=i[me],!oe.width&&m&&oe.label.width>Ie&&(Ie=oe.label.width);var Re=0;function _e(xe,he){var Ge=[],qe=[];for(me=0;me<xe.length;me++){if(oe=xe[me],oe.type=="TabObject"){var Fe={color:n(oe.color)?t.Pick.choose(w):oe.color,rollColor:n(oe.rollColor)?t.Pick.choose(T):oe.rollColor,downColor:n(oe.downColor)?t.Pick.choose(p):oe.downColor,selectedColor:n(oe.selectedColor)?t.Pick.choose(x):oe.selectedColor,selectedRollColor:n(oe.selectedRollColor)?t.Pick.choose(P):oe.selectedRollColor,backgroundColor:n(oe.backgroundColor)?t.Pick.choose(l):oe.backgroundColor,rollBackgroundColor:n(oe.rollBackgroundColor)?t.Pick.choose(a):oe.rollBackgroundColor,downBackgroundColor:n(oe.downBackgroundColor)?t.Pick.choose(s):oe.downBackgroundColor,selectedBackgroundColor:n(oe.selectedBackgroundColor)?t.Pick.choose(f):oe.selectedBackgroundColor,selectedRollBackgroundColor:n(oe.selectedRollBackgroundColor)?t.Pick.choose(c):oe.selectedRollBackgroundColor,wait:n(oe.wait)?t.Pick.choose(k):oe.wait};if(he)for(var We in he)n(he[We])||(Fe[We]=he[We]);ke=new t.Button({width:m?n(oe.width)?pe?e:Ie+te/2+E[0]/2:oe.width:n(oe.width)?Me:oe.width,height:m?te:r,label:oe.label,borderColor:J.borderColor!=null?J.borderColor:null,borderWidth:J.borderWidth!=null?J.borderWidth:null,backgroundColor:Fe.backgroundColor,rollBackgroundColor:Fe.rollBackgroundColor,downBackgroundColor:Fe.downBackgroundColor,downColor:Fe.downColor,corner:E,shadowColor:-1,gradient:C,gloss:L,backing:Y?Y.clone():null,rollBacking:_?_.clone():null,wait:Fe.wait,waitTime:n(oe.waitTime)?$:oe.waitTime,waitBackgroundColor:n(oe.waitBackgroundColor)?O:oe.waitBackgroundColor,rollWaitBackgroundColor:n(oe.rollWaitBackgroundColor)?X:oe.rollWaitBackgroundColor,waitColor:n(oe.waitColor)?R:oe.waitColor,rollWaitColor:n(oe.rollWaitBackgroundColor)?Q:oe.rollWaitColor,waitModal:n(oe.waitModal)?K:oe.waitModal,waitEnabled:n(oe.waitEnabled)?q:oe.waitEnabled,align:d,valign:u,indentH:S,indentV:F,inherit:t.copy(J)}),ke.tabInfo=Fe,ke.color=ke.tabInfo.color,ke.rollColor=ke.tabInfo.rollColor,ke.type="TabsButton",ke.content=oe,ke.listIndentReady=!0}else{if(oe.listIndentReady)ke=oe;else{ke=new t.Container,ke.type=oe.type,ke.content=oe;for(var ce=["text","backing","label","slider","stepper","checkBox","colorPicker","swatch","colorLabel"],Ve=0;Ve<ce.length;Ve++)oe[ce[Ve]]&&(ke[ce[Ve]]=oe[ce[Ve]])}oe.checkBox&&(ke.checkBox=oe.checkBox),n(ke.tabInfo)&&(ke.tabInfo={}),ye&&(ke.excludeTap=!0),ke.tabInfo.color=n(oe.color)?w:oe.color,ke.tabInfo.backgroundColor=n(oe.backgroundColor)?l:oe.backgroundColor,oe.listIndentReady||(new t.Rectangle(Math.max(oe.width,m?pe?e:Ie+te/2+E[0]/2:oe.width),Math.max(oe.height,m?te:r),t.clear).addTo(ke).expand(0).cur(),oe.center(ke).cur(),U=="center"||U=="middle"||oe.pos(0,null,U=="right"),D=="center"||D=="middle"||oe.pos(null,0,null,D=="bottom"),ke.listIndentReady=!0)}ke.width>Re&&(Re=ke.width),b?ke.tap(function(Se){Be(Se.currentTarget.znum),Z.dispatchEvent("change"),!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&Z.stage&&Z.stage.update()}):ke.zimTabEvent=ke.on((Pt?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",function(Se){Be(Se.currentTarget.znum),Z.dispatchEvent("change"),!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&Z.stage&&Z.stage.update()}),ke.on("mousedown",function(Se){Z.buttonDown=Se.currentTarget}),ke.on("pressup",function(Se){Z.buttonDown=null;var Ae=Se.currentTarget.znum;b||t.ACTIONEVENT=="click"?setTimeout(function(){He(Ae)},50):He(Ae)}),qe.push(oe.label),Ge.push(ke),ke.index=me}return[Ge,qe]}var Ze=_e(i);fe=Ze[0],V=Ze[1];function at(){var xe=0,he=0,Ge;for(me=0;me<fe.length;me++)Ge=fe[me],Ge.znum=me,Ge.selectedIndex=me,Ge.selectedIndex==de&&g&&(Ge.backgroundColor=f,Ge.rollBackgroundColor=c,Ge.color=x),V[me]&&(V[me].znum=me),Z.addChild(Ge),(!m||pe)&&(Ge.x=(e-Ge.width)/2,Ge.y=(r-Ge.height)/2),m?(Ge.y=he,he=Ge.y+Ge.height+v,U=="left"?Ge.x=(Ge.type=="TabsButton"||Ge.type=="ListItem"?0:h)+(Ge.regX-(Ge.getBounds()?Ge.getBounds().x:0))*Ge.scaleX:U=="right"&&(Ge.x=(pe?e:Re)-Ge.width-(Ge.type=="TabsButton"||Ge.type=="ListItem"?0:h))):(Ge.x=xe,xe=Ge.x+Ge.width+v,D=="top"?Ge.y=(Ge.type=="TabsButton"&&!we?0:h)+(Ge.regY-(Ge.getBounds()?Ge.getBounds().y:0))*Ge.scaleY:D=="bottom"&&(Ge.y=r-Ge.height-(Ge.type=="TabsButton"&&!we?0:h))),me==de&&!I?Ge.enabled=!1:Ge.enabled=!0;n(ne)||Z.removeChild(ae),Z._bounds=null;var qe=Z.getBounds(),Fe=0,We=0;if(!qe&&Ne.EaselJS.version[0]!=0?Z.setBounds():qe&&(Fe=m&&qe.width!=0&&pe?e:qe.width,We=m&&qe.height!=0?qe.height:r,Z.setBounds(Fe,We)),n(ne)||(ae.widthOnly=Fe,ae.heightOnly=We,Z.addChildAt(ae,0)),m&&!pe)for(me=0;me<=fe.length;me++)(U=="center"||U=="middle")&&(Ge.x=(Fe-Ge.width)/2)}at();function Be(xe,he){if(xe!=de){var Ge=fe[de];if(Ge&&g&&(Ge.tabInfo&&n(Ge.tabInfo.wait)&&(Ge.tabInfo.backgroundColor&&(Ge.backgroundColor=Ge.tabInfo.backgroundColor),Ge.tabInfo.rollBackgroundColor&&(Ge.rollBackgroundColor=Ge.tabInfo.rollBackgroundColor),Ge.tabInfo.color&&Ge.label&&(Ge.color=Ge.tabInfo.color),Ge.tabInfo.rollColor&&Ge.label&&(Ge.rollColor=Ge.tabInfo.rollColor)),I||(Ge.enabled=!0)),de=xe,Ge=fe[de],Ge){var qe=Ge.tabInfo;qe&&n(Ge.tabInfo.wait)&&g&&(qe.selectedBackgroundColor&&(Ge.backgroundColor=!n(qe.downBackgroundColor)&&!he?qe.downBackgroundColor:qe.selectedBackgroundColor),qe.selectedRollBackgroundColor&&(Ge.rollBackgroundColor=qe.selectedRollBackgroundColor),qe.selectedColor&&Ge.label&&(Ge.color=!n(qe.downColor)&&!he?qe.downColor:qe.selectedColor),qe.selectedRollColor&&Ge.label&&(Ge.rollColor=qe.selectedRollColor)),he&&!I&&(Ge.enabled=!1)}}}function He(xe){var he=fe[xe];if(he&&g){var Ge=he.tabInfo;Ge&&n(Ge.wait)&&(Ge.selectedBackgroundColor&&(he.backgroundColor=Z.selected==he?Ge.selectedBackgroundColor:Ge.backgroundColor),Ge.selectedColor&&he.label&&(he.color=Z.selected==he?Ge.selectedColor:Ge.color)),I||(he.enabled=!1)}}this.addAt=function(xe,he,Ge){n(he)&&(he=fe.length),he=t.constrain(he,0,fe.length),Array.isArray(xe)||(xe=[xe]),Pe(xe),ee(xe,Ge);var qe=_e(xe,Ge),Fe=qe[0],We=qe[1];he<=de&&(de+=Fe.length);var ce=[he,0].concat(Fe);return Array.prototype.splice.apply(fe,ce),ce=[he,0].concat(We),Array.prototype.splice.apply(V,ce),at(),Z},this.removeAt=function(xe,he){if(fe.length==0)return Z;for(n(xe)&&(xe=1),n(he)&&(he=fe.length-xe),he=t.constrain(he,0,fe.length-xe),de>=he&&de<=he+xe&&(de=-1),de>he+xe&&(de-=xe),me=he;me<he+xe;me++)fe[me].tabInfo&&(fe[me].tabInfo.backgroundColor&&(fe[me].backgroundColor=fe[me].tabInfo.backgroundColor),fe[me].tabInfo.color&&fe[me].label&&(fe[me].color=fe[me].tabInfo.color)),b?fe[me].noTap():fe[me].off((Pt?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",fe[me].zimTabEvent),fe[me].removeFrom();return fe.splice(he,xe),V.splice(he,xe),at(),Z},Z.keyEvent=function(xe){if(!(!Z.keyEnabled||!Z.keyFocus||Z.zimAccessibility)&&xe.keyCode==9){var he=de;xe.shiftKey?Be(--he<0?re?i.length-1:0:he):Be(++he>i.length-1?re?0:i.length-1:he),Z.dispatchEvent("change"),Z.dispatchEvent("keychange"),!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&Z.stage&&Z.stage.update(),xe.preventDefault()}},j.addEventListener("keydown",Z.keyEvent),Object.defineProperty(this,"selected",{get:function(){return fe[de]},set:function(){dt&&tt("Tabs() - selected is read only - try selectedIndex")}}),Object.defineProperty(this,"selectedIndex",{get:function(){return de},set:function(xe){Be(xe,!0),!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&Z.stage&&Z.stage.update()}}),this.last=function(){return this.selectedIndex=this.buttons.length-1,this},this.first=function(){return this.selectedIndex=0,this},Object.defineProperty(this,"tabs",{get:function(){return de},set:function(xe){Be(Math.min(Math.max(xe,0),i.length-1)),!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&Z.stage&&Z.stage.update()}}),Object.defineProperty(this,"color",{get:function(){return Z.buttons[0].tabItems?Z.buttons[0].tabItems.color:w},set:function(xe){if(w=xe,Z.buttons[0].tabInfo){for(var he=0;he<Z.buttons.length;he++)Z.buttons[he].tabInfo&&(Z.buttons[he].tabInfo.color=xe),(he!=de||!g)&&(Z.buttons[he].color=w);!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&Z.stage&&Z.stage.update()}}}),Object.defineProperty(this,"rollColor",{get:function(){return Z.buttons[0].tabItems?Z.buttons[0].tabItems.rollColor:T},set:function(xe){if(T=xe,Z.buttons[0].tabInfo){for(var he=0;he<Z.buttons.length;he++)Z.buttons[he].tabInfo&&(Z.buttons[he].tabInfo.rollColor=xe),Z.buttons[he].rollColor=T,he!=de&&Z.buttons[he].rolled&&(Z.buttons[he].color=T);!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&Z.stage&&Z.stage.update()}}}),Object.defineProperty(this,"selectedColor",{get:function(){return Z.buttons[0].tabItems?Z.buttons[0].tabItems.selectedColor:x},set:function(xe){if(x=xe,Z.buttons[0].tabInfo){for(var he=0;he<Z.buttons.length;he++)Z.buttons[he].tabInfo&&(Z.buttons[he].tabInfo.selectedColor=xe),he==de&&g&&(Z.buttons[he].color=x);!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&Z.stage&&Z.stage.update()}}}),Object.defineProperty(this,"selectedRollColor",{get:function(){return Z.buttons[0].tabItems?Z.buttons[0].tabItems.selectedRollColor:P},set:function(xe){if(P=xe,Z.buttons[0].tabInfo){for(var he=0;he<Z.buttons.length;he++)Z.buttons[he].tabInfo&&(Z.buttons[he].tabInfo.selectedRollColor=xe),he==de&&g&&Z.buttons[he].rolled&&(Z.buttons[he].color=P);!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&Z.stage&&Z.stage.update()}}}),Object.defineProperty(this,"backgroundColor",{get:function(){return Z.buttons[0].tabItems?Z.buttons[0].tabItems.backgroundColor:l},set:function(xe){if(l=xe,Z.buttons[0].tabInfo){for(var he=0;he<Z.buttons.length;he++)Z.buttons[he].tabInfo&&(Z.buttons[he].tabInfo.backgroundColor=xe),(he!=de||!g)&&(Z.buttons[he].backgroundColor=l);!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&Z.stage&&Z.stage.update()}}}),Object.defineProperty(this,"rollBackgroundColor",{get:function(){return Z.buttons[0].tabItems?Z.buttons[0].tabItems.rollBackgroundColor:a},set:function(xe){if(a=xe,Z.buttons[0].tabInfo){for(var he=0;he<Z.buttons.length;he++)Z.buttons[he].tabInfo&&(Z.buttons[he].tabInfo.rollBackgroundColor=xe),Z.buttons[he].rollBackgroundColor=a,he!=de&&Z.buttons[he].rolled&&(Z.buttons[he].backgroundColor=a);!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&Z.stage&&Z.stage.update()}}}),Object.defineProperty(this,"selectedBackgroundColor",{get:function(){return Z.buttons[0].tabItems?Z.buttons[0].tabItems.selectedBackgroundColor:f},set:function(xe){if(f=xe,Z.buttons[0].tabInfo){for(var he=0;he<Z.buttons.length;he++)Z.buttons[he].tabInfo&&(Z.buttons[he].tabInfo.selectedBackgroundColor=xe),he==de&&g&&(Z.buttons[he].backgroundColor=f);!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&Z.stage&&Z.stage.update()}}}),Object.defineProperty(this,"selectedRollBackgroundColor",{get:function(){return Z.buttons[0].tabItems?Z.buttons[0].tabItems.selectedRollBackgroundColor:c},set:function(xe){if(c=xe,Z.buttons[0].tabInfo){for(var he=0;he<Z.buttons.length;he++)Z.buttons[he].tabInfo&&(Z.buttons[he].tabInfo.selectedRollBackgroundColor=xe),he==de&&g&&Z.buttons[he].rolled&&(Z.buttons[he].backgroundColor=c);!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&Z.stage&&Z.stage.update()}}}),Object.defineProperty(this,"label",{get:function(){return V[de]},set:function(){dt&&tt("Tabs() - selected is read only - try selectedIndex")}}),Object.defineProperty(this,"text",{get:function(){return V[de]!=null?V[de].text:void 0},set:function(){dt&&tt("Tabs() - selected is read only - try selectedIndex")}}),Object.defineProperty(this,"buttons",{get:function(){return fe},set:function(){dt&&tt("Tabs() - buttons is read only")}}),Object.defineProperty(this,"labels",{get:function(){return V},set:function(){dt&&tt("Tabs() - labels is read only")}}),this._enabled=!0,Object.defineProperty(Z,"enabled",{get:function(){return Z._enabled},set:function(xe){bt(Z,xe)}}),j.KEYFOCUS!=null&&(t.KEYFOCUS=j.KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return t.KEYFOCUS==Z},set:function(){t.KEYFOCUS=Z}}),y&&t.KEYFOCUS&&et(),this.on("mousedown",function(){y&&et()});function et(){Z.keyFocus=!0;var xe=document.activeElement;xe&&xe.blur()}var ge=Z.getBounds();n(ge)||ge.width==0?Z.setBounds(0,0,e,r):Z.width=e,n(B)&&(B=J.selectedIndex!=null?J.selectedIndex:0),Z.selectedIndex=B,le!==!1&&t.styleTransforms(this,J),this.clone=function(){for(var xe=t.copy(i,!0),he=0;he<xe.length;he++)xe[he].label=xe[he].label.clone();return Z.cloneProps(new t.Tabs(e,r,xe,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O,X,R,Q,K,q,ne,U,D,d,u,o,S,F,h,b,ye,B,N,re,le,this.group,z))},this.doDispose=function(xe,he,Ge){Z.keyEvent&&j.removeEventListener("keydown",Z.keyEvent),t.loop(Z.buttons,function(qe){qe.dispose()}),Z.keyEvent=null,Ge||this.zimContainer_dispose(!0),g=oe=i=V=ke=fe=Ze=null}},t.extend(t.Tabs,t.Container,["clone","dispose"],"zimContainer",!1),t.Tabs.prototype.dispose=function(e){return this.doDispose(null,null,e)},t.Pad=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O,X,R,Q,K,q,ne,U,D){var d="width, cols, rows, keys, backgroundColor, rollBackgroundColor, downBackgroundColor, selectedBackgroundColor, selectedRollBackgroundColor, color, rollColor, downColor, selectedColor, selectedRollColor, spacing, currentEnabled, currentSelected, corner, labelColor, gradient, gloss, backing, rollBacking, wait, waitTime, waitBackgroundColor, rollWaitBackgroundColor, waitColor, rollWaitColor, waitModal, waitEnabled, selectedIndex, style, group, inherit",u;if(u=st(t.Pad,arguments,d,this))return u;De("66"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Pad",this.group=U;var o=ne===!1?{}:t.getStyle(this.type,this.group,D);n(e)&&(e=o.width!=null?o.width:150),n(r)&&(r=o.cols!=null?o.cols:3),n(i)&&(i=o.rows!=null?o.rows:r);var S;if(n(l))if(o.keys!=null)l=o.keys;else for(l=[],S=1;S<=i*r;S++)l.push(S);n(I)&&(I=o.currentEnabled!=null?o.currentEnabled:!0),n(v)&&(v=o.spacing!=null?o.spacing:1);var F=this,h;this.cols=r,this.rows=i;var b=e/r-v,ye=[],B=0,N;for(this.labels=[],this.buttons=[],S=0;S<i;S++){for(var re=[],le=0;le<r;le++)re.push(l[B]!=null?l[B]:""),B++;var G=o.corner!=null?o.corner:E;G&&!Array.isArray(G)&&(G=[G,G,G,G]),N=ye[S]=new t.Tabs({width:e,height:b,tabs:re,backgroundColor:o.backgroundColor!=null?o.backgroundColor:a,rollBackgroundColor:o.rollBackgroundColor!=null?o.rollBackgroundColor:s,downBackgroundColor:o.downBackgroundColor!=null?o.downBackgroundColor:f,selectedBackgroundColor:o.selectedBackgroundColor!=null?o.selectedBackgroundColor:c,color:o.color!=null?o.color:T,rollColor:o.rollColor!=null?o.rollColor:p,downColor:o.downColor!=null?o.downColor:x,selectedColor:o.selectedColor!=null?o.selectedColor:P,spacing:o.spacing!=null?o.spacing:v,currentEnabled:o.currentEnabled!=null?o.currentEnabled:I,currentSelected:o.currentSelected!=null?o.currentSelected:g,corner:G,backing:o.backing!=null?o.backing.clone():L,rollBacking:o.rollBacking!=null?o.rollBacking.clone():Y,base:null,keyEnabled:!1,gradient:o.gradient!=null?o.gradient:y,gloss:o.gloss!=null?o.gloss:C,wait:o.wait!=null?o.wait:_,waitTime:o.waitTime!=null?o.waitTime:k,waitBackgroundColor:o.waitBackgroundColor!=null?o.waitBackgroundColor:$,rollWaitBackgroundColor:o.rollWaitBackgroundColor!=null?o.rollWaitBackgroundColor:O,waitColor:o.waitColor!=null?o.waitColor:X,rollWaitColor:o.rollWaitColor!=null?o.rollWaitColor:R,waitModal:o.waitModal!=null?o.waitModal:Q,waitEnabled:o.waitEnabled!=null?o.waitEnabled:K,group:U,style:!1}),this.labels=this.labels.concat(N.labels),this.buttons=this.buttons.concat(N.buttons),this.addChild(N),N.selectedIndex=-1,N.y=(b+v)*S,N.znum=S,N.on("change",z)}this.tabs=ye;function z(se){var Oe=se.target;F.selected=Oe.selected,F.text=Oe.text,F.label=Oe.label;for(var J=Oe.selectedIndex,pe=0;pe<ye.length;pe++)Oe!=ye[pe]&&(ye[pe].selectedIndex=-1);h=Oe.znum*r+J,F.dispatchEvent("change"),!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&F.stage&&F.stage.update()}Object.defineProperty(this,"selectedIndex",{get:function(){return h},set:function(se){h=se;for(var Oe=0;Oe<ye.length;Oe++)ye[Oe].selectedIndex=-1;var J=Math.floor(h/r);J>=0&&J<F.tabs.length&&(F.tabs[J].selectedIndex=h%r)}}),this._enabled=!0,Object.defineProperty(F,"enabled",{get:function(){return F._enabled},set:function(se){bt(F,se)}}),n(q)&&(q=o.selectedIndex!=null?o.selectedIndex:0),F.selectedIndex=q,ne!==!1&&t.styleTransforms(this,o),this.clone=function(){return F.cloneProps(new t.Pad(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O,X,R,Q,K,q,ne,this.group,D))},this.dispose=function(se,Oe,J){t.loop(ye,function(pe){pe.dispose()}),this.labels=this.buttons=this.tabs=null,N=ye=F.rowTabs=null,J||this.zimContainer_dispose(!0)}},t.extend(t.Pad,t.Container,["clone","dispose"],"zimContainer",!1),t.NumPad=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y){var _="advanced, titleBar, titleBarColor, titleBarBackgroundColor, titleBarHeight, backgroundColor, borderColor, borderWidth, corner, numberCorner, close, closeColor, collapse, collapseColor, collapsed, align, shadowColor, shadowBlur, draggable, boundary, style, group, inherit",k;if(k=st(t.NumPad,arguments,_,this))return k;De("57.7"),this.group=L;var $=C===!1?{}:t.getStyle("NumPad",this.group,Y);n(e)&&(e=$.advanced!=null?$.advanced:!1);var O=400,X=e?620:530;n(r)&&(r=$.titleBar!=null?$.titleBar:"NUMPAD"),n(i)&&(i=$.titleBarColor!=null?$.titleBarColor:t.white),n(l)&&(l=$.titleBarBackgroundColor!=null?$.titleBarBackgroundColor:t.grey),n(a)&&(a=$.titleBarHeight!=null?$.titleBarHeight:40),n(s)&&(s=$.backgroundColor!=null?$.backgroundColor:t.darker),n(f)&&(f=$.borderColor!=null?$.borderColor:t.pewter),n(c)&&(c=$.borderWidth!=null?$.borderWidth:null),f<0||c<0?f=c=null:f!=null&&c==null&&(c=1),n(w)&&(w=$.corner!=null?$.corner:15),n(T)&&(T=$.numberCorner!=null?$.numberCorner:30),n(I)&&(I=$.align!=null?$.align:"left"),n(g)&&(g=$.shadowColor!=null?$.shadowColor:"rgba(0,0,0,.3)"),n(E)&&(E=$.shadowBlur!=null?$.shadowBlur:14),n(A)&&(A=$.draggable!=null?$.draggable:!0),n(y)&&(y=$.boundary!=null?$.boundary:null),n(p)&&(p=$.close!=null?$.close:!0),n(x)&&(x=$.closeColor!=null?$.closeColor:n(i)?t.grey:i),Array.isArray(w)||(w=[w,w,w,w]),n(P)&&(P=$.collapse!=null?$.collapse:!0),n(m)&&(m=$.collapseColor!=null?$.collapseColor:n(i)?t.grey:i),n(v)&&(v=$.collapsed!=null?$.collapsed:!1),this.zimPanel_constructor(O,X,null,r,i,l,a,s,f,c,w,p,x,null,null,null,P,m,v,I,g,E,A,y,C,L,Y),this.type="NumPad";var R=this;function Q(q,ne){return n(ne)&&(ne=mist),{label:q,backgroundColor:ne,rollBackgroundColor:white,color:darker,rollColor:darker}}var K=[Q("C",t.red.darken(.1)),Q(new t.Label({text:"\u2423",size:90,shiftV:-24}),t.yellow.darken(.1)),Q(new t.Label({text:"/",size:48,bold:!0,shiftV:3})),Q(new t.Label({text:"*",size:65,shiftV:18})),1,2,3,Q(new t.Label({text:"-",size:60,shiftV:-3})),4,5,6,Q(new t.Label({text:"+",size:55,shiftV:3})),7,8,9,Q(new t.Label({text:"\u232B",size:M=="ios"?60:35}),t.red.darken(.1)),Q(new t.Label({text:",",size:70,shiftV:-3})),Q(new zr({text:".",size:70,shiftV:-3})),0,Q(new t.Label({text:"\u23CE",size:M=="ios"?40:50,shiftV:5}),t.green.darken(.1))];e&&(K.splice(2,0,Q("%",yellow.darken(.1))),K.splice(4,0,Q(new t.Label({text:"^",size:47,shiftV:10}),yellow.darken(.1))),K.splice(4,0,Q(")",yellow.darken(.1))),K.splice(4,0,Q("(",yellow.darken(.1)))),R.pad=new t.Pad({width:380,cols:4,rows:e?6:5,keys:K,spacing:6,currentSelected:!1,backgroundColor:t.grey,rollBackgroundColor:t.tin,selectedBackgroundColor:t.grey,downBackgroundColor:t.green,corner:T}),R.pad.on("mousedown",function(){R.pad.text=="C"?R.key="clear":R.pad.text=="\u2423"?R.key="space":R.pad.text=="\u232B"?R.key="backspace":R.pad.text=="\u23CE"?R.key="enter":R.key=R.pad.text,R.dispatchEvent("pressed")}),R.add(R.pad,null,!0),C!==!1&&t.styleTransforms(this,$),this.clone=function(){return R.cloneProps(new t.NumPad(e,r?r.clone():"",i,l,a,s,f,c,w,T,p,x,P,m,R.collapsed,I,g,E,A,y,C,this.group,Y))}},t.extend(t.NumPad,t.Panel,["clone"],"zimPanel",!1),t.DPad=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g){var E="axis, width, backgroundColor, borderWidth, borderColor, indicatorColor, indicatorPressColor, indicatorScale, indicatorRadius, innerCircle, innerScale, activeRadius, clamp, logo, style, group, inherit",A;if(A=st(t.DPad,arguments,E,this))return A;De("66.2"),this.zimContainer_constructor(null,null,null,null,!1),this.type="DPad",this.group=I;var y=v===!1?{}:t.getStyle(this.type,this.group,g);n(e)&&(e=y.axis!=null?y.axis:"all"),n(r)&&(r=y.width!=null?y.width:100),n(i)&&(i=y.backgroundColor!=null?y.backgroundColor:t.granite),n(a)&&(a=y.borderColor!=null?y.borderColor:null),n(l)&&(l=y.borderWidth!=null?y.borderWidth:null),a<0||l<0?a=l=null:a!=null&&l==null&&(l=1),n(s)&&(s=y.indicatorColor!=null?y.indicatorColor:t.moon),n(f)&&(f=y.indicatorPressColor!=null?y.indicatorPressColor:t.lighter),n(c)&&(c=y.indicatorScale!=null?y.indicatorScale:1),n(w)&&(w=y.indicatorRadius!=null?y.indicatorRadius:null),n(T)&&(T=y.innerCircle!=null?y.innerCircle:!0),n(p)&&(p=y.innerScale!=null?y.innerScale:.5),n(x)&&(x=y.activeRadius!=null?y.activeRadius:r),n(P)&&(P=y.clamp!=null?y.clamp:!0),n(m)&&(m=y.logo!=null?y.logo:!1);var C=this;this.axis=e,this.outer=new t.Circle(r/2,i,a,l).addTo(this);var L=this.inner=new t.Circle(r*p/2,"rgba(0,0,0,.2)").center(this);m&&(this.logo=new t.Label({text:"D",bold:!0}).center(L).mov(1,2).alp(.3));var Y=new t.Container().addTo(this),_=(r-l)*.2*c,k=8;e=="vertical"?k=2:e=="horizontal"?(k=2,Y.rotation=90):e=="both"&&(k=4),t.loop(k,function(q,ne){new t.Triangle(_,_,_,s).addTo(Y).reg(null,n(w)?(r-l)*.475:w).rot(q*360/ne)});var $=0,O=0,X;C.dirX=0,C.dirY=0;var R,Q=!0;this.on("mousedown",function(q){R=q,Y.loop(function(ne){ne.color=f}),Q?C.ticker=t.Ticker.add(function(){K()}):t.Ticker.add(C.ticker)}),this.on("pressmove",function(q){R=q}),this.on("pressup",function(){t.Ticker.remove(C.ticker),C.dirX=C.dirY=0,Y.loop(function(q){q.color=s}),C.stage&&C.stage.update()});function K(){var q=R;$=q.stageX/t.scaX,O=q.stageY/t.scaY,X=C.globalToLocal($,O),q=new Ne.Event("change"),q.dirX=((X.x+x)/(x*2)-.5)*2,q.dirY=((X.y+x)/(x*2)-.5)*2,P&&(q.dirX=t.constrain(q.dirX,-1,1),q.dirY=t.constrain(q.dirY,-1,1)),C.dirX=q.dirX,C.dirY=q.dirY,C.dispatchEvent(q)}this._enabled=!0,Object.defineProperty(C,"enabled",{get:function(){return C._enabled},set:function(q){bt(C,q)}}),v!==!1&&t.styleTransforms(this,y),this.clone=function(){return C.cloneProps(new t.DPad(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,this.group,g))},this.dispose=function(q,ne,U){return this.ticker&&t.Ticker.remove(this.ticker),U||this.zimContainer_dispose(!0),!0}},t.extend(t.DPad,t.Container,["clone","dispose"],"zimContainer",!1),t.Radial=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O,X,R,Q,K,q,ne,U,D,d,u,o){var S="labels, size, font, height, coreRadius, coreColor, startAngle, totalAngle, angles, flip, shiftRadial, icons, rollIcons, rotateIcons, iconsShiftRadial, backgroundColor, rollBackgroundColor, selectedBackgroundColor, selectedRollBackgroundColor, backdropColor, color, rollColor, selectedColor, selectedRollColor, borderColor, borderWidth, gradient, gap, gapAsAngle, spacing, spacingInner, spacingOuter, currentEnabled, currentSelected, selectedIndex, style, group, inherit",F;if(F=st(t.Radial,arguments,S,this))return F;De("66.4"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Radial",this.group=u;var h=d===!1?{}:t.getStyle(this.type,this.group,o);n(e)&&(e=h.labels!=null?h.labels:["A","B","C","D","E"]),n(r)&&(r=h.size!=null?h.size:30),n(i)&&(i=h.font!=null?h.font:"verdana"),n(f)&&(f=h.startAngle!=null?h.startAngle:null),n(c)&&(c=h.totalAngle!=null?h.totalAngle:360),n(w)&&(w=h.angles!=null?h.angles:null),n(T)&&(T=h.flip!=null?h.flip:!0),n(p)&&(p=h.shiftRadial!=null?h.shiftRadial:0),n(x)&&(x=h.icons!=null?h.icons:null),n(P)&&(P=h.rollIcons!=null?h.rollIcons:null),n(m)&&(m=h.rotateIcons!=null?h.rotateIcons:!1),n(v)&&(v=h.iconsShiftRadial!=null?h.iconsShiftRadial:0),n(l)&&(l=h.height!=null?h.height:60),n(a)&&(a=h.coreRadius!=null?h.coreRadius:100),n(s)&&(s=h.coreColor!=null?h.coreColor:t.dark),n(y)&&(y=h.backdropColor!=null?h.backdropColor:t.clear),n(I)&&(I=h.backgroundColor!=null?h.backgroundColor:t.granite),n(g)&&(g=h.rollBackgroundColor!=null?h.rollBackgroundColor:t.tin),n(E)&&(E=h.selectedBackgroundColor!=null?h.selectedBackgroundColor:t.charcoal),n(A)&&(A=h.selectedRollBackgroundColor!=null?h.selectedRollBackgroundColor:E),n(C)&&(C=h.color!=null?h.color:t.white),n(L)&&(L=h.rollColor!=null?h.rollColor:C),n(Y)&&(Y=h.selectedColor!=null?h.selectedColor:C),n(_)&&(_=h.selectedRollColor!=null?h.selectedRollColor:L),n(k)&&(k=h.borderColor!=null?h.borderColor:t.dark),n($)&&($=h.borderWidth!=null?h.borderWidth:2),n(R)&&(R=h.gapAsAngle!=null?h.gapAsAngle:!1),n(X)&&(X=h.gap!=null?h.gap:R?3:6),n(O)&&(O=h.gradient!=null?h.gradient:null),O===!0&&(O=.1),n(Q)&&(Q=h.spacing!=null?h.spacing:6),n(K)&&(K=h.spacingInner!=null?h.spacingInner:Q),n(q)&&(q=h.spacingOuter!=null?h.spacingOuter:Q),n(ne)&&(ne=h.currentEnabled!=null?h.currentEnabled:!1),n(U)&&(U=h.currentSelected!=null?h.currentSelected:!0);var b=this,ye=this.innerRadius=a+K,B=this.outerRadius=ye+l;this.setBounds(-B,-B,B*2,B*2);var N=this.backdrop=new t.Circle(B+q,y).center(this);if(a>0&&(this.core=new t.Circle(a,s).center(this)),w&&w.length<e.length-1)return dt&&tt("Radial() - not enough angles provided"),this;if(e&&e.length>0||x&&x.length>0){var re;if(e&&e.length>0&&(re=e.length),x&&x.length>0&&(re>0?re=Math.min(x.length,re):re=x.length),P&&P.length<re)for(var le=0;le<re-P.length;le++)P.push(new t.Circle(1,t.clear));var G=N.width,z=this.buttons=new t.Container(-G/2,-G/2,G,G).centerReg(this),se=X;R||(X=X/B*180/Math.PI,se=se/ye*180/Math.PI);for(var Oe=(c-X*re+(c==360?0:X))/re,J=f||0,pe=0;pe<re;pe++){w&&(Oe=w[pe]);var Z=new t.Shape(-G/2,-G/2,G,G).centerReg(z);Z.num=pe,Z.zimSelected=!1,Z.angle=Oe;var de=Z.graphics;Z.backgroundColor=t.Pick.choose(I),Z.rollBackgroundColor=t.Pick.choose(g),Z.selectedBackgroundColor=t.Pick.choose(E),Z.selectedRollBackgroundColor=t.Pick.choose(A),Z.color=t.Pick.choose(C),Z.rollColor=t.Pick.choose(L),Z.selectedColor=t.Pick.choose(Y),Z.selectedRollColor=t.Pick.choose(_),Z.colorCommand=de.f(Z.backgroundColor).command,(n($)||$>0)&&(!n(k)||!n($))&&(n(k)&&(k=t.black),Z.borderColorCommand=de.s(k).command,Z.borderWidthCommand=de.ss($).command);var V=(J-90-Oe/2)*Math.PI/180,fe=(J-90+Oe/2)*Math.PI/180,ke=(J-90+(Oe+X-se)/2)*Math.PI/180,oe=(J-90-(Oe+X-se)/2)*Math.PI/180;if(de.arc(0,0,B,V,fe,!1),de.arc(0,0,ye,ke,oe,!0).cp(),O&&(de.s().ss().rf(["rgba(0,0,0,"+O+")","rgba(255,255,255,"+O+")"],[0,1],0,0,ye,0,0,B),de.arc(0,0,B,V,fe,!1),de.arc(0,0,ye,ke,oe,!0).cp()),Z.cur("pointer"),Z.zimOverEvent=Z.on("mouseover",function(Pe){var ie=Pe.target;ie.colorCommand.style=ie==b.selected&&U?ie.selectedRollBackgroundColor:ie.rollBackgroundColor,ie.label&&(ie.label.color=ie==b.selected&&U?ie.selectedRollColor:ie.rollColor),P&&(ie.holder.removeAllChildren(),P[ie.num].loc(1,0,ie.holder)),b.stage&&b.stage.update()}),Z.zimOutEvent=Z.on("mouseout",function(Pe){var ie=Pe.target;ie.colorCommand.style=ie==b.selected&&U?ie.selectedBackgroundColor:ie.backgroundColor,ie.label&&(ie.label.color=ie==b.selected&&U?ie.selectedColor:ie.color),P&&(ie.holder.removeAllChildren(),x&&x[ie.num].loc(1,0,ie.holder)),b.stage&&b.stage.update()}),Z.zimDownEvent=Z.on((Pt?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",function(Pe){var ie=Pe.target,be=ie!==b.selected;b.lastSelected=b.selected,ue=ie.num,U?be?(b.selected&&(b.selected.colorCommand.style=b.selected.backgroundColor,b.selected.label&&(b.selected.label.color=b.selected.color)),b.selected=ie,b.label=ie.label,b.label&&(b.text=b.label.text),b.icon=ie.icon,ie.colorCommand.style=ie.selectedRollBackgroundColor,ie.label&&(ie.label.color=ie.selectedRollColor)):ne||(ue=-1,b.selected=null,b.label=null,b.text=null,b.icon=null,ie.colorCommand.style=ie.rollBackgroundColor,ie.label&&(ie.label.color=ie.rollColor)):(b.selected=ie,b.label=ie.label,b.label&&(b.text=b.label.text),b.icon=ie.icon),b.dispatchEvent("change"),!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&b.stage&&b.stage.update()}),x&&x.length>0){var Ce=ye+l/2+v,Me=Z.holder=new t.Container(3,Ce).addTo(this).reg(1,Ce).rot(J);Me.mouseChildren=!1,Me.mouseEnabled=!1,Z.icon=x[pe],x[pe].loc(1,0,Me),m||(x[pe].rotation=-J)}if(e&&e.length>0){var te;if(e[pe].type!="LabelOnArc"){var ae=e[pe].type=="Label"?e[pe]:new t.Label({text:e[pe],size:r,font:i,color:C,style:d,inherit:o});te=new t.LabelOnArc({label:ae,color:C,size:r,spacing:-5,flip:T&&J>90&&J<270,radius:ye+(l-ae.height)/2+2+p,style:d,inherit:o})}else te=e[pe];e[pe]=te,Z.label=te,te.center(this).rot(J),te.mouseChildren=!1,te.mouseEnabled=!1}if(pe!=e.length-1){var we=w?w[pe+1]:Oe;J+=(Oe+we)/2+X}}n(f)||(b.rotation+=b.buttons.getChildAt(0).angle/2)}var ue=null;Object.defineProperty(this,"selectedIndex",{get:function(){return ue},set:function(Pe){var ie;b.buttons&&(ie=b.buttons.getChildAt(Pe)),ie!==b.selected&&(b.selected&&(b.selected.colorCommand.style=b.selected.backgroundColor,b.selected.label&&(b.selected.label.color=b.selected.color)),b.selected=ie,ie&&(U&&(ie.colorCommand.style=ie.selectedRollBackgroundColor),ie.label&&(U&&(ie.label.color=ie.selectedColor),b.text=ie.label.text))),!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&b.stage&&b.stage.update()}}),n(D)&&(D=h.selectedIndex!=null?h.selectedIndex:0),b.selectedIndex=D,d!==!1&&t.styleTransforms(this,h),this.clone=function(){return b.cloneProps(new t.Radial(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O,X,R,Q,K,q,ne,U,D,d,this.group,o))}},t.extend(t.Radial,t.Container,"clone","zimContainer",!1),t.RadialMenu=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O,X,R,Q,K,q,ne,U,D,d,u,o){var S="menu, size, font, height, coreRadius, coreColor, title, titleIcon, startAngle, totalAngle, flip, shiftRadial, rotateIcons, iconsShiftRadial, backgroundColor, rollBackgroundColor, selectedBackgroundColor, selectedRollBackgroundColor, backdropColor, color, rollColor, selectedColor, selectedRollColor, borderColor, borderWidth, gradient, gap, gapAsAngle, spacing, spacingInner, spacingOuter, currentEnabled, currentSelected, open, under, style, group, inherit",F=S.split(", "),h=!1;if(e&&e.constructor==={}.constructor){for(var b in e)if(F.indexOf(b)>=0){h=!0;break}}if(e&&h){var ye;if(ye=st(t.RadialMenu,arguments,S,this))return ye}De("66.6"),this.zimContainer_constructor(null,null,null,null,!1),this.type="RadialMenu",this.group=u;var B=d===!1?{}:t.getStyle(this.type,this.group,o);n(e)&&(e=B.menu!=null?B.menu:{A:{A1:["AA1","AA2","AA3","AA4"],A2:[],A3:[]},B:["B1","B2","B3","B4","B5","B6"],C:[]}),n(r)&&(r=B.size!=null?B.size:30),n(i)&&(i=B.font!=null?B.font:"verdana"),n(w)&&(w=B.startAngle!=null?B.startAngle:null),n(T)&&(T=B.totalAngle!=null?B.totalAngle:360),n(p)&&(p=B.flip!=null?B.flip:!0),n(P)&&(P=B.rotateIcons!=null?B.rotateIcons:!1),n(x)&&(x=B.shiftRadial!=null?B.shiftRadial:0),n(m)&&(m=B.iconsShiftRadial!=null?B.iconsShiftRadial:0),n(l)&&(l=B.height!=null?B.height:60),n(a)&&(a=B.coreRadius!=null?B.coreRadius:100),n(s)&&(s=B.coreColor!=null?B.coreColor:t.dark),n(f)&&(f=B.title!=null?B.title:"MENU"),n(c)&&(c=B.titleIcon!=null?B.titleIcon:null),n(A)&&(A=B.backdropColor!=null?B.backdropColor:t.clear),n(v)&&(v=B.backgroundColor!=null?B.backgroundColor:t.granite),n(I)&&(I=B.rollBackgroundColor!=null?B.rollBackgroundColor:t.tin),n(g)&&(g=B.selectedBackgroundColor!=null?B.selectedBackgroundColor:t.charcoal),n(E)&&(E=B.selectedRollBackgroundColor!=null?B.selectedRollBackgroundColor:g),n(y)&&(y=B.color!=null?B.color:t.white),n(C)&&(C=B.rollColor!=null?B.rollColor:y),n(L)&&(L=B.selectedColor!=null?B.selectedColor:y),n(Y)&&(Y=B.selectedRollColor!=null?B.selectedRollColor:C),n(_)&&(_=B.borderColor!=null?B.borderColor:t.dark),n(k)&&(k=B.borderWidth!=null?B.borderWidth:2),n(X)&&(X=B.gapAsAngle!=null?B.gapAsAngle:!1),n(O)&&(O=B.gap!=null?B.gap:X?3:6),n(R)&&(R=B.spacing!=null?B.spacing:6),n($)&&($=B.gradient!=null?B.gradient:null),$===!0&&($=.1),n(Q)&&(Q=B.spacingInner!=null?B.spacingInner:R),n(K)&&(K=B.spacingOuter!=null?B.spacingOuter:R),n(q)&&(q=B.currentEnabled!=null?B.currentEnabled:!1),n(ne)&&(ne=B.currentSelected!=null?B.currentSelected:!0),n(U)&&(U=B.open!=null?B.open:!1),n(D)&&(D=B.under!=null?B.under:!0);var N=this,re=(Pt?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",le=null,G=this.core=new t.Circle({radius:a,color:s,style:d,inherit:o}).addTo(this);c&&(this.titleIcon=c.center(G)),f&&(this.title=new t.Label({text:f,size:r,font:i,color:y,style:d,inherit:o}).center(G)),G.cur("pointer"),G.on(re,function(){N.leafNode=!1,J.length==0?pe():(t.loop(J,function(de){de.selectedIndex=-1,de.removeFrom(),J=[]}),N.outerLevel=0,N.selected=N.outerMenu=N.selectedMenu=N.text=null),(q||N.selected!=le)&&N.dispatchEvent("change"),le=N.selected,N.stage&&N.stage.update()}),this.closeRings=function(de){n(de)&&(de=N.outerLevel);var V=N.outerLevel-de;t.loop(J,function(fe,ke){ke>V-1&&(fe.removeFrom(),fe.selectedIndex=-1,J.pop())},!0),N.outerLevel=V,N.outerMenu=J[J.length-1],N.outerMenu&&(N.outerMenu.selectedIndex=-1),N.selected=N.selectedMenu=N.text=null,J[J.length-2]?(N.selectedMenu=J[J.length-2],N.selectedIndex=N.selectedMenu.selectedIndex):N.selectedIndex=-1,N.selected!=le&&N.dispatchEvent("change"),le=N.selected,N.stage&&N.stage.update()};var z={},se,Oe;N.outerLevel=0,e.constructor=={}.constructor&&(e={core:e},se=N.tree=new t.Hierarchy(e),Oe=se.getLinearIDs()),N.lastRadial=null;var J=this.radials=[];U&&pe();function pe(de){var V,fe;de?V=de.ringLevel:(V=0,fe=a),t.loop(J,function(Ce,Me){Me>V-1&&(Ce.removeFrom(),Ce.selectedIndex=-1,J.pop())},!0);var ke;if(de&&(ke=de.selected),ke){var oe=ke.id;fe=de.outerRadius,Z(oe,V+1,fe)}else de||Z("id0",V+1,fe);N.selected=ke,N.selected?(N.selectedMenu=J[N.selected.menu.ringLevel-1],N.selectedIndex=N.selected.num,N.selected.label?N.text=N.selected.label.text:N.text=null):q&&de?(N.selectedIndex=de.selectedIndex,N.label=de.label,N.text=de.text,N.icon=de.icon,N.selectedMenu=de):(N.text=null,N.selectedIndex=-1,N.selectedMenu=null),N.stage&&N.stage.update()}function Z(de,V,fe){V&&(N.outerLevel=V);var ke;if(!z[de]){var oe=se.getData(de),Ce=oe.list;if(Ce&&!t.isEmpty(Ce)){var Me={labels:se.getLinearList(Ce),coreRadius:fe,size:r,font:i,startAngle:w,totalAngle:T,flip:p,rotateIcons:P,shiftRadial:x,iconsShiftRadial:m,height:l,coreColor:t.clear,backdropColor:A,backgroundColor:v,rollBackgroundColor:I,selectedBackgroundColor:g,selectedRollBackgroundColor:E,color:y,rollColor:C,selectedColor:L,selectedRollColor:Y,borderColor:_,borderWidth:k,gapAsAngle:X,gap:O,gradient:$,spacingInner:Q,spacingOuter:K,currentSelected:ne,currentEnabled:q,style:d,inherit:o};oe.styles&&(Me=t.merge(Me,oe.styles)),ke=z[de]=new t.Radial(Me),Oe=se.getLinearIDs(Ce),ke.buttons.loop(function(te,ae){te.menu=ke,te.id=Oe[ae]}),ke.ringLevel=N.outerLevel,ke.selectedIndex=-1,ke.on("change",function(te){N.leafNode=!1,pe(te.target),(q||N.selected!=le)&&N.dispatchEvent("change"),le=N.selected})}}z[de]?(J.push(z[de]),z[de].center(N),D&&z[de].bot()):(N.leafNode=!0,N.outerLevel-=1),N.outerMenu=ke}d!==!1&&t.styleTransforms(this,B),this.clone=function(){return N.cloneProps(new t.RadialMenu(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O,X,R,Q,K,q,ne,U,D,d,this.group,o))}},t.extend(t.RadialMenu,t.Container,"clone","zimContainer",!1),t.ColorPicker=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O,X,R){var Q="width, colors, cols, spacing, greyPicker, alphaPicker, startBackgroundColor, draggable, shadowColor, shadowBlur, buttonBar, circles, indicator, backgroundColor, keyArrows, container, selectedIndex, selectedColor, dropperTarget, spectrumCollapse, spectrumMode, spectrumClose, spectrumOk, spectrumTitle, tolerancePicker, collapsed, style, group, inherit",K;if(K=st(t.ColorPicker,arguments,Q,this))return K;De("67"),this.zimContainer_constructor(null,null,null,null,!1),this.type="ColorPicker",this.group=X;var q=O===!1?{}:t.getStyle(this.type,this.group,R),ne;n(e)&&(e=q.width!=null?q.width:500),n(r)&&(r=q.colors!=null?q.colors:"spectrum"),r=="legacy"&&(ne=!0),n(i)&&(i=q.cols!=null?q.cols:10),n(l)&&(l=q.spacing!=null?q.spacing:2);var U=!ne&&r.length>0&&r.length<=i;r=="spectrum"&&(i=10,l=2,U=!1),n(s)&&(s=q.alphaPicker!=null?q.alphaPicker:!U),n(k)&&(k=q.tolerancePicker!=null?q.tolerancePicker:!1),k&&(s=!1),n(a)&&(a=q.greyPicker!=null?q.greyPicker:!U),n(w)&&(w=q.shadowColor!=null?q.shadowColor:"rgba(0,0,0,.3)"),n(T)&&(T=q.shadowBlur!=null?q.shadowBlur:14),n(p)&&(p=q.buttonBar!=null?q.buttonBar:!U),n(c)&&(p||r=="spectrum"?c=q.draggable!=null?q.draggable:!0:c=q.draggable!=null?q.draggable:!1),n(x)&&(x=q.circles!=null?q.circles:!1),n(P)&&(P=q.indicator!=null?q.indicator:!1,p||(P=q.indicator!=null?q.indicator:!0)),n(m)&&(m=q.backgroundColor!=null?q.backgroundColor:t.black),n(f)&&(f=q.startBackgroundColor!=null?q.startBackgroundColor:null),n(v)&&(v=q.keyArrows!=null?q.keyArrows:!0),n(A)&&(A=q.dropperTarget!=null?q.dropperTarget:!1),n(y)&&(y=q.spectrumCollapse!=null?q.spectrumCollapse:!0),n(C)&&(C=q.spectrumMode!=null?q.spectrumMode:!0),n(L)&&(L=q.spectrumClose!=null?q.spectrumClose:!0),n(Y)&&(Y=q.spectrumOk!=null?q.spectrumOk:!0),n(_)&&(_=q.spectrumTitle!=null?q.spectrumTitle:null),n($)&&($=q.collapsed!=null?q.collapsed:!1);var D=this;if(n(I))if(j.zdf)I=j.zdf.stage;else return;else if(I.getBounds){if(n(I.getStage))return}else return;D.container=I;var d="#e472c4",u="#50c4b7",o=1,S=1,F=new t.Shape;this.addChild(F),F.x+=l,F.y+=l,ne=!1;var h,b,ye=[],B,N,re,le,G,z=r=="spectrum";if(n(r)||r=="legacy"||r=="spectrum"){ne=!0;var se=6,Oe=se*se*se;se=Math.ceil(Math.pow(Oe,1/2)),b=(e-l)/18-l,G=Math.floor(Math.pow(se*se,1/3)),h=[];for(var J=0;J<6;J++)for(var pe=0;pe<6;pe++)for(var Z=0;Z<6;Z++)h.push("#"+Ce(J*3)+Ce(pe*3)+Ce(Z*3));for(r=[],J=0;J<h.length;J++)B=Math.floor(J/6),N=J%6,B>=6*3?G=1:G=0,re=B-G*6*3,le=N+G*6,r[le*18+re]=h[J];i=18,ye=[u,d]}else b=(e-l)/i-l;var de=Math.ceil(r.length/i),V=1,fe=String(r[r.length-1]);if(!n(f)){var ke=f.match(/rgba\((.*)\)/);ke&&(B=ke[1].split(","),V=B.pop(),f="rgb("+B.join(",")+")"),fe=String(f)}var oe;ne&&(oe=u);function Ce(Tt){return Tt=Math.floor(Tt).toString(16),Tt+""+Tt}G=0;var Me=F.graphics,te,ae,we=q.borderColor!=null?q.borderColor:null,ue=q.borderWidth!=null?q.borderWidth:null;!n(we)&&n(ue)&&(ue=1),ue&&n(we)&&(we=t.dark),ue&&Me.s(we).ss(ue);var Pe=r.length;for(z&&(Pe=56),J=0;J<Pe;J++)B=J%i,N=Math.floor(J/i),te=B*(b+l),ae=N*(b+l),x?Me.f(r[J]).dc(te+b/2,ae+b/2,b/2):Me.f(r[J]).r(te,ae,b,b);var ie=ae+b+l;D.colors=r;var be=ie;if(a){for(J=0;J<16;J++)ye.push("#"+Ce(J)+Ce(J)+Ce(J));for(J=0;J<ye.length;J++)B=Math.floor(J/i),N=J%i,te=N*(b+l),ae=B*(b+l)+ie,x?Me.f(ye[J]).dc(te+b/2,ae+b/2,b/2):Me.f(ye[J]).r(te,ae,b,b);ie=ae+b+l;var Le=i,me=Math.ceil(ye.length/i)}D.greys=ye,P&&!z&&(P=this.indicator=x?new t.Circle(b/2*.5,null,null,null,null,null,null,null,!1):new t.Rectangle(b*.5,b*.5,null,null,null,null,null,null,null,!1),P.alpha=.5,P.centerReg(),this.addChild(P),P.mouseEnabled=!1,ee(r.indexOf(fe)));function ee(Tt){if(n(Tt)||Tt<0){P.visible=!1;return}else P.visible=!0;fe=="#000"||fe=="#000000"||fe=="black"?(P.color="#222",P.alpha=1):(P.color="black",P.alpha=.5),P.x=F.x+Tt%i*(b+l)+b/2,P.y=F.x+Math.floor(Tt/i)*(b+l)+b/2}var Ie=10,Re=ie;if(s||k){var _e=new t.Container({style:!1});_e.setBounds(0,0,600,70),this.addChild(_e),_e.x=0,_e.y=ie;var Ze=this.alphaBacking=new t.Rectangle(600-Ie*2,50,t.licorice,null,null,0,null,null,null,!1);_e.addChild(Ze),t.centerReg(Ze,_e);var at=this.alphaBut=new t.Button({width:20,height:30,backgroundColor:"darkorange",rollBackgroundColor:"orange",label:"",corner:0,hitPadding:20,style:!1}),Be=this.alphaSlider=new t.Slider({min:0,max:1,step:k?0:.05,button:at,barLength:k?500*.55:600*.55,barWidth:2,barColor:t.silver,vertical:!1,useTicks:!1,inside:!1,style:!1});Be.currentValue=n(V)?1:V,k&&(Be.currentValue=.1),_e.addChild(Be),Be.x=40,Be.y=_e.height/2;var He=this.alphaText=new t.Label({text:k?"Tolerance: 0.1":"Alpha: "+t.decimals(V),size:30,color:"orange",backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",backgroundColor:"ignore",rollColor:"orange",group:this.group});_e.addChild(He),He.x=Be.x+Be.bar.width+40,He.y=_e.height/2-He.height/2,_e.scaleX=_e.scaleY=e/600,Be.on("change",function(){He.text=k?"Tolerance: "+Ut(Be.currentValue):"Alpha: "+Ut(Be.currentValue),s&&Fe&&(Fe.alpha=S=Be.currentValue),D.dispatchEvent("change"),D.stage&&D.stage.update()}),ie+=_e.height-Ie,k&&(D.toleranceBacking=D.alphaBacking,D.toleranceBut=D.alphaBut,D.toleranceSlider=D.alphaSlider,D.alphaBacking=D.alphaBut=D.alphaSlider=null)}if(p){var et=new t.Container({style:!1});et.setBounds(0,0,600,100),this.addChild(et),et.x=0,et.y=ie+Ie;var ge=this.swatchText=new t.TextInput({align:"left",selectionAlpha:.5,text:fe.toUpperCase(),width:140,size:30,color:"orange",shadowColor:"ignore",shadowBlur:"ignore",backgroundColor:"ignore",group:this.group});if(ge.on("input",function(){(ge.text.length==4||ge.text.length==7)&&(Fe.color=ge.text,fe=Fe.color,D.dispatchEvent("change"))}),et.addChild(ge),t.centerReg(ge),ge.x=200/2-10,ge.y=50-2,c){var xe=this.grip=new t.Shape({style:!1});xe.cur("pointer"),et.addChild(xe),xe.graphics.f("rgba(256,256,256,.25)").r(0,0,5,20).r(10,0,5,20).r(20,0,5,20).r(30,0,5,20),xe.x=70,xe.y=65,ge.y=50-10,xe.mouseEnabled=!1}var he=this.closeBut=new t.Button({width:90,height:90,label:"X",backgroundColor:t.licorice,rollBackgroundColor:t.charcoal,corner:0,style:!1});et.addChild(he),he.x=600-he.width-Ie,he.y=0,he.on((Pt?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){D.hide(),D.dispatchEvent("close")});var Ge=this.okBut=new t.Button({width:150,height:90,label:"OK",backgroundColor:t.licorice,rollBackgroundColor:t.charcoal,corner:0,style:!1});et.addChild(Ge),Ge.x=he.x-Ge.width-Ie,Ge.y=0,Ge.on((Pt?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){gt(),D.dispatchEvent("ok")});var qe=this.swatchBacking=new t.Shape({style:!1});et.addChild(qe),Me=qe.graphics,Me.f(t.black).r(.5,.5,50,89).f(t.granite).r(50,.5,50,89).f(t.white).r(100,.5,49.5,89),qe.x=Ge.x-150-Ie,qe.y=0;var Fe=this.swatch=new t.Rectangle(150,90,fe,null,null,null,null,null,null,!1);et.addChild(Fe),Fe.x=qe.x,Fe.y=0,Fe.on((Pt?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){D.dispatchEvent("swatch")}),Fe.cur("pointer"),Fe.alpha=S=V,et.scaleX=et.scaleY=e/600,ie+=et.height}else F.cur("pointer");!s&&!p&&(ie-=Ie-l);var We=ie+Ie;this.setBounds(0,0,e,We);var ce=this.background=new t.Rectangle(e,We,m,null,null,null,null,null,null,!1);this.addChildAt(ce,0),w!=-1&&T>0&&(ce.shadow=new Ne.Shadow(w,8,8,T));var je=j.zdf,Ve,Se=!1;if(this.dropperTarget=A,z){r="spectrum";var Ae=30,Ye=20,Xe=Re-Ae+1,Ue=Xe-Ye+1,rt=D.bar=new t.Rectangle(D.width,Ae+1,t.black).addTo(D);_&&(D.title=new t.Label(_,18,null,t.light).pos(12,1,LEFT,CENTER,D.bar).noMouse()),c&&rt.cur();var Te=new t.Container(D.width,Xe).loc(0,Ae,D),$e=new t.Rectangle(D.width,Ue,new t.GradientColor(["rgb(255 0 0)","rgb(255 255 0)","rgb(0 255 0)","rgb(0 255 255)","rgb(0 0 255)","rgb(255 0 255)","rgb(255 0 0)"],[0,1/6,2/6,3/6,4/6,5/6,6/6],0,0,500,0)).addTo(Te).mov(0,Ye-1);new t.Rectangle(D.width,Ue/2,new t.GradientColor(["rgba(255,255,255,1)","rgba(255,255,255,0)"],[0,1],0,0,0,Ue/2)).loc($e,null,Te),new t.Rectangle(D.width,Ue/2+.5,new t.GradientColor(["rgba(0,0,0,1)","rgba(0,0,00,0)"],[1,0],0,0,0,Ue/2+.5)).loc($e,null,Te).mov(0,Ue/2),new t.Rectangle(D.width,20,new t.GradientColor(["black","white"],[.1,.9],0,0,D.width,0)).addTo(Te);var lt=D.gradient=new t.Bitmap(Te).loc(Te,null,D).cur("none"),Qe=D.pixels=new t.Pixel(Te,.5).loc(Te,null,D).vis(!1).cur("none");Te.dispose();var ot;!p&&L&&(ot=D.closeIcon=new t.Shape(-40,-40,80,80,null,!1),ot.graphics.f(t.light).p("AmJEVIEUkTIkXkWIB4h5IEWEYIETkTIB4B3IkTESIEQERIh4B4IkRkRIkSEVg"),ot.sca(.25).expand(10,10,10,1).pos(7,0,t.RIGHT,t.CENTER,rt).cur().addTo(D),ot.on((Pt?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){D.hide(),D.dispatchEvent("close")}));var ft=D.collapseIcon=new t.Triangle(20,20,20,t.faint,t.light,2).expand(10,10,10,1).pos(40+(ot?30:0),0,t.RIGHT,t.CENTER,rt).cur().addTo(D);ft.on("mousedown",function(){D.collapse(ft.rotation==0)});var ut=new t.Rectangle(20,20,t.white).reg("center");new t.Tile(new t.Rectangle(10,10,t.series(t.silver,t.white,t.white,t.silver)),2,2,0,0).addTo(ut),ut.mouseChildren=!1;var ze=D.modeIcon=new t.Button({width:20,height:20,shadowColor:-1,label:"",backing:ut,toggleEvent:"mousedown",toggleBacking:new t.Rectangle(20,20,new t.GradientColor([t.white,t.grey],[0,1],0,0,20,20)).reg("center")}).pos(8+(ot?30:0),5,t.RIGHT,t.TOP,D).expand(10,10,10,1);ze.on("mousedown",function(){Qe.vis(ze.toggled),D.spectrumToggled=!ze.toggled,je.stage.update()}),C||(ze.removeFrom(),ft.mov(28)),y||ft.removeFrom(),Y||D.okBut&&D.okBut.removeFrom(),!L&&he&&he.removeFrom();var kt=new t.Rectangle(D.width,D.height-Xe-Ae,t.faint).pos(0,0,t.LEFT,t.BOTTOM,D).noMouse(),Mt=this.dropper=new t.Circle(10,t.clear,t.white,8);new t.Circle(5,t.clear,t.black,2).center(Mt),new t.Circle(7,t.clear,t.white,2).center(Mt),Mt.noMouse()}this.updateDropperTarget=function(){Mt.vis(!1),Et(),Mt.vis(!0).top()},this.spectrumToggled=z,this.toggleSpectrum=function(Tt){Tt!=D.spectrumToggled&&(n(Tt)&&(Tt=!D.spectrumToggled),D.spectrumToggled=Tt,ze.toggle(!Tt),Qe.vis(!Tt),D.updateDropperTarget())};var xt=!1;function Yt(){je.stage.mouseInBounds?Mt.alp(1):Mt.alp(0),Mt.loc(je.mouseX,je.mouseY,je.stage),xt=D.spectrumToggled?lt.hitTestReg(Mt):Qe.hitTestReg(Mt);var Tt;D.dropperTarget?Tt=Mt.x>=Ve.x&&Mt.x<=Ve.x+Ve.width&&Mt.y>=Ve.y&&Mt.y<=Ve.y+Ve.height:Tt=!1;var Bt;if(D.dropperTarget?Bt=(xt||Tt)&&!kt.hitTestReg(Mt)&&!rt.hitTestReg(Mt):Bt=xt,!Se&&Bt)Dt(Tt);else if(Se&&!Bt){Ht(),je.stage.update();return}if(Bt){var gn;if(xt)gn=D.spectrumToggled?lt:Qe;else if(D.dropperTarget)gn=Ve;else return;var hn=gn.globalToLocal(je.mouseX,je.mouseY),en=gn.getColorAt(hn.x,hn.y,!0),En="rgba("+en[0]+","+en[1]+","+en[2]+","+en[3]+")";en[3]<.05&&(En=je.color),Mt.borderColor=En,je.stage.update()}}function Dt(Tt){Se=!0,Tt&&Et(),Mt.vis(!0).top()}function Ht(){Se=!1,Ve.dispose(),Mt.vis(!1)}this.collapsed=!1,this.collapse=function(Tt){n(Tt)&&(Tt=!0),Tt!=D.collapsed&&(D.collapsed=Tt,Tt?(ze.enabled=!1,ft.rot(180),D.background.vis(!1),lt.vis(!1),kt.vis(!1),F.visible=!1,Qe&&Qe.vis(!1),_e&&_e.vis(!1),p&&et.vis(!1),Se=!1,jt(),Qt(),D.dispatchEvent("collapsed")):(ze.enabled=!0,ft.rot(0),D.background.vis(!0),lt.vis(!0),kt.vis(!0),F.visible=!0,D.spectrumToggled||Qe.vis(!0),_e&&_e.vis(!0),p&&et.vis(!0),Se=!0,nn(),Et(),rt.hitTestReg(Mt)&&Qt(),D.dispatchEvent("expanded")),je.stage.update())},z&&y&&(D.collapseEvent=rt.on("dblclick",function(){D.collapsed?D.collapse(!1):D.collapse(!0)})),z&&$&&y&&(D.vis(!1),setTimeout(function(){D.collapse(!0),D.vis(!0),D.stage&&D.stage.update()},50));function nn(){jt(),D.dropperDown=je.stage.on("stagemousedown",Yt),D.dropperMove=je.stage.on("stagemousemove",Yt),D.dropperUp=je.stage.on("stagemouseup",function(){Yt(),Fe&&z&&xt&&Fe.color!=Mt.borderColor&&Je()})}function jt(){D.dropperDown&&je.stage.off("stagemousedown",D.dropperDown),D.dropperMove&&je.stage.off("stagemousemove",D.dropperMove),D.dropperUp&&je.stage.off("stagemouseup",D.dropperUp)}function Et(){Ve&&Ve.dispose&&Ve.dispose();var Tt=new t.Rectangle(je.width,je.height,je.color).addTo(je.stage,0),Bt;D.dropperTarget&&D.dropperTarget.getBounds&&D.dropperTarget.type&&!D.dropperTarget.type.includes("Stage")?Bt=D.dropperTarget.boundsToGlobal():Bt=je.stage.getBounds(),Ve=new t.Bitmap(je.stage,Bt.width,Bt.height,Bt.x,Bt.y).loc(Bt).cur("none"),Tt.dispose(),Ve.on("mousedown",Je)}function Qt(){Ve&&Ve.dispose&&Ve.dispose(),Mt.vis(!1)}function Je(){Mt.vis(!1),D.currentValue=t.convertColor(Mt.borderColor,"hex"),D.dispatchEvent("change"),Se&&(A?(Et(),Mt.vis(!0).top(),setTimeout(function(){D.updateDropperTarget(),je.stage.update()},50)):(Mt.vis(!0).top(),je.stage.update()))}function gt(){if(ne&&a){u=d,d=oe;var Tt=[u,d];for(J=0;J<2;J++){var Bt=F.graphics;B=Math.floor(J/i),N=J%i,te=N*(b+l),ae=B*(b+l)+be,ye[J]=Tt[J],Bt.f(ce.color).r(te-1,ae-1,b+2,b+2).f(Tt[J]).r(te,ae,b,b)}}oe=fe,o=S,D.dispatchEvent("change"),!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&D.stage&&D.stage.update()}if(c){var Ot,mt;ce.on("mousedown",_t),ce.on("pressmove",vt),ce.on("pressup",Lt),z&&(rt.on("mousedown",_t),rt.on("pressmove",vt),rt.on("pressup",Lt))}function _t(Tt){Ot=Tt.stageX/t.scaX-D.x,mt=Tt.stageY/t.scaY-D.y}function vt(Tt){D.x=Tt.stageX/t.scaX-Ot,D.y=Tt.stageY/t.scaY-mt,D.stage&&D.stage.update()}function Lt(){D.stage&&D.stage.update()}var Vt=i*(b+l),Jt=de*(b+l);if(a)var tn=Le*(b+l),Zt=me*(b+l);F.on((Pt?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",function(Tt){var Bt=t.hitTestGrid(F,Vt,Jt,i,de,Tt.stageX,Tt.stageY,0,0,l,l);n(Bt)||(fe=r[Bt],p&&(Fe.color=fe,ge.text=String(r[Bt]).toUpperCase()),gt()),a&&(Bt=null,Bt=t.hitTestGrid(F,tn,Zt,Le,me,Tt.stageX,Tt.stageY,0,Jt,l,l),n(Bt)||(fe=ye[Bt],p&&(Fe.color=fe,ge.text=ye[Bt].toUpperCase()),gt())),P&&ee(r.indexOf(fe)),p?D.stage&&D.stage.update():P&&D.stage&&D.stage.update(),zt()}),Object.defineProperty(this,"selectedColor",{get:function(){return fe},set:function(Tt){Tt=Tt.toLowerCase(),oe=fe=Tt,p&&(Fe.color=fe,ge.text=fe,D.stage&&D.stage.update()),P&&!z&&ee(r.indexOf(fe)),zt()}}),Object.defineProperty(this,"currentValue",{get:function(){return fe},set:function(Tt){D.selectedColor=Tt}}),Object.defineProperty(this,"currentValueEvent",{get:function(){return fe},set:function(Tt){Tt!=D.selectedColor&&(D.selectedColor=Tt,D.dispatchEvent("change"))}}),Object.defineProperty(this,"selectedIndex",{get:function(){return z?null:r.indexOf(fe)},set:function(Tt){z||(oe=fe=r[Tt],p&&(Fe.color=fe,ge.text=fe,D.stage&&D.stage.update()),P&&ee(r.indexOf(fe)),zt())}}),Object.defineProperty(this,"selectedAlpha",{get:function(){return s?Ut(Be.currentValue):1},set:function(Tt){s&&(o=Be.currentValue=Tt,Fe&&(Fe.alpha=o),He&&(He.text="Alpha: "+Ut(Be.currentValue)),D.stage&&D.stage.update())}}),Object.defineProperty(this,"selectedTolerance",{get:function(){return k?Ut(Be.currentValue):1},set:function(Tt){k&&(Be.currentValue=Tt,D.stage&&D.stage.update())}}),Object.defineProperty(this,"colors",{get:function(){return z?"spectrum":a?r.concat(ye):r},set:function(){dt&&tt("ColorPicker() colors is read only - make a new ColorPicker to change")}}),j.KEYFOCUS!=null&&(t.KEYFOCUS=j.KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return t.KEYFOCUS==D},set:function(){Pt?t.KEYFOCUS=D:j.KEYFOCUS=D}}),v&&t.KEYFOCUS&&an(),this.on("mousedown",function(){v&&an()});function an(){D.keyFocus=!0;var Tt=document.activeElement;Tt&&Tt.blur()}function zt(){D.zimAccessibility&&D.zimAccessibility.changeTitle(D,null,!0)}this.keyDownEvent=function(Tt){if(D.stage&&!z&&(D.zimAccessibility&&D.focus||!D.zimAccessibility&&D.keyFocus)){var Bt=D.selectedIndex;Tt.keyCode==37||Tt.keyCode==40?(Bt--,yn(Bt)):(Tt.keyCode==38||Tt.keyCode==39)&&(Bt++,yn(Bt))}};function yn(Tt){Tt<0&&(Tt=D.colors.length-1),Tt>D.colors.length-1&&(Tt=0),D.selectedIndex=Tt,D.dispatchEvent("change"),D.stage&&D.stage.update()}j.addEventListener("keydown",this.keyDownEvent);var yt,je;this.hide=function(){return yt=D.stage,D.removeFrom(),yt&&yt.update(),D},this.on("removed",ht);function ht(){if(z&&(Se=!1,jt(),Qt()),D.toggled=!1,D.zimAccessibility){var Tt=D.zimAccessibility;Tt.resize(D),Gt?Gt.focus():D.zimTabTag.nextSibling.focus(),setTimeout(function(){Tt.talk("ColorPicker has been closed.")},50)}yt&&yt.update()}var Gt,Kt=!1;this.show=function(){return D.center(D.container),D};function $t(){if(D.stage&&(yt=D.stage,je=yt.frame),D.zimAccessibility){var Tt=D.zimAccessibility;setTimeout(function(){Tt.activatedObject&&(Gt=Tt.activatedObject.zimTabTag)},50),Tt.resize(D),Tt.tabIndex=D.zimTabIndex}D.toggled=!0,setTimeout(function(){z&&(Se=!0,Et(),nn(),Dt(),Yt()),D.stage&&D.stage.update()},20)}this.on("added",$t),this.toggle=function(Tt){return Tt===!0?D.show():Tt===!1||D.container.contains(D)?D.hide():D.show(),D};function Ut(Tt){return Math.round(Tt*Math.pow(10,2))/Math.pow(10,2)}n(g)&&(g=q.selectedIndex!=null?q.selectedIndex:0),D.selectedIndex=g,n(E)&&(E=q.selectedColor!=null?q.selectedColor:null),E!=null?D.selectedColor=E:z&&(D.selectedColor="#888888"),O!==!1&&t.styleTransforms(this,q),this.clone=function(){return D.cloneProps(new t.ColorPicker(e,ne?null:r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O,this.group,R))},this.dispose=function(Tt,Bt,gn){return j.removeEventListener("keydown",D.keyDownEvent),z&&(jt(),D.gradient.cur("default"),D.pixels.cur("default"),A&&A.cur("default"),Ve.cur("default"),Se=!1,Qt()),Be&&Be.dispose(),Mt&&Mt.dispose(),D.dropperDown&&je.stage.off("stagemousedown",D.dropperDown),D.dropperMove&&je.stage.off("stagemousemove",D.dropperMove),D.dropperUp&&je.stage.off("stagemouseup",D.dropperUp),gn||this.zimContainer_dispose(!0),!0}},t.extend(t.ColorPicker,t.Container,["clone","dispose"],"zimContainer",!1),t.EmojiPicker=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A){var y="width, height, emojis, monochrome, backgroundColor, titleBar, titleBarColor, titleBarBackgroundColor, titleBarHeight, cache, size, collapse, collapseColor, collapsed, colSize, rowSize, style, group, inherit",C;if(C=st(t.EmojiPicker,arguments,y,this))return C;De("67.05"),this.group=E;var L=g===!1?{}:t.getStyle("EmojiPicker",this.group,A);n(e)&&(e=L.width!=null?L.width:400),n(r)&&(r=L.height!=null?L.height:600),n(l)&&(l=L.monochrome!=null?L.monochrome:!1),n(a)&&(a=L.backgroundColor!=null?L.backgroundColor:t.lighter),n(s)&&(s=L.titleBar!=null?L.titleBar:"Emojis"),n(f)&&(f=L.titleBarColor!=null?L.titleBarColor:null),n(c)&&(c=L.titleBarBackgroundColor!=null?L.titleBarBackgroundColor:t.silver.toAlpha(.8)),n(w)&&(w=L.titleBarHeight!=null?L.titleBarHeight:40),n(T)&&(T=L.cache!=null?L.cache:!!t.mobile()),n(p)&&(p=L.size!=null?L.size:30),n(v)&&(v=L.colSize!=null?L.colSize:p+15),n(I)&&(I=L.rowSize!=null?L.rowSize:p+14),n(x)&&(x=L.collapse!=null?L.collapse:!1),n(P)&&(P=L.collapseColor!=null?L.collapseColor:n(f)?t.grey:f),n(m)&&(m=L.collapsed!=null?L.collapsed:!1),this.zimWindow_constructor(e,r,null,a,null,L.borderWidth!=null?L.borderWidth:2,L.padding!=null?L.padding:10,L.corner!=null?L.corner:10,null,L.scrollBarActive!=null?L.scrollBarActive:!0,L.scrollBarDrag!=null?L.scrollBarDrag:!0,null,null,null,!1,null,null,null,null,null,!0,null,null,null,null,null,null,s,f,c,w,L.draggable!=null?L.draggable:!0,null,null,L.close!=null?L.close:!0,null,null,L.fullSize!=null?L.fullSize:!1,null,L.resizeHandle!=null?L.resizeHandle:!1,x,P,m,null,null,g,E,t.copy(L)),this.type="EmojiPicker";var Y=this;this.emojiData=n(i)?["\u{1F4A5}","\u{1F335}","\u{1F382}","\u{1F370}","\u{1F429}","\u{1F525}","\u{1F32B}","\u{1F30A}","\u{1F34F}","\u{1F34E}","\u{1F34B}","\u{1F34C}","\u{1F347}","\u{1F351}","\u{1F345}","\u{1F346}","\u{1F9C0}","\u{1F355}","\u{1F36C}","\u{1F36D}","\u{1F369}","\u{1F37A}","\u{1F37B}","\u{1F378}","\u{1F37E}","\u2615\uFE0F","\u{1F4A9}","\u{1F47B}","\u{1F916}","\u{1F4A4}","\u{1F440}","\u{1F483}","\u{1F483}\u{1F3FB}","\u{1F483}\u{1F3FC}","\u{1F483}\u{1F3FD}","\u{1F483}\u{1F3FE}","\u{1F483}\u{1F3FF}","\u{1F454}","\u{1F457}","\u{1F459}","\u{1F458}","\u{1F460}","\u{1F452}","\u{1F3A9}","\u{1F431}","\u{1F43B}","\u{1F436}","\u{1F43C}","\u{1F42F}","\u{1F981}","\u{1F42E}","\u{1F437}","\u{1F419}","\u{1F435}","\u{1F412}","\u{1F414}","\u{1F426}","\u{1F434}","\u{1F984}","\u{1F41D}","\u{1F422}","\u{1F420}","\u{1F410}","\u{1F54A}","\u{1F415}","\u{1F408}","\u{1F409}","\u{1F432}","\u{1F384}","\u{1F340}","\u{1F33B}","\u{1F339}","\u{1F490}","\u{1F344}","\u2600\uFE0F","\u{1F327}","\u26BD\uFE0F","\u{1F3C0}","\u{1F3C8}","\u26BE\uFE0F","\u{1F3BE}","\u{1F3D2}","\u26F7","\u{1F3C4}","\u{1F3CA}","\u{1F6B4}","\u{1F3AD}","\u{1F3A8}","\u{1F3B7}","\u{1F3BA}","\u{1F3B8}","\u{1F3BB}","\u{1F3B0}","\u{1F3B3}","\u{1F697}","\u{1F695}","\u{1F68C}","\u{1F68E}","\u{1F691}","\u{1F692}","\u{1F69C}","\u{1F682}","\u2708\uFE0F","\u26F5\uFE0F","\u{1F6F0}","\u{1F301}","\u{1F30B}","\u{1F3DE}","\u{1F305}","\u{1F386}","\u{1F308}","\u{1F3E0}","\u{1F3E5}","\u{1F3EB}","\u231A\uFE0F","\u{1F4F1}","\u{1F5A5}","\u{1F4BE}","\u{1F4FC}","\u{1F3A5}","\u260E\uFE0F","\u{1F4FA}","\u{1F4FB}","\u{1F4E1}","\u{1F56F}","\u{1F4B0}","\u{1F48E}","\u{1F6AC}","\u26B0","\u{1F52E}","\u{1F488}","\u{1F6BD}","\u{1F511}","\u{1F6CF}","\u{1F389}","\u{1F38A}","\u2764\uFE0F","\u{1F921}","\u{1F600}","\u{1F62C}","\u{1F601}","\u{1F602}","\u{1F603}","\u{1F604}","\u{1F605}","\u{1F606}","\u{1F607}","\u{1F609}","\u{1F60A}","\u{1F642}","\u{1F643}","\u263A\uFE0F","\u{1F60B}","\u{1F60C}","\u{1F60D}","\u{1F618}","\u{1F617}","\u{1F619}","\u{1F61A}","\u{1F61C}","\u{1F61D}","\u{1F61B}","\u{1F911}","\u{1F913}","\u{1F60E}","\u{1F917}","\u{1F60F}","\u{1F636}","\u{1F610}","\u{1F611}","\u{1F612}","\u{1F644}","\u{1F914}","\u{1F633}","\u{1F61F}","\u{1F620}","\u{1F614}","\u{1F615}","\u{1F641}","\u2639\uFE0F","\u{1F623}","\u{1F62B}","\u{1F629}","\u{1F631}","\u{1F628}","\u{1F630}","\u{1F62F}","\u{1F626}","\u{1F622}","\u{1F62A}","\u{1F613}","\u{1F62D}","\u{1F635}","\u{1F632}","\u{1F910}","\u{1F637}","\u{1F912}","\u{1F915}","\u{1F634}","\u{1F480}","\u2620\uFE0F","\u{1F47D}","\u{1F63A}","\u{1F638}","\u{1F639}","\u{1F63B}","\u{1F63C}","\u{1F63D}","\u{1F640}","\u{1F63F}","\u{1F63E}","\u{1F444}","\u{1F48B}","\u{1F445}","\u{1F5E3}","\u{1F464}","\u{1F465}","\u{1F456}","\u{1F463}","\u{1F461}","\u{1F462}","\u{1F45E}","\u{1F45F}","\u{1F393}","\u{1F451}","\u{1F45C}","\u{1F45B}","\u{1F4BC}","\u{1F453}","\u{1F576}","\u{1F48D}","\u{1F302}","\u2744\uFE0F","\u{1F32A}","\u26A1\uFE0F","\u{1F951}","\u{1F98B}","\u{1F648}","\u{1F649}","\u{1F64A}","\u{1F427}","\u{1F577}","\u{1F982}","\u{1F980}","\u{1F40D}","\u{1F41B}","\u{1F40C}","\u{1F41E}","\u{1F41C}","\u{1F41F}","\u{1F421}","\u{1F42C}","\u{1F433}","\u{1F40B}","\u{1F40A}","\u{1F406}","\u{1F332}","\u{1F333}","\u{1F334}","\u{1F331}","\u{1F33F}","\u{1F343}","\u{1F342}","\u{1F341}","\u{1F33A}","\u{1F33C}","\u{1F338}","\u{1F330}","\u{1F383}","\u{1F41A}","\u{1F578}","\u{1F30E}","\u{1F30D}","\u{1F30F}","\u{1F315}","\u{1F316}","\u{1F317}","\u{1F318}","\u{1F311}","\u{1F312}","\u{1F313}","\u{1F314}","\u{1F31A}","\u{1F31D}","\u{1F31B}","\u{1F31C}","\u{1F31E}","\u{1F319}","\u2B50\uFE0F","\u{1F31F}","\u{1F4AB}","\u2728","\u2604\uFE0F","\u{1F354}","\u{1F373}","\u{1F35F}","\u{1F32D}","\u{1F35D}","\u{1F32E}","\u{1F32F}","\u{1F363}","\u{1F368}","\u{1F366}","\u{1F377}","\u{1F379}","\u{1F3C6}","\u{1F3AA}","\u{1F3B9}","\u{1F680}","\u26F2\uFE0F","\u{1F3A2}","\u26F0","\u{1F3D4}","\u{1F5FB}","\u{1F4AF}","\u{1F3B5}","\u{1F3B6}","\u{1F4AC}","\u{1F4AD}","\u{1F5EF}","\u{1F0CF}","\u{1F3F3}\uFE0F\u200D\u{1F308}","\u{1F953}","\u{1F943}","\u{1F3A4}","\u{1F6A8}","\u{1F3CD}","\u{1F3D5}","\u26FA\uFE0F","\u{1F3DC}","\u{1F3D6}","\u{1F3DD}","\u{1F307}","\u{1F306}","\u{1F3D9}","\u{1F303}","\u{1F3D8}","\u{1F3E1}","\u{1F3E2}","\u{1F528}","\u2699","\u{1F52B}","\u{1F4A3}","\u{1F52A}","\u{1F48A}","\u{1F573}","\u{1F489}","\u{1F6C1}","\u26F1","\u{1F381}","\u{1F388}","\u{1F380}","\u{1F4C5}","\u{1F5F3}","\u{1F4DA}","\u270F\uFE0F","\u26AA\uFE0F","\u26AB\uFE0F","\u2B1B\uFE0F","\u2B1C\uFE0F","\u{1F5BC}","\u{1F3DA}","\u{1F3ED}","\u{1F532}","\u{1F533}","\u{1F3B1}","\u{1F53A}","\u{1F53B}","\u{1F4A6}","\u26F3\uFE0F","\u{1F3DF}","\u{1F4A1}","\u{1F52D}","\u{1F52C}","\u{1F570}","\u{1F42A}","\u{1F42B}","\u{1F418}","\u{1F438}","\u{1F430}","\u{1F42D}","\u{1F6AA}","\u{1F6CD}","\u{1F441}","\u{1F353}","\u{1F352}","\u{1F336}","\u{1F33D}","\u{1F360}","\u{1F36F}","\u{1F35E}","\u{1F36B}","\u{1F37F}","\u{1F36A}","\u{1F34A}","\u{1F3F9}","\u{1F46F}","\u{1F46F}\u200D\u2642\uFE0F","\u{1F5D1}"]:i;var _=[];t.loop(this.emojiData,function(k){var $=new t.Emoji(k,p,l);_.push($)}),this.wrapper=new t.Wrapper({items:_,width:e,alignInner:t.CENTER,valignInner:t.CENTER,wrapperType:"column",colSize:v,rowSize:I}).cur(),this.backdrop=new t.Rectangle(this.wrapper.width,this.wrapper.height,t.faint),t.timeout(.2,function(){Y.scrollBar&&Y.scrollBar.vertical&&Y.scrollBar.vertical.getBounds()&&Y.scrollBar.vertical.expand(),Y.backdrop.heightOnly=Y.wrapper.height,T&&Y.wrapper.cache()}),this.add(this.backdrop),this.add(this.wrapper),this.wrapper.tap(function(k){Y.currentEmoji=k.target,Y.dispatchEvent("change")}),g!==!1&&t.styleTransforms(this,L),this.clone=function(){return Y.cloneProps(new t.EmojiPicker(e,r,g,this.group,A))},this.dispose=function(){return!0}},t.extend(t.EmojiPicker,t.Window,["clone","dispose"],"zimWindow",!1),t.TextEditor=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O,X,R,Q,K,q,ne,U,D){var d="width, color, backgroundColor, fieldColor, fieldHeight, textSize, sizeList, optionList, colorList, fontList, live, button, titleBar, titleBarColor, titleBarBackgroundColor, titleBarHeight, wrap, limit, scroll, placeholder, password, borderColor, borderWidth, margin, corner, shadowColor, shadowBlur, draggable, boundary, frame, fontListHeight, fontListViewNum, style, group, inherit",u;if(u=st(t.TextEditor,arguments,d,this))return u;De("67.1"),this.group=U;var o=ne===!1?{}:t.getStyle("TextEditor",this.group,D);if(n(e)&&(e=o.width!=null?o.width:400),n(i)&&(i=o.backgroundColor!=null?o.backgroundColor:t.lighter),n(P)&&(P=o.titleBar!=null?o.titleBar:"Text Editor"),n(X)&&(X=o.draggable!=null?o.draggable:!0),n(I)&&(I=o.titleBarHeight!=null?o.titleBarHeight:30),n(l)&&(l=o.fieldColor!=null?o.fieldColor:i.darken(.05)),n(p)&&(p=o.live!=null?o.live:!0),n(g)&&(g=o.wrap!=null?o.wrap:!0),n(A)&&(A=o.scroll!=null?o.scroll:!0),n(_)&&(_=o.margin!=null?o.margin:10),n(E)&&(E=o.limit!=null?o.limit:null),n(P)&&(P=o.titleBar!=null?o.titleBar:null),n(f)&&(f=o.sizeList!=null?o.sizeList:null),n(w)&&(w=o.colorList!=null?o.colorList:null),n(c)&&(c=o.optionList!=null?o.optionList:null),n(T)&&(T=o.fontList!=null?o.fontList:null),n(l)&&(l=o.fieldColor!=null?o.fieldColor:null),n(a)&&(a=o.fieldHeight!=null?o.fieldHeight:null),n(s)&&(s=o.textSize!=null?o.textSize:null),n(K)&&(K=o.fontListHeight!=null?o.fontListHeight:100),n(q)&&(q=o.fontListViewNum!=null?o.fontListViewNum:3),typeof Q>"u")if(j.zdf)var Q=j.zdf;else{dt&&tt("zim.TextEditor - please provide a reference to zim Frame");return}this.zimPanel_constructor(e,300,null,P,m,v,I,i,L,Y,k,!0,null,null,null,null,null,null,null,null,$,O,X,R,ne,U,D);var S=this;n(x)&&(x=new t.Button({width:50,height:50,label:"",icon:new t.Shape().sca(.4).f("white").p("AikFsQg5jmhphxIA1gXQBeBGA3CwQC8mRCpjOIBfAoQkPFGiSFpg"),color:t.white,corner:10,backgroundColor:t.green.darken(.2),borderColor:t.white,borderWidth:2,rollBackgroundColor:t.green,shadowBlur:3}).pos(_,I+_*2,t.RIGHT,t.TOP,S)),S.button=x,x.on((Pt?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",F),n(a)&&(a=o.fieldHeight!=null?o.fieldHeight:x.height+_*2);function F(){p||(b.text=h.text),S.hide(),S.dispatchEvent("set")}var h=S.textArea=new t.TextArea({color:r,backgroundColor:l,width:e-x.width-_*3,height:n(a)?x.height+_*2:a,expand:10,password:C,placeholder:y,frame:Q}).loc(_,I+_+(a&&a<x.height+_*2?(x.height-a)/2+_:0),null,null,!1);g||(h.tag.style.whiteSpace="nowrap"),E&&h.tag.setAttribute("maxLength",E),A&&(h.tag.style.overflowY="auto");var b=new t.Label;S.on("pressmove",function(){h.resize()}),S.on("close",function(){S.inputEvent&&h.off("input",S.inputEvent),h.removeFrom()}),S.panelHeight=I+_+Math.max(a,x.height+_*2)+_;var ye=t.mobile(),B=ye?35:30;if(f||c||w){new t.Rectangle(e,B+_,"rgba(0,0,0,.05)").loc(0,S.panelHeight,S);var N=[];if(w){var re=Array.isArray(w),le=S.colorPicker=new t.ColorPicker({colors:re?w:null,cols:re?Math.min(w.length,12):null,alphaPicker:!1,greyPicker:!re,container:Q.stage});le.on("close",pe),le.on("change",function(){b.color=r.color=le.selectedColor,S.dispatchEvent("update"),pe()}),S.closeColorPicker=function(){pe()},r=S.swatch=new t.Rectangle(B,B,b.color,t.dark,1).cur(),r.on("mousedown",function(){S.dispatchEvent("color"),h.tag.style.display="none",le.selectedColor=r.color,le.show(),S.stage&&S.stage.update()}),N.push(r)}if(c){c===!0&&(c=["bold","italic","align"]),n(j.STYLE)&&(j.STYLE={}),n(j.STYLE.group)&&(j.STYLE.group={}),j.STYLE.group.zimEditor={width:B,height:B,corner:0,borderColor:t.tin,shadowBlur:-1,backgroundColor:t.light,rollBackgroundColor:t.light,toggleBackgroundColor:t.green,toggleColor:t.grey};var G,z,se;t.loop(c,function(ke){if(ke.toLowerCase()=="bold")G=S.bold=new t.Button({label:new t.Label({text:"B",color:t.grey,size:16,bold:!0}),toggle:"B",group:"zimEditor"}),G.on("click",function(){b.bold=G.toggled,S.dispatchEvent("update"),S.stage&&S.stage.update()}),N.push(G),b.bold&&G.toggle();else if(ke.toLowerCase()=="italic")z=S.italic=new t.Button({label:new t.Label({text:"I",color:t.grey,size:16,bold:!0,italic:!0}),toggle:"I",group:"zimEditor"}),z.on("click",function(){b.italic=z.toggled,S.dispatchEvent("update"),S.stage&&S.stage.update()}),N.push(z),b.italic&&z.toggle();else if(ke.toLowerCase()=="align"){var oe=new t.Tile(new t.Rectangle(B-10,B-10,t.grey).centerReg(),3,1,10,10),Ce=ye?["\u21DA","\u21D4","\u21DB"]:["\u21D0","\u21D4","\u21D2"];t.loop(3,function(te){var ae=oe.getChildAt(te);new t.Label(Ce[te],B*2/3,null,t.white).center(ae).expand(10)});var Me=0;b.align=="right"?Me=2:(b.align=="center"||b.align=="middle")&&(Me=1),se=S.align=new t.Selector({tile:oe,corner:0,borderWidth:1,borderColor:t.grey,backgroundColor:t.clear,selectedIndex:Me}),se.on("change",function(){se.selectedIndex==0?b.align="left":se.selectedIndex==1&&(b.align="center"),se.selectedIndex==2&&(b.align="right"),S.dispatchEvent("update"),S.stage&&S.stage.update()}),N.push(se)}}),delete j.STYLE.group.zimEditor}if(f){var Oe=S.sizePicker=new t.Stepper({list:f===!0?null:f,stepperType:f===!0?null:"list",min:f===!0?5:null,max:f===!0?500:null,width:150,shadowBlur:-1,borderColor:t.dark,borderWidth:2,corner:0,backgroundColor:t.green,downForward:!1}).siz(null,B);Oe.arrowPrev.expand(0),Oe.textBox.color=t.lighter,Oe.on("change",function(){b.size=Oe.currentValue,S.dispatchEvent("update"),S.stage&&S.stage.update()}),Oe.currentValue=b.size,N.push(Oe)}var J=new t.Tile(N,N.length,1,10,10,!0).loc(_,S.panelHeight+_/2,S);S.panelHeight=S.panelHeight+_+J.height+_}function pe(){h.tag.style.display="block",le.hide(),S.stage&&S.stage.update()}var Z;if(T){Array.isArray(T)?Z=T:(Z=["Arial","Courier New","Georgia","Helvetica","Palatino","Tahoma","Verdana"],ye||(Z=Z.concat(["Comic Sans MS","Impact"])),Z.sort());var de=S.fonts=new t.List({width:e-_*2,height:K,viewNum:q,backgroundColor:t.moon,color:t.grey,rollColor:t.dark,rollBackgroundColor:t.green.lighten(.5),selectedBackgroundColor:t.mist,selectedRollBackgroundColor:t.green.lighten(.6),selectedColor:t.dark,backdropColor:t.light,scrollBarColor:t.dark,shadowBlur:-1,list:Z}).center(S).loc(null,S.panelHeight);de.on("change",function(){b.font=de.currentValue,S.dispatchEvent("update"),S.stage&&S.stage.update()}),S.panelHeight=S.panelHeight+_+de.height+_}S.show=function(ke,oe,Ce,Me){if(S.parent)return ke==S.label||(S.label=ke),S;b=ke,h.addTo(S);var te;if(b&&b.stage)te=b.stage;else if(Me)te=Me.stage;else if(j.zdf)te=j.zdf.stage;else return S;return!n(oe)||!n(Ce)?S.loc(oe,Ce):b&&b.y>te.height/2?S.loc(te.width/2-e/2,b.y-S.panelHeight-te.height*.05,te):b&&b.y<=te.height/2?S.loc(te.width/2-e/2,b.y+b.height+te.height*.05,te):S.center(te),S.y<20&&(S.y=20),S.y+S.height>S.stage.height&&(S.y=S.stage.height-S.height-20),V(),S.stage.update(),S};function V(){b&&(h.text=b.text),r&&(r.color=b.color),G&&G.toggle(b.bold==!0),z&&z.toggle(b.italic==!0),se&&(se.noAnimate=!0,b.align=="center"?se.selectedIndex=1:b.align=="right"?se.selectedIndex=2:se.selectedIndex=0),Oe&&(Oe.currentValue=b.size),de&&(de.currentValue=b.font),S.inputEvent&&h.off("input",S.inputEvent),S.inputEvent=h.on("input",function(){p&&b&&(b.text=h.text),S.dispatchEvent("input"),S.dispatchEvent("update"),S.stage&&S.stage.update()})}S.hide=function(){if(w&&le.hide(),h&&h.removeFrom(),!n(S.stage)){var ke=S.stage;return S.removeFrom(),ke.update(),S}},j.KEYFOCUS!=null&&(t.KEYFOCUS=j.KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return t.KEYFOCUS==S},set:function(){t.KEYFOCUS=S}}),t.KEYFOCUS||fe(),this.on("mousedown",function(){fe()});function fe(){S.keyFocus=!0}Object.defineProperty(S,"label",{get:function(){return b},set:function(ke){b=ke,V()}}),ne!==!1&&t.styleTransforms(this,o),this.clone=function(){return S.cloneProps(new t.TextEditor(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O,X,R,Q,K,q,ne,this.group,D))},this.dispose=function(ke,oe,Ce){return S.inputEvent&&h.off("input",S.inputEvent),le&&le.dispose(),r&&r.dispose(),de&&de.dispose(),x&&x.dispose(),h&&h.dispose(),se&&se.dispose(),G&&G.dispose(),z&&z.dispose(),Oe&&Oe.dispose(),Ce||this.zimPanel_dispose(),S.stage&&S.stage.update(),S.textArea=S.color=S.colorPicker=S.font=S.button=S.selector=S.bold=S.italic=S.size=null,!0}},t.extend(t.TextEditor,t.Panel,["clone","dispose"],"zimPanel",!1),t.Keyboard=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O,X,R,Q,K,q,ne){var U="labels, backgroundColor, color, shiftBackgroundColor, shiftHoldBackgroundColor, placeBackgroundColor, placeColor, cursorColor, shadeAlpha, borderColor, borderWidth, margin, corner, draggable, placeClose, shadowColor, shadowBlur, container, data, place, placeShiftH, placeShiftV, special, rtl, hardKeyboard, layout, numPadScale, numPadDraggable, numPadOnly, numPadAdvanced, style, group, inherit",D;if(D=st(t.Keyboard,arguments,U,this))return D;De("67.2"),this.zimContainer_constructor(1e3,400,null,null,!1),this.type="Keyboard",this.group=q;var d=K===!1?{}:t.getStyle(this.type,this.group,ne);n(e)&&(e=d.labels!=null?d.labels:[]),Array.isArray(e)||(e=[e]),n(r)&&(r=d.backgroundColor!=null?d.backgroundColor:t.dark),n(i)&&(i=d.color!=null?d.color:t.white),n(l)&&(l=d.shiftBackgroundColor!=null?d.shiftBackgroundColor:"orange"),n(a)&&(a=d.shiftHoldBackgroundColor!=null?d.shiftHoldBackgroundColor:"red"),n(s)&&(s=d.placeBackgroundColor!=null?d.placeBackgroundColor:t.blue),n(f)&&(f=d.placeColor!=null?d.placeColor:i),n(c)&&(c=d.cursorColor!=null?d.cursorColor:t.blue),n(w)&&(w=d.shadeAlpha!=null?d.shadeAlpha:.2),n(T)&&(T=d.borderColor!=null?d.borderColor:"rgba(0,0,0,.1)"),n(p)&&(p=d.borderWidth!=null?d.borderWidth:null),T<0||p<0?T=p=null:T!=null&&p==null&&(p=1),n(x)&&(x=d.margin!=null?d.margin:5),n(P)&&(P=d.corner!=null?d.corner:30),n(m)&&(m=d.draggable!=null?d.draggable:!1),n(v)&&(v=d.placeClose!=null?d.placeClose:!0),n(I)&&(I=d.shadowColor!=null?d.shadowColor:"rgba(0,0,0,.2)"),n(g)&&(g=d.shadowBlur!=null?d.shadowBlur:14),n(A)&&(A=d.data!=null?d.data:[[["q","w","e","r","t","y","u","i","o","p"],["a","s","d","f","g","h","j","k","l"],["shift","z","x","c","v","b","n","m","backspace"],["?123","@"]],[["1","2","3","4","5","6","7","8","9","0"],["!","@","#","$","/","^","&","*","(",")"],["1/2","-","'",'"',":",";",",","?","backspace"],["ABC","@"]],[["+","x","%","=","<",">","{","}","[","]"],["\u20AC","\xA3","\xA5","$","\uFFE6","~","`","\xA4","\u2661","\u2606"],["2/2","_","\\","|","\u300A","\u300B","\xA1","\xBF","backspace"],["ABC","@"]]]),A[3]||(A[3]={e:["\u0117","\u0113","\u0119","\xEA","\xE9","\xEB","\xE8"],u:["\u016B","\xFB","\xFA","\xFC","\xF9"],i:["\u012B","\u012F","\xEC","\xED","\xEF","\xEE"],o:["\u014D","\u0153","\xF8","\xF5","\xF4","\xF3","\xF6","\xF2"],a:["\u0101","\xE3","\xE5","\xE2","\xE1","\xE4","\xE0","\xE6"],n:["\xF1","\u0144"]});var u=this;n(y)&&(y=d.place!=null?d.place:!0),n(C)&&(C=d.placeShiftH!=null?d.placeShiftH:0),n(L)&&(L=d.placeShiftV!=null?d.placeShiftV:0),n(_)&&(_=d.rtl!=null?d.rtl:!1),n(k)&&(k=d.hardKeyboard!=null?d.hardKeyboard:!0),n(O)&&(O=d.numPadScale!=null?d.numPadScale:.8),n(R)&&(R=d.numPadOnly!=null?d.numPadOnly:!1),n(X)&&(X=d.numPadDraggable!=null?d.numPadDraggable:!0),n(Q)&&(Q=d.numPadAdvanced!=null?d.numPadAdvanced:!1),n($)&&($=d.layout!=null?d.layout:"qwerty"),$=$.toLowerCase(),$!="qwerty"&&($=="arabic"?A=[[["\u0636","\u0635","\u062B","\u0642","\u0641","\u063A","\u0639","\u0647","\u062E","\u062D","\u062C"],["\u0634","\u0633","\u064A","\u0628","\u0644","\u0627","\u062A","\u0646","\u0645","\u0643","\u0637"],["\u0630","\u0621","\u0624","\u0631","\u0649","\u0629","\u0648","\u0632","\u0638","\u062F","back"],["?123","\u0640"]],[["1","2","3","4","5","6","7","8","9","0","*"],["!","@","#","$","/","^","&","*","(",")","*"],["1/2","-","'",'"',":",";",",","?","*","backspace"],["ABC","*"]],[["+","x","%","=","<",">","{","}","[","]","*"],["\u20AC","\xA3","\xA5","$","\uFFE6","~","`","\xA4","\u2661","\u2606","*"],["2/2","_","\\","|","\u300A","\u300B","\xA1","\xBF","*","backspace"],["ABC","*"]],{\u0627:["\u0623","\u0625","\u0622","\u0621"],\u0649:["\u0626"],\u0621:["\u0626","\u0624"],\u0648:["\u0624"],\u0640:["\u064D","\u064B","\u064C","\u0652","\u064F","\u0650","\u064E","\u0651"],"*":["\u064D","\u064B","\u064C","\u0652","\u064F","\u0650","\u064E","\u0651"],n:["\xF1","\u0144"]}]:$=="hebrew"?A=[[["\u05E7","\u05E8","\u05D0","\u05D8","\u05D5","\u05DF","\u05DD","\u05E4","backspace"],["\u05E9","\u05D3","\u05D2","\u05DB","\u05E2","\u05D9","\u05D7","\u05DC","\u05DA","\u05E3"],["\u05D6","\u05E1","\u05D1","\u05E0","\u05D4","\u05DE","\u05E6","\u05EA","\u05E5"],["?123","@"]],[["1","2","3","4","5","6","7","8","9","0"],["!","@","#","$","/","^","&","*","(",")"],["1/2","-","'",'"',":",";",",","?","backspace"],["ABC","@"]],[["+","x","%","=","<",">","{","}","[","]"],["\u20AC","\xA3","\xA5","$","\uFFE6","~","`","\xA4","\u2661","\u2606"],["2/2","_","\\","|","\u300A","\u300B","\xA1","\xBF","backspace"],["ABC","@"]],{e:["\u0117","\u0113","\u0119","\xEA","\xE9","\xEB","\xE8"],u:["\u016B","\xFB","\xFA","\xFC","\xF9"],i:["\u012B","\u012F","\xEC","\xED","\xEF","\xEE"],o:["\u014D","\u0153","\xF8","\xF5","\xF4","\xF3","\xF6","\xF2"],a:["\u0101","\xE3","\xE5","\xE2","\xE1","\xE4","\xE0","\xE6"],n:["\xF1","\u0144"]}]:$=="azerty"?A=[[["a","z","e","r","t","y","u","i","o","p"],["q","s","d","f","g","h","j","k","l","m"],["shift","w","x","c","v","b","n","\xB4","backspace"],["?123","@"]],[["1","2","3","4","5","6","7","8","9","0"],["!","@","#","$","/","^","&","*","(",")"],["1/2","-","'",'"',":",";",",","?","backspace"],["ABC","@"]],[["+","x","%","=","<",">","{","}","[","]"],["\u20AC","\xA3","\xA5","$","\uFFE6","~","`","\xA4","\u2661","\u2606"],["2/2","_","\\","|","\u300A","\u300B","\xA1","\xBF","backspace"],["ABC","@"]],{e:["\u0117","\u0113","\u0119","\xEA","\xE9","\xEB","\xE8"],u:["\u016B","\xFB","\xFA","\xFC","\xF9"],i:["\u012B","\u012F","\xEC","\xED","\xEF","\xEE"],o:["\u014D","\u0153","\xF8","\xF5","\xF4","\xF3","\xF6","\xF2"],a:["\u0101","\xE3","\xE5","\xE2","\xE1","\xE4","\xE0","\xE6"],n:["\xF1","\u0144"]}]:$=="turkish"&&(A=[[["q","w","e","r","t","y","u","\u0131","o","p","\u011F","\xFC"],["a","s","d","f","g","h","j","k","l","\u015F","i"],["shift","z","x","c","v","b","n","m","\xF6","\xE7","backspace"],["?123","*"]],[["1","2","3","4","5","6","7","8","9","0","*"],["!","@","#","$","/","^","&","*","(",")","*"],["1/2","-","'",'"',":",";",",","?","*","backspace"],["ABC","*"]],[["+","x","%","=","<",">","{","}","[","]","*"],["\u20AC","\xA3","\xA5","$","\uFFE6","~","`","\xA4","\u2661","\u2606","*"],["2/2","_","\\","|","\u300A","\u300B","\xA1","\xBF","*","backspace"],["ABC","*"]],{e:["\u0117","\u0113","\u0119","\xEA","\xE9","\xEB","\xE8"],u:["\u016B","\xFB","\xFA","\xFC","\xF9"],i:["\u012B","\u012F","\xEC","\xED","\xEF","\xEE"],o:["\u014D","\u0153","\xF8","\xF5","\xF4","\xF3","\xF6","\xF2"],a:["\u0101","\xE3","\xE5","\xE2","\xE1","\xE4","\xE0","\xE6"],n:["\xF1","\u0144"]},{\u0131:"I",i:"\u0130"},{I:"\u0131",\u0130:"i"}])),u.data=A;var o="zim display - Keyboard(): Please pass in a reference to a container with bounds set";if(n(E))if(j.zdf)E=j.zdf.stage;else{tt(o);return}else if(E.getBounds){if(n(E.stage)){tt("zim display - Keyboard(): The container must have a stage property");return}}else{tt(o);return}I!=-1&&g>0&&(u.shadow=new Ne.Shadow(I,3,3,g));var S=j.zdf?j.zdf.stage:null;u.labels=e;var F,h=10;t.loop(A[0],function(Ae){Ae.length>h&&(h=Ae.length)});var b=h,ye=["/","",",",".","numpad","away"];n(Y)||ye.splice(1,0,Y);var B=t.copy(A[0]);B[3]=B[3].concat(ye);var N=t.copy(A[1]);N[3]=N[3].concat(ye);var re=t.copy(A[2]);re[3]=re[3].concat(ye);var le=[],G=(1e3-(b-1)*5)/b,z={def:"default",shift:"shift",number1:"number1",number2:"number2"},se=z.def,Oe,J,pe,Z=!1,de,V,fe=0,ke,oe=[],Ce,Me,te,ae,we,ue,Pe,ie;Re(),ee(se),m&&_e(),this.on("mousedown",be);function be(Ae){S=u.stage,J&&u.removeChild(J),ke&&oe.indexOf(Ae.target)<0&&ge(),n(Ae.target.na)||(m&&Ae.target===Pe?(u.tickerMouseEvent=S.on("stagemousemove",function(Ye){u.mouseYAmount=Ye.stageY}),t.Ticker.add(at),u.on("pressup",Be),ie=Ae.stageY-u.localToGlobal(0,0).y):!n(Y)&&Ae.target.na===Y?u.dispatchEvent("special"):Ae.target.na==="shift"?me():Ae.target.toggle==="?123"?(u.removeChild(Oe),ee(z.number1)):Ae.target.toggle==="ABC"?(u.removeChild(Oe),se=z.def,ee(),Z&&me(!0)):Ae.target.toggle==="1/2"?(u.removeChild(Oe),ee(z.number2)):Ae.target.toggle==="2/2"?(u.removeChild(Oe),ee(z.number1)):Ae.target.na==="numpad"?Ze(Ae.target):Ae.target.na==="away"?(u.hideKeyboard(),u.dispatchEvent("close")):A[3]&&A[3][Ae.target.na]?Ie(Ae.target.na):Ae.target.na==="return"?xe(`
`):Ae.target.na==="backspace"||Ae.target.na==="back"?qe():Ae.target.na===""?xe(" "):xe(Ae.target.na),S.update())}u.addChar=function(Ae){!n(Ae)&&Ae.match(/^.$/)&&xe(Ae)},u.removeChar=function(){qe(!0)},u.clearText=function(){V.text="",qe(!0),Ge(),u.selectedIndex=0},u.setText=function(Ae){V.text=Ae,Ge(),u.selectedIndex=Ae.length};var Le;function me(Ae){var Ye=!1,Xe,Ue;if(se===z.def){for(de.color=Ae?a:l,Xe=0;Xe<le.length-6-(n(Y)?0:1);Xe++)Ue=le[Xe],Ue.label.text.length>0&&(Ue.na.length===1?(A[4]&&A[4][Ue.label.text]?Ue.label.text=A[4][Ue.label.text]:Ue.label.text=Ue.label.text.toUpperCase(),Ue.label.centerReg(Ue).mov(0,6)):Ue.label.centerReg(Ue));Ae||(Ye=!0,setTimeout(rt,500),Le=u.on("pressup",Te)),se=z.shift}else{for(de.color=r,Z=!1,Xe=0;Xe<le.length-6;Xe++)Ue=le[Xe],Ue.label.text.length>0&&(Ue.na.length===1?(A[5]&&A[5][Ue.label.text]?Ue.label.text=A[5][Ue.label.text]:Ue.label.text=Ue.label.text.toLowerCase(),Ue.label.centerReg(Ue).mov(0,3)):Ue.label.centerReg(Ue));se=z.def}Oe.updateCache(),u.stage&&u.stage.update();function rt(){Ye&&(Z=!0,de.color=a,Oe.updateCache(),u.stage&&u.stage.update())}function Te(){u.off("pressup",Le),Ye=!1}}function ee(Ae){var Ye,Xe,Ue,rt=0,Te=0,$e,lt,Qe=!1,ot,ft,ut=!1;n(Ae)&&(Ae=z.def),Ae===z.def?Ye=B:Ae===z.number1?Ye=N:Ae===z.number2&&(Ye=re),u.keys=Oe=new t.Container(1e3,430,null,null,!1).addTo(u).vis(!R);for(var ze=0;ze<Ye.length;ze++){(ze<=1||Ae==z.def&&ze==2&&Ye[2][0]!="shift")&&(rt=(G/2+2.5)*(b-Ye[ze].length));for(var kt=0;kt<Ye[ze].length;kt++){if(Qe=!1,ot=null,ut=!1,Ye[ze][kt]=="backspace"?(lt=!0,ot=Me,ut=!0):Ye[ze][kt]=="back"?(lt=!1,ot=Me,ut=!0):Ye[ze][kt]=="shift"?(lt=!0,ot=Ce):(ze==3||Ae!=z.def&&ze==2)&&kt==0?(lt=!0,ut=!0):Ye[ze][kt]==""?(lt=!1,Qe=!0):Ye[ze][kt]=="numpad"?(ot=ae,lt=!1,ut=!0):Ye[ze][kt]=="away"?(ot=te,lt=!0,ut=!0):lt=!1,lt?$e=G*1.5+2.5:Qe?($e=(G+5)*((n(Y)?3:2)+b-10+1-A[0][3].length)-5,A[0][3].indexOf("backspace")!=-1&&($e-=G/2)):$e=G,Ue=new t.Rectangle($e,G,r,T,p,P,null,null,null,!1).cur().addTo(Oe),ut&&Ue.addChild(new t.Rectangle($e,G,"black",null,null,P,null,null,null,!1).alp(w)),ot?Ue.label=Xe=new t.Label({text:"",backgroundColor:"ignore",font:d.font!=null?d.font:null,style:!1}):Ue.label=Xe=new t.Label({lineWidth:10,lineHeight:25,font:d.font!=null?d.font:null,text:Ye[ze][kt],color:i,align:"center",style:!1}),ot){var Mt=ot.clone(),xt;Ye[ze][kt]=="numpad"?(xt=60,ue=Ue):xt=70,Mt.scaleTo(Ue,xt,xt),Mt.centerReg(Ue)}ft?(ft=!1,rt+=67.33):(Xe.centerReg(Ue).mov(0,isNaN(Xe.text)?3:7),Ue.x=rt,Ue.y=Te,Ue.na=Ye[ze][kt],ze==2&&kt==0&&Ae==z.number1&&(Ue.toggle="1/2"),ze==2&&kt==0&&Ae==z.number2&&(Ue.toggle="2/2"),ze==3&&kt==0&&Ae==z.def&&(Ue.toggle="?123"),ze==3&&kt==0&&Ae!=z.def&&(Ue.toggle="ABC"),Ue.toggle&&Xe.mov(0,3),le.push(Ue),Ue.na=="shift"&&(de=Ue),rt=Ue.x+Ue.width+5)}Te+=G+5,rt=0}Oe.cache(p?-p:0,p?-p:0,p?Oe.width+p*2:Oe.width,p?Oe.height+p*2:Oe.height)}function Ie(Ae){var Ye=A[3][Ae],Xe=!1,Ue=!1,rt;rt=t.timeout(500,lt,null,"ms");var Te=u.on("pressup",$e);function $e(){Xe=!0,u.off("pressup",Te),Ue||xe(Ae)}function lt(){var Qe,ot,ft,ut=0,ze;if(rt.clear(),!Xe){Ue=!0,J=new t.Container(1e3,G,null,null,!1).addTo(u,0),J.y=-G-5;for(var kt=0;kt<Ye.length;kt++)se===z.shift?ze=Ye[kt].toUpperCase():ze=Ye[kt],Qe=new t.Label({lineWidth:10,lineHeight:25,text:ze,font:d.font!=null?d.font:null,color:i,align:"center",style:!1}),ot=new t.Rectangle(G,G,r,T,p,P,null,null,null,!1).addTo(J),ft=new t.Rectangle(G,G,"white",null,null,P,null,null,null,!1).alp(.2),ot.addChild(ft),Qe.center(ot),ot.na=Ye[kt],ot.x=ut,ut+=G+5;u.stage&&u.stage.update()}}}function Re(){Ce=new t.Shape({style:!1}),Ce.graphics.f(i).p("AhIFoIAAjYIixAAID5n3ID6H3IixAAIAADYgAjHBxICeAAIAADYIBTAAIAAjYICeAAIjImSg"),Ce.setBounds(-51/2,-72/2,51,72),Me=new t.Container({style:!1});var Ae=new t.Shape({style:!1});Ae.graphics.f(i).p("ACgC+IigigIifCgQgGAGgJAAQgJAAgGgGQgGgGgBgJQABgJAGgGICgigIigifQgGgGgBgJQABgJAGgGQAGgGAJAAQAIAAAHAGICfCgICgigQAGgGAJAAQAJAAAGAGQAGAGABAJQgBAJgGAGIigCfICgCgQAGAGABAJQgBAJgGAGQgGAGgJAAQgJAAgGgGg"),Ae.setTransform(82.6,32),Ae.addTo(Me);var Ye=new t.Shape({style:!1});Ye.graphics.f(i).s().p("AkhFAQgcAAgUgUIkHj6QgVgUAAgeQAAgdAVgVIEHj6QAUgTAcAAINKAAQAdAAAUAUQAUAUAAAdIAAH1QAAAdgUATQgUAVgdAAgAk0kOIkGD8QgIAHAAALQAAALAIAIIEGD7QAIAHALAAINKAAQALAAAIgIQAHgHAAgLIAAn1QAAgLgHgIQgIgIgLAAItKAAQgLAAgIAHg"),Ye.setTransform(62.2,32),Ye.addTo(Me),Me.setBounds(0,0,125,64),te=new t.Container({style:!1}),te.setBounds(0,0,147,86);for(var Xe=[{p:"Ai+heIF9AAIi/C9g",transform:[73.4,76]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[128.4,43.2]},{p:"AnNAzIAAhlIObAAIAABlg",transform:[73,43.2]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[18.8,43.2]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[128.2,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[114.5,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[100.8,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[87.1,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[73.4,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[59.7,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[46,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[32.3,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[18.6,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[128,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[114.3,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[100.6,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[86.9,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[73.2,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[59.5,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[45.8,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[32.1,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[18.4,15.8]},{p:"AphEnQgzAAgkgkQglglAAgzIAAlVQAAgzAlglQAkgkAzAAITDAAQAzAAAkAkQAlAlAAAzIAAFVQAAAzglAlQgkAkgzAAgAqjjtQgcAcAAAnIAAFVQAAAnAcAbQAbAcAnAAITDAAQAnAAAcgcQAbgbAAgnIAAlVQAAgngbgcQgcgcgnAAIzDAAQgnAAgbAcg",transform:[73.4,29.5]}],Ue,rt=0;rt<Xe.length;rt++)Ue=new t.Shape({style:!1}),Ue.graphics.f(i).s().p(Xe[rt].p),Ue.setTransform(Xe[rt].transform[0],Xe[rt].transform[1]),Ue.addTo(te);ae=new t.Container({style:!1}),ae.setBounds(0,0,62,86),we=new t.Container({style:!1}),we.setBounds(0,0,62,86);for(var Te=[{p:"Ai+heIF9AAIi/C9g",transform:[33,76,1,1,180]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[46,43.2]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[32.3,43.2]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[18.8,43.2]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[46,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[32.3,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[18.6,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[45.8,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[32.1,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[18.4,15.8]}],rt=0;rt<Te.length;rt++){var $e=new t.Shape({style:!1});$e.graphics.f(i).s().p(Te[rt].p),$e.setTransform(Te[rt].transform[0],Te[rt].transform[1],Te[rt].transform[2],Te[rt].transform[3],Te[rt].transform[4]),$e.addTo(ae);var lt=new t.Shape({style:!1});lt.graphics.f(i).s().p(Te[rt].p),lt.setTransform(Te[rt].transform[0],Te[rt].transform[1]),lt.addTo(we)}$e.graphics.ef().s(white).ss(3).rr(-16,-14,60,55,10),lt.graphics.ef().s(white).ss(3).rr(-16,-14,60,55,10)}function _e(){Pe=new t.Rectangle(G*1.5+2.5+2.5,G,r,T,p,P,null,null,null,!1).addTo(u,0).cur();for(var Ae,Ye=0;Ye<4;Ye++)Ae=new t.Rectangle(Pe.width*.4,4,i,null,null,null,null,null,null,!1).centerReg(Pe).alp(.2),Ae.y-=-22+Ye*15;Pe.x=8.5*G+40,Pe.y=-G-5,Pe.na="drag"}function Ze(Ae){u.numPad||(u.numPad=new t.NumPad({advanced:Q,draggable:X}).sca(O),X||R?u.numPad.center({add:!1}):u.numPad.pos({x:0,y:8,horizontal:"center",vertical:"bottom",add:!1}),u.numPad.on("pressed",function(){u.numPad.key=="enter"?u.dispatchEvent("enter"):u.numPad.key=="backspace"?u.removeChar():u.numPad.key=="clear"?u.clearText():u.numPad.key=="space"?xe(" "):xe(u.numPad.key)}),u.numPad.on("close",function(){ue.removeChildAt(2),ae.clone().scaleTo(ue,60,60).centerReg(ue,2),Oe.updateCache(),(!u.keys.parent||!u.keys.visible)&&pe&&(pe.visible=!1,u.toggled=!1,ge())})),ue.removeChildAt(2),u.numPad.parent||Ae===!1?(u.numPad.removeFrom(),ae.clone().scaleTo(ue,60,60).centerReg(ue,2)):(!u.numPad.parent||Ae===!0)&&(u.numPad.addTo(),we.clone().scaleTo(ue,60,60).centerReg(ue,2)),Oe.updateCache(),u.stage&&u.stage.update()}function at(){u.mouseYAmount&&(u.y=u.parent.globalToLocal(0,u.mouseYAmount-ie).y)}function Be(){S.off("pressmousemove",u.tickerMouseEvent),t.Ticker.remove(at)}u.setBounds(1e3,400-(b-10)*26);function He(){if(!(!V||!pe)){for(var Ae=V.label.x+V.label.getBounds().x,Ye=0;Ye<fe;Ye++)Ae+=V.widthArray[Ye]?V.widthArray[Ye]:0;pe.heightOnly=V.getBounds().height*(V.backing&&n(V.padding)?.9:1)-(V.paddingV&&V.background?V.paddingV*2:0),pe.center(V),pe.x=Ae}}function et(){if(ke||!V)return u;var Ae=v?["<",">","x"]:["<",">"],Ye,Xe,Ue;oe=[],Ue=V.localToLocal(0,0,u),ke=u.place=new t.Container({style:!1}).addTo(u).cur();for(var rt=0;rt<Ae.length;rt++)Ye=new t.Rectangle(G,G,s,T,p,P,null,null,null,!1),Ae[rt]=="x"&&new t.Rectangle(G,G,"black",null,null,P,null,null,null,!1).alp(w).addTo(Ye),Xe=new t.Label({lineWidth:10,text:Ae[rt],backing:Ye,font:d.font!=null?d.font:null,color:f,align:"center",valign:"center",style:!1}),Xe.pos(0,0,t.LEFT,t.TOP,ke).cache(),Xe.x=Xe.x+rt*(G+5),oe.push(Xe);Ue=V.localToLocal(0,0,u),ke.x=Ue.x+C,ke.y=Ue.y+V.height+15+L,ke.on("click",Te);function Te($e){oe.indexOf($e.target)==0?fe>0&&fe--:oe.indexOf($e.target)==1?fe<V.text.length&&fe++:ge(),He()}u.stage&&u.stage.update()}function ge(){if(!ke)return u;ke.dispose(),ke=null}function xe(Ae){if(V){var Ye,Xe;if(Ae==="del")V&&(V.text=[V.text.slice(0,fe-1),V.text.slice(fe)].join("")),fe--,Ge();else{se===z.shift&&(Ae=Ae.toUpperCase());var Ue=V.text;Ye=V.clone().removeFrom(),Ye.text=Ae,Xe=Ye.label.getMeasuredWidth(),V.widthArray?V.widthArray.splice(fe,0,Xe):V.widthArray=[V.breedte],fe<V.text.length?V.text=[V.text.slice(0,fe),Ae,V.text.slice(fe)].join(""):V.text+=Ae,V&&V.label.getBounds().width<F?(fe++,He()):V.text=Ue}se===z.shift&&!Z&&(u.removeChild(Oe),ee(),se=z.def),He();var rt=new Ne.Event("keydown");rt.letter=Ae,u.dispatchEvent(rt),u.stage&&u.stage.update()}}function he(Ae){if(u.stage){var Ye,Xe=0,Ue=!1;V=Ae.target,V.widthArrayCheck||Ge(),F=V.label.lineWidth?V.label.lineWidth:1e4,Ye=V.globalToLocal(Ae.stageX/t.scaX,Ae.stageY/t.scaY),Ye.x-=V.label.x,Ye.y-=V.label.y;for(var rt=0;rt<V.widthArray.length;rt++)if(Xe+=V.widthArray[rt],Ye.x<Xe-V.widthArray[rt]/2+V.label.getBounds().x){fe=rt,Ue=!0;break}Ue||(fe=V.text.length),He(),y&&!ke&&V.text.length>0&&et(),ke&&V&&(V.text.length>0?(Ye=V.localToLocal(0,0,u),ke.x=Ye.x+C,ke.y=Ye.y+V.height+15+L):ge())}}function Ge(){if(V){var Ae=new t.Label("");V.widthArray=[];for(var Ye=0;Ye<V.text.length;Ye++)Ae=V.clone().removeFrom(),Ae.text=V.text[Ye],V.widthArray.push(Ae.label.getMeasuredWidth());Ae.text=V.text,V.widthArrayCheck=!0,He()}}function qe(Ae){var Ye=!0,Xe;function Ue(){(!V||V.text.length<1||u.currentIndex==0)&&(Ye=!1),Ye&&(rt(),Xe&&(Xe=t.timeout(200,Ue,null,"ms"))),V&&V.text.length<1&&Te()}function rt(){V&&V.text.length>0?(u.selectedIndex>0&&xe("del"),Ae?Te():u.on("pressup",Te)):xe("del")}function Te(){Ye=!1,Xe&&Xe.clear(),u.off("pressup",Te)}rt(),Xe=t.timeout(300,Ue,null,"ms"),u.stage&&u.stage.update()}function Fe(){for(var Ae=0;Ae<e.length;Ae++)e[Ae].clickEvent=e[Ae].on("click",he)}Fe();function We(){if(e.length>1)for(var Ae=0;Ae<e.length;Ae++)e[Ae].off("click",e[Ae].clickEvent)}function ce(){if(!pe&&(V=e[0],F=V&&V.label.lineWidth?V.label.lineWidth:1e4,V)){pe=new t.Rectangle(3,V.height-(V.paddingV&&V.background?V.paddingV*2:0),c,null,null,null,null,null,null,!1).center(V),pe.x=0,pe.visible=!1,pe.animate({obj:{alpha:0},rewind:!0,loop:!0,loopWait:750,time:250,id:"knipperTekst",timeUnit:"ms"});for(var Ae=0;Ae<e.length;Ae++)e[Ae].widthArray=[0];Ge()}}ce();function Ve(){t.stopAnimate("knipperTekst"),V&&V.removeChild(pe),pe=null,V=null}Object.defineProperty(this,"selectedLabel",{get:function(){return V},set:function(Ae){var Ye={target:Ae};he(Ye),u.hidePlace()}}),Object.defineProperty(this,"selectedIndex",{get:function(){return fe},set:function(Ae){fe=Ae,He()}}),this.show=function(Ae,Ye){if(u.addTo(E),!n(Ae)){var Xe={target:e[Ae]};he(Xe)}return pe&&(pe.visible=!0),u.toggled=!0,R?Ze():(!R||Ye)&&(u.keys.vis(!0),Se.vis(!0)),u.numPad&&u.numPad.parent&&u.numPad.top(),u},this.hide=function(){return u.removeFrom(E),Ze(!1),pe&&(pe.visible=!1),S.update(),u.toggled=!1,u},this.showNumPad=function(){Ze(!0),u.toggled=!0,pe&&(pe.visible=!0)},this.hideNumPad=function(){Ze(!1),(!u.keys.parent||!u.keys.visible)&&pe&&(pe.visible=!1,u.toggled=!1,ge())},this.showKeyboard=function(){u.show(null,!0)},this.hideKeyboard=function(){!u.numPad||!u.numPad.parent?u.hide():(u.keys.vis(!1),Se.vis(!1))},this.toggle=function(Ae){return Ae===!0?u.show():Ae===!1||u.parent?u.hide():u.show(),u},this.showPlace=function(){return et(),u},this.hidePlace=function(){return ge(),u},this.addLabels=function(Ae){Array.isArray(Ae)||(Ae=[Ae]);for(var Ye=Ae.length-1;Ye>=0;Ye--){var Xe=e.indexOf(Ae[Ye]);Xe>=0||Ae[Ye].type!="Label"?Ae.splice(Ye,1):Ae[Ye].widthArray=[0]}return We(),e=e.concat(Ae),Fe(),ce(),pe&&(pe.visible=!0),u},this.removeLabels=function(Ae){Array.isArray(Ae)||(Ae=[Ae]),We();for(var Ye=0;Ye<Ae.length;Ye++){var Xe=e.indexOf(Ae[Ye]);Xe>=0&&e.splice(Xe,1)}return Fe(),e.length==0?V&&Ve():V&&e.indexOf(V)==-1&&(Ve(),ce()),u};var Se=new t.Rectangle(this.width,this.height,t.clear,null,null,null,null,null,null,!1).addTo(this).expand().bot();Se.on("mousedown",function(){}),Se.on("click",function(){}),R&&Se.vis(!1),this.resize=function(){if(u.scaleTo(S,100-x*2/S.width*100,50-x*2/S.height*100),u.y=S.height-u.height-x,u.x=S.width/2-u.width/2,V&&ke){var Ae=V.localToLocal(0,0,u);ke.x=Ae.x,ke.y=Ae.y+V.height+15}return u.stage&&u.stage.update(),u},this.resize(),u.selectedLabel&&(u.selectedIndex=u.selectedLabel.text.length),k&&(this.keydownEvent=function(Ae){if(u.stage){var Ye=u;n(Ye)||(Ae.keyCode==35&&(Ye.selectedIndex=Ye.selectedLabel.text.length),Ae.keyCode==36&&(Ye.selectedIndex=0),Ae.keyCode==37&&(Ye.selectedIndex=Ye.selectedIndex-1),Ae.keyCode==39&&(Ye.selectedIndex=Ye.selectedIndex+1),Ae.keyCode==46&&Ye.selectedIndex<Ye.selectedLabel.text.length&&(Ye.selectedIndex=Ye.selectedIndex+1,Ye.removeChar()),Ae.keyCode==8&&(Ae.preventDefault(),Ye.removeChar()),Ye.addChar(Ae.key),u.stage&&u.stage.update())}},j.addEventListener("keydown",this.keydownEvent)),K!==!1&&t.styleTransforms(this,d),this.clone=function(){var Ae=new t.Keyboard(e,r,i,l,a,s,c,w,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O,X,R,Q,K,this.group,ne);return u.cloneProps(Ae)},this.dispose=function(Ae,Ye,Xe){Se.removeAllEventListeners(),Se=null,u.keydownEvent&&j.removeEventListener("keydown",u.keydownEvent);for(var Ue=0;Ue<u.labels.length;Ue++)u.labels[Ue].removeAllEventListeners();return u.numPad&&u.numPad.dispose(),pe&&pe.dispose(),u.labels=V=null,S&&S.off("pressmousemove",u.tickerMouseEvent),Xe||u.zimContainer_dispose(!0),!0}},t.extend(t.Keyboard,t.Container,["clone","dispose"],"zimContainer",!1),t.Organizer=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O){var X="width, list, useAdd, useRemove, usePosition, autoAdd, autoRemove, autoPosition, addForward, removeForward, backgroundColor, rollBackgroundColor, selectedBackgroundColor, selectedRollBackgroundColor, color, rollColor, selectedColor, selectedRollColor, spacing, corner, keyEnabled, gradient, gloss, backdropColor, style, group, inherit",R;if(R=st(t.Organizer,arguments,X,this))return R;De("67.3"),this.group=$;var Q=k===!1?{}:t.getStyle("Organizer",this.group,O);if(n(e)&&(e=Q.width!=null?Q.width:r&&r.vertical?r.width:300),n(i)&&(i=Q.useAdd!=null?Q.useAdd:!0),n(l)&&(l=Q.useRemove!=null?Q.useRemove:!0),n(a)&&(a=Q.usePosition!=null?Q.usePosition:!0),n(s)&&(s=Q.autoAdd!=null?Q.autoAdd:i),n(f)&&(f=Q.autoRemove!=null?Q.autoRemove:l),n(c)&&(c=Q.autoPosition!=null?Q.autoPosition:a),n(w)&&(w=Q.addForward!=null?Q.addForward:!0),n(T)&&(T=Q.removeForward!=null?Q.removeForward:!0),n(p)&&(p=Q.backgroundColor!=null?Q.backgroundColor:t.tin),n(x)&&(x=Q.rollBackgroundColor!=null?Q.rollBackgroundColor:t.grey),n(P)&&(P=Q.selectedBackgroundColor!=null?Q.selectedBackgroundColor:t.dark),n(v)&&(v=Q.color!=null?Q.color:t.white),n(I)&&(I=Q.rollColor!=null?Q.rollColor:v),n(g)&&(g=Q.selectedColor!=null?Q.selectedColor:v),n(E)&&(E=Q.selectedRollColor!=null?Q.selectedRollColor:v),n(A)&&(A=Q.spacing!=null?Q.spacing:1),n(y)&&(y=Q.corner!=null?Q.corner:0),n(L)&&(L=Q.gradient!=null?Q.gradient:.2),n(Y)&&(Y=Q.gloss!=null?Q.gloss:null),n(_)&&(_=Q.backdropColor!=null?Q.backdropColor:null),Array.isArray(y)||(y=[y,y,y,y]),!(!i&&!a&&!l)){var K=(i?1:0)+(a?4:0)+(l?1:0),q=(e+A)/K,ne={width:q,height:q,label:"",shadowColor:-1,gradient:L,corner:y,backgroundColor:p,rollBackgroundColor:x},U=[],D=new t.Shape;if(D.graphics.f(v).p("AAAA4Ih6B8Ig5g4IB8h8Ih7h6IA4g5IB6B8IB7h8IA5A5Ih8B6IB8B7Ig5A5g"),i&&U.push(new t.Button({icon:D.sca(.55).rot(-45).reg(1),inherit:ne})),a){var d=new t.Shape;d.graphics.f(v).p("AiJieIETCeIkTCfg"),U.push(new t.Button({icon:d.sca(.6).rot(r&&!r.vertical?180:-90).reg(-2),inherit:ne})),U.push(new t.Button({icon:d.clone().sca(.6).rot(r&&!r.vertical?0:90).reg(-2),inherit:ne}));var u=new t.Shape;u.graphics.f(v).p("AiFCLIAAkVIBXAAIAAEVgAgiAAICoiHIAAEQg"),U.push(new t.Button({icon:u.sca(.62).rot(r&&!r.vertical?0:90).reg(0),inherit:ne})),U.push(new t.Button({icon:u.clone().sca(.62).rot(r&&!r.vertical?180:-90).reg(0),inherit:ne}))}l&&U.push(new t.Button({icon:D.clone().rot(0).sca(.55),inherit:ne})),U.length==0&&(U=[""]),this.zimTabs_constructor(e,q,U,p,x,null,P,m,v,I,null,g,E,!1,A,!0,!1,y,null,!0,L,Y,null,null,null,null,null,null,null,null,null,null,_);var o=this;o.list=r,o.type="Organizer",o.setButtons=function(){if(a){var h=i?1:0;U[h+0]&&(U[h+0].icon.rotation=o.list&&!o.list.vertical?180:-90),U[h+1]&&(U[h+1].icon.rotation=o.list&&!o.list.vertical?0:90),U[h+2]&&(U[h+2].icon.rotation=o.list&&!o.list.vertical?0:90),U[h+3]&&(U[h+3].icon.rotation=o.list&&!o.list.vertical?180:-90)}};var S=!1,F=r;o.change(function(h){(!S&&o.list||o.list&&o.list!=F)&&(o.list!=F&&F&&F.noChange(),o.list.change(function(){o.orgItem=o.list.selected,o.orgIndex=o.list.selectedIndex}),S=!0,F=o.list);var b=h.target.selectedIndex;i||b++,!a&&(!i||b>0)&&(b=5);var ye=n(o.list.selectedIndex)||o.list.selectedIndex<0;ye&&(o.currentValue=null),o.lastIndex=o.list.selectedIndex;var B;switch(b){case 0:s&&(B=Math.max(0,o.list.selectedIndex),o.add(B)),o.orgType="add";break;case 1:if(ye)break;c&&(B=o.list.selectedIndex,o.up(B)),o.orgType="up";break;case 2:if(ye)break;c&&(B=o.list.selectedIndex,o.down(B)),o.orgType="down";break;case 3:if(ye)break;c&&(B=o.list.selectedIndex,o.toTop(B)),o.orgType="top";break;case 4:if(ye)break;c&&(B=o.list.selectedIndex,o.toBottom(B)),o.orgType="bottom";break;case 5:if(ye)break;f&&(B=o.list.selectedIndex,o.remove(B)),o.orgType="remove";break}}),this.add=function(h,b,ye){return n(h)&&(h=o.lastIndex),n(b)&&(b=""),w?h=Math.min(o.list.length,Math.max(0,o.list.selectedIndex)+1):h=Math.max(0,o.list.selectedIndex),o.list.addAt(b,h,ye),o.list.selectedIndexPlusPosition=h,o.orgItem=o.list.selected,o.orgIndex=o.list.selectedIndex,o},this.up=function(h){n(h)&&(h=o.lastIndex);var b=o.list.items[h];return n(b)||(o.list.removeAt(1,h),o.list.addAt(b,h-1),o.list.selectedIndexPlusPosition=Math.max(0,h-1),o.orgItem=o.list.selected,o.orgIndex=o.list.selectedIndex),o},this.down=function(h){n(h)&&(h=o.lastIndex);var b=o.list.items[h];return n(b)||(o.list.removeAt(1,h),o.list.addAt(b,h+1),o.list.selectedIndexPlusPosition=Math.min(o.list.length-1,h+1),o.orgItem=o.list.selected,o.orgIndex=o.list.selectedIndex),o},this.toTop=function(h){n(h)&&(h=o.lastIndex);var b=o.list.items[h];return n(b)||(o.list.removeAt(1,h),o.list.addAt(b,0),o.list.first(),o.orgItem=o.list.selected,o.orgIndex=o.list.selectedIndex),o},this.toBottom=function(h){n(h)&&(h=o.lastIndex);var b=o.list.items[h];if(!n(b))return o.list.removeAt(1,h),o.list.addAt(b,o.list.length),o.list.last(),o.orgItem=o.list.selected,o.orgIndex=o.list.selectedIndex,o},this.remove=function(h){if(n(h))if(o.list.selectedIndex>=0)h=o.list.selectedIndex;else return o;var b=h==o.list.selectedIndex;return o.removedItem=o.list.items[h],o.list.removeAt(1,h),b?T||(h=Math.max(0,h-1)):h=o.list.selectedIndex,o.list.selectedIndexPlusPosition=Math.min(o.list.length-1,h),o.orgItem=o.list.selected,o.orgIndex=o.list.selectedIndex,o},k!==!1&&t.styleTransforms(this,Q),this.clone=function(){return o.cloneProps(new t.Organizer(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,o.group,O))},this.dispose=function(h,b,ye){return U=null,ye||o.zimTabs_dispose(!0),!0}}},t.extend(t.Organizer,t.Tabs,["clone","dispose"],"zimTabs",!1),t.Connectors=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O,X,R,Q,K,q,ne,U,D,d,u){var o="width, height, points, node, line, linear, linearWrap, linearOrder, num, snapH, snapV, dropType, dropArray, continuous, startIndex, duplicateLine, deleteNode, dblclick, fullMove, min, max, boundary, expand, nodeRollColor, nodeRollBorderColor, nodeSelectedColor, nodeSelectedBorderColor, baseColor, baseBorderColor, baseRollover, rootLock, grandChildren, dblclickTime, steps, style, group, inherit",S;if(S=st(t.Connectors,arguments,o,this))return S;De("67.39"),this.group=d;var F=D===!1?{}:t.getStyle("Connectors",this.group,u);n(e)&&(e=F.width!=null?F.width:null),n(r)&&(r=F.height!=null?F.height:null),this.zimContainer_constructor(null,null,null,null,!1),this.type="Connectors",n(i)&&(i=F.points!=null?F.points:[[0,0],[100,0],[100,100],[0,100]]),n(l)&&(l=F.node!=null?F.node:new t.Circle(10,t.grey,t.grey)),l.removeFrom(),l.color==t.clear&&!l.hitArea&&l.expand(0),n(a)&&(a=F.line!=null?F.line:new t.Line({length:10,thickness:3,color:t.tin,strokeObj:{caps:"round"}})),n(w)&&(w=F.num!=null?F.num:10),n(s)&&(s=F.linear!=null?F.linear:!1),n(f)&&(f=F.linearWrap!=null?F.linearWrap:!0),n(_)&&(_=F.nodeRollColor!=null?F.nodeRollColor:l.color.match("rgb")?l.color:l.color.lighten(.2)),n(k)&&(k=F.nodeRollBorderColor!=null?F.nodeRollBorderColor:l.borderColor),n($)&&($=F.nodeSelectedColor!=null?F.nodeSelectedColor:t.white),n(O)&&(O=F.nodeSelectedBorderColor!=null?F.nodeSelectedBorderColor:l.borderColor),n(X)&&(X=F.baseColor!=null?F.baseColor:l.color),n(R)&&(R=F.baseBorderColor!=null?F.baseBorderColor:l.borderColor),n(Q)&&(Q=F.baseRollover!=null?F.baseRollover:!1),n(y)&&(y=F.min!=null?F.min:l.radius?l.radius*2:Math.min(l.width,l.height)),n(C)&&(C=F.max!=null?F.max:null),n(Y)&&(Y=F.expand!=null?F.expand:t.mobile()?10:0),n(x)&&(x=F.dropType!=null?F.dropType:"any"),n(P)&&(P=F.dropArray!=null?F.dropArray:null),n(m)&&(m=F.continuous!=null?F.continuous:!1),n(v)&&(v=F.startIndex!=null?F.startIndex:null),n(I)&&(I=F.duplicateLine!=null?F.duplicateLine:!0),n(g)&&(g=F.deleteNode!=null?F.deleteNode:!0),n(E)&&(E=F.dblclick!=null?F.dblclick:!0),n(A)&&(A=F.fullMove!=null?F.fullMove:!0),n(ne)&&(ne=F.dblclickTime!=null?F.dblclickTime:.5);var h=wt(ne);if(ne*=h=="s"?1e3:1,n(T)&&(T=F.snapH!=null?F.snapH:null),n(p)&&(p=F.snapV!=null?F.snapV:null),n(K)&&(K=F.rootLock!=null?F.rootLock:!1),n(q)&&(q=F.grandChildren!=null?F.grandChildren:!0),n(U)&&(U=F.steps!=null?F.steps:null),s&&i.length<=1){dt&&tt("Connector() - linear needs more than one point");return}var b=this,ye=0;b.node=l,b.line=a;var B=[],N=l.color,re=l.borderColor,le=b.lines=new t.Container(e,r).addTo(b),G=b.nodes=new t.Container(e,r).addTo(b);if(i.type=="Blob"||i.type=="Squiggle"){var z=[];t.loop(i.points,function(Be){z.push([Be[0],Be[1]])}),i=z}b.points=i,this.addNode=function(Be,He,et){if(!s)return se(Be,He,et)};function se(Be,He,et,ge){if(Be.addChild){x="on",K=!0,q=!1,et=Be,et.connectorMoveEvent||(b.bases||(b.bases=[]),b.bases.push(et),et.connectorMoveEvent=et.on("pressmove",function(){et.positionConnectors(et,!0,!0)}),et.connectorUpEvent=et.on("pressup",function(){et.positionConnectors(et,!0,!0)}),Q&&(et.connectorOverEvent=et.on("mouseover",function(){Pe(et)}),et.connectorOutEvent=et.on("mouseout",function(){ie(et)})),et.positionConnectors=function(qe,Fe,We){t.loop(qe.connectors,function(ce){var Ve=qe.parent.localToLocal(qe.x-qe.baseStart.x+ce.nodeStart.x,qe.y-qe.baseStart.y+ce.nodeStart.y,ce.parent);ce.x=Ve.x,ce.y=Ve.y,_e(ce,Fe,We)}),qe.stage&&qe.stage.update()},et.setConnectorColors=function(qe,Fe,We,ce){return n(qe)||(et.connectorColor=qe),n(Fe)||(et.connectorBorderColor=Fe),n(We)||(et.connectorRollColor=We),n(ce)||(et.connectorRollBorderColor=ce),t.loop(et.connectors,function(Ve){n(qe)||(Ve.color=qe),n(Fe)||(Ve.borderColor=Fe)}),et},et.setConnectorColors(X,R,_,k));var xe=et.getBounds();a.endHead,Array.isArray(He)||(He=[He,He]);var he=[];return He.length==2&&(He=[He[0],He[1],He[0],He[1]]),(a.lineOrientation==t.HORIZONTAL||a.lineOrientation=="auto")&&t.loop([He[0],He[1]],function(qe,Fe){if(qe==-1||qe==-2){var We=et.localToLocal(Fe==0?xe.x:xe.x+xe.width,xe.y,b);he.push([We.x,We.y,t.HORIZONTAL])}if(qe==-1||qe==-3){var ce=et.localToLocal(Fe==0?xe.x:xe.x+xe.width,xe.y+xe.height,b);he.push([ce.x,ce.y,t.HORIZONTAL])}qe>0&&t.loop(qe,function(Ve,Se){var Ae=et.localToLocal(Fe==0?xe.x:xe.x+xe.width,xe.y+xe.height*(Ve+1)/(Se+1),b);he.push([Ae.x,Ae.y,t.HORIZONTAL])})}),(a.lineOrientation==t.VERTICAL||a.lineOrientation=="auto")&&t.loop([He[2],He[3]],function(qe,Fe){if(qe==-1||qe==-2){var We=et.localToLocal(xe.x,Fe==0?xe.y:xe.y+xe.height,b);he.push([We.x,We.y,t.VERTICAL])}if(qe==-1||qe==-3){var ce=et.localToLocal(xe.x+xe.width,Fe==0?xe.y:xe.y+xe.height,b);he.push([ce.x,ce.y,t.VERTICAL])}qe>0&&t.loop(qe,function(Ve,Se){var Ae=et.localToLocal(xe.x+xe.width*(Ve+1)/(Se+1),Fe==0?xe.y:xe.y+xe.height,b);he.push([Ae.x,Ae.y,t.VERTICAL])})}),et.connectors=[],et.baseStart=new t.Point(et.x,et.y),t.loop(he,function(qe){var Fe=se(qe[0],qe[1],et,qe[2]);be(et,Fe)}),setTimeout(function(){et.positionConnectors(et,!0,!0)},50),b}var Ge=l.clone().loc(Be,He,G).drag({boundary:L}).expand(Y);return Ge.orientation=ge,Ge.nodeColor=Ge.color,Ge.on("mouseover",pe),Ge.on("mouseout",Z),Ge.on("mousedown",Ce),Ge.on("pressmove",Me),Ge.on("pressup",te),g&&Ge.hold(J),Ge.nodeNum=ye++,Ge.creations=[],Ge}function Oe(){t.loop(i,function(Be,He){var et=se(Be[0],Be[1]);et.dropIndex=He,P&&(et.dropArray=P[He])}),s&&G.loop(function(Be,He,et){He==0?(f?Be.before=G.getChildAt(et-1):Be.before=null,Be.after=G.getChildAt(He+1)):He==et-1?(f?Be.after=G.getChildAt(0):Be.after=null,Be.before=G.getChildAt(He-1)):(Be.before=G.getChildAt(He-1),Be.after=G.getChildAt(He+1)),c&&He>0&&Be.noMouse()})}Oe(),b.setAvailableIndexes=function(Be){return Array.isArray(Be)||(Be=[Be]),b.nodes.loop(function(He,et){Be.indexOf(et)==-1?He.noMouse():He.mouse()}),b},n(v)||b.setAvailableIndexes(v),b.keyEvent=function(Be){g&&Be.keyCode==46&&(t.loop(de,function(He){He&&He.parent&&Ze(He)}),b.stage&&b.stage.update())},j.addEventListener("keydown",b.keyEvent);function J(Be){var He=Be.target.stage,et=Be.target;b.bases||K&&!et.creator.creator||(et.adding?Ze(et.creator):Ze(et),b.stage&&b.stage.update())}function pe(Be){var He=Be.target;He.selected||(He.color=He.base?He.base.connectorRollColor:_,He.borderColor=He.base?He.base.connectorRollBorderColor:k,b.stage&&b.stage.update())}function Z(Be){var He=Be.target;He.selected||(He.color=He.base?He.base.connectorColor:He.nodeColor,He.borderColor=He.base?He.base.connectorBorderColor:re,b.stage&&b.stage.update())}var de=[],V,fe=0,ke,oe;function Ce(Be,He,et,ge){var xe=Be.target;if(!n(xe)&&(et&&(xe.selected=!0,de=[],b.selectNode(xe,!ge)),oe=xe.nodeNum,!s&&(!K||xe.creator)&&E&&!He&&(fe==0&&(ke=setTimeout(function(){if(fe=0,de){var Fe=b.stage?b.stage.frame:j.zdf,We=G.loop(function(ce){if(ce.hitTestPoint(Fe.mouseX,Fe.mouseY)&&ce.selected)return!1});We&&Re()}},ne)),fe++),xe.startX=xe.x,xe.startY=xe.y,!s&&de.length>0&&t.loop(de,function(Fe){Fe.startX=Fe.x,Fe.startY=Fe.y}),!(xe.creations.length>=w||xe.selected||xe.creator&&!q))){xe.adding=!0;var he=se(xe.x,xe.y).bot();he.creations=xe.creations,he.creatorLine=xe.creatorLine,he.creator=xe.creator,he.orientation=xe.orientation,he.startX=xe.startX,he.startY=xe.startY,he.dropIndex=xe.dropIndex,he.dropArray=xe.dropArray,he.lineArray=xe.lineArray,he.color=he.nodeColor=xe.nodeColor;var Ge=he.nodeNum;if(he.nodeNum=xe.nodeNum,xe.nodeNum=Ge,xe.base&&(he.base=xe.base,he.baseStart=xe.baseStart,he.nodeStart=xe.nodeStart,he.connectors=xe.connectors,xe.base=xe.baseStart=xe.nodeStart=xe.connectors=null,he.base.connectors&&he.base.connectors.splice(he.base.connectors.indexOf(xe),1,he),he.color=he.base.connectorColor,he.borderColor=he.base.connectorBorderColor),he.before=xe.before,he.after=xe.after,he.before&&(he.before.after=he),he.after&&(he.after.before=he),he.creator){var qe=he.creator.creations.indexOf(xe);qe!=-1&&he.creator.creations.splice(qe,1,he)}t.loop(he.creations,function(Fe){Fe.creator=he}),xe.creator=he,xe.creatorLine=a.clone().setPoints(xe.x,xe.y,xe.x,xe.y).addTo(le).alp(0),xe.creatorLine.lineOrientation=xe.orientation,xe.creatorLine.node=xe,xe.creatorLine.creatorNode=he,xe.creations=[],xe.veeObj&&!n(xe.veeObj.color)?xe.color=t.Pick.choose(xe.veeObj.color):xe.color=he.color,xe.nodeColor=xe.color,he.creations.push(xe),b.latestNode=xe}}function Me(Be,He,et,ge){var xe=Be.target;xe.creatorLine&&xe.creatorLine.alp(1),!s&&de.length>0&&de.indexOf(xe)==-1&&Re(),_e(xe,!1,!0),b.bases&&t.loop(b.bases,function(he){xe.creator&&xe.creator.base==he||(!he.connectorsOn&&xe.hitTestBounds(he)&&Pe(he),he.connectorsOn&&!xe.hitTestBounds(he)&&ie(he))}),b.stage&&b.stage.update()}function te(Be,He,et,ge){var xe=Be.target;b.bases&&t.loop(b.bases,function(Ue){Ue!=xe.base&&Ue.connectorsOn&&ie(Ue)});var he=!1;if(!s&&fe>1&&!He){clearTimeout(ke);var Ge=xe.adding?xe.creator:xe;if(xe.adding&&Ze(Ge.creations[Ge.creations.length-1],!0),!Ge.selected){var qe=b.stage?b.stage.frame:j.zdf;ee(Ge,!qe.ctrlKey)}fe=0,he=!0}if(!s&&!b.base&&(T&&(xe.x=Math.round(xe.x/T)*T),p&&(xe.y=Math.round(xe.y/p)*p)),y&&t.dist(xe.x,xe.y,xe.startX,xe.startY)<y||C&&t.dist(xe.x,xe.y,xe.startX,xe.startY)>C){xe.adding?Ze(xe,!0):(xe.loc(xe.startX,xe.startY),he||_e(xe)),b.stage&&b.stage.update(),b.lastNode=null,b.targetNode=null,b.dispatchEvent("noconnection");return}var Fe=!1,We=!1;if(s){var ce=xe.creator;if(b.connectionStart=ce,b.connectionEnd=xe,ce.before&&xe.hitTestCircle(ce.before)&&!c)xe.loc(ce.before).removeFrom(),ce.before.after=null,ce.before.before||ce.before.noMouse(),ce.before=null,ce.after||ce.noMouse(),We=!0,Fe=Ie();else if(ce.after&&xe.hitTestCircle(ce.after))xe.loc(ce.after).removeFrom(),ce.after.before=null,ce.after.after||ce.after.noMouse(),c&&ce.after.mouse(),ce.after=null,ce.before||ce.noMouse(),c&&ce.noMouse(),We=!0,Fe=Ie();else if(!ce||xe.creations.length>0)xe.loc(xe.startX,xe.startY).bot();else{Ze(xe,!0),b.stage&&b.stage.update(),b.lastNode=null,b.targetNode=null,b.dispatchEvent("noconnection");return}}else if(x=="off"){var Ve=G.loop(function(Ue){if(xe!=Ue&&xe.hitTestCircles(Ue)){xe.adding?Ze(xe,!0):(xe.loc(xe.startX,xe.startY),_e(xe)),K&&me(xe),!A&&xe.creator&&w>0&&xe.creator.creations.length>=w&&xe.creator.noMouse(),b.targetNode=Ue,m&&b.nodes.loop(function(rt){rt!=b.latestNode&&rt.noMouse()}),m&&b.nodes.loop(function(rt){rt!=b.latestNode&&rt.noMouse()}),ae(),b.dispatchEvent("connection"),b.stage&&b.stage.update();return}});if(!Ve){ue(xe);return}}else if(x=="on"||x=="single"){var Se=0,Ae,Ye=G.loop(function(Ue){if(xe!=Ue&&xe.hitTestCircles(Ue)){if(Ae=Ue,b.bases&&(xe.orientation!=Ue.orientation||xe.creator&&xe.creator.base&&xe.creator.base==Ue.base)||xe.dropArray&&xe.dropArray.indexOf(Ue.dropIndex)==-1||!I&&xe.lineArray&&xe.lineArray.indexOf(Ue.dropIndex)!=-1)return;if(x=="on")return!1;Se++,Se+=Ue.creations.length}});if(Ye&&!(x=="single"&&Se==1)){ue(xe);return}else{if(xe.loc(Ae),xe.creator&&xe.orientation==t.VERTICAL&&Math.round(xe.y)==Math.round(xe.creator.startY)||xe.creator&&xe.orientation==t.HORIZONTAL&&Math.round(xe.x)==Math.round(xe.creator.startX))return;b.targetNode=Ae;var Xe=xe.dropIndex;xe.dropIndex=Ae.dropIndex,xe.dropArray=t.copy(Ae.dropArray),Ae.lineArray?Ae.lineArray.push(Xe):Ae.lineArray=[Xe],xe.lineArray=t.copy(Ae.lineArray),xe.creator&&(xe.creator.lineArray||(xe.creator.lineArray=[]),xe.creator.lineArray.push(xe.dropIndex)),Ae.base&&Ae.base.connectors&&be(Ae.base,xe),We=!0}}else xe.selected||(We=!0);!A&&xe.creator&&w>0&&xe.creator.creations.length>=w&&xe.creator.noMouse(),xe.adding=!1,_e(xe,!0,!0),t.loop(de,function(Ue){if(de.indexOf(Ue.creator)==-1){var rt=t.loop(Ue.creations,function(Te){if(de.indexOf(Te)>=0)return!1});ae(Ue.nodeNum,null,t.decimals(Ue.x,2),t.decimals(Ue.y,2),rt||rt===void 0?1:0)}Ue.startX=Ue.x,Ue.startY=Ue.y}),xe.startX=xe.x,xe.startY=xe.y,K&&me(xe),We?(m&&b.nodes.loop(function(Ue){Ue!=b.latestNode&&Ue.noMouse()}),ae(),b.dispatchEvent("connection"),t.arraysEqual(xe.dropArray,xe.lineArray,!1)&&b.dispatchEvent("blocked")):b.dispatchEvent("noconnection"),Fe&&b.dispatchEvent("complete"),b.stage&&b.stage.update()}function ae(Be,He,et,ge,xe){He?B.push([Be,null,null,1]):n(et)?B.push([oe,t.decimals(b.latestNode.x,2),t.decimals(b.latestNode.y,2)]):B.push([Be,null,null,null,et,ge,xe])}b.makeConnection=function(Be,He,et,ge,xe){var he=b.stage?b.stage.frame:j.zdf;return ge?(he.ctrlKey=xe==1,Ce({target:Be},!0,!0,xe),Be.loc(He,et),Me({target:Be},!0,!0,xe),te({target:Be},!0,!0,xe)):(Ce({target:Be},!0,!1,null),b.latestNode.loc(He,et),Me({target:b.latestNode},!0,!1,null),te({target:b.latestNode},!0,!1,null)),he.ctrlKey=!1,b.latestNode};function we(Be){var He=b.nodes.loop(function(et){if(et.nodeNum==Be)return et});if(He.type)return He}b.setSteps=function(Be){return t.loop(Be,function(He){var et=we(He[0]);et&&(He[3]?et&&Ze(et):n(He[4])?b.makeConnection(et,He[1],He[2]):(b.makeConnection(et,He[4],He[5],!0,He[6]),Re()))}),b},b.applySteps=b.setSteps,b.getSteps=function(Be){return Be&&(b.stage||(b.stage=zdf.stage),b.pane||(b.pane=new t.Pane({displayClose:!1,container:b.stage,width:Math.min(500,b.stage.width-20),height:Math.min(500,b.stage.height-20),draggable:!0}),b.textArea=new t.TextArea(Math.min(400,b.stage.width-70),Math.min(400,b.stage.height-70)).centerReg(b.pane)),b.pane.show(),b.textArea.text=JSON.stringify(B)),B},Object.defineProperty(this,"steps",{get:function(){return B},set:function(Be){b.setSteps(Be)}});function ue(Be){Be.adding||!q?Ze(Be,!0):(Be.loc(Be.startX,Be.startY),_e(Be)),K&&me(Be),Be.base&&Be.base.connectors&&Le(Be.base,Be),b.lastNode=null,b.targetNode=null,b.dispatchEvent("noconnection"),b.stage&&b.stage.update()}function Pe(Be){t.loop(Be.connectors,function(He){He.color=Be.connectorRollColor,He.borderColor=Be.connectorRollBorderColor}),Be.connectorsOn=!0,Be.stage&&Be.stage.update()}function ie(Be){t.loop(Be.connectors,function(He){He.color=Be.connectorColor,He.borderColor=Be.connectorBorderColor}),Be.connectorsOn=!1,Be.stage&&Be.stage.update()}function be(Be,He){Be.connectors.push(He),He.nodeStart=He.parent.localToLocal(He.x,He.y,Be.parent),He.nodeStart.x-=Be.x-Be.baseStart.x,He.nodeStart.y-=Be.y-Be.baseStart.y,He.base=Be}function Le(Be,He){Be.connectors.splice(Be.connectors.indexOf(He),1),He.nodeStart=null,He.base=null}function me(Be){if(Be.creator){if(Be.creator.creator){me(Be.creator);return}Be.creator&&Be.creator.creations.length>=w?Be.creator.noMouse():Be.creator.mouse()}}function ee(Be,He){He&&t.loop(Be.creations,function(et){ee(et,He)}),Be.selected=!0,Be.color=Be.base?Be.base.connectorColor:$,Be.borderColor=Be.base?Be.base.connectorBorderColor:O,de.push(Be),Be.top(),V||(V=b.stage.on("stagemousedown",function(){var et=b.stage?b.stage.frame:j.zdf,ge=G.loop(function(xe){if(xe.hitTestPoint(et.mouseX,et.mouseY))return!1});ge&&Re()}))}this.selectNode=function(Be,He){ee(Be,He)};function Ie(){var Be=G.loop(function(He){if(He.before||He.after)return!1});if(Be)return G.loop(function(He){He.noMouse()}),!0}function Re(){t.loop(de,function(Be){Be.selected=!1,Be.color=Be.base?Be.base.connectorColor:Be.nodeColor,Be.borderColor=Be.base?Be.base.connectorBorderColor:re}),de=[],b.stage.off("stagemousedown",V),V=null,b.stage&&b.stage.update()}function _e(Be,He,et){var ge=de.length>0?de:[Be];t.loop(ge,function(xe){xe!=Be&&xe.loc(xe.startX+Be.x-Be.startX,xe.startY+Be.y-Be.startY),xe.creator&&xe.creatorLine.setPoints(xe.x,xe.y,xe.creator.x,xe.creator.y,He,et),t.loop(xe.creations,function(he){he.creatorLine.setPoints(he.x,he.y,he.creator.x,he.creator.y,He,et)})})}function Ze(Be,He){if(t.loop(Be.creations,function(ge){Ze(ge)},!0),Be.creatorLine){Be.creatorLine.removeFrom();var et=Be.creator.creations.indexOf(Be);et!=-1&&Be.creator.creations.splice(et,1),!Be.creator.mouseEnabled&&!(K&&!Be.creator.creator)&&Be.creator.mouse()}return Be.removeFrom(),Be.removeAllEventListeners(),He?ye--:ae(Be.nodeNum,1),Be=null,b}this.removeNode=function(Be){Ze(Be)},this.removeConnectors=function(){t.loop(G,function(Be){Ze(Be)},!0),Oe(),b.stage&&b.stage.update()},this.removeBase=function(Be){t.loop(Be.connectors,function(He){Ze(He)}),at(Be)},this.addBase=function(Be,He){se(Be,He)};function at(Be){Be.off("pressmove",Be.connectorMoveEvent),Be.off("pressup",Be.connectorUpEvent),Be.connectorOverEvent&&Be.off("mouseover",Be.connectorOverEvent),Be.connectorOutEvent&&Be.off("mouseout",Be.connectorOutEvent),Be.connectors=null,Be.baseStart=null,Be.positionConnectors=Be.setConnectorColors=null,Be.connectorColor=Be.connectorBorderColor=Be.connectorRollColor=Be.connectorRollBorderColor=null,b.bases.splice(b.bases.indexOf(Be),1),b.stage&&b.stage.update()}U&&b.added(function(){b.setSteps(U),b.stage.update()}),Object.defineProperty(this,"selectedList",{get:function(){return de},set:function(){dt&&tt("Selectors() - selectedList is read only")}}),this.dispose=function(Be,He,et){return b.nodes.loop(function(ge){ge.removeFrom(),ge.removeAllEventListeners(),ge=null},!0),b.lines.loop(function(ge){ge.removeFrom(),ge=null},!0),j.removeEventListener("keydown",b.keyEvent),b.keyEvent=null,b.bases&&t.loop(b.bases,function(ge){at(ge)}),et||(b.zimContainer_dispose(!0),b.stage&&b.stage.update()),!0},D!==!1&&t.styleTransforms(this,F),this.clone=function(){return b.cloneProps(new t.Connectors(e,r,i,l,a,s,f,c,w,T,p,x,t.copy(P),m,v,I,g,E,A,y,C,L,Y,_,k,$,O,X,R,Q,K,q,ne,U,D,b.group,u))}},t.extend(t.Connectors,t.Container,["clone","dispose"],"zimContainer",!1),t.Marquee=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g){var E="width, height, items, time, transition, speed, direction, marginLeft, marginRight, marqueeType, borderColor, borderWidth, refresh, mix, style, group, inherit",A;if(A=st(t.Marquee,arguments,E,this))return A;De("67.4"),this.group=I;var y=v===!1?{}:t.getStyle("Marquee",this.group,g),C=this;n(e)&&(e=y.width!=null?y.width:300),n(r)&&(r=y.height!=null?y.height:100);var L=wt(l);n(l)&&(l=y.time!=null?y.time:L=="s"?5:5e3),n(a)&&(a=y.transition!=null?y.transition:"slide"),n(p)&&(p=y.borderColor!=null?y.borderColor:t.dark),n(x)&&(x=y.borderWidth!=null?y.borderWidth:1),p<0||x<0?p=x=null:p!=null&&x==null&&(x=1),n(c)&&(c=y.marginLeft!=null?y.marginLeft:25),n(w)&&(w=y.marginRight!=null?y.marginRight:25),n(s)&&(s=y.speed!=null?y.speed:L=="s"?.5:500),It(s,L),n(f)&&(f=y.direction!=null?y.direction:"right"),n(P)&&(P=y.refresh!=null?y.refresh:L=="s"?30*60:30*60*1e3),n(m)&&(m=y.mix!=null?y.mix:!0),this.zimContainer_constructor(e+c+w,r,null,null,!1),this.type="Marquee",this.speed=s;var Y=new t.Rectangle(e-1,r-1,t.clear).addTo(C).mov(c+.5,.5),_=this.content=new t.Container(e,r).loc(c,0,C).setMask(Y),k=this.pages=new t.Pages(null,a,s,null,_).addTo(_),$=!1;this.add=function(h,b,ye,B,N){n(N)&&(N=!0),h.scaleTo(_,100,100),b&&h.cur().on("click",function(){nr(b,ye)}),k.addPage(h),N&&k.center(),h.marqueeViews=0,h.marquee=C,$||O(),B||D(),F&&F.top()},this.remove=function(h){if(C.selected==h){if(C.pages.pages.length==1)return;var b=C.selectedIndex+1;b==C.pages.pages.length&&(b=0),C.pages.go(b,null,null,0),setTimeout(function(){C.pages.removePage(h),h.dispose&&h.dispose(),D()},20)}else C.pages.removePage(h),h.dispose&&h.dispose(),D()};function O(){$=!0,C.selectedIndex=0,C.selected=k.pages[C.selectedIndex].page,C.lastSelected=null,C.selected.marqueeOn&&C.selected.marqueeOn(),C.interval=t.interval(l,function(){C.go()})}if(!n(i)&&!Array.isArray(i)&&(i=[i]),i&&i.length>0&&(m&&t.shuffle(i),t.loop(i,function(h){C.add(h,null,null,!0)})),P>0)var X=t.timeout(P*(L=="s"?1e3:1),function(){location.reload()},null,"ms");C.go=function(h){if(C.selected.marqueeViews+=1,C.selected.marqueeOff&&C.selected.marqueeOff(),h)C.selected=h,t.loop(k.pages,function(ye,B){if(ye.page==h){C.selectedIndex=B;return}}),C.interval.interval=C.selected.marqueeTime?C.selected.marqueeTime:l,C.interval.pause(ne.toggled,null,!0);else{var b=C.selectedIndex+1;C.selectedIndex=b%k.pages.length,C.selected=k.pages[C.selectedIndex].page,C.interval.time=C.selected.marqueeTime?C.selected.marqueeTime:l}C.dispatchEvent("page"),C.selected.marqueeOn&&C.selected.marqueeOn(),k.go(C.selected,f,a,s)},k.on("pagetransitioned",function(){C.dispatchEvent("pagetransitioned"),C.indicator&&(C.indicator.selectedIndex=C.selectedIndex)});var R=!1,Q=C.left=new t.Container(c-4,r-4),K=new t.Shape().sca(.6);K.graphics.f(t.light).mt(0,0).p("AAhCLIAAkVIBXAAIAAEVgAh3CLIAAkVIBXAAIAAEVg");var q=new t.Shape().sca(.6).reg(-2,0);q.graphics.f(t.light).mt(0,0).p("AiJieIETCeIkTCfg");var ne=C.button=new t.Button({label:"",icon:K,toggleIcon:q,width:45,height:45,corner:0,shadowBlur:0}).scaleTo(Q,100).pos(0,0,!1,!0,Q);ne.on("click",function(){C.interval&&C.interval.pause(ne.toggled),R=ne.toggled,C.stage.update()});var U;function D(){if(!(n(c)||c==0)){var h=4*c/25;Q.pos(c-Q.width-h,h/2,!1,!0,C),C.indicator&&(C.indicator.dispose(),C.indicator.removeFrom()),U||(U=new t.Proportion(8,16,Q.width+h,Q.width/2+h,-1)),C.indicator=new t.Indicator({width:(k.pages.length<=2?k.pages.length:k.pages.length-1)*(Q.width-3),height:U.convert(k.pages.length),num:k.pages.length,shadowBlur:-1,interactive:!0,scale:1.2,indicatorType:T}),C.indicator.fit(0,0,r-ne.height,ne.width),C.indicator.rot(f=="down"?-90:90).center(Q).pos(null,Q.width-h/2,null,!0),C.indicator.selectedIndex=C.selectedIndex,C.indicator.on("change",function(){C.go(k.pages[C.indicator.selectedIndex].page)})}}if(D(),!n(w)&&w>0&&j.zdf&&j.zdf){var d=4*w/25,u=C.right=new t.Container(45,270),o=C.icon=j.zdf.makeIcon(t.grey,t.lighter,t.silver).sca(.5).pos(0,0,!0,!0,u).mov(0,0).cur();o.on("mouseover",function(){S.animate({props:{scaleX:1},time:500,ease:"backOut",override:!0,timeUnit:"ms"}),o.stage.update()}),o.on("mouseout",function(){S.animate({props:{scaleX:0},time:300,ease:"backIn",override:!0,timeUnit:"ms"}),o.stage.update()}),o.on("mousedown",function(){nr("https://zimjs.com/marquee","_blank")});var S=C.label=new t.Label({text:"MARQUEE",color:t.dark,backgroundColor:t.lighter,shiftV:1,paddingV:5}).rot(-90).pos(0,13,!0,!1,u).reg(-10).sca(0,1).mov(0);u.fit(0,0,w-d,r-d),u.pos(w-u.width-d,d/2,!0,!0,C)}if(C.stage&&C.stage.update(),this.pause=function(h,b){n(h)&&(h=!0),h!=R&&(R=h,C.interval.pause(h,b),C.button.toggle(h))},Object.defineProperty(this,"paused",{get:function(){return R},set:function(){dt&&tt("Marquee() - paused is read only - use pause()")}}),Object.defineProperty(this,"time",{get:function(){return l},set:function(h){l=h,C.interval.time=l}}),this.load=function(h,b){var ye=[];m&&t.shuffle(h),t.loop(h,function(N){Array.isArray(N)?ye.push(N[0]):ye.push(N)});var B=C.stage?C.stage.frame:j.zdf;return C.marqueeLoader=B.loadAssets(ye,b),C.loadEvent=C.marqueeLoader.on("assetload",function(N){var re=h[N.asset.id],le,G;Array.isArray(re)?(le=re[0],G=re[1]):(le=re,G="_self"),C.add(N.asset,le,G),D()}),C},!n(p)){var F=new t.Rectangle(e-1,r-1,t.clear,p,x).loc(Y,null,C);F.mouseEnabled=!1}v!==!1&&t.styleTransforms(this,y),this.clone=function(){return C.cloneProps(new t.Marquee(e,r,i,l,a,s,f,T,p,x,P,m,v,this.group,g))},this.dispose=function(h,b,ye){return X&&X.clear(),C.interval&&C.interval.clear(),C.loadEvent&&C.marqueeLoader.off("assetload",C.loadEvent),k.dispose(),k=null,ye||this.zimContainer_dispose(!0),!0}},t.extend(t.Marquee,t.Container,["clone","dispose"],"zimContainer"),t.Carousel=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C){var L="items, viewNum, time, spacing, backgroundColor, backing, padding, paddingH, paddingV, arrowLeft, arrowRight, arrowGap, valign, ease, swipe, remember, selectedIndex, continuous, style, group, inherit",Y;if(Y=st(t.Carousel,arguments,L,this))return Y;De("67.45"),this.group=y;var _=A===!1?{}:t.getStyle("Carousel",this.group,C),k=this;this.zimContainer_constructor(),n(e)&&(e=_.items!=null?_.items:[new Sn({color:red}),new Sn({color:orange}),new Sn({color:yellow}),new Sn({color:green}),new Sn({color:blue}),new Sn({color:purple}),new Sn({color:pink})]),n(a)&&(a=_.backgroundColor!=null?_.backgroundColor:t.clear),n(s)&&(s=_.backing!=null?_.backing:null),n(P)&&(P=_.valign!=null?_.valign:"center"),n(r)&&(r=_.viewNum!=null?_.viewNum:3),n(l)&&(l=_.spacing!=null?_.spacing:20),n(f)&&(f=_.padding!=null?_.padding:0),n(c)&&(c=_.paddingH!=null?_.paddingH:f),n(w)&&(w=_.paddingV!=null?_.paddingV:f),n(T)&&(T=_.arrowLeft!=null?_.arrowLeft:new t.Arrow().rot(180)),n(p)&&(p=_.arrowRight!=null?_.arrowRight:new t.Arrow),n(x)&&(x=_.arrowGap!=null?_.arrowGap:20);var $=wt(i);n(i)&&(i=_.time!=null?_.time:$=="s"?.2:200),n(m)&&(m=_.ease!=null?_.ease:"quadInOut"),n(v)&&(v=_.swipe!=null?_.swipe:!0),n(I)&&(I=_.remember!=null?_.remember:"zimCarousel"),n(g)&&(g=_.selectedIndex!=null?_.selectedIndex:0),n(E)&&(E=_.continuous!=null?_.continuous:!0),I&&localStorage&&!n(localStorage[I])&&(localStorage[I]=="NaN"&&(localStorage[I]=0),g=Number(localStorage[I])),k.items=e,k.viewNum=r,k.spacing=l,k.arrowLeft=T,k.arrowRight=p,k.arrowLeft.oW=T.width,k.arrowRight.oW=p.width,s&&(k.backing=s);var O={};t.loop(e,function(o,S){typeof o=="string"&&(o=e[S]=new t.Pic(o)),o.reg(CENTER,CENTER);var F=O["width"+o.width];F?O["width"+o.width]+=1:O["width"+o.width]=1});var X=0,R=0;t.loop(O,function(o,S){S>X&&(X=S,R=Number(o.substring(5)))});var Q=0;t.loop(e,function(o){o.width=R,o.height>Q&&(Q=o.height)});var K;E?(k.continuous=!0,K=t.copy(e),t.loop(e.length,function(o){K.push(e[o].clone())})):K=e,k.itemWidth=R,k.itemHeight=Q;var q=T.width+x+c,ne;function U(){var o=r*(R+l)-l,S=Q;ne=o+c*2+x*2+T.width+p.width,k.setBounds(0,0,ne,S+w*2),k.tile=new t.Tile({obj:K,cols:K.length,spacingH:l,rows:1,unique:!0,align:"center",valign:P}).center(k).loc(q),k.background=new Sn(o+c*2,S+w*2,a).center(k,0),k.tile.setMask(k.background)}function D(){T.pos(0,0,"left","center",k),p.pos(0,0,"right","center",k),T.on("mousedown",function(){k.cycleInterval&&(k.cycleClear(),k.dispatchEvent("cyclecleared")),k.goLeft()}),p.on("mousedown",function(){k.cycleInterval&&(k.cycleClear(),k.dispatchEvent("cyclecleared")),k.goRight()}),u()}function d(){if(k.swipe){var o=k.swipeObj=new t.Swipe(k.tile);o.on("swipe",function(S){S.swipeX!=0&&k.cycleInterval&&(k.cycleClear(),k.dispatchEvent("cyclecleared")),S.swipeX==1?k.goLeft():S.swipeX==-1&&k.goRight()})}}function u(){localStorage&&I&&(localStorage[I]=k.selectedIndex),T.activate(!0),p.activate(!0),!E&&(k.tile.x+k.tile.width<=ne-p.oW-c-x&&p.activate(!1),k.tile.x>=q&&T.activate(!1))}k.goLeft=function(o){return n(o)&&(o=i),E&&k.tile.x>=-R&&(k.tile.x-=k.tile.width/2+l/2),k.tile.x<q&&(k.disableArrows(),g--,k.tile.animate({props:{x:k.tile.x+R+l},time:o,ease:m,call:function(){u(),k.enableArrows(),k.dispatchEvent("transitioned")}})),k},k.goRight=function(o){return n(o)&&(o=i),E&&k.tile.x-R<=ne-k.tile.width&&(k.tile.x+=k.tile.width/2+l/2),k.tile.x+k.tile.width>ne-p.oW-c-x&&(k.disableArrows(),g++,k.tile.animate({props:{x:k.tile.x-R-l},time:o,ease:m,call:function(){u(),k.enableArrows(),k.dispatchEvent("transitioned")}})),k},k.cycleClear=function(){return k.cycleInterval.clear(),k.cycleInterval=null,k},k.cycle=function(o,S,F,h,b,ye){var B="cycleTime, transitionTime, repeat, repeatNum, recycle, rtl",N;if(N=st(k.cycle,arguments,B))return N;n(o)&&(o=_.cycleTime!=null?_.cycleTime:$=="s"?5:5e3),n(S)&&(S=_.transitionTime!=null?_.transitionTime:$=="s"?1:1e3),n(F)&&(F=!0),n(h)&&(h=0),n(b)&&(b=o*2),n(ye)&&(ye=j.DIR&&j.DIR=="rtl"||!j.DIR&&t.DIR=="rtl");let re=ye?-1:1;return k.cycleInterval&&k.cycleInterval.clear(),b&&b!=-1&&(k.recycleEvent&&k.off("cyclecleared",k.recycleEvent),k.recycleWait&&k.recycleWait.clear(),k.recycleEvent=k.on("cyclecleared",function(){k.recycleWait&&k.recycleWait.clear(),k.recycleWait=$r(b,function(){k.cycle(o,S,F,h,b,ye)})})),E?(k.repeatTotal=0,k.cycleInterval=t.interval(o*2,function(le){if(k.selectedIndex==0)if(!F&&ye)k.cycleInterval.clear();else{if(ye&&le.count!=1&&(k.repeatTotal+=1),ye&&h!=0&&k.repeatTotal>=h){k.cycleInterval.clear(),k.dispatchEvent("repeatdone");return}re==1?k.goRight(S):k.goLeft(S)}else if(k.selectedIndex==e.length-r){if(!ye&&le.count!=1&&(k.repeatTotal+=1),!ye&&h!=0&&k.repeatTotal>=h){k.cycleInterval.clear(),k.dispatchEvent("repeatdone");return}k.repeatTotal>=1&&k.dispatchEvent("repeated"),!ye&&!F?k.cycleInterval.clear():re==1?k.goRight(S):k.goLeft(S)}else re==1?k.goRight(S):k.goLeft(S)})):(k.repeatTotal=.5,k.cycleInterval=t.interval(o*2,function(le){if(k.selectedIndex==0){if(le.count!=1&&(k.repeatTotal+=.5),h!=0&&k.repeatTotal>h){k.cycleInterval.clear(),k.dispatchEvent("bouncedone");return}k.repeatTotal>=1&&k.dispatchEvent("bounced"),re=1,k.goRight(S)}else if(k.selectedIndex==e.length-r){if(le.count!=1&&(k.repeatTotal+=.5),h!=0&&k.repeatTotal>h){k.cycleInterval.clear(),k.dispatchEvent("bouncedone");return}k.repeatTotal>=1&&k.dispatchEvent("bounced"),re=-1,k.goLeft(S)}else Rr(),re==1?k.goRight(S):k.goLeft(S)})),k},k.enableArrows=function(){return k.swipeObj&&(k.swipeObj.active=!0),T.mouse(),p.mouse(),k},k.disableArrows=function(){return k.swipeObj&&(k.swipeObj.active=!1),T.noMouse(),p.noMouse(),k},Object.defineProperty(k,"selectedIndex",{get:function(){return(g+e.length)%e.length},set:function(o){g=t.constrain(o,0,e.length-r),k.tile.x=q-g*(R+l),u()}}),Object.defineProperty(k,"swipe",{get:function(){return v},set:function(o){v=o,v&&!k.swipeObj&&d(),k.swipeObj.active=v}}),U(),D(),d(),s&&s.center(k,1),g&&(k.selectedIndex=g),this.dispose=function(o,S,F){return k.swipeObj&&k.swipeObj.dispose(),k.recycleEvent&&k.off("cyclecleared",k.recycleEvent),k.cycleWait&&k.cycleWait.clear(),k.cycleInterval&&k.cycleInterval.clear(),k.swipeObj=k.recycleEvent=k.cycleWait=null,F||this.zimContainer_dispose(),!0},A!==!1&&t.styleTransforms(this,_),this.clone=function(){return k.cloneProps(new t.Carousel(t.copy(e),r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,this.group))}},t.extend(t.Carousel,t.Container,["clone","dispose"],"zimContainer",!1),t.Loader=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O,X,R,Q,K,q,ne,U,D){var d="width, height, label, type, backgroundColor, rollBackgroundColor, color, rollColor, borderColor, rollBorderColor, borderWidth, corner, shadowColor, shadowBlur, hitPadding, gradient, gloss, dashed, backing, rollBacking, rollPersist, icon, rollIcon, toggle, toggleBacking, rollToggleBacking, toggleIcon, rollToggleIcon, toggleEvent, frame, multiple, accept, style, group, inherit",u;if(u=st(t.Loader,arguments,d,this))return u;De("67.5"),this.group=U;var o=ne===!1?{}:t.getStyle("Loader",this.group,D);if(n(e)&&(e=o.width!=null?o.width:250),n(r)&&(r=o.height!=null?o.height:70),n(l)&&(l=o.type!=null?o.type:"image"),l=l.toLowerCase(),n(a)&&(a=o.backgroundColor!=null?o.backgroundColor:"rgba(0,0,0,.05)"),n(s)&&(s=o.rollBackgroundColor!=null?o.rollBackgroundColor:"rgba(0,0,0,.1)"),n(f)&&(f=o.color!=null?o.color:"rgba(0,0,0,.5)"),n(c)&&(c=o.rollColor!=null?o.rollColor:f),n(w)&&(w=o.borderColor!=null?o.borderColor:"rgba(0,0,0,.3)"),n(p)&&(p=o.borderWidth!=null?o.borderWidth:1),n(E)&&(E=o.dashed!=null?o.dashed:!0),n(x)&&(x=o.corner!=null?o.corner:0),n(K)&&(K=o.multiple!=null?o.multiple:!0),n(i)&&(i=o.label!=null?o.label:new t.Label({text:"UPLOAD PIC",color:f,rollColor:c,valign:"center",align:"center",backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",backgroundColor:"ignore",group:this.group})),typeof Q>"u")if(j.zdf)var Q=j.zdf;else{dt&&tt("zim.Loader - please provide a reference to zim Frame");return}this.zimButton_constructor(e,r,i,a,s,null,f,c,null,w,p,T,null,A,y,null,L,Y,null,x,E,P,m,I,g,null,null,null,null,null,v,null,null,null,C,_,null,null,null,null,null,null,k,$,null,O,X,null,R,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,!1),this.type="Loader";var S=this,F=Q.stage;i=S.label;var h=S.tag=document.createElement("input");Q.tag?Q.tag.appendChild(h):document.body.appendChild(h),h.setAttribute("type","file"),h.setAttribute("aria-hidden",!0),K&&h.setAttribute("multiple","multiple"),q&&h.setAttribute("accept",q),h.hidden=!0,h.zimDisplay=h.style.display||"inline-block",h.style.cssText="border:thin solid grey; z-index:2; width:"+e+"px; height:"+r+"px; overflow:hidden; outline:none;position:absolute; left:0px; top:0px; display:none; cursor:pointer; opacity: 0; filter: alpha(opacity=0);",this.addEventListener("mousedown",function(){h.click()}),h.addEventListener("change",N);var b=new Ne.DOMElement(h);F.addChild(b),b.alpha=0;var ye=Q.retina&&j.devicePixelRatio||1;this.resize=function(G,z){if(!S.stage){h.setAttribute("aria-hidden",!0),h.hidden=!0,h.style.display="none";return}h.setAttribute("aria-hidden",!1),h.hidden=!1,h.style.display=h.zimDisplay,n(G)&&(G=!0),S.time1&&clearTimeout(S.time1),z||(S.time1=setTimeout(function(){S.resize(null,!0)},40));var se=S.getConcatenatedMatrix().decompose(),Oe=S.localToGlobal(0,0);if(Q.retina){var J=t.browserZoom();Q.tag?(b.x=Oe.x/ye/J,b.y=Oe.y/ye/J):(b.x=Q.x/F.scaleX+Oe.x/ye/J,b.y=Q.y/F.scaleY+Oe.y/ye/J),t.sca(b,se.scaleX/ye/F.scaleX/J,se.scaleY/ye/F.scaleY/J)}else b.x=Q.x+Oe.x*Q.scale,b.y=Q.y+Oe.y*Q.scale,t.sca(b,Q.scale*se.scaleX,Q.scale*se.scaleY);return F.update(),S},this.resize(),S.on("added",function(){h.style.display="block",h.hidden=!1,h.style.display="block",S.resize()}),S.added(B);function B(){S.resize(),S.time2=setTimeout(function(){h.style.display="block",h.hidden=!1,h.style.display="block"},50),S.on("added",B,null,!0)}S.on("removed",function(){S.time1&&clearTimeout(S.time1),S.time2&&clearTimeout(S.time2),h&&(h.style.display="none",h.hidden=!0,h.style.display="none")});function N(G){var z;if(G.dataTransfer&&G.dataTransfer.files&&G.dataTransfer.files.length>0?z=G.dataTransfer.files:z=G.target.files,l=="text"||l=="json"){var se=[],Oe;if(l.toLowerCase()=="json")var J=[],pe}else if(l=="other")var Z=[],de;else var V=[],fe;for(var ke=0;ke<z.length;ke++)(function(oe){var Ce=new FileReader;Ce.onload=function(Me){if(l=="text"||l=="json"){var te=Me.target.result;if(se.push(te),l=="json"){var ae=JSON.parse(te);J.push(ae)}if(se.length==1&&(Oe=te,l=="json"&&(pe=ae)),se.length==z.length){var we=new Ne.Event("loaded");we.texts=se,we.text=Oe,we.lastText=te,we.total=se.length,l=="json"&&(we.jsons=J,we.json=pe,we.lastJSON=ae),S.dispatchEvent(we),h.value=""}}else if(l=="other"){var ue=Me.target.result;if(Z.push(ue),Z.length==1&&(de=ue),Z.length==z.length){var we=new Ne.Event("loaded");we.others=Z,we.other=de,we.lastOther=ue,we.total=Z.length,S.dispatchEvent(we),h.value=""}}else{var Pe=new Image;Pe.onload=function(){var ie=new t.Bitmap(Pe);if(V.push(ie),V.length==1&&(fe=ie),V.length==z.length){var be=new Ne.Event("loaded");be.bitmaps=V,be.bitmap=fe,be.lastBitmap=ie,be.total=V.length,S.dispatchEvent(be),h.value=""}},Pe.src=Me.target.result}},l=="text"||l=="json"?Ce.readAsText(oe):Ce.readAsDataURL(oe)})(z[ke])}var re=new XMLHttpRequest;if(re.upload){var le=function(G){h.removeEventListener("change",N),N(G),setInterval(function(){h.addEventListener("change",N)},100)};h.addEventListener("drop",le)}this.save=function(G,z,se,Oe,J,pe,Z,de,V,fe,ke){var oe="content, filename, x, y, width, height, cached, cachedBounds, type, data, quality",Ce;if(Ce=st(S.save,arguments,oe))return Ce;if(n(G)&&(G=Q.stage),n(V)&&(V="png"),n(z))z="saved_"+String(t.makeID("numbers",5))+"."+V;else{var Me=z.split(".");if(Me.length==1)z+="."+V;else{var te=["png","jpg","jpeg"],ae=te.indexOf(Me[Me.length-1].toLowerCase());ae==-1?z+="."+V:V=te[ae]}}if(n(se)&&(se=0),n(Oe)&&(Oe=0),n(J)&&(J=G.getBounds&&G.getBounds()?G.getBounds().width:Q.width),n(pe)&&(pe=G.getBounds&&G.getBounds()?G.getBounds().height:Q.height),G.cache(se,Oe,J,pe),fe){var we=G.cacheCanvas.toDataURL("image/"+V,ke);return Z?de&&G.cache(de.x,de.y,de.width,de.height):G.uncache(),we}var ue=/Edge\/(\d)+/.test(navigator.userAgent);if(ue){var Pe=j.open();Pe.document.write("<html><head><title>saved</title></head><body style='margin:0px;padding:0px;overflow:hidden'><img src="+G.cacheCanvas.toDataURL("image/"+V)+"></body></html>"),Pe.document.close()}else{V=="jpg"&&(V="jpeg");var ie=document.createElement("a");ie.setAttribute("download",z),ie.setAttribute("href",G.cacheCanvas.toDataURL("image/"+V,ke)),document.body.appendChild(ie),ie.click(),document.body.removeChild(ie)}return Z?de&&G.cache(de.x,de.y,de.width,de.height):G.uncache(),S},ne!==!1&&t.styleTransforms(this,o),this.clone=function(){var G=new t.Loader(e,r,n(i)?null:i.clone(),a,s,f,c,w,p,x,P,m,v,I,g,n(A)?null:A.clone(),n(y)?null:y.clone(),C,n(L)?null:L.clone(),n(Y)?null:Y.clone(),_,n(k)?null:k.clone(),n($)?null:$.clone(),n(O)?null:O.clone(),n(X)?null:X.clone(),R,Q,ne,this.group);return S.cloneProps(G)},Object.defineProperty(this,"frame",{get:function(){return Q},set:function(G){G!=Q&&(Q.off("update",S.updateEvent),Q.off("resize",S.resizeEvent),Q=G,S.resizeEvent=Q.on("resize",S.resize),S.updateEvent=Q.on("update",S.resize),S.resize())}}),this.resizeEvent=Q.on("resize",S.resize),this.updateEvent=Q.on("update",S.resize),this.dispose=function(G,z,se){var Oe;return S.stage&&(Oe=S.stage),Q.off("update",S.updateEvent),Q.off("resize",S.resizeEvent),N&&h.removeEventListener("change",N),le&&h.removeEventListener("drop",le),h&&h.parentNode&&h.parentNode.removeChild(h),h=null,se||(this.zimButton_dispose(),Oe&&Oe.update()),!0}},t.extend(t.Loader,t.Button,["clone","dispose"],"zimButton",!1),t.TextArea=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O){var X="width, height, placeholder, text, size, padding, color, backgroundColor, borderColor, borderWidth, corner, shadowColor, shadowBlur, dashed, id, readOnly, spellCheck, password, inputType, wrap, maxLength, frame, expand, keyboardShift, style, group, inherit",R;if(R=st(t.TextArea,arguments,X,this))return R;De("67.6"),this.group=$;var Q=k===!1?{}:t.getStyle("TextArea",this.group,O);if(n(e)&&(e=Q.width!=null?Q.width:250),n(r)&&(r=Q.height!=null?Q.height:70),n(i)&&(i=Q.placeholder!=null?Q.placeholder:null),n(l)&&(l=Q.text!=null?Q.text:null),n(a)&&(a=Q.size!=null?Q.size:20),n(s)&&(s=Q.padding!=null?Q.padding:5),n(f)&&(f=Q.color!=null?Q.color:t.granite),n(c)&&(c=Q.backgroundColor!=null?Q.backgroundColor:"rgba(256,256,256,.1)"),n(w)&&(w=Q.borderColor!=null?Q.borderColor:"rgba(0,0,0,.1)"),n(T)&&(T=Q.borderWidth!=null?Q.borderWidth:null),w<0||T<0?w=T=null:w!=null&&T==null&&(T=1),n(p)&&(p=Q.corner!=null?Q.corner:0),!n(P)&&n(x)&&(x=Q.shadowColor!=null?Q.shadowColor:"rgba(0,0,0,.3)"),!n(x)&&n(P)&&(P=Q.shadowBlur!=null?Q.shadowBlur:10),n(E)&&(E=Q.password!=null?Q.password:!1),n(A)&&(A=Q.inputType!=null?Q.inputType:!1),n(y)&&(y=Q.wrap!=null?Q.wrap:!0),n(C)&&(C=Q.maxLength!=null?Q.maxLength:null),n(g)&&(g=Q.spellCheck!=null?Q.spellCheck:!0),n(I)&&(I=Q.readOnly!=null?Q.readOnly:!1),n(_)&&(_=Q.keyboardShift!=null?Q.keyboardShift:!1),this.maxLength=C,n(Y)&&(Y=Q.expand!=null?Q.expand:20),Y===!0&&(Y=20),typeof L>"u")if(j.zdf)var L=j.zdf;else{dt&&tt("zim.TextArea - please provide a reference to zim Frame");return}this.zimContainer_constructor(e,r,null,null,!1),this.type="TextArea";var K=this,q=L.stage,ne=this.background=new t.Rectangle(e,r,c,w,T,p,m,null,null,!1).expand(Y);x!=-1&&P>0&&(ne.shadow=new Ne.Shadow(x,3,3,P)),K.addChild(ne);var U=K.tag=A||E?document.createElement("input"):document.createElement("textarea");L.tag?L.tag.appendChild(U):document.body.appendChild(U),n(v)||(U.setAttribute("id",v),U.setAttribute("name",v)),E?U.setAttribute("type","password"):A&&U.setAttribute("type",A),U.readOnly=I,U.spellcheck=g,i&&U.setAttribute("placeholder",i),l&&(U.value=l),U.zimDisplay=U.style.display||"inline-block",U.style.cssText="background-color:rgba(0,0,0,.01); color:"+f+"; resize:none; z-index:3; width:"+(e-s*2)+"px; height:"+(r-s*2)+"px; overflow:hidden; outline:none;font-size:"+a+"px; font-family:"+(Q.font!=null?Q.font:"arial")+"; border:none; position:absolute; left:0px; top:0px; display:none;",K.taInput=function(){!n(K.maxLength)&&K.text.length>K.maxLength&&(K.text=K.text.substring(0,K.maxLength)),K.dispatchEvent("input")};var D=K.y;K.taFocus=function(){if(j.M&&_){K.re&&K.stage.frame.off("resize",K.re),K.re=K.stage.frame.on("resize",function(){K.stage&&S>K.stage.height/4&&(K.stage.y=K.stage.scaleY*(K.stage.height/4-S),K.stage.update())});var S=K.localToGlobal(0,0).y;K.stage&&S>K.stage.height/4&&(K.stage.y=K.stage.scaleY*(K.stage.height/4-S),K.stage.update())}K.stage&&(L=K.stage.frame),L.zil&&j.removeEventListener("keydown",L.zil[0]),K.dispatchEvent("focus")},K.taBlur=function(){j.M&&_&&K.stage&&(K.re&&K.stage.frame.off("resize",K.re),K.stage.y=D,K.stage.update()),K.stage&&(L=K.stage.frame),L.zil&&j.addEventListener("keydown",L.zil[0]),K.dispatchEvent("blur")},U.addEventListener("change",K.taChange),U.addEventListener("input",K.taInput),U.addEventListener("focus",K.taFocus),U.addEventListener("blur",K.taBlur);var d=new Ne.DOMElement(U);d.alpha=0,this.on("mousedown",function(){setTimeout(function(){U.focus()},100)}),this.setFocus=function(S){return n(S)&&(S=!0),S?U.focus():U.blur(),K};var u=L.retina&&j.devicePixelRatio||1;this.resize=function(S,F){n(S)&&(S=!0),K.time1&&clearTimeout(K.time1),F||(K.time1=setTimeout(function(){K.resize(null,!0)},40));var h=K.getConcatenatedMatrix().decompose(),b=K.localToGlobal(s,s);if(L.retina){var ye=t.browserZoom();L.tag?(d.x=b.x/u/ye,d.y=b.y/u/ye):(d.x=L.x/q.scaleX+b.x/u/ye,d.y=L.y/q.scaleY+b.y/u/ye),t.sca(d,h.scaleX/u/q.scaleX/ye,h.scaleY/u/q.scaleY/ye)}else L.tag?(d.x=b.x*L.scale,d.y=b.y*L.scale):(d.x=L.x+b.x*L.scale,d.y=L.y+b.y*L.scale),t.sca(d,L.scale*h.scaleX,L.scale*h.scaleY);return d.alpha=K.alpha,K.parent&&(d.alpha*=K.parent.alpha),S&&K.stage&&q.update(),K},this.resize(),K.added(o);function o(){q.addChild(d),K.time2=setTimeout(function(){U.style.display=U.zimDisplay},50),K.resize(),K.on("added",o,null,!0),K.FOEvent=q.on("stagemousedown",function(){K.focus=!1})}K.on("removed",function(){K.time1&&clearTimeout(K.time1),K.time2&&clearTimeout(K.time2),q.removeChild(d),K.FOEvent&&q.off("stagemousedown",K.FOEvent),U&&(U.style.display="none")}),Object.defineProperty(this,"currentValue",{get:function(){return U.value},set:function(S){U.value=S}}),Object.defineProperty(this,"text",{get:function(){return U.value},set:function(S){U.value=S}}),Object.defineProperty(this,"focus",{get:function(){return document.activeElement==U},set:function(S){K.setFocus(S)}}),Object.defineProperty(this,"readOnly",{get:function(){return U.readOnly},set:function(S){U.readOnly=S}}),j.KEYFOCUS!=null&&(t.KEYFOCUS=j.KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return t.KEYFOCUS==K},set:function(){t.KEYFOCUS=K}}),t.KEYFOCUS||(K.keyFocus=!0),K.taMousedown=function(){K.keyFocus=!0},U.addEventListener("mousedown",K.taMousedown),y||(U.style.whiteSpace="pre"),k!==!1&&t.styleTransforms(this,Q),this.clone=function(){var S=new t.TextArea(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,this.group,O);return K.cloneProps(S)},Object.defineProperty(this,"frame",{get:function(){return L},set:function(S){S!=L&&(L.off("update",K.updateEvent),L.off("resize",K.resizeEvent),L=S,K.resizeEvent=L.on("resize",K.resize),K.updateEvent=L.on("update",K.resize),u=L.retina&&j.devicePixelRatio||1,q=L.stage,K.resize())}}),this.resizeEvent=L.on("resize",K.resize),this.updateEvent=L.on("update",K.resize),this.dispose=function(S,F,h){var b;return K.stage&&(b=K.stage),L.off("update",K.updateEvent),L.off("resize",K.resizeEvent),b&&K.FOEvent&&b.off("stagemousedown",K.FOEvent),U&&U.parentNode&&U.parentNode.removeChild(U),U.removeEventListener("change",K.taChange),U.removeEventListener("input",K.taInput),U.removeEventListener("focus",K.taFocus),U.removeEventListener("blur",K.taBlur),U.removeEventListener("mousedown",K.taMousedown),U=null,h||(this.zimContainer_dispose(!0),b&&b.update()),K.background=null,!0}},t.extend(t.TextArea,t.Container,["clone","dispose"],"zimContainer",!1),t.Tag=function(e,r,i,l,a,s,f,c,w,T,p,x){var P="width, height, id, frame, backgroundColor, padding, paddingH, paddingV, expand, style, group, inherit",m;if(m=st(t.Tag,arguments,P,this))return m;De("67.7"),this.group=p;var v=T===!1?{}:t.getStyle("Tag",this.group,x);if(n(e)&&(e=v.width!=null?v.width:250),n(r)&&(r=v.height!=null?v.height:70),n(i)&&(i=v.id!=null?v.id:"zimTag_"+t.rand(1e4)),typeof l>"u")if(j.zdf)var l=j.zdf;else{dt&&tt("zim.Tag - please provide a reference to zim Frame");return}n(a)&&(a=v.backgroundColor!=null?v.backgroundColor:"rgba(0,0,0,0)"),n(s)&&(s=v.padding!=null?v.padding:10),n(f)&&(f=v.paddingH!=null?v.paddingH:s),n(c)&&(c=v.paddingV!=null?v.paddingV:s),n(w)&&(w=v.expand!=null?v.expand:20),w===!0&&(w=20),this.zimContainer_constructor(e,r,null,null,!1),this.type="Tag",this.tagID=i,this.id=i;var I=this,g=l.stage;I.background=new t.Rectangle(e+f,r+c,a).center(this).expand(w||0);var E=I.tag=document.createElement("div");l.tag?l.tag.appendChild(E):document.body.appendChild(E),E.setAttribute("id",i),E.setAttribute("name",i),E.zimDisplay=E.style.display||"inline-block",E.style.cssText="resize:none; z-index:3; width:"+e+"px; height:"+r+"px; overflow:hidden; outline:none;position:absolute; left:0px; top:0px; display:none;";var A=new Ne.DOMElement(E);A.alpha=0;var y=l.retina&&j.devicePixelRatio||1;this.resize=function(L,Y){n(L)&&(L=!0),I.time1&&clearTimeout(I.time1),Y||(I.time1=setTimeout(function(){I.resize(null,!0)},40));var _=I.getConcatenatedMatrix().decompose(),k=I.localToGlobal(0,0);if(l.retina){var $=t.browserZoom();l.tag?(A.x=k.x/y/$,A.y=k.y/y/$):(A.x=l.x/g.scaleX+k.x/y/$,A.y=l.y/g.scaleY+k.y/y/$),t.sca(A,_.scaleX/y/g.scaleX/$,_.scaleY/y/g.scaleY/$)}else A.x=l.x+k.x*l.scale,A.y=l.y+k.y*l.scale,t.sca(A,l.scale*_.scaleX,l.scale*_.scaleY);return A.alpha=I.alpha,I.parent&&(A.alpha*=I.parent.alpha),L&&I.stage&&g.update(),I},this.resize(),I.added(C);function C(){g.addChild(A),I.time2=setTimeout(function(){E.style.display=E.zimDisplay},50),I.resize(),I.on("added",C,null,!0)}I.on("removed",function(){I.time1&&clearTimeout(I.time1),I.time2&&clearTimeout(I.time2),g.removeChild(A),E&&(E.style.display="none")}),this.add=function(L){return E.innerHTML+=L,I},Object.defineProperty(this,"innerHTML",{get:function(){return E.innerHTML},set:function(L){E.innerHTML=L}}),Object.defineProperty(this,"style",{get:function(){return E.style},set:function(L){E.style=L}}),T!==!1&&t.styleTransforms(this,v),this.clone=function(){var L=new t.Tag(e,r,i,l,a,s,f,c,w,T,this.group,x);return I.cloneProps(L)},Object.defineProperty(this,"frame",{get:function(){return l},set:function(L){L!=l&&(l.off("update",I.updateEvent),l.off("resize",I.resizeEvent),l=L,I.resizeEvent=l.on("resize",I.resize),I.updateEvent=l.on("update",I.resize),I.resize())}}),this.resizeEvent=l.on("resize",I.resize),this.updateEvent=l.on("update",I.resize),this.dispose=function(L,Y,_){var k;return I.stage&&(k=I.stage),l.off("update",I.updateEvent),l.off("resize",I.resizeEvent),E&&E.parentNode&&E.parentNode.removeChild(E),E=null,_||(this.zimContainer_dispose(!0),k&&k.update()),!0}},t.extend(t.Tag,t.Container,["clone","dispose"],"zimContainer",!1);function bt(e,r){r?(e.mouseChildren=!0,e.mouseEnabled=!0,e._enabled=!0):(e.mouseChildren=!1,e.mouseEnabled=!1,e._enabled=!1)}if(t.addTo=function(e,r,i,l){var a="obj, container, index, localToLocal",s;if(s=st(t.addTo,arguments,a))return s;if(De("47.5"),n(e)){tt("zim methods - addTo(): please provide object");return}if(n(r))if(j.zdf)r=j.zdf.stage;else{tt("zim methods - addTo(): please provide container");return}if(n(l)&&(l=!0),e.parent||(l=!1),l)var f=e.parent.localToLocal(e.x,e.y,r);return n(i)||isNaN(i)?r.addChild(e):r.addChildAt(e,i),l&&(e.x=f.x,e.y=f.y),e},t.removeFrom=function(e,r){if(De("47.6"),n(e)){tt("zim methods - removeFrom(): please provide object");return}return e.removePhysics&&e.removePhysics(),n(r)?e.parent&&e.parent.removeChild(e):r.removeChild(e),e},t.added=function(e,r,i,l){if(De("47.7"),!(n(e)||n(r)||typeof r!="function")){var a=wt(i);if(n(i)&&(i=a=="s"?.1:100),e.stage){r(e.stage,e);return}var s=i*(a=="s"?1e3:1),f;l&&(It(l),f=l*(a=="s"?1e3:1));var c=Date.now(),w=0,T=setInterval(function(){if(w>5){clearInterval(T);return}w++,e.stage&&(r(e.stage,e),clearInterval(T),clearInterval(p))},10),p=setInterval(function(){f>0&&c-Date.now()>f&&clearInterval(p),e.stage&&(r(e.stage,e),clearInterval(p))},s);return p}},t.centerReg=function(e,r,i,l){var a="obj, container, index, add",s;if(s=st(t.centerReg,arguments,a))return s;if(e.type=="AC"&&j.zdf)return j.zdf.ac("centerReg",arguments),e.addTo(r,i);if(De("48"),n(e)||!e.getBounds||!e.getBounds())return tt("zim methods - centerReg(): please provide object with bounds set"),e;n(l)&&(l=!0),n(r)&&e.parent&&l&&(r=e.parent,n(i)&&(i=e.parent.getChildIndex(e)),e.parent.removeChild(e)),!n(r)&&r==e.parent&&(n(i)&&(i=e.parent.getChildIndex(e)),e.parent.removeChild(e));var f=e.getBounds();return e.regX=f.x+f.width/2,e.regY=f.y+f.height/2,l?t.center(e,r,i):e},t.center=function(e,r,i,l){var a="obj, container, index, add",s;if(s=st(t.center,arguments,a))return s;if(e.type=="AC"&&j.zdf)return j.zdf.ac("center",arguments),e.addTo(r,i);if(t.centerCheck||(De("48.1"),t.centerCheck=!0),n(e)||!e.getBounds)return tt("zim.center(): please provide object with bounds"),e;if(n(r)&&(e.parent?r=e.parent:j.zdf&&(r=j.zdf.stage)),n(r)||!r.getBounds)return tt("zim.center(): please provide container with bounds"),e;var f=e.getBounds(),c=r.getBounds();n(l)&&(l=!0);var w=!1;if(n(c)&&(r.setBounds(0,0),c=r.getBounds(),w=!0),l&&r.addChild&&(n(i)||typeof i=="number"&&isNaN(i)?(!e.parent||e.parent!=r)&&r.addChild(e):r.addChildAt(e,i)),n(f))return e.x=c.x+c.width/2,e.y=c.y+c.height/2,e;var T=!1,p=!1;r.scaleX==0&&(T=!0,r.scaleX=1e-5),r.scaleY==0&&(p=!0,r.scaleY=1e-5);var x=e.localToLocal(e.regX,e.regY,r),P=t.boundsToGlobal(e),m=t.boundsToGlobal(r,P,!0);if(T&&(r.scaleX=0),p&&(r.scaleY=0),e.x=c.x+c.width/2-m.width/2+(x.x-m.x),e.y=c.y+c.height/2-m.height/2+(x.y-m.y),!l&&r.getStage&&r.stage&&e.parent){var v=r.localToLocal(e.x,e.y,e.parent);e.x=v.x,e.y=v.y}return w&&r.setBounds(null),e},t.place=function(e,r){if(De("49"),n(e))return;n(r)&&(r="obj"),t.lastPlace=e;function i(){tt(r+".x = "+Math.round(e.x)+"; "+r+".y = "+Math.round(e.y)+";"),tt(r+".loc("+Math.round(e.x)+", "+Math.round(e.y)+");")}t.drag({obj:e,currentTarget:!0,dragCursor:"crosshair"}),e.on("mousedown",function(){t.lastPlace=e});var l=j.zdf;return l&&l.on("keydown",function(a){if(e==t.lastPlace){var s=a.keyCode;if(s>=37&&s<=40){var f=a.shiftKey?10:1;e.mov(s==37?-1*f:s==39?1*f:0,s==38?-1*f:s==40?1*f:0),i(),e.stage&&e.stage.update()}}}),tt("place "+r+" - to get new position",e),e.on("click",i),e},t.placeReg=function(e,r){if(De("49.5"),n(e))return;var i=e.stage;if(n(i))return tt("zim.placeReg() - add object to stage before calling placeReg()"),e;n(r)&&(r="obj");function l(){var f=e.globalToLocal(s.x,s.y);tt(r+".regX = "+Math.round(f.x)+"; "+r+".regY = "+Math.round(f.y)+";"),tt(r+".reg("+Math.round(f.x)+", "+Math.round(f.y)+");")}var a=e.parent.localToGlobal(e.x,e.y),s=new t.Shape(-25,-25,50,50,null,!1).addTo(i).pos({x:a.x,y:a.y,reg:!0});return s.graphics.s("white").mt(-25,0).lt(25,0).mt(0,-25).lt(0,20),s.compositeOperation="difference",s.expand(0),t.drag({obj:s}),tt("place cursor to get new registration point location"),i.on("stagemouseup",l),e},t.pos=function(e,r,i,l,a,s,f,c,w,T,p){var x="obj, x, y, horizontal, vertical, container, index, add, reg, regX, regY",P;if(P=st(t.pos,arguments,x))return P;if(e.type=="AC"&&j.zdf)return j.zdf.ac("pos",arguments),e.addTo(s,f);De("41.5"),j.DIR&&j.DIR=="rtl"||!j.DIR&&t.DIR=="rtl"?l=="start"?l="right":l=="end"&&(l="left"):l=="start"?l="left":l=="end"&&(l="right");var m=!1;l=="right"&&(m=!0);var v=!1;a=="bottom"&&(v=!0);var I=t.POSREG;if(j.POSREG!=null&&(I=j.POSREG),n(w)&&(w=I),n(e))return;n(w)&&n(T)&&(T=!1),n(w)&&n(p)&&(p=!1),!n(w)&&n(T)&&(T=w),!n(w)&&n(p)&&(p=w),n(c)&&(c=!0),!n(s)&&!s.addChild&&(s=null),!e.getBounds&&!e.getBounds()&&(T=p=!1),e.zimPos={x:r,y:i,h:l,v:a,i:f},n(s)&&(e.parent?s=e.parent:j.zdf&&(s=j.zdf.stage)),!e.parent&&n(r)&&(r=0),!e.parent&&n(i)&&(i=0);var g=!1;e.getBounds()||(e.setBounds(0,0),g=!0);var E=!1;s&&!s.getBounds()&&(s.setBounds(0,0),E=!0);function A(){n(f)||typeof f=="number"&&isNaN(f)?s.contains(e)||s.addChild(e):s.addChildAt(e,f)}if(!n(s)&&s.addChild&&c){var y=s.getBounds().clone();A();var C=s.getBounds();(y.width!=C.width||y.height!=C.height||y.x!=C.x||y.y!=C.y)&&(e.removeFrom(),s.setBounds(y.x,y.y,y.width,y.height),E=!0,A())}if(!T&&!p&&(l=="center"||l=="middle")&&(a=="center"||a=="middle"))return e.center({container:s}),e.mov(r,i),g&&e.setBounds(null),E&&s.setBounds(null),e;if(l=="center"||l=="middle"){if(T)e.x=s.width/2;else{var L=e.y;e.center(),e.y=L}e.mov(r),r=null,l=null}else l===!0&&(m=!0);if(a=="center"||a=="middle"){if(p)e.y=s.height/2;else{var Y=e.x;e.center(),e.x=Y}e.mov(0,i),i=null,a=null}else a===!0&&(v=!0);function _(){var Q=e.getBounds(),K=Q.x,q=Q.y,ne=Q.width,U=Q.height,D=e._props.matrix;D=e.getMatrix(D),(K||q)&&D.appendTransform(0,0,1,1,0,0,0,-K,-q);var d=ne*D.a,u=ne*D.b,o=U*D.c,S=U*D.d,F=D.tx,h=D.ty,b=F,ye=F,B=h,N=h;return(K=d+F)<b?b=K:K>ye&&(ye=K),(K=d+o+F)<b?b=K:K>ye&&(ye=K),(K=o+F)<b?b=K:K>ye&&(ye=K),(q=u+h)<B?B=q:q>N&&(N=q),(q=u+S+h)<B?B=q:q>N&&(N=q),(q=S+h)<B?B=q:q>N&&(N=q),{x:b,y:B,width:ye-b,height:N-B}}if(e.parent&&e.parent.getBounds){if(s=e.parent,n(r)&&m==!0&&(r=0),n(i)&&v==!0&&(i=0),n(r)||(e.x=r),n(i)||(e.y=i),n(r)&&n(i)&&!m&&!v)return g&&e.setBounds(null),E&&s.setBounds(null),e;var k=0,$=0;if(e.getBounds()){var O=_();if(!n(r)){var X;m?X=new t.Point(O.x+O.width,O.y+O.height):X=new t.Point(O.x,O.y),k=X.x-r}n(i)||(v?X=new t.Point(O.x+O.width,O.y+O.height):X=new t.Point(O.x,O.y),$=X.y-i);var R=s.getBounds();n(r)||(m?T?e.x=R.width+R.x-r:e.x=R.width+R.x-r-k:(T?e.x=r:e.x=r-k,e.x+=R.x)),n(i)||(v?p?e.y=R.height+R.y-i:e.y=R.height+R.y-i-$:(p?e.y=i:e.y=i-$,e.y+=R.y))}}return g&&e.setBounds(null),E&&s.setBounds(null),c||e.removeFrom(),e},t.loc=function(e,r,i,l,a,s,f,c){var w="obj, target, y, container, index, add, localToLocal, x",T;if(T=st(t.loc,arguments,w))return T;if(e.type=="AC"&&j.zdf)return j.zdf.ac("loc",arguments),e.addTo(l,a);if(De("41.55"),!n(e)){if(typeof r=="number"&&(c=r,r=null),n(r)||(Array.isArray(r)?(c=r[0],i=r[1]):(n(r.x)||(c=r.x),n(r.y)||(i=r.y))),n(c)&&n(r)&&(c=e.x),n(i)&&n(r)&&(i=e.y),n(s)&&(s=!0),n(l)&&(e.parent?l=e.parent:j.zdf&&(l=j.zdf.stage)),s&&l&&(!e.parent||l!=e.parent?n(a)||isNaN(a)?l.addChild(e):l.addChildAt(e,a):n(a)||l.addChildAt(e,a)),n(f)&&(f=!0),r&&r.parent&&e.parent&&f){var p=r.parent.localToLocal(c,i,e.parent);c=p.x,i=p.y}return e.x=c,e.y=i,e}},t.mov=function(e,r,i){var l="obj, x, y",a;if(a=st(t.mov,arguments,l))return a;if(e.type=="AC"&&j.zdf)return j.zdf.ac("mov",arguments),e;if(De("41.6"),!n(e))return n(r)||(e.x+=r),n(i)||(e.y+=i),e},t.sca=function(e,r,i){return e.type=="AC"&&j.zdf?(j.zdf.ac("sca",arguments),e):(De("41.97"),n(e)||n(e.scaleX)||(n(r)&&(r=e.scaleX),n(i)&&(i=r),e.scaleX=r,e.scaleY=i),e)},t.alp=function(e,r){if(De("41.7"),!n(e))return n(r)||(e.alpha=e.hovOriginal=r,e.tag&&e.tag.style&&(e.type!="Loader"&&(e.tag.style.opacity=r),r==0?e.tag.style.display=e.tag.zimDisplay="none":e.tag.style.display=e.tag.zimDisplay="inline-block")),e},t.vis=function(e,r){if(De("41.71"),!n(e))return e.visible=r,e.tag&&e.tag.style&&(r?e.tag.style.display=e.tag.zimDisplay="inline-block":e.tag.style.display=e.tag.zimDisplay="none"),e},t.ble=function(e,r){if(De("41.72"),!n(e))return n(r)&&(r="difference"),e.compositeOperation=r,(e.type=="Blob"||e.type=="Squiggle")&&e.update(),e},t.dye=function(e,r){if(De("41.73"),!n(e))return e.hasOwnProperty("backgroundColor")?e.backgroundColor=r:e.hasOwnProperty("color")&&(e.color=r),e},t.hov=function(e,r,i){if(De("41.75"),!n(e))return n(r)&&(r=1),n(i)&&(i=typeof r=="number"?"alpha":"color"),e.hovMouseover&&(e.off("mouseover",e.hovMouseover),e.off("mouseout",e.hovMouseout)),r==-1?(e.cur("default"),n(e.hovOld)||(e[e.hovType]=e.hovOld),e.hovOld=null,e.stage&&e.stage.update(),e):(e.cur(),e.hovOld=e[i],e.hovNew=r,e.hovType=i,e.hovMouseover=e.on("mouseover",function(){e[i]=e.hovNew,e.stage&&e.stage.update()}),e.hovMouseout=e.on("mouseout",function(){e[i]=e.hovOld,e.stage&&e.stage.update()}),e)},t.rot=function(e,r,i,l){if(De("41.8"),!n(e)){if(e.type=="AC"&&j.zdf)return j.zdf.ac("rot",arguments),e;if(!n(r))if(e.parent&&(!n(i)||!n(l))){n(i)&&(i=e.x),n(l)&&(l=e.y);var a=e.parent.localToLocal(i,l,e),s=new t.Point(e.x,e.y);e.reg(a.x,a.y),e.rotation=r,e.x=i,e.y=l;var f=e.parent.localToLocal(s.x,s.y,e);e.reg(f.x,f.y),e.x=s.x,e.y=s.y}else e.rotation=r;return e}},t.siz=function(e,r,i,l){if(De("41.85"),!n(e))return e.type=="AC"&&j.zdf?(j.zdf.ac("siz",arguments),e):(n(l)&&(l=!1),!n(r)&&!n(i)?(e.widthOnly=r,e.heightOnly=i):n(r)?n(i)||(l?e.heightOnly=i:e.height=i):l?e.widthOnly=r:e.width=r,e)},t.ske=function(e,r,i){if(De("41.9"),!n(e))return e.type=="AC"&&j.zdf?(j.zdf.ac("ske",arguments),e):(n(r)||(e.skewX=r),n(i)||(e.skewY=i),e)},t.reg=function(e,r,i,l){if(De("41.95"),!n(e)){if(e.type=="AC"&&j.zdf)return j.zdf.ac("reg",arguments),e;var a=e.regX,s=e.regY,f=r,c=j.DIR||t.DIR||"ltr",w;if(r=="default"&&(r=null),typeof r=="string"&&(w=e.getBounds(),w?(r=="start"&&(r=c=="ltr"?"left":"right"),r=="end"&&(r=c=="ltr"?"right":"left"),r=="left"?r=w.x:r=="right"?r=w.x+w.width:(r=="center"||r=="middle")&&(r=w.x+w.width/2)):r=null),typeof i=="string"?(w||(w=e.getBounds()),w?i=="top"?i=w.y:i=="bottom"?i=w.y+w.height:(i=="center"||i=="middle")&&(i=w.y+w.height/2):i=null):n(i)&&(f=="center"||f=="middle")&&(w||(w=e.getBounds()),w?i=w.y+w.height/2:i=null),i=="default"&&(i=null),n(r)||(e.regX=r),n(i)||(e.regY=i),l&&e.parent){var T=e.localToLocal(a,s,e.parent);e.x-=T.x-e.x,e.y-=T.y-e.y}return e}},t.top=function(e){return De("41.62"),n(e)||!e.parent||e.parent.setChildIndex(e,e.parent.numChildren-1),e},t.bot=function(e){return De("41.63"),n(e)||!e.parent||e.parent.setChildIndex(e,0),e},t.ord=function(e,r){if(De("41.64"),!(n(e)||!e.parent))return n(r)&&(r=0),e.parent.setChildIndex(e,t.constrain(e.parent.getChildIndex(e)+r,0,e.parent.numChildren-1)),e},t.cur=function(e,r){if(De("41.1"),n(e))return tt("zim methods - cur(): please provide object"),e;n(r)&&(r="pointer");var i=j.zdf;return e.stage&&(i=e.stage.frame),i.cursors&&i.cursors[r]?(e.cursor="none",e._cursor=r,i.cursorList.add(e,r),e):(i.cursorList&&i.cursorList.add(e,!0),e.cursor=r,e)},t.sha=function(e,r,i,l,a){return De("41.2"),n(e)?(tt("zim methods - sha(): please provide object"),e):(n(r)&&(r="rgba(0,0,0,.3)"),r.blur?(e.shadow=r,e):(n(i)&&(i=e.width?e.width*.08:5),n(l)&&(l=e.height?e.height*.08:5),n(a)&&(a=e.width?e.width*.16:10),r==-1?e.shadow=null:e.shadow=new Ne.Shadow(r,i,l,a),e))},t.dep=function(e,r){if(De("41.65"),!n(e))return n(r)&&(r=0),e.depth=r,e},t.nam=function(e,r){if(De("41.67"),!(n(e)||n(r)))return e.name=r,t.zimObjectIDs[r]=e,e},t.movement=function(e,r,i){De("47.75");var l=e.stage||j.zdf.stage;function a(){l=e.stage,e.zimMovementStage=l,e.zimMovementEvent&&l.off("stagemousemove",e.zimMovementEvent),e.zimMovementEvent=l.on("stagemousemove",function(s){r(s)}),e.on("mouseout",function(){e.zimMovementEvent&&l.off("stagemousemove",e.zimMovementEvent)},null,!0)}return t.mobile()?(e.zimMovementEvent&&l.off("pressmove",e.zimMovementEvent),e.zimMovementEvent=e.on("pressmove",function(s){r(s)})):(e.zimMouseoverEvent&&e.off("mouseover",e.zimMouseoverEvent),e.zimMouseoverEvent=e.on("mouseover",a),i&&a()),e},t.noMovement=function(e){if(De("47.9"),!n(e))return e.zimMouseoverEvent&&e.off("mouseover",e.zimMouseoverEvent),e.zimMovementEvent&&e.zimMovementStage&&e.zimMovementStage.off("stagemousemove",e.zimMovementEvent),e},t.tap=function(e,r,i,l,a,s,f,c,w,T){var p="obj, call, distance, time, once, dbl, dblTime, call2, call3, call4",x;if(x=st(t.tap,arguments,p))return x;if(De("47.8"),!(n(e)||n(r)||typeof r!="function")){n(i)&&(i=s?10:5);var P=wt(l);n(l)&&(l=P=="s"?8:8e3),n(a)&&(a=!1),n(s)&&(s=!1),n(f)&&(T?f=P=="s"?.5:500:f=P=="s"?1:1e3),e.cur("pointer");var m=!1,v=!1,I;return s?e.zimDblClickDownEvent=e.on("mousedown",function(g){if(I=!1,m){m=!1;return}if(m=!0,g.currentTarget.type=="List"){if(g.target.type=="WindowBacking")return;var E=g.currentTarget.globalToLocal(g.stageX/t.scaX,g.stageY/t.scaY);if(E.y<=0)return}var A=g.stageX/t.scaX,y=g.stageY/t.scaY,C=Date.now(),L,Y;v=!0,e.zimDoubleTimeout&&clearTimeout(e.zimDoubleTimeout),e.zimDoubleTimeout=setTimeout(function(){if(v=!1,m=!1,e.zimDblClickUpEvent&&e.off("pressup",e.zimDblClickUpEvent),I&&T)if(Math.abs(A+y-L/t.scaX-Y/t.scaY)<i){if(e.excludeTap)return;T(g)}else c&&c(g)},P=="s"?f*1e3:f),e.zimDblClickUpEvent=e.on("pressup",function(_){if(L=_.stageX,Y=_.stageY,I=!0,m){w&&w(_);return}else if(!v)return;if(Math.abs(A+y-_.stageX/t.scaX-_.stageY/t.scaY)<i&&Date.now()-C<(P=="s"?l*1e3:l)){if(e.excludeTap)return;clearTimeout(e.zimDoubleTimeout),r(_)}else c&&c(_);_.remove()})},null,a):e.zimClickDownEvent=e.on("mousedown",function(g){if(g.currentTarget.type=="List"){if(g.target.type=="WindowBacking")return;var E=g.currentTarget.globalToLocal(g.stageX/t.scaX,g.stageY/t.scaY);if(E.y<=0)return}var A=g.stageX/t.scaX,y=g.stageY/t.scaY,C=Date.now();e.zimClickUpEvent=e.on("pressup",function(L){if(Math.abs(A+y-L.stageX/t.scaX-L.stageY/t.scaY)<i&&Date.now()-C<(P=="s"?l*1e3:l)){if(e.excludeTap)return;r(L)}else c&&c(L);L.remove()})},null,a),e}},t.noTap=function(e){if(De("47.9"),!n(e))return e.cursor&&e.cur("default"),e.zimClickDownEvent&&e.off("mousedown",e.zimClickDownEvent),e.zimClickUpEvent&&e.off("pressup",e.zimClickUpEvent),e.zimDoubleTimeout&&clearInterval(e.zimDoubleTimeout),e},t.hold=function(e,r,i,l,a){if(De("47.87"),!(n(e)||n(r)||typeof r!="function")){n(i)&&(i=5);var s=wt(l);n(l)&&(l=s=="s"?1.5:1500),n(a)&&(a=!1),e.cur("pointer");var f;return e.zimClickHoldDownEvent=e.on("mousedown",function(c){if(f||(f=c.target.stage),!!f){if(n(f.frame)&&(f.frame=j.zdf),(n(f.frame)||!f.frame.mousemoveEvent)&&(n(f.frame)&&(f.frame={}),f.frame.mouseX=c.stageX/t.scaX,f.frame.mouseY=c.stageY/t.scaY,f.frame.mouseholdEvent&&f.off("stagemousemove",f.frame.mouseholdEvent),f.frame.mouseholdEvent=f.on("stagemousemove",function(P){f.frame.mouseX=P.stageX/t.scaX,f.frame.mouseY=P.stageY/t.scaY})),c.currentTarget.type=="List"){if(c.target.type=="WindowBacking")return;var w=c.currentTarget.globalToLocal(c.stageX/t.scaX,c.stageY/t.scaY);if(w.y<=0)return}var T=c.stageX/t.scaX,p=c.stageY/t.scaY;clearInterval(e.zimHoldInterval);var x=0;e.zimHoldInterval=setInterval(function(){if(x<10)Math.abs(T+p-f.frame.mouseX-f.frame.mouseY)>i&&clearInterval(e.zimHoldInterval);else{if(Math.abs(T+p-f.frame.mouseX-f.frame.mouseY)<i){if(e.excludeHold)return;r(c)}clearInterval(e.zimHoldInterval)}x++},l/10*(s=="s"?1e3:1)),e.zimClickHoldUpEvent=e.on("pressup",function(){clearInterval(e.zimHoldInterval),f&&f.frame.mouseholdEvent&&f.off("stagemousemove",f.frame.mouseholdEvent)},null,!0)}},null,a),e}},t.noHold=function(e){if(De("47.88"),!n(e))return e.cursor&&e.cur("default"),e.off("mousedown",e.zimClickHoldDownEvent),e.off("pressup",e.zimClickHoldUpEvent),e.stage&&e.stage.frame.mouseEvent&&e.stage.off("stagemousemove",e.stage.frame.mouseEvent),clearInterval(e.zimHoldTimeout),e},t.change=function(e,r,i){if(De("47.85"),!(n(e)||n(r)||typeof r!="function"))return n(i)&&(i=!1),e.zimChangeEvent=e.on("change",function(l){r(l)},null,i),e},t.noChange=function(e){if(De("47.95"),!n(e))return e.off("mousedown",e.zimChangeEvent),e},t.drag=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L){var Y="obj, boundary, axis, overCursor, dragCursor, all, swipe, localBoundary, onTop, surround, slide, slideFactor, slideSnap, slideSnapDamp, reg, removeTweens, startBounds, rect, currentTarget, offStage, immediateBoundary, singleTouch",_;if(_=st(t.drag,arguments,Y))return _;if(De("31"),n(e)||!e.on)return;var k=t.DRAGALL;if(j.DRAGALL!=null&&(k=j.DRAGALL),n(s)&&n(A)&&(s=k),n(s)&&n(A)?A=!1:n(s)?n(A)&&(A=!1):A=s,(e.type=="Tag"||e.type=="TextArea"||e.type=="Loader")&&(A=!0),r&&r.getBounds&&(e.type=="Container"||e.type=="Tile")&&e.mouseChildren==!0&&!s){var $=Array.prototype.slice.call(arguments);return $[4]=!0,setTimeout(function(){e.loop(function(me){$[0]=me,t.drag.apply(null,$)})},C?0:50),e}(n(i)||i=="all"||i!="horizontal"&&i!="vertical")&&(i="both"),e.zimDown&&e.noDrag(),e.cur(n(l)?"pointer":l),n(f)&&(f=!1),n(c)&&(c=!1),n(w)&&(w=!0),n(T)&&(T=!1),n(p)&&(p=!1),n(x)&&(x=.9),n(P)&&(P=!0);var O=["horizontal","vertical","auto"];if(P!==!0&&O.indexOf(P)<0&&(P=!1),P=="auto"&&(P=!0),n(m)&&(m=.1),n(v)&&(v=!1),n(I)&&(I=!0),n(g)&&(g=!0),n(r)&&!n(E)&&(r=E),n(L)&&(L=!1),e.dragPaused=!1,p)var X,R,Q,K,q,ne,U,D,d,u,o,S,F,h,b,ye,B,N,re=j.M?20:10,le,G,z,se,Oe=!1,J=!1,pe=50;else e.zimDragTicker=function(){};e._draggable=!0,t.setSwipe(e,f),e.zimBoundary=r,e.zimlocalBoundary=c,e.circleBounds=r&&r.type=="Circle"?r.radius:!1,e.downCheck=!1;var Z=!1,de,V,fe,ke,oe;e.zimAdded=e.on("added",Ce,null,!0),e.zimRemoved=e.on("removed",Me,null,!0),e.parent&&Ce();function Ce(){if(e.off("added",e.zimAdded),r=e.zimBoundary,r&&r.getBounds&&r.type!="Blob"){if(e.zimlocalBoundary=!1,r.type!="Stage"&&r.type!="StageGL"?r=r.boundsToGlobal():r=new t.Boundary(0,0,r.width,r.height),!T){var me=e.boundsToGlobal();oe=e.localToGlobal(e.regX,e.regY);var ee=new t.Point(oe.x-me.x,oe.y-me.y),Ie=e.borderWidth?e.borderWidth:0;r.x+=ee.x+Ie/2,r.y+=ee.y+Ie/2,r.width-=me.width+Ie,r.height-=me.height+Ie}e.zimBoundary=r}de=0,V=0,e.zimBoundary&&e.zimBoundary.type!="Blob"&&(c?(fe=t.boundsToGlobal(e.parent,e.zimBoundary),T&&(ke=e.zimBoundary)):(fe=e.zimBoundary,T&&(ke=t.boundsToGlobal(e.parent,e.zimBoundary,!0)))),fe&&g&&(oe=e.parent.localToGlobal(e.x,e.y),ue(e,oe.x,oe.y)),p&&setTimeout(function(){p&&P&&(X=new t.Damp(null,m),R=new t.Damp(null,m)),e.zimDragImmediate=function(Re,_e){o=Re,S=_e,le=G=0,z=se=0,D=F=d=h=u=b=0,p&&P&&(n(Re)||X.immediate(Re),n(_e)||R.immediate(_e))},Q=3,K=0,q=[],ne=[],U=[],D=e.x,d=e.y,o=e.x,S=e.y,F=e.x,h=e.y,b=Date.now(),ye=-1e4,B=-1e4,e.zimDragMoving=!0,Le()},50),n(e.zimMaskDynamic)||e.zimMaskApply()}function Me(){e.zimDragTicker&&t.Ticker.remove(e.zimDragTicker)}var te,ae;e.pointers={};var we=!1;e.zimDown=e.on("mousedown",function(me){if(!(!e.stage||e.dragPaused)&&!(L&&we)){we=!0,ae=e.stage,e.zmu||(e.zmu=ae.frame.on("mouseupplus",function(Ze){e.downCheck&&(p||(e.downCheck=!1),Pe(Ze,!0))})),e.dragMouseX=Math.round(me.stageX/t.scaX)+ae.x,e.dragMouseY=Math.round(me.stageY/t.scaY)+ae.y;var ee="id"+Math.abs(me.pointerID+1);if(e.pointers[ee]=!0,te=A?me.currentTarget:me.target,e.zimBoundary&&!te.getBounds()){tt("zim.drag() - drag object needs bounds set");return}if(e.downCheck=!0,e.stage.mouseMoveOutside=!0,t.Ticker.has(e.zimDragTicker)||t.Ticker.add(e.zimDragTicker,e.stage),I&&e.zimTweens)for(var Ie in e.zimTweens){var Re=e.zimTweens[Ie];Re.zimObj&&(Re.zimObj.x!=null||Re.zimObj.y!=null)&&e.stopAnimate(Ie)}if(te.parent){if(w){var _e=te.parent.numChildren-1;te.parent.getChildAt(_e).type=="Keyboard"&&_e--,te.parent.setChildIndex(te,_e),te.ZIMoutlineShape&&te.outline()}te.parent==e.stage?oe=new t.Point(me.stageX/t.scaX,me.stageY/t.scaY):oe=te.parent.globalToLocal(me.stageX/t.scaX,me.stageY/t.scaY),v&&(te.x=oe.x,te.y=oe.y),de=oe.x-te.x,V=oe.y-te.y,fe=null,e.zimBoundary&&(c?(fe=t.boundsToGlobal(te.parent,e.zimBoundary),T&&(ke=e.zimBoundary)):(fe=e.zimBoundary,T&&(ke=t.boundsToGlobal(te.parent,e.zimBoundary,!0)))),e.cur(n(a)?"pointer":a),p&&(e.slideStartX=e.x,e.slideStartY=e.y,N=e.zimDragMoving,K=0,q=[oe.x],ne=[oe.y],U=[Date.now()],ye=-1e4,B=-1e4,e.zimDragMoving=!0),e.type=="Pen"&&(e.zimDragCheck=!0,Z=!1)}}},!0),e.zimMove=e.on("pressmove",function(me){if(!(L&&!e.pointers["id"+Math.abs(me.pointerID+1)])&&!(!e.downCheck||e.dragPaused)){var ee=(y?me.rawX:me.stageX)/t.scaX+ae.x,Ie=(y?me.rawY:me.stageY)/t.scaY+ae.y;e.dragMouseX=Math.round(ee),e.dragMouseY=Math.round(Ie),ue(te,ee,Ie),te.ZIMoutlineShape&&te.outline(),e.type=="Pen"&&!Z&&e.drawing?Z=!0:(e.type=="Tag"||e.type=="TextArea"||e.type=="Loader")&&e.resize()}},!0);function ue(me,ee,Ie){if(n(me)&&(me=te||e),!!me.parent){if(n(ee)||n(Ie)){var Re=me.parent.localToGlobal(me.x,me.y);de=V=0,e.zimBoundary&&(c?(fe=t.boundsToGlobal(me.parent,e.zimBoundary),T&&(ke=me.zimBoundary)):(fe=e.zimBoundary,T&&(ke=t.boundsToGlobal(me.parent,e.zimBoundary,!0)))),ee=Re.x,Ie=Re.y,p&&(o=me.x,S=me.y,te=me)}var _e;ae&&ae.type?_e=me.parent.globalToLocal(ee,Ie):_e=me.parent.globalToLocal(ee*t.scaX,Ie*t.scaY);var Ze=i=="both"||i=="horizontal",at=i=="both"||i=="vertical",Be;p&&P?P=="vertical"?(Be=ie(me,_e.x-de,_e.y-V),Ze&&(me.x=Be.x),at&&(me.y=_e.y-V)):P=="horizontal"?(Be=ie(me,_e.x-de,_e.y-V),Ze&&(me.x=_e.x-de),at&&(me.y=Be.y)):(Ze&&(me.x=_e.x-de),at&&(me.y=_e.y-V)):(Be=ie(me,_e.x-de,_e.y-V),Ze&&(me.x=Be.x),at&&(me.y=Be.y)),p&&!N&&(me.slideStartX!=me.x||me.slideStartY!=me.y)&&(N=!0)}}e.zimPosition=ue,e.zimUp=e.on("pressup",function(me){Pe(me)},!0);function Pe(me,ee){if(!(L&&!ee&&!e.pointers["id"+Math.abs(me.pointerID+1)])){we=!1;var Ie="id"+Math.abs((n(me.pointerID)?0:me.pointerID)+1);if(delete e.pointers[Ie],!(!e.downCheck||e.dragPaused)){if(e.cur(n(l)?"pointer":l),p){if(te.dispatchEvent("slidestart"),te.parent){var Re=y?me.rawX:me.stageX,_e=y?me.rawY:me.stageY;oe=te.parent.globalToLocal(Re/t.scaX,_e/t.scaY)}else oe=new t.Point(0,0);D=oe.x,d=oe.y,u=Date.now(),isNaN(D)&&(D=-1e3),isNaN(d)&&(d=-1e3),z=D-F,se=d-h;var Ze=u-b;le=t.constrain(z*re/Ze,-pe,pe),G=t.constrain(se*re/Ze,-pe,pe),Oe=!1,J=!1,e.downCheck=!1,o=te.x,S=te.y,ee&&(F=D=0,h=d=0,b=u=0)}else{e.downCheck=!1;var at=0;for(var Be in e.pointers)at++;at==0&&t.Ticker.remove(e.zimDragTicker),e.type=="Pen"&&(e.zimDragCheck=!1,Z&&e.drawing&&e.stopCheck())}e.stage&&e.stage.update()}}}function ie(me,ee,Ie){if(!me.parent)return{x:ee,y:Ie};if(fe)if(T){var Re=me.getBounds().width,_e=me.getBounds().height,Ze=me.getBounds().x,at=me.getBounds().y;Re<ke.width?ee=ke.x+(ke.width-Re)/2+(me.regX-Ze):(ee-(me.regX-Ze)>ke.x&&(ee=ke.x+(me.regX-Ze)),ee-(me.regX-Ze)+Re<ke.x+ke.width&&(ee=ke.x+ke.width+(me.regX-Ze)-Re)),me.height<ke.height?Ie=ke.y+(ke.height-_e)/2+(me.regY-at):(Ie-(me.regY-at)>ke.y&&(Ie=ke.y+(me.regY-at)),Ie-(me.regY-at)+_e<ke.y+ke.height&&(Ie=ke.y+ke.height+(me.regY-at)-_e))}else{if(fe.type=="Blob")return fe.shape.hitTestPoint(ee,Ie)?{x:ee,y:Ie}:{x:e.x,y:e.y};if(oe=me.parent.localToGlobal(ee,Ie),e.circleBounds){var Be=fe.x+fe.width/2,He=fe.y+fe.height/2,et=e.circleBounds;if(t.dist(Be,He,oe.x,oe.y)<=et)ee=oe.x,Ie=oe.y;else{var ge=t.angle(Be,He,oe.x,oe.y)*RAD;ee=Be+et*Math.cos(ge),Ie=He+et*Math.sin(ge)}}else ee=Math.max(fe.x,Math.min(fe.x+fe.width,oe.x)),Ie=Math.max(fe.y,Math.min(fe.y+fe.height,oe.y));oe=me.parent.globalToLocal(ee,Ie),ee=oe.x,Ie=oe.y}return{x:ee,y:Ie}}function be(me,ee,Ie,Re,_e){Math.abs(me.x-ye)<.1&&Math.abs(me.y-B)<.1?(e.zimDragMoving=!1,me.x=Re,me.y=_e,me.slideStartX=null,me.slideStartY=null,N&&(me.dispatchEvent("slidestop"),t.Ticker.remove(e.zimDragTicker)),e.type=="Pen"&&(e.zimDragCheck=!1,Z&&e.drawing&&e.stopCheck())):(ye=ee,B=Ie)}function Le(){e.zimDragTicker=function(){if(!n(e.slideStartX))if(te||(te=e),e.downCheck){var me;te.parent?me=te.parent.globalToLocal(e.dragMouseX,e.dragMouseY):me=new t.Point(0,0),K++,q.push(me.x),ne.push(me.y),U.push(Date.now()),K>=Q?(F=q.shift(),h=ne.shift(),b=U.shift()):(F=q[0],h=ne[0],b=U[0])}else{if(!e.zimDragMoving)return;z=le,se=G;var ee,Ie;i==BOTH?(ee=te.x+z,Ie=te.y+se):i==HORIZONTAL?(ee=te.x+z,Ie=te.y):i==VERTICAL&&(ee=te.x,Ie=te.y+se),le=z*x,G=se*x;var Re;fe&&(Re=ie(te,ee,Ie),(P===!0||P=="horizontal")&&(Math.round(ee)!=Math.round(Re.x)&&(Oe||(X.immediate(ee),Oe=!0),le=0,ee=X.convert(Re.x)),P=="horizontal"&&(Ie=Re.y)),(P===!0||P=="vertical")&&(Math.round(Ie)!=Math.round(Re.y)&&(J||(J=!0,R.immediate(Ie),G=0),Ie=R.convert(Re.y)),P=="vertical"&&(ee=Re.x)),P||(ee=Re.x,Ie=Re.y)),te.x=ee,te.y=Ie,be(te,te.x,te.y,ee,Ie)}}}return e},t.noDrag=function(e,r){if(De("32"),n(e)||!e.on)return;if(n(r)&&(r=!0),r&&e.numChildren&&e.numChildren>1)for(var i=0;i<e.numChildren;i++){var l=e.getChildAt(i);a(l)}a(e);function a(s){s.cur&&s.cur("default"),s._draggable=!1,t.setSwipe(s,!0),s.off("added",s.zimAdded),s.off("removed",s.zimRemoved),s.off("mousedown",s.zimDown),s.off("pressmove",s.zimMove),s.off("pressup",s.zimUp),s.zmu&&(s.stage?s.stage.frame.off("mouseupplus",s.zmu):j.zdf.off("mouseupplus",s.zmu)),t.Ticker&&(s.zimDragSlide&&t.Ticker.remove(s.zimDragSlide),s.zimDragTicker&&t.Ticker.remove(s.zimDragTicker)),s.zimDragMoving=s.zimAdded=s.zimRemoved=s.zimDown=s.zimMove=s.zimUp=s.zimBoundary=s.zimDragSlide=null,s.slideStartX=s.slideStartY=s.zimDragImmediate=null,s.dragMouseX=s.zimPosition=s.dragMouseY=s.zimDown=s.zimUp=null,s.zimDragTicker=s.zimDragSlide=null}return e},t.dragBoundary=function(e,r){if(De("33"),!(n(e)||!e.on))return e.zimBoundary=r,e.zimDragMoving=!0,e.zimPosition&&e.zimPosition(),e},t.dragRect=t.dragBoundary,t.mouse=function(e){return De("33.1"),e.zimLastMouse&&(e.mouseChildren=e.zimLastMouse),e.mouseEnabled=!0,e.zimLastMouseEnabled=!0,e},t.noMouse=function(e){return De("33.15"),e.zimLastMouse=e.mouseChildren,e.mouseChildren=!1,e.mouseEnabled=!1,e.zimLastMouseEnabled=!1,e},t.wire=function(e,r,i,l,a,s,f,c){var w="source, target, prop, twoWay, setSource, filter, call, input",T;if(T=st(t.wire,arguments,w))return T;if(De("33.2"),n(t.Ticker)&&dt)return tt("wire() - requires ZIM Frame"),e;if(n(r)&&dt)return tt("wire() - requires a target"),e;var p=t.DEFAULTWIRE;return j.DEFAULTWIRE!=null&&(p=j.DEFAULTWIRE),n(c)&&(p&&p!="currentValue"&&p!="selectedIndex"||p&&Object.prototype.hasOwnProperty.call(e,p)?c=p:Object.prototype.hasOwnProperty.call(e,"currentValue")?c="currentValue":Object.prototype.hasOwnProperty.call(e,"selectedIndex")?c="selectedIndex":c=i),n(i)&&(i=c),e.addChild&&(e.zimWire=!0),r.addChild&&(r.zimWired=!0),t.Ticker.addWire(e,[r,i,l,a,s,f,c]),e},t.noWire=function(e,r,i,l){var a="source, target, prop, input",s;return(s=st(t.noWire,arguments,a))?s:(De("33.25"),n(t.Ticker)&&dt?(tt("noWire() - requires ZIM Frame"),e):(t.Ticker.removeWire(e,r,i,l),e))},t.wired=function(e,r,i,l,a,s,f,c){var w="target, source, prop, twoWay, setSource, filter, call, input",T;return(T=st(t.wired,arguments,w))?T:(De("33.3"),n(t.Ticker)&&dt?(tt("wired() - requires ZIM Frame"),e):(t.wire(r,e,i,l,a,s,f,c),e))},t.noWired=function(e,r,i,l){var a="target, source, prop, input",s;return(s=st(t.noWire,arguments,a))?s:(De("33.35"),n(t.Ticker)&&dt?(tt("noWired() - requires ZIM Frame"),e):(t.Ticker.removeWire(r,e,i,l),e))},typeof Ct>"u")var Ct;if(t.bind=function(e,r,i,l,a,s){var f="obj, id, props, extra, filter, bindObj",c;if(c=st(t.bind,arguments,f))return c;if(De("33.17"),!Ct)return dt&&tt("bind() - needs a Bind() object created first"),e;if(n(r))return dt&&tt("bind() - needs a unique id"),e;var w=s||Ct;return w.add(r,e,i,l,a),e},t.noBind=function(e,r,i,l,a){var s="obj, props, removeConnectionData, call, bindObj",f;if(f=st(t.noBind,arguments,s))return f;if(De("33.18"),!Ct)return e;var c=a||Ct;return c.remove(e,r,i,l),e},t.transform=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O,X,R,Q){var K="obj, move, stretchX, stretchY, scale, rotate, allowToggle, visible, onTop, showStretch, showRotate, showScale, showReg, showBorder, borderColor, borderWidth, dashed, customCursors, handleSize, regSize, snapDistance, snapRotation, cache, events, ghostColor, ghostWidth, ghostDashed, ghostHidden, frame, container",q;if(q=st(t.transform,arguments,K))return q;if(e.type=="AC"&&j.zdf)return j.zdf.ac("transform",arguments),e;if(De("33.5"),n(e)||!e.getBounds)return tt("zim methods - transform(): please provide object with bounds set"),e;if(!e.getBounds())return tt("zim methods - transform(): please setBounds() on object"),e;if(!e.parent)return tt("zim methods - transform(): object should be on stage first"),e;n(r)&&(r=!0),n(i)&&(i=!0),n(l)&&(l=!0),e.width==0&&(i=!1),e.height==0&&(l=!1),n(a)&&(a=!0),n(s)&&(s=!0),n(f)&&(f=!0),n(c)&&(c=!0),n(w)&&(w=!0),n(T)&&(T=!!ne),n(p)&&(p=!!ne),n(x)&&(x=!0),n(P)&&(P=!0),n(m)&&(m=!0),n(v)&&(v="brown"),n(I)&&(I=1),n(k)&&(k=null),n($)&&($=null),k<0||$<0?k=$=null:k!=null&&$==null&&($=1),n(O)&&(O=!0),n(X)&&(X=!1),n(R)&&(R=j.zdf);var ne=j.M;n(E)&&(E=!ne),n(A)&&(A=ne?20:10),n(y)&&(y=16),n(C)&&(C=10),n(L)&&(L=5),n(Y)&&(Y=!0),n(_)&&(_=!1),(e.type=="Tag"||e.type=="TextArea"||e.type=="Loader")&&(_=!0),e.mouseChildren=!1;var U=e.getConcatenatedMatrix().decompose(),D=e.stage?e.stage:R.stage;n(Q)&&(Q=D),n(R.eventRemove)&&(D.enableMouseOver(),R.ctrlKey=!1,R.shiftKey=!1,j.addEventListener("keydown",function(je){R.altKey=je.altKey,R.ctrlKey=je.ctrlKey}),j.addEventListener("keyup",function(je){R.altKey=je.altKey,R.ctrlKey=je.ctrlKey}));var d=e.getBounds(),u=new t.Shape({style:!1}),o=new t.Shape({style:!1}),S=new t.Shape({style:!1});o.mouseEnabled=!1,S.controlType="reg";var F=e.parent,h=u.graphics,b=o.graphics,ye=S.graphics,B,N,re,le,G,z,se,Oe,J,pe=new t.Container({style:!1});pe.type="TransformControls";var Z=new t.Container({style:!1}),de=new t.Container({style:!1}),V=new t.Container({style:!1}),fe=new t.Container({style:!1}),ke,oe,Ce,Me,te;n(e.zimMaskDynamic)||e.zimMaskApply();function ae(je,ht){je==ht&&new t.Triangle(16,12,12,"white",null,null,0).addTo(je).mov(0,-13.5),new t.Triangle(16,12,12,"white",null,null,0).addTo(je).mov(13.5).rot(90),je==ht&&new t.Triangle(16,12,12,"white",null,null,0).addTo(je).mov(0,13.5).rot(180),new t.Triangle(16,12,12,"white",null,null,0).addTo(je).mov(-13.5).rot(-90),je==ht&&new t.Triangle(10,7,7,"black",null,null,0).addTo(je).mov(0,-13),new t.Triangle(10,7,7,"black",null,null,0).addTo(je).mov(13).rot(90),je==ht&&new t.Triangle(10,7,7,"black",null,null,0).addTo(je).mov(0,13).rot(180),new t.Triangle(10,7,7,"black",null,null,0).addTo(je).mov(-13).rot(-90),Y&&je.cache(-20,-20,40,40)}if(E){var we=new t.Container({style:!1}),ue=new t.Container({style:!1});ae(we,we),ae(ue,we);var Pe={"nw-resize":45,"ne-resize":-45,"n-resize":90,"e-resize":0}}function ie(){var je=e;for(ke=0,oe=1,Ce=1,Me=0,te=0;je.parent;)ke+=je.rotation,oe*=je.scaleX,Ce*=je.scaleY,Me+=je.skewX,te+=je.skewY,je=je.parent}ie();var be=ke,Le=["nw-resize","ne-resize","nw-resize","ne-resize"],me=[2,3,0,1],ee,Ie;for(Ie=0;Ie<4;Ie++)x?(ee=new t.Rectangle(A,A,t.pink,t.grey,2,null,null,null,null,!1),ee.centerReg(Z),Y&&ee.cache(-1,-1,A+2,A+2)):(ee=new t.Rectangle(A,A,"rgba(0,0,0,0)","rgba(0,0,0,0)",2,null,null,null,null,!1),ee.centerReg(Z),ee.expand(0)),ee.rotation=ke,se=E?"none":Le[Ie],ee.drag({overCursor:se,dragCursor:se,onTop:!1}),ee.controlType="corner",ee.cu=Le[Ie];for(Ie=0;Ie<me.length;Ie++)Z.getChildAt(Ie).op=Z.getChildAt(me[Ie]);var Re=["n-resize","e-resize","n-resize","e-resize"];for(me=[1,1,0,0],Ie=0;Ie<4;Ie++){var _e=Ie%2==0?e.width/2:A,Ze=Ie%2==0?A:e.height/2;T?(ee=new t.Rectangle(A,A,t.fog,t.dark,2,null,null,null,null,!1),ee.centerReg(Ie%2==0?V:de),Y&&ee.cache(-1,-1,A+2,A+2)):(ee=new t.Rectangle(_e,Ze,"rgba(0,0,0,0)",null,null,null,null,null,null,!1),ee.centerReg(Ie%2==0?V:de),ee.expand(0)),ee.rotation=ke,se=E?"none":Re[Ie],ee.drag({overCursor:se,dragCursor:se,onTop:!1}),ee.controlType="side",ee.cu=Re[Ie]}for(Ie=0;Ie<me.length;Ie++){var at=Ie%2==0?V:de;at.getChildAt(Math.floor(Ie/2)).op=at.getChildAt(me[Ie])}var Be=["ne-resize","nw-resize","ne-resize","nw-resize"];for(Ie=0;Ie<4;Ie++)p?(ee=new t.Circle(A,t.pink,null,null,null,null,null,null,!1),ee.addTo(fe),Y&&ee.cache(-A,-A,A*2,A*2)):(ee=new t.Circle(A,"rgba(0,0,0,0)",null,null,null,null,null,null,!1),ee.addTo(fe),ee.expand(0)),se=E?"none":Be[Ie],ee.drag({overCursor:se,dragCursor:se,onTop:!1}),ee.controlType="rotate",ee.cu=Be[Ie];var He=1.8;fe.alpha=.5,et();function et(){var je=A*He*t.sign(oe),ht=A*He*t.sign(Ce);fe.getChildAt(0).reg(je,ht),fe.getChildAt(1).reg(-je,ht),fe.getChildAt(2).reg(-je,-ht),fe.getChildAt(3).reg(je,-ht),D.update()}function ge(){h.c(),b.c(),ye.c(),B=e.localToLocal(d.x,d.y,Q),N=e.localToLocal(d.x+d.width,d.y,Q),re=e.localToLocal(d.x+d.width,d.y+d.height,Q),le=e.localToLocal(d.x,d.y+d.height,Q);var je=e.localToLocal(d.x+d.width/2,d.y,Q),ht=e.localToLocal(d.x+d.width,d.y+d.height/2,Q),Gt=e.localToLocal(d.x+d.width/2,d.y+d.height,Q),Kt=e.localToLocal(d.x,d.y+d.height/2,Q);G=e.localToLocal(e.regX,e.regY,Q),z=e.localToLocal(d.x+d.width/2,d.y+d.height/2,Q),J=[B,N,re,le],Oe=[je,ht,Gt,Kt],m&&(h.s(v),g&&h.sd([10,5],0),h.ss(I).mt(B.x,B.y).lt(N.x,N.y).lt(re.x,re.y).lt(le.x,le.y).lt(B.x,B.y).cp()),n(k)||(b.s(k),O&&b.sd([10,5],0),b.ss($).mt(B.x,B.y).lt(N.x,N.y).lt(re.x,re.y).lt(le.x,le.y).lt(B.x,B.y).cp()),u.setBounds(B.x,B.y,N.x-B.x,le.y-B.y),P&&(ye.s("#eee").ss(I).f("rgba(0,0,0,.1)").dc(0,0,y),ye.s("#222").ss(I).dc(0,0,y*.3)),ie();for(var $t=Math.min(50,Math.abs(Me))*t.sign(Me),Ut=Math.min(50,Math.abs(te))*t.sign(te),Tt=ke*t.sign(oe*Ce)*t.sign(e.scaleX*e.scaleY),Bt=0;Bt<J.length;Bt++){var gn=J[Bt];Z.getChildAt(Bt).loc(gn.x,gn.y).ske($t,Ut).rot(Tt),fe.getChildAt(Bt).loc(gn.x,gn.y).rot(Tt);var hn=Oe[Bt],en=Bt%2==0?V:de;en.getChildAt(Math.floor(Bt/2)).loc(hn.x,hn.y).ske($t,Ut).rot(Tt),T||en.getChildAt(Math.floor(Bt/2)).sca(Bt%2==0?oe/2:1,Bt%2==0?1:Ce/2)}S.x=G.x,S.y=G.y}ge();var xe=new t.Shape(1e3,1e3,null,null,null,!1);function he(){xe.x=0,xe.y=0,xe.graphics.c().f("rgba(0,0,0,.01)").mt(B.x,B.y).lt(N.x,N.y).lt(re.x,re.y).lt(le.x,le.y).lt(B.x,B.y).cp(),xe.reg(G.x,G.y),xe.x=G.x,xe.y=G.y}he(),pe.on("dblclick",function(je){R.ctrlKey&&e.transformControls.visible&&(e.scaleX=1,e.scaleY=1,e.rotation=0,ge(),he(),D.update()),Et(je,!0)});var Ge=pe.on("mousedown",Fe),qe=e.on("mousedown",Fe);function Fe(je){var ht=D.getObjectUnderPoint(je.stageX,je.stageY,1);ne||ht&&(e.contains&&e.contains(ht)||!e.contains&&e==ht)?e.transformControls.visible||(E?(Lt=!1,xe.mouseEnabled=!1):R.canvas.style.cursor="move",e.transformControls.show(),e.dispatchEvent("transformshow")):e.transformControls.visible&&(!ht||!pe.contains(ht))&&(e.transformControls.hide(),e.dispatchEvent("transformhide"))}var We=D.on("stagemousedown",function(je){var ht=D.getObjectUnderPoint(je.stageX,je.stageY,1),Gt=ht&&ht.parent&&ht.parent.layer&&ht.parent.layer==e;e.transformControls.visible&&(!ht||!pe.contains(ht)&&!Gt)&&(e.dispatchEvent("transformhide"),e.transformControls.hide())});f||(pe.off("mousedown",Ge),e.off("mousedown",qe),D.off("stagemousedown",We));var ce,Ve,Se,Ae,Ye,Xe,Ue,rt,Te,$e,lt,Qe,ot,ft=!1,ut=!1,ze,kt,Mt=e.cursor,xt,Yt=new t.Circle(30,"rgba(0,0,0,0)",null,null,null,null,null,null,!1).expand(20);if(E){Yt.mouseEnabled=!1,Yt.mouseChildren=!1,Yt.addChild(ue),Z.on("mouseover",Je),Z.on("mouseout",gt),de.on("mouseover",Je),de.on("mouseout",gt),V.on("mouseover",Je),V.on("mouseout",gt),fe.on("mouseover",Je),fe.on("mouseout",gt);var Dt=new t.Circle(30,"rgba(0,0,0,0)",null,null,null,null,null,null,!1).expand(20);Dt.cursor="none"}Z.on("mousedown",Ht),Z.on("pressmove",nn),Z.on("pressup",Et),de.on("mousedown",Ht),de.on("pressmove",nn),de.on("pressup",Et),V.on("mousedown",Ht),V.on("pressmove",nn),V.on("pressup",Et),fe.on("mousedown",Ht),fe.on("pressmove",jt),fe.on("pressup",Et);function Ht(je){ut=!0,w&&Ot(),ze&&D.off("stagemousemove",ze),ce=je.target.x,Ve=je.target.y,$e=e.x,lt=e.y,Se=e.scaleX,Ae=e.scaleY;var ht=Q.globalToLocal(je.stageX/t.scaX,je.stageY/t.scaY);if(je.target.controlType=="rotate"){ft=!0,Ye=e.rotation;var Gt=ht.x,Kt=ht.y,$t=F.localToLocal($e,lt,Q);Qe=$t.x,ot=$t.y,Xe=Math.atan2(Kt-ot,Gt-Qe)*180/Math.PI}R.ctrlKey||je.target.controlType=="rotate"?(Ue=Math.abs(ce-e.x),rt=Math.abs(Ve-e.y)):(Ue=Math.abs(ce-je.target.op.x),rt=Math.abs(Ve-je.target.op.y)),je.target.controlType!="rotate"&&(Te=je.target.op.parent.localToLocal(je.target.op.x,je.target.op.y,e.parent)),Yt.stage?Q.setChildIndex(Yt,Q.getChildIndex(pe)):Yt.addTo(Q,Q.getChildIndex(pe)+1),Yt.x=ht.x,Yt.y=ht.y,Yt.cursor=E?"none":je.target.cu,E&&(e.getConcatenatedMatrix().decompose(U),U.rotation||(U.rotation=0),ue.rotation=U.rotation*t.sign(oe*Ce)*t.sign(e.scaleX*e.scaleY)+Pe[je.target.cu]+be,je.target.controlType!="side"&&oe*Ce<0&&(ue.rotation+=90),Dt.addTo(Q,1).pos({x:ht.x,y:ht.y,reg:!0})),xe.visible=!1,e.cursor="none"}function nn(je){var ht=1;R.ctrlKey&&je.target.controlType=="corner"?ht=Ue>rt?(je.target.x-$e)/(ce-$e):(je.target.y-lt)/(Ve-lt):Ue>rt?ce-je.target.op.x&&(ht=(je.target.x-je.target.op.x)/(ce-je.target.op.x)):Ve-je.target.op.y&&(ht=(je.target.y-je.target.op.y)/(Ve-je.target.op.y)),je.target.controlType=="corner"?(e.scaleX=ht*Se,e.scaleY=ht*Ae):(e.scaleX=je.target.cu=="e-resize"?ht*Se:Se,e.scaleY=je.target.cu=="n-resize"?ht*Ae:Ae),ge();var Gt=Q.globalToLocal(je.stageX/t.scaX,je.stageY/t.scaY);if(Yt.x=Gt.x,Yt.y=Gt.y,E&&(Dt.x=Gt.x,Dt.y=Gt.y),!R.ctrlKey||je.target.controlType=="side"){var Kt=je.target.op.parent.localToLocal(je.target.op.x,je.target.op.y,e.parent);e.x-=(Kt.x-Te.x)*t.sign(oe)*t.sign(e.scaleX),e.y-=(Kt.y-Te.y)*t.sign(Ce)*t.sign(e.scaleY)}if(ge(),e.transformControls.events){var $t=je.target.controlType;Qt(je,$t)}}function jt(je){var ht=Q.globalToLocal(je.stageX/t.scaX,je.stageY/t.scaY),Gt=Math.atan2(ht.y-ot,ht.x-Qe)*180/Math.PI;if(R.shiftKey?e.rot(Math.round((Ye+(Gt-Xe)*t.sign(oe)*t.sign(e.scaleX))/45)*45):e.rot(Ye+(Gt-Xe)*t.sign(oe)*t.sign(e.scaleX)),ge(),Yt.x=ht.x,Yt.y=ht.y,E&&(e.getConcatenatedMatrix().decompose(U),U.rotation||(U.rotation=0),ue.rotation=U.rotation*t.sign(oe*Ce)*t.sign(e.scaleX*e.scaleY)+Pe[je.target.cu]+be,je.target.controlType!="side"&&oe*Ce<0&&(ue.rotation+=90),Dt.x=ht.x,Dt.y=ht.y),ge(),e.transformControls.events){var Kt=je.target.controlType;Qt(je,Kt,null,!1)}}function Et(je,ht){et();var Gt=je?je.target.controlType:"move";ht&&(Gt="reset"),E&&Dt.removeFrom(),Qt(je,Gt,!0),D.update()}function Qt(je,ht,Gt,Kt){Kt==null&&(Kt=!0);var $t=!1;xt=null;var Ut=Q.globalToLocal(je.stageX/t.scaX,je.stageY/t.scaY);ht=="move"?((e.x!=an.x||e.y!=an.y)&&(xt=new Ne.Event("transformed"),xt.transformType="move"),Kt&&($t=xe.hitTestPoint(Ut.x,Ut.y))):ht=="corner"?((e.scaleX!=an.scaleX||e.scaleY!=an.scaleY)&&(xt=new Ne.Event("transformed"),xt.transformType="size"),Kt&&($t=Z.hitTestPoint(Ut.x,Ut.y))):ht=="side"?((e.scaleX!=an.scaleX||e.scaleY!=an.scaleY)&&(xt=new Ne.Event("transformed"),xt.transformType="stretch"),Kt&&($t=de.hitTestPoint(Ut.x,Ut.y)||V.hitTestPoint(Ut.x,Ut.y))):ht=="rotate"?(e.rotation!=an.rotation&&(xt=new Ne.Event("transformed"),xt.transformType="rotate"),Kt&&($t=fe.hitTestPoint(Ut.x,Ut.y))):ht=="reg"?(e.regX!=an.regX||e.regY!=an.regY)&&(xt=new Ne.Event("transformed"),xt.transformType="reg"):ht=="reset"?(xt=new Ne.Event("transformed"),xt.transformType="reset"):(xt=new Ne.Event("transformed"),xt.transformType="unknown"),Kt&&!$t&&(Yt.removeFrom(),R.canvas.style.cursor="default",e.cursor=Mt),xt&&(xt.pressup=Gt,(e.type=="Tag"||e.type=="TextArea"||e.type=="Loader")&&e.resize(),e.dispatchEvent(xt))}function Je(je){if(!ut){Yt.stage?Q.setChildIndex(Yt,Q.getChildIndex(pe)):Yt.addTo(Q,Q.getChildIndex(pe)+1),Dt.addTo(Q,1);var ht=Q.globalToLocal(je.stageX/t.scaX,je.stageY/t.scaY);Yt.x=ht.x,Yt.y=ht.y,Dt.x=ht.x,Dt.y=ht.y,e.getConcatenatedMatrix().decompose(U),U.rotation||(U.rotation=0),ue.rotation=U.rotation*t.sign(oe*Ce)*t.sign(e.scaleX*e.scaleY)+Pe[je.target.cu]+be,je.target.controlType!="side"&&oe*Ce<0&&(ue.rotation+=90),D.update(),ze&&D.off("stagemousemove",ze),ze=D.on("stagemousemove",function(Gt){var Kt=Q.globalToLocal(Gt.stageX/t.scaX,Gt.stageY/t.scaY);Yt.x=Kt.x,Yt.y=Kt.y,D.update()})}}function gt(){D.off("stagemousemove",ze),!ut&&(e.cursor=Mt,Yt.removeFrom(),Dt.removeFrom(),D.update())}function Ot(){if(w){var je=F.numChildren-1;F.getChildAt(je).type=="Keyboard"&&je--,F.setChildIndex(e,je),mt()}}function mt(){if(F==Q)pe.removeFrom(),Q.addChildAt(pe,Q.getChildIndex(e)+1);else{for(var je=F;je.parent&&je.parent!=Q;)je=je.parent;e.stage&&(pe.parent==Q&&Q.removeChild(pe),Q.addChildAt(pe,Q.getChildIndex(je)+1))}}var _t,vt;S.drag(),S.on("mousedown",Ot),S.on("pressup",function(je){if(!R.ctrlKey){for(var ht=0;ht<J.length;ht++)if(t.dist(S.x,S.y,J[ht].x,J[ht].y)<C){S.x=J[ht].x,S.y=J[ht].y;break}t.dist(S.x,S.y,z.x,z.y)<C&&(S.x=z.x,S.y=z.y)}var Gt=e.rotation;_t=Q.localToLocal(S.x,S.y,e),F==D?vt=new t.Point(S.x,S.y):vt=Q.localToLocal(S.x,S.y,F),e.reg(_t.x,_t.y),e.rotation=0,e.x=e.x+vt.x-e.x,e.y=e.y+vt.y-e.y,e.rotation=Gt,ge(),he(),Et(je),D.update()});var Lt=!0;se=E?"none":"move",xe.drag({overCursor:se,dragCursor:se,onTop:!1}),xe.controlType="move",E&&(xe.on("mouseover",Jt),xe.on("mouseout",Vt));function Vt(){D.off("stagemousemove",kt),!ut&&(we.removeFrom(pe),D.update())}function Jt(je){if(!(ut||!E||!Lt)){var ht=Q.globalToLocal(je.stageX/t.scaX,je.stageY/t.scaY);we.addTo(pe).pos({x:ht.x,y:ht.y,reg:!0}),D.update(),kt&&D.off("stagemousemove",kt),kt=D.on("stagemousemove",function(Gt){var Kt=Q.globalToLocal(Gt.stageX/t.scaX,Gt.stageY/t.scaY);we.x=Kt.x,we.y=Kt.y,D.update()})}}xe.on("mousedown",Ot),xe.on("pressmove",function(je){if(e.transformControls.visible){var ht;if(F==D?ht=new t.Point(xe.x,xe.y):ht=Q.localToLocal(xe.x,xe.y,F),e.x=ht.x,e.y=ht.y,ge(),e.transformControls.events){var Gt="move";Qt(je,Gt)}}}),xe.on("pressup",function(je){e.transformControls.visible&&Et(je)});var tn=D.on("stagemouseup",function(){ut=!1,xe.mouseEnabled=!0,Lt||(xt=new Ne.Event("transformed"),e.x!=an.x||e.y!=an.y?xt.transformType="move":xt.transformType="select",xt.pressup=!0,e.dispatchEvent(xt)),Lt=!0,xe.visible=!0,ft&&!R.ctrlKey&&L>1&&(e.rotation=Math.round(e.rotation/L)*L,ge()),he(),xe.mouseEnabled=!0,ft=!1,D.update()});function Zt(){an={x:e.x,y:e.y,rotation:e.rotation,regX:e.regX,regY:e.regY,scaleX:e.scaleX,scaleY:e.scaleY}}var an;Zt();var zt=e.on("mousedown",Zt);pe.on("mousedown",Zt),pe.addChild(u),r&&pe.addChild(xe),a&&pe.addChild(Z),i&&pe.addChild(de),l&&pe.addChild(V),s&&pe.addChild(fe),pe.addChild(S);var yn;r&&(e.drag({overCursor:"pointer",dragCursor:"pointer",onTop:!1,removeTweens:!1}),yn=e.on("pressmove",function(je){if(ge(),he(),et(),e.transformControls.events){var ht="move";Qt(je,ht)}}));var yt=f;return e.transformControls={visible:c,events:_,ghost:!n(k),ghostEnabled:!n(k),show:function(){return w&&Ot(),mt(),e.toggled=!0,e.transformControls.visible=!0,o.parent&&o.removeFrom(),D.update(),e},hide:function(){if(e.transformControls.ghost)var je=Q.getChildIndex(pe);return Q.removeChild(pe),e.transformControls.ghost&&e.transformControls.ghostEnabled&&Q.addChildAt(o,je),e.toggled=!1,e.transformControls.visible=!1,E&&(ze&&D.off("stagemousemove",ze),kt&&D.off("stagemousemove",kt),ut=!1,Yt.removeFrom(),Dt.removeFrom()),r||e.cur(Mt),D.update(),e},remove:function(je){je||e.transformControls.hide(),f=!1,r&&(e.noDrag(),e.off("pressmove",yn))},add:function(je){je||e.transformControls.show(),f=yt,r&&(e.drag({overCursor:"pointer",dragCursor:"pointer",onTop:!1,removeTweens:!1}),yn=e.on("pressmove",yn))},allowToggleOn:function(){f=yt=!0,Ge=pe.on("mousedown",Ge),qe=e.on("mousedown",qe),We=D.on("stagemousedown",We)},allowToggleOff:function(){f=yt=!1,pe.off("mousedown",Ge),e.off("mousedown",qe),D.off("stagemousedown",We)},disable:function(){pe.mouseChildren=!1,pe.mouseEnabled=!1,r&&(e.noDrag(),e.off("pressmove",yn))},enable:function(){pe.mouseChildren=!0,pe.mouseEnabled=!0,r&&(e.drag({overCursor:"pointer",dragCursor:"pointer",onTop:!1,removeTweens:!1}),yn=e.on("pressmove",yn))},recordData:function(je){var ht={type:e.type,index:F.getChildIndex(e),x:e.x,y:e.y,scaleX:e.scaleX,scaleY:e.scaleY,rotation:e.rotation,skewX:e.skewX,skewY:e.skewY,regX:e.regX,regY:e.regY,controls:e.transformControls.visible};return je?JSON.stringify(ht):ht},setData:function(je,ht){if(!n(je)){ht&&(je=JSON.parse(je)),delete je.controls;var Gt=je.index;n(Gt)&&(Gt=0),delete je.index;for(var Kt in je)e[Kt]=je[Kt];return setTimeout(function(){ge(),he(),et(),F.setChildIndex(e,Gt),e.transformControls.visible&&e.type!="Layer"?e.transformControls.show():e.transformControls.hide(),e.transformControls.ghost&&!e.transformControls.ghostEnabled&&!e.transformControls.visible&&Q.addChild(o)},90),e}},hideGhost:function(){e.transformControls.ghost=!1,o.removeFrom()},showGhost:function(){if(e.transformControls.ghost=!0,e.transformControls.ghostEnabled&&!e.transformControls.visible){for(var je=F;je.parent&&je.parent!=Q;)je=je.parent;o.stage?Q.setChildIndex(o,Q.getChildIndex(je)+1):Q.addChildAt(o,Q.getChildIndex(je)+1)}},addGhost:function(){$>0?(e.transformControls.ghostEnabled=!0,e.transformControls.showGhost()):dt&&tt("transform() - ghostWidth must be > 0 when making transform")},removeGhost:function(){e.transformControls.ghostEnabled=!1,e.transformControls.hideGhost()},resize:function(je){if(F=e.parent,ge(),he(),et(),c&&e.transformControls.show(),je){var ht=new Ne.Event("transformed");ht.pressup=!0,ht.transformType="resize",e.dispatchEvent(ht)}return e},dispose:function(){e.transformControls.hide(),f=!1,r&&(e.noDrag(),e.off("pressmove",yn)),e.transformControls.hideGhost(),xe.removeAllEventListeners(),fe.removeAllEventListeners(),S.removeAllEventListeners(),de.removeAllEventListeners(),V.removeAllEventListeners(),Z.removeAllEventListeners(),pe.removeAllEventListeners(),qe&&e.off("mousedown",qe),Ge&&e.off("mousedown",Ge),We&&D.off("stagemousedown",We),ze&&D.off("stagemousemove",ze),kt&&D.off("stagemousemove",kt),tn&&D.off("stagemouseup",tn),zt&&e.off("mousedown",zt),yn&&e.off("pressmove",yn),pe=Yt=Dt=null,e.transformControls=null},controls:pe,scaleControls:Z,stretchXControls:de,stretchYControls:V,rotateControls:fe},e.toggle=function(je){return je===!0?e.transformControls.show():je===!1||e.transformControls.visible?e.transformControls.hide():e.transformControls.show(),e},e.transformControls.ghost&&(e.transformControls.toggleGhost=function(je){return je===!0?e.transformControls.showGhost():je===!1||e.transformControls.visible?e.transformControls.hideGhost():e.transformControls.showGhost(),e}),c?e.transformControls.show():!X&&e.transformControls.ghost&&e.transformControls.showGhost(),e},t.gesture=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I){var g="obj, move, scale, rotate, boundary, minScale, maxScale, snapRotate, localBoundary, slide, slideFactor, regControl, onTop, surround, circularBounds, rect",E;if(E=st(t.gesture,arguments,g))return E;if(De("34.5"),n(e)||!e.on)return;n(r)&&(r=!0),n(i)&&(i=!0),n(l)&&(l=!0),n(w)&&(w=!1),n(c)&&(c=1),n(T)&&(T=!1),n(p)&&(p=5),n(x)&&(x=!1),n(P)&&(P=!0),n(m)&&(m=!1),m&&l&&(m=I=null,dt&&tt("gesture() - does not support surround when rotate is true")),n(v)&&(v=!1),n(a)&&!n(I)&&(a=I);var A,y,C,L,Y=wt();if(n(e.zimMaskDynamic)||e.zimMaskApply(),!e.zimTouch){var _=new t.Damp(e.scaleX,.05),k=new t.Damp(e.scaleY,.05),$=e.scaleX/e.scaleY;if(e.zimTouch={move:r,scale:i,rotate:l,pointers:{},checkBounds:function(o,S){if(e.zimTouch.boundary){var F=e.zimTouch.boundary,h=e.parent.localToLocal(o,S,e.parent);m?(o=Math.min(F.x,Math.max(F.x+F.width,h.x)),S=Math.min(F.y,Math.max(F.y+F.height,h.y))):(o=Math.max(F.x,Math.min(F.x+F.width,h.x)),S=Math.max(F.y,Math.min(F.y+F.height,h.y))),h=e.parent.globalToLocal(o,S),o=h.x,S=h.y}return{x:o,y:S}}},a){e.zimTouch.boundary=a,w&&(e.zimTouch.boundary=t.boundsToGlobal(e.parent,a)),e.zimTouch.boundaryStartX=e.zimTouch.boundary.x,e.zimTouch.boundaryStartY=e.zimTouch.boundary.y,e.zimTouch.boundaryStartW=e.zimTouch.boundary.width,e.zimTouch.boundaryStartH=e.zimTouch.boundary.height;var O=e.zimTouch.checkBounds(e.x,e.y);e.x=O.x,e.y=O.y}T&&(C=10,L=5,y=0,A=[],e.zimTouch.slideInterval=t.interval(C/(Y=="s"?1e3:1),function(){A[y++%L]=[e.x,e.y]}),e.zimTouch.slideInterval.pause(),e.animate({x:e.x,y:e.y},10/(Y=="s"?1e3:1),"quadOut"));var X,R,Q,K,q,ne,U,D;e.zimTouch.mousedown=e.on("mousedown",function(o){if(n(D)?D=1:D++,P){var S=e.parent.numChildren-1;e.parent.getChildAt(S).type=="Keyboard"&&S--,e.parent.setChildIndex(e,S),e.ZIMoutlineShape&&e.outline()}x||(U=null,R=e.scaleX,Q=e.scaleY,K=e.rotation,q=e.regX,ne=e.regY,e.reg(0,0),X=e.getMatrix(),e.regX=q,e.regY=ne);var F="id"+Math.abs(o.pointerID+1),h=e.parent.globalToLocal(o.stageX/t.scaX,o.stageY/t.scaY);e.zimTouch.pointers[F]={startX:h.x,startY:h.y,x:h.x,y:h.y},(e.zimTouch.move||e.zimTouch.rotate)&&(e.zimTouch.total=0,t.loop(e.zimTouch.pointers,function(){e.zimTouch.total++})),T&&e.zimTouch.total==1&&e.zimTouch.slideInterval.pause(!1),d()}),e.zimTouch.pressmove=e.on("pressmove",function(o){var S="id"+Math.abs(o.pointerID+1),F=e.parent.globalToLocal(o.stageX/t.scaX,o.stageY/t.scaY);e.zimTouch.pointers[S]&&(e.zimTouch.pointers[S].x=F.x,e.zimTouch.pointers[S].y=F.y);var h=0,b=0,ye=0,B=0,N=0,re=0;if(t.loop(e.zimTouch.pointers,function(ae,we){h+=we.x-we.startX,b+=we.y-we.startY,ye+=we.x,B+=we.y}),e.zimTouch.total!=0){N=h/e.zimTouch.total,re=b/e.zimTouch.total,h=e.zimTouch.startX+N,b=e.zimTouch.startY+re,ye=ye/e.zimTouch.total,B=B/e.zimTouch.total;var le={x:e.x,y:e.y,scaleX:e.scaleX,scaleY:e.scaleY,rotation:e.rotation};if(e.zimTouch.move){var G=e.zimTouch.checkBounds(h,b);le.x=G.x,le.y=G.y}if(e.zimTouch.pair.length==2){var z=e.zimTouch.pair[0],se=e.zimTouch.pair[1];if(e.zimTouch.scale){var Oe=Math.sqrt(Math.pow(se.startX-z.startX,2)+Math.pow(se.startY-z.startY,2)),J=Math.sqrt(Math.pow(se.x-z.x,2)+Math.pow(se.y-z.y,2)),pe=e.zimTouch.startSX+(J/Oe-1),Z=e.zimTouch.startSY+(J/Oe-1);le.scaleX=pe,le.scaleY=Z,le.scaleX=_.convert(pe),le.scaleY=k.convert(Z);var de=!n(s)&&Math.min(pe,Z)<s,V=!n(f)&&Math.max(pe,Z)>f;(de||V)&&(de?$>1?(le.scaleY=s,le.scaleX=s*$):(le.scaleX=s,le.scaleY=s/$):V&&($>1?(le.scaleX=f,le.scaleY=f/$):(le.scaleY=f,le.scaleX=f*$)),_.immediate(le.scaleX),k.immediate(le.scaleY))}if(e.zimTouch.rotate){var fe=Math.atan2(z.startY-se.startY,z.startX-se.startX)*(180/Math.PI),ke=Math.atan2(z.y-se.y,z.x-se.x)*(180/Math.PI),oe=ke-fe;le.rotation=e.zimTouch.startR+oe}if(x)e.scaleX=le.scaleX,e.scaleY=le.scaleY,e.rotation=le.rotation,e.zimTouch.move&&(e.x=le.x,e.y=le.y);else{e.reg(0,0);var Ce=e.parent.localToGlobal(ye,B);ye=Ce.x,B=Ce.y;var Me=n(U)?e.globalToLocal(ye,B):e.globalToLocal(U.x,U.y),te=X.clone().translate(Me.x,Me.y).rotate(le.rotation-K).scale(le.scaleX/R,le.scaleY/Q).translate(-Me.x,-Me.y);te.decompose(e),e.zimTouch.move&&(e.x+=N,e.y+=re),U=e.localToGlobal(Me.x,Me.y),e.reg(q,ne)}e.zimTouch.scale&&e.dispatchEvent("scale"),e.zimTouch.rotate&&e.dispatchEvent("rotate"),e.zimTouch.move&&e.dispatchEvent("move")}else e.x=le.x,e.y=le.y,e.zimTouch.move&&e.dispatchEvent("move");(e.type=="Tag"||e.type=="TextArea"||e.type=="Loader")&&e.resize(),e.ZIMoutlineShape&&e.outline(),e.getStage&&e.stage&&e.stage.update()}}),e.on("mousedown",function(){var o=1;e.stage.on("stagemousedown",function(){o++}),e.stage.on("stagemouseup",function(){o--,o==0&&setTimeout(function(){e.zimTouch&&(e.zimTouch.total=0),e.zimTouch&&(e.zimTouch.pointers={}),D=null},50)})},null,!0),e.zimTouch.pressup=e.on("pressup",function(o){var S="id"+Math.abs(o.pointerID+1);if(delete e.zimTouch.pointers[S],(e.zimTouch.move||e.zimTouch.rotate)&&e.zimTouch.total--,l&&!n(c)&&e.zimTouch.total==0&&(c>0?e.rotation=Math.round(e.rotation/c)*c:c==0&&(e.rotation=Math.round(e.rotation))),T&&e.zimTouch.total==0&&D==1){e.zimTouch.slideInterval.pause();var F=A[(y+1)%A.length],h=A[y%A.length],b=e.x+(F[0]-h[0])*p,ye=e.y+(F[1]-h[1])*p,B=e.zimTouch.checkBounds(b,ye),N=L*C*p*Math.min((e.x-B.x)/(e.x-b)||1,(e.y-B.y)/(e.y-ye)||1);e.animate({x:B.x,y:B.y},N/(Y=="s"?1e3:1),"quadOut",function(){e.dispatchEvent("slidestop")})}e.zimTouch.total==0&&(D=null),e.getStage&&e.stage&&e.stage.update(),d()}),a&&(u(),e.on("move",u))}function d(){e.zimTouch.pair=[],t.loop(e.zimTouch.pointers,function(o,S,F){S.startX=S.x,S.startY=S.y,F<=1&&e.zimTouch.pair.push(S)}),e.zimTouch.startX=e.x,e.zimTouch.startY=e.y,e.zimTouch.startSX=e.scaleX,e.zimTouch.startSY=e.scaleY,e.zimTouch.startR=e.rotation}function u(){var o=e.localToGlobal(e.regX,e.regY),S;if(v){var F=e.parent.localToGlobal(e.x-e.width/2,e.y-e.height/2),h=e.parent.localToGlobal(e.x+e.width/2,e.y+e.height/2);S={x:F.x,y:F.y,width:h.x-F.x,height:h.y-F.y}}else S=e.boundsToGlobal();var b={x:e.zimTouch.boundaryStartX+o.x-S.x,y:e.zimTouch.boundaryStartY+o.y-S.y,width:e.zimTouch.boundaryStartW-S.width,height:e.zimTouch.boundaryStartH-S.height};e.gestureBoundary(b,!1)}return e},t.noGesture=function(e,r,i,l){var a="obj, move, scale, rotate",s;if(s=st(t.noGesture,arguments,a))return s;if(De("34.6"),!(n(e)||!e.on||!e.zimTouch))return n(r)&&(r=!0),n(i)&&(i=!0),n(l)&&(l=!0),e.zimTouch.move=!r,e.zimTouch.scale=!i,e.zimTouch.rotate=!l,!e.zimTouch.move&&!e.zimTouch.scale&&!e.zimTouch.rotate&&(e.off("mousedown",e.zimTouch.mousedown),e.off("pressmove",e.zimTouch.pressmove),e.off("pressup",e.zimTouch.pressup),delete e.zimTouch),e},t.gestureBoundary=function(e,r,i){if(De("34.7"),!(n(e)||!e.on)&&!(n(r)||!e.zimTouch)){e.zimTouch.localBoundary&&e.parent?e.zimTouch.boundary=t.boundsToGlobal(e.parent,r):e.zimTouch.boundary=r,n(i)&&(i=!0),i&&(e.zimTouch.boundaryStartX=r.x,e.zimTouch.boundaryStartY=r.y,e.zimTouch.boundaryStartW=r.width,e.zimTouch.boundaryStartH=r.height);var l=e.zimTouch.checkBounds(e.x,e.y);return e.x=l.x,e.y=l.y,e}},t.effect=function(e,r,i,l,a,s){if(De("33.16"),n(r))return e;n(e.effects)&&(e.effects={}),Array.isArray(r)||(r=[r]);for(var f=0,c=0;c<r.length;c++){var w=r[c];w.type||(w instanceof Ne.BlurFilter?w.type="BlurEffect":w instanceof Ne.ColorFilter?w.type="ColorEffect":w instanceof Ne.AlphaMaskFilter?w.type="AlphaEffect":w instanceof Ne.ColorMatrixFilter?w.type="MultiEffect":n(w.type)&&(w.type="custom"+f++));var T=w.type.replace(/effect/i,"");e.effects[T.toLowerCase()]=w}e.filters=[];for(var p in e.effects)e.filters.push(e.effects[p]);return e.cache(i,l,a,s),e},t.updateEffects=function(e,r){return De("33.163"),e.updateCache&&(r?e.cache():e.updateCache()),e},t.noEffect=function(e,r,i){if(De("33.165"),n(i)&&(i=!1),n(r)){var l;e.effects.multi&&(l=e.effects.multi),e.effects={},l&&(e.effects.multi=l)}else{e.effects||(e.effects={}),Array.isArray(r)||(r=[r]);for(var a=0;a<r.length;a++){var s=r[a].replace(/effect/i,"");delete e.effects[s.toLowerCase()]}}e.filters=[];for(var f in e.effects)e.filters.push(e.effects[f]);return i||e.filters.length>0?e.updateCache&&e.updateCache():e.uncache&&e.uncache(),e},t.addPhysics=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m){var v="obj, dynamic, contract, shape, friction, linear, angular, density, bounciness, maskBits, categoryBits, physics, restitution, sensor",I;if(I=st(t.addPhysics,arguments,v))return I;if(De("34.8"),n(x)){if(typeof zimPhysics>"u")return dt&&tt("ZIM Physics module must be imported"),e;n(j.zimDefaultPhysics)&&(j.zimDefaultPhysics=new t.Physics),x=j.zimDefaultPhysics}e.physics=x;var g="rectangle";return e.type=="Circle"||e.type=="Dial"?g="circle":e.type=="Triangle"?g="triangle":e.type=="Blob"&&(g="poly"),n(l)&&(l=g),n(w)&&(w=P),Ke(e,r,i,l,a,s,f,c,w,T,p,m),e},t.removePhysics=function(e){return De("34.85"),n(e.physics)||(e==e.physics.followObj&&e.physics.follow(null),e.follow=e.noFollow=e.control=e.noControl=e.sleep=e.wake=null,e.impulse=e.force=e.spin=e.torque=null,e.physics.remove(e.body),e.physics=null),e},t.hitTestPoint=function(e,r,i,l){if(t.zimhtp||(De("35"),t.zimhtp=!0),!e.stage||n(r)||n(i))return!1;if(!(n(e)||!e.globalToLocal)){if(n(l)&&(l=!0),l){var a=e.getBounds();if(a){var s=e.globalToLocal(r,i);if(s.x>a.x+a.width||s.x<a.x||s.y>a.y+a.height||s.y<a.y)return!1}}var f={x:r,y:i};return e.image||e.spriteSheet||e.type=="Shape"?f=e.globalToLocal(f.x,f.y):f=e.globalToLocal(f.x*t.scaX,f.y*t.scaY),e.hitTest(f.x,f.y)}},t.hitTestReg=function(e,r,i){if(t.zimhtr||(De("36"),t.zimhtr=!0),!e.stage||!r.stage)return!1;if(!(n(e)||n(r)||!e.localToLocal||!r.localToLocal)){n(i)&&(i=!0);var l=r.localToGlobal(r.regX,r.regY),a=e.getBounds();if(i&&a){var s=e.globalToLocal(l.x,l.y);if(s.x>a.x+a.width||s.x<a.x||s.y>a.y+a.height||s.y<a.y)return!1}return e.image||e.spriteSheet||e.type=="Shape"?l=e.globalToLocal(l.x,l.y):l=e.globalToLocal(l.x*t.scaX,l.y*t.scaY),e.hitTest(l.x,l.y)}},t.hitTestRect=function(e,r,i,l,a){if(t.zimhtr||(De("37"),t.zimhtr=!0),!e.stage||!r.stage)return!1;if(n(e)||n(r)||!e.hitTest||!r.getBounds)return;n(i)&&(i=0),n(l)&&(l=!0);var s=r.getBounds();if(!s){dt&&tt(`hitTestRect():
 please setBounds() on param b object`);return}if(l){var f=e.getBounds();if(f&&!t.hitTestBounds(e,r))return!1}function c(v){if(e.image||e.spriteSheet||e.type=="Shape"?v=e.globalToLocal(v.x,v.y):v=e.globalToLocal(v.x*t.scaX,v.y*t.scaY),e.hitTest(v.x,v.y))return!0}var w=s.x+s.width/2,T=s.y+s.height/2,p=r.localToGlobal(w,T),x,P;if(a){if(!c(p))return!1;for(var m=0;m<=i;m++)if(x=s.width*(m+1)/(i+1),P=s.height*(m+1)/(i+1),p=r.localToGlobal(s.x+x,s.y),!c(p)||(p=r.localToGlobal(s.x+s.width,s.y+P),!c(p))||(p=r.localToGlobal(s.x+s.width-x,s.y+s.height),!c(p))||(p=r.localToGlobal(s.x,s.y+s.height-P),!c(p)))return!1;return!0}else{if(c(p))return!0;for(var m=0;m<=i;m++)if(x=s.width*(m+1)/(i+1),P=s.height*(m+1)/(i+1),p=r.localToGlobal(s.x+x,s.y),c(p)||(p=r.localToGlobal(s.x+s.width,s.y+P),c(p))||(p=r.localToGlobal(s.x+s.width-x,s.y+s.height),c(p))||(p=r.localToGlobal(s.x,s.y+s.height-P),c(p)))return!0}},t.hitTestCircle=function(e,r,i,l,a){if(t.zimhtc||(De("38"),t.zimhtr=!0),De("38"),!e.stage||!r.stage||n(e)||n(r)||!e.hitTest||!r.getBounds)return;n(i)&&(i=8),n(l)&&(l=!0);var s=r.getBounds();if(!s){dt&&tt(`hitTestCircle():
 please setBounds() on param b object`);return}var f=e.getBounds();if(l&&f&&!t.hitTestBounds(e,r))return!1;function c(g){if(e.image||e.spriteSheet||e.type=="Shape"?g=e.globalToLocal(g.x,g.y):g=e.globalToLocal(g.x*t.scaX,g.y*t.scaY),e.hitTest(g.x,g.y))return!0}var w=s.x+s.width/2,T=s.y+s.height/2,p=r.localToGlobal(w,T),x=(s.width+s.height)/2/2,P,m,v;if(a){if(!c(p))return!1;for(var I=0;I<i;I++)if(P=I/i*2*Math.PI,m=w+x*Math.cos(P),v=T+x*Math.sin(P),p=r.localToGlobal(m,v),!c(p))return!1;return!0}else{if(c(p))return!0;for(var I=0;I<i;I++)if(P=I/i*2*Math.PI,m=w+x*Math.cos(P),v=T+x*Math.sin(P),p=r.localToGlobal(m,v),c(p))return!0}return!1},t.hitTestCircleRect=function(e,r,i){if(t.zimhtcr||(De("38.2"),t.zimhtcr=!0),!(!e.stage||!r.stage)){var l=e.stage;if(!(n(e)||n(r)||!e.getBounds||!r.getBounds)){var a=e.getBounds(),s=r.getBounds();if(!a||!s){dt&&tt(`hitTestCircleRect():
 please setBounds() on both objects`);return}n(i)&&(i=0);var f=(e.radius?e.radius:(a.width+a.height)/2)+i,c=e.getConcatenatedMatrix().decompose().scaleX;f*=c/l.scaleX;var w=r.boundsToGlobal(),T=e.localToGlobal(0,0),p=T.x,x=T.y,P=w.x,m=w.y,v=w.x+w.width,I=w.y+w.height,g=p<P?P:p>v?v:p,E=x<m?m:x>I?I:x,A=g-p,y=E-x;return A*A+y*y<=f*f}}},t.hitTestCircles=function(e,r,i){if(t.zimhtcs||(De("38.5"),t.zimhtcs=!0),!(!e.stage||!r.stage)){var l=e.stage;if(!(n(e)||n(r)||!e.hitTest||!e.getBounds||!r.getBounds)){var a=e.getBounds(),s=r.getBounds();if(!a||!s){dt&&tt(`hitTestCircles():
 please setBounds() on both objects`);return}n(i)&&(i=0);var f=e.localToGlobal(a.x+a.width/2,a.y+a.height/2),c=r.localToGlobal(s.x+s.width/2,s.y+s.height/2),w=e.getConcatenatedMatrix(),T=r.getConcatenatedMatrix(),p=Math.sqrt(w.a/l.scaleX*w.a/l.scaleX+w.c/l.scaleX*w.c/l.scaleX),x=Math.sqrt(w.b/l.scaleY*w.b/l.scaleY+w.d/l.scaleY*w.d/l.scaleY),P=Math.sqrt(T.a/l.scaleX*T.a/l.scaleX+T.c/l.scaleX*T.c/l.scaleX),m=Math.sqrt(T.b/l.scaleY*T.b/l.scaleY+T.d/l.scaleY*T.d/l.scaleY),v=Math.sqrt(Math.abs(Math.pow(f.x-c.x,2)+Math.pow(f.y-c.y,2)));return a.width*Math.max(p,x)/2+s.width*Math.max(P,m)/2>=v-i}}},t.hitTestBounds=function(e,r,i,l){if(t.zimhtb||(De("39"),t.zimhtb=!0),!(!e.stage||!r.stage)&&!(n(e)||n(r)||!e.getBounds||!r.getBounds)){var a=!1;l&&l.graphics&&(a=!0);var s=e.getBounds(),f=r.getBounds();if(!s||!f){dt&&tt(`hitTestBounds():
 please setBounds() on both objects`);return}n(i)&&(i=0);var c=t.boundsToGlobal(e),w=t.boundsToGlobal(r);if(a){var T=l.graphics;T.c(),T.ss(1).s("blue"),T.r(c.x,c.y,c.width,c.height),T.s("green"),T.r(w.x,w.y,w.width,w.height),l.stage.update()}return t.rectIntersect(c,w,i)}},t.hitTestPath=function(e,r,i,l,a,s){if(t.zimhtpa||(De("37.5"),t.zimhtpa=!0),!e.stage||!r.stage||n(e)||n(r)||!e.hitTest||r.type!="Squiggle"&&r.type!="Blob")return;var f=e.getBounds();n(i)&&(i=2),n(l)&&(l=!1),n(a)&&(a=!1),n(s)&&(s=!1);var c=[],w;function T(v){var I;if(e.image||e.spriteSheet||e.type=="Shape"?I=e.globalToLocal(v.x,v.y):I=e.globalToLocal(v.x*t.scaX,v.y*t.scaY),e.hitTest(I.x,I.y))if(a)c.push({x:Math.round(v.x),y:Math.round(v.y)});else if(s)w=x/p.length*100;else return!0}var p=r.interpolate(i,null,!0,null,!0),x,P;if(l)for(r.hitPathPoints?r.hitPathPoints.removeAllChildren():r.hitPathPoints=new t.Container().addTo(),r.hitPathPoints.top(),x=0;x<p.length;x++)P=p[x],P=r.localToGlobal(P.x,P.y),new t.Circle(3).loc(P.x,P.y,r.hitPathPoints);if(f){var m=t.boundsAroundPoints(p);if(!t.rectIntersect(e.boundsToGlobal(f),r.boundsToGlobal(m)))return!1}for(x=0;x<p.length;x++){if(P=p[x],P=r.localToGlobal(P.x,P.y),T(P))return!0;if(w!=null)return w}return c.length>0?c:!1},t.hitTestGrid=function(e,r,i,l,a,s,f,c,w,T,p,x,P){if(t.zimhtg||(De("41"),t.zimhtg=!0),!e.stage)return!1;if(!n(e)&&!x){var m=e.globalToLocal(s,f);s=m.x,f=m.y}n(c)&&(c=0),n(w)&&(w=0),n(T)&&(T=0),n(p)&&(p=0),r+=T,i+=p;var v=r/l,I=i/a,g=Math.min(l-1,Math.max(0,Math.floor((s-c+T/2)/v))),E=Math.min(a-1,Math.max(0,Math.floor((f-w+p/2)/I)));if(!(P!="open"&&(s-c>v*(g+1)-T||s-c<v*g||f-w>I*(E+1)-p||f-w<I*E))){var A=E*l+g;if(n(P)||P=="index")return A;if(P=="col")return g;if(P=="row")return E;if(P=="array"||P=="open")return[A,g,E]}},t.animate=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O,X,R,Q,K,q,ne,U,D,d,u,o,S,F,h,b,ye,B,N,re,le,G,z,se,Oe,J,pe,Z,de,V,fe,ke){var oe="target, props, time, ease, call, params, wait, waitedCall, waitedParams, loop, loopCount, loopWait, loopCall, loopParams, loopWaitCall, loopWaitParams, loopPick, rewind, rewindWait, rewindCall, rewindParams, rewindWaitCall, rewindWaitParams, rewindTime, rewindEase, startCall, startParams, animateCall, animateParams, sequence, sequenceCall, sequenceParams, sequenceReverse, ticker, cjsProps, css, protect, override, from, set, id, events, sequenceTarget, dynamic, drag, clamp, startPaused, clean, obj, seriesWait, sequenceWait, rate, pauseOnBlur, easeAmount, easeFrequency, timeUnit, timeCheck, noAnimateCall";if(e&&(e.props||e.obj)){var Ce;if(Ce=st(t.animate,arguments,oe))return Ce}if(e.type=="AC"&&j.zdf)return j.zdf.ac("animate",arguments),e;if(t.animateCheck||(De("45"),t.animateCheck=!0),!e)return;var Me=t.ANIMATE;if(j.ANIMATE!=null&&(Me=j.ANIMATE),!Me)return n(ke)&&(ke=!0),a&&ke&&typeof a=="function"&&a(n(s)?e:s),e;n(fe)&&(fe=!0);var te=wt(null,V,null,null,n(fe)?!1:!fe);(p||P||x)&&(T=!0),(_||y||_||k||A)&&(E=!0);var ae,we,ue,Pe=arguments,ie=Array.prototype.slice.call(arguments);if(n(r)&&!n(z)&&(r=z),z=r,n(z))return dt&&tt("animate() - need props"),e;if(e.type=="BeadsContainer"&&n(Q)&&(Q=0),e.type=="Tone"&&(pe=!1),pe===!1?t.pauseAnimateOnBlur=!1:(pe||n(pe)&&t.pauseAnimateOnBlur!==!1)&&(n(t.blurCheck)&&t.setBlurDetect(),t.pauseAnimateOnBlur=!0),!(!n(Q)&&e.addChild)){i=t.Pick.choose(i),l=t.Pick.choose(l),f=t.Pick.choose(f),p=t.Pick.choose(p),x=t.Pick.choose(x),E=t.Pick.choose(E),A=t.Pick.choose(A),n(_)?_=i:_=t.Pick.choose(_),ne=t.Pick.choose(ne),S=t.Pick.choose(S),F=t.Pick.choose(F);var be=["loopCount","loopWait","rewind","rewindWait"];for(we in D)be.indexOf(we)>=0&&(D[we]=t.Pick.choose(D[we]))}var Le={override:!n(e)&&!n(e.zimX)&&!n(z.x)||!n(e)&&!n(e.zimY)&&!n(z.y)};n(T)||(Le.loop=T),n(p)||(Le.count=p),n(x)||(Le.loopWait=x),n(P)||(Le.loopCall=P),n(I)||(Le.loopWaitParams=I),n(v)||(Le.loopWaitCall=v),n(m)||(Le.loopParams=m),n(g)||(Le.loopPick=g),n(E)||(Le.rewind=E),n(A)||(Le.rewindWait=A),n(y)||(Le.rewindCall=y),n(C)||(Le.rewindParams=C),n(L)||(Le.rewindWaitCall=L),n(Y)||(Le.rewindWaitParams=Y),n($)||(Le.startCall=$),n(O)||(Le.startParams=O),n(X)||(Le.animateCall=X),n(R)||(Le.animateParams=R),n(r)||(Le=t.merge(Le,D)),D=Le,t.loop(z,function(Ee,it){if(typeof Ee=="string"){var ct=Ee.split(".");if(ct.length>1&&Ee.substr(0,1)!="."&&(z["."+Ee]=it,delete z[Ee],Ee="."+Ee),ct.length>1&&typeof it=="string"){var pt=it.substr(0,1);pt!="+"&&pt!="-"&&(z[Ee]="+"+it)}}});function me(Ee,it){if(it.substr(0,1)=="."){for(var ct=it.split("."),pt=Ee,Rt=1;Rt<ct.length;Rt++)pt=pt[ct[Rt]];return pt}else return it=="transform"&&Ee.style?Ee.style.transform:Ee[it]}function ee(Ee,it,ct){if(it.substr(0,1)=="."){for(var pt=it.split("."),Rt=Ee,Ft=1;Ft<pt.length-1;Ft++)Rt=Rt[pt[Ft]];Rt[pt[pt.length-1]]=ct}else Ee[it]=ct}if(e.zimTweenOriginals={},!n(Q)&&e.addChild){var Ie=[];for(ae=0;ae<e.numChildren;ae++)Ie.push(e.getChildAt(ae));ye=e,e=Ie}var Re=["extra","zoom","speed","layer","fade"],_e={zoom:e.type=="Pen"?"size":"scale",speed:"percentSpeed",layer:"layer",fade:"alpha"};if(e instanceof Array){for(ne&&e.reverse(),ae=0;ae<e.length;ae++){var Ze=e[ae];if(S){var at;Ze.zimObj={};for(we in z){if(Re.indexOf(we)>=0?at=z[we]:at=t.Pick.choose(z[we]),Ze.zimObj[we]=Ze[we],typeof at=="string"&&we!="transform"){var Be;Ze.zimLastObj&&!n(Ze.zimLastObj[we])?Be=Ze.zimLastObj[we]:Be=Ze[we],at=Be+Number(at.replace(/\s/g,""))}Ze.zimLastObj&&(Ze.zimLastObj[we]=E?Ze.zimTweenOriginals[we]:z[we]),Ze[we]=at}}else{Ze.zimObj={};for(we in z)Re.indexOf(we)>=0,Ze.zimObj[we]=z[we]}var He=ae*Q;ae==0&&Q!=0&&(He=te=="s"?.02:20),t.animate(Ze,Ze.zimObj,i,l,ae==e.length-1?a:null,ae==e.length-1?s:null,f,c,w,null,null,null,null,null,null,null,g,null,null,null,null,null,null,_,k,$,O,X,R,null,K,q,null,U,t.copy(D),d,u,o,null,F,h,b,ye,B,N,re,le,G,z,se,He,J,pe,Z,de,V,fe,ke)}return ye}var et=i,ge=_;n(et)&&(et=te=="s"?1:1e3),n(_)&&(_=ge=et),n(l)&&(l="quadInOut"),n(f)&&(f=0),n(A)&&(A=0),n(D)&&(D={override:!n(e.zimX)&&!n(z.x)||!n(e.zimY)&&!n(z.y)}),n(s)&&(s=e),n(U)&&(U=!0),n(d)&&(d=!1),n(u)&&(u=!1),n(S)&&(S=!1),n(F)&&(F={}),F.scale&&(F.scaleX=F.scaleY=F.scale,delete F.scale),n(o)||(D.override=o),n(N)&&(N=!1),n(le)&&(le=!!N),n(B)&&(B=!1),n(re)&&(re=!0),n(G)&&(G=!0),n(J)&&(J=1),e.futureRate=J;var xe,he,Ge;if(z instanceof Array){if(ue=1,z.length==0)return this;var qe,Fe;return Ve(),jt(),We(),e}function We(){e.zimLastObj&&t.loop(e.zimLastObj,function(kn){n(e.zimTweenOriginals[kn])||(e[kn]=e.zimTweenOriginals[kn],e.zimLastObj[kn]=e.zimTweenOriginals[kn])});for(var Ee,it=f,ct=0,pt,Rt,Ft=0;Ft<z.length;Ft++)if(Ee=z[Ft],!n(Ee.target)){n(Ee.time)&&(Ee.time=et),it+=Ee.wait?Ee.wait:0,pt=Ee.time,Rt=n(Ee.rewindTime)?pt:Ee.rewindTime,Ee.rewind&&(pt=pt+Rt+(Ee.rewindWait?Ee.rewindWait:0)),Ee.loop&&(pt*=Ee.loopCount,pt+=(Ee.loopCount-1)*(Ee.loopWait?Ee.loopWait:0)),n(Ee.params)&&(Ee.params=Ee.target),Fe=Ee.target,it<0&&(ct+=it,it=0);var pn={target:Ee.target,obj:t.copy(Ee.obj),seriesWait:ct,wait:it,waitedCall:Ee.waitedCall,waitedParams:Ee.waitedParams,time:Ee.time,ease:Ee.ease,from:Ee.from,rewind:Ee.rewind,call:Ee.call,params:Ee.params,loop:Ee.loop,loopCount:Ee.loopCount,loopWait:Ee.loopWait,loopCall:Ee.loopCall,loopParams:Ee.loopParams,loopWaitCall:Ee.loopWaitCall,loopWaitParams:Ee.loopWaitParams,loopPick:Ee.loopPick,rewindWait:Ee.rewindWait,rewindCall:Ee.rewindCall,rewindParams:Ee.rewindParams,rewindWaitCall:Ee.rewindWaitCall,rewindWaitParams:Ee.rewindWaitParams,rewindTime:Ee.rewindTime,rewindEase:Ee.rewindEase,startCall:Ee.startCall,startParams:Ee.startParams,animateCall:Ee.animateCall,animateParams:Ee.animateParams,set:t.copy(Ee.masterSet),events:b,rate:e.futureRate,pauseOnBlur:Ee.pauseOnBlur,easeAmount:Ee.easeAmount,easeFrequency:Ee.easeFrequency,override:!1,id:h};Ft==z.length-1&&ce(pn),t.animate(pn),ct+=it+pt,it=0}}function ce(Ee){var it=Ee.call,ct=Ee.params;D.loop&&(!D.count||ue<D.count)?Ee.call=function(){it&&typeof it=="function"&&it(ct),D.loopCall&&typeof D.loopCall=="function"&&D.loopCall(D.loopParams),D.loopWait?(n(e.zimTweens)&&(e.zimTweens={}),xe=e.zimTweens[h]=e.zimTween=Ne.Tween.get(e,{override:D.override}).wait(D.loopWait,!0).call(pt),xe.timeScale=e.futureRate):pt();function pt(){for(var Rt=0;Rt<qe.objects.length;Rt++)qe.objects[Rt].set&&qe.objects[Rt].set(qe.values[Rt]);D.loopWaitCall&&typeof D.loopWaitCall=="function"&&D.loopWaitCall(D.loopWaitParams),We()}}:Ee.call=function(){it&&typeof it=="function"&&it(ct),n(s)&&(s=Fe),a&&typeof a=="function"&&a(s),e.zimLastObj=null},ue++}function Ve(){e&&!e.seriesTweens&&(e.seriesTweens=[],e.seriesCalls=[],e.seriesParams=[]);for(var Ee,it=0;it<z.length;it++)Ee=z[it],Ee.target?(Ee.target.seriesTweens||(Ee.target.seriesTweens=[]),Ee.target.seriesCalls||(Ee.target.seriesCalls=[]),Ee.target.seriesParams||(Ee.target.seriesParams=[]),Ee.target.seriesTweens.push(Ee.props),Ee.target.seriesCalls.push(Ee.call),Ee.target.seriesParams.push(Ee.params)):(e.seriesTweens.push(Ee.props),e.seriesCalls.push(Ee.call),e.seriesParams.push(Ee.params));e.seriesCalls.push(a),e.seriesParams.push(s),Ee=z[0];var ct;for(e?ct=e:ct=Ee.target,ct.zimSeriesOriginals={},it=z.length-1;it>=0;it--)Ee=z[it],n(Ee.props)&&!n(Ee.obj)&&(Ee.props=Ee.obj),Ee.obj=Ee.props,t.loop(Ee.obj,function(sr){sr=="path"?ct.zimSeriesOriginals[sr]=z[sr]:ct.zimSeriesOriginals[sr]=me(ct,sr)});var pt=new t.Dictionary;for(qe=new t.Dictionary,it=0;it<z.length;it++)if(Ee=z[it],e||(e=Ee.target),n(Ee.target)&&(Ee.target=e),n(Ee.ease)&&(Ee.ease=l),!n(Ee.target)){if(it==0&&(Ee.target.zimSeriesArgs=Pe),n(Ee.props)&&!n(Ee.obj)&&(Ee.props=Ee.obj),Ee.obj=Ee.props,Ee.loop&&(n(Ee.loopCount)||Ee.loopCount<=0)&&(Ee.loopCount=0,z.splice(it+1,z.length)),n(Ee.obj.scale)||(Ee.obj.scaleX=Ee.obj.scaleY=Ee.obj.scale,delete Ee.obj.scale),Ee.from){var Rt=pt.at(Ee.target);if(Rt){if(Ee.set){var Ft=t.copy(Ee.obj),pn=t.merge(Rt,Ee.set);Ee.obj=Jt(Ee.target,Ee.obj,pn),Ee.set=t.merge(Ee.set,Ft)}else Ee.set=t.copy(Ee.obj),Ee.obj=Jt(Ee.target,Ee.obj,Rt);Ee.from=!1}else pt.add(Ee.target,Jt(Ee.target,Ee.obj,Ee.set))}var kn={};for(var Xn in Ee.obj)kn[Xn]=Ee.set&&Ee.set[Xn]?Ee.set[Xn]:Ee.target[Xn];n(qe.at(Ee.target))&&qe.add(Ee.target,{});var tr=t.merge(qe.at(Ee.target),kn);qe.remove(Ee.target),qe.add(Ee.target,tr),Ee.masterSet=t.copy(Ee.set)}n(e.zimTweens)&&(e.zimTweens={})}if(z&&(z.x&&(e.zimX=!0),z.y&&(e.zimY=!0)),!n(z.shape)&&z.shape.type==e.type&&(e.type=="Blob"||e.type=="Squiggle")){var Se=e.pointObjects,Ae=z.shape.pointObjects;if(Se.length!=Ae.length)dt&&tt("animate() - shapes must be of same number of points"),delete z.shape;else{delete z.shape;var Ye=n(z.blobShift)?0:z.blobShift;delete z.blobShift;var Xe=!0;for(ae=0;ae<Se.length;ae++){var Ue=Se[ae],rt=Ae[(Se.length*2e4+ae+Ye)%Se.length];for(_n=0;_n<4;_n++)if(_n!=1){var Te=Ue[_n],$e=t.copy(ie);$e[0]=Te,$e[1]={x:rt[_n].x,y:rt[_n].y,rotation:rt[_n].rotation},Xe&&($e[37]=!0,Te.animateEvent&&Te.off("animation",Te.animateEvent),Te.animateEvent=Te.on("animation",function(){e.update()})),Xe=!1,t.animate.apply(t.animate,$e)}}if(t.isEmpty(z))return e}}if(n(e))return;e.tweenStates||(e.tweenStates={all:!0});var lt=!1;if(z.note){if(Array.isArray(z.note))t.loop(z.note,function(Ee,it){typeof Ee=="string"&&(z.note[it]=t.Synth.note(Ee))});else if(z.note.min)z.note.min=t.Synth.note(z.note.min),z.note.max=t.Synth.note(z.note.max);else if(z.note.array)t.loop(z.note.array,function(Ee,it){typeof Ee=="string"&&(z.note.array[it]=t.Synth.note(Ee))});else if(typeof z.note=="function"){if(dt)return tt("animate() - use frequency in ZIM VEE functions not note"),e}else z.note=t.Synth.note(z.note);z.frequency=z.note,delete z.note}function Qe(Ee,it){return!!Object.getOwnPropertyDescriptor(Ee,it).get}(e.type=="Sprite"||!Object.prototype.hasOwnProperty.call(e,"paused"))&&(Object.defineProperty(e,"paused",{get:function(){return e.animatePaused},set:function(Ee){e.animatePaused=Ee}}),e.type!=null&&(e.paused=!0),e.animating=!1),e.endTween=function(Ee,it){if(e.stopAnimate(it),Ee!="all"&&Ee!="main"&&Ee!="none"&&(Ee="all"),!e.seriesTweens)t.loop(e.zimLastObj,function(pt){typeof e.zimLastObj[pt]=="string"&&pt!="transform"&&(e.zimLastObj[pt]=e[pt]+Number(e.zimLastObj[pt].replace(/\s/g,""))),ee(e,pt,e.zimLastObj[pt])}),Ee!="none"&&a&&a(s);else{if(t.loop(e.seriesTweens,function(pt,Rt){t.loop(pt,function(Ft){typeof pt[Ft]=="string"&&Ft!="transform"&&(pt[Ft]=e[Ft]+Number(pt[Ft].replace(/\s/g,""))),ee(e,Ft,pt[Ft])}),Ee=="all"&&e.seriesCalls[Rt]&&e.seriesCalls[Rt](e.seriesParams[Rt])}),Ee!="none"){var ct=e.seriesCalls[e.seriesCalls.length-1];ct&&ct(e.seriesParams[e.seriesParams.length-1])}e.seriesTweens=null,e.seriesCalls=null,e.seriesParams=null}return e.stage&&e.stage.update(),e};var ot=!1;if(t.loop(z,function(Ee,it){Ee=="path"?e.zimTweenOriginals[Ee]=z[Ee]:e.zimTweenOriginals[Ee]=me(e,Ee),Ee.match("hue")?(z.hueBatch=it,delete z.hue,ot=!0):Ee.match("saturation")?(z.saturationBatch=it,delete z.saturation,ot=!0):Ee.match("brightness")?(z.brightnessBatch=it,delete z.brightness,ot=!0):Ee.match("contrast")?(z.contrastBatch=it,delete z.contrast,ot=!0):Ee.match(/^.effects/)&&(ot=!0)}),e.resetTween=function(Ee){n(Ee)&&(Ee=!0),e.pauseAnimate(),e.percent=null,e.startPercent=null;var it=e.zimSeriesOriginals?e.zimSeriesOriginals:e.zimTweenOriginals;return t.loop(it,function(ct){if(ct=="path"){e.percentComplete=0,e.zimPath=it[ct];var pt;e.zimStartPercent,pt=e.zimPath.getCurvePoint(e.zimStartPercent/100),e.loc(pt.x,pt.y)}else ee(e,ct,it[ct])}),e.zimLastObj=null,e.stage&&e.stage.update(),e.stopAnimate(),e.zimPath&&(ie[1].path=e.zimPath),n(e.zimStartRotation)||(e.rotation=e.zimStartRotation),e.zimStartRotation=null,n(e.zimStartScaleX)||(e.scaleX=e.zimStartScaleX),e.zimStartScaleX=null,n(e.zimStartScaleY)||(e.scaleY=e.zimStartScaleY),e.zimStartScaleY=null,t.animate.apply(null,e.zimSeriesArgs?e.zimSeriesArgs:ie),e.pauseAnimate(Ee),e},e.replayTween=function(){return e.resetTween(!1),e},z.path||B){var ft;e.requestedPercentComplete?ft=e.requestedPercentComplete:e.percentComplete&&!Qe(e,"percentComplete")&&(ft=e.percentComplete),e.requestedPercentComplete=null,n(ft)&&(ft=0),e.pathRatio=0,e.zimStartRotation=e.rotation,e.percent=null,e.parent&&e.parent.type=="BeadsContainer"||(e.startPercent=null)}d&&(U=!1),n(e.zimTweens)&&(e.zimTweens={});var ut;if(d||(e.stage?ut=e.stage:j.zdf?ut=j.zdf.stage:d=!0),e.setColorRange&&!n(z.color)){var ze=z.color;delete z.color,z.colorRange=1,e.setColorRange(e.color,ze),e.colorRange=0}else if(z.color&&(e.material||e.isMaterial)){if(e.isMaterial)return tt("ZIM animate - please animate the color on the mesh not the material"),e;var kt=e;kt.cT&&t.Ticker.remove(kt.cT),e={val:0,zimTweens:{},ticker:kt.cT};var Mt=kt.material.color.getHexString(),xt=z.color;if(z={val:1},kt.cT=t.Ticker.add(function(){var Ee=t.colorRange("#"+Mt,xt,e.val);kt.material.color.set(Ee)}),a){var Yt=a;a=function(){kt.cT==e.ticker&&(Yt(callParams||kt),t.Ticker.remove(kt.cT),kt.cT=null,e=null)}}else a=function(){kt.cT==e.ticker&&(t.Ticker.remove(kt.cT),kt.cT=null,e=null)}}var Dt={};for(ae in z)Re.indexOf(ae)>=0||(Dt[ae]=t.copy(z[ae]),z[ae]=t.Pick.choose(z[ae]));n(z.scale)||(z.scaleX=z.scaleY=t.Pick.choose(z.scale),delete z.scale);for(var Ht in z){if(!e.zimBusy)break;e.zimBusy[Ht]&&delete z[Ht]}if(t.isEmpty(z))return;e.type!="Sprite"&&(e.type!=null&&(e.paused=!1),e.animating=!0);function nn(){e.zimMouseEnabledCheck||(e.zimMouseEnabledCheck=!0,e.zimLastMouseEnabled=e.mouseEnabled),e.mouseEnabled=!1,setTimeout(function(){e.zimBusy||(e.zimBusy={});for(var Ee in z)e.zimBusy[Ee]=!0;e.zimMouseEnabledCheck=null,e.mouseEnabled=e.zimLastMouseEnabled},70)}(u||D.loop||D.rewind)&&nn(),jt();function jt(){n(h)?h=t.makeID(null,10):(h=String(h),Ge=h),n(e.zimIdSets)&&(e.zimIdSets={}),n(e.zimIdSets[h])?e.zimTweens&&!n(e.zimTweens[h])&&(he=h,h=t.makeID(null,10),e.zimIdSets[he]=[he],e.zimTweens[he].zimIdSet=he,e.zimIdSets[he].push(h)):(he=h,h=t.makeID(null,10),e.zimIdSets[he].push(h))}Re.shift();for(ae in F)F[ae]=t.Pick.choose(F[ae]);for(ae in D)ae=="waitedCall"||ae=="waitedParams"||ae=="loopCall"||ae=="rewindCall"||ae=="loopWaitCall"||ae=="rewindWaitCall"||ae=="startCall"||ae=="animateCall"||(D[ae]=t.Pick.choose(D[ae]));Et();function Et(){Je(),gt(),e.seriesTweens&&(e.seriesTweens[0]=z),S&&!lt&&(z=Jt(e,z,F,!0))}function Qt(){Je(),S&&!lt&&(z=Jt(e,z,F,!0))}function Je(){var Ee;e.zimLastObj||(e.zimLastObj={});for(ae in z){if(typeof z[ae]=="string"&&ae!="transform"){if(ae.substring&&ae.substring(0,1)=="."){if(z[ae].substr(0,1)=="+"||z[ae].substr(0,1)=="-")continue}else if(z[ae].substr(0,1)=="+")continue;if(z[ae].substr(0,3)=="rgb")continue;e.zimLastObj&&!n(e.zimLastObj[ae])?Ee=e.zimLastObj[ae]:Ee=e[ae],z[ae]=Ee+Number(z[ae].replace(/\s/g,""))}e.zimLastObj[ae]=E?e.zimTweenOriginals[ae]:z[ae]}}function gt(){var Ee;for(ae in F){if(typeof F[ae]=="string"&&ae!="transform"){if(ae.substring&&ae.substring(0,1)=="."){if(F[ae].substr(0,1)=="+"||F[ae].substr(0,1)=="-")continue}else if(F[ae].substr(0,1)=="+")continue;if(F[ae].substr(0,3)=="rgb")continue;e.zimLastObj&&!n(e.zimLastObj[ae])?Ee=e.zimLastObj[ae]:Ee=e[ae],F[ae]=Ee+Number(F[ae].replace(/\s/g,""))}e.zimLastObj[ae]=E?e.zimTweenOriginals[ae]:z[ae]}}e.getBounds&&n(e.percentCompleteCheck)&&(e.percentCompleteCheck=!0,e._percentComplete=0,Object.defineProperty(e,"percentComplete",{get:function(){if(e.paused)return e._percentComplete;if(e.tweenStartTime&&e.tweenEndTime){var Ee=Date.now(),it;return D.loop&&Ee>e.tweenEndTime?it=(Ee-e.tweenStartTime)%(e.tweenEndTime-e.tweenStartTime):it=Ee-e.tweenStartTime,Math.max(0,Math.min(100,it/(e.tweenEndTime-e.tweenStartTime)*100))}else return 0},set:function(Ee){this.zimTween?(sn=!0,Ot(Ee,!0)):this.requestedPercentComplete=Ee,e._percentComplete=Ee}}),Object.defineProperty(e,"percentCompleteNoAngle",{get:function(){if(e.tweenStartTime&&e.tweenEndTime){var Ee=Date.now(),it;return D.loop&&Ee>e.tweenEndTime?it=(Ee-e.tweenStartTime)%(e.tweenEndTime-e.tweenStartTime):it=Ee-e.tweenStartTime,Math.max(0,Math.min(100,it/(e.tweenEndTime-e.tweenStartTime)*100))}else return 0},set:function(Ee){this.zimTween?Ot(Ee,!1):this.requestedPercentComplete=Ee,e._percentComplete=Ee}})),Object.defineProperty(e,"rate",{get:function(){return e.futureRate},set:function(Ee){e.futureRate=Ee,t.loop(e.zimTweens,function(it,ct){ct.timeScale=Ee})},configurable:!0});function Ot(Ee,it){e.zimTween.startPaused=!1,B?n(e.zimTween.currentTime)||(e.zimTween.currentTime=e.zimTween.currentTime-e.zimTween.position+Ee*e.zimTween.duration/100):e.zimTweens?t.loop(e.zimTweens,function(ct,pt,Rt){var Ft=e.tweenStartTime+(e.tweenEndTime-e.tweenStartTime)*Ee/100,pn;pt.zimLoop&&Ft<=pt.startTime?pn=0:pt.zimLoop&&Ft>pt.startTime+pt.duration?pn=(Ft-pt.startTime)%pt.duration:pn=Ft-pt.startTime,pt.percentComplete=Math.max(0,Math.min(100,pn/pt.duration*100))}):e.zimTween.setPosition(Math.round(Ee*e.zimTween.duration/100)),it&&mt&&z.orient!==!1&&mt.getCurvePoint&&(e.rotation=mt.getCurvePoint(e.pathRatio,null,null,!0).angle+(An||0)),sn&&typeof ht<"u"&&(ht=Ee),e.handlePath&&e.handlePath()}var mt,_t,vt,Lt;if(!n(z.path)&&z.path.segmentPoints){n(z.orient)&&(z.orient=!0),z.orient&&n(z.flip)&&(z.flip=!0),e.type=="Pen"&&(e.infinite=!0),e.zimOnPath=!0,n(e.pathRatio)&&(e.pathRatio=0),z.orient&&(z.orient=z.path,z.startOrient=z.rotation),mt=z.path,N?(delete z.path,delete z.percent,(dt&&e.startPercent&&e.startPercent>0||e.percent&&e.percent!=100)&&tt("ZIM.animate() - startPercent and percent currently not supported with drag on path"),_t=mt.getCurvePoint(e.pathRatio,yt,Lt),_t&&(vt=e.parent.globalToLocal(_t.x,_t.y),e.x=vt.x,e.y=vt.y)):(n(e.startPercent)&&(e.startPercent=t.Pick.choose(n(z.startPercent)?0:z.startPercent)),n(e.percent)&&(e.percent=t.Pick.choose(n(z.percent)?100:z.percent)),delete z.path,delete z.percent);var Vt=!mt.lockControls;delete z.path,z.pathRatio=1}function Jt(Ee,it,ct,pt){lt=!0,mt&&(!n(Ee.percentComplete)||ct&&!n(ct.percentComplete))&&(ct||(ct={}),n(ct.pathRatio)&&(ct.pathRatio=n(ct.percentComplete)?Ee.percentComplete/100:ct.percentComplete/100));var Rt={};for(ae in it)ct&&!n(ct[ae])?Rt[ae]=ct[ae]:Rt[ae]=Ee[ae],pt&&(Ee[ae]=it[ae]);return Rt}var tn=!0,Zt=!1,an=!0,zt=!0;n(z.redirect)||(zt=z.redirect,delete z.redirect);function yn(Ee){var it=mt.globalToLocal(Ee.rawX/t.scaX,Ee.rawY/t.scaY),ct=en;mt.type=="Blob"&&(Tn[0]<Tn[4]?$t=!0:Tn[0]>Tn[4]&&($t=!1),ct<10&&!$t?(En=en=ct=Bt-5,Zn.immediate(En/Bt*100),Tn=[Bt-1,Bt-2,Bt,Bt-3,Bt-4]):ct>Bt-10&&$t&&(En=en=ct=5,Zn.immediate(En/Bt*100),Tn=[0,0,0,0,0]));var pt={x:it.x,y:it.y,r:ct};hn.sort(function(Rt,Ft){var pn={x:Rt.x,y:Rt.y,r:Rt.r*Bt},kn={x:Ft.x,y:Ft.y,r:Ft.r*Bt},Xn=Math.sqrt(Math.pow(pt.x-pn.x,2)+Math.pow(pt.y-pn.y,2)+Math.pow(pt.r-pn.r,2)),tr=Math.sqrt(Math.pow(pt.x-kn.x,2)+Math.pow(pt.y-kn.y,2)+Math.pow(pt.r-kn.r,2));return Xn-tr}),En=hn[0].r*Bt,ht=En/Bt*100,ht=t.constrain(ht,0,99.95),E&&(ht/=2,xe.position>xe.duration/2&&(ht=100-ht))}if(mt){var yt;Vt||(Lt=t.copy(mt.segmentPoints),yt=t.copy(mt.segmentRatios)),e.currentPercent=e.startPercent+e.percent*e.pathRatio;var je=(1e6+e.currentPercent)%100/100;if(_t=mt.getCurvePoint(je,yt,Lt),e.parent&&_t&&(vt=e.parent.globalToLocal(_t.x,_t.y),e.x=vt.x,e.y=vt.y),N){l="linear",e.cur("pointer");var ht=e.percentComplete,Gt=!1,Kt=!0,$t=!0,Ut=ht,Tt=10;Lt=t.copy(mt.segmentPoints);var Bt=0;t.loop(Lt,function(Ee){Bt+=t.distanceAlongCurve(Ee)});var gn=Math.round(Bt/Lt.length/Tt),hn=mt.interpolate(gn,null,!0,null,!0),en=(ht||0)/100*Bt,En=en;mt.zimAnimateChanged=!1,e.zimAnimatePathChange=mt.on("change",function(){mt.zimAnimateChanged=!0}),e.zimAnimatePathDown=mt.on("mousedown",function(){Gt=!0,e.paused==!0&&(Zt=!0)}),e.zimAnimatePathUp=mt.on("pressup",function(){Zt=!1}),e.zimAnimateDragDown=e.on("mousedown",function(Ee){ut=Ee.target.stage,e.amu||(e.amu=ut.frame.on("mouseupplus",function(){Zt=!1})),ut.mouseMoveOutside=!0,tn=!1,an=!0,setTimeout(function(){tn=!0},50),Zt=!0,mt.zimAnimateChanged&&(Lt=t.copy(mt.segmentPoints),Bt=0,t.loop(Lt,function(ct){Bt+=t.distanceAlongCurve(ct)}),gn=Math.round(Bt/Lt.length/Tt),hn=mt.interpolate(gn,null,!0,null,!0)),mt.zimAnimateChanged=!1,ht=e.percentComplete,Zn.immediate(ht);var it=ht;E&&(xe.position>xe.duration/2?it=(100-ht)*2:it=ht*2),en=(it||0)/100*Bt,En=en});var rr=!1;e.zimAnimateDragPress=e.on("pressmove",function(Ee){rr=!0,yn(Ee)}),e.animateReturn=function(){if(!E){dt&&tt("animate() - animateReturn() needs rewind set to true");return}Kt=!1,$t=!1,e.percentComplete<50&&(e.percentComplete=100-e.percentComplete),e.pauseAnimate(!1)},e.zimAnimateDragUp=e.on("pressup",function(){e.paused==!1&&(Zt=!1),tn=!1,setTimeout(function(){tn=!0},50),Tn[0]<Tn[4]?$t=!0:Tn[0]>Tn[4]&&($t=!1),!e.paused&&E&&zt&&$t!=Kt&&(e.percentComplete=100-e.percentComplete,Kt=$t)});var Zn=new t.Damp(ht,.15),jn=0,ur=0,Tn=[0,0,0,0,0],sn=!1;e.zimDragAnimateTicker=t.Ticker.add(function(){var Ee;N&&(++ur%20&&(Tn.push(En),Tn.shift()),en=En,Gt&&(ht=e.percentComplete),Zt||an&&e.paused==!0?(Gt||sn||mt.type=="Blob"&&Math.abs(jn-ht)>(E?45:90)?(Gt=!1,Ee=ht,Zn.immediate(Ee),sn=!1):Ee=Zn.convert(ht),Math.abs(jn-Ee)>.1?(e.percentCompleteNoAngle=Ee,jn=Ee):(e.percentCompleteNoAngle=Ee,an=!1,rr=!1)):an=!1)},ut)}}var rn;if(z.orient){if(z.orient===!0){var ir=e.parent.localToGlobal(n(z.x)?e.x:z.x,n(z.y)?e.y:z.y);z.orient={x:ir.x,y:ir.y}}rn=z.orient,delete z.orient;var An=e.rotation;if(e.rotation=mt.getPointAngle(0)+An,rn!=mt){var ln;rn.parent?ln=rn.parent.localToLocal(rn.x,rn.y,e.parent):ln=e.parent.globalToLocal(rn.x,rn.y),e.rotation=t.angle(e.x,e.y,ln.x,ln.y)+An}}var zn=e.scaleX,Wn=e.scaleY,Bn=z.flip!=null?z.flip:!1,Nn=z.flipVertical!=null?z.flipVertical:!1,Dn=e.x,Mn=e.y,In=0;D.loop&&(n(D.count)||(In=D.count,delete D.count,ue=1));var Wt=0;D.loopWait&&(Wt=D.loopWait,x=D.loopWait,delete D.loopWait);var fn;D.loopCall&&(fn=D.loopCall,delete D.loopCall);var on=e;D.loopParams&&(on=D.loopParams,delete D.loopParams),j.TIMECHECK&&fe&&(et&&It(et,te),ge&&It(ge,te),f&&It(f,te),Fn&&It(Fn,te),Wt&&It(Wt,te),x&&It(x,te),D.rewindWait&&It(D.rewindWait,te),se&&It(se,te),Oe&&It(Oe,te)),te=="s"&&(et&&(et*=1e3),ge&&(ge*=1e3),f&&(f*=1e3),Fn&&(Fn*=1e3),Wt&&(Wt*=1e3),x&&(x*=1e3),D.rewindWait&&(D.rewindWait*=1e3),se&&(se*=1e3),Oe&&(Oe*=1e3));var xn=et;D.rewind&&(xn+=ge),e.zimTweenArgs={time:xn,wait:f,wait2:Fn,wait3:Wt,loopWait:x,rewindWait:D.rewindWait,seriesWait:se,sequenceWait:Oe};function bn(){if(Wt>0&&(e.waiting=!1),!!D.loop){if(K&&typeof K=="function"){var Ee=n(q)?e:q;K(Ee)}if(fn&&typeof fn=="function"&&fn(on||e),g){var it=t.Pick.choose(e.futureRate);n(e.futureRate)||(xe.timeScale=it);var ct;if(n(Dt.scale)||(ct=t.Pick.choose(Dt.scale)),!S&&xe.step&&xe.step.prev&&xe.step.prev.props){for(var pt in xe.step.prev.props)if(!(Re.indexOf(pt)>=0)){var Rt=t.Pick.choose(Dt[pt]);if(typeof Rt=="string"&&pt!="transform"&&Rt.substr(0,1)!="+"&&Rt.substr(0,1)!="-"){var Ft;e.zimLastObj&&!n(e.zimLastObj[pt])?Ft=e.zimLastObj[pt]:Ft=e[pt],Rt=Ft+Number(Rt.replace(/\s/g,""))}e.zimLastObj[pt]=E?e.zimTweenOriginals[pt]:Rt,E?(n(Dt[pt])||(xe.step.prev.props[pt]=Rt),pt=="scaleX"&&!n(ct)&&(xe.step.prev.props.scaleX=ct),pt=="scaleY"&&!n(ct)&&(xe.step.prev.props.scaleY=ct)):(n(Dt[pt])||(xe.step.props[pt]=Rt),pt=="scaleX"&&!n(ct)&&(xe.step.props.scaleX=ct),pt=="scaleY"&&!n(ct)&&(xe.step.props.scaleY=ct))}}}}}var Cn;D.loopWaitCall&&(Cn=D.loopWaitCall,delete D.loopWaitCall);var Kn=e;D.loopWaitParams&&(Kn=D.loopWaitParams,delete D.loopWaitParams);function Yn(){Cn&&typeof Cn=="function"&&Cn(Kn||e)}var Rn;D.startCall&&(Rn=D.startCall,delete D.startCall);var cr;D.startParams&&(cr=D.startParams,delete D.startParams);function dr(Ee){Ee.startCalled||(Ee.startCalled=!0,Rn&&typeof Rn=="function"&&Rn(cr||e))}function Un(Ee){e.latestTween=Ee,e.waiting?Ee.startTime=Date.now():Ee.startTime=hr,Ee.zimLoop=T,e.animating||e.pauseAnimate(!0),n(Ee.percentComplete)&&Object.defineProperty(Ee,"percentComplete",{get:function(){return this.position/this.duration*100},set:function(it){this.setPosition(it*this.duration/100)}})}var lr=Date.now();e.tweenStartTime||(e.tweenStartTime=lr),e.tweenEndTime||(e.tweenEndTime=lr);var hr=lr+(f||0)+(se||0),pr=hr+(xn||0);pr>e.tweenEndTime&&(e.tweenEndTime=pr);var gr=["ballisticIn","ballisticOut","ballisticInOut","snapIn","snapOut","snapInOut","slowmoIn","slowmoOut","slowmoInOut"];gr.indexOf(l)!=-1&&(l=vr(l));function vr(Ee){var it=[.4,.75,.9,.95],ct=[.99,-.69,.53,.014],pt=[1.18,.69,1,.96];return Ee=="ballisticIn"?Ee=nt(t.zimEase(it)):Ee=="ballisticOut"?Ee=nt(t.zimEase(it).reverse()):Ee=="ballisticInOut"?Ee=nt(t.zimEase(it,null,!0)):Ee=="snapIn"?Ee=nt(t.zimEase(ct)):Ee=="snapOut"?Ee=nt(t.zimEase(ct).reverse()):Ee=="snapInOut"?Ee=nt(t.zimEase(ct,null,!0)):Ee=="slowmoIn"?Ee=nt(t.zimEase(pt)):Ee=="slowmoOut"?Ee=nt(t.zimEase(pt).reverse()):Ee=="slowmoInOut"&&(Ee=nt(t.zimEase(pt,null,!0))),Ee}var vn,Hn,Jn;if(D.rewind&&(l&&(l instanceof Function?vn=nt(l.reverse()):(vn=l,vn.indexOf("InOut")==-1&&(vn.indexOf("Out")!=-1?vn=vn.replace("Out","In"):vn.indexOf("In")!=-1&&(vn=vn.replace("In","Out"))))),k&&(vn=k,gr.indexOf(vn)!=-1&&(vn=vr(vn)))),l instanceof Function)Hn=l;else{var mn="get"+l.charAt(0).toUpperCase()+l.slice(1),On=nt(Z),Pn=nt(de);(!n(On)||!n(Pn))&&Ne.Ease[mn]?(!n(Pn)&&n(On)&&(On=1),!n(On)&&n(Pn)&&(Pn=.3*1.5),Hn=Ne.Ease[mn](On,Pn)):Hn=Ne.Ease[l]}vn&&(vn instanceof Function?Jn=vn:(mn="get"+vn.charAt(0).toUpperCase()+vn.slice(1),On=nt(Z),Pn=nt(de),(!n(On)||!n(Pn))&&Ne.Ease[mn]?(!n(Pn)&&n(On)&&(On=1),!n(On)&&n(Pn)&&(Pn=.3*1.5),Jn=Ne.Ease[mn](On,Pn)):Jn=Ne.Ease[vn]));function li(){Fn>0&&(e.waiting=!1),yr&&typeof yr=="function"&&yr(Mr)}function ai(){Fn>0&&(e.waiting=!0),xr&&typeof xr=="function"&&xr(Ir)}function _r(Ee){Qt(),f>0?(e.waiting=!0,xe=e.zimTweens[h]=e.zimTween=Ne.Tween.get(e,{override:D.override}).wait(f,!0).call(function(){e.waiting=!1,f=0,Er(xe),c&&typeof c=="function"&&c(n(w)?e:w)}),xe.timeScale=e.futureRate,Ee&&wr(Ee,xe),Un(xe)):Er(Ee)}function Er(Ee){var it=Fr();e.set&&!S&&e.set(F),xe=e.zimTweens[h]=e.zimTween=Ne.Tween.get(e,D).call(dr).to(z,et,Hn).call(ai).wait(Fn,!0).call(li).to(it,ge,Jn).call(Nr).wait(Wt,!0).call(bn),xe.timeScale=e.futureRate,Ee&&wr(Ee,xe),Sr(),Un(xe)}function Xr(Ee){Qt(),f>0?(e.waiting=!0,xe=e.zimTweens[h]=e.zimTween=Ne.Tween.get(e,{override:D.override}).wait(f,!0).call(function(){f=0,e.waiting=!1,Pr(xe),c&&typeof c=="function"&&c(n(w)?e:w)}),xe.timeScale=e.futureRate,Ee&&wr(Ee,xe),Un(xe)):Pr(Ee)}function Pr(Ee){e.set&&!S&&e.set(F),xe=e.zimTweens[h]=e.zimTween=Ne.Tween.get(e,D).call(dr).to(z,et,Hn).call(Nr).wait(Wt,!0).call(bn),xe.timeScale=e.futureRate,Ee&&wr(Ee,xe),Sr(),Un(xe)}if(D.rewind){var Fn=0;delete D.rewind,E=!0,A=D.rewindWait,D.rewindWait&&(Fn=D.rewindWait,delete D.rewindWait);var yr;if(D.rewindCall){yr=D.rewindCall;var Mr=D.rewindParams;n(Mr)&&(Mr=e),delete D.rewindCall,delete D.rewindParams}var xr;if(D.rewindWaitCall){xr=D.rewindWaitCall;var Ir=D.rewindWaitParams;n(Ir)&&(Ir=e),delete D.rewindWaitCall,delete D.rewindWaitParams}se>0||Oe>0||f>0?se>0||Oe>0?(e.waiting=!0,xe=e.zimTweens[h]=e.zimTween=Ne.Tween.get(e,{override:D.override}).wait(se>0?se:0,!0).wait(Oe>0?Oe:0,!0).call(function(Ee){Ee.waiting=!1,Oe=se=0,_r(xe)}),xe.timeScale=e.futureRate,Un(xe)):_r():(Qt(),Er())}else se>0||Oe>0||f>0?se>0||Oe>0?(e.waiting=!0,xe=e.zimTweens[h]=e.zimTween=Ne.Tween.get(e,{override:D.override}).wait(se>0?se:0,!0).wait(Oe>0?Oe:0,!0).call(function(){Oe=se=0,e.waiting=!1,Xr(xe)}),xe.timeScale=e.futureRate,Un(xe)):Xr():(Qt(),Pr());function wr(Ee,it){it.zimIdSet=Ee.zimIdSet,it.zimObj=Ee.zimObj,it.zimTicker=Ee.zimTicker,it.zimExtraTickers=Ee.zimExtraTickers,it.requestID=Ee.requestID}xe.startPaused=le,xe.rewinding=!1,n(J)||(xe.timeScale=t.Pick.choose(J)),D.animateCall&&(X=D.animateCall,delete D.animateCall),D.animateParams&&(R=D.animateParams,delete D.animateParams);var ar;!d&&U&&(ft&&(e.pathRatio=e.percentComplete&&Math.round(e.percentComplete)!=100?e.percentComplete/100:0,e.percentCompleteNoAngle=Math.round(ft)!=100?ft:0),b&&!n(ye)&&ye.dispatchEvent?ar=t.Ticker.add(function(){ot&&e.updateEffects(),(mt||rn||Bn||Nn)&&er(),ye.dispatchEvent("animation")},ut):b&&e.dispatchEvent?ar=t.Ticker.add(function(){ot&&e.updateEffects(),(mt||rn||Bn||Nn)&&er(),e.dispatchEvent("animation")},ut):X&&typeof X=="function"?ar=t.Ticker.add(function(){ot&&e.updateEffects(),(mt||rn||Bn||Nn)&&er(),X(R||e)},ut):ar=t.Ticker.add(function(){ot&&e.updateEffects(),(mt||rn||Bn||Nn)&&er()},ut));function si(Ee){if(Array.isArray(Ee)){for(var it=0,ct=0,pt=Ee.length;ct<pt;ct++)it+=Ee[ct];return it}}var Or=[1,1,1],er=function(){if(!(!e.parent||xe.passive||xe.startPaused)){if(N&&E&&(Ut<50&&e.percentComplete>50||Ut>50&&e.percentComplete<50)&&(Kt=e.percentComplete<50),Ut=e.percentComplete,mt){if(Vt&&(Lt=mt.segmentPoints,yt=mt.segmentRatios),N)var Ee=mt.getCurvePoint(e.pathRatio,yt,Lt);else{e.currentPercent=e.startPercent+e.percent*e.pathRatio;var it=(1e6+e.currentPercent)%100/100;e.pathRatio==1&&(it+=e.percent>0?1:0),Ee=mt.getCurvePoint(it,yt,Lt)}if(Ee){var ct=e.parent.globalToLocal(Ee.x,Ee.y);e.x=ct.x,e.y=ct.y}}var pt=Math.abs(Dn-e.x),Rt=Math.abs(Mn-e.y),Ft=An==90||An==270||An==-90;Bn&&tn&&(Dn>e.x&&pt>.01&&t.sign(Ft?e.scaleY:e.scaleX)==t.sign(zn)||Dn<e.x&&pt>.01&&t.sign(Ft?e.scaleY:e.scaleX)!=t.sign(zn)||e.percentComplete<99&&e.percentComplete>1&&pt<.01&&Rt>.01&&t.sign(Ft?e.scaleY:e.scaleX)!=t.sign(zn))&&(Ft?e.scaleY*=-1:e.scaleX*=-1),Nn&&tn&&(Mn>e.y&&Rt>.01&&t.sign(Ft?e.scaleX:e.scaleY)==t.sign(Wn)||Mn<e.y&&Rt>.01&&t.sign(Ft?e.scaleX:e.scaleY)!=t.sign(Wn)||e.percentComplete<99&&e.percentComplete>1&&Rt<.01&&pt>.01&&t.sign(Ft?e.scaleX:e.scaleY)!=t.sign(Wn))&&(Ft?e.scaleX*=-1:e.scaleY*=-1);var pn;if(rn&&pt>.05||rn&&Rt>.05){if(mt==rn)pn=t.angle(Dn,Mn,e.x,e.y)+An;else{var kn;rn.parent?kn=rn.parent.localToLocal(rn.x,rn.y,e.parent):kn=e.parent.globalToLocal(rn.x,rn.y),pn=t.angle(e.x,e.y,kn.x,kn.y)+An}if(pn!=0&&(!e.paused||rr)){Bn&&Dn-e.x>.01&&(pn+=180);var Xn=pn;e.rotation=Math.round(Xn==An?e.rotation:Xn),E&&e.percentComplete>50&&!Bn&&(e.rotation+=180)}}if(N){var tr=e.x-Dn+e.y-Mn;Math.abs(tr)>2&&(Or.push(t.sign(tr)),Or.shift(),xe.forward=si(Or))}Dn=e.x,Mn=e.y}};(mt||rn||Bn||Nn)&&(e.handlePath=er),n(e.zimMaskDynamic)||e.zimMaskApply();function Nr(){if(e.seriesTweens&&e.seriesTweens.shift(),e.seriesCalls&&e.seriesCalls.shift(),e.seriesParams&&e.seriesParams.shift(),e.paused&&e.type!="Sprite"){a&&typeof a=="function"&&a(s);return}if(D.loop)if(In>0)if(ue<In){Wt>0&&(e.waiting=!0),Yn(),ue++;return}else E?e.set&&e.set(Fr()):e.set&&e.set(z);else{Wt>0&&(e.waiting=!0),Yn();return}if(G?br(h):e.pauseAnimate(!0,h),!D.loop&&K&&typeof K=="function"){var Ee=n(q)?e:q;K(Ee)}a&&typeof a=="function"&&a(s)}function Fr(){var Ee={};for(var it in z)if(d&&e.style)!n(F[it])&&!S?Ee[it]=F[it]:it=="transform"?Ee[it]=e.style[it]:Ee[it]=Qn(e.style[it]);else if(!n(F[it])&&!S)Ee[it]=F[it];else if(it.substr(0,1)=="."){for(var ct=it.split("."),pt=e,Rt=1;Rt<ct.length;Rt++)pt=pt[ct[Rt]];Ee[it]=pt}else Ee[it]=e[it];return Ee}function oi(Ee){if(e.zimBusy){for(var it in Ee)delete e.zimBusy[it];t.isEmpty(e.zimBusy)&&(e.zimBusy=null)}}var fi=!1;Sr();function Sr(){xe.zimObj=z,xe.zimTicker=ar,xe.zimPaused=fi,he&&(xe.zimIdSet=he),Ge&&(n(t.idSets)&&(t.idSets={}),n(t.idSets[Ge])?t.idSets[Ge]=[e]:t.idSets[Ge].indexOf(e)<0&&t.idSets[Ge].push(e)),t.animatedObjects||(t.animatedObjects=new t.Dictionary(!0)),t.animatedObjects.add(e,!0)}function br(Ee){if(e.tweenStates&&e.tweenStates[Ee]&&delete e.tweenStates[Ee],!(n(e.zimTweens)||n(e.zimTweens[Ee]))){e.zimX=null,e.zimY=null,oi(e.zimTweens[Ee].zimObj),e.zimTweens[Ee].paused=!0,Gr(Ee);var it=e.zimTweens[Ee].zimIdSet;if(!n(it)&&e.zimIdSets){var ct=e.zimIdSets[it];ct&&ct.splice(ct.indexOf(Ee),1),ct&&ct.length==0&&(delete e.zimIdSets[it],t.isEmpty(e.zimIdSets)&&delete e.zimIdSets)}if(e.type=="Pen"&&e.zimOnPath&&(e.stop(),e.zimOnPath=!1),delete e.zimTweens[Ee],e.zimLastObj=null,t.isEmpty(e.zimTweens)&&e.stopAnimate(null,null,null,!1,!0),!(e.zimTweens&&e.zimTweens[Ee]||e.zimIdSets&&e.zimIdSets[it||Ee])){if(t.idSets&&t.idSets[it||Ee]){t.idSets[it||Ee];var pt=t.idSets[it||Ee].indexOf(e);pt>=0&&t.idSets[it||Ee].splice(pt,1),t.idSets[it||Ee].length<=0&&(delete t.idSets[it||Ee],t.isEmpty(t.idSets)&&delete t.idSets)}}}}function Gr(Ee){-function(){var it=e.zimTweens[Ee].zimTicker;if(e.zimTweens[Ee].extraTickers)for(var ct=0;ct<e.zimTweens[Ee].extraTickers.length;ct++)t.Ticker.remove(e.zimTweens[Ee].extraTickers[ct]);e.zimTweens[Ee].requestID&&cancelAnimationFrame(e.zimTweens[Ee].requestID),it&&setTimeout(function(){it&&t.Ticker.remove(it),it=null},200)}()}function Cr(Ee,it){var ct=e.zimTweens[Ee];ct.paused=it,it!=ct.zimPaused&&(ct.zimPaused=it,it?ct.zimTicker&&(ct.zimAnimateTimeout=setTimeout(function(){t.Ticker.remove(ct.zimTicker)},200)):(ct.startPaused=!1,clearTimeout(ct.zimAnimateTimeout),ct.zimTicker&&(ct.zimTicker=t.Ticker.add(ct.zimTicker,ut))))}function Vr(Ee){for(var it=[],ct=0;ct<Ee.length;ct++)e.zimIdSets&&!n(e.zimIdSets[Ee[ct]])?it=it.concat(e.zimIdSets[Ee[ct]]):it.push(Ee[ct]);return it}(!e.stopAnimate||!e.stopAnimate.real)&&(e.stopAnimate=function(Ee,it,ct,pt,Rt){var Ft;if(e.dynamicAnimation=null,Rt&&N){e.pauseAnimate();return}if(n(Ee)&&(e.tweenStates={}),it)return e.endTween(null,Ee),e;if(n(pt)&&(pt=!0),e.pan==null&&(e.type!=null&&(e.paused=!0),e.animating=!1),e.type=="Pen"&&e.zimOnPath&&(e.stop(),e.zimOnPath=!1),n(ct)&&(ct=!0),pt&&N&&(mt&&mt.off("change",e.zimAnimatePathChange),e.off("mousedown",e.zimAnimateDragDown),e.off("pressmove",e.zimAnimateDragPress),e.off("pressup",e.zimAnimateDragUp),e.amu&&ut.frame.off("mouseupplus",e.amu),t.Ticker.remove(e.zimDragAnimateTicker)),n(Ee)){if(!ct)return e;e.zimBusy=null,Ne.Tween.removeTweens(e);for(Ft in e.zimTweens)Gr(Ft);e.zimTweens=null,e.zimIdSets=null,e.zimTween=null,t.idSets&&t.idSets[he||Ft]&&(delete t.idSets[he||Ft],t.isEmpty(t.idSets)&&delete t.idSets),t.animatedObjects.remove(e)}else{Array.isArray(Ee)||(Ee=[Ee]);var pn=Vr(Ee);for(Ft in e.zimTweens)e.zimTweens[Ft].requestID&&cancelAnimationFrame(e.zimTweens[Ft].requestID),ct&&pn.indexOf(Ft)>=0&&br(Ft,pt),!ct&&pn.indexOf(Ft)<0&&br(Ft,pt)}return e},e.stopAnimate.real=!0,e.pauseAnimate=function(Ee,it,ct,pt){var Rt;if(it=="pauseOnBlur"?it=null:n(it)&&(e.tweenStates={all:Ee===!1}),e.type=="Pen"&&(Ee===!1?e.zimOnPath&&(e.infinite=!0):e.stop()),Qr&&!pt){if(n(it))for(Rt in e.zimTweens)Cr(Rt,Ee);else e.pause(Ee,it);return e}if(n(Ee)&&(Ee=!0),Zt=!1,e.type!=null&&(e.paused=Ee),e.animating=!Ee,n(ct)&&(ct=!0),n(it)&&!ct)return e;if(n(it))for(Rt in e.zimTweens)Cr(Rt,Ee);else{Array.isArray(it)||(it=[it]);var Ft=Vr(it);for(Rt in e.zimTweens)ct&&Ft.indexOf(Rt)>=0&&(Cr(Rt,Ee),e.tweenStates[Rt]=!Ee),!ct&&Ft.indexOf(Rt)<0&&(Cr(Rt,Ee),e.tweenStates[Rt]=!Ee)}return e.type=="Sprite"&&(e.running||e.stop()),e}),le&&e.pauseAnimate(!0,h,null,!0);var Ln;for(z.extra&&(Ln=z.extra,delete z.extra,Array.isArray(Ln)||(Ln=[Ln])),ae=0;ae<Re.length;ae++){var mr=Re[ae];z[mr]&&(n(Ln)&&(Ln=[]),ui(mr,z[mr]),delete z[mr])}function ui(Ee,it){it===!0?Ln.push({outputProp:_e[Ee]}):Array.isArray(it)?Ln.push({outputProp:_e[Ee],outputMin:it[0],outputMax:it[1],inputMin:it[2],inputMax:it[3]}):Ln.push({outputProp:_e[Ee],outputMax:it})}if(Ln){e.zimStartScaleX=e.scaleX,e.zimStartScaleY=e.scaleY,xe.extraTickers=[];var Wr;for(ae=0;ae<Ln.length;ae++){var un=Ln[ae];n(un.inputObj)&&(un.inputObj=e),n(un.inputProp)&&(un.inputProp="y"),n(un.inputMin)&&(un.inputMin=0),n(un.inputMax)&&(un.inputMax=un.inputProp=="x"?ut.width:ut.height),n(un.outputObj)&&(un.outputObj=e),n(un.outputProp)&&(un.outputProp="scale"),n(un.outputMin)&&(un.outputMin=0),n(un.outputMax)&&(un.outputMax=un.outputMin+1),n(un.constrain)&&(un.constrain=!0);for(var _n in un)z[_n]=t.Pick.choose(z[_n]);un.outputProp=="percentSpeed"&&(B=!0),Wr=new t.Proportion(un.inputMin,un.inputMax,un.outputMin,un.outputMax,un.factor,un.outputRound);var Ur=function(){var Ee=un,it=Wr;return function(){var ct,pt=Ee.outputObj,Rt=Ee.inputObj[Ee.inputProp];if((Ee.inputProp=="x"||Ee.inputProp=="y")&&Ee.inputObj.parent){var Ft=Ee.inputObj.parent.localToGlobal(Rt,Rt);Rt=Ft[Ee.inputProp]}if(Ee.constrain?ct=t.constrain(it.convert(Rt),Ee.outputMin,Ee.outputMax):ct=it.convert(Rt),Number.isNaN(ct)&&(ct=Ee.outputMin!=null?Ee.outputMin:0),Ee.outputProp=="scale")pt.scaleX=t.sign(pt.scaleX)*ct,pt.scaleY=t.sign(pt.scaleY)*ct;else if(Ee.outputProp=="scaleX")pt.scaleX=t.sign(pt.scaleX)*ct;else if(Ee.outputProp=="scaleY")pt.scaleY=t.sign(pt.scaleY)*ct;else if(Ee.outputProp=="layer"){if(!pt.parent)return;var pn=t.constrain(Math.round(ct),0,pt.parent.numChildren-1);pn!=pt.parent.getChildIndex(pt)&&pt.parent.setChildIndex(pt,pn)}else Ee.outputProp=="percentSpeed"?pt[Ee.outputProp]=ct*100:pt[Ee.outputProp]=ct}}();Ur(),xe.extraTickers.push(t.Ticker.add(Ur,ut))}}var Qr;function qr(){if(xe.requestID=requestAnimationFrame(qr),!(!B||xe.startPaused&&e.percentSpeed==0)){xe.startPaused=!1,xe!=Zr&&(Zr=xe,xe.currentTime=0,e.pauseAnimate(!0,h,null,!0),e.type!=null&&(e.paused=!1),e.animating=!0,Lr=!Oe&&!se&&!f&&!In&&D.loop),Lr&&(xe.currentTime+=1e4*Br,xe.setPosition(xe.currentTime,!0),Lr=!1);var Ee=xe.currentTime+ci*e.percentSpeed/100;Dr&&f==0&&(Ee=t.constrain(Ee,0,Dr)),xe.currentTime=Ee,xe.setPosition(xe.currentTime),(mt||rn||Bn||Nn)&&er(),ut.update()}}if(B&&(e.dynamicAnimation=!0),B||e.zimAnimateDragDown){if(B){Qr=!0,e.pauseAnimate(!0,h,null,!0),e.type!=null&&(e.paused=!1),e.animating=!0,xe.currentTime=0;var Zr=xe;n(e.percentSpeed)&&(e.percentSpeed=xe.startPaused?0:100);var ci=1e3/60;xe.currentTime=0;var Lr=!Oe&&!se&&!f&&!In&&D.loop;re&&D.loop&&!In&&(re=!1);var Br=i+(E?_||i:0)+(A||0)+(x||0);Br*=te=="s"?1e3:1;var Kr=1;D.loop&&In&&(Kr=In);var Dr;re&&(Dr=Br*Kr),qr()}var Tr;e.pause=function(Ee,it){if(n(Ee)&&(Ee=!0),n(it)&&(it=0),Ee){if(e.zimAnimateDragDown&&(N=!1,e.cur("default"),mt&&mt.off("change",e.zimAnimatePathChange),e.off("mousedown",e.zimAnimateDragDown),e.off("pressmove",e.zimAnimateDragPress),e.off("pressup",e.zimAnimateDragUp),!B))return;Tr=e.percentSpeed,it>0?t.animate({target:e,props:{percentSpeed:0},override:!1,ticker:!1,time:it,call:function(){e.percentSpeed=0,e.type!=null&&(e.paused=!0),e.animating=!1,B=!1,e.dispatchEvent("pause")}}):(xe.startPaused=!1,e.percentSpeed=0,e.type!=null&&(e.paused=!0),e.animating=!1,B=!1,setTimeout(function(){e.dispatchEvent("pause")},10))}else{if(e.zimAnimateDragDown&&(N=!0,e.cur("pointer"),mt&&(e.zimAnimatePathChange=mt.on("change",e.zimAnimatePathChange)),e.zimAnimateDragDown=e.on("mousedown",e.zimAnimateDragDown),e.zimAnimateDragPress=e.on("pressmove",e.zimAnimateDragPress),e.zimAnimateDragUp=e.on("pressup",e.zimAnimateDragUp),!B&&le!=!1))return;Zt=!1,xe.currentTime=xe.position,it>0?t.animate({target:e,props:{percentSpeed:Tr},override:!1,ticker:!1,time:it,call:function(){e.percentSpeed=Tr,e.paused=!1,e.animating=!0,B=!0}}):(e.percentSpeed=Tr,e.type!=null&&(e.paused=!1),e.animating=!0,B=!0)}return e}}return e},t.stopAnimate=function(e,r){De("45.12");var i;if(n(e)){if(t.animatedObjects)for(i=t.animatedObjects.length-1;i>=0;i--)t.animatedObjects.objects[i].stopAnimate(null,r);return}if(Array.isArray(e)||(e=[e]),!!t.idSets)for(var l=0;l<e.length;l++){var a=e[l];if(t.idSets[a]){var s=t.idSets[a].length-1;for(i=s;i>=0;i--)t.idSets[a][i].stopAnimate(a,r)}}},t.stopZimAnimate=function(e){De("45.1"),t.stopAnimate(e)},t.pauseAnimate=function(e,r){De("45.22"),n(e)&&(e=!0);var i;if(n(r)||r=="pauseOnBlur"){if(t.animatedObjects)for(i=t.animatedObjects.length-1;i>=0;i--)t.animatedObjects.objects[i].pauseAnimate(e,r);return}if(Array.isArray(r)||(r=[r]),!!t.idSets)for(var l=0;l<r.length;l++){var a=r[l];if(t.idSets[a])for(i=t.idSets[a].length-1;i>=0;i--)t.idSets[a][i].pauseAnimate(e,a)}},t.pauseZimAnimate=function(e,r){De("45.2"),t.pauseAnimate(e,r)},t.wiggle=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I){var g="target, property, baseAmount, minAmount, maxAmount, minTime, maxTime, totalTime, type, ease, integer, id, startType, ticker, wait, pauseOnBlur",E;if(E=st(t.wiggle,arguments,g))return E;if(De("45.25"),n(e)||n(i)||n(l))return e;n(a)&&(a=l);var A=wt(s,null,40);n(s)&&(s=A=="s"?1:1e3),n(f)&&(f=s),It(f,A,40),n(T)&&(T="quadInOut"),n(p)&&(p=!1),n(x)&&(x=t.makeID()),n(w)&&(w="both"),n(P)&&(P="both"),n(m)&&(m=!0),n(v)&&(v=0),It(c,A,40),n(c)||(e.wiggleTimeout=setTimeout(function(){e.stopAnimate(x),e.dispatchEvent("wigglestop")},c*(A=="s"?1e3:1)));var y=0,C;function L(){var Y=t.rand(t.Pick.choose(s),t.Pick.choose(f),!1),_={},k={},$;k[r]=t.Pick.choose(i),w=="negative"||y==0&&P=="negative"?$=-t.rand(t.Pick.choose(l),t.Pick.choose(a),p):w=="positive"||y==0&&P=="positive"?$=t.rand(t.Pick.choose(l),t.Pick.choose(a),p):y==0?$=t.rand(t.Pick.choose(l),t.Pick.choose(a),p,!0):$=t.rand(t.Pick.choose(l),t.Pick.choose(a),p)*t.sign(C)*-1,_[r]=t.Pick.choose(i)+$,y==0&&(Y=Y/2),C=$,y++;var O=e.futureRate;w=="negative"||w=="positive"?t.animate({target:e,obj:_,set:k,ease:T,time:Y*2,wait:nt(v),rewind:!0,override:!1,call:L,id:x,ticker:!!e.stage,timeCheck:!1,pauseOnBlur:I}):t.animate({target:e,obj:_,ease:T,time:Y,wait:nt(v),override:!1,call:L,id:x,ticker:!!e.stage,timeCheck:!1,pauseOnBlur:I}),O&&(e.futureRate=O)}return e.addTo&&!e.stage?e.added(L):L(),e},t.loop=function(e,r,i,l,a,s,f,c){var w="obj, call, reverse, interval, step, start, end, immediate",T;if(T=st(t.loop,arguments,w))return T;if(t.zimLoopCheck||De("45.3"),t.zimLoopCheck=!0,n(e)||n(r))return;n(i)&&(i=!1),n(l)&&(l=0),(n(a)||a<=0)&&(a=1),n(c)&&(c=!0),e.constructor===Number&&(e=Number(e)),e.constructor===String&&(e=String(e));var p=typeof e=="number"?"number":e.constructor===Array?"array":e.constructor==={}.constructor?"object":e instanceof NodeList?"nodelist":typeof e=="string"?"string":e instanceof HTMLCollection?"htmlcollection":e.type&&e.type=="Dictionary"?"Dictionary":"invalid";if(p=="container"&&!e.addChild)return;var x,P,m,v;if(p=="number"||p=="string"||p=="array"||p=="nodelist"||p=="htmlcollection"||p=="Dictionary"){if(p=="Dictionary"){var I=t.copy(e.values);e=t.copy(e.objects)}if(x=p=="number"?e:e.length,m=E(x-1),m==0)return;if(i)if(l===0){for(P=s;P>=f;P-=a)if(p=="number"?v=r(P,m,s,f,e):p=="array"||p=="string"?v=r(e[P],P,m,s,f,e):p=="Dictionary"?v=r(e[P],I[P],P,m,s,f,e):v=r(e.item(P),P,m,s,f,e),typeof v<"u"&&v!="next")return v}else t.interval(l,function(A){if(P=A.count,c||P--,a&&(P*=a),P=s-P,p=="number"?v=r(P,m,s,f,e):p=="array"||p=="string"?v=r(e[P],P,m,s,f,e):p=="Dictionary"?v=r(e[P],I[P],P,m,s,f,e):v=r(e.item(P),P,m,s,f,e),v=="next")A.next();else if(typeof v<"u")return A.clear(),v},m,c);else if(l===0){for(P=s;P<=f;P+=a)if(p=="number"?v=r(P,m,s,f,e):p=="array"||p=="string"?v=r(e[P],P,m,s,f,e):p=="Dictionary"?v=r(e[P],I[P],P,m,s,f,e):v=r(e.item(P),P,m,s,f,e),typeof v<"u"&&v!="next")return v}else t.interval(l,function(A){if(P=A.count,c||P--,a&&(P*=a),p=="number"?v=r(P,m,s,f,e,A):p=="array"||p=="string"?v=r(e[P],P,m,s,f,e,A):p=="Dictionary"?v=r(e[P],I[P],P,m,s,f,e):v=r(e.item(P),P,m,s,f,e,A),v=="next")A.next();else if(typeof v<"u")return A.clear(),v},m,c);return!0}else if(p=="object"){x=0;var g=[];for(P in e)x++,g.push(P);if(m=E(x-1),m==0)return;if(i)if(l===0){for(P=s;P>=f;P-=a)if(v=r(g[P],e[g[P]],P,m,s,f,e),typeof v<"u"&&v!="next")return v}else t.interval(l,function(A){if(P=A.count,c||P--,a&&(P*=a),P=s-P,v=r(g[P],e[g[P]],P,m,s,f,e),v=="next")A.next();else if(typeof v<"u")return A.clear(),v},m,c);else if(l===0){for(P=s;P<=f;P+=a)if(v=r(g[P],e[g[P]],P,m,s,f,e),typeof v<"u"&&v!="next")return v}else t.interval(l,function(A){if(P=A.count,c||P--,a&&(P*=a),v=r(g[P],e[g[P]],P,m,s,f,e),v=="next")A.next();else if(typeof v<"u")return A.clear(),v},m,c);return!0}else{if(m=E(e.numChildren-1),m==0)return;if(i)if(l===0){for(P=s;P>=f;P-=a)if(v=r(e.getChildAt(P),P,m,s,f,e),typeof v<"u"&&v!="next")return v}else t.interval(l,function(A){if(P=A.count,c||P--,a&&(P*=a),P=s-P,v=r(e.getChildAt(P),P,m,s,f,e),v=="next")A.next();else if(typeof v<"u")return A.clear(),v},m,c);else if(l===0){for(P=s;P<=f;P+=a)if(v=r(e.getChildAt(P),P,m,s,f,e),typeof v<"u"&&v!="next")return v}else t.interval(l,function(A){if(P=A.count,c||P--,a&&(P*=a),v=r(e.getChildAt(P),P,m,s,f,e),v=="next")A.next();else if(typeof v<"u")return A.clear(),v},m,c);return!0}function E(A){return n(s)&&(s=i?A:0),n(f)&&(f=i?0:A),i&&f>s||!i&&s>f||(s<0&&f)<0||s>A&&f>A?0:(s=Math.max(0,Math.min(s,A)),f=Math.max(0,Math.min(f,A)),Math.floor((i?s-f:f-s)/a)+1)}},t.scaleTo=function(e,r,i,l,a,s,f){var c="obj, boundObj, percentX, percentY, type, boundsOnly, simple",w;if(w=st(t.scaleTo,arguments,c))return w;if(e.type=="AC"&&j.zdf)return j.zdf.ac("scaleTo",arguments),e;if(De("43"),n(r)&&(r=j.zdf&&j.zdf.stage?j.zdf.stage:null),n(e)||!e.getBounds||!e.getBounds())return Gn("zim methods - scaleTo(): please provide an object (with setBounds) to scale"),e;if(n(r)||!r.getBounds||!r.getBounds())return Gn("zim methods - scaleTo(): please provide a boundObject (with setBounds) to scale to"),e;n(i)&&(i=-1),n(l)&&(l=-1),i==-1&&l==-1&&(i=l=100,n(a)&&(a="fill")),n(a)&&(a="fit"),a=="smallest"?a="fit":a=="biggest"||a=="outside"||a=="largest"?a="fill":(a=="both"||a=="stretch")&&(a="full"),n(s)&&(s=!1),n(f)&&(f=!1);var T=r.getBounds().width*i/100*(s?1:r.scaleX),p=r.getBounds().height*l/100*(s?1:r.scaleY);(r.type=="Stage"||r.type=="StageGL")&&(T=r.width*i/100,p=r.height*l/100);var x,P;if(f)x=e.getBounds().height,P=e.getBounds().width;else{var m=t.boundsToGlobal(e);x=m.height/e.scaleX,P=m.width/e.scaleY,(isNaN(x)||isNaN(P)||x>5e3)&&(x=e.getBounds().height,P=e.getBounds().width)}if((i==-1||l==-1)&&a!="full")return i==-1?t.sca(e,p/x):t.sca(e,T/P),e;var v;return a=="full"?(e.scaleX=i!=-1?T/P:e.scaleX,e.scaleY=l!=-1?p/x:e.scaleY,e):(a=="fill"?v=Math.max(T/P,p/x):v=Math.min(T/P,p/x),t.sca(e,v),e)},t.fit=function(e,r,i,l,a,s){var f="obj, left, top, width, height, type",c;if(c=st(t.fit,arguments,f))return c;if(e.type=="AC"&&j.zdf)return j.zdf.ac("fit",arguments),e;if(De("46"),!(n(e)||!e.getBounds)){if(!e.getBounds()){tt("zim methods - fit(): please setBounds() on object");return}if(n(r)){if(!e.stage){tt("zim methods - fit(): please add boundary dimensions or add obj to stage first");return}if(!e.stage.getBounds()){tt("zim methods - fit(): please add boundary dimensions or add obj with bounds to stage first");return}var w=e.stage.getBounds().width,T=e.stage.getBounds().height;r=0,i=0,l=w,a=T}s===!0?s="fit":s===!1&&(s="fill"),n(s)&&(s="fit"),e.scaleX=e.scaleY=1;var p=l,x=a,P=e.getBounds().width,m=e.getBounds().height,v,I,g,E,A;return s=="full"?(e.scaleX=g=p/P,e.scaleY=E=x/m,v=p,I=x):(s=="fit"?p/x>=P/m?A=x/m:A=p/P:s=="fill"&&(p/x>=P/m?A=p/P:A=x/m),g=E=A),e.scaleX=g,e.scaleY=E,v=P*g,I=m*E,e.x=(e.regX-e.getBounds().x)*g+r+(p-v)/2,e.y=(e.regY-e.getBounds().y)*E+i+(x-I)/2,{x:e.x,y:e.y,width:v,height:I,scale:A,scaleX:g,scaleY:E,bX:r,bY:i,bWidth:l,bHeight:a}}},t.boundsCheck=!1,t.boundsToGlobal=function(e,r,i,l,a){if(t.boundsCheck||(De("40"),t.boundsCheck=!0),!(n(e)||!e.getBounds)){if(n(i)&&(i=!1),a&&!e.getBounds&&!e.getBounds())return e;var s=e.getBounds();if(!s&&n(r)){tt(`zim methods - boundsToGlobal():
 please setBounds() on object (or a rectangle)`);return}r&&(s=r);var f,c,w,T;a&&a.type&&!(a.type=="Stage"||a.type=="StageGL")?(f=e.localToLocal(s.x,s.y,a),c=e.localToLocal(s.x+s.width,s.y,a),w=e.localToLocal(s.x+s.width,s.y+s.height,a),T=e.localToLocal(s.x,s.y+s.height,a)):i?(f=e.globalToLocal(s.x,s.y),c=e.globalToLocal(s.x+s.width,s.y),w=e.globalToLocal(s.x+s.width,s.y+s.height),T=e.globalToLocal(s.x,s.y+s.height)):(f=e.localToGlobal(s.x,s.y),c=e.localToGlobal(s.x+s.width,s.y),w=e.localToGlobal(s.x+s.width,s.y+s.height),T=e.localToGlobal(s.x,s.y+s.height));var p=Math.min(f.x,c.x,w.x,T.x),x=Math.min(f.y,c.y,w.y,T.y),P=Math.max(f.x,c.x,w.x,T.x),m=Math.max(f.y,c.y,w.y,T.y);return new Ne.Rectangle(p,x,P-p,m-x)}},t.resetBounds=function(e,r,i,l,a,s){var f="obj, a, b, c, d, margin",c;if(c=st(t.resetBounds,arguments,f))return c;De("40.5");var w,T,p,x;return n(l)?(w=0,T=r,p=0,x=i):(w=r,T=l,p=i,x=a),n(x)&&(x=T),n(r)?e.setBounds(null):e.setBounds(w,p,T,x),s&&(i=e.getBounds(),i&&e.setBounds(i.x-s,i.y-s,i.width+s*2,i.height+s*2)),e},t.copyMatrix=function(e,r){return De("45.5"),e.x=r.x,e.y=r.y,e.scaleX=r.scaleX,e.scaleY=r.scaleY,e.regX=r.regX,e.regY=r.regY,e.rotation=r.rotation,e.skewX=r.skewX,e.skewY=r.skewY,e},t.duplicate=function(e,r){De("45.6");var i=e.clone(r);for(var l in e)if(Object.prototype.hasOwnProperty.call(e,l)&&i[l]==null){if(l=="parent"||l=="zimTouch")continue;i[l]=e[l]}return i},t.expand=function(e,r,i,l,a){var s="obj, padding, paddingV, paddingRight, paddingBottom",f;if(f=st(t.expand,arguments,s))return f;if(De("50"),n(e)||!e.getBounds||!e.getBounds())return tt("zim methods - expand(): please provide object with bounds set"),e;n(r)&&(r=20),n(i)&&(i=r);var c,w;!n(l)||!n(a)?(n(l)&&(l=r),n(a)&&(a=i),c=r,w=i):(c=l=r,w=a=i);var T=e.getBounds(),p=new t.Shape({style:!1});return p.graphics.f("rgba(0,0,0,.01)").r(T.x-c,T.y-w,T.width+c+l,T.height+w+a),e.hitArea=p,e},t.setSwipe=function(e,r){if(De("34"),n(e)||!e.on)return;e.zimNoSwipe=r?null:!0,e instanceof Ne.Container&&i(e);function i(l){for(var a=l.numChildren,s,f=0;f<a;f++)s=l.getChildAt(f),s.zimNoSwipe=e.zimNoSwipe,s instanceof Ne.Container&&i(s)}return e},t.setMask=function(e,r,i){if(De("50.1"),n(e)&&tt("zim methods - setMask(): please provide obj"),n(r))return a(),e;var l=e.stage||(j.zdf?j.zdf.stage:null);function a(){e.zimMask&&e.zimMask.parent&&e.zimMask.parent.removeChild(e.zimMask),e.zimMask=null,e.zimMaskTicker&&t.Ticker.remove(e.zimMaskTicker),e.mask=null}e.zimMaskOriginal&&e.zimMaskOriginal!=r&&a(),n(i)&&(i=r.type=="Blob"||!n(r.zimDown)||!n(r.transformControls)||!n(r.zimTouch)||!n(r.zimTweens),r.zimMaskDynamic=i),e.zimMaskOriginal=r;var s;function f(){if(i&&(!l||!r.stage))return e;if(s&&s.dispose&&s.dispose(),s=null,e.zimMask=r.zimMask=s=r.shape.clone(),t.copyMatrix(s,r),r.addChildAt(s,0),s.alpha=0,!e.parent){e.mask=s;return}var c=r.getConcatenatedMatrix().decompose(),w=e.parent.getConcatenatedMatrix().decompose();s.scaleX=c.scaleX/w.scaleX,s.scaleY=c.scaleY/w.scaleY,s.rotation=(c.rotation?c.rotation:0)-(w.rotation?w.rotation:0);var T=r.localToLocal(r.shape.x+r.regX,r.shape.y+r.regY,e.parent);s.x=T.x,s.y=T.y,e.mask=s}return r.zimMaskApply=function(){e.zimMaskTicker&&t.Ticker.remove(e.zimMaskTicker),e.zimMaskTicker=t.Ticker.add(f)},r&&r.shape?(f(),i&&r.zimMaskApply()):(s=r,e.mask=s),e},t.outline=function(e,r,i,l){var a="obj, color, size, boundsOnly",s;if(s=st(t.outline,arguments,a))return s;if(e.type=="AC"&&j.zdf)return j.zdf.ac("outline",arguments),e;if(De("47"),e.type&&e.type=="zimOultineShape")return dt&&tt("zim.outline() - warning, you are trying to outline an outline - do not outline in a loop"),e;if(n(e)||!e.getBounds)return tt("zim methods - outline(): please provide object with bounds set"),e;if(!e.getBounds())return tt("zim methods - outline(): please setBounds() on object"),e;if(!e.parent)return tt("zim methods - outline(): object should be on stage first"),e;if(n(r)&&(r="brown"),n(i)&&(i=2),i<=0){e.ZIMoutlineShape&&e.ZIMoutlineShape.parent.removeChild(e.ZIMoutlineShape),e.ZIMoutlineShapeC&&e.ZIMoutlineShapeC.parent.removeChild(e.ZIMoutlineShapeC),e.ZIMoutlineShape=e.ZIMoutlineShapeC=null;return}var f=e.getBounds(),c=e.ZIMoutlineShape=e.ZIMoutlineShape?e.ZIMoutlineShape:new t.Shape;c.type="zimOutlineShape";var w=e.ZIMoutlineShapeC=e.ZIMoutlineShapeC?e.ZIMoutlineShapeC:new t.Shape;w.type="zimOutlineShape";var T=e.parent;e.outlineToggled=!0,e.outlineToggle=function(C){return C===!0?(e.ZIMoutlineShape.visible=!0,e.ZIMoutlineShapeC.visible=!0):C===!1?(e.ZIMoutlineShape.visible=!1,e.ZIMoutlineShapeC.visible=!1):(e.ZIMoutlineShape.visible=!e.ZIMoutlineShape.visible,e.ZIMoutlineShapeC.visible=!e.ZIMoutlineShapeC.visible),e.outlineToggled=e.ZIMoutlineShape.visible,e};var p=e.localToLocal(f.x,f.y,T),x=e.localToLocal(f.x+f.width,f.y,T),P=e.localToLocal(f.x+f.width,f.y+f.height,T),m=e.localToLocal(f.x,f.y+f.height,T),v=e.localToLocal(0,0,T),I=c.graphics.c(),g=w.graphics.c();if(I.s(r).ss(i).mt(p.x,p.y).lt(x.x,x.y).lt(P.x,P.y).lt(m.x,m.y).lt(p.x,p.y).cp(),!l){var E=10,A=E+1;g.s("white").ss(i+2),g.mt(-A,0).lt(A,0),g.mt(0,-A).lt(0,A),g.s(r).ss(i),g.mt(-E,0).lt(E,0),g.mt(0,-E).lt(0,E),g.cp(),w.x=v.x,w.y=v.y,w.rotation=e.rotation,I.s("white").ss(i+2).dc(e.x,e.y,E+6),I.s(r).ss(i).dc(e.x,e.y,E+6)}e.parent.removeChild(c),e.parent.removeChild(w);var y=e.parent.getChildIndex(e);return e.parent.addChildAt(w,y+1),e.parent.addChildAt(c,y+1),c.mouseEnabled=!1,w.mouseEnabled=!1,e},t.blendmodes=function(e,r,i){De("47.05"),n(r)&&(r=1);var l=["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"];i===!1&&l.push("source-over","source-in","source-out","source-atop","destination-over","destination-in","destination-out","destination-atop","copy","xor");var a=0,s=t.interval(r,function(){var f=l[a%l.length];a++,e.ble(f),Rr(f),e.stage&&e.stage.update()});return e.on("mousedown",function(){s.pause(!s.paused)}),e},t.STYLE=null,t.ignore="ignore",t.getStyle=function(e,r,i,l){t.STYLECHECK||(De("50.34"),t.STYLECHECK=!0);var a=["tap","change","hold","noTap","noChange","noHold","pos","addTo","center","centerReg","reg","mov","move","drag","transform","gesture","mouse","expand","outline","bounds","animate","wiggle","cache"],s=j.STYLE||t.STYLE,f=s,c,w=!1;n(l)||(e=null,r=l,w=!0),s&&s.type&&typeof s.type=="string"&&(s.ttype=s.type,delete s.type);for(var T in s)c=s[T],T.match(/^[(A-Z)]/)?(s.type||(s.type={}),s.type[T]?s.type[T]=t.merge(s.type[T],c):s.type[T]=c,delete s[T]):c.constructor==={}.constructor&&T!="group"&&T!="type"&&!t.isPick(c)&&a.indexOf(T)==-1&&(s.group||(s.group={}),s.group[T]?s.group[T]=t.merge(s.group[T],c):s.group[T]=c,delete s[T]);n(f)?f={}:f=t.copy(f);var p;if(n(i))i={};else for(p=0;p<a.length;p++)delete i[a[p]];var x=i,P=f.type;if(P&&delete f.type,!n(r)&&!n(f.group)){var m=r.split(","),v={};for(p=0;p<m.length;p++){var I=m[p].trim();n(f.group[I])||(v=t.merge(v,f.group[I]))}delete f.group}w?!n(r)&&!n(v)&&(f=v):(!n(e)&&!n(P)&&!n(P[e])&&(f=t.merge(f,P[e])),!n(r)&&!n(v)&&(f=t.merge(f,v)));for(var g in f){if(x[g]){delete f[g];continue}if(c=a.indexOf(g)==-1&&!f.delayPick?t.Pick.choose(f[g]):f[g],c=="ignore"){delete f[g];continue}else c&&c.constructor==={}.constructor&&(c=t.copy(c,!0,!1));var E;for(var A in f)(E=A.match(/^(.+)gColor$/))&&(f[E[1]+"ackgroundColor"]=f[A],delete f[A]);f[g]=c}return f=t.merge(f,x),f.ttype&&!f.type&&(f.type=f.ttype,delete f.ttype),f.style===!1?{}:f},t.styleTransforms=function(e,r){var i=["visible","x","y","scale","scaleX","scaleY","rotation","alpha","skewX","skewY","blendMode"],l;if(r){for(r.add&&e.addTo(),r.addTo&&e.addTo(r.addTo===!0?null:r.addTo),l=0;l<i.length;l++)r[i[l]]!=null&&(e[i[l]]=t.Pick.choose(r[i[l]]));if((r.regX!=null||r.regY!=null)&&e.reg(n(r.regX)?DEFAULT:r.regX,n(r.regY)?DEFAULT:r.regY),r.bounds&&r.bounds.constructor==={}.constructor&&e.setBounds(r.bounds.x?r.bounds.x:0,r.bounds.y?r.bounds.y:0,r.bounds.width?r.bounds.width:100,r.bounds.height?r.bounds.height:100),r.center&&e.center(r.center===!0?null:r.center),r.centerReg&&e.centerReg(r.centerReg===!0?null:r.centerReg),r.reg!=null&&(r.reg.constructor==={}.constructor?e.reg(t.Pick.choose(r.reg.x),t.Pick.choose(r.reg.y),r.reg.still):e.reg(r.reg)),r.x!=null&&(r.loc?r.loc.x==null&&(r.loc.x=r.x):r.loc={x:r.x}),r.y!=null&&(r.loc?r.loc.y==null&&(r.loc.y=r.y):r.loc={y:r.y}),r.loc&&(r.loc.constructor==={}.constructor?e.loc(t.Pick.choose(r.loc.x),t.Pick.choose(r.loc.y)):e.loc(t.Pick.choose(r.loc))),r.pos)if(r.pos.constructor==={}.constructor)e.pos(t.Pick.choose(r.pos.x),t.Pick.choose(r.pos.y),t.Pick.choose(r.pos.horizontal),t.Pick.choose(r.pos.vertical),t.Pick.choose(r.pos.container),t.Pick.choose(r.pos.index),r.pos.add,t.Pick.choose(r.pos.reg),t.Pick.choose(r.pos.regX),t.Pick.choose(r.pos.regY));else{var a=t.Pick.choose(r.pos);(a=="left"||a=="top")&&e.pos(),a=="right"&&e.pos({horizontal:"right"}),a=="bottom"&&e.pos({vertical:"bottom"}),(a=="rightbottom"||a=="bottomright")&&e.pos({horizontal:"right",vertical:"bottom"}),a=="center"&&e.center()}if((r.mov||r.move)&&(r.move&&(r.mov=r.move),r.mov.constructor==={}.constructor?e.mov(t.Pick.choose(r.mov.x),t.Pick.choose(r.mov.y)):e.mov(t.Pick.choose(r.mov))),r.outline&&setTimeout(function(){e.outline(r.outline.constructor==={}.constructor?r.outline:null),e.stage&&e.stage.update()},20),r.drag&&e.drag(r.drag.constructor==={}.constructor?r.drag:{currentTarget:!0}),r.gesture&&e.gesture(r.gesture.constructor==={}.constructor?r.gesture:null),r.mouse===!1&&e.noMouse(),r.transform&&setTimeout(function(){e.transform(r.transform.constructor==={}.constructor?r.transform:null)},20),r.animate)for(Array.isArray(r.animate)||(r.animate=[r.animate]),l=0;l<r.animate.length;l++)-function(){var f=r.animate[l];f.constructor==={}.constructor&&setTimeout(function(){e.animate(f)},20)}();if(r.wiggle)for(Array.isArray(r.wiggle)||(r.wiggle=[r.wiggle]),l=0;l<r.wiggle.length;l++)-function(){var f=r.wiggle[l];f.constructor==={}.constructor&&setTimeout(function(){e.wiggle(f)},20)}();r.expand&&e.expand(r.expand===!0?null:r.expand),r.cache&&(r.cache.constructor==={}.constructor?r.cache.x?e.cache(t.Pick.choose(r.cache.x),t.Pick.choose(r.cache.y),t.Pick.choose(r.cache.x),t.Pick.choose(r.cache.y)):e.cache(t.Pick.choose(r.cache.width),t.Pick.choose(r.cache.height)):e.cache()),r.tap&&e.tap&&e.tap(r.tap),r.change&&e.change&&e.change(r.change),r.hold&&e.hold&&e.hold(r.hold),r.noChange&&e.noChange&&e.noChange(),r.noTap&&e.noTap&&e.noTap(),r.noHold&&e.noHold&&e.noHold();var s=j.STYLE||t.STYLE;s&&(s.once===!0||s.once==e.type)&&(j.STYLE?j.STYLE={}:t.STYLE={})}},t.Style={remembered:{},clear:function(){return j.STYLE&&(j.STYLE={}),t.STYLE&&(t.STYLE={}),t.Style},clearTypes:function(){var e=j.STYLE||t.STYLE;return delete e.types,t.Style},clearGroups:function(){var e=j.STYLE||t.STYLE;return delete e.groups,t.Style},remember:function(e){n(e)&&(e="default");var r=j.STYLE||t.STYLE;return r||(Pt?r=t.STYLE={}:r=j.STYLE={}),t.Style.remembered[e]=t.copy(r,!0),t.Style},clearRemembered:function(e){return n(e)?t.Style.remembered={}:delete t.Style.remembered[e],t.Style},recall:function(e){return n(e)&&(e="default"),j.STYLE?j.STYLE=t.Style.remembered[e]:t.STYLE=t.Style.remembered[e],t.Style},add:function(e){var r=j.STYLE||t.STYLE;return r||(Pt?r=t.STYLE={}:r=j.STYLE={}),j.STYLE?j.STYLE=t.merge(r,e):t.STYLE=t.merge(r,e),t.Style},addType:function(e,r){var i=j.STYLE||t.STYLE;return i||(Pt?i=t.STYLE={}:i=j.STYLE={}),i.type||(i.type={}),i.type[e]=r,t.Style},addGroup:function(e,r){var i=j.STYLE||t.STYLE;return i||(Pt?i=t.STYLE={}:i=j.STYLE={}),i.group||(i.group={}),i.group[e]=r,t.Style},remove:function(e){var r=j.STYLE||t.STYLE;return r||(Pt?r=t.STYLE={}:r=j.STYLE={}),delete r[e],t.Style},removeType:function(e){var r=j.STYLE||t.STYLE;return r||(Pt?r=t.STYLE={}:r=j.STYLE={}),r.type&&delete r.type[e],t.Style},removeGroup:function(e){var r=j.STYLE||t.STYLE;return r||(Pt?r=t.STYLE={}:r=j.STYLE={}),r.group&&delete r.group[e],t.Style}},t.PATH=null,t.TIME="seconds",t.TIMECHECK=!1,t.DIR="ltr",t.SEEDRAND=null,t.SEEDRANDCOUNT=0,t.ANIMATE=!0,t.OPTIMIZE=!1,t.ACTIONEVENT="mousedown",t.DEFAULTWIRE="currentValue",t.KEYFOCUS=null,t.POSREG=!1,t.DRAGALL=!1,t.MOBILE="default",t.Ticker={stages:null,myUpdate:null,alwaysList:new t.Dictionary,list:new t.Dictionary,wire:new t.Dictionary,setFPS:function(e,r){n(e)&&n(r)?(e=60,r=60):n(e)?e=60:n(r)&&(r=e),t.Ticker.framerate=Ne.Ticker.framerate=t.mobile()?e:r},setTimingMode:function(e){Ne.Ticker.timingMode=Ne.Ticker.RAF,e=="synched"&&(Ne.Ticker.timingMode=Ne.Ticker.RAF_SYNCHED),e=="timeout"&&(Ne.Ticker.timingMode=Ne.Ticker.TIMEOUT)},add:function(e,r){De("30");var i=t.Ticker;if(i.has(e,r))return e;if((n(r)||!r.update)&&(r=j.zdf.stage),n(e)||typeof e!="function"){tt("zim.Ticker.add() - only add functions");return}return i.list.at(r)?i.list.at(r).push(e):i.list.add(r,[e]),i.ticker||(i.ticker=Ne.Ticker.on("tick",i.call)),i.framerate||i.setFPS(),e},addWire:function(e,r){if(De("30"),n(r[0]))return e;var i=t.Ticker;i.wire.add(e,r);var l=r[0][r[1]];return r[4]&&(l=r[4](l,"from")),r[3]&&(e[r[6]]=r[7]=l),i.ticker||(i.ticker=Ne.Ticker.on("tick",i.call)),i.framerate||i.setFPS(),e},rawID:{},raw:function(e){De("30");var r=t.makeID("letters",7);return-function i(l){e(l),t.Ticker.rawID[r]=requestAnimationFrame(i)}(),r},removeRaw:function(e){cancelAnimationFrame(t.Ticker.rawID[e]),delete t.Ticker.rawID[e]},call:function(e){var r=t.Ticker,i,l,a,s=[];for(a=0;a<r.list.length;a++){i=r.list.objects[a],l=r.list.values[a];for(var f=0;f<l.length;f++)l[f](e);var c=!1;(r.alwaysList.at(i)||l.length>0&&(n(r.update)&&!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)||r.update))&&(c=!0),c&&s.indexOf(i)<0&&s.push(i)}for(a=r.wire.length-1;a>=0;a--){var w=r.wire.objects[a],T=r.wire.values[a];if(T){var p=w[T[6]];p!=T[7]&&(T[4]&&(p=T[4](p,"to",T[7])),T[0][T[1]]=T[7]=p,T[5]&&T[5](p),i=T[0].stage,i&&s.indexOf(i)<0&&s.push(i)),T[2]&&T[0]&&(p=T[0][T[1]],T[7]!=p&&(T[4]&&(p=T[4](p,"from",T[7])),w[T[6]]=T[7]=p,T[5]&&T[5](p),i=w.stage,i&&s.indexOf(i)<0&&s.push(i)))}}if(r.list.length==0)for(a=0;a<r.alwaysList.length;a++)i=r.alwaysList.objects[a],s.indexOf(i)<0&&s.push(i);var x=s.length;for(a=0;a<x;a++)s[a].update()},always:function(e){De("30");var r=t.Ticker;r.framerate||r.setFPS(),(n(e)||!e.update)&&(e=j.zdf.stage),r.alwaysList.add(e,!0),r.ticker||(r.ticker=Ne.Ticker.on("tick",r.call))},alwaysOff:function(e){var r=t.Ticker;(n(e)||!e.update)&&(e=j.zdf.stage),r.alwaysList.remove(e)},remove:function(e){var r=t.Ticker;if(n(e)||typeof e!="function"){tt("zim.Ticker - only remove functions");return}for(var i=0;i<r.list.length;i++){var l=r.list.values[i].indexOf(e);l>-1&&r.list.values[i].splice(l,1)}r.alwaysList.length>0||r.list.length>0||r.wire.length>0||(Ne.Ticker.off("tick",r.ticker),r.ticker=null)},removeAll:function(e){for(var r=t.Ticker,i,l=0;l<r.list.length;l++)i=r.list.objects[l],(n(e)||e===i)&&(r.list.values[l]=[]);r.alwaysList.length>0||r.list.length>0||r.wire.length>0||(Ne.Ticker.off("tick",r.ticker),r.ticker=null)},removeWire:function(e,r,i,l){var a=t.Ticker;if(n(e)&&n(r)&&n(i)&&n(l))a.wire.clear();else for(var s=a.wire.length-1;s>=0;s--){var f=a.wire.objects[s],c=a.wire.values[s];c&&(e&&f!=e||r&&c[0]!=r||i&&c[1]!=i||l&&c[6]!=l||(a.wire.objects.splice(s,1),a.wire.values.splice(s,1)))}a.alwaysList.length>0||a.list.length>0||a.wire.length>0||(Ne.Ticker.off("tick",a.ticker),a.ticker=null)},isUpdating:function(e){n(e)&&(e=j.zdf.stage);var r=!1,i=t.Ticker;return(i.alwaysList.at(e)||i.list&&i.list.values.at(e)&&i.list.values.at(e).length>0&&(n(i.update)&&!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)||i.update))&&(r=!0),r},has:function(e,r){return(n(r)||!r.update)&&(r=j.zdf.stage),t.Ticker.list&&t.Ticker.list.at(r)&&t.Ticker.list.at(r).indexOf(e)>=0},getFPS:function(){return Ne.Ticker.getMeasuredFPS()},dispose:function(e){for(var r=t.Ticker,i=0,l,a=r.list.length-1;a>=0;a--)l=r.list.objects[a],n(e)||e===l?(r.list.remove(e),r.alwaysList.remove(e)):i+=r.list.values[a].length;if(!(r.alwaysList.length>0))return i==0&&(Ne.Ticker.off("tick",r.ticker),r.ticker=null),!0}},t.Ticker.setFPS(),Object.defineProperty(t.Ticker,"update",{get:function(){return t.Ticker.myUpdate},set:function(e){var r=t.Ticker;typeof e!="boolean"&&(e=null),r.myUpdate=e,r.myUpdate===!1&&(cancelAnimationFrame(r.ticker),r.alwaysList=new t.Dictionary)}}),t.Pages=function(e,r,i,l,a,s,f,c,w){var T="pages, transition, speed, transitionTable, holder, arrowDisableColor, style, group, inherit",p;if(p=st(t.Pages,arguments,T,this))return p;De("71"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Pages",this.group=c;var x=f===!1?{}:t.getStyle(this.type,this.group,w),P=wt(i);if(n(e)&&(e=x.pages!=null?x.pages:[]),this.pages=e,n(r)&&(r=x.transition!=null?x.transition:"none"),n(i)&&(i=x.speed!=null?x.speed:P=="s"?.2:200),n(l)&&(l=x.transitionTable!=null?x.transitionTable:[]),this.transitionTable=l,n(s)&&(s=x.arrowDisableColor!=null?x.arrowDisableColor:t.grey),this.arrowDisableColor=s,n(a)&&(a=x.holder!=null?x.holder:null),n(a)&&j.zdf&&(a=j.zdf.stage),!a.getBounds||!a.getBounds()){tt(`zim controls - Pages():
holder object must have bounds set`);return}this.speed=i,this.active=!0;var m=this;m.transitioning=!1;var v=a.getBounds().width,I=a.getBounds().height,g,E;(r!="none"||l!=[])&&A();function A(){g=new Ne.Shape,g.graphics.f("black").r(0,0,v,I+1),E=new Ne.Shape,E.graphics.f("white").r(0,0,v,I+1)}var y=["left","right","up","down"],C,L,Y=!0,_;for(_=0;_<e.length;_++)C=e[_],C.constructor!={}.constructor&&(C=e[_]={page:e[_]}),C.swipe&&(Y=!1);for(_=0;_<e.length;_++){if(C=e[_],C.constructor!=={}.constructor&&(C=e[_]={page:e[_]}),Y){var k=e[_-1],$=e[_+1];C.swipe=[k?k.page:null,$?$.page:null]}K(C.page,C.swipe)}var O=this.page=e[0]?e[0].page:null;n(this.page)||(this.index=0),this.addChild(O),q(O),this.swipe=new t.Swipe(a);var X,R=!1,Q=this.swipe.on("swipe",function(D){if(m.active){var d=D.currentTarget.direction;if(d!="none"){var u="";d=="left"?u="right":d=="right"?u="left":d=="up"?u="down":d=="down"&&(u="up"),d=u;var o=y.indexOf(d);L=O.zimSwipeArray[o],X=[L,d,null,null,!0],m.page=O,m.nextPage=L,m.direction=d,m.dispatchEvent("swipe"),setTimeout(function(){R||m.go(L,d,null,null,!0)},50)}}});function K(D,d){n(D)||(D.zimHTMLList=new t.Dictionary,ne(D),D.zimSwipeArray=d||[],D.zimOriginalAlpha=D.alpha,D.parent&&D.parent.removeChild(C.page))}function q(D){if(!n(D))for(D.removedHTML=!1,_=0;_<D.zimHTMLList.length;_++)D.addChildAt(D.zimHTMLList.values[_].obj,D.zimHTMLList.values[_].depth)}function ne(D){if(!D.removedHTML){D.removedHTML=!0,D.zimHTMLList.clear();var d,u;for(u=0;u<D.numChildren;u++)if(d=D.getChildAt(u),d.type=="TextArea"||d.type=="Loader"||d.type=="Tag"){var o={obj:d,depth:D.getChildIndex(d)};D.zimHTMLList.add(d,o)}for(u=D.numChildren-1;u>=0;u--)d=D.getChildAt(u),(d.type=="TextArea"||d.type=="Loader"||d.type=="Tag")&&D.removeChild(d)}}this.addPage=function(D,d){K(D,d),m.pages.push({page:D}),O?D.parent&&D.parent.removeChild(D):(O=m.page=D,m.addChild(O))},this.removePage=function(D){ne(D),m.currentPage==D&&(m.removeChild(D),a.stage&&a.stage.update()),t.loop(m.pages,function(d,u){(d.page==D||d==D)&&m.pages.splice(u,1)},!0),D.zimSwipeArray=null},this.setSwipeArray=function(D,d){n(d)&&(d=[]);var u={page:D,swipe:d};u.page.zimSwipeArray=u.swipe?u.swipe:[]},this.pause=function(){R=!0},this.unpause=function(){R&&m.go(X[0],X[1],X[2],X[3],X[4])};var U=!0;this.go=function(D,d,u,o,S){if(typeof D=="number"){var F=m.pages[D];if(n(F))return;D=F.page}setTimeout(function(){R=!1},200);for(var h=[{x:v},{x:-v},{y:I},{y:-I}],b=[{x:0},{x:0},{y:0},{y:0}],ye=[{x:v/2,alpha:0},{x:-v/2,alpha:0},{y:I/2,alpha:0},{y:-I/2,alpha:0}],B=r,N=m.speed,re=0;re<m.transitionTable.length;re++)if(m.transitionTable[re][0]==O&&m.transitionTable[re][1]==D){B=m.transitionTable[re][2],n(m.transitionTable[re][3])||(N=m.transitionTable[re][3]);break}n(u)&&(u=B),n(o)&&(o=N),m.speed=o;function le(Me){Me[0].uncache(),Me[1].uncache(),m.transitioning=!1,m.dispatchEvent("pagetransitioned"),m.removeChild(m.lastPage),u=="fan"&&(d=="right"||d=="down"?(m.lastPage.rotation=0,m.lastPage.regY=0,m.lastPage.mov(0,-m.lastPage.height)):(m.page.rotation=0,m.page.regY=0,m.page.mov(0,-m.lastPage.height))),m.removeChild(g),m.removeChild(E),q(O),U=!0}function G(Me){m.removeChild(m.lastPage),t.animate(Me.shift(),{alpha:0},m.speed/2,null,le,Me)}if(m.direction=d,D==""||D==null)m.page=O,m.dispatchEvent("nothing");else if(typeof D=="string")m.page=O,m.dispatchEvent(D);else{if(D==O)return;n(d)&&(d="right");var z=y.indexOf(d);if(!U)return;U=!1,D.x=0,D.y=0,D.alpha=D.zimOriginalAlpha;var se,Oe=["pixelDark","pixelLight","pixelZIM","bubbleDark","bubbleLight","bubbleZIM","lineDark","lineLight","lineZIM"];if(Oe.indexOf(u)>=0){var J=u;se=!0,u="slide"}var pe=["explodeDark","explodeLight","explodeZIM"];if(pe.indexOf(u)>=0){var Z=u;se=!0,u="fade"}if(u.type=="Emitter"&&(se=u,u.horizontal||u.vertical?u="slide":u="fade"),m.transitioning=!0,u=="slide"?(D.x=-(h[z].x|0),D.y=-(h[z].y|0),D.cache(0,0,(v+1)/D.scaleX,(I+1)/D.scaleY),O.cache(0,0,(v+1)/O.scaleX,(I+1)/O.scaleY),m.addChild(D),m.addChild(O),t.animate(O,h[z],m.speed,null,le,[O,D]),t.animate(D,b[z],m.speed)):u=="reveal"?(D.cache(0,0,(v+1)/D.scaleX,(I+1)/D.scaleY),O.cache(0,0,(v+1)/O.scaleX,(I+1)/O.scaleY),m.addChild(D),m.addChild(O),t.animate(O,ye[z],m.speed,null,le,[O,D])):u=="fade"?(D.cache(0,0,(v+1)/D.scaleX,(I+1)/D.scaleY),O.cache(0,0,(v+1)/O.scaleX,(I+1)/O.scaleY),D.alpha=1,m.addChild(D),m.addChild(O),t.animate(O,{alpha:0},m.speed,null,le,[O,D])):u=="black"?(D.cache(0,0,(v+1)/D.scaleX,(I+1)/D.scaleY),O.cache(0,0,(v+1)/O.scaleX,(I+1)/O.scaleY),D.alpha=1,m.addChild(D),m.addChild(O),g.alpha=0,m.addChild(g),t.animate(g,{alpha:1},m.speed/2,null,G,[g,O,D])):u=="clear"?(D.cache(0,0,(v+1)/D.scaleX,(I+1)/D.scaleY),O.cache(0,0,(v+1)/O.scaleX,(I+1)/O.scaleY),D.alpha=0,m.addChild(D),m.addChild(O),t.animate(O,{alpha:0},m.speed/2),t.animate(D,{alpha:1},m.speed/2,null,le,[O,D],m.speed/2)):u=="white"?(D.cache(0,0,(v+1)/D.scaleX,(I+1)/D.scaleY),O.cache(0,0,(v+1)/O.scaleX,(I+1)/O.scaleY),D.alpha=1,m.addChild(D),m.addChild(O),E.alpha=0,m.addChild(E),t.animate(E,{alpha:1},m.speed/2,null,G,[E,O,D])):u=="fan"?(D.cache(0,0,(v+1)/D.scaleX,(I+1)/D.scaleY),O.cache(0,0,(v+1)/O.scaleX,(I+1)/O.scaleY),D.alpha=1,d=="right"||d=="down"?(m.addChild(D),m.addChild(O),O.regY=O.height,O.mov(0,O.height),t.animate(O,{rotation:-90},m.speed,null,le,[O,D])):(m.addChild(O),m.addChild(D),D.regY=O.height,D.mov(0,O.height),D.rotation=-90,t.animate(D,{rotation:0},m.speed,null,le,[O,D]))):(m.transitioning=!1,m.addChild(D),m.removeChild(O),U=!0),se){var de=z<2,V,fe;if(J||u=="slide"){J?(J=="lineDark"||J=="lineLight"?V=new t.Rectangle(de?30:v+5,de?I+5:30,J=="lineDark"?t.dark:t.white).alp(.2):J=="lineZIM"?V=new t.Rectangle(de?50:v+5,de?I+5:50,[t.green,t.yellow,t.orange,t.pink,t.blue]).alp(.5):J=="pixelDark"||J=="pixelLight"?V=new t.Rectangle(40,40,t.clear,J=="pixelDark"?t.dark:t.white,2).alp(.7):J=="pixelZIM"?V=new t.Rectangle(40,40,[t.green,t.yellow,t.orange,t.pink,t.blue]).alp(.7):J=="bubbleDark"||J=="bubbleLight"?V=new t.Circle(30,t.clear,J=="bubbleDark"?t.dark:t.white,2).alp(.7):J=="bubbleZIM"&&(V=new t.Circle(30,[t.green,t.yellow,t.orange,t.pink,t.blue]).alp(.7)),V.centerReg({add:!1}),J=="lineDark"||J=="lineLight"||J=="lineZIM"?fe=new t.Emitter({obj:V,life:.5,decayTime:.5,shrink:!1,force:0,gravity:0,width:0,startPaused:!0}):fe=new t.Emitter({obj:V,num:6,life:.5,decayTime:.5,width:de?0:v,height:de?I:0,vertical:de,horizontal:!de,startPaused:!0})):fe=se;var ke=[{x:0,y:I/2},{x:v,y:I/2},{x:v/2,y:0},{x:v/2,y:I}],oe=[{x:v,y:I/2},{x:0,y:I/2},{x:v/2,y:I},{x:v/2,y:0}];fe.centerReg(a).spurt(null,m.speed),fe.x=ke[z].x,fe.y=ke[z].y,t.animate(fe,oe[z],m.speed,null,function(){J&&fe.dispose()})}else(Z||u=="fade")&&(Z?(Z=="explodeDark"||Z=="explodeLight"?V=new t.Circle(150,Z=="explodeDark"?t.dark:t.white).alp(.5):Z=="explodeZIM"&&(V=new t.Circle(130,[t.green,t.yellow,t.orange,t.pink,t.blue]).alp(.7)),fe=new t.Emitter({obj:V,num:5,gravity:0,force:{min:20,max:40},life:.5,shrink:!1,decayTime:.5,startPaused:!0})):fe=se,fe.centerReg(a).spurt(null,m.speed*.35),fe.on("fizzed",function(){Z&&fe.dispose()}));a&&a.type!="Stage"&&a.type!="StageGL"&&fe.particles&&a.shape&&fe.particles.setMask(a.shape)}for(a&&a.shape&&fe&&fe.particles&&fe.particles.setMask(a.shape),ne(O),m.lastPage=O,m.page=D,m.index=-1,re=0;re<m.pages.length;re++){var Ce=m.pages[re].page;Ce==m.page&&(m.index=re)}u=="none"&&q(D),n(S)&&(S=!1),m.fromSwipe=S,m.dispatchEvent("page"),O=D,m.setArrows(e.index),a.stage&&a.stage.update()}},a&&a.shape&&(a.mouseChildren=!0,a.mouseEnabled=!0,m.setMask(a.shape)),this.resize=function(){v=a.getBounds().width,I=a.getBounds().height,(r!="none"||l!=[])&&A()},this.puff=function(D){for(var d=0;d<e.length;d++)m.addChild(e[d].page);m.addChild(O),D>0&&setTimeout(function(){m.settle()},D*(P=="s"?1e3:1))},this.settle=function(){m.removeAllChildren(),m.addChild(O),m.dispatchEvent("puffed")},this.disable=function(){m.active=!1},this.enable=function(){m.active=!0},this.arrows={},this.setArrows=function(){if(!t.isEmpty(m.arrows)){var D=m.pages[m.index];if(!(!D||!D.swipe)){var d=D.swipe,u=[t.LEFT,t.RIGHT,t.DOWN,t.UP];t.loop(u,function(o,S){d[S]?t.loop(m.arrows[o],function(F){if(F.setDisabled===!0){F.activate(!1,m.arrowDisableColor),F.setDisabled=null;return}F.enabled||F.activate(!0,F.arrowBackgroundColor)}):t.loop(m.arrows[o],function(F){if(F.setDisabled===!1){F.activate(!0,F.arrowBackgroundColor),F.setDisabled=null;return}F.enabled&&F.activate(!1,m.arrowDisableColor)})}),m.stage&&m.stage.update()}}},m.added(function(D){if(D.frame&&D.frame.scaling=="full"){if(!t.globalManager){var d=t.globalManager=new t.Manager;d.frame=D.frame,d.event=D.frame.on("resize",function(){d.resize()})}t.globalManager.add(m)}}),f!==!1&&t.styleTransforms(this,x),this.dispose=function(D,d,u){if(t.globalManager){var o=t.globalManager;o.remove(m),t.globalManager.items.length==0&&(o.frame.off("resize",o.event),o.dispose(),t.globalManager=null)}return m.swipe.off("swipe",Q),m.swipe.dispose(),u||this.zimContainer_dispose(!0),!0}},t.extend(t.Pages,t.Container,["clone","dispose"],"zimContainer",!1),t.Arrow=function(e,r,i,l,a,s,f,c,w,T,p){var x="backgroundColor, rollBackgroundColor, pages, direction, type, newPage, trans, speed, style, group, inherit",P;if(P=st(t.Arrow,arguments,x,this))return P;De("71.2"),this.group=T;var m=w===!1?{}:t.getStyle("Arrow",this.group,p);n(l)&&(l=m.direction!=null?m.direction:"right"),n(e)&&(e=m.backgroundColor!=null?m.backgroundColor:t.blue),this.arrowBackgroundColor=e,n(r)&&(r=m.rollBackgroundColor!=null?m.rollBackgroundColor:t.blue.lighten(.2)),this.arrowRollBackgroundColor=r,n(a)&&(a=m.type!=null?m.type:"triangle"),n(s)&&(s=m.newPage!=null?m.newPage:null),n(f)&&(f=m.trans!=null?m.trans:null),n(c)&&(c=m.speed!=null?m.speed:null);var v,I,g,E,A;a=="triangle"?(v=new t.Triangle(45,45,45,e,null,null,null,null,-7).rot(90),I=new t.Triangle(45,45,45,r,null,null,null,null,-7).rot(90)):a=="thick"?(v=new t.Shape,g=v.graphics.f(e).command,A="AhFBdIiWAAIAAi4ICWAAIAAh7IEhDWIkhDXg",v.p(A).reg(-4),I=new t.Shape,E=I.graphics.f(r).command,I.p(A).reg(-4)):a=="thin"?(v=new t.Shape,g=v.graphics.f(e).command,A="AhBCIIBZhbIjWAAIAAhVIDaAAIhdhfIA9g+IDDDFIAAAAIAAAAIjDDGg",v.p(A).reg(-4),I=new t.Shape,E=I.graphics.f(r).command,I.p(A).reg(-4)):a=="angle"&&(v=new t.Shape,g=v.graphics.f(e).command,A="AiNC5IC4i5Ii4i5IAxgxIDqDqIjqDrg",v.p(A).reg(-3),I=new t.Shape,E=I.graphics.f(r).command,I.p(A).reg(-3)),this.zimButton_constructor(50,50,"",t.clear,t.clear,null,null,null,null,null,null,null,null,null,null,null,v,I),this.type="Arrow";var y=this;if(this.activate=function(_,k){return n(_)&&(_=!0),n(k)&&(k=t.grey),k===!1||(_?(y.enabled=!0,k!==!1&&(a=="triangle"?(y.icon.color=y.arrowBackgroundColor,y.rollIcon.color=y.arrowRollBackgroundColor):(g.style=y.arrowBackgroundColor,E.style=y.arrowRollBackgroundColor))):(y.enabled=!1,k!==!1&&(a=="triangle"?(y.icon.color=k,y.rollIcon.color=k):(g.style=k,E.style=k)))),y},n(i)||i.type!="Pages")return;var C=(Pt?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click";n(i.arrows)&&(i.arrows={}),n(i.arrows[l])&&(i.arrows[l]=[]),i.arrows[l].push(this);var L=Y();L||this.activate(!1,i.arrowDisableColor);function Y(){var _=i.pages[i.index];if(!(!_||!_.page||!_.page.zimSwipeArray)){var k=_.page.zimSwipeArray;if(l=="left")return k[0];if(l=="right")return k[1];if(l=="up")return k[2];if(l=="down")return k[3]}}this.expand(),this.on(C,function(){if(!i.transitioning){var _=Y();_&&i.go(_,l,f,c)}}),w!==!1&&t.styleTransforms(this,m),this.clone=function(){return y.cloneProps(new t.Arrow(e,r,i,l,a,s,f,c,w,this.group,p))}},t.extend(t.Arrow,t.Button,"clone","zimButton",!1),t.HotSpots=function(e,r,i){var l="spots, local, mouseDowns",a;if(a=st(t.HotSpots,arguments,l,this))return a;De("72"),this.zimContainer_constructor(null,null,null,null,!1),this.type="HotSpots",n(r)&&(r=!0),n(i)&&(i=!1);var s=(Pt?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",f=this,c,w,T=f.hotSpots=[];n(e)&&(e=[]);for(var p=0;p<e.length;p++)x(e[p]);function x(m){var v=null;if(!Array.isArray(m.rect)){if(v=m.rect,!v){tt("zim controls - HotSpots(): HotSpot "+m.page+" "+m.rect+" button does not exist");return}m.rect=[v.x,v.y,v.width||1,v.height||1]}w=new t.HotSpot(m.page,m.rect[0],m.rect[1],m.rect[2],m.rect[3],m.call,m.callOver,m.callOut,r,m.talk),w.zimHSpage=m.page,w.button=v,T.push(w),w.on(s,P),v&&n(m.callOver)&&n(m.callOut)&&(w.spot.mouseEnabled=!1,w.spot.mouseChildren=!1,v.zimHScall=m.call,v.zimHSEvent=v.on(s,P,!0),i||(v.zimHSMDEvent=v.on("mousedown",function(I){I.stopImmediatePropagation()})),v.cur("pointer"))}function P(m){m.stopImmediatePropagation&&m.stopImmediatePropagation(),j.event&&(j.event.cancelBubble=!0),typeof m.currentTarget.zimHScall=="function"&&m.currentTarget.zimHScall(m)}this.add=this.addHotSpot=function(m,v,I,g,E,A){c={page:m,rect:v,call:I,callOver:g,callOut:E,talk:A},e.push(c),x(c)},this.show=function(){for(var m=0;m<T.length;m++)w=T[m],w.button||(w.spot.alpha=.2)},this.hide=function(){for(var m=0;m<T.length;m++)w=T[m],w.spot.alpha=0},this.remove=this.removeHotSpots=function(m,v){for(var I=e.length-1;I>=0;I--)c=e[I],w=T[I],v&&!Array.isArray(v)&&(v=[v.x,v.y,v.getBounds().width,v.getBounds().height]),(n(m)&&n(v)||n(v)&&m==c.page||n(m)&&t.arraysEqual(v,c.rect)||m==c.page&&t.arraysEqual(v,c.rect))&&(e.splice(I,1),w.button&&(w.button.off(s,w.button.zimHSEvent),w.button.zimHSEvent=null,i||(w.button.off("mousedown",w.button.zimHSMDEvent),w.button.zimHSMDEvent=null)),w.off(s,P),w.dispose(),T.splice(I,1))},this.dispose=function(){for(var m=0;m<T.length;m++)w=T[m],w.button&&(w.button.off(s,w.button.zimHSEvent),w.button.zimHSCall=null,w.button.zimHSEvent=null,i||(w.button.off("mousedown",w.button.zimHSMDEvent),w.button.zimHSMDEvent=null)),w.off(s,P),w.dispose();return!0}},t.extend(t.HotSpots,t.Container,"dispose","zimContainer",!1),t.HotSpot=function(e,r,i,l,a,s,f,c,w,T){var p="obj, x, y, width, height, call, callOver, callOut, local, talk",x;if(x=st(t.HotSpot,arguments,p,this))return x;if(De("73"),this.zimContainer_constructor(null,null,null,null,!1),this.type="HotSpot",n(e)||!e.addChild){tt(`zim controls - HotSpot():
Please pass in container object for obj`);return}if(!(e instanceof Ne.Container)){tt(`zim controls - HotSpot():
Objects passed in should be Containers`);return}if(n(r)||n(i)||n(l)||n(a)){tt(`zim controls - HotSpot():
Please pass in x, y, width, height`);return}n(w)&&(w=!0);var P=(Pt?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",m=l,v=a,I,g,E;if(w)I=new t.Point(r,i),g=l,E=a;else{I=e.globalToLocal(r,i);var A=e.globalToLocal(r+m,i+v);g=A.x-I.x,E=A.y-I.y}var y=new t.Shape(l,a);if(y.talk=n(T)?"HotSpot":T,y.alpha=0,y.graphics.f("black").dr(0,0,g,E),y.x=I.x,y.y=I.y,y.cur("pointer"),y.expand(0),this.spot=y,typeof s=="function")var C=y.on(P,function(_){s(_)});if(typeof f=="function")var L=y.on("mouseover",function(_){f(_)});if(typeof c=="function")var Y=y.on("mouseout",function(_){c(_)});e.addChild(y),this.show=function(){y.alpha=.5,e.stage&&e.stage.update()},this.hide=function(){y.alpha=0,e.stage&&e.stage.update()},this.dispose=function(){return C&&y.off(P,L),L&&y.off("mouseover",L),Y&&y.off("mouseout",Y),e.removeChild(y),y=null,!0}},t.extend(t.HotSpot,t.Container,"dispose","zimContainer",!1),t.Guide=function(e,r,i,l,a,s,f,c){var w="obj, vertical, pixels, hideKey, pixelKey, style, group, inherit",T;if(T=st(t.Guide,arguments,w,this))return T;De("76"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Guide",this.group=f;var p=s===!1?{}:t.getStyle(this.type,this.group,c);if(n(e)&&(j.zdf?e=j.zdf.stage:e="stage"),n(r)&&(r=p.vertical!=null?p.vertical:!0),e!="stage"&&(!e.addChild||!e.getBounds||!e.getBounds())){Gn("zim controls - Guide(): Please provide container with bounds for the obj (setBounds())");return}n(i)&&(i=p.pixels!=null?p.pixels:!(zdf&&zdf.scaling=="full")),n(l)&&(l=p.hideKey!=null?p.hideKey:"G"),n(a)&&(a=p.pixelKey!=null?p.pixelKey:"P");var x=this,P,m=80,v=26,I=m/6+m/2,g=v*2,E,A,y;r?(y=C("#00c5af","white","white"),y.shape.regX=m+m/6,y.shape.regY=v/2,y.label.x=-m/2-m/6):(y=C("#d61fa0","white","white"),y.shape.regX=m/2,y.shape.regY=v+v/4,y.label.y=-v*3/4);function C(U,D,d){var u=new t.Container({style:!1});return u.shape=new t.Shape,u.shape.graphics.s(D).ss(1).f(U).r(0,0,m,v),u.shape.alpha=.9,u.addChild(u.shape),u.label=new Ne.Text("10","16px arial",d),u.label.textAlign="center",u.label.textBaseline="middle",u.addChild(u.label),u.mouseChildren=!1,u.mouseEnabled=!1,u}var L;e!="stage"&&e.addChild(x);var Y=t.added(x,R),_=!1,k,$,O,X;function R(){if(e=="stage"?(L=x.stage,e=L):L=e.stage,L.frame&&L.frame.scaling=="full"){if(!t.globalManager){var U=t.globalManager=new t.Manager;U.frame=L.frame,U.event=L.frame.on("resize",function(){U.resize()})}t.globalManager.add(x)}e.addChild(x),k=e.getBounds().width,$=e.getBounds().height,r?(y.y=$/2,y.label.text="x:"+(x.pixels?Math.round(k*70/100):"70%")):(y.x=k/2,y.label.text="y:"+(x.pixels?Math.round($*70/100):"70%")),O=new t.Shape,x.addChild(O),r?O.x=k*.7:O.y=$*.7,_||(e.addChild(x),q()),L.off("stagemousemove",P),P=L.on("stagemousemove",K),L.update()}var Q={x:0,y:0};function K(U){var D,d;U?(D=e.globalToLocal(U.rawX/t.scaX,U.rawY/t.scaY),Q=D):D={x:Q.x,y:Q.y},i?r?(d=Math.round(Math.abs(D.x-O.x)),y.label.text="x:"+Math.max(0,Math.min(d,Math.round(k))),y.y=Math.max(g,Math.min(D.y,A))):(d=Math.round(Math.abs(D.y-O.y)),y.label.text="y:"+Math.max(0,Math.min(d,Math.round($))),y.x=Math.max(I,Math.min(D.x,E))):r?(d=Math.round(Math.abs(D.x-O.x)/k*100),y.label.text="x:"+Math.max(0,Math.min(d,100))+"%",y.y=Math.max(g,Math.min(D.y,A))):(d=Math.round(Math.abs(D.y-O.y)/$*100),y.label.text="y:"+Math.max(0,Math.min(d,100))+"%",y.x=Math.max(I,Math.min(D.x,E))),L&&L.update()}function q(){_=!0,k=e.getBounds().width,$=e.getBounds().height;var U;r?(U="ew-resize",X=new Ne.Rectangle(0,0,k,0)):(U="ns-resize",X=new Ne.Rectangle(0,0,0,$)),t.noDrag(O),setTimeout(function(){t.drag(O,X,null,U,U,null,null,!0)},500),L.mouseMoveOutside=!0,L.enableMouseOver(10),E=k-m*2/3,A=$-v-v,O.uncache();var D=O.graphics;r?(D.c().s("rgba(0,255,255,.1)").ss(20).mt(0,0).lt(0,$),D.f().s("white").ss(2).mt(0,0).lt(0,$),D.s("#00c5af").sd([20,20]).mt(0,0).lt(0,$).sd(),O.cache(-10,0,20,$)):(D.c().s("rgba(255,0,255,.1)").ss(20).mt(0,0).lt(k,0),D.f().s("white").ss(2).mt(0,0).lt(k,0),D.s("#d61fa0").sd([20,20]).mt(0,0).lt(k,0).sd(),O.cache(0,-10,k,20)),r?y.x=k:y.y=$,x.addChild(y)}Object.defineProperty(this,"pixels",{get:function(){return i},set:function(U){i=U,x.resize()}}),j.addEventListener("keydown",ne);function ne(U){U||(U=event),L&&(String.fromCharCode(U.keyCode)==l.toUpperCase()&&x.toggle(),String.fromCharCode(U.keyCode)==a.toUpperCase()&&(x.pixels=!x.pixels))}this.toggled=!0,this.toggle=function(U){return U===!0?x.visible=x.toggled=!0:U===!1?x.visible=x.toggled=!1:(x.visible=!x.visible,x.toggled=x.visible),L&&(L.off("stagemousemove",P),x.visible&&(P=L.on("stagemousemove",K,x)),L.update()),x},this.resize=function(){return x?(L&&(q(),K()),!0):!1},s!==!1&&t.styleTransforms(this,p),this.dispose=function(){if(!x)return!1;if(t.globalManager){var U=t.globalManager;U.remove(x),t.globalManager.items.length==0&&(U.frame.off("resize",U.event),U.dispose(),t.globalManager=null)}return t.noDrag(O),clearInterval(Y),x.removeAllChildren(),j.removeEventListener("keydown",ne),x.parent&&x.parent.removeChild(x),x=null,!0}},t.extend(t.Guide,t.Container,"clone","zimContainer",!1),t.Grid=function(e,r,i,l,a,s,f,c,w,T,p){var x="obj, color, pixels, hideKey, pixelKey, allowToggle, cache, numbers, style, group, inherit",P;if(P=st(t.Grid,arguments,x,this))return P;De("78"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Grid",this.group=T;var m=w===!1?{}:t.getStyle(this.type,this.group,p);if(n(e)&&(j.zdf?e=j.zdf.stage:e="stage"),n(r)&&(r=m.color!=null?m.color:t.black),e!="stage"&&(!e.addChild||!e.getBounds||!e.getBounds())){Gn("zim controls - Grid(): Please provide container with bounds for the obj (setBounds())");return}n(i)&&(i=m.pixels!=null?m.pixels:!(zdf&&zdf.scaling=="full")),n(l)&&(l=m.hideKey!=null?m.hideKey:"G"),n(a)&&(a=m.pixelKey!=null?m.pixelKey:"P"),n(s)&&(s=m.allowToggle!=null?m.allowToggle:!0),n(f)&&(f=m.cache!=null?m.cache:!0),n(c)&&(c=m.numbers!=null?m.numbers:!0);var v=this,I=10,g;this.mouseChildren=!1,this.mouseEnabled=!1;var E=80,A=26,y=v.numbersX=L("#dddddd",r,"#333333");y.shape.regX=E/2,y.shape.regY=-A/4,y.label.y=A*3/4;var C=v.numbersY=L("#dddddd",r,"#333333");C.shape.regX=-E/6,C.shape.regY=A/2,C.label.x=E/2+E/6,c||(y.visible=!1,C.visible=!1);function L(o,S,F){var h=new t.Container({style:!1});return h.shape=new Ne.Shape,h.shape.graphics.s(S).ss(1).f(o).r(0,0,E,A),h.shape.alpha=.9,h.addChild(h.shape),h.label=new Ne.Text("10","16px arial",F),h.label.textAlign="center",h.label.textBaseline="middle",h.addChild(h.label),h.mouseChildren=!1,h.mouseEnabled=!1,h}var Y=E/6+E/2,_=A*2,k,$;y.x=Y,C.y=_,y.label.text="x:0",C.label.text="y:0";var O;e!="stage"&&e.addChild(v);var X=t.added(v,Q),R=!1;function Q(){if(e=="stage"?(O=v.stage,e=O):O=e.stage,O.frame&&O.frame.scaling=="full"){if(!t.globalManager){var o=t.globalManager=new t.Manager;o.frame=O.frame,o.event=O.frame.on("resize",function(){o.resize()})}t.globalManager.add(v)}R||(d(),e.addChild(v)),O.off("stagemousemove",g),g=O.on("stagemousemove",q),O.update()}var K={x:0,y:0};function q(o){var S;o?(S=e.globalToLocal(o.rawX/t.scaX,o.rawY/t.scaY),K=S):S={x:K.x,y:K.y},i?(y.label.text="x:"+Math.max(0,Math.min(Math.round(S.x),Math.round(ne))),y.x=Math.max(Y,Math.min(S.x,k)),C.label.text="y:"+Math.max(0,Math.min(Math.round(S.y),Math.round(U))),C.y=Math.max(_,Math.min(S.y,$))):(y.label.text="x:"+Math.max(0,Math.min(Math.round(S.x/ne*100),100))+"%",y.x=Math.max(Y,Math.min(S.x,k)),C.label.text="y:"+Math.max(0,Math.min(Math.round(S.y/U*100),100))+"%",C.y=Math.max(_,Math.min(S.y,$))),O&&O.update()}var ne,U,D;function d(){R=!0,e&&e.getBounds&&(ne=e.getBounds().width,U=e.getBounds().height),O&&(O.mouseMoveOutside=!0,O.enableMouseOver(10)),k=ne-E*2/3,$=U-A-A,D=v.grid=new t.Container({style:!1}),v.addChild(D);var o=new Ne.Shape;D.addChild(o);var S=o.graphics;S.s(r).ss(1);var F=new Ne.Shape;D.addChild(F);var h;if(i){for(h=0;h<ne/I;h++)S.mt(h*I,0).lt(h*I,U);for(h=0;h<U/I;h++)S.mt(0,h*I).lt(ne,h*I);for(o.alpha=.3,S=F.graphics,S.s(r).ss(1),h=0;h<ne/(I*10);h++)S.mt(h*(I*10),0).lt(h*(I*10),U);for(h=0;h<U/(I*10);h++)S.mt(0,h*(I*10)).lt(ne,h*(I*10))}else{for(h=1;h<20+1;h++)S.mt(h*ne/20,0).lt(h*ne/20,U);for(h=1;h<20;h++)S.mt(0,h*U/20).lt(ne,h*U/20);for(o.alpha=.3,S=F.graphics,S.s(r).ss(1),h=1;h<10;h++)S.mt(h*ne/10,0).lt(h*ne/10,U);for(h=1;h<10;h++)S.mt(0,h*U/10).lt(ne,h*U/10)}var b=80;S.s("#FFFFFF").ss(8),S.mt(ne/2,U/2-b/2).lt(ne/2,U/2+b/2),S.mt(ne/2-b/2,U/2).lt(ne/2+b/2,U/2),S.s("#000000").ss(4),S.mt(ne/2,U/2-b/2).lt(ne/2,U/2+b/2),S.mt(ne/2-b/2,U/2).lt(ne/2+b/2,U/2),S.s(r).ss(f?3:2),S.dr(0,0,ne,U),F.alpha=.5,f&&D.cache(0,0,ne,U),v.addChild(y),v.addChild(C),O&&O.update()}Object.defineProperty(this,"pixels",{get:function(){return i},set:function(o){i=o,v.resize()}}),j.addEventListener("keydown",u);function u(o){o||(o=event),!(!O||!s)&&(String.fromCharCode(o.keyCode)==l.toUpperCase()&&v.toggle(),String.fromCharCode(o.keyCode)==a.toUpperCase()&&(v.removeChild(D),D=null,v.pixels=!v.pixels))}this.toggled=!0,this.toggle=function(o){return o===!0?v.visible=v.toggled=!0:o===!1?v.visible=v.toggled=!1:(v.visible=!v.visible,v.toggled=v.visible),O.off("stagemousemove",g),v.visible&&(g=O.on("stagemousemove",q,v)),O&&O.update(),v},this.resize=function(){return v?(v.removeChild(D),D=null,O&&(d(),q(),setTimeout(function(){v&&v.removeChild(D),D=null,d()},200)),!0):!1},w!==!1&&t.styleTransforms(this,m),this.dispose=function(){if(t.globalManager){var o=t.globalManager;o.remove(v),t.globalManager.items.length==0&&(o.frame.off("resize",o.event),o.dispose(),t.globalManager=null)}return clearInterval(X),v.removeAllChildren(),j.removeEventListener("keydown",u),v.parent&&v.parent.removeChild(v),v=null,!0}},t.extend(t.Grid,t.Container,"clone","zimContainer",!1),t.Wrapper=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_){var k="items, width, spacingH, spacingV, wrapperType, align, valign, alignInner, valignInner, flip, reverse, bottomFull, colSize, rowSize, height, minSpreadNum, minStretchNum, percentVoidH, offsetVoidH, percentVoidV, offsetVoidV, style, group, inherit",$=null;if($=st(t.Wrapper,arguments,k,this))return $;De("78.5"),this.group=Y;var O=L===!1?{}:t.getStyle("Wrapper",this.group,_);n(r)&&(r=O.width!=null?O.width:300),n(v)&&(v=O.height!=null?O.height:null),n(i)&&(i=O.spacingH!=null?O.spacingH:null),n(l)&&(l=O.spacingV!=null?O.spacingV:null),n(a)&&(a=O.wrapperType!=null?O.wrapperType:"spacing"),n(s)&&(s=O.align!=null?O.align:"left"),n(f)&&(f=O.valign!=null?O.valign:"top"),n(c)&&(c=O.alignInner!=null?O.alignInner:"left"),n(w)&&(w=O.valignInner!=null?O.valignInner:"bottom"),n(T)&&(T=O.flip!=null?O.flip:!1),n(p)&&(p=O.reverse!=null?O.reverse:!1),n(x)&&(x=O.bottomFull!=null?O.bottomFull:!1),n(P)&&(P=O.colSize!=null?O.colSize:100),n(m)&&(m=O.rowSize!=null?O.rowSize:null),n(i)&&(i=0),n(l)&&(l=0),n(I)&&(I=O.minSpreadNum!=null?O.minSpreadNum:2),n(g)&&(g=O.minStretchNum!=null?O.minStretchNum:3),n(E)&&(E=O.percentVoidH!=null?O.percentVoidH:0),n(A)&&(A=O.offsetVoidH!=null?O.offsetVoidH:0),n(y)&&(y=O.percentVoidV!=null?O.percentVoidV:0),n(C)&&(C=O.offsetVoidV!=null?O.offsetVoidV:0);var X=200,R=0,Q=0,K=0,q=r;this.items=[];var ne,U;a=="spread"?ne=!0:a=="stretch"&&(U=!0),this.zimContainer_constructor(r,X),this.type="Wrapper",s=="middle"&&(s="center"),f=="middle"&&(f="center"),c=="middle"&&(c="center"),w=="middle"&&(w="center");var D=this;this.add=function(u){return this.addAt(u,this.numChildren-1),D},this.addAt=function(u,o){return n(u)||((n(o)||o<0)&&(o=0),Array.isArray(u)||(u=[u]),t.loop(u,function(S,F){D.addChildAt(S,o+F)}),D.resize()),D},this.remove=function(u){return Array.isArray(u)||(u=[u]),t.loop(u,function(o){o&&o.removeFrom&&o.removeFrom()},!0),D.resize(),D},this.convert=function(u,o){var S=[];return u.loop(function(F){S.push(F),o&&F.cache()}),D.add(S),u.removeFrom(),D},this.resize=function(u,o){if(!D.preventResize){n(u)||(r=u),n(o)||(v=o),this.items2D=[],this.items=[],R=0,Q=0,K=0,n(E)&&(E=0),n(A)&&(A=0);var S=t.Pick.choose(E),F=t.Pick.choose(A);q=r*(100-S)/100,this.setBounds(q,X);var h=0,b=0,ye=0;D.cols=0,D.rows=0;var B=[],N=[0],re=null,le=0,G=null,z=t.Pick.choose(P);a!="column"&&(z=null);var se=t.Pick.choose(m),Oe=0,J,pe;t.loop(this,function(Me,te){x||T?Me.pos(h+(Me.marginRight?Me.marginRight:0),b+(Me.marginTop?Me.marginTop:0),t.RIGHT,T?t.TOP:t.BOTTOM):Me.pos(h+(Me.marginLeft?Me.marginLeft:0),b+(Me.marginTop?Me.marginTop:0)),Oe++,G=Me.boundsToGlobal();var ae=D.globalToLocal(G.x,G.y),we=D.globalToLocal(G.x+G.width,G.y+G.height);if(x||T?J=D.globalToLocal(G.x,G.y):J=D.globalToLocal(G.x+G.width,G.y+G.height),Me.wrapHeight=we.y-ae.y,Me.wrapWidth=we.x-ae.x,S){var ue=D.globalToLocal(G.x+Me.wrapWidth/2,G.y+Me.wrapHeight/2);Me.centerX=ue.x,Me.centerY=ue.y,ue=null}z?pe=z*Oe:x||T?pe=q-J.x+(Me.marginLeft?Me.marginLeft:0)+i:pe=J.x+(Me.marginRight?Me.marginRight:0)+i,Math.round(pe)-i>q&&(d(B,re,ye,le,z,S,F,!1),le=0,D.cols==0&&(D.cols=te),h=0,b+=ye+(se?0:t.Pick.choose(l)),ye=0,se=t.Pick.choose(m),S=t.Pick.choose(E),F=t.Pick.choose(A),Oe=0,D.items2D.push(t.copy(B)),D.rows++,N.push(b),B=[],x||T?Me.pos(h+(Me.marginRight?Me.marginRight:0),b+(Me.marginTop?Me.marginTop:0),t.RIGHT,T?t.TOP:t.BOTTOM):Me.pos(h+(Me.marginLeft?Me.marginLeft:0),b+(Me.marginTop?Me.marginTop:0)),S&&(G=Me.boundsToGlobal(),ue=D.globalToLocal(G.x+Me.wrapWidth/2,G.y+Me.wrapHeight/2),Me.centerX=ue.x,Me.centerY=ue.y,ue=null),Oe++,z?pe=0:(pe=(Me.marginLeft?Me.marginLeft:0)+Me.wrapWidth+(Me.marginRight?Me.marginRight:0)+t.Pick.choose(i),x||T?J.x=q-((Me.marginRight?Me.marginRight:0)+Me.wrapWidth):J.x=(Me.marginLeft?Me.marginLeft:0)+Me.wrapWidth)),B.push(Me),le+=Me.wrapWidth,h=pe,se?ye=se:ye=Math.max(ye,Me.wrapHeight+(Me.marginTop?Me.marginTop:0)+(Me.marginBottom?Me.marginBottom:0)),re=new t.Point(J.x,b+ye)},p&&x?!1:p||x),D.numChildren>0&&(D.cols==0&&(D.cols=D.numChildren),D.items2D.push(t.copy(B)),N.push(b),d(B,re,ye,le,z,S,F,!0),D.rows+=1);var Z=t.Pick.choose(f),de;n(Z)&&(Z="top"),x&&(de=b+ye-X,t.loop(this,function(Me){Me.mov(0,de)}),D.items2D.reverse(),t.loop(D.items2D,function(Me){Me.reverse()}));var V=t.Pick.choose(y),fe=t.Pick.choose(C);if(!n(V)){n(fe)&&(fe=0);var ke=b+ye,oe=ke*V/100,Ce=ke/2+fe/100*ke;t.loop(N,function(Me,te){if(Me>=Ce)return t.loop(D.items2D,function(ae){t.loop(ae,function(we){we.mov(0,oe)})},null,1,te),"break"})}return n(v)||(f=="bottom"?(de=v-(b+ye),t.loop(this,function(Me){Me.mov(0,de)})):(f=="center"||f=="middle")&&(de=(v-(b+ye))/2,t.loop(this,function(Me){Me.mov(0,de)}))),D.setBounds(null),G=D.getBounds(),G&&D.setBounds(0,G.y,r,G.height),t.loop(D.items2D,function(Me){t.loop(Me,function(te){D.items.push(te)})}),this.stage&&this.stage.update(),D}};function d(u,o,S,F,h,b,ye,B){var N=t.Pick.choose(s),re=t.Pick.choose(ne),le=t.Pick.choose(U),G=t.Pick.choose(T),z=t.Pick.choose(c),se=t.Pick.choose(w);n(N)&&(N="left"),n(se)&&(se="top"),n(z)&&(z="left"),G&&u.reverse();var Oe=((100-b)/100/2+ye/100)*r,J=r*b/100,pe=0,Z=!1,de,V;if(h){(x||T)&&u.reverse();var fe=q%h,ke=q/2+ye/100*q,oe=0,Ce=0,Me=Math.floor(q/h);D.rows!=0&&B&&(Z=!0),t.loop(u,function(Pe,ie){pe=0,z=="right"?Ce=h*ie+oe+h-Pe.wrapWidth:z=="center"||z=="middle"?Ce=h*ie+oe+(h-Pe.wrapWidth)/2:Ce=h*ie+oe,de=Pe.x,Pe.pos(Ce),V=Pe.x-de,Pe.centerX+=V,Pe.marginLeft&&(pe+=Pe.marginLeft),Pe.marginRight&&(pe-=Pe.marginRight);var be;N=="center"||N=="middle"?(be=Math.floor(q/h)-u.length,pe+=(fe+(be?be*h:0))/2):N=="right"&&(be=Math.floor(q/h)-u.length,pe+=fe+(be?be*h:0)),Pe.mov(pe),Pe.centerX+=pe}),N=="center"&&Z&&(u.length+Me)%2!=0&&(pe=(ke<=q/2?-1:1)*h/2,t.loop(u,function(Pe){Pe.mov(pe),Pe.centerX+=pe}))}else if(re||le){var te,ae;re?te=u.length?(q-F)/(u.length+1):0:le&&(te=u.length-1>0?(q-F)/(u.length-1):0),u.length<g&&D.rows!=0&&B&&(te=K,Z=!0),K=te;var we=0;if((x||T)&&u.reverse(),t.loop(u,function(Pe,ie){pe=0,de=Pe.x,Pe.pos(te*(ie+(re?1:0))+we),V=Pe.x-de,Pe.centerX+=V,Z||(Pe.marginLeft&&(pe+=Pe.marginLeft),Pe.marginRight&&(pe-=Pe.marginRight),Pe.mov(pe),Pe.centerX+=pe),we+=Pe.wrapWidth}),Z){pe=0;var ue=re?te:0;V=0,t.loop(u,function(Pe){if(N=="right")de=Pe.x,Pe.pos(ue,null,t.RIGHT),V=Pe.x-de,ue+=Pe.wrapWidth+te;else if(N=="center"){var ie=(q-(we+(u.length-1)*te))/2-(re?te:0);de=Pe.x,Pe.pos(ue+ie,null,t.RIGHT),V=Pe.x-de,ue+=Pe.wrapWidth+te}Pe.marginLeft&&(pe+=Pe.marginLeft),Pe.marginRight&&(pe-=Pe.marginRight),Pe.mov(pe),Pe.centerX+=V+pe},!0)}}else N=="center"?t.loop(u,function(Pe){pe=((x||T?0:r)-o.x)/2,(re||le)&&(Pe.marginLeft&&(pe+=Pe.marginLeft),Pe.marginRight&&(pe-=Pe.marginRight)),Pe.mov(pe),Pe.centerX+=pe}):(x||T)&&N=="left"?(ae=u[u.length-1].marginLeft,t.loop(u,function(Pe){pe=-o.x+(ae||0),re&&(pe+=Q),Pe.mov(pe),Pe.centerX+=pe})):!(x||T)&&N=="right"?(ae=u[u.length-1].marginRight,t.loop(u,function(Pe){pe=r-o.x-(ae||0),re&&(pe-=Q),Pe.mov(pe),Pe.centerX+=pe})):re&&re&&t.loop(u,function(Pe){pe=Q*(N=="right"?-1:1),Pe.mov(pe),Pe.centerX+=pe});b&&(Oe=(1/2+ye/100)*q,J=r*b/100,t.loop(u,function(Pe){h||le||re?N=="right"?Pe.centerX>q-Oe&&Pe.mov(J):N=="center"?Math.round(Pe.centerX)==Math.round(q/2+ye/100*q)?Pe.mov(J/2):Math.round(Pe.centerX)>Math.round(q/2+ye/100*q)&&Pe.mov(J):Pe.centerX>Oe&&Pe.mov(J):!(x||T)&&N=="right"?Pe.centerX<r-Oe&&Pe.mov(-J):!(x||T)&&N=="center"?Pe.centerX>r/2+ye/100*q?Pe.mov(J/2):Pe.mov(-J/2):(x||T)&&N=="right"?Pe.centerX>q-Oe&&Pe.mov(J):(x||T)&&N=="center"?Pe.centerX>q/2+ye/100*q&&Pe.mov(J):Pe.centerX>Oe&&Pe.mov(J)})),re&&(R+=te,Q=R/(D.rows+1)),se=="center"?t.loop(u,function(Pe){Pe.mov(0,(S-Pe.wrapHeight)/2*(x?-1:1))}):!x&&se=="bottom"?t.loop(u,function(Pe){Pe.mov(0,S-Pe.wrapHeight-(Pe.marginBottom?Pe.marginBottom:0))}):x&&se=="top"&&t.loop(u,function(Pe){Pe.mov(0,-(S-Pe.wrapHeight)+(Pe.marginTop?Pe.marginTop:0))})}Object.defineProperty(D,"spacingH",{get:function(){return i},set:function(u){i=u,this.resize()}}),Object.defineProperty(D,"spacingV",{get:function(){return l},set:function(u){l=u,this.resize()}}),Object.defineProperty(D,"wrapperType",{get:function(){return a},set:function(u){u=="spread"?ne=!0:ne=!1,u=="stretch"?U=!0:U=!1,a=u,this.resize()}}),Object.defineProperty(D,"align",{get:function(){return s},set:function(u){s=u,s=="middle"&&(s="center"),this.resize()}}),Object.defineProperty(D,"valign",{get:function(){return f},set:function(u){f=u,f=="middle"&&(f="center"),this.resize()}}),Object.defineProperty(D,"alignInner",{get:function(){return c},set:function(u){c=u,c=="middle"&&(c="center"),this.resize()}}),Object.defineProperty(D,"valignInner",{get:function(){return w},set:function(u){w=u,w=="middle"&&(w="center"),this.resize()}}),Object.defineProperty(D,"colSize",{get:function(){return P},set:function(u){P=u,a=="column"&&this.resize()}}),Object.defineProperty(D,"rowSize",{get:function(){return m},set:function(u){m=u,this.resize()}}),Object.defineProperty(D,"flip",{get:function(){return T},set:function(u){T=u,this.resize()}}),Object.defineProperty(D,"reverse",{get:function(){return p},set:function(u){p=u,this.resize()}}),Object.defineProperty(D,"bottomFull",{get:function(){return x},set:function(u){x=u,this.resize()}}),Object.defineProperty(D,"percentVoidH",{get:function(){return E},set:function(u){E=u,this.resize()}}),Object.defineProperty(D,"offsetVoidH",{get:function(){return A},set:function(u){A=u,this.resize()}}),Object.defineProperty(D,"percentVoidV",{get:function(){return y},set:function(u){y=u,this.resize()}}),Object.defineProperty(D,"offsetVoidV",{get:function(){return C},set:function(u){C=u,this.resize()}}),n(e)||D.add(e),L!==!1&&t.styleTransforms(this,O),this.clone=function(){var u=D.cloneProps(new t.Wrapper(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,this.style,this.group));return u}},t.extend(t.Wrapper,t.Container,"clone","zimContainer",!1),t.Tile=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O,X,R,Q,K,q,ne,U){var D="obj, cols, rows, spacingH, spacingV, unique, width, height, squeezeH, squeezeV, colSize, rowSize, align, valign, count, mirrorH, mirrorV, snapToPixel, clone, events, exact, scaleToH, scaleToV, scaleToType, backgroundColor, backing, backdropColor, backdropPadding, backdropPaddingH, backdropPaddingV, mat, style, group, inherit",d;if(d=st(t.Tile,arguments,D,this))return d;De("66.5"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Tile",this.group=ne;var u=q===!1?{}:t.getStyle(this.type,this.group,U);n(e)&&(e=u.obj!=null?u.obj:new t.Circle),n(r)&&(r=u.cols!=null?u.cols:1121),n(i)&&(i=u.rows!=null?u.rows:1121);var o;r==1121&&i==1121?r=i=o=3:r==1121?r=1:i==1121&&(i=1),n(s)&&(s=u.unique!=null?u.unique:!1),n(f)&&(f=u.width!=null?u.width:null),n(c)&&(c=u.height!=null?u.height:null),n(p)&&(p=u.colSize!=null?u.colSize:null),n(x)&&(x=u.rowSize!=null?u.rowSize:null),n(f)||(p=null),n(c)||(x=null),n(l)&&(l=u.spacingH!=null?u.spacingH:o?3:null),n(a)&&(a=u.spacingV!=null?u.spacingV:o?3:null);var S=l,F=a;(n(l)||!n(p)||!n(f))&&(l=0),(n(a)||!n(x)||!n(c))&&(a=0),n(w)&&(w=u.squeezeH!=null?u.squeezeH:!1),n(T)&&(T=u.squeezeV!=null?u.squeezeV:!1),n(P)&&(P=u.align!=null?u.align:"left"),n(m)&&(m=u.valign!=null?u.valign:"top"),n(v)&&(v=u.count!=null?u.count:s&&Array.isArray(e)?e.length:null),v===0&&(v=null,dt&&tt("ZIM Tile() - count parameter of 0 is ignored - see docs")),n(I)&&(I=u.mirrorH!=null?u.mirrorH:!1),n(g)&&(g=u.mirrorV!=null?u.mirrorV:!1),n(E)&&(E=u.snapToPixel!=null?u.snapToPixel:!0),E&&(e&&e.stage?e.stage.snapToPixelEnabled=!0:typeof elem<"u"&&j.zdf&&(j.zdf.stage.snapToPixelEnabled=!0)),n(A)&&(A=u.clone!=null?u.clone:s?!1:null),A==null&&(A=!(typeof e=="function"&&e.type!="series")),n(y)&&(y=u.events!=null?u.events:!0),n(L)&&(L=u.scaleToH!=null?u.scaleToH:null),n(Y)&&(Y=u.scaleToV!=null?u.scaleToV:null),n(_)&&(_=u.scaleToType!=null?u.scaleToType:null),n(k)&&(k=u.backgroundColor!=null?u.backgroundColor:null),n($)&&($=u.backing!=null?u.backing:null),n(O)&&(O=u.backdropColor!=null?u.backdropColor:null),n(X)&&(X=u.backdropPadding!=null?u.backdropPadding:null),n(R)&&(R=u.backdropPaddingH!=null?u.backdropPaddingH:n(O)?null:X||l),n(Q)&&(Q=u.backdropPaddingV!=null?u.backdropPaddingV:n(O)?null:X||a),(Q||R)&&(X=!0),n(K)&&(K=u.mat!=null?u.mat:!1);var h=this;h.cols=r=Math.round(r),h.rows=i=Math.round(i),h.spacingH=l,h.spacingV=a,h.squeezeH=w,h.squeezeV=T;var b=typeof P=="function",ye=typeof m=="function";h.align=b?"left":P,h.valign=ye?"top":m,h.mirrorH=I,h.mirrorV=g,h.items=[];var B,N=0,re=!1;e:for(var le=0;le<i;le++)for(var G=0;G<r;G++){if(N++,!n(v)&&N>v)break e;B=s?e[N-1]:t.Pick.choose(e),typeof B=="string"&&(B=j.asset(B).centerReg({add:!1}).clone()),n(B)&&(B=new t.Container(0,0,0,0)),A&&(le!=0||G!=0)&&(B=B.clone(C)),y&&B.on("change",function(he){var Ge=new Ne.Event("change");Ge.item=he.currentTarget,h.dispatchEvent(Ge)}),h.items.push(B),B.type=="AC"&&(re=!0),B.tileNum=N-1,B.tileCol=G,B.tileRow=le}re&&dt&&tt("ZIM Tile - assets must have dimensions for Tile");var z,se,Oe,J,pe,Z,de,V,fe,ke,oe,Ce,Me,te;function ae(){h.removeAllChildren(),z=[],se=[],Oe=[],J=[],pe=[],Z=0,de=0,V=0,fe=0,ke=[],oe=[],Ce=[],te=[],Me=[],(!h.items||!h.items.length)&&(h.items=[]),v=h.items.length;var he=0,Ge,qe,Fe=0,We=0,ce,Ve;for(qe=0;qe<v;qe++)Fe=Math.floor(qe/h.cols),We=qe%h.cols,n(z[Fe])&&(z[Fe]=[]),n(h.items[qe])&&(h.items[qe]=new t.Container(0,0,0,0)),z[Fe][We]=h.items[qe];h.rows=Math.max(1,z.length),h.cols=Math.max(1,n(z[0])?0:z[0].length);e:for(Fe=0;Fe<h.rows;Fe++)for(ke.push([]),oe.push([]),te.push([]),x&&n(c)&&(ce=t.Pick.choose(x)),qe=0;qe<h.cols;qe++){if(he++,!n(v)&&he>v)break e;Ge=z[Fe][qe],Ge.snapToPixel=E,h.addChild(Ge),ke[Fe].push(Ge.scaleX),oe[Fe].push(Ge.scaleY),p&&n(f)&&(Ve=t.Pick.choose(p)),Fe==0&&Me.push(t.Pick.choose(P)),(!p||!n(f))&&(Ve=Math.abs(Ge.width)),(!x||!n(c))&&(ce=Math.abs(Ge.height)),te[Fe][qe]=[Ve,ce],n(J[qe])&&(J[qe]=0),n(pe[Fe])&&(pe[Fe]=0),Ve>J[qe]&&(J[qe]=Ve),ce>pe[Fe]&&(pe[Fe]=ce),n(se[Fe])&&(se[Fe]=0),n(Oe[qe])&&(Oe[qe]=0),se[Fe]+=Ve,Oe[qe]+=ce,se[Fe]>Z&&(Z=se[Fe]),Oe[qe]>de&&(de=Oe[qe]),n(Ce[qe])&&(Ce[qe]=0),Ce[qe]++}var Se;if(h.squeezeH===!1)for(qe=0;qe<J.length;qe++)Se=J[qe],V+=Se;if(h.squeezeV===!1)for(qe=0;qe<pe.length;qe++)Se=pe[qe],fe+=Se}ae();var we=V,ue=fe,Pe,ie,be,Le,me=1,ee=1;function Ie(he,Ge){!n(O)&&X&&(he-=Math.max(R*2,0),Ge-=Math.max(Q*2,0)),he<=0&&(he=null),Ge<=0&&(Ge=null),!n(he)&&h.squeezeH=="full"?Pe=he:n(he)?V>0?Pe=V+(h.cols-1)*h.spacingH:Pe=Z+(h.cols-1)*h.spacingH:L?Pe=he:Pe=Math.max(Z+(h.cols-1)*h.spacingH,he),!n(Ge)&&h.squeezeV=="full"?ie=Ge:n(Ge)?fe>0?ie=fe+(h.rows-1)*h.spacingV:ie=de+(h.rows-1)*h.spacingV:Y?ie=Ge:ie=Math.max(de+(h.rows-1)*h.spacingV,Ge),h.setBounds(0,0,Pe,ie),me=(Pe-(h.cols-1)*S)/we,ee=(ie-(h.rows-1)*F)/ue;var qe,Fe;be=[],Le=[];var We=[];for(le=0;le<z.length;le++)for(qe=z[le],Fe=0,G=0;G<qe.length;G++){B=qe[G];var ce,Ve;if(le==0&&(be[G]=0,n(Ge)||(h.squeezeV=="full"?Le[G]=Ce[G]>1?(Ge-Oe[G])/(Ce[G]-1):0:h.squeezeV?Le[G]=Ce[G]>1?Math.max(h.spacingV,(Ge-Oe[G])/(Ce[G]-1)):0:Le[G]=Ce[G]>1?Math.max(h.spacingV,(ie-Oe[G])/(Ce[G]-1)):0),h.squeezeV?h.valign=="center"||h.valign=="middle"?We[G]=(ie-(Oe[G]+(Ce[G]-1)*(n(Ge)?h.spacingV:Le[G])))/2:h.valign=="bottom"?We[G]=ie-(Oe[G]+(Ce[G]-1)*(n(Ge)?h.spacingV:Le[G])):We[G]=0:We[G]=0),G==0){n(he)||(h.squeezeH=="full"?Ve=qe.length>1?(he-se[le])/(qe.length-1):0:h.squeezeH?Ve=qe.length>1?Math.max(h.spacingH,(he-se[le])/(qe.length-1)):0:Ve=qe.length>1?Math.max(h.spacingH,(Pe-se[le])/(qe.length-1)):0),h.squeezeH?h.align=="center"||h.align=="middle"?ce=(Pe-(se[le]+(qe.length-1)*(n(he)?h.spacingH:Ve)))/2:h.align=="right"?ce=Pe-(se[le]+(qe.length-1)*(n(he)?h.spacingH:Ve)):ce=0:ce=0;var Se=t.Pick.choose(m)}P=Me[G];var Ae=te[le][G][0],Ye=te[le][G][1];h.mirrorH&&G%2==1&&(B.scaleX=-ke[le][G]),B.pos(Fe,null),!h.squeezeH&&b?n(he)&&(P=="center"||P=="middle")?B.x+=(J[G]-B.width)/2:n(he)&&P=="right"&&(B.x+=J[G]-B.width):h.squeezeH?n(he)&&(h.align=="center"||h.align=="middle")?B.x+=(Ae-B.width)/2:n(he)&&h.align=="right"&&(B.x+=Ae-B.width):n(he)&&(h.align=="center"||h.align=="middle")?B.x+=(J[G]-B.width)/2:n(he)&&h.align=="right"&&(B.x+=J[G]-B.width),h.mirrorV&&le%2==1&&(B.scaleY=-oe[le][G]),B.pos(null,be[G]),!h.squeezeV&&ye?n(Ge)&&(Se=="center"||Se=="middle")?B.y+=(pe[le]-B.height)/2:n(Ge)&&Se=="bottom"&&(B.y+=pe[le]-B.height):h.squeezeV?n(Ge)&&(h.valign=="center"||h.valign=="middle")?B.y+=(Ye-B.height)/2:n(Ge)&&h.valign=="bottom"&&(B.y+=Ye-B.height):n(Ge)&&(h.valign=="center"||h.valign=="middle")?B.y+=(pe[le]-B.height)/2:n(Ge)&&h.valign=="bottom"&&(B.y+=pe[le]-B.height),h.squeezeH===!0||!n(he)?Fe+=Ae+(n(he)?h.spacingH:Ve):Fe+=J[G]+(n(he)?h.spacingH:Ve),B.x+=ce,B.y+=We[G],h.squeezeV===!0||!n(Ge)?be[G]+=Ye+(n(Ge)?h.spacingV:Le[G]):be[G]+=pe[le]+(n(Ge)?h.spacingV:Le[G])}}Ie(f,c),this.itemUnderPoint=function(he,Ge,qe){if(n(qe)&&(qe=!0),!(n(he)||n(Ge))){var Fe=h.globalToLocal(he,Ge);he=Fe.x,Ge=Fe.y;var We=0,ce=t.loop(J,function(Ae,Ye){if(We+=Ae+h.spacingH,(!qe||qe=="vertical")&&he>We-h.spacingH&&he<We)return!1;if(he<We-h.spacingH/2)return Ye});if(ce!==!1&&(ce===!0&&(ce=r-1),!(he<0||he>Pe||Ge<0||Ge>ie))){var Ve=0,Se=t.loop(pe,function(Ae,Ye){var Xe=n(c)?h.spacingV:Le[G];if((!qe||qe=="horizontal")&&Ge>Ve-Xe&&Ge<Ve)return!1;if(Ve+=Ae+Xe,Ge<Ve-Xe/2)return Ye});if(Se!==!1)return Se===!0&&(Se=i-1),h.items2D[Se][ce]}}},this.remake=function(he){return n(he)||(h.items=he),ae(),Ie(f,c),xe(!0),h},this.resize=function(he,Ge){return n(he)&&(he=f),n(Ge)&&(Ge=c),f=he,c=Ge,Ie(he,Ge),xe(!0),h};function Re(he){for(var Ge=[],qe,Fe=0;Fe<he.length;Fe++)Fe%h.cols==0&&(qe=[],Ge.push(qe)),qe.push(he[Fe]);return Ge}function _e(he){var Ge=[],qe;for(qe=0;qe<h.cols;qe++)Ge.push([]);for(qe=0;qe<he.length;qe++)Ge[qe%h.cols][Math.floor(qe/h.cols)]=he[qe];return Ge}Object.defineProperty(this,"items2D",{get:function(){return Re(h.items)},set:function(){dt&&tt("Tile() - items2D is read only")}}),Object.defineProperty(this,"items2DCols",{get:function(){return _e(h.items)},set:function(){dt&&tt("Tile() - items2DCols is read only")}}),Object.defineProperty(this,"current",{get:function(){var he=[];return t.loop(h.items,function(Ge){var qe=Ge.getBounds(),Fe=Ge.x-Ge.regX+qe.x+qe.width/2,We=Ge.y-Ge.regY+qe.y+qe.height/2,ce=h.hitTestGrid(h.width,h.height,h.cols,h.rows,Fe,We,null,null,h.spacingH,h.spacingV,!0,"open");ce!=null&&(he[ce[0]]=Ge)}),he},set:function(){dt&&tt("Tile() - current is read only")}}),Object.defineProperty(this,"current2D",{get:function(){return Re(h.current)},set:function(){dt&&tt("Tile() - current2D is read only")}}),Object.defineProperty(this,"current2DCols",{get:function(){return _e(h.current)},set:function(){dt&&tt("Tile() - current2DCols is read only")}});var Ze,at,Be,He,et,ge;function xe(he){if(he&&(He&&He.removeFrom(),K&&K.removeFrom()),!n(k)||$||L||Y){!he&&(L||Y)&&(et=[],ge=[]),(!he||n(k))&&(Ze=[]),!he&&!n(k)&&(Be=[]),!he&&$&&(at=[]);var Ge=(p?S:0)/2,qe=(x?F:0)/2,Fe,We=0;if(t.loop(h.items2D,function(Ve,Se){t.loop(Ve,function(Ae,Ye){var Xe=black;if(n(k)||(he&&!n(k)?(Xe=Be[We],Fe=Ze[We].siz(J[Ye]*me-(p?S:0),pe[Se]*ee-(x?F:0)).loc(Ge,qe,h,0)):(Xe=nt(k),Be.push(k),Fe=new t.Rectangle({width:J[Ye]*me-(p?S:0),height:pe[Se]*ee-(x?F:0),color:Xe,style:!1,scaleDimensions:!1,strokeObj:{ignoreScale:!0},group:"background"}).loc(Ge,qe,h,0),Ze.push(Fe)),Ae.pos(0,0,P,m,Fe).addTo(h)),Ge=Fe.x+Fe.width+S,L||Y){var Ue,rt;if(he)Ue=et[We],rt=ge[We];else{var Ue=nt(L)||100,rt=nt(Y)||100;et.push(Ue),ge.push(rt)}Ae.scaleTo(Fe,Ue,rt,_).pos(0,0,P,m,Fe).addTo(h)}if($){var Te;he?Te=at[We]:Te=nt($).clone(null,!1),at.push(Te),Te.pos(0,0,P,m,Fe).addTo(h)}We++}),Ge=(p?S:0)/2,qe+=Fe.height+F}),$&&!n(k)&&t.loop(at,function(Ve){Ve.addTo(h,Ze.length)},!0),n(k)?(t.loop(Ze,function(Ve){Ve.dispose()},!0),Ze=null,Be=null):(h.backgrounds=Ze,h.backgroundColors=Be),!n(k)&&(p||x)){h.loop(function(Ve){Ve.mov(p?-S/2:0,x?-F/2:0)});var ce=h.getBounds();h.setBounds(ce.x,ce.y,ce.width-(p?S:0)*r,ce.height-(x?F:0)*i),ce=h.getBounds()}$&&(h.backings=at)}if(K&&(h.mat=K,K.center(h,0)),O){var ce=h.getBounds();He=h.backdrop=new t.Rectangle({width:ce.width+R*2,height:ce.height+Q*2,color:O,style:!1,group:"backdrop"}),He.center(h,0),h.loop(function(Se){Se.mov(Math.max(0,R),Math.max(Q,0))}),h.setBounds(0,0,ce.width+Math.max(0,R)*2,ce.height+Math.max(Q,0)*2)}}xe(),q!==!1&&t.styleTransforms(this,u),this.clone=function(he){if(he){var Ge=[];if(k)var qe=[];if($)var Fe=[];for(var We=0;We<h.items.length;We++)Ge.push(h.items[We].clone(!0)),k&&qe.push(Be[We]),$&&Fe.push(at[We].clone(!0))}return h.cloneProps(new t.Tile(he?t.series(Ge):e.clone?e.clone():e,h.cols,h.rows,h.spacingH,h.spacingV,he?!1:s,f,c,h.squeezeH,h.squeezeV,p,x,P,m,h.items.length,h.mirrorH,h.mirrorV,E,he?!1:A,y,he,L,Y,_,he?t.series(qe):k,he?t.series(Fe):$&&$.clone?$.clone():$,O,X,R,Q,K&&K.clone?K.clone():K,this.style,this.group))}},t.extend(t.Tile,t.Container,"clone","zimContainer",!1),t.Pack=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k){var $="width, height, items, spacingH, spacingV, flatten, direction, lock, backgroundColor, align, valign, lastAlign, paddingH, paddingV, dragOrder, dragColor, dragThickness, dragDashed, reverse, funnel, showPacking, order, style, group, inherit",O;if(O=st(t.Pack,arguments,$,this))return O;De("66.52"),this.group=_;var X=Y===!1?{}:t.getStyle("Pack",this.group,k);n(e)&&(e=X.width!=null?X.width:500),n(r)&&(r=X.height!=null?X.height:500),this.zimContainer_constructor(e,r),this.type="Pack",n(i)&&(i=X.items!=null?X.items:[new t.Rectangle(400,300,t.orange),new t.Rectangle(400,200,t.purple),new t.Rectangle(500,300,t.blue)]),n(l)&&(l=X.spacingH!=null?X.spacingH:10),n(a)&&(a=X.spacingV!=null?X.spacingV:10),n(s)&&(s=X.flatten!=null?X.flatten:"top"),n(f)&&(f=X.direction!=null?X.direction:"horizontal"),n(c)&&(c=X.lock!=null?X.lock:"auto"),n(w)&&(w=X.backgroundColor!=null?X.backgroundColor:t.clear),n(T)&&(T=X.align!=null?X.align:"center"),n(p)&&(p=X.valign!=null?X.valign:"center"),n(x)&&(x=X.lastAlign!=null?X.lastAlign:f=="horizontal"?"left":"top"),n(P)&&(P=X.paddingH!=null?X.paddingH:0),n(m)&&(m=X.paddingV!=null?X.paddingV:0),n(v)&&(v=X.dragOrder!=null?X.dragOrder:!1),n(I)&&(I=X.dragColor!=null?X.dragColor:t.white),n(g)&&(g=X.dragThickness!=null?X.dragThickness:2),n(E)&&(E=X.dragDashed!=null?X.dragDashed:!0),n(A)&&(A=X.reverse!=null?X.reverse:!1),n(y)&&(y=X.funnel!=null?X.funnel:!1),n(C)&&(C=X.showPacking!=null?X.showPacking:!1),n(L)&&(L=X.order!=null?X.order:null);var R=this;R.funnel=y;var Q=i.length,K=e-P*2,q=r-m*2,ne=50;s===!1&&(s=NONE);var U=this.backing=new Sn({width:e,height:r,color:w,scaleDimensions:!1}).addTo(this);if(R.items=t.copy(i),i.length<=0)return this;if(i.length==1)return d(i[0]),u(i[0]),this;var D=function(ue,Pe,ie){return ue.width>Pe.width?1:ue.width<Pe.width?-1:0};function d(ue){ue.scaleTo(U,100-P/K*100*2,100-m/q*100*2),ue.scale*=R.scale,ue.scale<0&&(ue.scale=.05)}function u(ue){ue.pos(T!=CENTER&&T!=MIDDLE?P:0,p!=CENTER&&p!=MIDDLE?m:0,T,p,U).addTo(R)}function o(ue){var Pe=[];t.loop(ue,function(ie,be){Pe[be]=R.items[ie]}),i=[],t.loop(Pe,function(ie){ie&&i.push(ie)})}var S=R.content=new t.Container,F,h,b,ye,B,N,re,le,G,z,se,Oe,J,pe;t.loop(i,function(ue,Pe){ue.zpRotation=ue.rotation,ue.zpIndex=Pe}),L&&o(L),f==VERTICAL&&Z(!0);function Z(ue){S.rotation=0;var Pe=r;r=e,e=Pe;var ie=q;q=K,K=ie;var be=a;a=l,l=be;var Le=m;m=P,P=Le,s==RIGHT?s=BOTTOM:s!=CENTER&&s!=NONE&&(s=TOP),x==BOTTOM?x=LEFT:x!=CENTER&&x!=MIDDLE&&(x=RIGHT),U.dispose(),U=new Sn(e,r,w).center(R),ue?(c==HORIZONTAL?c=VERTICAL:c==VERTICAL&&(c=HORIZONTAL),t.loop(i,function(me,ee){var Ie=new t.Container(me.height,me.width);me.rotation+=90,me.pos(0,0,TOP,LEFT,Ie),i[ee]=Ie})):(c==HORIZONTAL?c=VERTICAL:c==VERTICAL&&(c=HORIZONTAL),S.rotation-=90,t.loop(i,function(me,ee){var Ie=me,Re=me.getChildAt(0).addTo(S).sca(Ie.scale);Ie.dispose(),i[ee]=Re}))}var de=c;function V(ue){c==AUTO&&(c=HORIZONTAL),F=Math.ceil(Math.sqrt(Q)),h=Math.ceil(Q/F),B=null,N=null,re=0,pe=null,le=0,G=0,z=null,se=null,Oe=null,J=null,we(ue,F,h),ae(S,F,h)}V(i),fe();function fe(){if(d(S),u(S),s==NONE){t.loop(i,function(be){be.surrogate?(i.splice(i.indexOf(be),1),be.dispose()):be.bot()},!0);var ue=h*F-Q;if(s==NONE&&ue>0){var Pe=S.getChildAt(S.numChildren-1);if(f==HORIZONTAL&&!A&&x!=LEFT){var ie=S.getBounds().width-(Pe.x+(Pe.getBounds().x-Pe.regX)*Pe.scaleX+Pe.width);t.loop(F-ue,function(be){S.getChildAt(S.numChildren-be-1).mov(x==RIGHT?ie:ie/2)})}else if(f==HORIZONTAL&&A&&x!=RIGHT){var ie=Pe.x+(Pe.getBounds().x-Pe.regX)*Pe.scaleX;t.loop(F-ue,function(Le){S.getChildAt(S.numChildren-Le-1).mov(x==LEFT?-ie:-ie/2)})}else if(f==VERTICAL&&!A&&x!=RIGHT){var ie=Pe.x;t.loop(F-ue,function(Le){S.getChildAt(S.numChildren-Le-1).mov(x==LEFT?-ie:-ie/2)})}else if(f==VERTICAL&&A&&x!=LEFT){var ie=S.getBounds().width-Pe.x;t.loop(F-ue,function(Le){S.getChildAt(S.numChildren-Le-1).mov(x==RIGHT?ie:ie/2)})}}}f==VERTICAL&&(Z(!1),d(S),u(S)),R.cols=F,R.rows=h,R.iterations=re-2,R.currentItems=i,R.dispatchEvent("change")}var ke,oe,Ce;v&&R.added(Me);function Me(){te(),Ce=Math.min(30,f==HORIZONTAL?S.height/h/3*R.scale*S.scale:S.width/F/3*R.scale*S.scale),ke?ke.siz(Ce,Ce).reg(CENTER):ke=R.beacon=new t.Rectangle({width:Ce,height:Ce,borderColor:I,borderWidth:g,scaleDimensions:!1}).reg(CENTER).rot(45),oe||(oe=R.ghost=new t.Rectangle({width:100,height:100,borderColor:I,borderWidth:g,dashed:E,scaleDimensions:!1}).reg(CENTER));var ue,Pe,ie,be;R.mdEvent=R.on("mousedown",function(Le){if(ie=Le.target,ke.top(),ue=null,!(i.indexOf(ie)<0)){be=R.localToGlobal(R.getBounds().x,R.getBounds().y);var me=ie.boundsToGlobal();R.ghost.siz(me.width,me.height).reg(CENTER).loc(me.x+oe.width/2,me.y+oe.height/2,R.stage),oe.diffX=R.stage.frame.mouseX-oe.x,oe.diffY=R.stage.frame.mouseY-oe.y,Pe=S.getChildIndex(ie),R.stage.update()}}),R.pmEvent=R.on("pressmove",function(){if(oe.parent){var Le=R.stage.frame;oe.loc(Le.mouseX-oe.diffX,Le.mouseY-oe.diffY);var me=R.getObjectUnderPoint((oe.x-be.x)/R.scaleX,(oe.y-be.y)/R.scaleY,1);if(i.indexOf(me)>=0){var ee=me.boundsToGlobal();f==HORIZONTAL?oe.x>=ee.x+ee.width/2?(ke.loc(ee.x+ee.width+l/2*R.scaleX*S.scaleX,ee.y+ee.height/2,R.stage),ue=S.getChildIndex(me)+(A?0:1)):(ke.loc(ee.x-l/2*R.scaleX*S.scaleX,ee.y+ee.height/2,R.stage),ue=S.getChildIndex(me)+(A?1:0)):oe.y>=ee.y+ee.height/2?(ke.loc(ee.x+ee.width/2,ee.y+ee.height+a/2,R.stage),ue=S.getChildIndex(me)+(A?0:1)):(ke.loc(ee.x+ee.width/2,ee.y-a/2,R.stage),ue=S.getChildIndex(me)+(A?1:0))}R.stage.update()}}),R.puEvent=R.on("pressup",function(){oe.parent&&(ue!=null&&(ue>Pe&&ue--,ue!=Pe&&(ie.level=ue,i=[],S.loop(function(Le,me){i.push(Le.rot(Le.zpRotation||0).sca(1))}),c=de,f==VERTICAL&&Z(!0),V(i),fe())),oe.removeFrom(),ke.removeFrom(),R.stage.update())})}function te(){R.mdEvent&&R.off("mousedown",R.mdEvent),R.pmEvent&&R.off("pressmove",R.pmEvent),R.puEvent&&R.off("pressup",R.puEvent),ke&&ke.removeFrom(),oe&&oe.removeFrom()}function ae(ue,Pe,ie){if(ue.scale=1,re++>20){pe&&pe.clear();return}var be=!1;if(ue.height>q){if(b=Pe+1,ye=Math.ceil(Q/b),Pe==N&&c==VERTICAL)if(G>le)b=se,ye=J,be=!0;else return ue}else if(ue.height<=q&&(b=Math.max(Pe-1,1),ye=Math.ceil(Q/b),Pe==N&&c==HORIZONTAL))if(G>le)b=se,ye=J,be=!0;else return ue;if(N=B,B=F,F=b,h=ye,t.loop(i,function(Le){s==NONE&&Le.surrogate?(i.splice(i.indexOf(Le),1),Le.dispose()):Le.siz(null,q)},!0),we(i,F,h),G=le,se=z,J=Oe,de==AUTO||c==HORIZONTAL&&Math.round(ue.width)==K||c==VERTICAL&&Math.round(ue.height)==q?le=ue.width*ue.height:le=0,z=F,Oe=h,be){pe&&pe.clear(),u(ue),R.stage&&R.stage.update();return}C?(pe=$r(1,function(){ae(ue,F,h)}),u(ue),R.stage&&R.stage.update(),ue.sca(1)):(ue.sca(1),ae(ue,F,h))}function we(ue,Pe,ie){var be=0;t.loop(ue,function(Be,He){Be.siz(null,ne),be+=Be.width});var Le=be/Q,me=ue;Q%Pe!=0&&s==NONE&&t.loop(Pe-Q%Pe,function(){var Be=new t.Rectangle(Le,ne,grey);Be.surrogate=!0,me.push(Be)});var ee=new ei(me,Pe,ie,0,0,!0),Ie=[],Re=t.copy(ee.items2D);if(s!=NONE&&Pe*ie!=Q&&Re.length>1){var _e;if(s==BOTTOM)_e=R.funnel?Math.floor((Pe*ie-Q)/2):Math.ceil((Pe*ie-Q)/2),t.loop(_e,function(Be){Re[ie-1].unshift(Re[ie-2].pop())});else{var Ze=Pe*ie-Q;t.loop(Re,function(Be,He,et){He!=et-1&&t.loop(Be.splice(-Ze,Ze),function(ge){Re[He+1].unshift(ge)},!0)}),_e=R.funnel?Math.floor((Pe*ie-Q)/2):Math.ceil((Pe*ie-Q)/2),t.loop(_e,function(Be){Re[0].push(Re[1].shift())})}}t.loop(Re,function(Be,He,et){var ge=0;t.loop(Be,function(qe){ge+=qe.width});var xe=(K-l*(Be.length-1))/ge;t.loop(Be,function(qe){qe.scale*=xe});var he=t.copy(Be);(A&&f==HORIZONTAL||!A&&f==VERTICAL)&&he.reverse();var Ge=new ei(he,Be.length,1,l,0,!0);A&&Ge.loop(function(qe){qe.bot()}),Ie.push(Ge)}),ee.dispose();var at=0;return S.loc(U,null,R),S.removeAllChildren(),t.loop(Ie,function(Be){Be.loc(0,at,S),at+=Be.height+a,Be.loop(function(He,et,ge){He.addTo(S).ord(-(ge-et))},!0)}),t.loop(Ie,function(Be){Be.dispose()},!0),d(S),S}R.getOrder=function(ue){if(n(ue)&&(ue=!1),ue){if(!Pe){var Pe=R.pane=new t.Pane({displayClose:!1,container:R.stage,width:Math.min(500,R.stage.width-20),height:Math.min(500,R.stage.height-20),draggable:!0}),ie=R.textArea=new t.TextArea(Math.min(400,R.stage.width-70),Math.min(400,R.stage.height-70));ie.centerReg(Pe)}Pe.show(),ie.text=JSON.stringify(R.order)}return R.order},this.setOrder=function(ue){return o(ue),V(i),fe(),R},this.addAt=function(ue,Pe){return n(ue)||(n(Pe)&&(Pe=R.items.length),Array.isArray(ue)||(ue=[ue]),t.loop(ue,function(ie,be){R.items.push(ie),ie.zpIndex=R.items.length-1,R.currentItems.splice(Pe+be,0,ie)}),V(R.currentItems),fe()),R},this.removeAt=function(ue,Pe){n(ue)&&(ue=1),n(Pe)&&(Pe=R.items.length);var ie=R.currentItems.splice(Pe,ue);return t.loop(ie,function(be){var Le=R.items.indexOf(be);R.items.splice(Le,1)}),V(R.currentItems),fe(),R},Object.defineProperty(R,"order",{get:function(){var ue=[];return S.loop(function(Pe){ue.push(Pe.zpIndex)}),ue},set:function(ue){R.setOrder(ue)}}),Object.defineProperty(R,"lock",{get:function(){return de},set:function(ue){ue!=de&&(c=ue,V(i),fe(),v&&Me())}}),Object.defineProperty(R,"direction",{get:function(){return f},set:function(ue){ue!=f&&(f=ue,S.rotation=0,i=[],S.loop(function(Pe,ie){i.push(Pe.rot(Pe.zpRotation||0).sca(1))}),f==VERTICAL&&Z(!0),V(i),fe(),v&&Me())}}),Object.defineProperty(R,"spacing",{get:function(){return f==VERTICAL?a:l},set:function(ue){l=a=ue,V(i),fe()}}),Object.defineProperty(R,"outerWidth",{get:function(){return e},set:function(ue){e!=ue&&(e=ue,K=e-P*2,U&&(U.widthOnly=e,U.center(R)),V(i),fe(),v&&Me())}}),Object.defineProperty(R,"outerHeight",{get:function(){return r},set:function(ue){r!=ue&&(r=ue,q=r-m*2,U&&(U.heightOnly=r,U.center(R)),V(i),fe(),v&&Me())}}),Object.defineProperty(R,"flatten",{get:function(){return s},set:function(ue){s!=ue&&(s=ue,V(i),fe())}}),Object.defineProperty(R,"dragOrder",{get:function(){return v},set:function(ue){ue?Me():(te(),R.stage&&R.stage.update())}}),Y!==!1&&t.styleTransforms(this,X),this.dispose=function(ue){return v&&te(),R.items=null,R.currentItems=null,ue||this.zimContainer_dispose(!0),!0},this.clone=function(){return R.cloneProps(new t.Pack(e,r,t.copy(i,!0),l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,t.copy(R.order),this.style,this.group))}},t.extend(t.Pack,t.Container,["dispose","clone"],"zimContainer",!1),t.Beads=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v){var I="path, obj, count, angle, startPercent, endPercent, percents, onTop, showControls, visible, interactive, clone, group, style, inherit",g;if(g=st(t.Beads,arguments,I,this))return g;De("66.7"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Beads",this.group=P;var E=m===!1?{}:t.getStyle(this.type,this.group,v);n(c)&&(c=E.onTop!=null?E.onTop:!1),n(w)&&(w=E.showControls!=null?E.showControls:!1),n(T)&&(T=E.visible!=null?E.visible:!0),n(p)&&(p=E.interactive!=null?E.interactive:!0),n(e)&&(e=E.path!=null?E.path:new t.Blob({color:null,borderWidth:3,borderColor:t.blue})),e.visible=T,e.interactive=p,e.toggle(w),e.onTop=c,n(r)&&(r=E.obj!=null?E.obj:new t.Circle(10)),n(i)&&(i=E.count!=null?E.count:10),n(l)&&(l=E.angle!=null?E.angle:null),n(a)&&(a=E.startPercent!=null?E.startPercent:0),n(s)&&(s=E.endPercent!=null?E.endPercent:100),n(f)&&(f=E.percents!=null?E.percents:null);var A=s;s<a&&(A=100+s);var y;if(n(f)){var C;e.type=="Squiggle"?C=(A-a)/(i-1):C=(A-a)/(i-(a!=A%100?1:0)),f=[];var L=a-C;for(y=0;y<i;y++)f.push(L+C),L+=C,L>100&&(L-=100)}n(x)&&(x=E.clone!=null?E.clone:!0);var Y=this;Y.count=i,Y.percents=f,Y.items=[];var _;for(y=0;y<i;y++)_=t.Pick.choose(r),x&&y!=0&&(_=_.clone()),_.beadNum=y,_.startPercent=f[y],Y.items.push(_);Y.path=e.addTo(Y),Y.beads=new t.Container().addTo(Y,c?0:null),Y.beads.type="BeadsContainer",this.resize=function(){for(var k=e.segmentRatios,$=e.segmentPoints,O=0;O<Y.count;O++){var X=e.getCurvePoint(Math.max(0,Math.min(.9999,f[O]/100)),k,$,!0);if(X){var R=Y.beads.globalToLocal(X.x,X.y);R&&Y.items[O].loc(R,null,Y.beads).rot(n(l)?X.angle>180?X.angle-360+e.rotation:X.angle+e.rotation:l)}}return this},Y.resize(),p&&(e.on("pressmove",Y.resize),e.on("update",Y.resize)),m!==!1&&t.styleTransforms(this,E),this.dispose=function(k){return k||this.zimContainer_dispose(!0),Y.items=[],!0},this.clone=function(k){if(k)for(var $=[],O=0;O<Y.items.length;O++)$.push(Y.items[O].clone(!0));return Y.cloneProps(new t.Beads(e.clone(),k?t.series($):r.clone?r.clone():r,Y.count,l,a,s,f,c,w,T,p,x,this.style,this.group))}},t.extend(t.Beads,t.Container,["clone","dispose"],"zimContainer",!1),t.Layout=function(e,r,i,l,a,s,f,c,w,T,p,x){var P="holder, regions, lastMargin, lastMarginMin, backgroundColor, vertical, showRegions, scalingObject, hideKey, style, group, inherit",m;if(m=st(t.Layout,arguments,P,this))return m;De("80"),this.cjsEventDispatcher_constructor(),this.type="Layout",this.group=p;var v=T===!1?{}:t.getStyle(this.type,this.group,x);if(n(e)&&(e=v.holder!=null?v.holder:null),n(c)&&(c=v.scalingObject!=null?v.scalingObject:null),n(e)||!e.getBounds){Gn("zim controls - Layout(): please provide an object with bounds set that holds the objects being laid out");return}if(c=n(c)?e:c,!c.getBounds||!c.getBounds()){Gn("zim controls - Layout(): holder must have bounds set or provide a scalingObject with bounds");return}var I=c.getBounds();e.setBounds(0,0,I.width,I.height),n(i)&&(i=v.lastMargin!=null?v.lastMargin:0),n(l)&&(l=v.lastMarginMin!=null?v.lastMarginMin:0),n(s)&&(s=v.vertical!=null?v.vertical:!0),n(a)&&(a=v.backgroundColor!=null?v.backgroundColor:""),n(w)&&(w=v.hideKey!=null?v.hideKey:"B"),n(f)&&(f=v.showRegions!=null?v.showRegions:null);var g;f&&(g=new t.Shape);var E=this.backing=new t.Shape,A=this;if(this.active=!0,n(r)&&(r=v.regions!=null?t.copy(v.regions):null),n(r))return;t.loop(r,function(d,u){d instanceof Ne.DisplayObject&&(r[u]={obj:d}),r[u].object&&(r[u].obj=r[u].object,delete r[u].object)}),this.regions=r;var y,C=0,L="minWidth",Y="width",_="height",k="marginLeft",$="marginMinLeft",O="maxHeight";s&&(L="minHeight",Y="height",_="width",k="marginTop",$="marginMinTop",O="maxWidth");for(var X=[],R=0,Q=0;Q<r.length;Q++){if(y=r[Q],!y.obj||!y.obj.getBounds()){tt("Layout(): each region object must have an object with setBounds() set");return}y[L]||(y[L]=0),y[Y]||(y[Y]=0),y.backgroundColor||(y.backgroundColor=""),y.given=0,y.maxGiven=0,y[k]=="auto"?(X[Q]=!0,R++,y[$]?y[k]=y[$]:delete y[k]):y[k]&&y[$]&&y[k]<y[$]&&(y[k]=y[$]),n(y[k])&&(y[k]=1e-4),y[O]||(y[O]=100),s?(y.align||(y.align="middle"),y.valign||(Q==0?y.valign="top":Q==r.length-1?y.valign="bottom":y.valign="middle",r.length==1&&(y.valign="middle"))):(y.valign||(y.valign="top"),y.align||(Q==0?y.align="left":Q==r.length-1?y.align="right":y.align="middle",r.length==1&&(y.align="middle"))),y[Y]&&(y[L]=0),C+=y[Y]+y[k]}if(i=="auto"?(X[r.length]=!0,i=l||0):i&&l&&i<l&&(i=l),C+=i,C>100){tt("Layout(): cannot fit regions into 100% bounds");return}var K=100-C;q();function q(){var d=0,u;for(u=0;u<r.length;u++)y=r[u],y.given=0,y[Y]==0&&(d+=y.obj.getBounds()[Y]);for(u=0;u<r.length;u++)y=r[u],y[Y]==0&&(y.given=y.obj.getBounds()[Y]/d*K)}this.resize=function(){var d;if(A.active){for(I=c.getBounds(),e.setBounds(0,0,I.width,I.height),E.graphics.clear(),a!=""&&(ne(E,a),E.graphics.r(0,0,I.width,I.height)),d=0;d<r.length;d++)y=r[d],y.maxGiven=0,y.marginGiven=0;for(var u=!0,o,S,F,h,b,ye,B=K;u;){for(u=!1,o=!0,d=0;d<r.length;d++)y=r[d],y.given>0&&y.maxGiven==0&&(S=y.obj.getBounds()[Y],F=y.obj.getBounds()[_],h=y.given*I[Y]/100,b=y[O]*I[_]/100,ye=F/S*h,ye>b&&y.obj.type!="Window"?(y.maxGiven=S/F*b*100/I[Y],B-=y.maxGiven):o=!1);if(o)break;var N=0;for(d=0;d<r.length;d++)y=r[d],y[Y]==0&&y.maxGiven==0&&(N+=y.obj.getBounds()[Y]);for(d=0;d<r.length;d++)y=r[d],y[Y]==0&&y.maxGiven==0&&(y.given=y.obj.getBounds()[Y]/N*B)}var re=!0;if(y=r[0],y.maxGiven>0?y.maxGiven<y[L]&&(y[Y]=y[L],re=!1):y.given>0&&y.given<y[L]&&(y[Y]=y[L],re=!1),y=r[r.length-1],y.maxGiven>0?y.maxGiven<y[L]&&(y[Y]=y[L],re=!1):y.given>0&&y.given<y[L]&&(y[Y]=y[L],re=!1),!re){for(C=0,d=0;d<r.length;d++)y=r[d],C+=y[Y]+y[k];if(C+=i,C>100){tt("zim display - Layout(): cannot fit regions into 100% bounds");return}K=100-C,q(),A.resize();return}var le=!0,G=0,z=0;for(d=0;d<r.length;d++)y=r[d],G+=y[k],y[Y]>0?z+=y[Y]:y.maxGiven>0?z+=y.maxGiven:y.given>0&&(z+=y.given),y[Y]==0&&(le=!1);if(le||o){G+=i;var se=100-z-G;if(G-=i+r[0][k],se!=0&&G!=0)for(d=0;d<r.length;d++)d!=0&&(y=r[d],y.marginGiven=y[k]/G*(G+se))}if(R>0){var Oe=0,J=0;for(d=0;d<r.length;d++)y=r[d],y.marginGiven>0?J+=y.marginGiven:J+=y[k],y.marginGiven=0,Oe+=y[k]>.05?y[k]:0;var pe=(J-Oe)/R;for(d=0;d<X.length;d++)X[d]&&r[d]&&(y=r[d],y.marginGiven=(y[$]?y[$]:0)+pe)}var Z=0,de=0,V,fe,ke;if(g&&g.graphics){var oe=g.graphics;oe.c()}for(d=0;d<r.length;d++)y=r[d],y.marginGiven>0?Z+=y.marginGiven*I[Y]/100:Z+=y[k]*I[Y]/100,y[Y]>0?S=y[Y]:y.maxGiven>0?S=y.maxGiven:y.given>0?S=y.given:S=0,S=S*I[Y]/100,F=y[O]*I[_]/100,de=(I[_]-F)/2,s?(y.obj.type=="Wrapper"&&y.obj.resize(F),y.obj.type=="Window"&&y.obj.resize(F,S),y.obj.type=="Region"&&y.obj.setBounds(F,S),V=t.fit(y.obj,de,Z,F,S)):(y.obj.type=="Wrapper"&&y.obj.resize(S),y.obj.type=="Window"&&y.obj.resize(S,F),y.obj.type=="Region"&&y.obj.setBounds(S,F),V=t.fit(y.obj,Z,de,S,F)),y.valign=="top"?y.obj.y=V.bY:y.valign=="bottom"&&(y.obj.y=V.bY+V.bHeight-V.height),y.align=="left"?y.obj.x=V.bX:y.align=="right"&&(y.obj.x=V.bX+V.bWidth-V.width),g&&g.graphics&&(oe.s("white").ss(2).r(V.bX,V.bY,V.bWidth,V.bHeight),oe.s("#ff8203").sd([20,20]).r(V.bX,V.bY,V.bWidth,V.bHeight).sd()),ke=fe=0,(Z==0||Z+S==I[Y])&&(s?ke=1:fe=1),F==I[_]&&(s?fe=1:ke=1),y.backgroundColor!=""&&(ne(E,y.backgroundColor),E.graphics.r(V.bX,V.bY,V.bWidth+fe,V.bHeight+ke)),Z+=S,y.obj.ZIMoutlineShape&&y.obj.outline()}};function ne(d,u){u.type=="GradientColor"?d.graphics.lf(u.colors,u.ratios,u.x0,u.y0,u.x1,u.y1):u.type=="RadialColor"?d.graphics.rf(u.colors,u.ratios,u.x0,u.y0,u.r0,u.x1,u.y1,u.r1):u.type=="BitmapColor"?d.graphics.bf(u.image,u.repetition,u.matrix):d.graphics.f(y.backgroundColor)}this.resize(),g&&e.addChild(g),e.addChildAt(E,0),j.addEventListener("keydown",U);function U(d){d||(d=event),g&&String.fromCharCode(d.keyCode)==w.toUpperCase()&&(A.toggle(),g.stage&&g.stage.update())}this.disable=function(){A.active=!1,j.removeEventListener("keydown",U),g&&(g.alpha=0)},this.enable=function(){A.active=!0,j.addEventListener("keydown",U),A.resize(),g&&(g.alpha=1)},this.removeShape=function(){g&&(g.graphics.clear(),g.dispose(),g=null,g=!1),j.removeEventListener("keydown",U)},this.toggled=!0,this.toggle=function(d){return d===!0?g.visible=!0:d===!1?g.visible=!1:g.visible=!g.visible,A.toggled=g.visible,A},this.addShape=function(d){A.removeShape(),g=d,j.addEventListener("keydown",U),e.addChild(g),A.resize()},T!==!1&&t.styleTransforms(this,v),c.added?c.added(D):D(c);function D(d){if(d&&d.frame&&d.frame.scaling=="full"){if(!t.globalManager){var u=t.globalManager=new t.Manager;u.frame=d.frame,u.event=d.frame.on("resize",function(){u.resize()})}t.globalManager.add(A)}}this.dispose=function(){if(A.resize=null,t.globalManager){var d=t.globalManager;d.remove(A),t.globalManager.items.length==0&&(d.frame.off("resize",d.event),d.dispose(),t.globalManager=null)}return A.backing&&A.backing.dispose(),A.backing=null,A.removeShape(),!0}},t.extend(t.Layout,Ne.EventDispatcher,null,"cjsEventDispatcher",!1),t.Accessibility=function(e,r,i,l,a,y,f,c,w,T,p,x,P,m,v){var I="appName, tabOrder, tabIndex, cycle, decimals, frame, application, alwaysHighlight, AHTime, AHColor, AHBorderWidth, AHBorderPadding, AHAlpha, AHObject, AHObjectScale",g;if(g=st(t.Accessibility,arguments,I,this))return g;De("30.5"),this.cjsEventDispatcher_constructor(),this.type="Accessibility",n(e)&&(e="application"),n(l)&&(l=!1),n(a)&&(a=2),n(y)&&(y=j.zdf),n(f)&&(f=!t.mobile()),n(c)&&(c=!1);var E=wt(w);if(n(w)&&(w=E=="s"?.7:700),n(T)&&(T="brown"),n(p)&&(p=3),n(x)&&(x=5),n(P)&&(P=.8),n(v)&&(v=.8),n(m)){var A=new t.Shape({style:!1});A.mouseEnabled=!1}else m.mouseEnabled&&(m.mouseEnabled=!1);if(typeof y>"u")var y=j.zdf;if(n(y)){dt&&tt("Accessibility - needs a Frame");return}var C=y.retina&&j.devicePixelRatio||1,L=this;L.cycle=l,L.decimals=a,L.alwaysHighlight=c,L.AHTime=w,L.AHColor=T,L.AHBorderWidth=p,L.AHBorderPadding=x,L.AHAlpha=P,L.AHObjectScale=v;var Y=-1,_=-1,k=[],$=[],O={RadioButtons:"option",Tabs:"tab",Pad:"key"},X,R=y.canvas.id,Q=t.mobile(),K=!1,q=null,ne=[],U,D,d,u,o,S,F,h=150,b;Object.defineProperty(this,"tabOrder",{get:function(){return Y},set:function(ie){var be;for(U&&U.removeEventListener("focus",N),D&&D.removeEventListener("focus",N),be=0;be<k.length;be++)k[be].parentElement&&(k[be].outerHTML="");k=[];var Le,me;for(be=0;be<$.length;be++)Le=Y[be],Le&&$[be][0].off("mousedown",$[be][1]);$=[],Y=[];var ee=[];b=y.shim?document.body:y.canvas,ue=!1;var Ie=0;for(be=0;be<ie.length;be++){if(Le=ie[be],Le.type=="HotSpots"&&(ie.splice.apply(ie,[be,1].concat(Le.hotSpots)),Le=Le.hotSpots[0]),Le.type=="HotSpot"&&(Le=Le.spot),Le.constructor=={}.constructor){if(me=Le.obj,!me||!me.getStage)continue;Le.title||(Le.title=Z(me,be+Ie))}else me=Le,Le={obj:Le,title:Z(Le,be+Ie)};if(me.type=="RadioButtons"||me.type=="Tabs"||me.type=="Pad"){var Re=[];Ie--;for(var _e=0;_e<me.buttons.length;_e++){Ie++;var Ze=me.buttons[_e],at={obj:Ze,title:Le.title+" - "+O[me.type]+": "+(Ze.text=="a"||Ze.text=="A"?"eh":Ze.text)};Re.push(at),Ze.zimTabParent=me,Ze.zimTabParent.zimAccessibility=L,Ze.zimTabIndex=be+Ie,Ze.tabIndex=_e,Ze.zimAccessibility=L,de(at),b=V(R+"Tab"+(be+Ie),at.title,b,at),$.push([Ze,Ze.on("mousedown",pe)]),K||ne.push([Ze,Ze.on("mousedown",B)])}ee=ee.concat(Re)}else me.zimTabIndex=be+Ie,me.zimTabParent=me,de(Le),me.zimAccessibility=L,$.push([me,me.on("mousedown",pe)]),K||ne.push([me,me.on("mousedown",B)]),ee.push(Le),b=V(R+"Tab"+(be+Ie),Le.title,b,Le)}U=L.startAppTag=V(R+"PrefixTab",e+" start",y.shim?document.body:y.canvas,null,"before"),U.addEventListener("focus",N),K||(U.addEventListener("focus",se),u=V(R+"noAriaTab","",U,null,"before"),u.setAttribute("aria-hidden",!0),u.focusTab=U,u.addEventListener("focus",z),S=V(R+"noAriaTab","",U),S.setAttribute("aria-hidden",!0),S.focusTab=U,S.addEventListener("focus",z)),b=V(R+"BufferTab","",b),Q&&b.setAttribute("aria-hidden",!0),b=D=L.endAppTag=V(R+"SuffixTab",e+" end",b),D.addEventListener("focus",N),K||(D.addEventListener("focus",se),b=o=V(R+"noAriaTab","",D),o.setAttribute("aria-hidden",!0),o.focusTab=D,o.addEventListener("focus",z),F=V(R+"noAriaTab","",D,null,"before"),F.setAttribute("aria-hidden",!0),F.focusTab=D,F.addEventListener("focus",z)),Y=ee}});function ye(){U&&(U.removeEventListener("focus",N),U.removeEventListener("focus",se),U.parentNode&&(U.outerHTML="")),u&&(u.removeEventListener("focus",z),u.parentNode&&(u.outerHTML="")),S&&(S.removeEventListener("focus",z),S.parentNode&&(S.outerHTML="")),b&&b.parentNode&&(b.outerHTML=""),D&&(D.removeEventListener("focus",N),D.removeEventListener("focus",se),D.parentNode&&(D.outerHTML="")),o&&(o.removeEventListener("focus",z),o.parentNode&&(o.outerHTML="")),F&&(F.removeEventListener("focus",z),F.parentNode&&(F.outerHTML=""))}Object.defineProperty(this,"tabIndex",{get:function(){return _},set:function(ie){if(!Pe)return;if(ie<0||ie>=Y.length)Be();else{ie!=_&&at();var be=Y[ie].obj;if(be.stage){if(_=ie,be.focus=!0,fe=!0,ke=!1,L.changeTitle(be),be.zimTabTag.focus(),setTimeout(function(){be.zimTabTag.focus();var He=new Ne.Event("change");He.title=be.zimTabTag.getAttribute("aria-label"),L.dispatchEvent(He)},h),L.alwaysHighlight&&(!q||!Q)){if(L.AHObject){X=L.AHObject;var Ze=t.boundsToGlobal(be);L.AHObject.alp(L.AHAlpha).addTo(y.stage,null,!1),L.AHObject.fit(Ze.x,Ze.y,Ze.width,Ze.height),L.AHObject.sca(L.AHObject.scaleX*L.AHObjectScale),L.AHTime>0&&(ae=setTimeout(function(){y.stage.removeChild(L.AHObject),y.stage.update()},L.AHTime*(E=="s"?1e3:1)))}else{X=A;var Le=be.getBounds(),me=be.localToGlobal(Le.x-5,Le.y-5),ee=be.localToGlobal(Le.x+Le.width+5,Le.y-5),Ie=be.localToGlobal(Le.x+Le.width+5,Le.y+Le.height+5),Re=be.localToGlobal(Le.x-5,Le.y+Le.height+5),_e=A.graphics;_e.clear(),_e.s(L.AHColor).ss(L.AHBorderWidth).mt(me.x-L.AHBorderPadding,me.y-L.AHBorderPadding).lt(ee.x+L.AHBorderPadding,ee.y-L.AHBorderPadding).lt(Ie.x+L.AHBorderPadding,Ie.y+L.AHBorderPadding).lt(Re.x-L.AHBorderPadding,Re.y+L.AHBorderPadding).lt(me.x-L.AHBorderPadding,me.y-L.AHBorderPadding).cp(),A.alpha=L.AHAlpha,L.AHTime>0&&(ae=setTimeout(function(){y.stage.removeChild(A),y.stage.update()},L.AHTime*(E=="s"?1e3:1)))}y.stage.addChild(X),y.stage.update()}}else Be()}function at(){if(_&&_>-1)Y&&Y[_]&&(Y[_].obj.focus=!1);else for(var He=0;He<Y.length;He++)Y[He].obj.focus=!1}function Be(){at(),fe=!1,L.AHObject&&y.stage.removeChild(L.AHObject),L.alwaysHighlightShape&&y.stage.removeChild(L.alwaysHighlightShape),y.stage.update(),_=-1}}}),Object.defineProperty(this,"aria",{get:function(){return q},set:function(ie){q=ie,q&&re()}});function B(ie){var be=ie.currentTarget,Le=be.boundsToGlobal(),me=Le.x+Le.width/2,ee=Le.y+Le.height/2,Ie=5;ie.stageX/t.scaX<me-Ie||ie.stageX/t.scaX>me+Ie||ie.stageY/t.scaY<ee-Ie||ie.stageY/t.scaY>ee+Ie?le():re()}function N(){d&&(d.innerHTML="")}Q=="android"&&(t.ACTIONEVENT="click",Pt||(j.ACTIONEVENT="click"));function re(){q=!0,Oe(),d&&d.setAttribute("aria-hidden",!1),t.ACTIONEVENT="click",Pt||(j.ACTIONEVENT="click"),y.stage.removeChild(X),Q&&(L.alwaysHighlight=!1),y.stage.update();for(var ie,be,Le,me=0;me<Y.length;me++)ie=Y[me],be=ie.obj,Le=be.zimTabTag,Le.disabled=!1,ie.title=ie.title.replace(/\s\(use arrow keys\)/,""),Le.setAttribute("aria-label",ie.title),Le.addEventListener("focus",G)}function le(){q=!1;for(var ie,be,Le,me=0;me<Y.length;me++)ie=Y[me],be=ie.obj,Le=be.zimTabTag,Le.disabled=!1;Oe(),c&&J()}function G(ie){var be=ie.currentTarget,Le=be.zimObject;_=Le.zimTabIndex,Le.focus=!0;var me=new Ne.Event("change");me.title=be.getAttribute("aria-label"),L.dispatchEvent(me)}function z(ie){q=!1,ie.target.focusTab.focus()}function se(){n(q)||q?re():le()}function Oe(){K=!0,U.removeEventListener("focus",se),D.removeEventListener("focus",se),u.removeEventListener("focus",z),o.removeEventListener("focus",z),u.parentNode&&(u.parentNode.removeChild(u),o.parentNode.removeChild(o)),S.removeEventListener("focus",z),F.removeEventListener("focus",z),S.parentNode&&(S.parentNode.removeChild(S),F.parentNode.removeChild(F));for(var ie=0;ie<ne.length;ie++)ne[ie][0].off("mousedown",ne[ie][1])}function J(){for(var ie=0;ie<k.length;ie++){var be=k[ie];be.zimObject&&(be.zimObject.type=="Loader"||be.zimObject.type=="TextArea"||be.zimObject.type=="Tag")||(k[ie].style.left="-2000px")}}n(r)?setTimeout(function(){if(Y==-1){Y=[];var ie=[];t.loop(y.stage,function(be){be.type&&ie.push(be)}),L.tabOrder=ie,n(i)||(L.tabIndex=i)}},50):(Y=[],L.tabOrder=r,n(i)||(L.tabIndex=i));function pe(ie){var be=ie.currentTarget;if(be.type=="RadioButton"||be.type=="TabsButton"||be.type=="PadButton")for(var Le=0;Le<be.zimTabParent.buttons.length;Le++){var me=be.zimTabParent.buttons[Le];me.zimTabTag.setAttribute("aria-label",me.zimTabTag.getAttribute("aria-label").split(" - currently")[0]+(be.zimTabParent.selectedIndex==me.tabIndex?" - currently selected.":" - currently not selected."))}L.tabIndex=ie.currentTarget.zimTabIndex,L.activatedObject=be}function Z(ie){return ie.talk?ie.talk:ie.type=="TextArea"||ie.type=="RadioButtons"||ie.type=="Tabs"||ie.type=="Pad"?ie.type:ie.type=="Waiter"?"Waiter active - please wait":ie.text?ie.type+" - "+(ie.text=="a"||ie.text=="A"?"eh":ie.text):ie.type+(ie.type=="Dial"||ie.type=="Slider"||ie.type=="ColorPicker"||ie.type=="Stepper"?" (use arrow keys)":"")+(ie.type=="TextArea"?" (press ENTER to edit)":"")}function de(ie){var be=ie.obj;ie.title=ie.title.replace(/\.$/,""),be.type=="RadioButton"||be.type=="TabsButton"||be.type=="PadButton"?ie.title=ie.title+(be.tabIndex==be.zimTabParent.selectedIndex?" - currently selected":" - currently not selected"):be.type=="CheckBox"?ie.title=ie.title+(be.checked?" - currently checked":" - currently not checked"):be.type=="Stepper"?ie.title=ie.title+" - currently displaying "+be.currentValue:be.type=="Slider"||be.type=="Dial"?ie.title=ie.title+" - currently at "+t.decimals(be.currentValue,L.decimals):be.type=="ColorPicker"?ie.title=ie.title+" - currently at "+be.selectedColor:be.type=="TextArea"?ie.title=ie.title+(be.tag.value!=""?"":" - placeholder: "+be.tag.placeholder):be.type=="Indicator"?ie.title=ie.title+" - currently "+(be.selectedIndex>=0?"at "+(be.selectedIndex+1)+" of "+be.num:"not indicating"):be.type=="TextInput"&&(ie.title=ie.title+(be.htmlTag.value!=""?"":" - placeholder: "+be.htmlTag.placeholder)),ie.title+="."}function V(ie,be,Le,me,ee){var Ie,Re;if(me&&(Ie=me.obj),me&&(Ie.type=="TextArea"||Ie.type=="Loader"))return Re=Ie.tag,Re.setAttribute("aria-label",be),Ie&&Re.setAttribute("aria-hidden",!Ie.stage),ee=="before"?Le.parentNode.insertBefore(Re,Le):Le.parentNode.insertBefore(Re,Le.nextSibling),Ie.type=="TextArea"?Re.style.zIndex=3:Re.style.zIndex=-5,Re.zimObject=Ie,me.obj.zimTabTag=Re,k.push(Re),Re;if(me&&Ie.type=="TextInput")return Re=Ie.htmlTag,Re.setAttribute("aria-label",be),Ie&&Re.setAttribute("aria-hidden",!Ie.stage),ee=="before"?Le.parentNode.insertBefore(Re,Le):Le.parentNode.insertBefore(Re,Le.nextSibling),Re.style.zIndex=-5,Re.zimObject=Ie,me.obj.zimTabTag=Re,k.push(Re),Re;var _e;if(me&&(Ie.type=="Dial"||Ie.type=="Slider"||Ie.type=="Stepper"||Ie.type=="ColorPicker")){var Ze=[];if(Ie.type=="Dial"||Ie.type=="Slider"){var at=Ie.step<=0?(Ie.max-Ie.min)/20:Ie.step;for(_e=Ie.min;_e<Ie.max;_e=_e+at)Ze.push(Ie.min+_e)}else Ie.type=="Stepper"?Ze=Ie.stepperArray:Ie.type=="ColorPicker"&&(Ze=Ie.colors);Re=document.createElement("select"),Re.disabled=!0,Re.zimObject=Ie,Re.addEventListener("change",function(ge){!q&&!Q=="android"||(ge.currentTarget.zimObject.zimTabParent.currentValueEvent=ge.target.value,y.stage.update())}),Re.size=1;var Be,He;for(_e=0;_e<Ze.length;_e++)Be=Ze[_e],He=document.createElement("option"),He.setAttribute("aria-label",Be),He.innerHTML=Be,Re.add(He),Be==Ie.zimTabParent.currentValue&&He.setAttribute("selected","selected");Re.setAttribute("role","button")}else Re=document.createElement("div"),Ie&&(Re.zimObject=Ie),Re.innerHTML="tag",Re.setAttribute("role",f?"application":"button"),Q=="android"&&Re.addEventListener("click",function(){Ie.dispatchEvent("click")});if(Re.setAttribute("id",ie),Re.setAttribute("tabindex",0),Re.setAttribute("aria-label",be),Ie&&Re.setAttribute("aria-hidden",!Ie.stage),ee=="before"?Le.parentNode.insertBefore(Re,Le):Le.parentNode.insertBefore(Re,Le.nextSibling),Re.style.position="absolute",me){Ie=me.obj;var et=Ie.boundsToGlobal();y.retina?(Re.style.left=y.x+et.x*y.scale/C+"px",Re.style.top=y.y+et.y*y.scale/C+"px",Re.style.width=et.width*y.scale/C+"px",Re.style.height=et.height*y.scale/C+"px"):(Re.style.left=y.x+et.x*y.scale+"px",Re.style.top=y.y+et.y*y.scale+"px",Re.style.width=et.width*y.scale+"px",Re.style.height=et.height*y.scale+"px"),me.obj.zimTabTag=Re}else Re.style.left="-1000px",Re.style.top=y.y+"px";return Re.style.overflow="hidden",Re.style.zIndex=-5,Re.style.fontSize="20px",Re.style.color="rgba(0,0,0,.01)",k.push(Re),Re}var fe=!1,ke=!0,oe=y.on("keydown",function(ie){if(ie.keyCode==9&&(Ce()||(fe=!1,L.tabIndex!=-1&&(L.tabIndex=-1)),fe?te(ie):Me(ie)),fe&&Y.length>0&&L.tabIndex>=0&&ie.keyCode==13){var be=Y[L.tabIndex],Le=be.obj;if(be&&Le.stage){var me=new Ne.Event("mousedown"),ee=new Ne.Event("click");me.fromEnter=ee.fromEnter=!0,Le.type=="Pane"?(Le.backdrop.dispatchEvent(me),Le.backdrop.dispatchEvent(ee)):(Le.dispatchEvent(me),Le.dispatchEvent(ee))}}});function Ce(){for(var ie=!1,be=0;be<k.length;be++)if(document.activeElement==k[be]){ie=!0;break}return!!(document.activeElement==y.canvas||ie)}function Me(ie){!y.shiftKey&&(wn(R+"PrefixTab")==document.activeElement||y.canvas==document.activeElement)?(Y.length>0&&(Y[Y.length-1].obj.focus=!0),ke=!0,fe=!0,te(ie)):y.shiftKey&&(wn(R+"SuffixTab")==document.activeElement||wn(R+"BufferTab")==document.activeElement)&&(Y.length>0&&(Y[0].obj.focus=!0),ke=!0,fe=!0,te(ie))}function te(ie){if(ie.ctrlKey){we(ie.shiftKey?-1:1);return}ie.shiftKey?L.tab(-1):L.tab(1),ie.preventDefault()}var ae;this.tab=function(ie){if(clearTimeout(ae),X&&y.stage.removeChild(X),n(ie)&&(ie=1),Y.length==0){we(ie);return}for(var be=0;be<Y.length;be++){var Le=Y[be].obj;if(Le.focus){Le.focus=!1;var me=be+ie,ee=(me+Y.length*1e4)%Y.length,Ie=Y[ee];Le=Ie.obj;for(var Re=0,_e=!1;!(Le.stage&&(!Le.zimTabParent&&(n(Le.enabled)||Le.enabled)||Le.zimTabParent&&(n(Le.zimTabParent.enabled)||Le.zimTabParent.enabled)));)if(Re++,me=me+ie,ee=(me+Y.length*100)%Y.length,Ie=Y[ee],Le=Ie.obj,Re==Y.length){_e=!0;break}if(_e||!L.cycle&&me!=ee&&!ke){we(ie);return}ke=!1,L.tabIndex=ee;break}}};function we(ie){fe=!1,wn(R+(ie==1?"SuffixTab":"PrefixTab")).focus(),y.stage.removeChild(m),y.stage.update(),L.tabIndex=-1}this.changeTitle=function(ie,be,Le){if(typeof ie!="number"&&(ie=ie.zimTabIndex),!n(ie)){if(Le&&n(be)){L.tabIndex=ie;return}var me=Y[ie],ee=me.obj;n(be)&&(be=ee.zimTabTag.getAttribute("aria-label").split(" - currently")[0]),me.title=be,de(me),ee.zimTabTag.setAttribute("aria-label",me.title),Le&&(L.tabIndex=ie)}};var ue=!1;this.talk=function(ie){ue||(d=V(R+"TalkTab","",D),d.setAttribute("role","alert"),ue=!0),d.removeAttribute("role"),d.setAttribute("aria-label",ie),d.setAttribute("role","alert");var be=new Ne.Event("change");be.title=ie,L.dispatchEvent(be)},this.resize=function(ie){if(n(ie))for(var me=0;me<Y.length;me++)ee(Y[me].obj);else{if(typeof ie!="number"&&(ie=ie.zimTabIndex),ie<0)return;var be=Y[ie],Le=be.obj;!Le.stage&&X&&Le==L.currentObject&&(y.stage.removeChild(X),y.stage.update()),ee(Le)}function ee(Ie){if(Ie.type=="TextArea"||Ie.type=="Loader"){Ie.resize();return}else{var Re=Ie.boundsToGlobal(),_e=Ie.zimTabTag;y.retina?(_e.style.left=y.x+Re.x*y.scale/C+"px",_e.style.top=y.y+Re.y*y.scale/C+"px",_e.style.width=Re.width*y.scale/C+"px",_e.style.height=Re.height*y.scale/C+"px"):(_e.style.left=y.x+Re.x*y.scale/C/C+"px",_e.style.top=y.y+Re.y*y.scale/C/C+"px",_e.style.width=Re.width*y.scale/C/C+"px",_e.style.height=Re.height*y.scale/C/C+"px")}_e.setAttribute("aria-hidden",!Ie.stage),_e.hidden=!Ie.stage}},Object.defineProperty(this,"currentObject",{get:function(){return Y[_]&&Y[_].obj?Y[_].obj:null},set:function(ie){for(var be=0;be<Y.length;be++)if(Y[be].obj==ie){L.tabIndex=be;break}}});var Pe=!0;Object.defineProperty(this,"enabled",{get:function(){return Pe},set:function(ie){Pe=ie}}),this.dispose=function(){A&&A.graphics.clear(),L.tabOrder=[];for(var ie=0;ie<k.length;ie++)k[ie].parentElement&&(k[ie].outerHTML="");ye(),L.removeAllEventListeners(),y.off("keydown",oe)}},t.extend(t.Accessibility,Ne.EventDispatcher,null,"cjsEventDispatcher",!1),t.TextureActive=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I){var g="width, height, color, color2, angle, borderColor, borderWidth, corner, interactive, animated, backingOrbit, pattern, scalePattern, style, group, inherit",E;if(E=st(t.TextureActive,arguments,g,this))return E;De("35.2"),this.group=v;var A=m===!1?{}:t.getStyle("TextureActive",this.group,I);n(e)&&(e=A.width!=null?A.width:j.zdf.width),n(r)&&(r=A.height!=null?A.height:j.zdf.height),n(w)&&(w=A.interactive!=null?A.interactive:!0),n(T)&&(T=A.animated!=null?A.animated:!0),n(i)&&(i=A.color!=null?A.color:null),n(l)&&(l=A.color2!=null?A.color2:null),n(a)&&(a=A.angle!=null?A.angle:null),n(s)&&(s=A.borderColor!=null?A.borderColor:null),n(f)&&(f=A.borderWidth!=null?A.borderWidth:null),s<0||f<0?s=f=null:s!=null&&f==null&&(f=1),n(c)&&(c=A.corner!=null?A.corner:10),n(p)&&(p=A.backingOrbit!=null?A.backingOrbit:!0),n(x)&&(x=A.pattern!=null?A.pattern:null),n(P)&&(P=A.scalePattern!=null?A.scalePattern:null),this.zimPage_constructor(e,r,i,l,a,x,P,null,m,v,I),this.type="TextureActive",c&&(this.backing.corner=c),n(f)||(this.backing.borderWidth=f),n(s)||(this.backing.borderColor=s),(f||!n(s))&&(this.backing.siz(this.width-f,this.height-f),this.backing.center()),this.backing.mouseChildren=!1,this.interactive=w,this.animated=T,this.backingOrbit=p,m!==!1&&t.styleTransforms(this,A),this.clone=function(){return this.cloneProps(new t.TextureActive(e,r,i,l,a,s,f,c,w,T,p,x,P,m,this.group,I))}},t.extend(t.TextureActive,t.Page,["clone"],"zimPage",!1),t.TextureActive.makeLogo=function(e,r){n(e)&&(e="light");var i=e!="dark",l=i?t.light:t.dark,a=i?t.dark:t.light,s=i?t.white:t.black,f=i?t.black:t.white,c=new t.Container(400,100),w=j.zdf.makeIcon(l,a,[l,l,l,l,l]).ske(0,30).scaleTo(c,100,100).center(c),T=new t.Rectangle((400-w.width)/2+4,80-10,new t.GradientColor([i?l:s,i?s:l,i?l:s],-70),f,.5).addTo(c),p=T.clone().pos(0,0,"right","bottom",c);return new t.Label({text:"Texture",size:50,color:a,variant:!0}).scaleTo(T,75,75).center(T),new t.Label({text:"Active",size:50,color:a,variant:!0}).scaleTo(T,72,72).center(p),r?c:c.noMouse()},t.TextureActive.makeBacking=function(e,r,i,l){n(e)&&(e=800),n(r)&&(r=600),n(i)&&(i="CANVAS WINDOW"),n(l)&&(l=t.light);var a=new t.Container(e,r);return a.icon=j.zdf.makeIcon({box:black}).sca(2),a.label=new t.Label({text:i,size:25,color:l,align:"center"}).reg("center"),a.tile=new t.Tile({obj:[a.icon,a.label],rows:2,spacingV:24,unique:!0,align:CENTER}).scaleTo(a,50,70).center(a),a.tile.items[1].mov(0,10),a},t.TextureActives=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E){var A="actives, threejs, zimThree, renderer, scene, camera, controls, layers, near, far, ignoreList, toggleKey, color, outerColor, damp, style, group, inherit",y;if(y=st(t.TextureActives,arguments,A,this))return y;De("35.4"),this.group=g;var C=I===!1?{}:t.getStyle("TextureActives",this.group,E),L,Y,_="ZIM TextureActives - need a ZIM Frame";if(n(e)&&n(e[0]))if(j.zdf)Y=j.zdf,L=j.zdf.stage;else{tt(_);return}else if(n(e)||n(e[0])||n(e[0].stage))if(j.zdf)Y=j.zdf,L=j.zdf.stage;else{tt(_);return}else L=e[0].stage,Y=L.frame;n(e)&&(e=C.actives!=null?C.actives:null),n(r)&&(r=C.threejs!=null?C.threejs:null),n(i)&&(i=C.zimThree!=null?C.zimThree:null),n(l)&&(l=C.renderer!=null?C.renderer:null),n(a)&&(a=C.scene!=null?C.scene:null),n(s)&&(s=C.camera!=null?C.camera:null),n(f)&&(f=C.controls!=null?C.controls:null),n(c)&&(c=C.layers!=null?C.layers:[]),Array.isArray(c)||(c=[c]),n(w)&&(w=C.near!=null?C.near:void 0),n(T)&&(T=C.far!=null?C.far:void 0),n(p)&&(p=C.ignoreList!=null?C.ignoreList:[]),Array.isArray(p)||(p=[p]),n(x)&&(x=C.toggleKey!=null?C.toggleKey:"t"),n(P)&&(P=C.color!=null?C.color:t.darker),n(m)&&(m=C.outerColor!=null?C.outerColor:"black"),n(v)&&(v=C.damp!=null?C.damp:null);var k=this;t.TAM||(t.TAM=new t.TextureActivesManager(L,x,v),l&&l.domElement&&l.domElement.addEventListener("mousedown",R=>{R.preventDefault()})),k.manager=t.TAM,this.ignoreList=p,this.raycast=!0,this.renderer=l,this.layers=c,this.animated=!1,this.interactive=!1,this.actives=[],this.threeMeshes=[];var $=!1;function O(R){n(R)&&(R=[]),Array.isArray(R)||(R=[R]);var Q=0,K,q;return t.loop(R,function(ne){k.actives.indexOf(ne)<0&&(k.actives.push(ne),ne.cache(),ne.canvas.content=ne,ne.interactive&&(K=!0,ne.canvas.isTextureActive=!0),ne.animated&&(q=!0),Q++)}),K&&!k.interactive&&(k.interactive=!0,Q>0&&X()),q&&!k.animated&&(k.animated=!0),Q}O(e),t.TAM.updateTile(k,k.actives),t.TAM.color=P,t.TAM.outerColor=m,Y.canvas.style.display="none";function X(){if($)return;$=!0,k.pointerCheck||(k.pointerCheck=t.TAM.addPointer(k)),k.pointerData={x:Y.mouseX,y:Y.mouseY,mousedown:!1};var R=window.innerWidth,Q=window.innerHeight,K=-1,q=-2,ne=-1,U=-2;k.overInterval=t.interval(.05,function(){if(q&&q!=K||U&&U!=ne){var h=new Ne.Event("rayover");h.mesh=k.mesh=q,h.material=k.material=U,U.userData&&(h.textureActive=k.textureActive=U.userData.ta_content),h.intersect=k.intersect,k.dispatchEvent(h),f&&!f.screenSpacePanning&&(f.activeLook=!1)}else if(!q&&K||!U&&ne){var h=new Ne.Event("rayout");h.mesh=K,h.material=ne,ne.userData&&(h.textureActive=ne.userData.ta_content),h.intersect=k.intersect,k.dispatchEvent(h),f&&!f.screenSpacePanning&&(f.activeLook=!0)}K=q,ne=U});var D=k.raycaster=new r.Raycaster(void 0,void 0,w,T);c.length>0&&t.loop(c,function(h){D.layers.set(h)});var d;window.addEventListener("pointerdown",u);function u(h){if(k.raycast){var b;!i||i.resizeEvent?b={x:h.clientX/window.innerWidth*2-1,y:1-h.clientY/window.innerHeight*2}:b={x:h.clientX/R*2-1,y:1-h.clientY/Q*2},D.setFromCamera(b,s);var ye=D.intersectObjects(a.children);d=null;var B,N,re;for(N=0;N<ye.length;N++)if(B=ye[N].object,!(k.ignoreList.indexOf(B)>-1)){if(k.threeMeshes.indexOf(B)>-1)if(B.material&&Array.isArray(B.material))re=B.material[ye[N].face.materialIndex];else if(B.material)re=B.material;else break;if(re&&re.map&&re.map.source&&re.map.source.data&&re.map.source.data.isTextureActive&&re.userData.ta_content){d=B;var le=re.userData.ta_content;if(k.pointerData.mousedown=!0,F(le,ye[N],re.userData.ta_flipped),Ne.handleRemotePointer(k.pointerData.x,k.pointerData.y,"down",h,L,h.pointerID),f&&f.maxAzimuthAngle&&le)if(le.backingOrbit){var G=le.globalToLocal(Y.mouseX,Y.mouseY),z=le.backing;z&&le.getObjectUnderPoint(G.x,G.y,1)!=z?f.enableRotate=!1:f.enableRotate=!0}else f.enableRotate=!1;var h=new Ne.Event("raydown");h.mesh=k.mesh=B,h.material=k.material=re,h.textureActive=k.textureActive=le,h.intersect=k.intersect=ye[N],k.dispatchEvent(h);break}else break}}}window.addEventListener("pointerup",o);function o(h){if(k.raycast){if(k.pointerData.mousedown=!1,f&&f.maxAzimuthAngle&&(f.enableRotate=!0),d){var h=new Ne.Event("rayup");h.mesh=k.mesh,h.material=k.material,h.textureActive=k.textureActive,h.intersect=k.intersect,k.dispatchEvent(h)}d=null,Ne.handleRemotePointer(null,null,"up",h,L,-1)}}window.addEventListener("pointermove",S);function S(h){if(k.raycast){var b;!i||i.resizeEvent?b={x:h.clientX/window.innerWidth*2-1,y:1-h.clientY/window.innerHeight*2}:b={x:h.clientX/R*2-1,y:1-h.clientY/Q*2},D.setFromCamera(b,s);var ye=!1,B,N,re;if(d){let z=D.intersectObject(d);if(z.length>0&&(B=d,B.material&&Array.isArray(B.material)?re=B.material[z[0].face.materialIndex]:B.material&&(re=B.material),re)){var le=re.userData.ta_content;F(le,z[0],re.userData.ta_flipped),Ne.handleRemotePointer(k.pointerData.x,k.pointerData.y,"move",h,L,h.pointerID),ye=!0;var h=new Ne.Event("raymove");h.mesh=q=k.mesh=B,h.material=U=k.material=re,h.textureActive=k.textureActive=le,h.intersect=k.intersect=z[0],k.dispatchEvent(h)}}else{var G=D.intersectObjects(a.children);for(N=0;N<G.length;N++)if(B=G[N].object,!(k.ignoreList.indexOf(B)>-1)){if(k.threeMeshes.indexOf(B)>-1)if(B.material&&Array.isArray(B.material))re=B.material[G[N].face.materialIndex];else if(B.material)re=B.material;else break;if(re&&re.map&&re.map.source&&re.map.source.data&&re.map.source.data.isTextureActive&&re.userData.ta_content){var le=re.userData.ta_content;F(le,G[N],re.userData.ta_flipped),Ne.handleRemotePointer(k.pointerData.x,k.pointerData.y,"move",h,L,h.pointerID),ye=!0;var h=new Ne.Event("raymove");h.material=U=k.material=re,h.mesh=q=k.mesh=B,h.textureActive=k.textureActive=le,h.intersect=k.intersect=G[N],k.dispatchEvent(h);break}else break}}ye||(q=null,U=null),t.TAM.setActive(k,ye)}}function F(h,b,ye){if(!(!h||!h.getBounds)){var B=h.getBounds(),N=ye?B.width-b.uv.x*B.width:b.uv.x*B.width,re=(1-b.uv.y)*B.height,le=h.localToGlobal(N,re);k.pointerData.x=le.x,k.pointerData.y=le.y}}}this.add=function(R){var Q=O(R);return Q>0&&t.TAM.updateTile(k,k.actives),k},this.remove=function(R){n(R)&&(R=[]),Array.isArray(R)||(R=[R]);var Q=0;return t.loop(R,function(K){if(Ne.remoteQueue){var q=Ne.remoteQueue.indexOf(K);q>=0&&Ne.remoteQueue.splice(q,1)}q=k.actives.indexOf(K),q>=0&&(k.actives.splice(q,1),Q++),K.textureMap&&delete K.textureMap.userData.ta_content,q=k.threeMeshes.indexOf(K),q>=0&&k.threeMeshes.splice(q,1),K.dispose()},!0),Q>0&&t.TAM.updateTile(k,k.actives),k},k.addMesh=function(R,Q){if(n(Q)||R.layers.enable(Q),R.material){var K=k.threeMeshes.indexOf(R);if(K<0)k.threeMeshes.push(R);else return k;var q;Array.isArray(R.material)?q=R.material:q=[R.material],R.onBeforeRender=function(){R.userData.ta_viewID&&clearTimeout(R.userData.ta_viewID),R.userData.ta_viewID=setTimeout(function(){R.userData.ta_view=!1,Ne.remoteQueue&&t.loop(R.userData.ta_content,function(ne){var U=Ne.remoteQueue.indexOf(ne);U>=0&&Ne.remoteQueue.splice(U,1)},!0)},100),R.userData.ta_view||(R.userData.ta_view=!0,t.loop(R.userData.ta_content,function(ne){Ne.remoteQueue.indexOf(ne)<0&&Ne.remoteQueue.push(ne)}))},R.userData.ta_content=[],t.loop(q,function(ne){if(ne&&ne.map&&ne.map.source&&ne.map.source.data&&ne.map.source.data.content){var U=ne.map.source.data.content;R.userData.ta_content.push(U),U.mesh=R,R.textureActive=!0,ne.userData.ta_content=U,U.textureMaps||(U.textureMaps=[]);var D=U.textureMaps.indexOf(ne.map);D<0&&U.textureMaps.push(ne.map),(U.animated||U.interactive)&&(Ne.remoteQueue||(Ne.remoteQueue=[]))}})}return k},k.dispose=function(){k.raycast=!1,f&&(f.enableRotate=!0,f.enabled=!0),k.remove(k.actives),t.TAM.remove(k),t.TAM.count<1&&(t.TAM.dispose(),t.TAM=null),k.material=k.mesh=k.content=k.intersect=null}},t.extend(t.TextureActives,Ne.EventDispatcher,"dispose"),t.TextureActivesManager=function(e,r,i){De("35.6");var l=this;this.type="TextureActivesManager",l.color=t.darker,l.outerColor="black";var a=!1;l.toggleKey=r||"t",(n(i)||i===!0)&&(i=.2);var s=l.objects=new t.Dictionary(!0),f=e.frame,c=new t.Proportion({baseMin:1e3,baseMax:9e3,targetMin:-.1,targetMax:-.05,clamp:!1});l.backing=new t.Rectangle(100,100,t.faint).addTo(e,0);var w=[];l.updateTile=function(E,A,y){y||s.add(E,A);var C=[];if(w=[],t.loop(s,function(Y,_){t.loop(_,function(k){C.push(k),k.loop(function($){($.type=="Scrambler"||$.type=="List"||$.type=="Window")&&w.push($)})})}),C.length<0){var L=l.message=new t.Rectangle(W,H,t.yellow);new t.Label("No TextureActives Added").center(L),C.push(L)}l.tile?(l.tile.cols=C.length,l.tile.remake(C)):l.tile=new t.Tile(C,C.length,1,20,0,!0).addTo(e),l.backing.scaleTo(l.tile,100,100,"full").siz(null,e.height,!0),l.swiper&&(l.swiper.sensitivity=t.constrain(c.convert(l.tile.width),-.1,-.01))},this.addPointer=function(E){var A=[];return t.loop(s,function(y){A.indexOf(y.renderer.domElement)<0&&A.push(y.renderer.domElement)}),A.indexOf(E)<0&&A.push(E.renderer.domElement),Ne.remotePointers?Ne.remotePointers=A:Ne.addRemotePointers(e,A),!0},this.setActive=function(E,A){if(E.active=A,!A){var y=t.loop(s,function(C){if(C.active)return!1});y&&(e.mouseInBounds=!1)}};var T=!1,p=this.nav=new t.Panel({width:200,height:80,titleBar:"TextureActives",draggable:!0,close:!0}).pos(50,50,RIGHT,BOTTOM),x=this.slider=new t.Slider({min:0,max:100,damp:!0}).scaleTo(p,80);x.on("mousedown",function(){T=!0,l.swiper.enabled=!1,m()}),x.on("pressup",function(){l.swiper.immediate(x.currentValue),l.swiper.enabled=!0,v(),T=!1}),p.on("close",function(){l.hide(),p.addTo()});var P=0;this.ticker=t.Ticker.add(function(){l.tile.x=-x.currentValue*(l.tile.width-W)/100,a&&!T&&P!=0&&P!=100&&(x.currentValue==0||x.currentValue==100)&&v(),P=x.currentValue}),p.add(x,0,!0),p.removeFrom(),t.Ticker.remove(l.ticker);function m(){a||(a=!0,t.loop(w,function(E){E.enabled=!1}))}function v(){a&&(a=!1,t.loop(w,function(E){E.enabled=!0,E.update()}))}l.swiper=new t.Swiper({swipeOn:l.backing,target:x,property:"currentValue",sensitivity:l.tile?t.constrain(c.convert(tile.width),-.1,-.01):-.1,damp:i}),l.backing.on("mousedown",function(){P=-100,m()}),l.swiper.on("swipestop",v),l.toggled=!1;var I=f.color,g=f.outerColor;this.show=function(){if(!l.toggled)return f.color=l.color,f.outerColor=l.outerColor,l.toggled=!0,t.Ticker.add(l.ticker),p.addTo(),t.loop(s,function(E){E.lastRaycast=E.raycast,E.raycast=!1,E.renderer.domElement.style.display="none"}),Ne.remoteQueue&&t.loop(l.tile.items,function(E){Ne.remoteQueue.indexOf(E)<0&&Ne.remoteQueue.push(E)}),f.canvas.style.display="block",Ne.removeRemotePointers(e),this},this.hide=function(){if(l.toggled){f.color=I,f.outerColor=g,l.toggled=!1,t.Ticker.remove(l.ticker),p.removeFrom();var E=[];return t.loop(s,function(A){A.raycast=A.lastRaycast,A.renderer.domElement.style.display="block",E.push(A.renderer.domElement)}),Ne.remoteQueue&&(Ne.remoteQueue=[],t.loop(l.tile.items,function(A){A.mesh&&(A.mesh.userData.ta_view=!1)})),f.canvas.style.display="none",Ne.addRemotePointers(e,E),this}},l.toggle=function(E){return n(E)&&(E=!l.toggled),E&&!l.toggled?l.show():!E&&l.toggled&&l.hide(),this},l.keyEvent=f.on("keydown",function(E){E.key==l.toggleKey&&(l.toggled?l.hide():l.show())}),l.remove=function(E){s.remove(E),l.updateTile(null,null,!0)},l.dispose=function(){l.hide(),p.dispose(),f.off("keydown",l.keyEvent),l.backing.removeAllEventListeners(),l.backing.dispose(),l.objects.dispose(),l.tile.dispose(),l.objects=l.tile=p=null}},t.extend(t.TextureActivesManager,Ne.EventDispatcher),t.Manager=function(e){De("75");var r=this;this.type=e,this.items=[],this.add=function(a){return Array.isArray(a)?r.items=r.items.concat(a):r.items.push(a),r};var i,l;this.remove=function(a){if(r){if(!a)r.items=[];else for(Array.isArray(a)||(a=[a]),i=a.length-1;i>=0;i--){l=a[i];var s=r.items.indexOf(l);s!=-1&&r.items.splice(s,1)}return r}},this.resize=function(a){if(r){if(a)for(Array.isArray(a)||(a=[a]),i=a.length-1;i>=0;i--)l=a[i],!l.resize&&r.items.indexOf(l)!=-1?r.items.splice(r.items.indexOf(l),1):l.resize();else for(i=r.items.length-1;i>=0;i--)r.items[i].resize?r.items[i].resize():r.items.splice(i,1);return r}},this.toggle=function(a,s){if(r){if(s)for(Array.isArray(s)||(s=[s]),f=s.length-1;f>=0;f--)l=s[f],!l.resize&&r.items.indexOf(l)!=-1?r.items.splice(r.items.indexOf(l),1):l.toggle(a);else for(var f=r.items.length-1;f>=0;f--)r.items[f].resize?r.items[f].toggle(a):r.items.splice(f,1);return r}},this.dispose=function(a){if(r){if(r.resize=null,a)for(Array.isArray(a)||(a=[a]),i=a.length-1;i>=0;i--)l=a[i],r.items.indexOf(l)!=-1&&r.items.splice(r.items.indexOf(l)),l.dispose&&l.dispose();else{for(i=r.items.length-1;i>=0;i--)r.items[i].resize?r.items[i].dispose():r.items.splice(i,1);r.items=null}return!0}}},t.ResizeManager=function(){De("75.5"),t.Manager.call(this,"ResizeManager")},t.ResizeManager.prototype=new t.Manager,t.ResizeManager.prototype.constructor=t.ResizeManager,t.TransformManager=function(e,r){De("75.7");var i=this;this.type="TransformManager",this.persistID=r,this.items=[];function l(s){!localStorage||s&&!s.pressup||i.savePersist(s)}this.add=function(s){var f=[];Array.isArray(s)?f=s:f=[s];for(var c,w=!1,T=0;T<f.length;T++)if(c=f[T],c.transformControls&&(c.originalVisible=c.transformControls.visible),c.toggle&&c.toggle(!1),i.items.length==0&&T==0&&(w=!0),c.type=="Blob"||c.type=="Squiggle")i.persistID||w&&(w=!1,c.controlsVisible=!0,i.currentObject=c),c.on("change",function(x){var P=new Ne.Event("transformed");P.transformObject=x.target,P.transformType=x.controlType,i.dispatchEvent(P)}),c.on("controlsshow",function(x){var P=new Ne.Event("transformshow");i.currentObject=P.transformObject=x.target,i.dispatchEvent(P)}),c.on("controlshide",function(x){var P=new Ne.Event("transformhide");P.transformObject=x.target,i.currentObject=null,i.dispatchEvent(P)}),c.on("update",function(x){var P=new Ne.Event("transformed");P.transformObject=x.target,P.transformType=x.controlType,i.dispatchEvent(P)});else if(c.type=="Connectors")i.persistID||w&&(w=!1,i.currentObject=c),c.on("connection",function(x){var P=new Ne.Event("transformed");P.transformObject=x.target,P.transformType="connection",i.dispatchEvent(P)});else if(c.type=="Pack")i.persistID||w&&(w=!1,i.currentObject=c),c.on("change",function(x){var P=new Ne.Event("transformed");P.transformObject=x.target,P.transformType="change",i.dispatchEvent(P)});else{var p=c.transformControls;i.persistID||w&&c.type!="Layer"&&(w=!1,c.originalVisible&&(p.show(),i.currentObject=c)),c.on("transformed",function(x){var P=new Ne.Event("transformed");P.transformObject=x.target,P.transformType=x.transformType,i.dispatchEvent(P)}),c.on("transformshow",function(x){var P=new Ne.Event("transformshow");i.currentObject=P.transformObject=x.target,i.dispatchEvent(P)}),c.on("transformhide",function(x){var P=new Ne.Event("transformhide");P.transformObject=x.target,i.currentObject=null,i.dispatchEvent(P)})}i.items=i.items.concat(s),i.persist&&!n(i.persistID)&&i.persist(i.persistID)},this.remove=function(s){if(n(s)){i.items=[];return}Array.isArray(s)||(s=[s]);for(var f,c=0;c<s.length;c++){f=s[c],i.currentObject==f&&(i.currentObject=null),f.transformedEvent&&(f.off("transformed",f.transformedEvent),f.transformedEvent=null),f.type=="Blob"||f.type=="Squiggle"?f.controlsVisible=!1:f.transformControls&&f.transformControls.remove();var w=i.items.indexOf(f);w!=-1&&i.items.splice(w,1)}r&&i.savePersist()},this.show=function(s){if(!n(s)){if(s.type=="Blob"||s.type=="Squiggle")s.controlsVisible||(s.controlsVisible=!0);else{var f=s.transformControls;if(!f||f.visible)return;f.show()}i.currentObject=s}},this.hide=function(s){if(!n(s))if(i.currentObject==s&&(i.currentObject=null),s.type=="Blob"||s.type=="Squiggle")s.controlsVisible&&(s.controlsVisible=!1);else{var f=s.transformControls;if(!f||f.visible)return;f.hide()}},this.hideAll=function(s){for(var f,c,w=0;w<i.items.length;w++)if(c=i.items[w],!c||!(c.transformControls||c.update))i.items.splice(w);else{if(i.items[w]==s)continue;c.type=="Blob"||c.type=="Squiggle"?c.controlsVisible&&(c.controlsVisible=!1):(f=i.items[w].transformControls,f.visible&&f.hide())}i.currentObject=null},this.resize=function(){if(i){for(var s,f=0;f<i.items.length;f++)s=i.items[f],!s||!(s.transformControls||s.update)?i.items.splice(f):s.type=="Blob"||s.type=="Squiggle"?s.update():s.transformControls.resize();r&&i.savePersist()}},n(e)||i.add(e);var a="TransformManager persist(persistID) - sorry, must provide id";this.persist=function(s){var f,c;if(n(s)&&dt){tt(a);return}i.persistID=s;var w=0;if(localStorage&&localStorage[s]){var T=i.persistData=JSON.parse(localStorage[s]);if(T.length==i.items.length)for(c=0;c<i.items.length;c++)T[c].controls&&(i.currentObject=i.items[c]),T[c]&&(T[c].type=="Blob"||T[c].type=="Squiggle")?(i.items[c].points.length!=T[c].points.length&&(i.items[c].points=T[c].points),i.items[c].setData(T[c]),i.items[c]==i.currentObject&&i.currentObject.toggle(!0),w++,w==T.length&&setTimeout(function(){i.dispatchEvent("persistcomplete")},100)):T[c]&&T[c].type=="Connectors"?(i.items[c].setSteps(T[c].steps),i.items[c].loc(T[c].x,T[c].y),i.items[c].sca(T[c].scale),w++,w==T.length&&setTimeout(function(){i.dispatchEvent("persistcomplete")},100)):T[c]&&T[c].type=="Pack"?(i.items[c].setOrder(T[c].order),i.items[c].outerWidth=T[c].outerWidth,i.items[c].outerHeight=T[c].outerHeight,w++,w==T.length&&setTimeout(function(){i.dispatchEvent("persistcomplete")},100)):T[c]&&(n(i.items[c].transformControls)?-function(){var p=f=i.items[c],x=T[c];t.interval(50,function(P){p.transformControls&&(p.transformControls.setData(x),p.dispatchEvent("persistset"),w++,w==T.length&&(setTimeout(function(){p==i.currentObject&&i.currentObject.toggle(!0),i.dispatchEvent("persistcomplete")},100),P.clear()))},20,null,null,"ms")}():(i.items[c].transformControls.setData(T[c]),-function(){var p=f=i.items[c];t.interval(50,function(x){p.dispatchEvent("persistset"),w++,w==T.length&&(setTimeout(function(){p==i.currentObject&&i.currentObject.toggle(!0),i.dispatchEvent("persistcomplete")},100),x.clear())},20,null,null,"ms")}()))}for(c=0;c<i.items.length;c++)f=i.items[c],f.transformedEvent||(f.type=="Blob"||f.type=="Squiggle"?(f.transformedEvent=f.on("change",function(p){p.pressup=!0,l(p)}),f.transformedUEvent=f.on("update",function(p){p.pressup=!0,l(p)}),f.transformedSEvent=f.on("controlsshow",function(p){p.pressup=!0,l(p)}),f.transformedHEvent=f.on("controlshide",function(p){p.pressup=!0,l(p)})):f.type=="Connectors"?f.transformedEvent=f.on("connection",function(p){p.pressup=!0,l(p)}):f.type=="Pack"?f.transformedEvent=f.on("change",function(p){p.pressup=!0,l(p)}):(f.transformedEvent=f.on("transformed",l),f.transformedSEvent=f.on("transformshow",l),f.transformedHEvent=f.on("transformhide",l)))},this.savePersist=function(){for(var s=[],f=0;f<i.items.length;f++){var c=i.items[f];c.type=="Blob"||c.type=="Squiggle"?c.recordData&&s.push(c.recordData()):c.type=="Connectors"?s.push({type:c.type,x:c.x,y:c.y,scale:c.scale,steps:c.getSteps()}):c.type=="Pack"?s.push({type:c.type,outerWidth:c.outerWidth,outerHeight:c.outerHeight,order:c.getOrder()}):c.transformControls&&c.transformControls.recordData&&s.push(c.transformControls.recordData())}i.persistData=s,localStorage[i.persistID]=JSON.stringify(s)},this.clearPersist=function(s){if(n(s)&&dt){tt(a);return}i.persistData=null,localStorage&&localStorage.removeItem(s)},this.stopPersist=function(){for(var s=0;s<i.items.length;s++){var f=i.items[s];f.transformedEvent&&(f.type=="Blob"||f.type=="Squiggle"?(f.off("change",f.transformedEvent),f.off("update",f.transformedUEvent),f.off("controlsshow",f.transformedSEvent),f.off("controlshide",f.transformedHEvent)):f.type=="Connectors"?f.off("connection",f.transformedEvent):f.type=="Pack"?f.off("change",f.transformedEvent):(f.off("transformed",f.transformedEvent),f.off("transformshow",f.transformedSEvent),f.off("transformhide",f.transformedHEvent)),f.transformedEvent=null,f.transformedUEvent=null,f.transformedSEvent=null,f.transformedHEvent=null)}i.persistData=null},n(r)||i.persist(r),this.dispose=function(s,f){if(n(s)&&(s=!0),i.removeAllEventListeners(),i.persistID&&s&&i.stopPersist(),f)for(var c=0;c<i.items.length;c++){var w=i.items[c];w.type=="Blob"||w.type=="Squiggle"?w.dispose():w.transformControls.dispose()}}},t.extend(t.TransformManager,Ne.EventDispatcher,null,"cjsEventDispatcher",!1),t.GuideManager=function(){De("77"),t.Manager.call(this,"GuideManager")},t.GuideManager.prototype=new t.Manager,t.GuideManager.prototype.constructor=t.GuideManager,t.GridManager=function(){De("79"),t.Manager.call(this,"GridManager")},t.GridManager.prototype=new t.Manager,t.GridManager.prototype.constructor=t.GridManager,t.LayoutManager=function(){De("81"),t.Manager.call(this,"LayoutManager")},t.LayoutManager.prototype=new t.Manager,t.LayoutManager.prototype.constructor=t.LayoutManager,t.SelectionSet=function(e){De("81.5"),this.type="SelectionSet",n(e)&&(e=[]),this.selections=e,this.clear=function(){this.selections=[]},this.isSelected=function(r){return this.selections.indexOf(r)>=0},this.add=function(r,i,l,a){if(!n(r)){n(i)&&(n(this.selectionManager)||(i=this.selectionManager.multiple)),n(this.selectionManager)||(this.selectionManager.setCurrent(this),!i&&this.selectionManager.multipleSets&&this.selectionManager.clear()),i||this.clear();var s=this.selections.indexOf(r);if(!(s>=0)){if(this.selections.push(r),!n(l)){Array.isArray(l)||(l=[l]);for(var f=0;f<=l.length;f++)l[f].add(r,i)}if(!n(a))for(Array.isArray(a)||(a=[a]),f=0;f<=a.length;f++)a[f].remove(r,i)}}},this.remove=function(r,i,l,a){if(!n(r)){n(i)&&(n(this.selectionManager)||(i=this.selectionManager.multiple)),n(this.selectionManager)||this.selectionManager.setCurrent(this),i||this.clear();var s=this.selections.indexOf(r);if(n(this.selectionManager)||(this.selectionManager.setCurrent(this),!i&&this.selectionManager.multipleSets&&this.selectionManager.clear()),i||this.clear(),i?s>=0&&this.selections.splice(s,1):this.clear(),!n(l)){Array.isArray(l)||(l=[l]);for(var f=0;f<=l.length;f++)l[f].remove(r,i)}if(!n(a))for(Array.isArray(a)||(a=[a]),f=0;f<=a.length;f++)a[f].add(r,i)}},this.toggle=function(r,i,l,a){this.isSelected(r)?this.remove(r,i,l,a):this.add(r,i,l,a)},this.dispose=function(){return this.clear(),this.selections=null,!0}},t.SelectionManager=function(e,r,i){De("81.6"),this.cjsEventDispatcher_constructor(),this.type="SelectionManager",n(e)&&(e=[]),n(i)&&(i=!0),Array.isArray(e)||(e=[e]),this.sets=e,this.multipleKey=r,this.multipleSets=i,this.multiple=!1;for(var l=this,a=0;a<e.length;a++)e[a].selectionManager=this;this.clear=function(){this.currentSet=null;for(var f=0;f<e.length;f++)e[f].clear()},this.setCurrent=function(f){this.currentSet=f;for(var c=0;c<e.length;c++)e[c]!=f&&(this.multipleSets||e[c].clear())};var s=new Ne.Event("keydown");this.eventRemove=s.remove,this.keydownEvent=function(f){f.remove=l.eventRemove,l.multipleKey&&(l.multiple=f[l.multipleKey+"Key"]),l.ctrlKey=f.ctrlKey,l.shiftKey=f.shiftKey,l.metaKey=f.metaKey,l.dispatchEvent(f),f.keyCode==90&&(l.ctrlKey||l.metaKey)&&l.dispatchEvent("undo")},j.addEventListener("keydown",this.keydownEvent),this.keyupEvent=function(f){l.multipleKey&&(l.multiple=f[l.multipleKey+"Key"]),l.ctrlKey=f.ctrlKey,l.shiftKey=f.shiftKey,l.metaKey=f.metaKey,f.remove=l.eventRemove,l.dispatchEvent(f)},j.addEventListener("keyup",this.keyupEvent),this.dispose=function(){this.clear(),j.removeEventListener("keydown",this.keydownEvent),j.removeEventListener("keyup",this.keyupEvent)}},t.extend(t.SelectionManager,Ne.EventDispatcher,null,"cjsEventDispatcher",!1),typeof Ct>"u")var Ct;t.Bind=function(e,r,i,l,a,s,f,c){var w="connection, bindType, master, masterFilter, couple, smartDecimals, report, setDefault",T;if(T=st(t.Bind,arguments,w,this))return T;De("81.8"),this.type="Bind";var p=this;n(e)&&localStorage&&n(Ct)&&(n(r)||r==t.LOCALSTORAGE)?(e="zimBind",r=t.LOCALSTORAGE):e&&e.match(/\/|\./)?(n(r)&&(r=t.GET),e.match(/\?/)?e+="&":e+="?"):e&&n(r)&&(r=t.LOCALSTORAGE),n(s)&&(s=!0),r==t.LOCALSTORAGE&&!localStorage&&(dt&&tt("Bind() - no localStorage"),p.error="error - no localStorage"),this.connection=e,this.bindType=r,this.master=i,this.masterFilter=l,this.smartDecimals=s,n(f)&&(f=!1),(!Ct||c)&&(Ct=this),Object.defineProperty(p,"default",{get:function(){return p==Ct},set:function(g){!g&&Ct==p?Ct=null:g&&(Ct=p)}}),this.bindType==t.POST&&(p.ajax=new t.Ajax),this.bindings={},this.ids=[],this.data={},this.objIDs=new t.Dictionary(!0),this.toIDs={},this.fromIDs={},this.add=function(g,E,A,y,C){if(n(A)||n(E)||n(g))return p;if(p.bindings[g]){if(p.bindings[g].obj!=E)return dt&&tt("Bind() - id can be used with only one object"),p}else{p.ids.indexOf(g)<=0&&p.ids.push(g),p.bindings[g]={obj:E,props:[]},!n(C)&&typeof C=="function"&&(p.bindings[g].filter=C);var L=p.objIDs.at(E);L?L.indexOf(g)<0&&L.push(g):p.objIDs.add(E,[g])}!Array.isArray(A)&&A.constructor!={}.constructor&&(A=[A]);var Y=p.bindings[g].props;Array.isArray(A)?t.loop(A,function(k){_(p.toIDs,k,g),_(p.fromIDs,k,g),Y.indexOf(k)<0&&Y.push(k)}):t.loop(A,function(k,$){($==t.BOTH||$==t.TO)&&_(p.toIDs,k,g),($==t.BOTH||$==t.FROM)&&_(p.fromIDs,k,g),Y.indexOf(k)<0&&Y.push(k)});function _(k,$,O){n(k[$])?k[$]=[O]:k[$].indexOf(O)<0&&k[$].push(O)}return f&&I("Bind Report: ADD ["+g+"]",(A?" "+A:"")+(y?" "+y:"")),p.bindType==t.LOCALSTORAGE?(p.from(null,g,A,y),(!p.data||t.isEmpty(p.data))&&p.to(g,A)):(m("bind",null,[C],p.data,y),p.applyData()),p},this.updatefilter=function(g,E){var A=p.bindings[g];return A&&(n(E)?A.filter&&delete A.filter:typeof E=="function"&&(A.filter=E)),p},this.remove=function(g,E,A,y,C,L){var Y;if(!n(g)&&!Array.isArray(g)&&(g=[g]),!n(g)){Y=[];var _=[];t.loop(g,function(ne){typeof ne=="string"?Y.push(ne):_.push(ne)})}!n(E)&&!Array.isArray(E)&&(E=[E]),n(C)&&(C=!0),g=Y.concat(_),g.length==0&&(g=null);var k=x("from",g,E,!1),$=k[0];k=k[1];var O=m("remove",y,$,k,A);if(O=="stop")return;var X=t.copy(k);n(E)||E.length==0?(Y.length>0&&t.loop(Y,function(ne){q(ne,!0)}),_.length>0&&t.loop(_,function(ne){Y=p.objIDs.at(ne),Y.length>0&&t.loop(Y,function(U){q(U,!1)}),p.objIDs.remove(ne)})):(Y=[],t.loop(k,function(ne,U){var D=p.bindings[ne],d=D.props;t.loop(U,function(u){var o=d.indexOf(u);o>=0&&d.splice(o,1),K(u,ne)}),d.length==0&&Y.push(ne)}),Y.length>0&&p.remove(Y));function R(ne){L&&typeof L=="function"&&(a&&(ne=t.couple(ne)),L(ne)),f&&I("Bind Report: REMOVE"+(A?" ["+A+"]":""),ne)}if(C){var Q="type="+p.bindType+"&";p.bindType==t.LOCALSTORAGE?(p.to(),R("success")):p.bindType==t.GET?(O=JSON.stringify(X),a&&(O=t.couple(O)),t.async(p.connection+Q+"remove="+O,R,"callbackRemove")):p.bindType==t.POST?p.ajax.post(p.connection+Q,X,R,"remove"):p.bindType==t.SOCKET}function K(ne,U){var D,d;D=p.fromIDs[ne],D&&(d=D.indexOf(U),d>=0&&D.splice(d,1),D.length==0&&delete p.fromIDs[ne]),D=p.toIDs[ne],D&&(d=D.indexOf(U),d>=0&&D.splice(d,1),D.length==0&&delete p.toIDs[ne])}function q(ne,U){var D=p.bindings[ne].obj,d=p.bindings[ne].props,u=p.objIDs.at(D),o=u.indexOf(ne);o>=0&&u.splice(o,1),U&&u.length==0&&_.push(D),o=p.ids.indexOf(ne),o>=0&&p.ids.splice(o,1),t.loop(d,function(S){K(S,ne)}),delete p.bindings[ne]}return p};function x(g,E,A){var y=[],C;if(n(E)&&n(A)){if(g=="from"&&p.bindType!=t.LOCALSTORAGE)return t.loop(p.bindings,function(k){k.filter&&y.push(k.filter)}),[y,"full"];C=p.ids}else!n(E)&&!Array.isArray(E)&&(E=[E]),!n(A)&&!Array.isArray(A)&&(A=[A]),E&&(C=[],t.loop(E,function(k){if(typeof k=="string")C.indexOf(k)<0&&C.push(k);else{var $=p.objIDs.at(k);$&&t.loop($,function(O){C.indexOf(O)<0&&C.push(O)})}}));var L={};return C?Y(A):A&&_(),[y,L];function Y(k){t.loop(C,function($){var O=p.bindings[$];if(O){O.filter&&y.push(O.filter);var X=O.obj;t.loop(k||O.props,function(R){var Q=p.toIDs[R];if(Q&&Q.indexOf($)>=0)if(g=="from")L[$]||(L[$]=[]),L[$].push(R);else{L[$]||(L[$]={});var K=X[R];typeof K=="number"&&p.smartDecimals&&(K>1?K=t.decimals(K,1):K=t.decimals(K,2)),L[$][R]=t.copy(K)}})}})}function _(){var k=[];t.loop(A,function($){t.loop(p.toIDs[$],function(O){var X=p.bindings[O];k.indexOf(O)<0&&(X.filter&&y.push(X.filter),k.push(O));var R=X.obj;if(g=="from")L[O]||(L[O]=[]),L[O].push($);else{L[O]||(L[O]={});var Q=R[$];typeof Q=="number"&&p.smartDecimals&&(Q>1?Q=t.decimals(Q,1):Q=t.decimals(Q,2)),L[O][$]=t.copy(Q)}})})}}this.stopProcess=!1,this.stop=function(){p.stopped=!0};var P=function(){var g=this;g.stop=function(){g.stopped=!0}};function m(g,E,A,y,C){var L=new P,Y=y!=null&&!t.isEmpty(y)&&p.data;if(v(L,C))return["stop",y];p.masterFilter&&typeof p.masterFilter=="function"&&(y=p.data=p.masterFilter(y,g,C,L));var _=t.loop(A,function(k){if(typeof k=="function"){if(v(L,C))return"stop";y=p.data=k(y,g,C,L)}});return _=="stop"||v(L,C)?["stop",y]:(E&&typeof E=="function"&&(y=p.data=E(y,g,C,L)),v(L,C)?["stop",y]:(Y&&!p.data&&dt&&tt("Bind()"+(g?" ["+g+"]":"")+(C?" ["+C+"]":"")+" - warning, a filter may not have returned data"),["go",y]))}function v(g,E){if(p.stopped||g.stopped)return I("STOP"+(E?" ["+E+"]":""),g.stopped?"process stopped":"bind stopped"),g.stopped?g.stop=null:p.stopped=!1,!0}this.to=function(g,E,A,y,C,L,Y,_){var k="targets, props, extra, filter, smartDecimals, call, lock, unique",$;if($=st(p.to,arguments,k))return $;var O=x("to",g,E,C),X=O[0];O=O[1];var R=m("to",y,X,O,A);if(O=R[1],R[0]=="stop")return;if(p.bindType==t.LOCALSTORAGE)localStorage[p.connection]=JSON.stringify(O),u(O);else{var Q="type="+p.bindType+"&";if(!O||t.isEmpty(O))return p;if(p.bindType==t.GET){var K=O;t.isJSON(K)||(K=JSON.stringify(K)),a&&(K=t.couple(K)),f&&I("Bind Report: TO [bindings]",K),K=t.urlEncode(K);var q=n(p.master)?"":"&master="+t.urlEncode(i),ne=n(Y)?"":"&lock="+t.urlEncode(Y),U=n(_)?"":"&unique="+t.urlEncode(_),D=n(A)?"":"&extra="+t.urlEncode(A),d=p.connection+Q+"command=to&data="+K+q+ne+U+D;f&&I("Bind Report: TO [url]",d),t.async(d,u,"callbackTo")}else p.bindType==t.POST&&(p.ajax.master=i,p.ajax.couple=a,p.ajax.lock=Y,p.ajax.unique=_,f&&I("Bind Report: TO [bindings]",O),p.ajax.post(p.connection+Q,O,"to",A,u))}function u(o){a&&(o=t.decouple(o)),L&&typeof L=="function"&&L(o),f&&I("Bind Report: TO"+(A?" ["+A+"]":" -"),o)}return p},this.toLock=function(g,E,A,y,C,L){var Y="targets, props, extra, filter, smartDecimals, call",_;if(_=st(p.toLock,arguments,Y))return _;if(p.bindType.toLowerCase()=="localstorage")return p.to(g,E,A,y,C,L),p;var k=t.makeID();p.from($,g,E,A,y,k);function $(){p.to(g,E,A,y,C,L,k)}return p},this.toUnique=function(g,E,A,y,C,L){var Y="targets, props, extra, filter, smartDecimals, call",_;return(_=st(p.toUnique,arguments,Y))?_:(p.to(g,E,A,y,C,L,null,!0),p)},this.toggleReport=function(g){return n(g)?f=!f:f=g,p},f&&I("Bind Report: CREATE ["+r.toUpperCase()+"]",e+(i?" "+i:""));function I(g,E){p==Ct?Ar(g,E):kr(g,E)}return this.report=function(){var g="Bind {DATA} Report:",E=t.copy(p.data);return p==Ct?Ar(g,E):kr(g,E),g="Bind {BINDINGS} Report:",E=t.copy(p.bindings),p==Ct?Ar(g,E):kr(g,E),p},this.from=function(g,E,A,y,C,L){var Y="call, targets, props, extra, filter, lock",_;if(_=st(p.from,arguments,Y))return _;var k=x("from",E,A,s),$=k[0];k=k[1];var O=m("fromTo",C,$,k,y);if(k=O[1],O[0]=="stop")return;var X="type="+p.bindType+"&";if(p.bindType==t.LOCALSTORAGE)(!localStorage[p.connection]||localStorage[p.connection]==null)&&(localStorage[p.connection]="{}"),p.data=JSON.parse(localStorage[p.connection]),U(p.data);else if(p.bindType==t.GET){var R=k;t.isJSON(R)||(R=JSON.stringify(R)),a&&(R=t.couple(R)),f&&I("Bind Report: FROM [bindings]",R),R=t.urlEncode(R);var Q=n(p.master)?"":"&master="+t.urlEncode(i),K=n(L)?"":"&lock="+t.urlEncode(L),q=n(y)?"":"&extra="+t.urlEncode(y),ne=p.connection+X+"data="+R+"&command=from"+Q+K+q;f&&I("Bind Report: FROM [url]",ne),t.async(ne,U,"callbackFrom")}else p.bindType==t.POST&&(p.ajax.master=i,p.ajax.couple=a,p.ajax.lock=L,f&&I("Bind Report: FROM [bindings]",k),p.ajax.post(p.connection+X,k,"from",y,U));function U(D){if(p.data=D,a&&(p.data=t.decouple(p.data)),!n(L))var d=JSON.stringify(p.data);var u=m("from",C,$,p.data,y);if(u[0]!="stop"){var o=!1;(n(L)||d!=JSON.stringify(p.data))&&(o=!0,p.applyData()),f&&I("Bind Report: FROM"+(y?" ["+y+"]":" -"),o?p.data:"data not applied in toLock()"),g&&typeof g=="function"&&g(p.data)}}return p},this.applyData=function(){return t.loop(p.data,function(g,E){var A=p.bindings[g];if(A){var y=p.bindings[g].obj;t.loop(E,function(C,L){y[C]=L})}}),p},this.clear=function(){return p.bindType==t.LOCALSTORAGE&&(localStorage[p.connection]=null),p},this.removeAllBindings=function(g,E){if(n(g)&&(g=!0),this.bindings={},this.ids=[],this.data={},this.objIDs=new t.Dictionary(!0),this.toIDs={},this.fromIDs={},g){var A="type="+p.bindType+"&";if(p.bindType==t.LOCALSTORAGE)p.clear(),C("success");else if(p.bindType==t.GET){var y=n(p.master)?"":"&master="+encodeURI(i);t.async(p.connection+A+"command=removeAll"+y,C,"callbackRemoveAll")}else p.bindType==t.POST&&(p.ajax.master=i,p.ajax.post(p.connection+A,{},"removeAll",null,C,"removeAll"))}function C(L){E&&typeof E=="function"&&E(L),f&&I("Bind Report: REMOVEALL",L)}return p},p},t.Swipe=function(e,r,i,l,a){var s="obj, distance, duration, isometric, overrideNoSwipe",f;if(f=st(t.Swipe,arguments,s,this))return f;if(De("70"),this.cjsEventDispatcher_constructor(),this.type="Swipe",n(e)||!e.on){tt(`zim controls - Swipe():
Please pass in object`);return}n(r)&&(r=30);var c=wt(i);n(i)&&(i=c=="s"?.08:80),this.distance=r,this.duration=i,this.active=!0;var w,T,p,x,P,m,v=this,I,g,E=e.on("mousedown",function(A){if(!v.active||!a&&A.target.zimNoSwipe)return;v.obj=A.target,x=w=A.stageX/t.scaX,P=T=A.stageY/t.scaY,p=!0,v.dispatchEvent("swipedown"),clearTimeout(m),m=setTimeout(function(){p&&(y(),p=!1)},v.duration*(c=="s"?1e3:1)),I=e.on("pressmove",function(C){x=C.stageX/t.scaX,P=C.stageY/t.scaY}),g=e.on("pressup",function(){p&&(y(),p=!1,clearTimeout(m))});function y(){var C=new Ne.Event("swipe");if(C.obj=v.obj,C.stageX=A.stageX/t.scaX,C.stageY=A.stageY/t.scaY,C.rawX=A.rawX/t.scaX,C.rawY=A.rawY/t.scaY,C.swipeX=C.swipeY=0,v.direction="none",l){if(Math.abs(x-w)>v.distance||Math.abs(P-T)>v.distance){var L=Math.atan2(P-T,x-w)*180/Math.PI;L=(L+360)%360,L>=270&&L<360?(C.swipeY=-1,v.direction="up"):L>=0&&L<90?(C.swipeX=1,v.direction="right"):L>=90&&L<180?(C.swipeY=1,v.direction="down"):L>=180&&L<270&&(C.swipeX=-1,v.direction="left")}}else Math.abs(x-w)>Math.abs(P-T)?(x-w>v.distance&&(C.swipeX=1,v.direction="right"),w-x>v.distance&&(C.swipeX=-1,v.direction="left")):(P-T>v.distance&&(C.swipeY=1,v.direction="down"),T-P>v.distance&&(C.swipeY=-1,v.direction="up"));v.dispatchEvent(C)}});this.disable=function(){v.active=!1},this.enable=function(){v.active=!0},this.dispose=function(){E&&e.off("mousedown",E),I&&e.off("pressmove",I),g&&e.off("pressup",g)}},t.extend(t.Swipe,Ne.EventDispatcher,null,"cjsEventDispatcher",!1),t.Swiper=function(e,r,i,l,a,s,f,c,w,T,p,x,P){var m="swipeOn, target, property, sensitivity, swiperType, min, max, damp, integer, factor, loop, pauseTime, otherSwiper",v;if(v=st(t.Swiper,arguments,m,this))return v;if(De("69.5"),this.cjsEventDispatcher_constructor(),this.type="Swiper",n(e)||!e.getStage||!e.stage){tt("zim.Swiper() - please provide container on stage");return}if(n(r))return;n(l)&&(l=1),n(a)&&(a="horizontal"),n(c)&&(c=.1),c===!1&&(c=1),n(w)&&(w=!1),n(T)&&(T=1),n(p)&&(p=!1);var I=wt(x);n(x)&&(x=I=="s"?.2:200);var g=this,E=e,A,y,C=g.desiredValue=r[i],L;this.target=r,this.property=i,this.sensitivity=l;var Y=!1,_=j.zdf||e.stage?e.stage.frame:{};E.canvas?(L=E,g.downEvent=E.on("stagemousedown",function(B){Y=!0,U(B),g.moveEvent=E.on("stagemousemove",D),g.upEvent=E.on("stagemouseup",k),g.upEvent2=_.on("mouseupplus",k)})):(L=E.stage,h(),g.downEvent=E.on("mousedown",U),g.moveEvent=E.on("pressmove",D),g.upEvent=E.on("pressup",$),g.upEvent2=_.on("mouseupplus",$));function k(){Y=!1,E.off("stagemousemove",g.moveEvent),E.off("stagemouseup",g.upEvent),g.dispatchEvent("swipeup")}function $(){Y=!1,g.dispatchEvent("swipeup")}var O,X,R,Q=Math.sqrt(Math.pow(E.width,2)+Math.pow(E.height,2)),K,q,ne=!1;function U(B){ne=!0,L=B.target.stage,R=(E.parent?E.parent:E).localToGlobal(E.x,E.y),Y=!0,a=="radial"?(K=B.stageX/t.scaX,q=B.stageY/t.scaY,O=Math.atan2(q-R.y,K-R.x)*t.DEG):A=a=="horizontal"?B.stageX/t.scaX:B.stageY/t.scaY,y=g.target[g.property],g.dispatchEvent("swipedown")}function D(B){if(Y){if(a=="radial"){g.diff=t.dist(K,q,B.stageX/t.scaX,B.stageY/t.scaY),X=Math.atan2(B.stageY/t.scaY-R.y,B.stageX/t.scaX-R.x)*t.DEG;var N=t.sign(O-X);if(Math.abs(X-O)>180){Y=!1;return}g.diff=g.diff*N;var re=Math.max(10,t.dist(R.x,R.y,B.stageX/t.scaX,B.stageY/t.scaY));g.diff*=(Q-re)/Q}else g.diff=A-(a=="horizontal"?B.stageX/t.scaX:B.stageY/t.scaY);if(P&&(Math.abs(g.diff)<Math.abs(P.diff)?(g.override=!0,P.override=!1):(g.override=!1,P.override=!0)),!g.override){if(Math.abs(g.diff)>0&&(g.swiperMoving=!0),C=y-g.diff*g.sensitivity*T,!n(s)&&!n(f)&&p){var le=C;C=(C+(f-s)*1e4-s)%(f-s)+s,Math.abs(le-C)>Math.abs(f-s)*.8&&(g.immediate(C),A=a=="horizontal"?B.stageX/t.scaX:B.stageY/t.scaY,y=g.target[g.property])}else n(s)||(C=Math.max(C,s)),n(f)||(C=Math.min(C,f));g.desiredValue=C,g.dispatchEvent("swipemove")}}}var d=new t.Damp(g.target[g.property],c),u=C,o=C;g.swiperTicker=t.Ticker.add(function(){C==u?C!=o&&(g.pauseTimeout&&g.pauseTimeout.clear(),o=C,g.pauseTimeout=t.timeout(x,function(){Y&&g.dispatchEvent("swipepause"),g.pauseTimeout=null})):(o=null,u=C,g.pauseTimeout&&g.pauseTimeout.clear()),g.swiperMoving&&(g.target[g.property]=w?Math.round(d.convert(C)):d.convert(C),ne&&!Y&&Math.abs(g.target[g.property]-C)<Math.abs(l)/2&&(g.swiperMoving=!1,ne=!1,g.target[g.property]=C,g.immediate(g.target[g.property]),g.dispatchEvent("swipestop")))},L),this.immediate=function(B){d.immediate(B),g.target[g.property]=w?Math.round(B):B,g.desiredValue=C=B};var S=!0;Object.defineProperty(g,"enabled",{get:function(){return S},set:function(B){S!=B&&(B?ye():b(),S=!!B)}}),Object.defineProperty(g,"desiredValue",{get:function(){return C},set:function(B){g.swiperMoving=!0,C=B}}),Object.defineProperty(g,"damp",{get:function(){return c},set:function(B){c=B,d.damp=c}});function F(){E.off("stagemousedown",g.downEvent),E.off("stagemousemove",g.moveEvent),E.off("stagemouseup",g.upEvent),_.off("mouseupplus",g.upEvent2)}function h(){E.off("mousedown",g.downEvent),E.off("pressmove",g.moveEvent),E.off("pressup",g.upEvent),_.off("mouseupplus",g.upEvent2)}function b(){E.canvas?F():h(),t.Ticker.remove(g.swiperTicker)}function ye(){E.canvas?g.downEvent=E.on("stagemousedown",g.downEvent):(g.downEvent=E.on("mousedown",g.downEvent),g.moveEvent=E.on("pressmove",g.moveEvent),g.upEvent=E.on("pressup",g.upEvent),g.upEvent2=_.on("mouseupplus",g.upEvent2)),g.immediate(g.target[g.property]),g.swiperTicker=t.Ticker.add(g.swiperTicker,L)}this.dispose=function(){b(),d=null,g.swiperTicker=null}},t.extend(t.Swiper,Ne.EventDispatcher,null,"cjsEventDispatcher",!1),t.MotionController=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_){var k="target, type, speed, axis, boundary, map, diagonal, damp, flip, orient, constant, firstPerson, turnSpeed, moveThreshold, stickThreshold, container, localBoundary, mouseMoveOutside, mousedownIncludes, minPercentSpeed, maxPercentSpeed, dampKeyup, rotate, mouseOutside",$;if($=st(t.MotionController,arguments,k,this))return $;De("69.7"),this.cjsEventDispatcher_constructor(),this.type="MotionController";var O=this,X,R="zim MotionController(): Please pass in a reference to the stage or a container on the stage";if(n(I))if(j.zdf)X=I=j.zdf.stage;else{tt(R);return}else if(n(I.stage))if(j.zdf)X=j.zdf.stage;else{tt(R);return}else X=I.stage;var Q=X.frame;n(T)||(Y=T),n(e)&&(e=new t.Container(1,1,null,null,!1));var K=e.type=="Accelerator";if(n(i)&&(i=r=="pressmove"?20:7),!n(r)&&r.type=="DPad"){var q=r;r="manual",n(l)&&(l=q.axis),l=="all"&&(l="both"),q.on("change",function(){O.convert(e.x+q.dirX*i,e.y+q.dirY*i)})}(n(r)||r!="mousemove"&&r!="pressmove"&&r!="pressdrag"&&r!="keydown"&&r!="gamebutton"&&r!="gamestick"&&r!="swipe"&&r!="follow"&&r!="manual")&&(r="mousedown"),n(l)&&(l=K?"horizontal":"both"),r=="keydown"&&n(s)&&(s=[[65,37],[68,39],[87,38],[83,40]]),r=="gamebutton"&&n(s)&&(x?s=[14,15,t.GamePad.RT,t.GamePad.LT]:s=[14,15,12,13]),r=="gamestick"&&n(s)&&(x?s=[[0,2],[0,2],[1],[1]]:s=[0,0,1,1]),r=="gamestick"&&n(s)&&(s=[0,0,1,1]),n(f)&&(f=!0),(l=="horizontal"||l=="vertical")&&(f=!1),(n(c)||c===!0)&&(c=r=="keydown"||r=="gamebutton"?1:r=="pressmove"?.5:.1),c===!1&&(c=1),n(x)&&(x=!1),n(P)&&(P=i*.4),n(m)&&(m=4),n(v)&&(v=.2),n(E)&&(E=!0),X.mouseMoveOutside=E,n(A)&&(A=[]),Array.isArray(A)||(A=[A]),e.type=="Pen"&&!e.move?A.push(e,e.paper):A.push(e),a&&a.getBounds&&(A?A.indexOf(a)==-1&&A.push(a):A=[a]),e.motionController=this,this.mousedownIncludes=A,I&&I.backing&&this.mousedownIncludes.push(I.backing),n(L)&&(L=.3),O.dampKeyup=L,this.dirX=0,this.dirY=0,this.speed=i,this.turnSpeed=P,this.axis=l,this.target=e,this.moveThreshold=m,this.stickThreshold=v,this.boundary=a,e.zimMCStartAngle=e.rotation;var ne=O.speed,U=O.speed,D=0;O.rotation=e.zimMCStartAngle;var d,u;if(K){u=I.getBounds();var o;!u||l=="vertical"&&!u.height||l!="vertical"&&!u.width?o=1e3:o=l=="vertical"?u.height:u.width,n(y)&&(y=0),n(C)&&(C=100),n(this.target.percentSpeed)&&(this.target.percentSpeed=(C-y)/2),O.x=o/2,O.y=o/2,d=new t.Proportion(0,o,y,C)}else O.x=this.target.x,O.y=this.target.y;var S=O.scaleX=e.scaleX,F=O.scaleY=e.scaleY,h,b,ye,B,N=!1,re=!1,le,G,z,se,Oe;if(r=="keydown"||r=="gamebutton"){for(G=0;G<4;G++)Array.isArray(s[G])||(s[G]=[s[G]]);var J=[0,0,0,0],pe=[],Z=["X","X","Y","Y"],de=[-1,1,-1,1],V={dirX:0,dirY:0};if(r=="keydown")var fe=Q.on("keydown",Pe);else{se=O.gamepad=new t.GamePad;var ke=se.on("buttondown",Pe)}if(n(p))if(r=="keydown")var oe=Q.on("keyup",ie);else var Ce=se.on("buttonup",ie);Oe={rotation:0,speedX:O.speed,speedY:O.speed};var Me=t.Ticker.add(function(){if(x){Le(V);return}var We=O.speed,ce=O.speed;if(O.axis=="both"&&V.dirX!=0&&V.dirY!=0){var Ve=Ie(V.dirX,V.dirY);We=Ve.speedX,ce=Ve.speedY}(O.axis=="horizontal"||O.axis=="both")&&(O.x+=We*V.dirX),(O.axis=="vertical"||O.axis=="both")&&(O.y+=ce*V.dirY),me()},X)}else if(r=="mousedown"||r=="mousemove")h=X.on("stage"+r,function(We){X=We.target.stage;var ce,Ve;if(!_&&O.boundary&&!O.boundary.type=="Blob"?Ve=O.boundary:!_&&I&&(Ve=I.boundsToGlobal()),!(Ve&&(ce={x:We.stageX/t.scaX,y:We.stageY/t.scaY},ce.x<Ve.x||ce.x>Ve.x+Ve.width||ce.y<Ve.y||ce.y>Ve.y+Ve.height))){if(r=="mousedown"){if(Array.isArray(O.mousedownIncludes)||(O.mousedownIncludes=[O.mousedownIncludes]),O.mousedownIncludes.indexOf(I)<0)for(G=0;G<I.numChildren;G++){var Se=I.getChildAt(G);if(O.mousedownIncludes.indexOf(Se)==-1&&Se.mouseEnabled&&Se.hitTestPoint&&Se.hitTestPoint(We.stageX/t.scaX,We.stageY/t.scaY))return}O.dispatchEvent("mousedown")}var Ae=I.globalToLocal(E?We.rawX/t.scaX:We.stageX/t.scaX,E?We.rawY/t.scaY:We.stageY/t.scaY);O.x=Ae.x,O.y=Ae.y,me()}});else if(r=="pressmove"||r=="pressdrag"||r=="follow")e.type=="Pen"&&(e.write=!1),h=X.on("stagemousedown",function(We){var ce,Ve;if(!_&&O.boundary&&!O.boundary.type=="Blob"?Ve=O.boundary:!_&&I&&(Ve=I.boundsToGlobal()),!(Ve&&(ce={x:We.stageX/t.scaX,y:We.stageY/t.scaY},ce.x<Ve.x||ce.x>Ve.x+Ve.width||ce.y<Ve.y||ce.y>Ve.y+Ve.height))&&!(O.boundary&&O.boundary.type=="Blob"&&(r=="pressmove"||r=="pressdrag")&&(ce={x:We.stageX/t.scaX,y:We.stageY/t.scaY},!O.boundary.shape.hitTestPoint(ce.x,ce.y)))&&!(r=="pressdrag"&&!e.hitTestPoint(We.stageX/t.scaX,We.stageY/t.scaY))){re=!1,Array.isArray(O.mousedownIncludes)||(O.mousedownIncludes=[O.mousedownIncludes]);var Se=!1;for(O.mouseDownIncludes&&(le=X.getObjectUnderPoint(We.stageX,We.stageY,1)),G=0;G<O.mousedownIncludes.length;G++)le&&O.mousedownIncludes[G].hitTestPoint&&O.mousedownIncludes[G].hitTestPoint(We.stageX/t.scaX,We.stageY/t.scaY)&&O.mousedownIncludes[G].contains(le)&&(Se=!0);if(!Se)for(G=0;G<I.numChildren;G++){var Ae=I.getChildAt(G);if(O.mousedownIncludes.indexOf(Ae)==-1&&Ae.mouseEnabled&&Ae.hitTestPoint&&Ae.hitTestPoint(We.stageX/t.scaX,We.stageY/t.scaY))return}var Ye=I.globalToLocal(E?We.rawX/t.scaX:We.stageX/t.scaX,E?We.rawY/t.scaY:We.stageY/t.scaY);r!="follow"&&r!="pressdrag"&&O.immediate(l=="both"||l=="horizontal"?Ye.x:null,l=="both"||l=="vertical"?Ye.y:null),me(),O.dispatchEvent("mousedown"),N=!0,O.moveX=E?We.rawX/t.scaX:We.stageX/t.scaX,O.moveY=E?We.rawY/t.scaY:We.stageY/t.scaY,b=X.on("stagemousemove",function(Xe){O.moveX=E?Xe.rawX/t.scaX:Xe.stageX/t.scaX,O.moveY=E?Xe.rawY/t.scaY:Xe.stageY/t.scaY,r!="follow"&&be()}),B&&t.Ticker.remove(B),r=="follow"&&(B=t.Ticker.add(be)),e.type=="Pen"&&(e.write=!0,e.paper.noMouse(),e.zimDragCheck=!0)}}),ye=X.on("stagemouseup",function(){e.type=="Pen"&&(e.write=!1,e.paper.mouse(),e.zimDragCheck=!1,re&&e.stopCheck()),B&&t.Ticker.remove(B),X.off("stagemousemove",b),N=!1});else if(r=="gamestick"){for(se=this.gamepad=new t.GamePad,G=0;G<4;G++)Array.isArray(s[G])||(s[G]=[s[G]]);Oe={rotation:e.zimMCStartAngle,speedX:O.speed,speedY:O.speed};var te=se.on("data",function(We){for(V={dirX:0,dirY:0},G=0;G<s[0].length;G++)if(z=We.axes[s[0][G]],Math.abs(z)>O.stickThreshold){V.dirX=z;break}for(G=0;G<s[2].length;G++)if(z=We.axes[s[2][G]],Math.abs(z)>O.stickThreshold){V.dirY=z;break}if(x){Le(V);return}O.x+=O.speed*V.dirX,O.y+=O.speed*V.dirY,me()})}else if(r=="swipe")var ae=new t.Swiper(X,O,"x",.8),we=new t.Swiper(X,O,"y",.8,!1),ue=ae.on("swipemove",function(){me()});function Pe(We){var ce=r=="keydown"?We.keyCode:We.buttonCode,Ve;for(G=0;G<4;G++)if(s[G].indexOf(ce)>-1){if(!f&&O.axis=="both"&&(V.dirX=V.dirY=0),V["dir"+Z[G]]=de[G],J[G]=1,Ve=pe.indexOf(G),Ve==0)return;Ve>0&&pe.splice(Ve,1),pe.unshift(G);return}}function ie(We){var ce=r=="keydown"?We.keyCode:We.buttonCode,Ve;for(G=0;G<4;G++)if(s[G].indexOf(ce)>-1){if(J[G]=0,Ve=pe.indexOf(G),Ve>=0&&pe.splice(Ve,1),O.axis!="both"||f)V["dir"+Z[G]]=-J[Math.floor(G/2)*2]+J[Math.floor(G/2)*2+1];else if(pe.length>0){V["dir"+Z[G]]=0;var Se=pe[0];V["dir"+Z[Se]]=de[Se]}else V.dirX=V.dirY=0;return}}function be(){var We=I.globalToLocal(O.moveX,O.moveY);O.x=We.x,O.y=We.y,me(),e.type=="Pen"&&!re&&e.drawing&&(re=!0)}function Le(We){Oe.rotation+=We.dirX*O.turnSpeed,O.rotation=Oe.rotation,Oe.speedX=Math.sin(Oe.rotation*Math.PI/180)*O.speed*-We.dirY,Oe.speedY=-Math.cos(Oe.rotation*Math.PI/180)*O.speed*-We.dirY,O.x+=Oe.speedX,O.y+=Oe.speedY}function me(){var We=O.x-(K?O.target.percentSpeed:O.target.x),ce=O.y-(K?O.target.percentSpeed:O.target.y),Ve=Ie(We,ce);if(ne=Ve.speedX,U=Ve.speedY,!!Y){if(n(Ve.angle)||(O.rotation=Ve.angle+e.zimMCStartAngle),n(O.rotation)){O.rotation=O.target.rotation;return}O.rotation+=D;var Se=ee(O.rotation),Ae=O.target.rotation=ee(O.target.rotation);Math.abs(Se-Ae)>180&&(Ae>Se?Ae-=360:Se-=360),O.dampR.immediate(Ae),O.target.rotation=Ae,O.rotation=Se}}function ee(We){return(We%360+360)%360}function Ie(We,ce){var Ve=O.speed,Se=O.speed,Ae,Ye=Math.sqrt(Math.pow(We,2)+Math.pow(ce,2));return Ye>0&&(Ve=Math.abs(We)/Ye*O.speed,Se=Math.abs(ce)/Ye*O.speed,Ae=90-Math.atan2(We,ce)*180/Math.PI),{speedX:Ve,speedY:Se,angle:Ae}}var Re=this.x,_e=this.y,Ze=this.x,at=this.y,Be=this.x=K?o/2:this.target.x,He=this.y=K?o/2:this.target.y;this.dampX=new t.Damp(Be,c),this.dampY=new t.Damp(He,c),this.dampR=new t.Damp(this.target.rotation,c);var et=0,ge=0,xe=t.Ticker.add(function(){if(r=="manual"&&me(),O.boundary&&O.boundary.type!="Blob"&&(O.x=t.constrain(O.x,O.boundary.x,O.boundary.x+O.boundary.width),O.y=t.constrain(O.y,O.boundary.y,O.boundary.y+O.boundary.height)),O.axis=="horizontal"||O.axis=="both"){if(O.dirX=t.sign(O.x-Be),Math.abs(O.x-Be)<ne?Be=O.x:Be+=O.dirX*ne,V&&V.dirX==0){var We=O.boundary?O.boundary.width/2:X.width/2,ce=O.x-(O.x-We)*(K?O.dampKeyup:0);Be=ce,O.x=Be}K&&u&&u.width?O.target.percentSpeed=d.convert(O.dampX.convert(Be)):O.target.x=O.dampX.convert(Be)}if(O.axis=="vertical"||O.axis=="both"){if(O.dirY=t.sign(O.y-He),Math.abs(O.y-He)<U?He=O.y:He+=t.sign(O.y-He)*U,V&&V.dirY==0){We=O.boundary?O.boundary.height/2:X.height/2;var Ve=O.y-(O.y-We)*(K?O.dampKeyup:0);He=Ve,O.y=He}K&&u&&u.height?O.target.percentSpeed=d.convert(O.dampY.convert(He)):O.target.y=O.dampY.convert(He)}if(O.boundary&&O.boundary.type=="Blob"&&(O.boundary.shape.hitTestPoint(O.target.x,O.target.y)?(Re=O.target.x,_e=O.target.y):(O.target.x=O.x=Re,O.target.y=O.y=_e,O.immediate(Re,_e))),r=="pressmove"&&N&&O.dispatchEvent("pressing"),c==1?(O.movingX=Math.round(Ze-O.x)!=0,O.movingY=Math.round(at-O.y)!=0,Ze=O.x,at=O.y):(O.movingX=Math.abs(Be-(K?O.target.percentSpeed:O.target.x))>O.moveThreshold,O.movingY=Math.abs(He-(K?O.target.percentSpeed:O.target.y))>O.moveThreshold),O.moving&&!(O.movingX||O.movingY)?O.dispatchEvent("stopmoving"):!O.moving&&(O.movingX||O.movingY)&&O.dispatchEvent("startmoving"),O.moving=O.movingX||O.movingY,O.moving&&O.dispatchEvent("moving"),O.dirX!=et||O.dirY!=ge){var Se=new Ne.Event("change"),Ae;O.dirX!=et?(Ae=["left",null,"right"],Se.dir=Ae[O.dirX+1],et=O.dirX,!e.zimMCStartAngle&&(w=="horizontal"||w=="both")&&(O.scaleX=e.scaleX=O.dirX?Math.abs(e.scaleX)*O.dirX:e.scaleX,S!=0&&Math.round(O.scaleX/S)==-1?D=180:D=0)):(Ae=["up",null,"down"],Se.dir=Ae[O.dirY+1],ge=O.dirY,!e.zimMCStartAngle&&(w=="vertical"||w=="both")&&(O.scaleY=e.scaleY=O.dirY?-Math.abs(e.scaleY)*O.dirY:e.scaleY,F!=0&&Math.round(O.scaleY/F)==-1?D=180:D=0)),O.dispatchEvent(Se)}Y&&!n(O.rotation)&&(O.target.rotation=O.dampR.convert(O.rotation))},X);this.immediate=function(We,ce,Ve){return!n(We)&&O.dampX&&(O.dampX.immediate(We),K?O.x=O.target.percentSpeed=Be=We:O.x=O.target.x=Be=We,ae&&ae.immediate(We)),!n(ce)&&O.dampY&&(O.dampY.immediate(ce),K?O.y=O.target.percentSpeed=He=ce:O.y=O.target.y=He=ce,we&&we.immediate(ce)),!n(Ve)&&O.dampR&&(O.dampR.immediate(Ve),O.rotation=O.target.rotation=Ve),Re=O.x,_e=O.y,O},this.convert=function(We,ce){n(We)||(O.x=We),n(ce)||(O.y=ce),me()},Object.defineProperty(O,"pausingSpeed",{get:function(){return O.speed},set:function(We){O.speed=We}}),this.paused=!1;var he;this.pause=function(We,ce,Ve){return n(We)&&(We=!0),n(ce)&&(ce=0),n(Ve)&&(Ve=!1),We?(he=O.speed,ce>0?(t.animate({target:O,obj:{pausingSpeed:0},ticker:!1,time:ce,call:function(){O.speed=0,O.paused=!0,O.enabled=!1,O.immediate(O.target.x,O.target.y),O.dispatchEvent("pause")}}),Ve&&(N=!1,b&&X.off("stagemousemove",b),B&&t.Ticker.remove(B),e.type=="Pen"&&(e.write=!1,e.zimDragCheck=!1),ye&&X.off("stagemouseup",ye),re&&e.stopCheck(),r=="keydown"?oe&&Q.off("keyup",oe):Ce&&se.off("buttonup",Ce))):(O.speed=0,O.paused=!0,O.enabled=!1,O.immediate(O.target.x,O.target.y),setTimeout(function(){O.dispatchEvent("pause")},10))):(O.enabled=!0,ce>0?t.animate({target:O,obj:{pausingSpeed:he},ticker:!1,time:ce,call:function(){O.speed=he,O.paused=!1}}):(O.speed=he,O.paused=!1)),O};var Ge=!0;Object.defineProperty(O,"enabled",{get:function(){return Ge},set:function(We){Ge!=We&&(We?(qe(),O.paused=!1):(Fe(),O.paused=!0),Ge=!!We)}});function qe(){r=="keydown"?(fe=Q.on("keydown",fe),oe&&(oe=Q.on("keyup",oe)),Me=t.Ticker.add(Me,X)):r=="gamebutton"?(ke=se.on("buttondown",ke),Ce&&(Ce=se.on("buttonup",Ce)),Me=t.Ticker.add(Me,X)):r=="gamestick"?te=se.on("data",te):r=="swipe"?(ae.enabled=!0,we.enabled=!0,ue&&(ue=ae.on("swipemove",ue))):r=="mousedown"||r=="mousemove"?h=X.on("stage"+r,h):r=="pressmove"&&(h=X.on("stagemousedown",h),b&&(b=X.on("stagemousemove",b)),ye&&(ye=X.on("stagemouseup",ye))),xe=t.Ticker.add(xe,X)}function Fe(){r=="keydown"?(Q.off("keydown",fe),Q.off("keyup",oe),t.Ticker.remove(Me)):r=="gamebutton"?(se.off("buttondown",ke),se.off("buttonup",Ce),t.Ticker.remove(Me)):r=="gamestick"?se.off("data",te):r=="swipe"?(ae.enabled=!1,we.enabled=!1,ae.off("swipemove",ue)):r=="mousedown"||r=="mousemove"?X.off("stage"+r,h):r=="pressmove"&&(X.off("stagemousedown",h),X.off("stagemousemove",b),X.off("stagemouseup",ye)),t.Ticker.remove(xe)}this.dispose=function(){Fe(),se&&se.dispose(),ae&&ae.dispose(),we&&ae.dispose()}},t.extend(t.MotionController,Ne.EventDispatcher,"enabled","cjsEventDispatcher"),t.GamePad=function(){if(De("69.8"),this.type="GamePad",this.cjsEventDispatcher_constructor(),!navigator.getGamepads){this.error=!0,dt&&tt("zim.GamePad() - no browswer support");return}var e;j.addEventListener("gamepadconnected",i),this.currentIndex=0;var r=this;function i(f){r.connected=!0,a("gamepadconnected",f);var c=navigator.getGamepads()[r.currentIndex];r.lastData=[];for(var w=0;w<c.buttons.length;w++)r.lastData[w]=c.buttons[w].pressed;function T(){if(e=requestAnimationFrame(T),r.data=navigator.getGamepads()[r.currentIndex],!!r.data){for(var p=r.buttons=[],x,P=0;P<r.data.buttons.length;P++)p[P]=r.data.buttons[P].pressed,p[P]!=r.lastData[P]&&(r.lastData[P]=p[P],p[P]?x=new Ne.Event("buttondown"):x=new Ne.Event("buttonup"),x.buttonCode=P,x.button=Xt[P],r.dispatchEvent(x));x=new Ne.Event("data"),x.axes=r.axes=r.data.axes,x.buttons=r.buttons,r.dispatchEvent(x)}}T()}var l=setInterval(function(){navigator.getGamepads&&navigator.getGamepads()[0]&&(r.connected||i(),clearInterval(l))},500);function a(f,c){var w=new Ne.Event(f);w.index=c.gamepad.index,w.id=c.gamepad.id,w.buttons=c.gamepad.buttons,w.axes=c.gamepad.axes,r.dispatchEvent(w)}var s=function(f){f.gamepad.index==r.currentIndex&&(cancelAnimationFrame(e),r.connected=!1,r.dispatchEvent("gamepaddisconnected"))};j.addEventListener("gamepaddisconnected",s),this.dispose=function(){j.removeEventListener("gamepadconnected",i),j.removeEventListener("gamepaddisconnected",s),cancelAnimationFrame(e),clearInterval(l),r.connected=!1}};var Xt=["A","B","X","Y","LB","RB","LT","RT","BACK","START","LS","RS","DPAD_UP","DPAD_DOWN","DPAD_LEFT","DPAD_RIGHT"];for(cn=0;cn<Xt.length;cn++)t.GamePad[Xt[cn]]=cn;var qt=["LSX","LSY","RSX","RSY"];for(cn=0;cn<qt.length;cn++)t.GamePad[qt[cn]]=cn;t.extend(t.GamePad,Ne.EventDispatcher,null,"cjsEventDispatcher"),t.Portal=function(e,r){var i="obj, lands",l;if(l=st(t.Portal,arguments,i,this))return l;if(De("69.96"),n(e)||!e.stage)return;this.type="Portal";var a=this,s=r&&r.numChildren&&r.numChildren>0;if(s){var f=r.getChildAt(r.numChildren-1),c=r.getChildAt(r.numChildren-2);r.setChildIndex(c,r.numChildren-1),c.setMask(e)}function w(){r.setChildIndex(f,0),f=c,c=r.getChildAt(r.numChildren-2),r.setChildIndex(c,r.numChildren-1),f.setMask(null),c.setMask(e),e.stage.update()}e.on(t.mobile()?"mousedown":"mouseover",function(){a._enabled&&(s&&w(),a.dispatchEvent("enter"))}),e.on(t.mobile()?"pressup":"mouseout",function(){a._enabled&&a.dispatchEvent("exit")}),Object.defineProperty(this,"portal",{get:function(){return e},set:function(T){if((n(T)||!T.stage)&&dt){tt("zim.Portal() - please provide a Display Object to act as the portal");return}c.setMask(e)}}),Object.defineProperty(this,"currentLand",{get:function(){return f},set:function(T){if(r.contains(T))for(;T!=f;)w()}}),Object.defineProperty(this,"nextLand",{get:function(){return c},set:function(){if(dt){tt("zim.Portal() - nextLand is read only - remake Portal to change");return}}}),this._enabled=!0,Object.defineProperty(a,"enabled",{get:function(){return a._enabled},set:function(T){a._enabled=T}})},t.extend(t.Portal,Ne.EventDispatcher,null,"cjsEventDispatcher",!1),j.zimContactListener=null;var At,Nt;function Ke(e,r,i,l,a,s,f,c,w,T,p,x){if(De("69.97"),n(i)&&(i=0),l=="rectangle")e.body=e.physics.makeRectangle(e.width-i,e.height-i,r,a,f,c,w,T,p,s,x);else if(l=="circle")e.body=e.physics.makeCircle(e.width/2-i,r,a,f,c,w,T,p,s,x);else if(l=="triangle")n(e.a)&&(e.a=e.width,e.b=e.c=Math.sqrt(Math.pow(e.a/2,2)+Math.pow(e.height,2))),e.body=e.physics.makeTriangle(e.a-i,e.b-i,e.c-i,r,a,f,c,w,T,p,s,x);else if(l=="poly"){var P=[];e.reg(0,0,!0);var m=e;e.scale!=1&&(m=e.clone().transformPoints("scale",e.scale)),i&&(m=e.clone().transformPoints("scale",Math.max(0,1-i/((e.width+e.height)/4)))),t.loop(m.points,function(I){P.push({x:I[0],y:I[1]})}),e.body=e.physics.makePoly(P,e.width,e.height,r,a,f,c,w,T,p,s,x)}e.body.x=e.x,e.body.y=e.y,e.body.rotation=e.rotation,e.physics.addMap(e.body,e),e.impulse=function(I,g,E,A){n(I)&&(I=0),n(g)&&(g=0);var y=e.body.GetWorldCenter();return n(E)&&(E=y.x*e.physics.scale),n(A)&&(A=y.y*e.physics.scale),e.body.ApplyImpulse(new j.b2Vec2(I,g),new j.b2Vec2(E/e.physics.scale,A/e.physics.scale)),e},e.force=function(I,g,E,A){n(I)&&(I=0),n(g)&&(g=0);var y=e.body.GetWorldCenter();return n(E)&&(E=y.x*e.physics.scale),n(A)&&(A=y.y*e.physics.scale),e.body.ApplyForce(new j.b2Vec2(I,g),new j.b2Vec2(E/e.physics.scale,A/e.physics.scale)),e},e.setLinearVelocity=function(I,g){return e.body.SetLinearVelocity(new j.b2Vec2(I,g)),e},e.setAngularVelocity=function(I){return e.body.SetAngularVelocity(I),e},e.spin=function(I){return n(I)&&(I=10),e.body.ApplyTorque(I*1e3),e},e.torque=function(I){return n(I)&&(I=10),e.body.ApplyTorque(I),e},e.follow=function(I,g,E,A,y,C,L,Y,_,k,$,O){var X="damp, dampY, leftOffset, rightOffset, upOffset, downOffset, offsetDamp, offsetDampY, horizontal, vertical, borderLock, borderOriginal",R;return(R=st(e.follow,arguments,X))?R:(e.physics.follow(e,I,g,E,A,y,C,L,Y,_,k,$,O),e)},e.noFollow=function(){return e.physics.follow(null),e},e.control=function(I,g,E,A,y){var C="type, speed, speedY, horizontal, vertical",L;return(L=st(e.control,arguments,C))?L:(e.physics.control(e,I,g,E,A,y),e)},e.customControl=function(I,g,E){var A="dir, speed, speedY",y;return(y=st(e.customControl,arguments,A))?y:(e.physics.customControl(I,g,E),e)},e.noControl=function(){return e.physics.noControl(e),e},e.sleep=function(){return e.body.SetAwake(!1),e},e.wake=function(){return e.body.SetAwake(!0),e};function v(){j.zimContactListener=new j.b2ContactListener,At=new t.Dictionary(!0),Nt=new t.Dictionary(!0),j.zimContactListener.BeginContact=I,j.zimContactListener.EndContact=g;function I(E){var A=At.at(E.m_fixtureB.GetBody());A&&A(E.m_fixtureA.GetBody().zimObj,E.m_fixtureA.GetBody()),A=At.at(E.m_fixtureA.GetBody()),A&&A(E.m_fixtureB.GetBody().zimObj,E.m_fixtureB.GetBody())}function g(E){var A=Nt.at(E.m_fixtureB.GetBody());A&&A(E.m_fixtureA.GetBody().zimObj,E.m_fixtureA.GetBody()),A=Nt.at(E.m_fixtureA.GetBody()),A&&A(E.m_fixtureB.GetBody().zimObj,E.m_fixtureB.GetBody())}e.physics.world.SetContactListener(j.zimContactListener)}e.contact=function(I){return j.zimContactListener||v(),At.add(e.body,I),e},e.noContact=function(){return At.remove(e.body),e},e.contactEnd=function(I){return j.zimContactListener||v(),Nt.add(e.body,I),e},e.noContactEnd=function(){return Nt.remove(e.body),e},e.hasOwnProperty("dynamic")||Object.defineProperty(e,"dynamic",{get:function(){return e.body.GetType()==2},set:function(I){e.body.SetType(I==!0?2:0)}})}for(t.Timeline=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v){var I="objects, width, startPaused, barColor, buttonColor, themeColor, corner, ticks, damp, loop, noLoop, call, style, group, inherit",g;if(g=st(t.Timeline,arguments,I,this))return g;De("69.971"),this.group=m;var E=P===!1?{}:t.getStyle("Timeline",m,v),A=this.stage?this.stage:zimDefaultFrame.stage,y=A.frame,C=A.width,L=A.height;n(i)&&(i=E.startPaused!=null?E.startPaused:!1),n(T)&&(T=E.loop!=null?E.loop:!0),n(p)&&(p=E.noLoop!=null?E.noLoop:!1),n(l)&&(l=E.barColor!=null?E.barColor:t.tin),n(a)&&(a=E.buttonColor!=null?E.buttonColor:t.light),n(s)&&(s=E.themeColor!=null?E.themeColor:t.purple),n(r)&&(r=E.width!=null?E.width:C*.5),n(c)&&(c=E.ticks!=null?E.ticks:!0),n(w)&&(w=E.damp!=null?E.damp:!1),n(N)&&(N=E.labels!=null?E.labels:!0),n(f)&&(f=E.corner!=null?E.corner:5);var Y=50;this.zimContainer_constructor(r,Y,null,null,!1),this.type="Timeline";var _=this,k=e,$=t.toBW(y.color);if(n(k)){if(!t.animatedObjects||!t.animatedObjects.objects)return tt("ZIM Timeline - add Timeline after animated objects"),_;k=t.copy(t.animatedObjects.objects)}Array.isArray(k)||(k=[k]);var O=Date.now(),X=0;t.loop(k,function(Ce){Ce.pauseAnimate(),Ce.tweenEndTime&&Ce.tweenEndTime>X&&(X=Ce.tweenEndTime)});var R=Math.ceil((X-O)/1e3),Q=this.backing=new t.Rectangle(r,Y,l,null,null,f).alp(.8).addTo(_),K=$=="#000000"?0:1,q=this.shade=new t.Rectangle(Y-K,Y-K*2,black,null,null,[f,0,0,f]).alp(.7).pos(K,K,LEFT,TOP,_),ne=this.shade2=new t.Rectangle(Y-K,Y-K*2,black,null,null,[0,f,f,0]).alp(.7).pos(K,K,RIGHT,TOP,_),U=new t.Container(50,50).alp(.9);new t.Rectangle(7,24,white).center(U).mov(-6),new t.Rectangle(7,24,white).center(U).mov(6);var D=_.controls=new t.Button({icon:new t.Triangle(30,30,30,white).reg(null,16).rot(90).alp(.9),toggleIcon:U.reg("center"),downBackgroundColor:t.purple.darken(.2),width:50,height:50,corner:25}).scaleTo(Q,null,70).center(q).addTo(_).expand(10).tap(function(){J.pauseAnimate(!D.toggled)});i||D.toggle();var d=new t.Container(50,50).reg("center").alp(.8).expand(10);new Sn(24,5,t.white).center(d).mov(0,-8),new Sn(24,5,t.white).center(d),new Sn(24,5,t.white).center(d).mov(0,8);var u=!0,o=_.menu=new t.Button({icon:d,downBackgroundColor:t.purple.darken(.2),width:50,height:50,corner:25}).scaleTo(Q,null,70).center(ne).addTo(_).tap(function(){Oe.show(),u&&Oe.loc(_.x,_.y).mov(_.width-Oe.width/2,-Oe.height/2-10)});function S(Ce){J.rate=Ce,oe.speed=Ce,_.trailInterval.time=ke.convert(oe.speed),localStorage&&(localStorage.zim_tl=JSON.stringify(oe))}function F(Ce){J.ticks.vis(Ce),J.labels.vis(Ce),A.update(),oe.labels=Ce,localStorage&&(localStorage.zim_tl=JSON.stringify(oe))}function h(Ce){T=Ce,oe.looping=Ce,localStorage&&(localStorage.zim_tl=JSON.stringify(oe))}function b(Ce){fe(),Ce&&(J.percentComplete=0,setTimeout(function(){V()},50)),oe.trailing=Ce,localStorage&&(localStorage.zim_tl=JSON.stringify(oe))}function ye(Ce){return t.loop([D,o],function(Me){Me.backgroundColor=Ce,Me.toggleBackgroundColor=Ce,Me.rollBackgroundColor=Ce.lighten(.2),Me.rollToggleBackgroundColor=Ce.lighten(.2),Me.downBackgroundColor=Ce.darken(.2)}),Oe.backing.color=Ce,B.slider.bar.color=Ce,A.update(),oe.color=Ce,localStorage&&(localStorage.zim_tl=JSON.stringify(oe)),this}this.setThemeColor=ye;var B=t.List.slider("speed",0,2,1,S,.1),N=t.List.checkBox("labels",!1,F),re=t.List.checkBox("loop",!1,h),le=t.List.checkBox("trails",!1,b),G=t.List.colorPicker("color",t.purple,new t.ColorPicker({colors:[t.purple,t.pink,t.red,t.orange,t.brown,t.green,t.blue,t.grey,t.black],cols:9}),ye),z=this.title=new t.Container(300,25).noMouse();new t.Rectangle(500,70,t.black.toAlpha(.4)).pos(0,-45,CENTER,TOP,z),this.icon=y.makeIcon({edges:"white",box:faint,slats:["white","white","white","white","white"]}).alp(.6).scaleTo(z,null,140).pos(7,-10,"left","center",z),new t.Label({text:"Z  I  M  -  T  I  M  E  L  I  N  E",color:"white"}).alp(.6).sca(.47).loc(51,-4,z),new t.Line(219,1,"white").alp(.6).center(z).mov(8,3);var se=this.list=new t.List({width:300,height:260,backdropColor:clear,borderWidth:-1,shadowColor:-1,viewNum:6,padding:12,scrollBarV:!1,list:[B,N,re,le,G],swipe:!1});B.slider.bar.color=t.purple,se.tabs.mov(0,8);var Oe=_.pane=new t.Pane({width:se.width,height:se.height+40,backgroundColor:t.purple,backdropColor:t.faint,draggable:!0,corner:8,content:se,resets:!1});Oe.contentContainer.mov(0,20),Oe.backing.on("pressmove",function(){u=!1},null,!0),z.scaleTo(Oe.contentContainer,100).pos(0,2,"center","top",Oe.contentContainer).setMask(Oe.backing);var J=_.slider=new t.Slider({min:0,max:R,inside:!0,barColor:l,barWidth:Y,barLength:r-Y*2-12,tickColor:$.toAlpha(.8),damp:w,useTicks:!0,tickScale:1,tickStep:.1,semiTicks:4,semiTickScale:1,useLabels:!0,labelColor:$.toAlpha(.8)}).center(_,1);J.bar.dye(t.faint),J.currentValue=0,J.ticks.mov(0,-20),J.bar.widthOnly=J.bar.width+14,new t.Triangle({color:t.dark}).alp(.3).scaleTo(J.button,70,90,"full").center(J.button),J.animate({props:{currentValue:J.max},time:J.max,ease:"linear",startPaused:i,loop:!0,loopWait:.5,loopWaitCall:function(){T||(J.pauseAnimate(),D.toggle(!1),J.currentValue=J.max),Z&&_.trailInterval.pause(),x&&typeof x=="function"&&x()},loopCall:function(){t.loop(k,function(Ce){Ce.percentComplete=0})}}),J.bar.on("mousedown",function(){J.percentComplete=J.currentValue/J.max*100});var pe=!0;J.button.on("mousedown",function(){pe=J.animating,J.pauseAnimate()}),J.button.on("pressup",function(){pe&&J.pauseAnimate(!1),J.percentComplete=J.currentValue/J.max*100}),_.keyEvent=y.on("keydown",function(Ce){Ce.key==" "&&(D.toggled?(D.toggle(!1),J.pauseAnimate(!0)):(D.toggle(!0),J.pauseAnimate(!1)))}),_.tickerID=t.Ticker.add(function(){var Ce=Math.min(100,_.slider.currentValue/R*100)-.01;t.loop(k,function(Me){var te=O+Ce/100*(X-O)-Me.tweenStartTime;p&&(Me.percentComplete=Math.max(0,Math.min(100,te/(Me.tweenEndTime-Me.tweenStartTime)*100))),Me.percentComplete=te/(Me.tweenEndTime-Me.tweenStartTime)*100})});var Z;function de(){t.loop(k,function(Ce){var Me=Ce.clone().addTo(Z).alp(.05);Me.color=clear,Me.borderColor=$}),Z.updateCache("source-over"),Z.disposeAllChildren()}_.trailInterval=t.interval(.05,function(){J.animating&&B.slider.currentValue>0&&de()}),_.trailInterval.pause();function V(){_.trails||(Z=new t.Container(C,L).addTo(A,0).cache(),_.trails=new t.Bitmap(Z.cacheCanvas).addTo(A,1),_.trailInterval.pause(!1))}function fe(){_.trails&&(_.trailInterval.pause(),_.trails.dispose(),_.trails=null,Z.dispose(),Z=null)}var ke=new t.Proportion(.1,2,.1,.01);if(localStorage){var oe=localStorage.zim_tl;oe||(oe=JSON.stringify({speed:1,labels:!1,looping:!1,color:purple})),oe=JSON.parse(oe),S(oe.speed),B.slider.currentValue=oe.speed,B.stepper.currentValue=oe.speed,F(oe.labels),N.checkBox.checked=oe.labels,h(oe.looping),re.checkBox.checked=oe.looping,ye(oe.color),G.colorPicker.selectedColor=oe.color,G.swatch.color=oe.color,G.colorLabel.text=oe.color.toUpperCase(),oe.trailing&&V(),le.checkBox.checked=oe.trailing,_.trailInterval.time=ke.convert(oe.speed)}this.pos(0,20,"center","bottom"),s!=t.purple&&ye(s),this.dispose=function(Ce,Me,te){return t.Ticker.remove(_.tickerID),y.off("keydown",_.keyEvent),te||this.zimContainer_dispose(!0),!0},P!==!1&&t.styleTransforms(this,E)},t.extend(t.Timeline,t.Container,"dispose","zimContainer",!1),t.BlurEffect=function(e,r,i,l,a,s){var f="blurX, blurY, quality, style, group, inherit",c;if(c=st(t.BlurEffect,arguments,f,this))return c;De("69.972"),this.group=a;var w=l===!1?{}:t.getStyle("BlurEffect",a,s);n(e)&&(e=w.blurX!=null?w.blurX:10),n(r)&&(r=w.blurY!=null?w.blurY:10),n(i)&&(i=w.quality!=null?w.quality:1);var T=p(e,r,i);this.veeObj={blurX:T[0],blurY:T[1],quality:T[2]};function p(){return arguments}e=nt(e),r=nt(r),i=nt(i),this.createjsBlurFilter_constructor(e,r,i),this.type="BlurEffect",this.clone=function(x){return new t.BlurEffect(x||!t.isPick(T[0])?e:T[0],x||!t.isPick(T[1])?r:T[1],x||!t.isPick(T[2])?i:T[2],l,this.group,s)}},t.extend(t.BlurEffect,Ne.BlurFilter,"clone","createjsBlurFilter",!1),t.GlowEffect=function(e,r,i,l,a,s,f,c,w,T,p,x){var P="color, alpha, blurX, blurY, strength, quality, inner, knockout, hideObject, style, group, inherit",m;if(m=st(t.GlowEffect,arguments,P,this))return m;De("69.9725"),this.group=p;var v=T===!1?{}:t.getStyle("GlowEffect",p,x);n(e)&&(e=v.color!=null?v.color:t.white),n(r)&&(r=v.alpha!=null?v.alpha:1),n(i)&&(i=v.blurX!=null?v.blurX:30),n(l)&&(l=v.blurY!=null?v.blurY:30),n(a)&&(a=v.strength!=null?v.strength:1),n(s)&&(s=v.quality!=null?v.quality:1),n(f)&&(f=v.inner!=null?v.inner:!1),n(c)&&(c=v.knockout!=null?v.knockout:!1),n(w)&&(w=v.hideObject!=null?v.hideObject:!1);var I=g(e,r,i,l,a,s,f,c,w);this.veeObj={color:I[0],alpha:I[1],blurX:I[2],blurY:I[3],strength:I[4],quality:I[5],inner:I[6],knockout:I[7],hideObject:I[8]};function g(){return arguments}i=nt(i),l=nt(l),s=nt(s),e=nt(e),this.alpha=nt(r),this.strength=nt(a),this.inner=nt(f),this.knockout=nt(c),this.hideObject=nt(w),this.createjsBlurFilter_constructor(i,l,s),this.type="GlowEffect",this.usesContext=!0,this.applyFilter=function(E,A,y,C,L,Y,_,k){if((this.alpha<=0||this.strength<=0)&&!this.knockout)return!0;Y=Y||E,_===void 0&&(_=A),k===void 0&&(k=y);var $=Y.getImageData(_,k,C,L),O=$.data,X=document.createElement("canvas");X.width=C,X.height=L;for(var R=X.getContext("2d",{willReadFrequently:!0}),Q=R.getImageData(0,0,C,L),K=Q.data,q=this.inner,ne=this._red,U=this._green,D=this._blue,d=0,u=K.length;d<u;d+=4){var o=d+3,S=O[o];q?S!==255&&(K[d]=ne,K[d+1]=U,K[d+2]=D,K[o]=255-S):S!==0&&(K[d]=ne,K[d+1]=U,K[d+2]=D,K[o]=S)}R.putImageData(Q,0,0);var F=this.strength;if(0<F){this.createjsBlurFilter_applyFilter(R,0,0,C,L),255<F&&(F=255);for(var h=1;h<F;h++)R.drawImage(X,0,0)}var b=this.alpha;b<0?b=0:1<b&&(b=1);var ye;return this.knockout?q?ye="source-in":ye="source-out":this.hideObject?q?ye="source-in":ye="copy":q?ye="source-atop":ye="destination-over",Y.save(),Y.setTransform(1,0,0,1,0,0),Y.globalAlpha=b,Y.globalCompositeOperation=ye,Y.drawImage(X,_,k),Y.restore(),!0},Object.defineProperty(this,"color",{get:function(){return this._red<<16|this._green<<8|this._blue},set:function(E){E=t.convertColor(E,"hexNumber"),this._red=E>>16&255,this._green=E>>8&255,this._blue=E&255}}),this.color=e,this.clone=function(E){return new t.GlowFilter(E||!t.isPick(I[0])?e:I[0],E||!t.isPick(I[1])?r:I[1],E||!t.isPick(I[2])?i:I[2],E||!t.isPick(I[3])?l:I[3],E||!t.isPick(I[4])?s:I[4],E||!t.isPick(I[5])?a:I[5],E||!t.isPick(I[6])?f:I[6],E||!t.isPick(I[7])?c:I[7],E||!t.isPick(I[8])?c:I[8],T,this.group,x)}},t.extend(t.GlowEffect,Ne.BlurFilter,["clone","applyFilter"],"createjsBlurFilter",!1),t.ShadowEffect=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m){var v="distance, angle, color, alpha, blurX, blurY, strength, quality, inner, knockout, hideObject, style, group, inherit",I;if(I=st(t.ShadowEffect,arguments,v,this))return I;De("69.973"),this.group=P;var g=x===!1?{}:t.getStyle("ShadowEffect",P,m);n(e)&&(e=g.distance!=null?g.distance:10),n(r)&&(r=g.angle!=null?g.angle:45),n(i)&&(i=g.color!=null?g.color:t.black),n(l)&&(l=g.alpha!=null?g.alpha:.4),n(a)&&(a=g.blurX!=null?g.blurX:15),n(s)&&(s=g.blurY!=null?g.blurY:15),n(f)&&(f=g.strength!=null?g.strength:1),n(c)&&(c=g.quality!=null?g.quality:1),n(w)&&(w=g.inner!=null?g.inner:!1),n(T)&&(T=g.knockout!=null?g.knockout:!1),n(p)&&(p=g.hideObject!=null?g.hideObject:!1);var E=A(e,r,i,l,a,s,f,c,w,T,p);this.veeObj={distance:E[0],angle:E[1],color:E[2],alpha:E[3],blurX:E[4],blurY:E[5],strength:E[6],quality:E[7],inner:E[8],knockout:E[9],hideObject:E[10]};function A(){return arguments}a=nt(a),s=nt(s),c=nt(c),i=nt(i),e=nt(e),r=nt(r);var y=this;this.alpha=nt(l),this.strength=nt(f),this.inner=nt(w),this.knockout=nt(T),this.hideObject=nt(p),this.createjsBlurFilter_constructor(a,s,c),this.type="ShadowEffect",this.usesContext=!0,Object.defineProperty(this,"angle",{get:function(){return r},set:function(L){r=L=(L%360+360)%360,C(e,L)}}),this.angle=r,Object.defineProperty(this,"distance",{get:function(){return e},set:function(L){e=L,C(L,r)}}),this.distance=e;function C(L,Y){var _=Y*t.RAD;y._offsetX=Math.cos(_)*L,y._offsetY=Math.sin(_)*L}Object.defineProperty(this,"color",{get:function(){return this._red<<16|this._green<<8|this._blue},set:function(L){L=t.convertColor(L,"hexNumber"),this._red=L>>16&255,this._green=L>>8&255,this._blue=L&255}}),this.color=i,this.applyFilter=function(L,Y,_,k,$,O,X,R){if((this.alpha<=0||this.strength<=0)&&!this.knockout&&!this.hideObject)return!0;O=O||L,X===void 0&&(X=Y),R===void 0&&(R=_);var Q=O.getImageData(X,R,k,$),K=Q.data,q=document.createElement("canvas");q.width=k,q.height=$;for(var ne=q.getContext("2d",{willReadFrequently:!0}),U=ne.getImageData(0,0,k,$),D=U.data,d=this.inner,u=this._red,o=this._green,S=this._blue,F=0,h=D.length;F<h;F+=4){var b=F+3,ye=K[b];d?ye!==255&&(D[F]=u,D[F+1]=o,D[F+2]=S,D[b]=255-ye):ye!==0&&(D[F]=u,D[F+1]=o,D[F+2]=S,D[b]=ye)}ne.putImageData(U,0,0);var B=this.strength;if(0<B){this.createjsBlurFilter_applyFilter(ne,0,0,k,$),255<B&&(B=255);for(var N=1;N<B;N++)ne.drawImage(q,0,0)}var re=this.alpha;re<0?re=0:1<re&&(re=1);var le;return this.knockout?d?le="source-in":le="source-out":this.hideObject?d?le="source-in":le="copy":d?le="source-atop":le="destination-over",O.save(),O.setTransform(1,0,0,1,0,0),O.globalAlpha=re,O.globalCompositeOperation=le,O.drawImage(q,X+this._offsetX,R+this._offsetY),O.restore(),!0},this.getBounds=function(L){var Y=this.createjsBlurFilter_getBounds(L),_=this._offsetX,k=this._offsetY;return _!==0&&(_<0?(Y.x+=_,Y.width+=-_):Y.width+=_),k!==0&&(k<0?(Y.y+=k,Y.height+=-k):Y.height+=k),Y},this.clone=function(L){return new t.ShadowFilter(L||!t.isPick(E[0])?e:E[0],L||!t.isPick(E[1])?r:E[1],L||!t.isPick(E[2])?i:E[2],L||!t.isPick(E[3])?l:E[3],L||!t.isPick(E[4])?a:E[4],L||!t.isPick(E[5])?s:E[5],L||!t.isPick(E[6])?c:E[6],L||!t.isPick(E[7])?f:E[7],L||!t.isPick(E[8])?w:E[8],L||!t.isPick(E[9])?T:E[9],L||!t.isPick(E[10])?p:E[10],x,this.group,m)}},t.extend(t.ShadowEffect,Ne.BlurFilter,["clone","getBounds","applyFilter"],"createjsBlurFilter",!1),t.ColorEffect=function(e,r,i,l,a,s,f,c,w,T,p){var x="redMultiplier, greenMultiplier, blueMultiplier, alphaMultiplier, redOffset, greenOffset, blueOffset, alphaOffset, style, group, inherit",P;if(P=st(t.ColorEffect,arguments,x,this))return P;De("69.9735"),this.group=T;var m=w===!1?{}:t.getStyle("ColorEffect",T,p);n(e)&&(e=m.redMultiplier!=null?m.redMultiplier:1),n(r)&&(r=m.greenMultiplier!=null?m.greenMultiplier:1),n(i)&&(i=m.blueMultiplier!=null?m.blueMultiplier:1),n(l)&&(l=m.alphaMultiplier!=null?m.alphaMultiplier:1),n(a)&&(a=m.redOffset!=null?m.redOffset:0),n(s)&&(s=m.greenOffset!=null?m.greenOffset:0),n(f)&&(f=m.blueOffset!=null?m.blueOffset:0),n(c)&&(c=m.alphaOffset!=null?m.alphaOffset:0);var v=I(e,r,i,l,a,s,f,c);this.veeObj={redMultiplier:v[0],greenMultiplier:v[1],blueMultiplier:v[2],alphaMultiplier:v[3],redOffset:v[4],greenOffset:v[5],blueOffset:v[6],alphaOffset:v[7]};function I(){return arguments}e=nt(e),r=nt(r),i=nt(i),l=nt(l),a=nt(a),s=nt(s),f=nt(f),c=nt(c),this.createjsColorFilter_constructor(e,r,i,l,a,s,f,c),this.type="ColorEffect",this.clone=function(g){return new t.ColorEffect(e,r,i,l,a,s,f,c,g||!t.isPick(v[0])?e:v[0],g||!t.isPick(v[1])?r:v[1],g||!t.isPick(v[2])?i:v[2],g||!t.isPick(v[2])?l:v[3],g||!t.isPick(v[2])?a:v[4],g||!t.isPick(v[2])?s:v[5],g||!t.isPick(v[2])?f:v[6],g||!t.isPick(v[2])?c:v[7],w,this.group,p)}},t.extend(t.ColorEffect,Ne.ColorFilter,"clone","createjsColorFilter",!1),t.MultiEffect=function(e,r,i,l,a,s,f){var c="hue, saturation, brightness, contrast, style, group, inherit",w;if(w=st(t.MultiEffect,arguments,c,this))return w;De("69.974"),this.group=s;var T=a===!1?{}:t.getStyle("MultiEffect",s,f);n(e)&&(e=T.hue!=null?T.hue:0),n(r)&&(r=T.saturation!=null?T.saturation:0),n(i)&&(i=T.brightness!=null?T.brightness:0),n(l)&&(l=T.contrast!=null?T.contrast:0);var p=x(e,r,i,l);this.veeObj={hue:p[0],saturation:p[1],brightness:p[2],contrast:p[3]};function x(){return arguments}e=nt(e),this.createjsColorMatrixFilter_constructor(new Ne.ColorMatrix().adjustColor(i,l,r,e)),this.type="MultiEffect",this.adjustColor=function(P,m,v,I){n(e)||(e=nt(P)),n(r)||(r=nt(m)),n(i)||(i=nt(v)),n(l)||(l=nt(I)),this.matrix.reset().adjustColor(P,m,v,I)},Object.defineProperty(this,"brightness",{get:function(){return i},set:function(P){i=nt(P),this.matrix.reset().adjustColor(i,l,r,e)}}),Object.defineProperty(this,"contrast",{get:function(){return l},set:function(P){l=nt(P),this.matrix.reset().adjustColor(i,l,r,e)}}),Object.defineProperty(this,"saturation",{get:function(){return r},set:function(P){r=nt(P),this.matrix.reset().adjustColor(i,l,r,e)}}),Object.defineProperty(this,"hue",{get:function(){return e},set:function(P){e=nt(P),this.matrix=new Ne.ColorMatrix().adjustColor(i,l,r,e),this.applyFilter()}}),this.clone=function(P){return new t.MultiEffect(P||!t.isPick(p[0])?e:p[0],P||!t.isPick(p[0])?r:p[0],P||!t.isPick(p[0])?i:p[0],P||!t.isPick(p[0])?l:p[0],a,this.group,f)}},t.extend(t.MultiEffect,Ne.ColorMatrixFilter,"clone","createjsColorMatrixFilter",!1),t.AlphaEffect=function(e,r,i,l){var a="mask, style, group, inherit",s;if(s=st(t.AlphaEffect,arguments,a,this))return s;De("69.9745"),this.group=i;var f=r===!1?{}:t.getStyle("AlphaEffect",i,l);n(e)&&(e=f.mask!=null?f.mask:null);var c=w(e);this.veeObj={mask:c[0]};function w(){return arguments}e=nt(e),e.type=="Bitmap"?e=e.image:e.cache&&(e=e.cache().cacheCanvas),this.createjsAlphaMaskFilter_constructor(e),this.type="AlphaEffect",this.clone=function(T){return new t.AlphaEffect(T||!t.isPick(c[0])?e:c[0],r,this.group,l)}},t.extend(t.AlphaEffect,Ne.AlphaMaskFilter,"clone","createjsAlphaMaskFilter",!1),t.Pixel=function(e,r,i,l,a,s,f,c,w,T,p,x,P){var m="obj, amount, amountY, blur, dynamic, blendmode, boundary, expand, amountFactor, blurFactor, style, group, inherit",v;if(v=st(t.Pixel,arguments,m,this))return v;De("69.9747"),this.group=x;var I=p===!1?{}:t.getStyle("Pixel",x,P);n(e)&&(e=I.obj!=null?I.obj:null),n(r)&&(r=I.amount!=null?I.amount:.5),n(i)&&(i=I.amountY!=null?I.amountY:null);var g=!1;i==null&&(g=!0,i=r),n(l)&&(l=I.blur!=null?I.blur:0),n(a)&&(a=I.dynamic!=null?I.dynamic:!1),n(s)&&(s=I.blendmode!=null?I.blendmode:null),n(f)&&(f=I.boundary!=null?I.boundary:new t.Boundary(e.getBounds())),n(c)&&(c=I.expand!=null?I.expand:0),n(w)&&(w=I.amountFactor!=null?I.amountFactor:.6),n(T)&&(T=I.blurFactor!=null?I.blurFactor:.6);var E=A(e,r,i,l,s,w,T);this.veeObj={obj:E[0],amount:E[1],amountY:E[2],blur:E[3],blendmode:E[4],amountFactor:E[5],blurFactor:E[6]};function A(){return arguments}e=nt(e),r=nt(r),i=nt(i),l=nt(l),s=nt(s),w=nt(w),T=nt(T),c&&(Array.isArray(c)?c.length==1?f.contract(-c):c.length==2?f.contract(-c[0],-c[1]):f.contract(-c[0],-c[1],-c[2],-c[3]):f.contract(-c));var y=t.constrain(w*10,0,10),C=t.constrain(T*10,0,10),L=this,Y=Math.pow(Math.E,-r*y),_=Math.pow(Math.E,-i*y),k=Math.pow(Math.E,-l*C);n(e)&&(e=new t.Tile(new t.Circle(20,[t.green,t.blue,t.yellow,t.pink,t.purple]),5,5,5,5));var $=document.createElement("canvas"),O=$.getContext("2d"),X=document.createElement("canvas"),R=X.getContext("2d"),Q=k;this.update=function(){!e.cacheCanvas||k!=Q?(e.cache(f.x,f.y,f.width,f.height,k),Q=k):e.updateCache(s);var K=e.width,q=e.height,ne=e.width*Y,U=e.height*_;$.width=K,$.height=q,X.width=K,X.height=q,R.msImageSmoothingEnabled=!1,R.mozImageSmoothingEnabled=!1,R.webkitImageSmoothingEnabled=!1,R.imageSmoothingEnabled=!1,O.drawImage(e.cacheCanvas,0,0,ne,U),R.drawImage($,0,0,ne,U,-c*e.scale,-c*e.scale,X.width+c*2*e.scaleX,X.height+c*2*e.scaleY)},this.update(),this.zimBitmap_constructor(X),a&&(this.dynamicTicker=t.Ticker.add(function(){L.update()})),Object.defineProperty(this,"amount",{get:function(){return r},set:function(K){r=K,Y=Math.pow(Math.E,-r*y),g&&(_=Math.pow(Math.E,-r*y),i=r),L.update()}}),Object.defineProperty(this,"amountX",{get:function(){return r},set:function(K){r=K,g=!1,Y=Math.pow(Math.E,-r*y),L.update()}}),Object.defineProperty(this,"amountY",{get:function(){return i},set:function(K){i=K,g=!1,_=Math.pow(Math.E,-i*y),L.update()}}),Object.defineProperty(this,"amountFactor",{get:function(){return w},set:function(K){w=K,y=t.constrain(w*10,0,10),Y=Math.pow(Math.E,-r*y),_=Math.pow(Math.E,-i*y),L.update()}}),Object.defineProperty(this,"blur",{get:function(){return l},set:function(K){l=K,k=Math.pow(Math.E,-l*C),L.update()}}),Object.defineProperty(this,"blurFactor",{get:function(){return T},set:function(K){T=K,C=t.constrain(T*10,0,10),k=Math.pow(Math.E,-l*C),L.update()}}),Object.defineProperty(this,"dynamic",{get:function(){return a},set:function(K){a!=K&&(a=K,a?L.dynamicTicker?L.dynamicTicker=t.Ticker.add(L.dynamicTicker):L.dynamicTicker=t.Ticker.add(L.update):L.dynamicTicker&&t.Ticker.remove(L.dynamicTicker))}}),this.dispose=function(){L.dynamicTicker&&t.Ticker.remove(L.dynamicTicker),this.zimBitmap_dispose()},p!==!1&&t.styleTransforms(this,I),this.clone=function(K){return L.cloneProps(new t.Pixel(K||!t.isPick(E[0])?e:E[0],K||!t.isPick(E[1])?r:E[1],K||!t.isPick(E[2])?i:E[2],K||!t.isPick(E[3])?l:E[3],a,K||!t.isPick(E[4])?s:E[4],f,c,K||!t.isPick(E[5])?w:E[5],K||!t.isPick(E[6])?T:E[6],p,this.group,P))}},t.extend(t.Pixel,t.Bitmap,["clone","dispose"],"zimBitmap",!1),t.Parallax=function(e,r,i,l,a,s,f){var c="layers, damp, auto, stage, startPaused, mouseMoveOutside, clamp",w;if(w=st(t.Parallax,arguments,c,this))return w;if(De("68"),this.type="Parallax",n(l))if(e&&e[0]&&e[0].obj&&e[0].obj.stage)l=e[0].obj.stage;else if(j.zdf)l=j.zdf.stage;else return;n(i)?i=!0:i=!1,n(a)&&(a=!1),n(s)&&(s=!1);var T=l.getBounds().width,p=l.getBounds().height;l.mouseMoveOutside=s;var x=this;x.stageEvent=l.on("stagemousemove",function(E){x.mouseX=E.rawX/t.scaX,x.mouseY=E.rawY/t.scaY});var P=n(r)?.1:r;this.addLayer=function(E){if(!(n(E.obj)||n(E.prop)||n(E.propChange))){var A={obj:E.obj,prop:E.prop};A[A.prop]=E.propChange,n(E.input)&&(E.input="mouseX"),A.input=E.input,A.split=n(E.split)?!!(E.input=="mouseX"&&i):E.split;var y=n(E.inMin)?0:E.inMin,C=n(E.inMax)?E.input=="mouseX"||E.input=="scrollX"?T:p:E.inMax,L=n(E.factor)?1:E.factor,Y=n(E.integer)?!1:E.integer;return A["p_"+A.prop]=new t.ProportionDamp(y,C,0,A[A.prop],P,L,Y,f),A.prop=="scale"?A["s_"+A.prop]=A.obj.scaleX:A.prop=="frame"?A["s_"+A.prop]=A.obj.currentFrame:A["s_"+A.prop]=A.obj[A.prop],n(E.immediate)||A["p_"+A.prop].immediate(E.immediate),m.push(A),x}},this.removeLayer=function(E){if(!n(E)){var A=m[E];return A["p_"+A.prop].dispose(),m.splice(E,1),x}},this.immediate=function(E){for(var A,y=0;y<m.length;y++)A=m[y],A["p_"+A.prop].immediate(E[y]);return x},this.dispose=function(){return l.off("stagemousemove",x.stageEvent),m=null,i&&t.Ticker.remove(I),!0},e=n(e)?[]:e;for(var m=[],v=0;v<e.length;v++)this.addLayer(e[v]);if(i){var I=t.Ticker.add(g,l);a&&t.Ticker.remove(I)}function g(){x.step()}this.step=function(E){for(var A,y,C=0;C<m.length;C++)A=m[C],n(E)?A.input=="mouseX"?y=x.mouseX:A.input=="mouseY"?y=x.mouseY:A.input=="scrollX"?y=t.scrollX():A.input=="scrollY"&&(y=t.scrollY()):y=E,A.prop=="scale"?A.obj.scaleX=A.obj.scaleY=A["s_"+A.prop]+A["p_"+A.prop].convert(y):A.prop=="frame"?A.obj.gotoAndStop(A["s_"+A.prop]+A["p_"+A.prop].convert(y)):(A.obj[A.prop]=A["s_"+A.prop]+A["p_"+A.prop].convert(y),A.split&&(A.obj[A.prop]-=A[A.prop]/2));return x},x.paused=a,x.pause=function(E){return n(E)&&(E=!0),x.paused!=E&&(x.paused=E,I&&(E?t.Ticker.remove(I):I=t.Ticker.add(I))),x},Object.defineProperty(x,"damp",{get:function(){return P},set:function(E){P=E;for(var A,y=0;y<m.length;y++)A=m[y],A["p_"+A.prop].damp=P}})},t.Flipper=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m){var v="front, back, interactive, time, vertical, flipped, easeRoot, frontPress, backPress, reverse, continuous, style, group, inherit",I;if(I=st(t.Flipper,arguments,v,this))return I;De("68.5"),this.group=P;var g=x===!1?{}:t.getStyle("Flipper",this.group,m);if(n(e)&&(e=g.front!=null?g.front:j.zdf.makeIcon().sca(2)),n(r)&&(r=g.back!=null?g.back:new t.Page(e.width,e.height,t.dark)),this.front=e,this.back=r,s){var E=e;e=r,r=E}var A=Math.max(e.width,r.width),y=Math.max(e.height,r.height);this.zimContainer_constructor(A,y),this.type="Flipper",n(l)&&(l=g.time!=null?g.time:.2),n(a)&&(a=g.vertical!=null?g.vertical:!1),n(i)&&(i=g.interactive!=null?g.interactive:!1),n(s)&&(s=g.flipped!=null?g.flipped:!1),n(f)&&(f=g.easeRoot!=null?g.easeRoot:"quad"),n(c)&&(c=g.frontPress!=null?g.frontPress:!0),n(w)&&(w=g.backPress!=null?g.backPress:!0),n(T)&&(T=g.reverse!=null?g.reverse:!1),n(p)&&(p=g.continuous!=null?g.continuous:!1);var C=s;this.flipped=s;var L=this;e.centerReg(this);var Y;(c&&!s||w&&s)&&(Y=i&&e.backing?e.backing:e,Y.on("mousedown",function(){_(e,r)}),Y.cur()),(w&&!s||c&&s)&&(Y=i&&r.backing?r.backing:r,Y.on("mousedown",function(){_(r,e,-1)}),Y.cur()),e.oScale=e.scale,r.oScale=r.scale,e.flipper=L,e.other=r,r.flipper=L,r.other=e,i||(e.mouseChildren=r.mouseChildren=!1),this.flip=function(k,$){k!=L.flipped&&(L.flipped?_(C?e:r,C?r:e,-1,$):_(C?r:e,C?e:r,1,$))};function _(k,$,O,X){if(n(O)&&(O=1),O*=T?-1:1,p&&(O=T?C?1:-1:C?-1:1),n(X)&&(X=l),L.flipped=!L.flipped,L.dispatchEvent("flip"),X==0){L.removeAllChildren(),$.scale=$.oScale,$.skewX=$.skewY=0,$.centerReg(L),L.dispatchEvent("flipped");return}var R,Q;a?(R={skewX:-90*O,scaleY:k.oScale/2},Q={skewX:0,scaleY:$.oScale},$.ske(90*O,0).sca($.oScale,$.oScale/2)):(R={skewY:-90*O,scaleX:k.oScale/2},Q={skewY:0,scaleX:$.oScale},$.ske(0,90*O).sca($.oScale/2,$.oScale)),k.animate({props:R,time:l,ease:f+"In",call:function(){k.removeFrom(),$.centerReg(L).animate({props:Q,time:l,ease:f+"Out",call:function(){L.dispatchEvent("flipped")}})}})}x!==!1&&t.styleTransforms(this,g),this.clone=function(){return L.cloneProps(new t.Flipper(e.clone(),r.clone(),i,l,a,s,f,c,w,T,p,x,this.group,m))}},t.extend(t.Flipper,t.Container,"clone","zimContainer"),t.Book=function(e,r,i,l,a,s,f,c){var w="width, height, pages, startPage, rollUp, radius, backgroundColor, arrows",T;if(T=st(t.Book,arguments,w,this))return T;De("68.7"),n(e)&&(e=j.zdf?j.zdf.stage.width:1024),n(r)&&(r=j.zdf?j.zdf.stage.height:768),this.zimContainer_constructor(e,r),this.type="Book",n(i)&&(i=[]),n(l)&&(l=0),n(a)&&(a=!0),n(f)&&(f=t.darker),n(c)&&(c=!0);var p=wt(),x=this;if(i.length==0)return;x.backing=new t.Rectangle(e-2,r-2,f),t.loop(i,function(L,Y){typeof L=="string"&&(i[Y]=t.asset(L)),i[Y].zimBookIndex=Y,g(L)}),x.added(I);var P,m,v;function I(L){P=L,m=P.frame;var Y=new t.Shape,_,k,$,O,X,R,Q;x._currentPage=l;function K(S){if(x._currentPage=S,x.removeAllChildren(),x.backing.loc(1,1,x),x.setMask(x.backing),Y.addTo(x),Y.c().f(t.black).dr(0,0,0,0),x.moving=!1,i[S-1]?_=i[S-1].reg(0,0).rot(0).loc(0,0,x):S>0&&Q.reg(0,0).rot(0).loc(0,0,x).setMask(null),i[S-2]?k=i[S-2].reg(e/2,r).loc(0,r,x).rot(-90):k=new t.Rectangle(e/2,r,f).reg(e/2,r).loc(0,r,x).rot(-90),i[S-3]?$=i[S-3].rot(0).loc(0,0,x).setMask(Y):$=new t.Rectangle(e/2,r,f).loc(0,0,x).setMask(Y),i[S])O=i[S].rot(0).reg(0,0).pos(0,0,t.RIGHT,t.TOP,x);else{P.update();return}i[S+1]?X=i[S+1].reg(0,r).loc(e,r,x).rot(90):(X=new t.Rectangle(e/2,r,f).reg(0,r).loc(e,r,x).rot(90),Q=X),i[S+2]?R=i[S+2].rot(0).pos(0,0,t.RIGHT,t.TOP,x).setMask(Y):R=new t.Rectangle(e/2,r,f).pos(0,0,t.RIGHT,t.TOP,x).setMask(Y),P.update()}K(l),Object.defineProperty(x,"directPage",{get:function(){return x._currentPage},set:function(S){C(),l%2==1?S=Math.ceil(S/2)*2-1:S=Math.ceil(S/2)*2,S!=x.page&&(S>x.page?(X.reg(0,0),R.setMask(null)):(k.reg(0,0),$.setMask(null)),K(S),x.moving=!1,q=!1,x.currentW=0,x.currentH=0,y())}});var q=!1;x.currentW=0,x.currentH=0,x.moving=!1;function ne(){x.stageEvent=P.on("stagemousedown",function(){if(x.hitTestPoint(m.mouseX,m.mouseY)){var S,F;if(!x.moving){var h=x.globalToLocal(m.mouseX,m.mouseY);if(!(h.x<0||h.x>e||h.y<0||h.y>r)&&!(s>0&&t.dist(h,new t.Point(0,r))>s&&t.dist(h,new t.Point(e,r))>s)){var b=h.x>e/2?"right":"left";b=="right"&&x._currentPage>=i.length-1||b=="left"&&x._currentPage<=1||(x.moving=!0,b=="right"?(O.addTo(x),X.addTo(x),R.addTo(x),x.pageNext=R.zimBookIndex):(_.addTo(x),k.addTo(x),$.addTo(x),x.rolledUp&&d(0,0,"right"),x.pageNext=k.zimBookIndex),C(),x.direction=b,x.dispatchEvent("rollpress"),x.moveEvent=P.on("stagemousemove",function(){U&&(U.clear(),U=null);var ye=x.globalToLocal(m.mouseX,m.mouseY);b=="right"?S=e-ye.x:S=ye.x,F=r-ye.y+S,x.currentW=S=t.constrain(S,0,e/2),x.currentH=F=t.constrain(F,0,r),d(S,F,b)}),x.upEvent=P.on("stagemouseup",function(){P.off("stagemousemove",x.moveEvent),!q&&D(S,F,b)},null,!0))}}}})}if(ne(),x.rollUp=function(S,F,h,b,ye){if(!x.moving&&!(h=="right"&&x._currentPage>=i.length-1)&&!(h=="left"&&x._currentPage<=1)){h=="right"?(O.addTo(x),X.addTo(x),R.addTo(x)):(x.rolledUp&&d(0,0,"right"),_.addTo(x),k.addTo(x),$.addTo(x)),x.moving=!0,n(b)&&(b=p=="s"?.5:.5/1e3),n(ye)&&(ye=null),x.animate({props:{currentW:S,currentH:F},time:b,ease:ye,call:function(){t.Ticker.remove(B),x.moving=!1,d(S,F,h)}});var B=t.Ticker.add(function(){d(x.currentW,x.currentH,h)})}},a!==!1){x.rolledUp=!0,a===!0&&(a=p=="s"?1:1/1e3);var U=t.timeout(a,function(){x.rollUp(60,130,"right",.5),x.dispatchEvent("rollup")})}x.rollDown=function(S,F,h,b){x.moving||h=="right"&&x._currentPage>=i.length-1||h=="left"&&x._currentPage<=1||D(S,F,h,b)};function D(S,F,h,b){x.moving=!0,x.rolledUp=!1,n(b)&&(b=p=="s"?.7:.7/1e3),x.animate({props:{currentW:0,currentH:0},time:b,call:function(){t.Ticker.remove(ye),d(0,0,h),x.moving=!1,y(),x.dispatchEvent("rolldown")}});var ye=t.Ticker.add(function(){d(x.currentW,x.currentH,h)})}function d(S,F,h){var b;h=="right"?(Y.c().mt(e,r).lt(e-S,r).lt(e,r-F).cp(),b=Math.atan2(S,F),X.loc(e-(S+S*Math.cos(2*b)),r-S*Math.sin(2*b)).rot(b*2*t.DEG),!q&&S>=e/2&&F>=r&&u()):(Y.c().mt(0,r).lt(S,r).lt(0,r-F).cp(),b=Math.atan2(S,F),k.loc(S+S*Math.cos(2*b),r-S*Math.sin(2*b)).rot(-b*2*t.DEG),!q&&S>=e/2&&F>=r&&o()),P.update()}function u(){C(),q=!0,x.moving=!0,x.moveEvent&&P.off("stagemousemove",x.moveEvent),x.upEvent&&P.off("stagemouseup",x.upEvent),x.currentW=0,x.currentH=0,x.lastPage=t.constrain(x._currentPage),x.direction="right",x.pageNext=R.zimBookIndex,x.dispatchEvent("pageanimate"),x.animate({ease:"quadOut",props:{currentW:e/2},time:.3,timeUnit:"s",call:function(){t.Ticker.remove(S),X.reg(0,0),R.setMask(null),K(x._currentPage+2),x.moving=!1,q=!1,x.currentW=0,x.currentH=0,y(),x.dispatchEvent("page")}});var S=t.Ticker.add(function(){Y.c().mt(e,r).lt(e/2,r).lt(e-x.currentW,0).lt(e,0).cp()});X.reg(e/2,r).loc(e/2,r,x).animate({props:{rotation:0},time:.3,ease:"quadOut",timeUnit:"s"})}function o(){C(),q=!0,x.moving=!0,x.moveEvent&&P.off("stagemousemove",x.moveEvent),x.upEvent&&P.off("stagemouseup",x.upEvent),x.currentW=0,x.currentH=0,x.lastPage=t.constrain(x._currentPage),x.direction="left",x.pageNext=k.zimBookIndex,x.dispatchEvent("pageanimate"),x.animate({ease:"quadOut",props:{currentW:e/2},time:.3,timeUnit:"s",call:function(){t.Ticker.remove(S),k.reg(0,0),$.setMask(null),K(x._currentPage-2),x.moving=!1,q=!1,x.currentW=0,x.currentH=0,y(),x.dispatchEvent("page")}});var S=t.Ticker.add(function(){Y.c().mt(0,r).lt(e/2,r).lt(x.currentW,0).lt(0,0).cp()});k.reg(0,r).loc(e/2,r,x).animate({props:{rotation:0},time:.3,timeUnit:"s",ease:"quadOut"})}c&&(c===!0&&(c=.2),x.keydown=m.on("keydown",function(S){S.keyCode==39?x.nextPage(c):S.keyCode==37&&x.prevPage(c)})),x.changeFrame=function(S){return x.stageEvent&&P.off("stagemousedown",x.stageEvent),x.moveEvent&&P.off("stagemousemove",x.moveEvent),x.upEvent&&P.off("stagemouseup",x.upEvent),m=S,P=S.stage,ne(),x},y()}x.nextPage=function(L){if(n(x.rollUp))return setTimeout(function(){x.nextPage(L)},10),x;x.moving||x.rollUp(e/2+.1,r+.1,"right",L,"quadIn")},x.prevPage=function(L){if(n(x.rollUp))return setTimeout(function(){x.prevPage(L)},10),x;x.moving||x.rollUp(e/2+.1,r+.1,"left",L,"quadIn")},x.gotoPage=function(L,Y){if(n(x.rollUp))return setTimeout(function(){x.gotoPage(L,Y)},10),x;L=t.constrain(L,0,x.pages.length-1),n(Y)&&(Y=p=="s"?.3:300);var _=Y+(p=="s"?.35:350);x.pageInterval=t.interval(_,function(k){var $=!1;x._currentPage<L?x.nextPage(Y):x._currentPage>L?x.prevPage(Y):$=!0,x.dispatchEvent("pageturn"),k.count==k.total-1&&($?(y(),x.dispatchEvent("pagedone")):t.timeout(_,function(){y(),x.dispatchEvent("pagedone")}))},Math.floor(Math.abs(L-x._currentPage)/2+1),!0)};function g(L){L.addChild&&(L.zimHTMLList=new t.Dictionary,A(L),L.parent&&L.parent.removeChild(data.page))}function E(L){if(!(n(L)||!L.addChild))for(L.removedHTML=!1,v=0;v<L.zimHTMLList.length;v++)L.addChildAt(L.zimHTMLList.values[v].obj,L.zimHTMLList.values[v].depth)}function A(L){if(!(L.removedHTML||!L.addChild)){L.removedHTML=!0,L.zimHTMLList.clear();var Y,_;for(_=0;_<L.numChildren;_++)if(Y=L.getChildAt(_),Y.type=="TextArea"||Y.type=="Loader"||Y.type=="Tag"){var k={obj:Y,depth:L.getChildIndex(Y)};L.zimHTMLList.add(Y,k)}for(_=L.numChildren-1;_>=0;_--)Y=L.getChildAt(_),(Y.type=="TextArea"||Y.type=="Loader"||Y.type=="Tag")&&L.removeChild(Y)}}function y(){x.pages[x.page]&&E(x.pages[x.page]),x.pages[x.page-1]&&E(x.pages[x.page-1])}function C(){x.pages[x.page]&&A(x.pages[x.page]),x.pages[x.page-1]&&A(x.pages[x.page-1])}Object.defineProperty(x,"page",{get:function(){return x._currentPage},set:function(L){x.gotoPage(L,p=="s"?.1:100)}}),Object.defineProperty(x,"pages",{get:function(){return i},set:function(){dt&&tt("Book() - pages is read only")}}),this.dispose=function(L,Y,_){return x.stageEvent&&P.off("stagemousedown",x.stageEvent),x.moveEvent&&P.off("stagemousemove",x.moveEvent),x.upEvent&&P.off("stagemouseup",x.upEvent),x.keydown&&m.off("keydown",x.keydown),x.removeFrom(),_||this.zimContainer_dispose(!0),!0}},t.extend(t.Book,t.Container,["clone","dispose"],"zimContainer"),t.Scrambler=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m){var v="tile, keys, keyProperty, scramble, time, wait, num, shadowColor, shadowBlur, swap, swapLock, style, group, inherit",I;if(I=st(t.Scrambler,arguments,v,this))return I;De("67.35"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Scrambler",this.group=P;var g=x===!1?{}:t.getStyle(this.type,this.group,m);n(e)&&(e=g.tile!=null?g.tile:e),n(r)&&(r=g.keys!=null?g.keys:null),n(i)&&(i=g.keyProperty!=null?g.keyProperty:null),n(l)&&(l=g.scramble!=null?g.scramble:!0),n(a)&&(a=g.time!=null?g.time:0),n(s)&&(s=g.wait!=null?g.wait:0),n(f)&&(f=g.num!=null?g.num:1),n(c)&&(c=g.shadowColor!=null?g.shadowColor:"rgba(0,0,0,.3)"),n(w)&&(w=g.shadowBlur!=null?g.shadowBlur:5),n(T)&&(T=g.swap!=null?g.swap:!1),n(p)&&(p=g.swapLock!=null?g.swapLock:!1),p&&(T=!0),n(e)&&(e=new t.Tile(new t.Rectangle(100,100,t.series(t.silver,t.tin,t.grey,t.dark,t.darker)),5,1,5)),e.addTo(this);var E=this;E.tile=e,E.complete=!0;var A=wt(a);wt(s);var y=(e.width+e.spacingH)/e.cols,C=(e.height+e.spacingV)/e.rows,L=j.zdf,Y=t.makeID(null,10),_,k,$,O=!1;e.pointers={},e.on("mousedown",function(D){if(O)return;O=!0,R(D.target),E.myDownCheck=!0,$=D.target;var d="id"+Math.abs(D.pointerID+1);if(e.pointers[d]=!0,_=D.target.x,k=D.target.y,p){var u=e.current;if(E.testItem(D.target,u.indexOf(D.target))){D.target.noMouse(),D.target.noDrag(),D.target.locked=!0,E.myDownCheck=O=!1,Q();return}}if(c!=-1&&w>0){var o=new Ne.Shadow(c,3,3,w);D.target.backing?D.target.backing.shadow=o:D.target.shadow=o}L&&(E.scrmu||(E.scrmu=L.on("mouseupplusonly",function(h){if(E.myDownCheck){E.myDownCheck=!1;var b=t.loop(e.pointers,function(ye,B){return B});b||(e.pointers.id0=!0),h={target:$,pointerID:h.pointerID?b:-1},S(h)}}))),E.upEvent&&e.off("pressup",E.upEvent),E.upEvent=e.on("pressup",function(h){var b="id"+Math.abs(h.pointerID+1);e.pointers[b]&&(E.myDownCheck=O=!1,S(h))});function S(h){var b="id"+Math.abs(h.pointerID+1);if(e.pointers[b]){delete e.pointers[b];var ye=!0;if(Q(),O=!1,E.moveEvent&&e.off("pressmove",E.moveEvent),p){var B=h.target.boundsToGlobal(),N=e.hitTestGrid(e.width,e.height,e.cols,e.rows,B.x+B.width/2,B.y+B.height/2,null,null,e.spacingH,e.spacingV,null,"open");if(n(N))ye=!1;else{var re=u[N[0]];h.target==re?ye=!1:ye=!E.testItem(re,N[0])}}T&&ye&&X(h),h.target.mouseEnabled=!1,h.target.animate({props:{x:_,y:k},time:.1,id:Y,timeUnit:"seconds",pauseOnBlur:!1,call:F,params:h})}}function F(h){!E.complete&&E.test()&&(E.complete=!0,E.dispatchEvent("complete")),c!=-1&&w>0&&(h.target.backing?h.target.backing.shadow=null:h.target.shadow=null),h.target.mouseEnabled=!0}T||(E.moveEvent&&e.off("pressmove",E.moveEvent),E.moveEvent=e.on("pressmove",function(h){X(h)}))});function X(D){var d=D.target;d.stopAnimate();var u=d.boundsToGlobal(),o=e.hitTestGrid(e.width,e.height,e.cols,e.rows,u.x+u.width/2,u.y+u.height/2,null,null,e.spacingH,e.spacingV,null,"open");n(o)||t.loop(e,function(S){if(!(S==d||S.paused===!1)){var F=S.boundsToGlobal(),h=e.hitTestGrid(e.width,e.height,e.cols,e.rows,F.x+F.width/2,F.y+F.height/2,null,null,e.spacingH,e.spacingV,null,"open");if(!n(h)){var b;o[2]==h[2]&&(S.x>=d.x&&S.x<=d.x+y/2||S.x<=d.x&&S.x>=d.x-y/2)&&(b=S.x,S.top().ord(-1),S.animate({props:{x:_},time:.2,id:Y,timeUnit:"seconds",call:function(){T&&!E.complete&&E.test()&&(E.complete=!0,E.dispatchEvent("complete"))}}),_=b),o[1]==h[1]&&(S.y>=d.y&&S.y<=d.y+C/2||S.y<=d.y&&S.y>=d.y-C/2)&&(b=S.y,S.top().ord(-1),S.animate({props:{y:k},time:.201,override:!1,id:Y,timeUnit:"seconds",call:function(){T&&!E.complete&&E.test()&&(E.complete=!0,E.dispatchEvent("complete"))}}),k=b)}}},!0)}function R(D){e.loop(function(d){d!=D&&d.noMouse()})}function Q(){e.loop(function(D){D.locked||D.mouse()})}this.test=function(){var D=e.current;return t.loop(D,function(d,u){if(n(d)||!E.testItem(d,u))return!1})},this.testItem=function(D,d){if(!n(D)){if(n(d)&&(d=e.current.indexOf(D)),r){var u=n(i)?D.key:D[i];if(u!=r[d])return!1}else if(e.items[d]!=D)return!1;return!0}},this.update=function(){return e.noDrag(),e.drag({boundary:e,singleTouch:!0}),this},this.starts=[];var K=[];t.loop(e.rows*e.cols,function(D){K.push(D)});var q=K.slice();e.loop(function(D){D.mouseChildren=!1,E.starts.push({x:D.x,y:D.y})}),this.inactive=!1,this.scramble=function(D,d,u){n(d)&&(d=0),n(D)&&(D=0),(n(u)||D==0)&&(u=1),ne(),t.timeout(d,function(){D>0?t.interval(D/u,o,u,!0):o()}),setTimeout(function(){E.complete=!1,e.loop(function(S){S.mouse(),S.locked=!1}),E.mouse(),e.drag({boundary:e,singleTouch:!0}),O=!1},A=="s"?(d+D)*1e3:d+D);function o(){for(var S=!0,F=0;S&&F<50;)F++,t.shuffle(K),S=t.loop(K,function(h,b){var ye=e.getChildAt(h);if(r){var B=n(i)?ye.key:ye[i];if(B!=r[b])return!1}else if(e.items[b]!=ye)return!1});U(K,D/u),t.timeout(D,function(){E.dispatchEvent("scrambled")})}return E},l?E.scramble(a,s,f):E.added(function(){e.drag({boundary:e,singleTouch:!0})});function ne(){E.upEvent&&e.off("pressup",E.upEvent),E.moveEvent&&e.off("pressmove",E.moveEvent),e.noDrag(),s+a>0&&E.noMouse()}function U(D,d,u){t.stopAnimate(Y),t.loop(e.items,function(o,S,F){var h=E.starts[D[S]];d?o.animate({props:{x:h.x,y:h.y},time:d,ease:u?"quadInOut":"quadOut",wait:u,timeUnit:"seconds",id:Y}):(o.loc(h),E.stage?o.drag({boundary:e,singleTouch:!0}):S==F-1&&E.added(function(){e.drag({boundary:e,singleTouch:!0})}))})}this.solve=function(D,d,u){n(u)&&(u=!0),n(d)&&(d=0),n(D)&&(D=0),d+D==0&&u&&E.noMouse(),setTimeout(function(){K=q.slice(),ne(),U(K,D,0,u)},A=="s"?d*1e3:d),u||setTimeout(function(){E.mouse(),e.drag({boundary:e,singleTouch:!0})},A=="s"?(d+D)*1e3:d+D)},this._enabled=!0,Object.defineProperty(E,"enabled",{get:function(){return E._enabled},set:function(D){bt(E,D),!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&E.stage&&E.stage.update()}}),Object.defineProperty(E,"order",{get:function(){var D=[],d=t.loop(e.current,function(u){if(!u)return!1;D.push(u.tileNum)});return!d||D.length!=K.length||(K=D),K},set:function(D){var d=[];t.loop(D,function(u){d.push(e.items[u])}),e.remake(d),e.stage&&e.stage.update()}}),this.dispose=function(D,d,u){return E.scrmu&&L.off("mouseupplus",E.scrmu),e.removeAllEventListeners(),u||(E.zimContainer_dispose(!0),E.stage&&E.stage.update()),!0},x!==!1&&t.styleTransforms(this,g),this.clone=function(){return E.cloneProps(new t.Scrambler(e.clone(),r,i,l,a,s,f,c,w,T,p,x,E.group,m))}},t.extend(t.Scrambler,t.Container,["clone","dispose"],"zimContainer",!1),t.Scroller=function(e,r,i,l,a,s,f,c,w,T,p){var x="backing, speed, direction, horizontal, gapFix, stage, container, backing2, style, group, inherit",P;if(P=st(t.Scroller,arguments,x,this))return P;De("69"),this.cjsEventDispatcher_constructor(),this.type="Scroller",this.group=T;var m=w===!1?{}:t.getStyle(this.type,this.group,p);if(n(e)&&(e=m.backing!=null?m.backing:null),n(e))return;var v=this.backing1=e;if(n(v)||!v.getBounds)return;var I;n(c)?I=this.backing2=e.clone(!0):I=c,n(l)&&(l=m.horizontal!=null?m.horizontal:!0),n(a)&&(a=m.gapFix!=null?m.gapFix:0),n(f)&&(f=m.container!=null?m.container:null),n(s)&&(s=m.stage!=null?m.stage:null);var g=this;n(r)&&(r=m.speed!=null?m.speed:1),this.speed=r;var E=this.baseSpeed=this.speed;n(i)&&(i=m.direction!=null?m.direction:1),this.direction=i;var A=l?v.scaleX:v.scaleY;if(v.type=="AC"){tt("ZIM Scroller(): please provide Pic() with dimensions for backing objects");return}if(!v.getBounds()){tt("ZIM Scroller(): please setBounds() on backing objects");return}if(!s&&!v.stage){tt("ZIM Scroller(): please pass in stage parameter or add backing objects to stage to start");return}if(!v.parent){tt("ZIM Scroller(): please add object to container or stage before adding to Scroller");return}if(v.parent.addChildAt(I,v.parent.getChildIndex(v)),s=s||v.stage,n(f)&&(f=s),!f.getBounds()){tt("zim display - Scroller(): please setBounds() on container or stage if no container");return}var y=v.getBounds().width*A-a,C=v.getBounds().height*A-a,L,Y;l?I.x=y:I.y=C;var _=!1,k=t.Ticker.add($,s);function $(){L||(L=f.getBounds().width,Y=f.getBounds().height),!(g.speed==0||g.direction==0)&&(l?(v.x-=g.speed*g.direction,v.x<I.x?I.x=v.x+y:I.x=v.x-y,g.direction*g.speed>0?I.x<0&&v.x<I.x?v.x=I.x+y:v.x<0&&I.x<v.x&&(I.x=v.x+y):I.x>L&&I.x>v.x?I.x=v.x-y:v.x>L&&v.x>I.x&&(v.x=I.x-y)):(v.y-=g.speed*g.direction,v.y<I.y?I.y=v.y+C:I.y=v.y-C,g.direction*g.speed>0?I.y<0&&v.y<I.y?v.y=I.y+C:v.y<0&&I.y<v.y&&(I.y=v.y+C):I.y>Y&&I.y>v.y?I.y=v.y-C:v.y>Y&&v.y>I.y&&(v.y=I.y-C)))}this.paused=!1,this.pause=function(O,X){return n(O)&&(O=!0),n(X)&&(X=0),O?(E=g.speed,X>0?(_=!0,t.animate({target:g,obj:{pausingSpeed:0},ticker:!1,time:X,call:function(){g.speed=0,g.paused=!0,_=!1,g.dispatchEvent("pause")}})):(_=!1,g.speed=0,g.paused=!0,setTimeout(function(){g.dispatchEvent("pause")},10))):(_=!1,X>0?t.animate({target:g,obj:{pausingSpeed:E},ticker:!1,time:X,call:function(){g.speed=E,g.paused=!1,_=!1}}):(g.speed=E,g.paused=!1)),g},Object.defineProperty(g,"percentSpeed",{get:function(){return g.baseSpeed==0?NaN:g.speed/g.baseSpeed*100},set:function(O){_||g.paused||(g.speed=g.baseSpeed*O/100)}}),Object.defineProperty(g,"pausingSpeed",{get:function(){return g.baseSpeed==0?NaN:g.speed/g.baseSpeed*100},set:function(O){g.speed=g.baseSpeed*O/100}}),Object.defineProperty(g,"percentComplete",{get:function(){return l?v.x<0&&v.x>I.x?-v.x/v.width*100:(-I.x/I.width*100+1e9)%100:v.y<0&&v.y>I.y?-v.y/v.height*100:(-I.y/I.height*100+1e9)%100},set:function(O){O=(O+1e9)%100,l?(v.x=-O*v.width/100,I.x=v.x+y):(v.y=-O*v.height/100,I.y=v.y+C)}}),w!==!1&&t.styleTransforms(this,m),this.dispose=function(){return t.Ticker.remove(k),!0}},t.extend(t.Scroller,Ne.EventDispatcher,null,"cjsEventDispatcher"),t.Dynamo=function(e,r,i,l,a,s,f,c,w,T,p,x){var P="sprite, speed, label, startFrame, endFrame, update, reversible, flip, flipVertical, style, group, inherit",m;if(m=st(t.Dynamo,arguments,P,this))return m;De("69.2"),this.cjsEventDispatcher_constructor(),this.type="Dynamo",this.group=p;var v=T===!1?{}:t.getStyle(this.type,this.group,x);if(n(e)&&(e=v.sprite!=null?v.sprite:null),n(e))return;var I=this.frames=e.parseFrames(i,l,a,!0);if(I.length==0)return;this.totalFrames=I.length;var g=0;n(r)&&(r=v.speed!=null?v.speed:30),n(f)&&(f=v.reversible!=null?v.reversible:!0);var E=this.baseSpeed=this.speed=r;n(s)&&(s=v.update!=null?v.update:!1),n(c)&&(c=v.flip!=null?v.flip:null),n(c)&&f==!1&&(c=!0);var A=this,y,C,L=Date.now(),Y,_,k,$=!1;A.scaleX=e.scaleX,A.scaleY=e.scaleY;function O(){if(y=requestAnimationFrame(O),C=I[g].s,!(A.speed==0||C==0)&&(_=1e3/Math.abs(A.speed)*C,Y=Date.now(),Y-L>_)){L=Y;var X=A.frame+(A.speed>0||!f?1:-1),R=!1;X>=I.length&&(R=!0,X=0),X<0&&(R=!0,X=I.length-1),A.frame=X,c&&(A.speed<0?e.scaleX=-A.scaleX:e.scaleX=A.scaleX),w&&(A.speed<0?e.scaleY=-A.scaleY:e.scaleY=A.scaleY),R&&A.dispatchEvent("loop"),A.dispatchEvent("change"),s&&e.stage&&e.stage.update(),!n(k)&&k==A.frame&&($=!1,A.speed=0,A.paused=!0,A.dispatchEvent("pause"))}}O(),this.paused=!1,this.pause=function(X,R,Q){if(n(X)&&(X=!0),X!=A.paused)return n(R)&&(R=0),X?(E=A.speed,typeof Q>"u"?R>0?($=!0,t.animate({target:A,obj:{pausingSpeed:0},ticker:!1,time:R,call:function(){$=!1,A.speed=0,A.paused=!0,A.dispatchEvent("pause")}})):($=!1,A.speed=0,A.paused=!0,setTimeout(function(){A.dispatchEvent("pause")},10)):($=!0,k=Q)):(k=null,R>0?($=!0,t.animate({target:A,obj:{pausingSpeed:E},ticker:!1,time:R,call:function(){$=!1,A.speed=E,A.paused=!1}})):($=!1,A.speed=E,A.paused=!1)),A},Object.defineProperty(A,"frame",{get:function(){return g},set:function(X){g=Math.round(X)%I.length;var R=I[g];n(R)||(e.frame=R.f)}}),Object.defineProperty(A,"percentSpeed",{get:function(){return A.baseSpeed==0?NaN:$||A.paused?E/A.baseSpeed*100:A.speed/A.baseSpeed*100},set:function(X){if($||A.paused){E=A.baseSpeed*X/100;return}A.speed=A.baseSpeed*X/100}}),Object.defineProperty(A,"pausingSpeed",{get:function(){return A.baseSpeed==0?NaN:A.speed/A.baseSpeed*100},set:function(X){A.speed=A.baseSpeed*X/100}}),T!==!1&&t.styleTransforms(this,v),this.dispose=function(){cancelAnimationFrame(y)}},t.extend(t.Dynamo,Ne.EventDispatcher,null,"cjsEventDispatcher"),t.Accelerator=function(e){De("69.3"),this.cjsEventDispatcher_constructor();var r=this;this.type="Accelerator",this.paused=!1,this.items=[],this.paused=!1,this._percentSpeed=100,this.add=function(i){var l;Array.isArray(i)?l=i:l=[i];for(var a,s=0;s<l.length;s++)a=r.items.indexOf(l[s]),a<0&&r.items.push(l[s]);return r},e&&this.add(e),this.remove=function(i){var l;Array.isArray(i)?l=i:l=[i];for(var a,s=0;s<l.length;s++)a=r.items.indexOf(l[s]),a>=0&&r.items.splice(a,1);return r},this.pause=function(i,l,a){if(n(i)&&(i=!0),i==r.paused)return;var s=[];if(i){n(a)||(l=null);for(var f=!1,c=0;c<r.items.length;c++)(!n(l)&&n(a)&&!r.items[c].totalFrames||r.items[c].totalFrames&&(!n(l)||!n(a)))&&(r.items[c].pause(!0,l,a),f=!0,s[c]=1,r.items[c].on("pause",function(){r.paused||(w(!0),r.paused=!0,r.dispatchEvent("pause"))},null,!0));f||(w(),r.paused=!0,setTimeout(function(){r.dispatchEvent("pause")},10))}else r.paused=!1,w();function w(){for(var T=0;T<r.items.length;T++)s[T]!=1&&r.items[T].pause(i)}},Object.defineProperty(r,"percentSpeed",{get:function(){return r._percentSpeed},set:function(i){r._percentSpeed=i;for(var l=0;l<r.items.length;l++)r.items[l].percentSpeed=i}}),this.dispose=function(){for(var i=0;i<r.items.length;i++)r.items[i].dispose();return r.items=null,!0}},t.extend(t.Accelerator,Ne.EventDispatcher,null,"cjsEventDispatcher"),t.Emitter=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O,X,R,Q,K,q,ne,U,D,d){var u="obj, width, height, interval, num, life, fade, shrink, warm, decayTime, decayStart, trace, traceFadeTime, traceShiftX, traceShiftY, angle, force, gravity, wind, layers, animation, random, horizontal, vertical, sink, sinkForce, cache, events, startPaused, pool, poolMin, particles, focusWarm, style, group, inherit",o;if(o=st(t.Emitter,arguments,u,this))return o;De("69.9"),this.type="Emitter",this.group=D;var S=U===!1?{}:t.getStyle(this.type,this.group,d);n(e)&&(e=S.obj!=null?S.obj:[new t.Circle(20,t.pink),new t.Circle(20,t.green),new t.Circle(20,t.blue)]),n(r)&&(r=S.width!=null?S.width:300),n(i)&&(i=S.height!=null?S.height:300);var F=wt(l);n(l)&&(l=S.interval!=null?S.interval:F=="s"?.02:20),typeof l=="number"&&(l=Math.max(F=="s"?.01:10,l)),n(a)&&(a=S.num!=null?S.num:1),n(x)&&(x=S.trace!=null?x.size:!1),n(P)&&(P=S.traceFadeTime!=null?S.traceFadeTime:T),n(m)&&(m=S.traceShiftX!=null?S.traceShiftX:0),n(v)&&(v=S.traceShiftY!=null?S.traceShiftY:0),It(s,F),n(s)&&(s=S.life!=null?S.life:F=="s"?1:1e3),n(f)&&(f=S.fade!=null?S.fade:!0),n(c)&&(c=S.shrink!=null?S.shrink:!x),n(w)&&(w=S.warm!=null?S.warm:null),It(T,F),n(T)&&(T=S.decayTime!=null?S.decayTime:F=="s"?1:1e3),n(I)&&(I=S.angle!=null?S.angle:{min:0,max:360}),n(g)&&(g=S.force!=null?S.force:5),n(E)&&(E=S.gravity!=null?S.gravity:9.8),n(A)&&(A=S.wind!=null?S.wind:0),n(y)&&(y=S.layers!=null?S.layers:"top"),n(r)&&(r=S.width!=null?S.width:100),n(i)&&(i=S.height!=null?S.height:100),n(Y)&&(Y=S.horizontal!=null?S.horizontal:!1),n(_)&&(_=S.vertical!=null?S.vertical:!1),n(k)&&(k=S.sink!=null?S.sink:null),!n(k)&&n($)&&($=S.sinkForce!=null?S.sinkForce:10),n(X)&&(X=S.events!=null?S.events:!1),n(R)&&(R=S.startPaused!=null?S.startPaused:!1),n(Q)&&(Q=S.pool!=null?S.pool:!0),n(K)&&(K=S.poolMin!=null?S.poolMin:0),n(q)&&(q=S.particles!=null?S.particles:new t.Container),n(ne)&&(ne=S.focusWarm!=null?S.focusWarm:!0),e.type=="shape"&&(ne=!1),q.type="Particles",q.emitter=this,this.zimContainer_constructor(r,i,null,null,!1),this.type="Emitter";var h=this;this.regX=r/2,this.regY=i/2,h.obj=e,h.particles=q,h.interval=l,h.num=a,h.life=s,h.fade=f,h.shrink=c,h.decayTime=T,h.decayStart=p,h.trace=x,h.traceFadeTime=P,h.traceShiftX=m,h.traceShiftY=v,h.angle=I,h.emitterForce=g,h.gravity=E,h.wind=A,h.layers=y,h.animation=C,h.random=L,h.horizontal=Y,h.vertical=_,h.sink=k,h.sinkForce=$,h.events=X,h.startEmitterPaused=h.emitterPaused=R,h.pool=Q,h.poolMin=K,h.particlesEmitted=0;var b=[],ye=0,B=0,N,re;t.added(h,le);function le(J){if(h.emitterPaused=null,h.on("added",function(){t.loop(h.particles,function(de){de.visible=!1}),h.particles.addTo(h.parent)}),re=J,n(O)&&(re.isWebGL?O=!1:O=t.mobile()),O&&(re.snapToPixelEnabled=!0),re){let de=function(){var fe=t.isPick(h.life)?t.Pick.getMinMax(h.life).max:h.life;if(n(fe)&&(fe=F=="s"?1:1e3),h.startEmitterPaused){h.pauseEmitter();return}if(e=Array.isArray(h.obj)?h.obj:[h.obj],e.length<=0)return;var ke,oe;function Ce(Me,te){return Me-te}Array.isArray(h.interval)?(h.interval.sort(Ce),ke=h.interval[0]):h.interval.constructor=={}.constructor?ke=h.interval.min:ke=h.interval,Array.isArray(h.num)?(h.num.sort(Ce),oe=h.num[h.num.length-1]):h.num.constructor=={}.constructor?oe=h.num.max:oe=h.num,t.loop(t.Pick.choose(h.num),function(){if(h.decayTime>0){var Me={};h.shrink&&(Me.scale=0),h.fade&&(Me.alpha=0)}var te,ae,we;if(h.pool&&b.length>0&&B>=Math.max(h.poolMin,fe/ke*oe))te=b[ye++%b.length],te.visible=!0,we=te.trace?te.getChildAt(0):te,we.emitShape&&(ae=we.template,we.graphics.c().s(ae.s?t.Pick.choose(ae.s):null).ss(ae.ss?t.Pick.choose(ae.ss):null).sd(ae.sd?t.Pick.choose(ae.sd):null,ae.offset?t.Pick.choose(ae.offset):null)),te.trace&&te.cacheCanvas&&te.updateCache(),h.layers=="top"?we.emitShape?te.addTo(q,null,!1):te.addTo(q,q.numChildren-1):we.emitShape?te.addTo(q,h.layers=="bottom"?0:t.rand(q.numChildren),!1):te.addTo(q,h.layers=="bottom"?0:t.rand(q.numChildren)),x||te.reg("center"),te.scaleX=1,te.scaleY=1,te.alpha=te.originalAlpha,we.scaleX=we.originalScaleX,we.scaleY=we.originalScaleY,we.rotation=we.originalRotation,we.color=we.originalColor,we.endSpurt=!1;else{B++,h.trace&&(te=new t.Container(r,i,null,null,!1),te.trace=!0);var ue=t.Pick.choose(t.shuffle(e)[0]);ue.type=="shape"?(ae=ue,we=new t.Shape(1,1,null,null,null,!1),we.emitShape=!0,we.template=ae,we.graphics.s(ae.s?t.Pick.choose(ae.s):null).ss(ae.ss?t.Pick.choose(ae.ss):null).sd(ae.sd?t.Pick.choose(ae.sd):null,ae.offset?t.Pick.choose(ae.offset):null),h.trace?we.addTo(te,null,!1):h.layers=="top"?we.addTo(q,null,!1):we.addTo(q,h.layers=="bottom"?0:t.rand(q.numChildren),null,!1)):(we=ue.clone(),we.centerReg||Vn(we),h.trace?we.centerReg(te).loc(-1e3,-1e3):h.layers=="top"?we.centerReg(q):we.centerReg(q,h.layers=="bottom"?0:t.rand(q.numChildren))),h.trace&&(h.layers=="top"?te.addTo(q,null,!1):te.addTo(q,h.layers=="bottom"?0:t.rand(q.numChildren),!1),te.cache(m,v,r*2,i*2)),h.trace||(te=we),te.particle=we,te.originalAlpha=te.alpha,we.originalAlpha=we.alpha,we.originalScaleX=we.scaleX,we.originalScaleY=we.scaleY,we.originalRotation=we.rotation,we.originalColor=we.color}h.currentParticle=we,h.particlesEmitted++,te.particleNormal=!0,te.particleDecaying=!1,te.particleFizzing=!1;var Pe=t.Pick.choose(h.angle),ie=t.Pick.choose(h.emitterForce),be=ie*Math.cos(Pe*Math.PI/180),Le=ie*Math.sin(Pe*Math.PI/180);we.info={position:{x:h.x,y:h.y},velocity:{x:be,y:Le},sink:n($)?null:nt($)},h.horizontal&&(we.info.position={x:h.x-h.regX+t.rand(0,r),y:h.y-h.regY+(h.vertical?i/2:0)}),h.vertical&&(we.info.position={x:h.x-h.regX+(h.horizontal?r/2:0),y:h.y-h.regY+t.rand(0,i)}),we.emitShape?we.graphics.mt(we.info.position.x,we.info.position.y):(we.x=we.info.position.x,we.y=we.info.position.y),we.alpha=we.originalAlpha,h.random&&t.loop(h.random,function(_e,Ze){var at=t.Pick.choose(Ze);_e=="scale"?we.sca(at):(_e=="x"?we.info.position.x=h.horizontal||h.vertical?at:at+r/2:_e=="y"&&(we.info.position.y=h.horizontal||h.vertical?at:at+i/2),(_e=="x"||_e=="y")&&we.emitShape&&we.graphics.mt(we.info.position.x,we.info.position.y),we[_e]=at,we.emitShape&&(we.x=0,we.y=0))}),O&&!we.emitShape&&we.cache(we.getBounds().x-10,we.getBounds().y-10,we.getBounds().width+20,we.getBounds().height+20);var me=we.emitShape?!1:h.shrink,ee=(te||we).life=nt(h.life);if(h.decayTime>0&&(h.fade||me||h.trace&&h.traceFadeTime>0)){if(h.trace&&h.traceFadeTime>0&&te.animate({obj:{alpha:0},time:h.traceFadeTime,wait:ee-h.traceFadeTime,waitedCall:function(_e){_e.particleNormal=!1,_e.particleFizzing=!0},call:G,override:!1,id:"decay"}),h.fade||me){var Ie={};h.fade&&(Ie.alpha=0),me&&(Ie.scaleX=0,Ie.scaleY=0),we.animate({obj:Ie,time:h.decayTime,wait:n(h.decayStart)?ee-h.decayTime:h.decayStart,waitedCall:function(_e){_e.parent!=h&&(_e=_e.parent),_e.particleNormal=!1,_e.particleDecaying=!0},call:function(_e){h.events&&z("decayed",_e),_e.endSpurt&&z("spurtdecayed",_e),h.trace&&h.traceFadeTime>0||(n(h.decayStart)||h.decayStart+h.decayTime>h.life?_e.parent&&G(_e.parent.trace?_e.parent:_e):-function(){var Ze=te;t.timeout(ee-(h.decayStart+h.decayTime),function(){G(Ze)})}())},override:!1,id:"decay"})}}else te.life=h.life,h.life>0&&-function(){var _e=te;_e.timeOut=t.timeout(h.life,function(){G(_e)})}();if(h.events&&z("emitted",te),se(we),h.animation){var Re=t.Pick.choose(h.animation);Array.isArray(Re)?t.loop(Re,function(_e){n(_e.override)&&(_e.override=!1),we.animate(t.copy(_e))}):(n(Re.override)&&(Re.override=!1),we.animate(t.copy(Re)))}})},V=function(){t.loop(q,function(fe){if(fe.trace){var ke=fe;fe=fe.getChildAt(0)}var oe=fe.info,Ce=0,Me=0;if(!n(h.sink)){var te=h.particles.localToGlobal(oe.position.x,oe.position.y),ae;h.sink.parent&&h.sink.parent.localToGlobal?ae=h.sink.parent.localToGlobal(h.sink.x,h.sink.y):ae=new Ne.Point(t.Pick.choose(h.sink.x),t.Pick.choose(h.sink.y));var we=t.angle(te.x,te.y,ae.x,ae.y);Ce=oe.sink*Math.cos(we*Math.PI/180),Me=oe.sink*Math.sin(we*Math.PI/180)}var ue=h.wind+Ce,Pe=h.gravity+Me;oe.velocity.x+=ue*Z,oe.velocity.y+=Pe*Z,oe.position.x+=oe.velocity.x*Z*100,oe.position.y+=oe.velocity.y*Z*100,fe.emitShape?fe.graphics.lt(oe.position.x,oe.position.y):(fe.x=oe.position.x,fe.y=oe.position.y),h.trace&&ke&&ke.cacheCanvas&&ke.updateCache(fe.emitShape?null:"source-over")})};var pe=h.parent.getChildIndex(h);h.parent.addChildAt(q,pe),!Y&&!_&&h.centerReg(null,null,!1),h.zimInterval=t.interval(h.interval,de,null,!0,!0);var Z=0;N=h.emitterTicker=t.Ticker.add(V,re),Z=1/t.Ticker.framerate,h.focusWarm=ne,h.doWarm=function(fe){if(n(fe)||fe===!0){var ke;s.max?ke=s.max:Array.isArray(s)?ke=t.arrayMinMax(s).max:ke=nt(s);var oe;l.min?oe=l.min:Array.isArray(l)?oe=t.arrayMinmin(l).min:oe=nt(l),fe=Math.min(200,Math.round(ke/oe))}var Ce=h.pool;h.pool=!1;var Me=Math.round(l*t.Ticker.framerate);t.loop(Math.round(fe*l*t.Ticker.framerate),function(te){te%Me==0&&de(),t.loop(q,function(ae){ae.warmTick?ae.warmTick++:ae.warmTick=1,ae.warmTick/t.Ticker.framerate>ae.life&&G(ae)}),V()}),t.loop(q,function(te){if(te.zimTweens){var ae=te.warmTick/t.Ticker.framerate/te.life*100;ae>=100&&(te.alpha=0),te.percentComplete=ae}}),h.pool=Ce},w&&h.doWarm(w)}}h.particles.noMouse();function G(J){if(h.events&&z("fizzed",J),(J.trace?J.getChildAt(0).endSpurt:J.endSpurt)&&(z("spurtfizzed",J),h.spurting=!1),h.pool&&J.pooled!="end")if(J.pooled){J.visible=!1;return}else{J.pooled=!0,b&&b.push(J),J.visible=!1;return}h.removeChild(J),h.trace&&J.uncache(),J=null}function z(J,pe){if(!n(pe)){var Z=new Ne.Event(J);Z.particle=pe.trace?pe.getChildAt(0):pe,h.dispatchEvent(Z)}}function se(J){n(h.spurtCount)&&n(h.spurtNum)||(h.spurtCount++,h.spurtCount>=h.spurtNum&&Oe(J))}function Oe(J){h.pauseEmitter(),h.spurtCount=h.spurtNum=null,!n(J)&&(z("spurted",J),J.endSpurt=!0)}Object.defineProperty(h,"interval",{get:function(){return l},set:function(J){l=J,h.zimInterval&&(h.zimInterval.time=l)}}),this.removeFrom=function(){h.parent&&h.parent.removeChild(h),h.particles.removeFrom()},this.spurting=!1,this.spurt=function(J,pe,Z){var de="num, time, restart",V;return(V=st(h.spurt,arguments,de))?V:(n(pe)||(t.timeout(t.Pick.choose(pe),function(){Oe(h.currentParticle)},!0),h.spurting=!0),n(J)||(h.spurtNum=t.Pick.choose(J),h.spurtCount=0,h.spurting=!0),h.pauseEmitter(!1,Z,null,!0),h)},this.clearPool=function(){t.loop(h.particles,function(J){J.pooled="end",J.visible||h.removeChild(J)},!0),B=0,ye=0,b=[]},h.startEmitterPaused||(this.emitterPaused=!1),this.pauseEmitter=function(J,pe,Z,de){if(h.startEmitterPaused=null,n(J)&&(J=!0),n(pe)&&(pe=!1),n(Z)&&(Z=!1),J){if(h.emitterPaused)return h;Z&&(N&&t.Ticker.remove(N),t.loop(h.particles,function(V){V.pauseAnimate(),V.trace&&V.getChildAt(0).pauseAnimate(),V.timeOut&&V.timeOut.pause()})),h.zimInterval.pause(),h.emitterPaused=!0}else{if(!h.emitterPaused)return h;pe&&(t.loop(h.particles,function(V){V.stopAnimate(),V.timeOut&&V.timeOut.clear(),V.trace&&V.getChildAt(0).pauseAnimate()}),h.removeAllChildren()),re&&N&&!t.Ticker.has(re,N)&&(t.Ticker.add(N,re),t.loop(h.particles,function(V){V.pauseAnimate(!1),V.timeOut&&V.timeOut.pause(!1),V.trace&&V.getChildAt(0).pauseAnimate(!1)})),h.zimInterval&&h.zimInterval.pause(!1,de),h.emitterPaused=!1}return h},this.resize=function(J,pe){n(J)||(r=J),n(pe)||(i=pe),h.setBounds(0,0,r,i),!Y&&!_&&h.centerReg(),h.clearPool()},U!==!1&&t.styleTransforms(this,S),this.clone=function(J){var pe;return Array.isArray(h.obj)||h.obj.constructor=={}.constructor?pe=t.copy(h.obj):h.obj.clone?pe=h.obj.clone(J):pe=h.obj,h.cloneProps(new t.Emitter(pe,r,i,h.interval,h.num,h.life,h.fade,h.shrink,h.decayTime,h.decayStart,h.trace,h.traceFadeTime,h.traceShiftX,h.traceShiftY,h.angle,h.emitterForce,h.gravity,h.wind,h.layers,h.animation,t.copy(h.random),h.horizontal,h.vertical,h.sink,h.sinkForce,O,h.events,R,h.pool,h.poolMin,U,h.group,d))},this.dispose=function(){return h.zimInterval&&h.zimInterval.clear(),N&&t.Ticker.remove(N),t.loop(b,function(J){J&&J.dispose()}),q&&q.dispose&&q.dispose(),h.currentParticle&&h.currentParticle.dispose&&h.currentParticle.dispose(),e&&Array.isArray(e)?t.loop(e,function(J){J.dispose&&J.dispose()}):e&&e.dispose&&e.dispose(),q=h.currentParticle=h.particles=e=h.obj=b=h.poolList=null,!0}},t.extend(t.Emitter,t.Container,"clone","zimContainer",!1),t.Generator=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L){var Y="color, strokeColor, strokeWidth, draw, stamp, setup, maxCount, boundary, drawCount, drawPause, drawSpacebarPause, startX, startY, cache, recordLinePoints, frame, seed, output, outputType, style, group, inherit",_;if(_=st(t.Generator,arguments,Y,this))return _;De("69.92"),this.group=C;var k=y===!1?{}:t.getStyle("Generator",this.group,L);n(I)&&(I=k.frame!=null?k.frame:j.zdf);var $=I.stage;n(e)&&(e=k.color!=null?k.color:null),n(r)&&(r=k.strokeColor!=null?k.strokeColor:t.white),n(i)&&(i=k.strokeWidth!=null?k.strokeWidth:1),n(f)&&(f=k.maxCount!=null?k.maxCount:1e3),n(c)&&(c=k.boundary!=null?k.boundary:new t.Boundary(0,0,$.width,$.height)),n(w)&&(w=k.drawCount!=null?k.drawCount:1),n(T)&&(T=k.drawPause!=null?k.drawPause:!0),n(p)&&(p=k.drawSpacebarPause!=null?k.drawSpacebarPause:!0),n(x)&&(x=k.startX!=null?k.startX:$.width/2),n(P)&&(P=k.startY!=null?k.startY:$.height/2),n(m)&&(m=k.cache!=null?k.cache:!1);var O=this.drawing=new t.Container(c.x,c.y,c.width,c.height).addTo($),X=this.shape=new t.Shape(c.width,c.height).addTo(O);this.drawCount=w,n(T)&&(T=!0),m&&X.cache(c.x,c.y,c.width,c.height),this.zimContainer_constructor(c.x,c.y,c.width,c.height),this.type="Generator";var R=this;if(R.draw=null,E){R.drawCount=10,!n(a)&&n(l)&&(l=a),a=null;var Q=new t.Loader;R.outputNum=0,R.outputName=E===!0?"gen_":E.match(/_$/)?E:E+"_"}this.color=e,this.strokeColor=r,this.strokeWidth=i;var K=x,q=P;this.fill=function(u){return R.color=u,R.currentColor=nt(R.color),X.f(R.currentColor),this},this.stroke=function(u,o){return n(u)||(R.strokeColor=u,R.currentStrokeColor=nt(R.strokeColor),X.s(R.currentStrokeColor)),n(o)||(R.strokeWidth=o,R.currentStrokeWidth=nt(R.strokeWidth),X.ss(R.currentStrokeWidth)),this},this.noStroke=function(){return R.strokeColor=R.currentStrokeColor=null,R.strokeWidth=R.currentStrokeWidth=null,X.s(),X.ss(1),this},X.matrix=X.getMatrix(),this.translate=function(u,o){n(u)&&(u=0),n(o)&&(o=0),u=nt(u),o=nt(o);var S=X.matrix.transformPoint(u,o);return K=S.x,q=S.y,X.mt(K,q),X.matrix.translate(u,o),this},this.rotate=function(u){return n(u)&&(u=0),u=nt(u),X.matrix.rotate(u),this},this.scale=function(u,o){return n(u)&&(u=1),n(o)&&(o=u),u=nt(u),o=nt(o),X.matrix.scale(u,o),this},this.skew=function(u,o){return n(u)&&(u=0),n(o)&&(o=0),u=nt(u),o=nt(o),X.matrix.skew(u,o),this},v&&(R.linePoints=[]),this.line=function(u,o,S,F){n(u)&&(u=0),n(o)&&(o=0),n(S)&&(S=0),n(F)&&(F=0),u=nt(u),o=nt(o),S=nt(S),F=nt(F),(v=="zero"||v=="nonzero"&&u&&o)&&R.linePoints.push([u,o]),R.translate(u,o);var h=X.matrix.transformPoint(S,F);return K=h.x,q=h.y,X.lt(K,q),v&&R.linePoints.push([K,q]),X.matrix.translate(S,F),this},this.arc=function(u,o,S,F,h,b){n(u)&&(u=0),n(o)&&(o=0),n(S)&&(S=50),u=nt(u),o=nt(o),S=nt(S),S=Math.abs(S),n(F)&&(F=0),n(h)&&(h=180),F=nt(F),h=nt(h),n(b)&&(b=!1),b=nt(b),R.translate(u,o);var ye=X.matrix.transformPoint(0,0);X.decomp||(X.decomp={}),X.matrix.decompose(X.decomp);var B=(Math.abs(X.decomp.scaleX)+Math.abs(X.decomp.scaleY))/2,N=X.decomp.rotation||0,re=S*B;return X.mt(ye.x+re*Math.cos((F+N)*Math.PI/180),ye.y+re*Math.sin((F+N)*Math.PI/180)),X.a(ye.x,ye.y,re,(F+N)*Math.PI/180,(h+N)*Math.PI/180,b),this},this.curve=function(u,o,S,F,h,b){n(u)&&(u=0),n(o)&&(o=0),n(S)&&(S=50),n(F)&&(F=50),n(h)&&(h=100),n(b)&&(b=0),u=nt(u),o=nt(o),S=nt(S),F=nt(F),h=nt(h),b=nt(b),R.translate(u,o);var ye=X.matrix.transformPoint(S,F),B=X.matrix.transformPoint(h,b),N=B.x,re=B.y;return X.qt(ye.x,ye.y,N,re),X.matrix.translate(h,b),this},this.bezier=function(u,o,S,F,h,b,ye,B){n(u)&&(u=0),n(o)&&(o=0),n(S)&&(S=50),n(F)&&(F=50),n(h)&&(h=-50),n(b)&&(b=-50),n(ye)&&(ye=100),n(B)&&(B=0),u=nt(u),o=nt(o),S=nt(S),F=nt(F),h=nt(h),b=nt(b),ye=nt(ye),B=nt(B),R.translate(u,o);var N=X.matrix.transformPoint(S,F),re=X.matrix.transformPoint(h,b),le=X.matrix.transformPoint(ye,B),G=le.x,z=le.y;return X.bt(N.x,N.y,re.x,re.y,G,z),X.matrix.translate(ye,B),this},this.rectangle=function(u,o,S,F,h,b,ye,B){if(n(u)&&(u=0),n(o)&&(o=0),n(S)&&(S=100),n(F)&&(F=S),u=nt(u),o=nt(o),S=nt(S),F=nt(F),!h&&!b&&!ye&&!B){R.translate(u,o);var N=X.matrix.transformPoint(0,0),re=X.matrix.transformPoint(S,0),le=X.matrix.transformPoint(S,F),G=X.matrix.transformPoint(0,F);return X.mt(N.x,N.y).lt(re.x,re.y).lt(le.x,le.y).lt(G.x,G.y).lt(N.x,N.y).lt(re.x,re.y),X.mt(N.x,N.y),this}n(h)&&(h=0),n(b)&&(b=h),n(ye)&&(ye=h),n(B)&&(B=h),h=nt(h),b=nt(b),ye=nt(ye),B=nt(B);var z=(S<F?S:F)/2,se=0,Oe=0,J=0,pe=0;z=Math.abs(z),h<0&&(h*=se=-1),h>z&&(h=z),b<0&&(b*=Oe=-1),b>z&&(b=z),ye<0&&(ye*=J=-1),ye>z&&(ye=z),B<0&&(B*=pe=-1),B>z&&(B=z),R.translate(u,o),X.decomp||(X.decomp={}),X.matrix.decompose(X.decomp);var Z=(Math.abs(X.decomp.scaleX)+Math.abs(X.decomp.scaleY))/2,de=S<0?-1:1,V=F<0?-1:1,fe=X.matrix.transformPoint(S-b*de,0),ke=X.matrix.transformPoint(S+b*Oe*de,-b*Oe*V),oe=X.matrix.transformPoint(S,b*V),Ce=X.matrix.transformPoint(S,F-ye*V),Me=X.matrix.transformPoint(S+ye*J*de,F+ye*J*V),te=X.matrix.transformPoint(S-ye*de,F),ae=X.matrix.transformPoint(B*de,F),we=X.matrix.transformPoint(-B*pe*de,F+B*pe*V),ue=X.matrix.transformPoint(0,F-B*V),Pe=X.matrix.transformPoint(0,h*V),ie=X.matrix.transformPoint(-h*se*de,-h*se*V),be=X.matrix.transformPoint(h*de,0);return X.mt(fe.x,fe.y).at(ke.x,ke.y,oe.x,oe.y,b*Z).lt(Ce.x,Ce.y).at(Me.x,Me.y,te.x,te.y,ye*Z).lt(ae.x,ae.y).at(we.x,we.y,ue.x,ue.y,B*Z).lt(Pe.x,Pe.y).at(ie.x,ie.y,be.x,be.y,h*Z).cp(),this},this.circle=function(u,o,S,F,h){n(u)&&(u=0),n(o)&&(o=0),n(S)&&(S=50),n(F)&&(F=100),n(h)&&(h=!0),u=nt(u),o=nt(o),S=nt(S),F=nt(F),S=Math.abs(S),R.translate(u,o);var b=X.matrix.transformPoint(0,0);X.decomp||(X.decomp={}),X.matrix.decompose(X.decomp);var ye=(Math.abs(X.decomp.scaleX)+Math.abs(X.decomp.scaleY))/2,B=X.decomp.rotation||0,N=S*ye;if(R.circleHeight=N*2,typeof F=="number"&&F>=0&&F<100){var re=360*F/100/2;X.mt(b.x+N*Math.cos((-re-90+B)*Math.PI/180),b.y+N*Math.sin((-re-90+B)*Math.PI/180)),X.a(b.x,b.y,N,(-re-90+B)*Math.PI/180,(re-90+B)*Math.PI/180,!1),h&&X.cp(),R.circleHeight=N-Math.cos(re*Math.PI/180)*N}else X.mt(b.x+N,b.y),X.a(b.x,b.y,N,0,Math.PI*2);return this},this.elipse=function(u,o,S,F){n(u)&&(u=0),n(o)&&(o=0),n(S)&&(S=100),n(F)&&(F=50),u=nt(u),o=nt(o),S=nt(S),F=nt(F),R.translate(u,o);var h=X.matrix.transformPoint(-S/2,-F/2);X.decomp||(X.decomp={}),X.matrix.decompose(X.decomp);var b=X.decomp.scaleX,ye=X.decomp.scaleY;return X.de(h.x,h.y,S*b,F*ye),this},this.poly=function(u,o,S,F,h,b){n(u)&&(u=0),n(o)&&(o=0),n(S)&&(S=100),n(F)&&(F=5),n(h)&&(h=0),n(b)&&(b=0),u=nt(u),o=nt(o),S=nt(S),F=nt(F),h=nt(h),b=nt(b),S=Math.abs(S),R.translate(u,o);var ye=X.matrix.transformPoint(0,0);X.decomp||(X.decomp={}),X.matrix.decompose(X.decomp);var B=(Math.abs(X.decomp.scaleX)+Math.abs(X.decomp.scaleY))/2,N=X.decomp.rotation||0,re=S*B;return X.dp(ye.x,ye.y,re,F,h,N),this},this.closePath=this.close=this.cp=function(){return X.cp(),this},this._noise=new t.Noise(g),this.noise=function(){if(arguments.length==1)return(this._noise.simplex1D.apply(null,arguments)+1)/2;if(arguments.length==2)return(this._noise.simplex2D.apply(null,arguments)+1)/2;if(arguments.length==3)return(this._noise.simplex3D.apply(null,arguments)+1)/2;if(arguments.length==4)return(this._noise.simplex4D.apply(null,arguments)+1)/2},this.stack=[],this.colorStrokeStack=[],this.push=function(){return R.stack.push(X.matrix.clone()),R.colorStrokeStack.push([R.color,R.strokeColor,R.strokeWidth,R.currentColor,R.currentStrokeColor,R.currentStrokeWidth]),this},this.pop=function(){X.matrix=R.stack.pop()||X.matrix;var u=R.colorStrokeStack.pop()||[R.color,R.strokeColor,R.strokeWidth,R.currentColor,R.currentStrokeColor,R.currentStrokeWidth];return R.color=u[0],R.strokeColor=u[1],R.strokeWidth=u[2],R.currentColor=u[3],R.currentStrokeColor=u[4],R.currentStrokeWidth=u[5],X.f(R.currentColor).s(R.currentStrokeColor).ss(R.currentStrokeWidth),X.mt(X.matrix.x,X.matrix.y),this},this.blit=function(){return X.updateCache("source-over"),X.c(),this},this.step=function(){return R.draw&&d(),this},n(R.color)||this.fill(R.color),!n(R.strokeColor)&&R.strokeWidth?this.stroke(R.strokeColor,R.strokeWidth):R.noStroke(),this.translate(K,q),typeof s=="function"&&(this.setup=s,t.timeout(.01,function(){s(0,R.count,R),m&&X.updateCache(),$.update()}));var ne=0;this.maxCount=f,this.resetup=function(u){return n(u)&&(u=!0),ne=0,u&&R.shape.c(),n(R.color)||this.fill(R.color),!n(R.strokeColor)&&R.strokeWidth?this.stroke(R.strokeColor,R.strokeWidth):R.noStroke(),this.reset(),this.setup&&(s(0,R.count,R),m&&X.updateCache(),$.update()),this},this.stampNum=0,typeof a=="function"&&(this.stamp=a,t.timeout(.015,function(){D(0)})),this.restamp=function(u,o){return n(u)&&(u=!0),n(o)&&(o=!0),ne=0,u&&R.shape.c(),o&&R.resetup(u),D(0),this},this.reset=function(){return this.fill(e),!n(r)&&i?this.stroke(r,i):this.noStroke(),X.matrix.identity(),this.translate(x,P),this},this.clear=function(){return this.shape.c(),this};function U(){Q.save({content:$,filename:R.outputName+t.decimals(R.outputNum,null,null,6),type:A}),R.outputNum++}E&&($.update(),U());function D(u){R.stampNum++;var o=t.loop(R.maxCount,function(S,F){if(R.paused)return R.pausedCount=S,!1;if(R.changeCount)return R.changeCount=!1,!1;ne=S+1;var h=a(S+1,F,R,R.stampNum);if(R.currentColor=nt(R.color),X.f(R.currentColor),R.currentStrokeColor=nt(R.strokeColor),X.s(R.currentStrokeColor),R.currentStrokeWidth=nt(R.strokeWidth),X.ss(R.currentStrokeWidth),E&&($.update(),U()),h)return h},null,null,u);m&&X.updateCache(),o&&R.dispatchEvent("complete"),$.update()}R.iterator=0,typeof l=="function"&&(this.draw=l,s?setTimeout(function(){R.ticker=t.Ticker.add(d)},100):this.ticker=t.Ticker.add(d),R.generatorPaused=!1,T&&(R.pauseEvent=$.on("stagemousedown",function(){R.count>=R.maxCount||R.pauseTimeout||(t.Ticker.has(R.ticker)?(t.Ticker.remove(R.ticker),R.generatorPaused=!0,R.dispatchEvent("generatorpaused")):(R.ticker=t.Ticker.add(R.ticker),R.generatorPaused=!1,R.dispatchEvent("generatorunpaused")))})),p&&(R.pauseSpacebarEvent=I.on("keydown",function(u){R.count>=R.maxCount||R.pauseTimeout||u.keyCode==20&&(t.Ticker.has(R.ticker)?(t.Ticker.remove(R.ticker),R.generatorPaused=!0,R.dispatchEvent("generatorpaused")):(R.ticker=t.Ticker.add(R.ticker),R.generatorPaused=!1,R.dispatchEvent("generatorunpaused")))})));function d(){R.iterator++,R.iterator%Math.ceil(R.drawCount)==0&&(R.count++,R.draw(R.count,R.maxCount,R),m&&R.blit(),R.currentColor=nt(R.color),X.f(R.currentColor),R.currentStrokeColor=nt(R.strokeColor),X.s(R.currentStrokeColor),R.currentStrokeWidth=nt(R.strokeWidth),X.ss(R.currentStrokeWidth),R.dispatchEvent("drawing"),$.update(),E&&U()),R.maxCount&&R.count>=R.maxCount&&(R.dispatchEvent("complete"),t.Ticker.remove(R.ticker))}this.redraw=function(u,o){return n(u)&&(u=!0),R.reset(),n(o)&&(o=!0),R.ticker&&t.Ticker.remove(R.ticker),R.iterator=0,R.count=0,u&&R.shape.c(),o?(R.resetup(u),setTimeout(function(){R.ticker&&(R.ticker=t.Ticker.add(R.ticker))},100)):R.ticker&&(R.ticker=t.Ticker.add(R.ticker)),this},this.paused=!1,this.pause=function(u,o){if(n(u)&&(u=!0),!(R.count>=R.maxCount)){if(u==this.paused)return this;this.paused=u,this.pauseTimeout&&this.pauseTimeout.clear(),this.paused?R.ticker&&t.Ticker.remove(R.ticker):R.ticker?R.ticker=t.Ticker.add(R.ticker):D(R.pausedCount,R.maxCount),setTimeout(function(){$.update()},20),o&&(this.pauseTimeout=t.timeout(o,function(){R.pause(!R.paused),R.pauseTimeout=null})),R.dispatchEvent(R.paused?"paused":"unpaused")}},this.outOfBounds=function(u,o){n(u)&&(u=0),n(o)&&(o=u);var S=R.shape.stage;if(S)return R.currentX>S.width-u||R.currentX<0+u||R.currentY>S.height-o||R.currentY<0+o},this.stop=function(){R.pause(),R.pauseEvent&&$.off("stagemousedown",R.pauseEvent),R.pauseSpaceEvent&&I.off("keydown",R.pauseSpaceEvent)},Object.defineProperty(this,"count",{get:function(){return ne},set:function(u){ne=u,R.stamp&&(R.changeCount=!0,setTimeout(function(){D(ne,R.maxCount)}))}}),Object.defineProperty(this,"currentX",{get:function(){return K},set:function(){dt&&tt("Generator() - currentX is read only")}}),Object.defineProperty(this,"currentY",{get:function(){return q},set:function(){dt&&tt("Generator() - currentY is read only")}}),this.clone=function(){return R.cloneProps(new t.Generator(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,y,R.group,L))},R.dispose=function(u,o,S){return R.pause(),R.ticker&&t.Ticker.remove(R.ticker),R.pauseEvent&&$.off("stagemousedown",R.pauseEvent),R.pauseSpacebarEvent&&I.off("keydown",R.pauseSpacebarEvent),R._noise&&(R._noise=null),R.shape&&R.shape.dispose(),R.drawing&&R.drawing.dispose(),R.shape=R.drawing=null,S||R.zimContainer_dispose(),!0},y!==!1&&t.styleTransforms(this,k)},t.extend(t.Generator,t.Container,["clone","dispose"],"zimContainer",!1),t.Pen=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O,X,R,Q){var K="size, color, penType, damp, spread, borderColor, borderWidth, end, paper, nib, cache, ctrlKey, cropScale, undo, undoKeys, move, onTop, deleteable, doubleClickDelete, holdDelete, immediateStop, lineAlpha, lineBlendMode, frame, dashed, pullColor, pullThickness, style, group, inherit",q;if(q=st(t.Pen,arguments,K,this))return q;De("69.93"),this.zimContainer_constructor(),this.type="Pen",this.group=R;var ne=X===!1?{}:t.getStyle(this.type,this.group,Q);n(i)&&(i=ne.penType!=null?ne.penType:"line");var U={size:2,color:t.dark,spread:{min:5,max:20},borderColor:t.darker,borderWidth:0},D={line:{size:2},kitetail:{size:{min:5,max:20},color:t.series(t.pink,t.blue,t.green),borderColor:"rgba(0,0,0,.5)",borderWidth:1},grass:{color:t.green,size:3,spread:{min:10,max:30}},hair:{color:[t.pink,t.blue],size:3,spread:{min:20,max:50}},city:{size:{min:30,max:70},spread:{min:50,max:200},color:[t.dark,t.darker,t.grey]},barbwire:{},splatter:{size:{min:5,max:20},color:"rgba(0,0,0,.5)"}};n(D[i])&&(i="line"),n(e)&&(e=ne.size!=null?ne.size:n(D[i].size)?U.size:D[i].size),n(r)&&(r=ne.color!=null?ne.color:n(D[i].color)?U.color:D[i].color),n(l)&&(l=ne.damp!=null?ne.damp:.5),l===!1&&(l=1),n(a)&&(a=ne.spread!=null?ne.spread:n(D[i].spread)?U.spread:D[i].spread),n(s)&&(s=ne.borderColor!=null?ne.borderColor:n(D[i].borderColor)?U.borderColor:D[i].borderColor),n(f)&&(f=ne.borderWidth!=null?ne.borderWidth:n(D[i].borderWidth)?U.borderWidth:D[i].borderWidth),n(c)&&(c=ne.end!=null?ne.end:t.isPick(e)||t.isPick(r)||i!="line"?"butt":"round"),n(P)&&(P=ne.cropScale!=null?ne.cropScale:1),n(p)&&(p=ne.cache!=null?ne.cache:!0),n(m)&&(m=ne.undo!=null?ne.undo:0),n(v)&&(v=ne.undoKeys!=null?ne.undoKeys:!0),n(I)&&(I=ne.move!=null?ne.move:!0),n(E)&&(E=ne.deleteable!=null?ne.deleteable:!0),n(A)&&(A=ne.doubleClickDelete!=null?ne.doubleClickDelete:!0),n(y)&&(y=ne.holdDelete!=null?ne.holdDelete:!0),n(g)&&(g=ne.onTop!=null?ne.onTop:!0),n(C)&&(C=ne.immediateStop!=null?ne.immediateStop:"both"),n(L)&&(L=ne.lineAlpha!=null?ne.lineAlpha:1),n(Y)&&(Y=ne.lineBlendMode!=null?ne.lineBlendMode:"normal"),n(w)&&(w=ne.paper!=null?ne.paper:new t.Container),n(T)&&(T=ne.nib!=null?ne.nib.clone():null),n(_)&&(_=ne.frame!=null?ne.frame:j.zdf),n(k)&&(k=ne.dashed!=null?ne.dashed:null),k===!0&&(k=[3,100]),n($)&&($=ne.pullColor!=null?ne.pullColor:null),n(O)&&(O=ne.pullThickness!=null?ne.pullThickness:1);var d=this;this.dampX=new t.Damp(null,l),this.dampY=new t.Damp(null,l);var u=!0;this.drawing=!1,this.immediateStop=C,this.undoLevels=m,this.undoKeys=v,this.move=I,this.draggable=!0,this.lineAlpha=L,this.lineBlendMode=Y;var o=d.shape=new t.Shape,S=_.stage.width,F=_.stage.height,h,b,ye,B;d.paperNum=0,d.sizeScale=1,d.spreadScale=1,d.sizeFactor=1,d.spreadFactor=1,d.pullThickness=O,d.stop=function(){};var N;this.added(function(Z){N=Z,d.paper=w,S=d.stage.width,F=d.stage.height,n(T)?d.stageDown=N.on("stagemousedown",function(oe){d.dispatchEvent("start")}):d.zimDown?d.nib=T.addTo(d):(d.nib=T.addTo(d.parent,d.parent.getChildIndex(d)),d.nib.x=d.x,d.nib.y=d.y,d.nib.mouseEnabled=!1,d.stageDown=N.on("stagemousedown",function(oe){N=oe.target.stage,d.nibEvent=N.on("stagemousemove",de),d.dispatchEvent("start")}),d.stageUp=N.on("stagemouseup",function(){N.off("stagemousemove",d.nibEvent)}));function de(oe){d.drawing&&(d.nib.x=oe.stageX/t.scaX,d.nib.y=oe.stageY/t.scaY)}d.zimDragCheck=!1,d.stop=function(){d.stopCheck(!0)},d.infinite=!1,d.stopCheck=function(oe){if(oe)d.drawing=!1,d.infinite=!1;else if(d.infinite||d.zimDragCheck||!d.immediateStop&&d.drawing)return;d.immediate(d.x,d.y),setTimeout(function(){var Ce;if(!d.drawing){if(p?(o.cache(-(S*P-S)/2,-(F*P-F)/2,S*P,F*P),Ce=w.bitmap=new t.Bitmap(o.cacheCanvas).reg((S*P-S)/2,(F*P-F)/2).addTo(w),o.graphics.clear(),o.uncache(),o.top()):Ce=o,d.undoLevels>0){var Me={paper:w,line:Ce};m.push(Me),m.length>d.undoLevels&&m.shift(),d.dispatchEvent("recordUndo")}p||(o=new t.Shape().clone().addTo(w)),d.lastSegment=Ce,d.lastSelected=Ce,Ce.alpha=d.lineAlpha,Ce.blendMode=d.lineBlendMode,Ce.paper=w,d.dispatchEvent("stop"),d.dispatchEvent("change")}},d.immediateStop||oe?0:50)};var V=0;d.dampX.immediate(d.x),d.dampY.immediate(d.y),d.lastX=d.lastMidX=d.drawX=d.x,d.lastY=d.lastMidY=d.drawY=d.y;var fe,ke;d.ticker=t.Ticker.add(function(){if(d.parent){var oe=d.dampX.convert(u?d.x:d.finishX),Ce=d.dampY.convert(u?d.y:d.finishY),Me=d.parent.localToLocal(oe,Ce,o);if(Math.abs(d.lastX-oe)+Math.abs(d.lastY-Ce)<1){if(d.drawing&&(d.drawing=!1,d.zimDown?(d.x=d.lastX=d.lastMidX=u?d.x:d.finishX,d.y=d.lastY=d.lastMidY=u?d.y:d.finishY):(d.x=d.finishX=d.lastX=d.lastMidX=oe,d.y=d.finishY=d.lastY=d.lastMidY=Ce),d.stopCheck(),fe=ke=null),d.lastX=d.lastMidX=oe,d.lastY=d.lastMidY=Ce,w){var te=w.localToLocal(0,0,d.parent);d.lastMidX-=te.x,d.lastMidY-=te.y}return}else{var ae=t.Pick.choose(e)*d.sizeScale*d.sizeFactor,we=t.Pick.choose(a)*d.spreadScale*d.spreadFactor;d.drawing||(G=[],w.getChildIndex(o)!=w.numChildren-1&&o.top()),d.drawing=!0,d.dispatchEvent("drawing")}var ue=d.parent.localToLocal(d.lastX,d.lastY,o),Pe;w?Pe=w.localToLocal(d.lastMidX,d.lastMidY,o):Pe=d.parent.localToLocal(d.lastMidX,d.lastMidY,o);var ie,be,Le;if(i=="splatter")for(var me=0;me<=3;me++){var ee=t.rand(360)*Math.PI/180,Ie=we,Re={x:oe+Ie*Math.cos(ee),y:Ce+Ie*Math.sin(ee)},_e=d.parent.localToLocal(Re.x,Re.y,o);o.graphics.mt(_e.x,_e.y).f(t.Pick.choose(r)).dc(_e.x,_e.y,ae/2)}else i=="grass"||i=="hair"||i=="city"?((i=="grass"||i=="hair")&&(ie=d.lastX+(oe-d.lastX)/2,be=d.lastY+(Ce-d.lastY)/2,Le=d.parent.localToLocal(ie,be,o),o.graphics.s(t.Pick.choose(r)).ss(ae,c).mt(Le.x,Le.y).lt(Le.x+t.rand(-we/4,we/4),i=="hair"?Le.y+we:Le.y-we)),(i=="grass"||i=="hair"||i=="city"&&V%3==0)&&o.graphics.s(t.Pick.choose(r)).ss(ae,c).mt(Me.x,Me.y).lt(Me.x+(i=="city"?0:t.rand(-we/4,we/4)),i=="hair"?Le.y+we:Me.y-we),V++):(i=="kitetail"&&o.graphics.s(t.Pick.choose(r)).ss(ae,c),i=="barbwire"?(o.graphics.s(t.Pick.choose(r)).ss(ae,c),ie=d.lastX+(oe-d.lastX)/2+t.rand(-we,we),be=d.lastY+(Ce-d.lastY)/2+t.rand(-we,we)):(ie=d.lastX+(oe-d.lastX)/2,be=d.lastY+(Ce-d.lastY)/2),Le=d.parent.localToLocal(ie,be,o),i!="line"&&o.graphics.qt(ue.x,ue.y,Le.x,Le.y));if(f>0&&i!="line"&&(ie=d.lastX+(oe-d.lastX)/2,be=d.lastY+(Ce-d.lastY)/2,Le=d.parent.localToLocal(ie,be,o),o.graphics.s(t.Pick.choose(s)).ss(t.Pick.choose(f)).mt(Pe.x,Pe.y).qt(ue.x,ue.y,Le.x,Le.y),i=="splatter"&&o.graphics.es()),i=="splatter")o.graphics.f(t.Pick.choose(r));else if(i!="kitetail")if(i=="line"){if(t.isPick(r)||ae!=ke){var Ze=t.Pick.choose(r);(Ze!=fe||ae!=ke)&&o.graphics.s(Ze).ss(ae,c),fe=Ze,ke=ae}}else o.graphics.s(t.Pick.choose(r)).ss(ae,c);i!="grass"&&i!="hair"&&i!="city"&&i!="splatter"&&o.graphics.mt(Pe.x,Pe.y).qt(ue.x,ue.y,Le.x,Le.y),k&&o.graphics.sd(k),d.lastX=oe,d.lastY=Ce,Le&&(d.lastMidX=Le.x,d.lastMidY=Le.y),d.drawX=d.lastMidX||0,d.drawY=d.lastMidY||0}}),n($)||re(N),d.mouseChildren=!1});function re(Z){var de=Z.frame;d.ppdEvent&&d.off("drawing",d.ppdEvent),d.ppsEvent&&d.off("stop",d.ppsEvent),d.ppmEvent&&Z.off("stagemousedown",d.ppmEvent),d.pullShape||(d.pullShape=new t.Shape),d.ppdEvent=d.on("drawing",function(){setTimeout(function(){var V=w.localToGlobal(d.drawX,d.drawY);d.pullShape.c().s($).ss(d.pullThickness).mt(de.mouseX,de.mouseY).lt(V.x,V.y)},10)}),d.ppsEvent=d.on("stop",function(){d.pullShape.removeFrom(),d.pullShape.c()}),d.ppmEvent=Z.on("stagemousedown",function(){d.pullShape.addTo(Z),d.immediate(de.mouseX,de.mouseY),d.motionController&&d.motionController.immediate(de.mouseX,de.mouseY)})}function le(){d.ppdEvent&&d.off("drawing",d.ppdEvent),d.ppsEvent&&d.off("stop",d.ppsEvent),d.ppmEvent&&d.off("stagemousedown",d.ppmEvent),d.pullShape&&d.pullShape.dispose()}m=[];var G=[];this.saveState=function(Z,de,V){var fe=Z.type=="Container"?"paper":"line",ke={paper:d.paper};ke[fe]=Z,ke[fe+"Transform"]={x:Z.x,y:Z.y,r:Z.rotation,a:Z.alpha,rX:Z.regX,rY:Z.regY,sX:Z.scaleX,sY:Z.scaleY,skX:Z.skewX,skY:Z.skewY,v:Z.visible},!n(de)&&!n(V)&&de!=V&&(ke.startLayer=de,ke.endLayer=V),m.push(ke),d.dispatchEvent("recordUndo"),m.length>d.undoLevels&&m.shift()};var z={x:0,y:0,r:0,a:1,rX:0,rY:0,sX:1,sY:1,skX:0,skY:0,v:!0};this.undo=function(){var Z=m.pop();if(Z){if(G.push(Z),Z.clear){for(var de=0;de<Z.clear.length;de++)Z.paper.addChild(Z.clear[de]);Z.paper.addChild(o)}else Z.line&&Z.lineTransform?(n(Z.startLayer)||(o.top(),Z.paper.setChildIndex(Z.line,ye)),se("line",Z.line)):Z.line?Z.line.removeFrom():Z.paperTransform&&se("paper",Z.paper);d.lastPaper=d.paper,Z.paper!=d.paper&&(d.paper=Z.paper,d.dispatchEvent("paperChange")),d.dispatchEvent("change"),d.dispatchEvent("undo"),!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&d.stage&&d.stage.update()}};function se(Z,de){for(var V,fe=m.length-1;fe>=0;fe--)if(m[fe][Z]==de&&m[fe][Z+"Transform"]){V=m[fe][Z+"Transform"];break}V||(V=t.copy(z)),de.x=V.x,de.y=V.y,de.alpha=V.a,de.rotation=V.r,de.regX=V.rX,de.regY=V.rY,de.scaleX=V.sX,de.scaleY=V.sY,de.skewX=V.skX,de.skewY=V.skY,de.visible=V.v,Z=="line"&&p&&(de.regX=(S*P-S)/2,de.regY=(F*P-F)/2)}this.redo=function(){var Z=G.pop(),de,V;Z&&(m.push(Z),Z.clear?(Z.paper.removeAllChildren(),Z.paper.addChild(o)):Z.line&&Z.lineTransform?(n(Z.endLayer)||(o.top(),Z.paper.setChildIndex(Z.line,B)),V=Z.lineTransform,de=Z.line):Z.line?Z.line.addTo(Z.paper):Z.paperTransform&&(V=Z.paperTransform,de=Z.paper),de&&(de.x=V.x,de.y=V.y,de.alpha=V.a,de.rotation=V.r,de.regX=V.rX,de.regY=V.rY,de.scaleX=V.sX,de.scaleY=V.sY,de.skewX=V.skX,de.skewY=V.skY,de.visible=V.v),d.lastPaper=d.paper,Z.paper!=d.paper&&(d.paper=Z.paper,d.dispatchEvent("paperChange")),d.dispatchEvent("change"),d.dispatchEvent("redo"),!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&d.stage&&d.stage.update())},d.ctrlKey=!1,d.shiftKey=!1,d.ctrlKeyCheck=!1,d.zimkeydownEvent=function(Z){d.ctrlKey=Z.ctrlKey,d.shiftKey=Z.shiftKey,Z.keyCode==17&&I&&!d.ctrlKeyCheck&&(d.ctrlKeyCheck=!0,w.noDrag(),w.drag({onTop:g,all:!0})),!(d.undoLevels<=0)&&d.undoKeys&&(Z.ctrlKey&&(Z.shiftKey&&Z.keyCode==90||Z.keyCode==89)?d.redo():Z.ctrlKey&&Z.keyCode==90&&d.undo(),_&&_.ctrlKey&&d.write&&(d.lastWrite=d.write,d.write=!1))},j.addEventListener("keydown",d.zimkeydownEvent),d.zimkeyupEvent=function(Z){Z.keyCode==17&&I&&d.ctrlKeyCheck&&(d.ctrlKeyCheck=!1,w.noDrag(),w.drag({onTop:g})),Z.ctrlKey||(d.ctrlKey=!1),Z.shiftKey||(d.shiftKey=!1),_&&!_.ctrlKey&&d.write==!1&&(d.write=d.lastWrite)},j.addEventListener("keyup",d.zimkeyupEvent),Object.defineProperty(this,"paper",{get:function(){return w},set:function(Z){Z.type=="Container"&&(w=Z,o.addTo(w,0,!1),w.shape=o,d.dampX.immediate(d.x),d.dampY.immediate(d.y),d.lastX=d.lastMidX=d.finishX=d.x,d.lastY=d.lastMidY=d.finishY=d.y,i=="barbwire"&&o.graphics.s(t.Pick.choose(r)).ss(t.Pick.choose(e)*d.sizeScale*d.sizeFactor,c),o.graphics.mt(d.x,d.y),w.parent||w.addTo(d.parent,d.parent.getChildIndex(d)),n(w.paperNum)&&(w.paperNum=++d.paperNum,E&&w.on("mousedown",function(de){d.lastSelected=de.target,d.nibEvent&&d.stage.off("stagemousemove",d.nibEvent);var V=de.target.paper;V&&(V!=d.paper&&(d.paper=V,d.dispatchEvent("paperChange")),d.shiftKey&&(d.ctrlKey?d.clear():(de.target.visible=!1,d.undoLevels>0&&d.saveState(de.target),d.dispatchEvent("change"))))}),A&&w.on("dblclick",function(de){de.target.visible=!1,d.undoLevels>0&&d.saveState(de.target)}),A&&w.hold(function(de){de.target.visible=!1,d.undoLevels>0&&d.saveState(de.target)}),I&&(w.on("mousedown",function(de){N=de.target.stage,d.draggingCheck=!0,!(d.shiftKey&&E)&&(h=de.stageX/t.scaX,b=de.stageY/t.scaY,o.top(),ye=w.getChildIndex(de.target))}),w.drag({onTop:g}),w.on("pressup",function(de){if(!(E&&d.shiftKey)&&de.target.visible!=!1&&!(d.undoLevels<=0)){if(Math.abs(de.stageX/t.scaX-h)<1&&Math.abs(de.stageY/t.scaY-b)<1){g&&(o.top(),B=w.getChildIndex(de.target),ye!=B&&d.saveState(de.target,ye,B));return}d.ctrlKey?(d.saveState(w),d.dispatchEvent("paperChange")):(o.top(),B=w.getChildIndex(de.target),d.saveState(de.target,ye,B)),d.dispatchEvent("change"),o.top()}}))))}}),Object.defineProperty(this,"write",{get:function(){return u},set:function(Z){u&&Z===!1&&(d.finishX=d.x,d.finishY=d.y),!u&&Z&&(o.graphics.es(),o.graphics.ef(),d.dampX.immediate(d.x),d.dampY.immediate(d.y),d.lastX=d.lastMidX=d.x,d.lastY=d.lastMidY=d.y),u=Z}}),Object.defineProperty(this,"size",{get:function(){return e},set:function(Z){o.graphics.es(),o.graphics.ef(),e=Z,i!="splatter"&&o.graphics.ss(t.Pick.choose(e)*d.sizeScale*d.sizeFactor,c)}}),Object.defineProperty(this,"color",{get:function(){return r},set:function(Z){r=Z,o.graphics.es(),o.graphics.ef(),i!="splatter"&&o.graphics.s(t.Pick.choose(r))}}),Object.defineProperty(this,"penType",{get:function(){return i},set:function(Z){i=Z,o.graphics.ef().es(),i!="splatter"?o.graphics.s(t.Pick.choose(r)):o.graphics.s(t.Pick.choose(r)).ss(t.Pick.choose(e)*d.sizeScale*d.sizeFactor,c)}}),Object.defineProperty(this,"end",{get:function(){return c},set:function(Z){c=Z}}),Object.defineProperty(this,"damp",{get:function(){return l},set:function(Z){l=Z,d.dampX.damp=l,d.dampY.damp=l}}),Object.defineProperty(this,"spread",{get:function(){return a},set:function(Z){a=Z}});var Oe,J;this.setColorRange=function(Z,de){return n(de)?(Oe=d.color,J=Z):n(Z)?(Oe=d.color,J=de):(Oe=Z,J=de),d};var pe=0;Object.defineProperty(d,"colorRange",{get:function(){return pe},set:function(Z){pe=Z,!n(Oe)&&!n(J)&&(d.color=t.colorRange(Oe,J,Z))}}),Object.defineProperty(this,"borderColor",{get:function(){return s},set:function(Z){s=Z}}),Object.defineProperty(this,"borderWidth",{get:function(){return f},set:function(Z){f=Z}}),Object.defineProperty(this,"pullColor",{get:function(){return $},set:function(Z){if(n(Z||Z==-1))le(),$=null;else if(n($)){$=Z;var de=N||zdf.stage;re(de)}else $=Z}}),d.setPen=function(Z){d.dampX.immediate(d.x),d.dampY.immediate(d.y),d.lastX=d.lastMidX=d.finishX=d.x,d.lastY=d.lastMidY=d.finishY=d.y,n(Z)&&(Z=i),n(D[Z])&&(Z="line"),d.penType=i=Z;var de=t.merge(U,D[Z]);for(var V in de)d[V]!=de[V]&&(d[V]=de[V]);return d},d.immediate=function(Z,de){return n(Z)||(d.x=Z,d.dampX.immediate(d.x),d.lastX=d.lastMidX=d.finishX=d.x),n(de)||(d.y=de,d.dampY.immediate(d.y),d.lastY=d.lastMidY=d.finishY=d.y),d},d.clear=function(){for(var Z=[],de=0;de<w.numChildren-1;de++)Z.push(w.getChildAt(de));return m.push({paper:w,clear:Z}),m.length>d.undoLevels&&m.shift(),d.dispatchEvent("recordUndo"),w.removeAllChildren(),o.graphics.clear(),w.addChild(o),d.dispatchEvent("change"),d.stage&&d.stage.update(),d},this.deleteSegment=function(Z){Z.visible=!1,d.undoLevels>0&&d.saveState(Z)},this.clone=function(){return this.cloneChildren(this.cloneProps(new t.Pen(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O,X,R,Q)))},d.dispose=function(Z,de,V){return n(Z)&&(Z=!0),j.removeEventListener("keydown",d.zimkeydownEvent),j.removeEventListener("keyup",d.zimkeyupEvent),N&&d.nibEvent&&N.off("stagemousemove",d.nibEvent),N&&d.stageDown&&N.off("stagemousedown",d.stageDown),N&&d.stageUp&&N.off("stagemouseup",d.stageUp),N&&d.upEvent&&N.off("stagemouseup",d.upEvent),t.Ticker.remove(d.ticker),d.removeAllEventListeners(),T&&T.removeFrom(),Z&&(d.shape&&d.shape.dispose(),d.paper&&d.paper.dispose(),p&&(d.bitmap&&d.bitmap.dispose(),d.bitmap=null),d.zimContainer_dispose(V),w=o=d.shape=null),!0},X!==!1&&t.styleTransforms(this,ne)},t.extend(t.Pen,t.Container,["dispose","clone"],"zimContainer",!1),t.SoundWave=function(e,r,i,l,a,s,f,c,w,T,p,x){var P="num, input, include, smoothing, min, max, operation, baseline, magnify, reduce, adjust, channel",m;if(m=st(t.SoundWave,arguments,P,this))return m;De("69.95"),this.type="SoundWave",n(e)&&(e=120),n(r)&&(r="mic"),n(i)&&(i=120/1024),n(l)&&(l=.85),n(a)&&(a=r=="mic"?-80:(r.oscillator,-100)),n(s)&&(s=r=="mic"?-40:(r.oscillator,-10)),n(f)&&(f=function(L,Y){return L*(.5+Y*1/Math.pow(t.SoundWave.bufferLength,.95))}),n(c)&&(c=r=="mic"?0:(r.oscillator,30)),n(w)&&(w=r=="mic"?1:r.oscillator?5:10),n(T)&&(T=0),n(p)&&(p=5),t.SoundWave.bufferLength=1024;var v=e,I=this;I.baseline=c,I.magnify=w,I.reduce=T,I.input=r,I.adjust=p;var g;r.type=="Tone"||r.type=="SynthSound"?g=r.audioContext:g=new(j.AudioContext||j.webkitAudioContext);var E=I.analyser=g.createAnalyser();E.minDecibels=a,E.maxDecibels=s,E.smoothingTimeConstant=l,Object.defineProperty(this,"smoothing",{get:function(){return E.smoothingTimeConstant},set:function(L){E.smoothingTimeConstant=L}}),Object.defineProperty(this,"num",{get:function(){return v},set:function(L){v=L,A=Math.floor(i*t.SoundWave.bufferLength/v),A<1&&tt("ZIM SoundWave: num is too big")}}),this.setInput=function(L){if(I.input=L,L=="mic"){navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia({audio:!0}).then(function(k){var $=I.source=g.createMediaStreamSource(k);C($)}).catch(function(k){tt("ZIM SoundWave: Error occured: "+k)}):navigator.getUserMedia?navigator.getUserMedia({audio:!0},function(k){var $=I.source=g.createMediaStreamSource(k);C($)},function(k){tt("ZIM SoundWave: Error occured: "+k)}):tt("ZIM SoundWave: Sorry, mic not supported");return}else if(L.type=="Tone")C(L.compressor);else if(L.type=="SynthSound")C(L.gain);else{if(L.type&&L.type=="sound"){tt("ZIM SoundWave: pass in the result of a zim.asset('somesound').play() for the input");return}var Y,_;L.playbackResource?(Y=L.playbackResource,_=g.createMediaElementSource(Y)):(Y=L,_=g.createMediaElementSource(Y)),C(_)}},this.setInput(r);var A,y;function C(L){if(y&&y.disconnect(E),y=L,n(x)||x!==0&&x!==1)L.connect(E),r!="mic"&&E.connect(g.destination);else{var Y=new ChannelSplitterNode(g,{numberOfOutputs:2});L.connect(Y),Y.connect(E,x);var _=new ChannelMergerNode(g,{numberOfInputs:2});E.connect(_,0,x),r!="mic"&&_.connect(g.destination)}if(E.fftSize=t.SoundWave.bufferLength*2,A=Math.floor(i*t.SoundWave.bufferLength/v),A<1){tt("ZIM SoundWave: include param is too small or num param is too big");return}var k=E.frequencyBinCount,$=new Uint8Array(k),O=300,X=0,R=0,Q=Math.round(60*I.adjust*.8),K=new t.Damp(O,.01);I.calculate=function(q){n(q)&&(q=!0),E.getByteFrequencyData($);var ne=$.map(f);if(A==1&&!q)return ne;var U=[],D=0,d;for(d=0;d<=i*t.SoundWave.bufferLength;d++)D+=ne[d],d!=0&&d%A==0&&(U.push(Math.max(0,(D/A-I.baseline)*I.magnify-I.reduce)),D=0);var u=U.length;if(r!="mic"&&(U[0]*=.75,U[1]*=.85,U[2]*=.9,U[u-2]*=.8,U[u-1]*=.75),U[u-1]*=1.3,U[u-2]*=1.2,U[u-3]*=1.1,q){var o=[];Q++,Q>=60*I.adjust&&(O=X/Q,X=0,R=0,Q=0);var S=K.convert(O);for(d=0;d<u;d++)U[d]>R&&(R=U[d]),o[d]=Math.min(1,S!=0?U[d]/S:0);return X+=R,o}return U},setTimeout(function(){I.dispatchEvent("ready")},50)}this.dispose=function(L){return L&&g&&g.close(),E&&E.disconnect(),!0}},t.extend(t.SoundWave,Ne.EventDispatcher,null,"cjsEventDispatcher",!1),t.Synth=function(e,r){De("69.955"),this.type="Synth",n(e)&&(e=.3),n(r)&&(r=220),this.volume=e,this.frequency=r;var i=this,l;this.play=function(a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O,X,R,Q,K,q,ne,U,D,d,u,o,S,F,h,b,ye,B,N,re,le,G,z,se,Oe,J,pe){var Z=Array.prototype.slice.call(arguments);if(Z=Z.shift(),!l&&(j.AudioContext||j.webkitAudioContext)&&(l=new(j.AudioContext||j.webkitAudioContext),l.z=l.createBufferSource,l.createBufferSource=function(fe){return fe==null&&(fe=l.z()),fe.start=fe.start||function(ke){l.noteOn(ke)},fe}),!!l){for(a=a!=null?nt(a):0,s=s!=null?nt(s):.3,f=f!=null?nt(f):.05,c=c!=null?nt(c):220,w=w!=null?nt(w):0,T=T!=null?nt(T):0,p=p!=null?nt(p):.1,x=x!=null?nt(x):0,P=P!=null?nt(P):1,m=m!=null?nt(m):0,v=v!=null?nt(v):0,I=I!=null?nt(I):0,g=g!=null?nt(g):0,E=E!=null?nt(E):0,A=A!=null?nt(A):0,y=y!=null?nt(y):0,C=C!=null?nt(C):0,L=L!=null?nt(L):0,k=k!=null?nt(k):0,Y=Y!=null?nt(Y):1,_=_!=null?nt(_):0,q=q!=null?nt(q):44100,ne==null&&(ne=99+w*q),U==null&&(U=T*q),D==null&&(D=p*q),d==null&&(d=_*q),u==null&&(u=L*q),o==null&&(o=Math.PI*2),S==null&&(S=function(fe){return fe>0?1:-1}),F==null&&(F=ne+d+U+D+u),h==null&&(h=m*=500*o/Math.pow(q,2)),b==null&&(b=c*=(1+f*2*Math.random()-f)*o/q),ye==null&&(ye=S(y)*o/4),B==null&&(B=0),N==null&&(N=0),re==null&&(re=0),le==null&&(le=0),G==null&&(G=0),z==null&&(z=0),se==null&&(se=1),Oe==null&&(Oe=[]),J==null&&(J=l.createBufferSource()),pe==null&&(pe=l.createBuffer(1,F,q)),J.connect(l.destination);re<Math.floor(F);Oe[re++]=z)++G>C*100&&(G=0,z=B*c*Math.sin(N*y*o/q-ye),z=x?x>1?x>2?x>3?Math.sin(Math.pow(z%o,3)):Math.max(Math.min(Math.tan(z),1),-1):1-(2*z/o%2+2)%2:1-4*Math.abs(Math.round(z/o)-z/o):Math.sin(z),z=(E?1-k+k*Math.sin(o*re/E):1)*S(z)*Math.pow(Math.abs(z),P)*s*i.volume*(re<ne?re/ne:re<ne+d?1-(re-ne)/d*(1-Y):re<ne+d+U?Y:re<F-u?(F-re-u)/D*Y:0),z=u?z/2+(u>re?0:(re<F-u?1:(re-F)/u)*Oe[re-u|0]/2):z),B+=1-A+(Math.sin(re)+1)*1e9%2*A,N+=1-A+(Math.pow(Math.sin(re),2)+1)*1e9%2*A,c+=m+=v*500*o/Math.pow(q,3),se&&++se>g*q&&(c+=I*o/q,b+=I*o/q,se=0),E&&++le>E*q&&(c=b,m=h,le=1,se=se||1);pe.getChannelData(0).set(Oe),J.buffer=pe;var de=new Ne.EventDispatcher;de.type="SynthSound",de.audioContext=l,de.gain=l.createGain(),J.connect(de.gain),de.gain.connect(l.destination),de.pan=l.createStereoPanner(),de.pan.pan.value=a,J.connect(de.pan),de.pan.connect(l.destination),J.start(),de.duration=Oe.length/q,de.playing=!0,de.stop=function(){clearTimeout(de.completeID),clearInterval(de.repeatID),de.gain.gain.setTargetAtTime(0,l.currentTime,.1),de.playing=!1,setTimeout(function(){l.close()},.1*1e3)};var V;return de.repeat=de.loop=function(fe,ke){V=0,fe===!0&&(fe=null),n(ke)&&(ke=0),clearTimeout(de.completeID);function oe(){return de.duration+nt(ke)}return de.repeatID=t.interval(oe,function(){V++,fe&&V>=fe?(de.dispatchEvent("complete"),de.repeatID.clear(),de.playing=!1):(de.dispatchEvent("loop"),i.play.apply(i,Z))}),de},de.play=function(){return i.play.apply(i,Z),de.playing=!0,de},de.completeID=setTimeout(function(){de.dispatchEvent("complete")},(Oe.length/q+.1)*1e3),de}},this.Tone=function(a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_){var k="volume, note, shape, pan, duration, attack, release, wahAmount, wahRate, wahShape, wahThroat, wahNote, vibratoAmount, vibratoRate, vibratoShape, tremeloAmount, tremeloRate, tremeloShape, startTime, pauseOnBlur",$;if($=st(i.Tone,arguments,k,this))return $;this.type="Tone";var O=this,X;n(a)&&(a=i.volume),n(s)&&(s=i.frequency),n(f)&&(f=t.SINE),n(c)&&(c=0),n(T)&&(T=.02),n(p)&&(p=.05),n(Y)&&(Y=0),j.AudioContext||j.webkitAudioContext?X=this.audioContext=new(j.AudioContext||j.webkitAudioContext):dt&&tt("Synth tone() needs AudioContext"),a=nt(a),s=nt(s),f=nt(f),c=nt(c),w=nt(w),T=nt(T),p=nt(p),x=nt(x),P=nt(P),m=nt(m),v=nt(v),I=nt(I),g=nt(g),E=nt(E),A=nt(A),y=nt(y),C=nt(C),L=nt(L),Y=nt(Y);var R=wt(w);i.duration=w,w&&(w=w*(R=="s"?1:1/1e3)),Y&&(wt(Y),Y=Y*(R=="s"?1:1/1e3)),i.attack=T,i.release=p,i.rampDuration=.02,i.hush=.1;var Q=this.note=this.oscillator=X.createOscillator();Q.frequency.value=t.Synth.note(s),t.Synth.setShape(Q,f);var K=this.filter=X.createBiquadFilter();K.type="bandpass",K.frequency.value=Q.frequency.value,K.Q.value=0;var q=this.gain=Q.gain=X.createGain();q.type="gain",q.gain.setValueAtTime(0,X.currentTime);var ne=this.compressor=X.createDynamicsCompressor();ne.threshold.setValueAtTime(-50,X.currentTime),ne.knee.setValueAtTime(40,X.currentTime),ne.ratio.setValueAtTime(12,X.currentTime),ne.attack.setValueAtTime(0,X.currentTime),ne.release.setValueAtTime(.25,X.currentTime);var U=this.panNode=X.createStereoPanner();this.panNode.pan.value=c,Q.connect(K),K.connect(U),U.connect(q),q.connect(ne),ne.connect(X.destination);function D(G,z){n(G)&&(G=X.currentTime),n(z)&&(z=i.attack),Q.start(G);var se=j.zdf&&new Date().getTime()-j.zdf.startTime<200?.1:i.attack;q.gain.setValueAtTime(0,X.currentTime+.1),q.gain.linearRampToValueAtTime(a*i.hush,X.currentTime+.1+se)}D(Y),this.stop=function(G){n(G)&&(G=i.release),q&&u(q.gain,0,!0,G),N&&u(N.gain,0,!0,G),b&&u(b.gain,0,!0,G),setTimeout(function(){O.dispatchEvent("complete")},(.6+G+i.rampDuration)*1e3),setTimeout(function(){X&&!X.iamClosed&&(X.iamClosed=!0,X.close())},(G+1)*1e3),setTimeout(function(){o&&O.removeWah()},(G+1)*1e3)},w&&this.stop(Y+w-.1);var d=this.notes=[Q];this.addNote=function(G,z,se,Oe,J,pe){n(Oe)&&(Oe=!0),n(J)&&(J=!1),n(G)&&(G=.1),n(pe)&&(pe=0);var Z={type:"Note"};Z._volume=G,Z._note=t.Synth.note(z),d.push(Z);var de=Z.oscillator=X.createOscillator();de.frequency.value=Z._note,de.type=t.Synth.setShape(de,se);var V=Z.gain=X.createGain();return u(V.gain,Z._volume,!0),V.connect(Oe?K:q),de.connect(V),b&&J&&b.connect(de.frequency),de.start(X.currentTime+pe),Object.defineProperty(Z,"volume",{get:function(){return Z._volume},set:function(fe){n(fe)||(Z._volume=nt(fe),u(Z.gain.gain,Z._volume,!0))}}),Object.defineProperty(Z,"note",{get:function(){return Z._note},set:function(fe){n(fe)||(Z._note=nt(fe),u(Z.oscillator.frequency,t.Synth.note(Z._note)))}}),Z},this.removeNote=function(G){var z=d.indexOf(G);return z>=0&&d.splice(z,1),G.oscillator.disconnect(),G=null,this};function u(G,z,se,Oe){n(z)&&(z=0),n(Oe)&&(Oe=i.rampDuration),se?(G.cancelScheduledValues(X.currentTime),G.linearRampToValueAtTime(G.value,X.currentTime+.02),G.linearRampToValueAtTime(z,X.currentTime+.05+Oe)):(G.cancelScheduledValues(X.currentTime),G.setTargetAtTime(z,X.currentTime,Oe))}this.ramp=function(G,z){u(q.gain,G*i.hush,!0,z)},this.rampPan=function(G,z){u(U.pan,G,!1,z)},this.animate=function(){return arguments[0].props?arguments[0].target=this:Array.prototype.unshift.call(arguments,this),t.animate.apply(null,arguments),this},this.wiggle=function(){return arguments[0].props?arguments[0].target=this:Array.prototype.unshift.call(arguments,this),t.wiggle.apply(null,arguments),this},t.addWires(this);var o,S;function F(){n(x)&&(x=1e3),n(P)&&(P=1),n(m)&&(m="sine"),n(v)&&(v=5),n(I)?I=O.oscillator.frequency.value:I=t.Synth.note(I),n(S)&&(S=200),O.filter.Q.value=v,o=O.wah=i.oscillator(P,x/2,m,I+x/2+S),o.ticker=t.Ticker.add(function(){O.filter.frequency.value=O.wah.amplitude})}(x||P||!n(m)||!n(v))&&F(),O.removeWah=function(){t.Ticker.remove(o.ticker),o.dispose(),o=O.wah=null,O.filter.Q.value=0};var h,b;function ye(){n(E)&&(E=5),n(A)&&(A="sine"),n(g)&&(g=10),h=O.vibrato=X.createOscillator(),b=O.vibratoGain=X.createGain(),b.gain.value=0,h.frequency.value=E,t.Synth.setShape(h,A),h.connect(b),b.connect(Q.frequency),h.start(0),b.gain.setValueAtTime(0,X.currentTime+.1),b.gain.linearRampToValueAtTime(g,X.currentTime+.1+i.attack)}(g||E||!n(A))&&ye(),O.removeVibrato=function(){u(b.gain,0,!0),setTimeout(function(){b.disconnect(),h.disconnect(),h.stop(),h=null},(i.rampDuration+1)*1e3)};var B,N;function re(){n(C)&&(C=5),n(L)&&(L="sine"),B=O.tremelo=X.createOscillator(),N=O.tremeloGain=X.createGain(),N.gain.value=0,B.frequency.value=C,t.Synth.setShape(B,L),B.connect(N),N.connect(q.gain),B.start(0);var G=j.zdf&&new Date().getTime()-j.zdf.startTime<200?.1:i.attack;N.gain.setValueAtTime(0,X.currentTime+.1),N.gain.linearRampToValueAtTime(a*i.hush,X.currentTime+.1+G)}(y||C||!n(L))&&re(),O.removeTremelo=function(){u(N.gain,0,!0),setTimeout(function(){N.disconnect(),B.disconnect(),B.stop(),B=null},(i.rampDuration+1)*1e3)},Object.defineProperty(this,"volume",{get:function(){return a},set:function(G){if(!n(G)){var z;B?(q.gain.value?z=N.gain.value/q.gain.value:z=a?y/a:0,a=nt(G),a=t.constrain(a,.001),u(N.gain,a*z*i.hush,!0)):a=nt(G),u(q.gain,a*i.hush,!1,i.rampDuration)}}}),this.paused=!1;var le=a;this.pause=function(G){n(G)&&(G=!0),G?(le=O.volume,O.volume=0):O.volume=le},_&&(n(t.blurCheck)&&t.setBlurDetect(),t.pauseOnBlur.push(this)),Object.defineProperty(this,"frequency",{get:function(){return r},set:function(G){n(G)||(r=nt(G),u(Q.frequency,G))}}),Object.defineProperty(this,"note",{get:function(){return s},set:function(G){n(G)||(s=nt(G),Q.frequency.value=t.Synth.note(s))}}),Object.defineProperty(this,"shape",{get:function(){return f},set:function(G){f=nt(G),t.Synth.setShape(Q,f)}}),Object.defineProperty(this,"pan",{get:function(){return c},set:function(G){n(G)||(c=nt(G),u(U.pan,c,!1,.1))}}),Object.defineProperty(this,"currentTime",{get:function(){return X.currentTime},set:function(){dt&&tt("Synth tone() - currentTime is read only")}}),this.wahAmountMin=0,this.wahAmountMax=5e3,Object.defineProperty(this,"wahAmount",{get:function(){return x},set:function(G){n(G)||(x=nt(G),x=t.constrain(x,i.wahAmountMin,i.wahAmountMax),n(o)?F():o.gain=x/2)}}),this.wahRateMin=0,this.wahRateMax=30,Object.defineProperty(this,"wahRate",{get:function(){return P},set:function(G){n(G)||(P=nt(G),P=t.constrain(P,i.wahRateMin,i.wahRateMax),n(o)?F():o.frequency=P)}}),this.wahThroatMin=0,this.wahThroatMax=100,Object.defineProperty(this,"wahThroat",{get:function(){return v},set:function(G){v=nt(G),v=t.constrain(v,i.wahThroatMin,i.wahThroatMax),n(o)?F():K.Q.value=v}}),Object.defineProperty(this,"wahNote",{get:function(){return I},set:function(G){n(G)||(I=nt(G),n(o)?F():o.offset=I+x/2+S)}}),Object.defineProperty(this,"wahAdjust",{get:function(){return S},set:function(G){n(G)||(S=nt(G),n(o)?F():o.offset=I+x/2+S)}}),Object.defineProperty(this,"wahShape",{get:function(){return m},set:function(G){m=nt(G),n(o)?F():o.shape=m}}),Object.defineProperty(this,"tremeloAmount",{get:function(){return y},set:function(G){n(G)||(y=nt(G),n(B)?re():N.gain.setValueAtTime(y,X.currentTime))}}),Object.defineProperty(this,"tremeloRate",{get:function(){return C},set:function(G){n(G)||(C=nt(G),n(o)?re():B.frequency.value=C)}}),Object.defineProperty(this,"tremeloShape",{get:function(){return L},set:function(G){L=nt(G),n(B)?re():t.Synth.setShape(B,L)}}),Object.defineProperty(this,"vibratoAmount",{get:function(){return g},set:function(G){n(G)||(g=nt(G),n(h)?ye():b.gain.setValueAtTime(g,X.currentTime))}}),Object.defineProperty(this,"vibratoRate",{get:function(){return E},set:function(G){n(G)||(E=nt(G),n(h)?ye():h.frequency.value=E)}}),Object.defineProperty(this,"vibratoShape",{get:function(){return A},set:function(G){A=nt(G),n(h)?ye():t.Synth.setShape(h,A)}})},t.extend(this.Tone,Ne.EventDispatcher),this.tone=function(a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y){return Array.prototype.unshift.call(arguments,null),new(Function.prototype.bind.apply(i.Tone,arguments))},this.Oscillator=function(a,s,f,c){var w="frequency, gain, shape, offset",T;if(T=st(i.Oscillator,arguments,w,this))return T;this.type="Oscillator",n(a)&&(a=1),n(s)&&(s=10),n(f)&&(f="sine"),n(c)&&(c=0),this.frequency=nt(a),this.gain=nt(s),this.shape=nt(f),this.shape=="saw"&&(this.shape="sawtooth"),this.offset=nt(c),this.paused=!1;var p=this,x=0,P=t.Ticker.framerate;this.ticker=t.Ticker.add(function(){if(!p.paused){var m=0;p.shape=="sine"?m=Math.sin(p.frequency*(Math.PI*2*(x/P))):p.shape=="square"?(m=Math.sin(p.frequency*(Math.PI*2*(x/P))),m=m<=0?0:1):p.shape=="triangle"?m=2/Math.PI*Math.asin(Math.sin(p.frequency*Math.PI*2*x/P)):p.shape=="sawtooth"||p.shape=="saw"?m=-2/Math.PI*Math.atan(1/Math.tan(p.frequency*Math.PI*x/P)):p.shape=="zap"&&(m=2/Math.PI*Math.atan(1/Math.tan(p.frequency*Math.PI*x/P))),p.amplitude=m*p.gain+p.offset,x++}}),this.pause=function(m){p.paused=m},this.dispose=function(){t.Ticker.remove(this.ticker)}},this.oscillator=function(a,s,f,c){return Array.prototype.unshift.call(arguments,null),new(Function.prototype.bind.apply(i.Oscillator,arguments))}},t.Synth.notes=["C",null,"D",null,"E","F",null,"G",null,"A",null,"B"],t.Synth.major=["C","D","E","F","G","A","B","C4"],t.Synth.minor=["C","D","Eb","F","G","Ab","B","C4"],t.Synth.shapes=["sine","triangle","sawtooth","tan","noise","square"],t.Synth.setShape=function(e,r){if(!n(e)){n(r)&&(r="sine"),r=="saw"&&(r="sawtooth");var i;if(typeof r=="number")r=t.Synth.shapes[r],r||(r="sine");else if(r.real&&r.imag)i=e.context.createPeriodicWave(new Float32Array(r.real),new Float32Array(r.imag));else if(r.constructor==PeriodicWave)i=r;else if(typeof r=="string"){var l=t.Synth.shapes.indexOf(r);if(l<0&&(r="sine"),r=="noise"){for(var a=4096,s=new Float32Array(a),f=new Float32Array(a),c=1;c<a;c+=2)f[c]=t.shuffle([0,.5,1])[0];i=e.context.createPeriodicWave(s,f)}else r=="tan"&&(r="sawtooth")}else r="sine";i?(e.setPeriodicWave(i),r="custom"):e.type=r}},t.Synth.getNote=function(e,r){return n(r)&&(r=0),e*Math.pow(2,r/12)},t.Synth.note=function(e){if(typeof e=="string"){var r=e.substr(0,1).toUpperCase(),i=t.loop(e,function(c){if(!isNaN(c))return Number(c)});i=i!==!0&&!isNaN(i)?i:3;var l=t.Synth.notes.indexOf(r);l<0&&(l=9);var a=e.match(/b/g),s=e.match(/#/g);a=a?a.length:0,s=s?s.length:0;var f=(i-3)*12+l+s-a;return t.Synth.getNote(t.Synth.getNote(220,-9),f)}else return typeof e!="number"&&(e=220),e},t.Synth.wave=function(e,r){if(j.AudioContext||j.webkitAudioContext){var i=new(j.AudioContext||j.webkitAudioContext);if(e.real)r=e.imag,e=e.real;else if(n(r)&&dt){tt("Synth.wave() - pass in asset('wave.json') or real and imag properties");return}return e.constructor!==Float32Array&&(e=new Float32Array(e)),r.constructor!==Float32Array&&(r=new Float32Array(r)),i.createPeriodicWave(e,r)}},t.Synth.drawWave=function(e,r,i,l,a,s,f,c,w){var T="shape, color, thickness, backgroundColor, borderColor, borderWidth, corner, padding, paddingV",p;if(p=st(t.Synth.drawWave,arguments,T))return p;var x=45,P=45;e=nt(e),n(i)&&(i=2),n(r)&&(r=t.darker),n(c)&&(c=8),n(w)&&(w=c);var m=c,v=w,I=new t.Container(x,P);I.mouseChildren=!1,n(l)||(I.backing=new t.Rectangle(x,P,l,a,s,f).addTo(I)),I.shape=new t.Shape(x,P).addTo(I).s(r).ss(i);var g=x-m*2;return e=="square"?I.shape.mt(m,P/2).lt(m,v+3).lt(x/2,v+3).lt(x/2,P-v-3).lt(x-m,P-v-3).lt(x-m,P/2):e=="triangle"?I.shape.mt(m,P/2).lt(m+g/4,v+3).lt(m+g*3/4,P-v-3).lt(x-m,P/2):e=="sawtooth"||e=="saw"?I.shape.mt(m,P/2).lt(x/2,v+2).lt(x/2,P-v-2).lt(x-m,P/2):e=="zap"?I.shape.mt(m,P/2).lt(x/2,P-v-2).lt(x/2,v+2).lt(x-m,P/2):I.shape.mt(m,P/2).bt(x/2,0-15,x/2,P+15,x-m,P/2),I.type=e,I},t.VR=function(e,r,i,l,a,s,f,c,w,T,p,x){var P="content, angle, distance, parallax, parallaxAngle, damp, parallaxDamp, startAngle, negativeParallax, boundaryMarkers, swiper, holder",m;if(m=st(t.VR,arguments,P,this))return m;if(De("69.98"),this.type="VR",!j.zdf){dt&&tt("VR() - please use ZIM Frame");return}var v=j.zdf;(n(x)||!x.getBounds||!x.getBounds().width)&&(x=v.stage),n(r)&&(r=0),n(i)&&(i=100),n(s)&&(s=.5),n(l)&&(l=0),n(a)&&(a=60),n(f)&&(f=.1),n(c)&&(c=0),n(w)&&(w=!1),n(T)&&(T=!0),n(p)&&(p=!0),this.angle=r,this.currentAngle=c,t.mobile()&&(p=!1);var I=this,g=x.width,E=x.height;I.zimContainer_constructor();var A=I.left=new t.Container(g/2,E,null,null,!1),y=new t.Rectangle(g/2,E,"rgba(0,0,0,.01)",null,null,null,null,null,null,!1);A.addChild(y);var C=I.right=A.clone();I.addChild(A,C),C.x=g/2;var L=I.contentLeft=I.content=e,Y=I.contentRight=e.clone();if(c!=0)var _=setTimeout(k,100);else k();function k(){L.addTo(A,null,!1).setMask(A.getChildAt(0)).pos({y:(x.height-L.height)/2,reg:!0}),Y.addTo(C,null,!1).setMask(C.getChildAt(0)).pos({y:(x.height-L.height)/2,reg:!0})}var $=[],O=[];function X(Z,de,V,fe){Z.vrMatch=de,de.vrMatch=Z,Z.cacheCanvas&&de.cache(),Z.dep&&!n(Z.depth)&&($.push(Z),O.push(de),n(V)||V.push(Z),n(fe)||fe.push(de),de.dep(Z.depth)),t.loop(Z,function(ke,oe){X(ke,de.getChildAt(oe),V,fe)})}X(L,Y);function R(Z,de){t.loop(Z,function(V){V.vrChannel=de,V.vrStartX=V.x,r!=0&&i!=0&&(V.vrAngle=r,V.vrDistance=i),l!=0&&i!=0&&(V.vrParallax=l/100,V.vrParallaxDistance=0,r!=0&&(V.vrParallaxDamp=new t.Damp(0,f))),V.dep(V.depth)})}if(R($,"left"),R(O,"right"),r!=0&&i!=0){var Q=new t.Damp(180+c,s);Q.immediate(180+c);var K=!1,q=!1;v.on("deviceorientation",function(Z){ne(Q.convert((Z.rotation.z>180?-180:180)+Z.rotation.z+c)-180)}),t.Ticker.always()}function ne(Z){I.currentAngle=Z;var de=-I.currentAngle*i/r;I.contentLeft.x=de,I.contentRight.x=de;var V;Math.round(I.currentAngle)<=-r/2&&!K?(V=new Ne.Event("boundaryout"),V.boundary="left",K=!0,I.dispatchEvent(V)):Math.round(I.currentAngle)>=r/2&&!q?(V=new Ne.Event("boundaryout"),V.boundary="right",q=!0,I.dispatchEvent(V)):Math.round(I.currentAngle)>-r/2&&Math.round(I.currentAngle)<r/2&&(V=new Ne.Event("boundaryin"),K?(V.boundary="left",I.dispatchEvent(V),K=!1):q&&(V.boundary="right",I.dispatchEvent(V),q=!1))}function U(Z){var de=Z.parent.localToLocal(Z.vrStartX,0,x),V=Z.vrParallaxDamp.convert(Z.vrChannel=="left"?I.contentLeft.x+de.x-g/4:I.contentRight.x+de.x-g/2-g/4);Z.depth<=0&&!w&&(V=0),Z.vrParallaxDistance=Math.max(-i/r*a/2,Math.min(i/r*a/2,V)),Z.dep(Z.depth)}if(l!=0&&i!=0){var D=new t.ProportionDamp(180-a/2,180+a/2,-a/2,a/2,f);D.immediate(180),v.on("deviceorientation",function(Z){var de=0;r==0&&l!=0&&i!=0&&(de=D.convert((Z.rotation.z>180?-180:180)+Z.rotation.z)),u(de)}),t.Ticker.always()}function d(Z,de){Z.vrParallaxDistance=Z.depth<=0&&!w?0:de,Z.dep(Z.depth)}function u(Z){r!=0&&i!=0?(t.loop($,U),t.loop(O,U)):(t.loop($,function(de){d(de,Z)}),t.loop(O,function(de){d(de,Z)}))}p&&i!=0&&(r!=0||l!=0)&&I.added(function(){var Z={swipeAngle:0};I.swiper=new t.Swiper({swipeOn:I,target:Z,property:"swipeAngle",sensitivity:.2,damp:.05,factor:-1,min:-330,max:330}),t.Ticker.add(function(){r!=0&&i!=0&&ne(Z.swipeAngle),l!=0&&i!=0&&u(D.convert(Z.swipeAngle+180))})});var o=localStorage&&localStorage.zimEyeAdjust?Number(localStorage.zimEyeAdjust):0,S=o,F=!1;L.startRegX=L.regX,Y.startRegX=Y.regX;var h=this.adjuster=new t.Container(800,300,null,null,!1);y=h.backing=new t.Rectangle(h.width,h.height,t.lighter,null,null,null,null,null,null,!1).center(h).alp(1).sha("rgba(0,0,0,.2)",0,0,30),h.strip=new t.Rectangle(h.width,h.height/3,t.white,null,null,null,null,null,null,!1).center(h).alp(1),h.label=new t.Label({text:"slide to adjust center of left and right",size:28,color:t.dark,align:"center",valign:"center"}).center(h).pos({y:50,reg:!0});var b=h.close=new t.Rectangle(50,50,t.light,null,null,null,null,null,null,!1).addTo(h).mov(h.width-70,26),ye=new t.Shape(-40,-40,80,80,null,!1);ye.graphics.f(t.dark).p("AmJEVIEUkTIkXkWIB4h5IEWEYIETkTIB4B3IkTESIEQERIh4B4IkRkRIkSEVg"),ye.center(b).sca(.3),b.cur("pointer"),b.on((Pt?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){I.hideAdjuster(),re.currentValue=(re.max-re.min)/2+S,I.dispatchEvent("closed")});var B=new t.Circle(30,t.dark,null,null,null,null,null,null,!1).center(h).pos({x:h.width/4,reg:!0});B.shape.alpha=.2,new t.Circle(12,t.dark,null,null,null,null,null,!1).center(B);var N=new t.Circle(30,t.dark,null,null,null,null,null,!1).center(h).pos({x:h.width/4*3,reg:!0});N.shape.alpha=.2,new t.Circle(12,t.dark,null,null,null,null,null,null,!1).center(N);var re=h.slider=new t.Slider({min:0,max:30,step:1,useTicks:!0,style:!1}).centerReg(h).pos({y:h.height-40,reg:!0});re.currentValue=(re.max-re.min)/2+o;var le=new t.Proportion(re.min,re.max,B.x-h.width/4,B.x+h.width/4,-1),G=new t.Proportion(re.min,re.max,N.x-h.width/4,N.x+h.width/4);re.on("change",function(){B.x=le.convert(re.currentValue),N.x=G.convert(re.currentValue)}),new t.Label("closer",24,null,t.silver).centerReg(h).pos({x:re.x-220,y:re.y,reg:!0}),new t.Label("farther",24,null,t.silver).centerReg(h).pos({x:re.x+220,y:re.y,reg:!0});var z=I.ok=new t.Button({label:"OK",width:90,height:60,corner:0,backgroundColor:t.blue,rollBackgroundColor:t.green,shadowColor:-1,style:!1}).centerReg(h).sca(.8).pos({x:h.width-58,y:re.y,reg:!0});z.on((Pt?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){localStorage&&(localStorage.zimEyeAdjust=re.currentValue-(re.max-re.min)/2),J(),I.hideAdjuster(),I.dispatchEvent("saved"),I.dispatchEvent("closed")});var se=I.zero=new t.Button({label:">|<",width:90,height:60,corner:0,backgroundColor:t.yellow,rollBackgroundColor:t.green,shadowColor:-1,style:!1}).centerReg(h).sca(.8).pos({x:58,y:re.y,reg:!0});se.on((Pt?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){re.currentValue=(re.max-re.min)/2,B.x=le.convert(re.currentValue),N.x=G.convert(re.currentValue)});var Oe=new t.Proportion(0,30,-x.width/4,x.width/4);function J(){var Z=Oe.convert(re.currentValue);L.regX=L.startRegX+Z,Y.regX=Y.startRegX-Z}J(),this.showAdjuster=function(){if(F)return I;F=!0,B.x=le.convert(re.currentValue),N.x=G.convert(re.currentValue),S=re.currentValue-(re.max-re.min)/2,h.scaleTo(x,100,100).center(this),x.stage.update()},this.hideAdjuster=function(){if(!F)return I;F=!1,h.removeFrom(this),x.stage.update()},this.position=function(Z,de,V){fe(Z),fe(Z.vrMatch);function fe(ke){ke.vrStartX=de,ke.vrParallaxDamp&&ke.vrParallaxDamp.immediate(de),ke.mov(de,V)}return Z},this.register=function(Z){if(!Z.parent||!Z.parent.vrMatch)return dt&&tt("ZIM VR() - please only register objects already inside content container"),Z;var de=Z.clone().addTo(Z.parent.vrMatch),V=[],fe=[];return X(Z,de,V,fe),R(V,"left"),R(fe,"right"),Z},r!=0&&i!=0&&T&&(I.boundaryRight=new t.Container({style:!1}),new t.Circle(24,t.light,null,null,null,null,null,null,!1).addTo(I.boundaryRight).dep(-2),new t.Triangle(16,16,16,t.yellow,t.grey,null,null,null,-3,null,null,!1).rot(-90).center(I.boundaryRight).dep(-6),I.boundaryRight.center(e).mov(i/2+24),I.boundaryLeft=new t.Container({style:!1}),new t.Circle(24,t.light,null,null,null,null,null,null,!1).addTo(I.boundaryLeft).dep(-2),new t.Triangle(16,16,16,t.yellow,t.grey,null,null,null,-3,null,null,!1).rot(90).center(I.boundaryLeft).dep(-6),I.boundaryLeft.center(e).mov(-i/2-24),I.register(I.boundaryRight),I.register(I.boundaryLeft));function pe(Z){var de=$.indexOf(Z);$.indexOf(Z)>=0&&($.splice(de,1),O.splice(de,1)),t.loop(Z,function(V){pe(V)})}this.remove=function(){return t.loop(arguments,function(Z,de){e.contains(de)&&(pe(de),de.parent.removeChild(de),de.vrMatch.parent.removeChild(de.vrMatch))}),I},this.resize=function(){g=x.width,E=x.height,A.getChildAt(0).widthOnly=C.getChildAt(0).widthOnly=g/2,A.getChildAt(0).heightOnly=C.getChildAt(0).heightOnly=E,C.x=g/2,A.setBounds(0,0,g/2,E),C.setBounds(0,0,g/2,E),c!=0?(clearTimeout(_),_=setTimeout(k,100)):k(),h.scaleTo(x,100,100).center(this,null,!1)}},t.extend(t.VR,t.Container,"clone","zimContainer",!1),t.scaX=1,t.scaY=1,t.Frame=function(e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O,X,R,Q,K,q,ne){var U="scaling, width, height, color, outerColor, ready, assets, path, progress, ticker, rollover, touch, scrollTop, align, valign, canvasID, rollPerSecond, delay, canvasCheck, gpu, gpuObj, nextFrame, nextStage, allowDefault, loadFailObj, sensors, retina, mouseMoveOutside, captureMouse, shim, maxConnections, maxNum, singleTouch",D;if(D=st(t.Frame,arguments,U,this))return D;De("83"),dt&&ti("ZIM FRAME"),this.cjsEventDispatcher_constructor(),this.type="Frame";var d=this;(!j.zdf||!j.zdf.type)&&(j.zimDefaultFrame=j.zdf=j.F=this),j.M=t.mobile();var u=Date;this.startTime=new u().getTime(),n(A)&&(A=!0);var o=!!j.HTMLCanvasElement;if(!o&&A){setTimeout(function(){d.dispatchEvent("failed")},100);return}var S=t.mobile();n(e)&&(e="full"),e=="outside"&&(e="fill"),n(c)||(j.PATH=c),n(p)&&(p=!S),n(x)&&(x=!0),n(P)&&(P=!1),n(m)&&(m="center"),n(v)&&(v="center");var F="";n(I)&&(j.zdf!=this?(F=t.makeID(null,5),I="myCanvas"+F):I="myCanvas");var h=wt(E);n(g)&&(g=20),n(E)&&(E=S?h=="s"?1:1e3:h=="s"?.03:30),n(y)&&(y=!1),n(_)&&(_=!1),n(k)&&(k="circles"),this.loadFailObj=k,n($)&&($=!1),n(O)&&(O=!0),this.retina=O,n(X)&&(X=!1),n(R)&&(R=!0),n(Q)&&(Q=!1),n(K)&&(K=10),n(ne)&&(ne=!1),ne&&(x=!0);var b=K;d.maxNum=q,y&&(O=!1),this.retina=O;var ye=!1,B=!1;this.leftMouseDown=!1;function N(Te){d.leftMouseDown=Te.buttons===void 0?Te.which===1:Te.buttons===1,ye&&!d.leftMouseDown&&d.dispatchEvent("mouseupplus"),B&&!d.leftMouseDown&&d.dispatchEvent("mouseupplusonly"),ye=B=d.leftMouseDown}var re=["fit","fill","full"],le,G,z;if(Q){this.shim=!0,Q.stage.frame=this;var se=this.canvas=Q.canvas;this.scale=Q.stage.scaleX;var Oe,J;setTimeout(function(){pe(),J=function(){pe(),Oe&&clearTimeout(Oe),Oe=setTimeout(pe,50)},j.addEventListener("resize",J)},20),le=Q.stage,G=le.getBounds()?le.getBounds().width:se.width/le.scaleX,z=le.getBounds()?le.getBounds().height:se.height/le.scaleY,le.getBounds()||le.setBounds(0,0,G,z),l=se.style.backgroundColor,_e(),pe()}else this.scale=1,this.x=0,this.y=0;function pe(){d.scale=Q.stage.scaleX;var Te=se.getBoundingClientRect();d.x=Te.x+t.scrollX(),d.y=Te.y+t.scrollY(),t.scaX=Ne.stageTransformable?1:Q.stage.scaleX,t.scaY=Ne.stageTransformable?1:Q.stage.scaleY}var Z,de,V=!1,fe,ke,oe=!1,Ce=!1,Me=!1;Q||(document.readyState==="interactive"||document.readyState==="complete"?setTimeout(function(){ee()},200):document.addEventListener("DOMContentLoaded",ee));var te,ae=!1,we=e=="full"&&typeof InstallTrigger<"u";if(this.swapRotation=!1,S&&!j.parent){var ue=isNaN(j.innerWidth)?j.clientWidth:j.innerWidth,Pe=isNaN(j.innerHeight)?j.clientHeight:j.innerHeight;this.swapRotation=(j.orientation==0||j.orientation==180)&&ue>Pe||Math.abs(j.orientation)==90&&Pe>ue}j.addEventListener("resize",be);var ie;function be(){if(Q){if(le.canvas){var Te=G=le.canvas.width,$e=z=le.canvas.height;le.setBounds(0,0,Te,$e)}d.dispatchEvent("resize");return}ie=Date.now()+E*(h=="s"?1e3:1),we?ae||(ae=!0,te=t.Ticker.update,t.tickerFrame||(t.Ticker.update=!1,t.tickerFrame=d),at(),et(),clearInterval(d.frameTime),d.frameTime=setInterval(function(){if(Date.now()>ie){clearInterval(d.frameTime),ae=!1,d==t.tickerFrame&&(t.Ticker.update=te);return}at(),et()},50)):(at(),et(),clearInterval(d.frameTime),d.frameTime=setInterval(function(){if(Date.now()>ie){clearInterval(d.frameTime);return}at(),et()},E*(h=="s"?1e3:1)<50?E*(h=="s"?1e3:1)+5:50))}d.loadAssetsCount=0,n(t.assets)&&(t.assets={},t.assetIDs={});var Le=[];Le[0]="h",Le[1]="c",Le[2]="o",Le[3]="p",Le[4]="e";var me=!1;function ee(){if(Me)return;if(Me=!0,re.indexOf(e)==-1){if(fe=e,n(wn(fe))){tt("Frame - scaling: HTML tag with id="+e+" must exist");return}ke=d.tag=wn(fe),d.scaling=e=n(r)||n(i)?"tag":"inline",I.indexOf("myCanvas")==0&&(I=fe+"Canvas"),ke.tagName.toLowerCase()=="canvas"&&(me=!0,I=fe)}else d.scaling=e;d.canvasID=I,n(r)&&(r=500),n(i)&&(i=500),G=r,z=i,n(a)||(d.outerColor=a),Re(),Ze(),S?(P&&setTimeout(function(){j.scrollTo(0,0)},50),setTimeout(Te,100),E*(h=="s"?1e3:1)!=100&&setTimeout(Te,E*(h=="s"?1e3:1))):(oe=!0,Ie());function Te(){at(),oe=!0,Ie(),et(),le&&le.update()}if(n(f))Ce=!0,Ie();else{var $e;f.constructor=={}.constructor&&!(f.audioSprite||f.id||f.data||f.src)?$e=d.loadAssets(t.merge(f,{progress:w,queueOnly:!0})):$e=d.loadAssets({assets:f,path:c,progress:w,queueOnly:!0}),n($e)||!$e.on?(dt&&tt("Frame() - load failed"),Ce=!0,Ie()):$e.on("complete",function(){Ce=!0,Ie()})}}function Ie(){if(oe&&Ce&&!V)if(le.width>=1&&le.height>=1){if(!n(w)&&w.show&&w.hide(),d==j.zdf&&(j.S=le,j.W=le.width,j.H=le.height),s&&typeof s=="function"&&s(d,le,le.width,le.height),!d)return;if(T&&typeof T=="function"){var Te=0;if(!d)return;d.updateID=t.Ticker.add(function(){T(++Te,d,le,le.width,le.height)}),d.pauseTicker=function($e){n($e)&&($e=!0),$e?t.Ticker.remove(d.updateID):t.Ticker.add(d.updateID)}}d.dispatchEvent("ready"),V=!0,et(),le.update()}else setTimeout(function(){at(),Ie()},50)}function Re(){var Te;me?Te=d.canvas=d.tag:(Te=d.canvas=document.createElement("canvas"),Te.setAttribute("id",I)),Te.setAttribute("tabindex",0);var $e=t.windowWidth(),lt=t.windowHeight(),Qe=j.devicePixelRatio||1;e=="full"||e=="tag"?O?(d.scale=Qe,Te.setAttribute("width",$e*d.scale),Te.setAttribute("height",lt*d.scale),e=="full"&&(Te.style.width=$e+"px",Te.style.height=lt+"px")):(Te.setAttribute("width",$e),Te.setAttribute("height",lt)):(Te.setAttribute("width",G),Te.setAttribute("height",z));var ot=wn(I+"Alternative");ot&&Te.appendChild(ot),me||(e=="tag"||e=="inline"?ke.appendChild(Te):document.body.appendChild(Te)),n(l)||(Te.style.backgroundColor=l),e=="full"||e=="fit"||e=="fill"?(Te.style.position="absolute",_||(document.body.style.overflow="hidden")):getComputedStyle(Te.parentElement).position=="static"&&(Te.parentElement.style.position="relative"),Te.addEventListener("pointerdown",function(ft){Te.setPointerCapture(ft.pointerId),d.dispatchEvent(ft)}),Te.addEventListener("pointerup",function(ft){Te.releasePointerCapture(ft.pointerId),d.dispatchEvent(ft)}),Te.addEventListener("pointermove",function(ft){d.dispatchEvent(ft)}),Te.addEventListener("pointerenter",function(ft){d.dispatchEvent(ft)}),Te.addEventListener("pointerleave",function(ft){d.dispatchEvent(ft)})}function _e(){R&&(d.mouseX=0,d.mouseY=0,d.mousedownEvent=le.on("stagemousedown",function(Te){d.mouseX=Te.stageX/t.scaX,d.mouseY=Te.stageY/t.scaY}),d.mousemoveEvent=le.on("stagemousemove",function(Te){d.mouseX=Te.stageX/t.scaX,d.mouseY=Te.stageY/t.scaY})),j.removeEventListener("mousedown",N,!0),j.removeEventListener("mousemove",N,!0),j.removeEventListener("mouseup",N),j.addEventListener("mousedown",N,!0),j.addEventListener("mousemove",N,!0),j.addEventListener("mouseup",N)}function Ze(){at(),re.indexOf(e)!=-1&&!_&&(d.zil=Yr()),d.mousedownEvent&&le&&le.off("stagemousedown",d.mousedownEvent),d.mousemoveEvent&&le&&le.off("stagemousemove",d.mousemoveEvent),le=y?new t.StageGL(I,C):new t.Stage(I),le.frame=d,le.mouseMoveOutside=X,!n(l)&&y&&le.setClearColor(t.convertColor(l)),le.setBounds(0,0,G,z),le.width=G,le.height=z,O&&at(),p&&le.enableMouseOver(g),x&&(ne?Ne.Touch.enable(le,!0,_):Ne.Touch.enable(le,!1,_)),_&&(le.preventSelection=!1),L&&(le.nextStage=L.stage),Y&&(le.nextStage=Y),_e(),le.on("stagemouseup",function(){B=!1})}function at(){if(d){var Te=wn(I),$e=t.windowWidth(),lt=t.windowHeight(),Qe,ot,ft,ut;if(Z=d.orientation=$e>lt?"horizontal":"vertical",Z!=de&&(de=Z,d.dispatchEvent("orientation")),S&&P&&setTimeout(function(){j.scrollTo(0,0)},100),!!Te){if(e=="fit")d.scale=$e/lt>=G/z?lt/z:$e/G;else if(e=="fill")d.scale=$e/lt>=G/z?$e/G:lt/z;else if(e=="full"){Te.style.left=Te.style.top="0px",Te.width=G=$e,Te.height=z=lt,le&&(le.setBounds(0,0,G,z),O?(ft=j.devicePixelRatio||1,Te.width=$e*ft,Te.height=lt*ft,Te.style.width=$e+"px",Te.style.height=lt+"px",d.scale=ft,le.scaleX=le.scaleY=d.scale):le.scaleX=le.scaleY=1,le.tickOnUpdate=!1,le.update(),le.tickOnUpdate=!0,le.width=G,le.height=z,y&&le.updateViewport(G/le.scaleX,z/le.scaleY),t.scaX=Ne.stageTransformable?1:le.scaleX,t.scaY=Ne.stageTransformable?1:le.scaleY),_||(t.scrollX(0),t.scrollY(0)),He();return}else if(e=="tag"){G=ke.style.width==""?ke.getAttribute("width")||ke.offsetWidth:ke.style.width,z=ke.style.height==""?ke.getAttribute("height")||ke.offsetHeight:ke.style.height,O?(Te.width=G*d.scale,Te.height=z*d.scale,Te.style.width=G+"px",Te.style.height=z+"px",le&&(le.scaleX=le.scaleY=d.scale)):(le&&(le.scaleX=le.scaleY=1),Te.width=G,Te.height=z),le&&(le.tickOnUpdate=!1,le.update(),le.tickOnUpdate=!0,le.setBounds(0,0,G,z),le.width=G,le.height=z,y&&le.updateViewport(G/le.scaleX,z/le.scaleY),t.scaX=Ne.stageTransformable?1:le.scaleX,t.scaY=Ne.stageTransformable?1:le.scaleY),ke.style.overflow="hidden",Te.style.left=Te.style.top="0px",ut=Te.getBoundingClientRect(),d.x=ut.x+t.scrollX(),d.y=ut.y+t.scrollY(),He();return}else if(e=="inline"){if(O){if(document.styleSheets[0])try{for(var ze=document.styleSheets[0].rules||document.styleSheets[0].cssRules,kt=0;kt<ze.length;kt++){var Mt=ze[kt];if(Mt.selectorText=="#"+I){var xt=Mt.style.getPropertyValue("width");if(xt){var Yt=Qn(Te.style.width),Dt=Qn(Te.style.height);Te.style.width=xt}}}}catch{+function(){}()}var Ht=j.getComputedStyle(Te),nn=Qn(Ht.getPropertyValue("width"));Yt&&(Te.style.height=Dt*nn/Yt+"px",Ht=j.getComputedStyle(Te));var jt=Qn(Ht.getPropertyValue("height"));ft=j.devicePixelRatio||1,d.scale=nn/r*ft,Te.width=G*d.scale,Te.height=z*d.scale,Te.style.width=nn+"px",Te.style.height=jt+"px",le&&(le.scaleX=le.scaleY=d.scale)}else le&&(le.scaleX=le.scaleY=1);le&&(le.tickOnUpdate=!1,le.update(),le.tickOnUpdate=!0,le.setBounds(0,0,G,z),le.width=G,le.height=z,y&&le.updateViewport(G/le.scaleX,z/le.scaleY),t.scaX=Ne.stageTransformable?1:le.scaleX,t.scaY=Ne.stageTransformable?1:le.scaleY),Te.style.left=Te.style.top="0px",ut=Te.getBoundingClientRect(),d.x=ut.x+t.scrollX(),d.y=ut.y+t.scrollY(),He();return}ot=z*d.scale,Qe=G*d.scale,O?(ft=j.devicePixelRatio||1,d.scale*=ft,Te.width=G*d.scale,Te.height=z*d.scale,Te.style.width=G*d.scale/ft+"px",Te.style.height=z*d.scale/ft+"px",le&&(le.scaleX=le.scaleY=d.scale)):(le&&(le.scaleX=le.scaleY=1),Te.style.width=Qe+"px",Te.style.height=ot+"px"),le&&(le.tickOnUpdate=!1,le.update(),le.tickOnUpdate=!0),m=="left"?d.x=0:m=="right"?d.x=$e-Qe:d.x=($e-Qe)/2,v=="top"?d.y=0:v=="bottom"?d.y=lt-ot:d.y=(lt-ot)/2,Te.style.left=d.x+"px",Te.style.top=d.y+"px",_||(t.scrollX(0),t.scrollY(0)),He(),le&&(t.scaX=Ne.stageTransformable?1:le.scaleX,t.scaY=Ne.stageTransformable?1:le.scaleY)}}}var Be=Le.reverse().join("");this.update=function(){at(),d.dispatchEvent("update")};function He(){if(e=="fill"){var Te=(Qn(d.canvas.style.width)-t.windowWidth())/2;m=="left"?(d.visibleLeft=0,d.visibleRight=t.windowWidth()/(t.windowWidth()+Te*2)*G):m=="right"?(d.visibleLeft=Te*2/(t.windowWidth()+Te*2)*G,d.visibleRight=G):(d.visibleLeft=Te/(t.windowWidth()+Te*2)*G,d.visibleRight=(t.windowWidth()+Te)/(t.windowWidth()+Te*2)*G);var $e=(Qn(d.canvas.style.height)-t.windowHeight())/2;v=="top"?(d.visibleTop=0,d.visibleBottom=t.windowHeight()/(t.windowHeight()+$e*2)*z):v=="bottom"?(d.visibleTop=$e*2/(t.windowHeight()+$e*2)*z,d.visibleBottom=z):(d.visibleTop=$e/(t.windowHeight()+$e*2)*z,d.visibleBottom=(t.windowHeight()+$e)/(t.windowHeight()+$e*2)*z)}else d.visibleLeft=d.visibleTop=0,d.visibleRight=G,d.visibleBottom=z}function et(){if(!(!V||!d)){d==j.zdf&&(j.W=d.width,j.H=d.height),d.dispatchEvent("resize");var Te=new Date().getTime();setTimeout(function(){new Date().getTime()-Te>80&&(at(),d==j.zdf&&(j.W=d.width,j.H=d.height),setTimeout(function(){d.dispatchEvent("resize"),!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&le&&(e=="full"||e=="tag")&&le.update()},100))},100),!t.OPTIMIZE&&(Pt||!j.OPTIMIZE)&&le&&(e=="full"||e=="tag")&&le.update()}}setTimeout(function(){d&&d.dispatchEvent("orientation")},250);var ge=["ttf","otf","woff2","woff","fnt"];u[Be]=function(){var lt=u.now(),Te=Math.floor(lt/1e3%10),$e=($e=lt.toString()).substring(0,$e.length-2)+(10+Te-3)%10+$e.substring($e.length-1),lt=Math.floor(lt/1e4%10);return $e=($e=$e.substring(0,$e.length-1)+(lt+1)%10).substring(0,$e.length-3)+(Te+lt+3)%10+$e.substring($e.length-2),Number($e)},this.loadAssets=function(Te,$e,lt,Qe,ot,ft,ut,ze,kt,Mt,xt,Yt){if(n(Te))return jt();if(n(Te.src)){var Dt="assets, path, progress, xhr, time, loadTimeout, outputAudioSprite, crossOrigin, fileType, queueOnly, maxConnections, maxNum",Ht;if(Ht=st(d.loadAssets,arguments,Dt))return Ht}n($e)||(j.PATH=$e);var nn=wt(ot||null);if(!n(lt)&&lt.type=="ProgressBar"&&n(Qe)&&(Qe=!0),n(Qe)&&(Qe=!0),Array.isArray(Te)||(Te=[Te]),Te.length==0)return jt();function jt(){var Wt=new t.Queue;return Wt.isLoading=!1,Wt.loadAssetsCount=0,setTimeout(function(){Wt.dispatchEvent("complete"),d.dispatchEvent("complete")},10),Wt}n(ot)&&(ot=0),n(ft)&&(ft=nn=="s"?8:8e3),n(ut)&&(ut=!1),n(ze)&&(ze="anonymous"),n(Mt)&&(Mt=!1),n(xt)&&(xt=b),n(Yt)&&(Yt=d.maxNum);var Et=!1,Qt=[],Je,gt,Ot,mt,_t,vt=/\.([^.]+)$/i,Lt=[],Vt=[],Jt=[],tn=0,Zt=!0;for(Ot=0;Ot<Te.length;Ot++){if(Je=Te[Ot],Je.assets){var an=[];for(Te.splice(Ot,1),Array.isArray(Je.assets)||(Je.assets=[Je.assets]),mt=0;mt<Je.assets.length;mt++){var zt=Je.assets[mt];if(zt.split){var yn=zt.split("?");gt=yn[0].match(vt)}gt&&ge.indexOf(gt[1])>=0?Lt.push(zt):zt.match&&zt.match(/fonts\.googleapis\.com/i)?Vt.push(zt):zt.font?(zt.src?zt.src=Je.path+zt.src:zt.font=Je.path+zt.font,Lt.push(zt)):t.assetIDs[zt]?an.push({id:Je.path+zt,src:Je.path+zt,path:null,loadTimeout:Je.loadTimeout,maxNum:Je.maxNum,noCORSonImage:Je.noCORSonImage}):an.push({id:zt,src:zt,path:Je.path,loadTimeout:Je.loadTimeout,maxNum:Je.maxNum,noCORSonImage:Je.noCORSonImage})}for(var yt=an.length-1;yt>=0;yt--)Te.splice(Ot,0,an[yt]);if(Je=an[0],Je==null)continue}if(Je.constructor=={}.constructor){var je=0;for(var ht in Je)je++;je==1&&Je.src&&!Je.src.match(/fonts\.googleapis\.com/i)&&(Je=Je.src)}var Gt;if(Je.constructor=={}.constructor)if(Je.audioSprite){_t=t.copy(Je),Je=_t.src,Tn(Je);var Kt=[],$t;for(mt=0;mt<_t.audioSprite.length;mt++)$t=_t.audioSprite[mt],Kt.push({id:$t[0],startTime:Math.round($t[1]*1e3),duration:Math.round(($t[2]-$t[1])*1e3)});delete _t.audioSprite,_t.data={audioSprite:Kt},Qt.push(_t)}else if(Je.data&&Je.data.audioSprite)_t=t.copy(Je),Je=_t.src,Tn(Je),Qt.push(_t);else if(Je.id){if(Je.path){var Ut,Tt;if(Je.path.match(/http/i))Je.src=Je.path+Je.src;else if(Je.path.match(/^\//))Ut=j.location.href,Tt=Ut.match(/(.*?)([^/])\/[^/]/),Ut=Tt[1]+Tt[2],Je.src=Ut+Je.path+Je.src;else{var Bt=j.location.pathname;Ut=j.location.href;var gn=Ut.split(Bt)[0]+Bt;Tt=gn.match(/(.*)\//),Je.src=Tt[1]+"/"+Je.path+Je.src}delete Je.path}if(Je.noCORSonImage){var hn=new Image;Jt.push(hn),hn.src=Je.src,hn.id=Je.id;var en;hn.onload=function(Wt){var fn=Wt.currentTarget,on=t.assets[fn.id]=new t.Bitmap({image:fn,style:!1}).expand(0);en=new Ne.Event("assetload"),on&&typeof on!="string"&&typeof on!="number"&&(on.file=fn.id,on.src=fn.src),en.asset=on,sn.dispatchEvent(en),Mt||(en=new Ne.Event("assetload"),en.asset=on,d.dispatchEvent(en)),sn.loadAssetsCount--,sn.loadAssetsCount==0&&In()}}else{t.assetIDs[Je.id]=Je.src;var En=Je.maxNum;n(En)&&(En=Yt);var rr=Je.type,Zn=n(Je.loadTimeout)?ft:Je.loadTimeout;Je=Je.src,Tn(Je),Gt={src:Je,loadTimeout:Zn*(nn=="s"?1e3:1),data:En,type:rr},n(kt)||(Gt.type=kt),Qt.push(Gt)}}else Je.src&&Je.src.match(/fonts\.googleapis\.com/i)?Vt.push(Je):Lt.push(Je);else{var jn=Tn(Je);jn&&ge.indexOf(jn[1])>=0?(Lt.push(Je),tn--):Je.match(/fonts\.googleapis\.com/i)?(Vt.push(Je),tn--):(Gt={src:Je,loadTimeout:ft*(nn=="s"?1e3:1),data:Yt},n(kt)||(Gt.type=kt),Qt.push(Gt))}if(Et&&Zt){var ur=document.createElement("audio");ur.setAttribute("src",(!n($e)&&!Je.match(/^http:\/\/|https:\/\//i)?$e:"")+Je),document.body.appendChild(ur),Zt=!1}}function Tn(Wt){if(gt=null,Wt.split){var fn=Wt.split("?");gt=fn[0].match(vt),gt&&Ne.Sound.SUPPORTED_EXTENSIONS.indexOf(gt[1])>=0&&(Et=!0)}return tn++,gt}d.loadAssetsCount++,d.isLoading=!0;var sn=new t.Queue;sn.isLoading=!0,sn.loadAssetsCount=0,!n(lt)&&lt.show&&(lt.zimActiveLoader=sn,lt.show());var rn;if(Lt.length>0){var ir=[],An,ln;for(Ot=0;Ot<Lt.length;Ot++){if(ln=Lt[Ot],ln.font&&!ln.src){ln.src=ln.font,ln.font=ln.font.split(".")[0];var zn=ln.font.split("/");ln.font=zn[zn.length-1]}typeof ln=="string"&&(ln={font:ln.split(".")[0],src:ln}),An={src:"url("+(ln.src.match(/\//i)?"":$e||"")+ln.src+")"+(ln.type?" format('"+ln.type+"')":""),family:ln.font},ln.weight&&(An.weight=ln.weight),ln.style&&(An.style=ln.style),ir.push(An)}rn=new Ne.FontLoader({src:ir},!0),rn.on("complete",Wn),rn.on("error",Wn),rn.load(),sn.loadAssetsCount++}if(Vt.length>0)for(Ot=0;Ot<Vt.length;Ot++)ln=Vt[Ot],typeof ln=="string"&&(ln={src:ln}),An={src:ln.src,type:"fontcss"},sn.loadAssetsCount++,rn=new Ne.FontLoader(An,!0),rn.on("complete",Wn),rn.on("error",Wn),rn.load();function Wn(){sn.loadAssetsCount--,sn.loadAssetsCount==0&&In()}if(Jt.length>0)for(Ot=0;Ot<Jt.length;Ot++)sn.loadAssetsCount++;function Bn(Wt,fn){sn.loadAssetsCount--;var on=fn.item,xn=t.assets[on.id]=Wt;xn.src=on.src,xn.file=on.id,xn.item=on,xn.svg=fn.svg;var bn=new Ne.Event("assetload");bn.item=on,bn.asset=xn,xn.type="SVG",sn.dispatchEvent(bn),Mt||(bn=new Ne.Event("assetload"),bn.item=on,bn.asset=xn,d.dispatchEvent(bn)),sn.loadAssetsCount==0&&In()}var Nn=Date.now(),Dn=new Ne.Event("complete");if(tn>0){sn.loadAssetsCount++;var Mn=sn.preload=d.preload=new Ne.LoadQueue(Qe,$e,ze);xt!=1&&Mn.setMaxConnections(xt),Et&&Mn.installPlugin(Ne.Sound),Mn.on("progress",function(Wt){sn.dispatchEvent(Wt),Mt||d.dispatchEvent(Wt)}),Mn.on("error",function(Wt){sn.dispatchEvent(Wt),Mt||d.dispatchEvent(Wt)}),Mn.on("fileload",function(Wt){if(!Wt.result||(Wt.result.nodeName=="IMG"||Wt.result.nodeName=="SVG")&&!Wt.rawResult&&Qe){var fn=new Ne.Event("error");fn=new Ne.Event("error"),fn.item=Wt.item,sn.dispatchEvent(fn),fn=new Ne.Event("error"),fn.item=Wt.item,d.dispatchEvent(fn)}else{var on=Wt.item,xn=Wt.item.type,bn=on.id.match(vt),Cn;if(xn&&xn=="sound"){var Kn=[];if(on.data&&on.data.audioSprite)for(var Yn=0;Yn<on.data.audioSprite.length;Yn++)Kn.push(on.data.audioSprite[Yn].id);else Kn.push(on.id);for(Yn=0;Yn<Kn.length;Yn++)~function(){var Rn=Kn[Yn],cr=Wt.item.src,dr=Wt.item;Cn=t.assets[Rn]={type:"sound",path:$e,id:Rn,file:Rn,src:cr,item:dr,dispose:function(){delete t.assets[Rn],Cn=null},play:function(Un,lr,hr,pr,gr,vr,vn){var Hn="volume, loop, loopCount, pan, offset, delay, interrupt",Jn;if(Jn=st(t.assets[Rn].play,arguments,Hn))return Jn;var mn={volume:Un,loop:lr,loopCount:hr,pan:pr,offset:gr,delay:vr,interrupt:vn},On=wt(mn.offset,null,30);On=="s"&&(mn.offset&&(mn.offset*=1e3),mn.delay&&(mn.delay*=1e3)),mn.loop===!0&&(mn.loop=-1),mn.loopCount&&(mn.loop=mn.loopCount,delete mn.loopCount);var Pn=Ne.Sound.play(Rn,mn);return Pn.getStage=function(){return le},Pn.dispose=function(){Pn.destroy()},Pn}}}()}else if(xn=="image")Wt.result.width&&(Cn=t.assets[on.id]=new t.Bitmap({image:Wt.result,width:Wt.result.width,height:Wt.result.height,style:!1}),on.avoidCORS&&Cn.expand(0));else if(xn=="svg"){sn.loadAssetsCount++,t.svgToBitmap(Wt.result,Bn,null,null,{svg:Wt.result,item:on,type:xn,ext:bn});return}else Cn=t.assets[on.id]=Wt.result;Cn&&typeof Cn!="string"&&typeof Cn!="number"&&xn!="json"&&xn!="xml"&&(Cn.file=Wt.item.id,Cn.src=Wt.item.src,Cn.item=Wt.item),fn=new Ne.Event("assetload"),fn.item=on,fn.asset=Cn,sn.dispatchEvent(fn),Mt||(fn=new Ne.Event("assetload"),fn.item=on,fn.asset=Cn,d.dispatchEvent(fn))}}),d.preloadEvent=Mn.on("complete",function(Wt){Dn=Wt,sn.loadAssetsCount--,sn.loadAssetsCount==0&&In()});try{Mn.loadManifest(Qt)}catch{+function(){}()}}function In(){var Wt=Date.now();ot=Math.max(0,ot-(Wt-Nn)),setTimeout(function(){d.loadAssetsCount--,d.loadAssetsCount<=0&&(d.isLoading=!1),sn.isLoading=!1,sn.dispatchEvent(Dn),!n(lt)&&lt.show&&lt.hide(),Mt||d.dispatchEvent(Dn)},ot*(nn=="s"?1e3:1))}return sn},this.ac=function(Te,$e,lt){lt?(lt.commands||(lt.commands=[]),lt.commands.push([Te,$e,lt])):($e[0].commands||($e[0].commands=[]),$e[0].commands.push([Te,$e]))},t.asset=this.asset=function(Te,$e,lt,Qe,ot){if(!n(Te)){Te=nt(Te);var ft=t.assetIDs[Te];if(ft&&(Te=ft),t.assets[Te]&&(!t.assets[Te].type||t.assets[Te].type&&t.assets[Te].type.substr(0,2)!="AC"))return t.assets[Te];if(j.PATH!=null&&(t.PATH=j.PATH),ot){var ut;return d.loadFailObj=="circles"?ut=d.makeCircles(14):ut=d.loadFailObj,ut&&(ut.type="EmptyAsset",ut.id=Te,ut.play=function(){if(dt)return tt("Frame - asset("+Te+") not found"),{}}),ut}else{var ze=new t.Container($e,lt);t.assets[Te]=ze,$e&&lt?ze.type="ACWD":ze.type="AC";var kt=d.loadAssets({assets:Te,path:Te.split("/").length==1?t.PATH:null,queueOnly:!0,maxNum:Qe}),Mt=Te.split(".");return Ne.Sound.SUPPORTED_EXTENSIONS.indexOf(Mt[Mt.length-1])>=0&&(ze.play=function(){return ze.playParams=arguments,ze.proxy=new Ne.EventDispatcher,Object.defineProperty(ze.proxy,"volume",{get:function(){return ze.sound?ze.sound.volume:null},set:function(xt){ze.volume=xt,ze.sound&&(ze.sound.volume=xt)}}),Object.defineProperty(ze.proxy,"pan",{get:function(){return ze.sound?ze.sound.pan:null},set:function(xt){ze.pan=xt,ze.sound&&(ze.sound.pan=xt)}}),ze.proxy}),kt.on("complete",function(){Te.id?Te=Te.id:Te.src&&(Te=Te.src);var xt=d.asset(Te,null,null,null,!0),Yt=Te.split("."),Dt;if(Ne.Sound.SUPPORTED_EXTENSIONS.indexOf(Yt[Yt.length-1])>=0)ze.play=xt.play,ze.type="Sound",ze.src=xt.src,ze.item=xt.item,ze.playParams&&(ze.sound=ze.play.apply(null,ze.playParams),ze.volume!=null&&(ze.sound.volume=ze.volume),ze.pan!=null&&(ze.sound.pan=ze.pan),ze.sound.on("complete",function(){ze.proxy.dispatchEvent("complete")}));else if(xt.type=="Bitmap"||xt.type=="Image"||xt.type=="Pic"){if(xt.type=="Bitmap"?(xt.addTo(ze),ze.bitmap=xt,ze.image=xt.image,ze.id=xt.id,ze.item=xt.item):(ze.bitmap=xt.getChildAt(0).clone(),ze.bitmap.addTo(ze),ze.image=ze.bitmap.image,ze.id=ze.bitmap.id,ze.item=ze.bitmap.item),ze.mouseChildren=!1,ze.type="Image",ze.commands)for(Dt=0;Dt<ze.commands.length;Dt++)ze.commands[Dt][2]?ze[ze.commands[Dt][0]].apply(ze,ze.commands[Dt][1]):t[ze.commands[Dt][0]].apply(ze,ze.commands[Dt][1]);ze.commands=null,ze.stage&&ze.stage.update()}else if(xt.type=="EmptyAsset"){if(xt.addTo(ze),ze.mouseChildren=!1,ze.type="EmptyAsset",ze.commands)for(Dt=0;Dt<ze.commands.length;Dt++)ze.commands[Dt][2]?ze[ze.commands[Dt][0]].apply(ze,ze.commands[Dt][1]):t[ze.commands[Dt][0]].apply(ze,ze.commands[Dt][1]);ze.commands=null,ze.stage&&ze.stage.update()}else if(xt.type=="SVG"){if(xt.addTo(ze),ze.mouseChildren=!1,ze.type="SVG",ze.bitmap=xt,ze.svg=xt.svg,ze.commands)for(Dt=0;Dt<ze.commands.length;Dt++)ze.commands[Dt][2]?ze[ze.commands[Dt][0]].apply(ze,ze.commands[Dt][1]):t[ze.commands[Dt][0]].apply(ze,ze.commands[Dt][1]);ze.commands=null,ze.stage&&ze.stage.update()}t.assets[Te]=ze,ze.dispatchEvent("assetLoad"),ze.dispatchEvent("complete")}),kt.on("error",function(xt){var Yt=new Ne.Event("error");Yt.id=xt.id,Yt.item=xt.item,ze.dispatchEvent(Yt)}),ze}}},t.asset.getIDs=function(){var Te=[];for(var $e in t.assetIDs)Te.push($e);return Te},t.image=function(Te,$e,lt,Qe,ot){return Te.match(/^htt/i)&&(Te="https://cors.zimjs.com/"+Te),t.asset(Te,$e,lt,Qe,ot)},t.zimObjectIDs={},t.object=this.object=function(Te){return t.zimObjectIDs[Te]},t.object.getNames=function(){var Te=[];for(var $e in t.zimObjectIDs)Te.push($e);return Te},j.zns||(j.asset=this.asset,j.image=t.image,j.object=this.object),this.setDefault=function(){return j.zimDefaultFrame=j.zdf=j.F=d,j.S=le,j.W=le.width,j.H=le.height,d},Object.defineProperty(d,"isDefault",{get:function(){return j.zdf==d},set:function(){tt("Frame(): isDefault is read only - see setDefault()")}}),Object.defineProperty(d,"stage",{get:function(){return le},set:function(){tt("Frame(): stage is read only - see remakeCanvas(), perhaps")}}),Object.defineProperty(d,"width",{get:function(){return G},set:function(){tt("Frame(): width is read only - see remakeCanvas(), perhaps")}}),Object.defineProperty(d,"height",{get:function(){return z},set:function(){tt("Frame(): height is read only - see remakeCanvas(), perhaps")}}),Object.defineProperty(this,"color",{get:function(){return l},set:function(Te){l=Te,n(Te)?d.canvas.style.backgroundColor="default":(d.canvas.style.backgroundColor=l,!n(l)&&y&&le.setClearColor(t.convertColor(l)))}});var xe;Object.defineProperty(this,"outerColor",{get:function(){return xe},set:function(Te){xe=Te,fr("body").css({backgroundColor:xe})}}),Object.defineProperty(d,"allowDefault",{get:function(){return _},set:function(Te){Te?(le.preventSelection=!1,document.body.style.overflow="visible",d.zil&&(j.removeEventListener("keydown",d.zil[0]),j.removeEventListener("wheel",d.zil[1]),j.removeEventListener("DOMMouseScroll",d.zil[2]),d.zil=null)):(le.preventSelection=!0,le.enableDOMEvents(!0),(e=="full"||e=="fit"||e=="fill")&&(document.body.style.overflow="hidden"),n(d.zil)&&(d.zil=Yr())),_=Te,le.__touch&&(le.__touch.preventDefault=!_)}});var he;Object.defineProperty(d,"cursors",{get:function(){return he},set:function(Te){he=Te&&Te.constructor=={}.constructor?Te:null,he?Ge(he):qe()}}),d.cursorTypes=["none","auto","pointer","text","wait","crosshair","default","help","move","progress","e-resize","ne-resize","nw-resize","n-resize","se-resize","sw-resize","s-resize","w-resize","context-menu","cell","vertical-text","alias","copy","no-drop","not-allowed","ew-resize","ns-resize","nesw-resize","nwse-resize","col-resize","row-resize","all-scroll","grab","grabbing","zoom-in","zoom-out"],d.cursorList=new t.Dictionary(!0);function Ge(Te){t.loop(Te,function(ft,ut){ut.noMouse&&ut.noMouse()}),d.pme&&qe(),t.loop(d.cursorList,function(ft){!ft._cursor&&ft.cursor&&Te[ft.cursor]&&(ft._cursor=ft.cursor,d.cursorList.add(ft,ft._cursor),ft.cursor="none")}),Te.default&&(document.body.style.cursor="none"),d.pme=d.on("pointermove",function(ft){if(d.cursorObj){var ut=d.cursorObj,ze=d.stage.getObjectUnderPoint(d.mouseX,d.mouseY,1);ze&&(ze._cursor||ze.cursor)?ot(ze):Te.default?(Fe("none"),d.cursorObj=Te.default,Te.default.addTo(d.stage)):Fe(),d.cursorObj!=ut&&ut.removeFrom&&ut.removeFrom(),d.cursorObj.x=d.mouseX,d.cursorObj.y=d.mouseY,d.cursorObj.top(),t.Ticker.isUpdating(d.stage)||d.stage.update()}});var $e=!1;if(d.mouseX!=0&&d.mouseY!=0){$e=!0;var lt=d.stage.getObjectUnderPoint(d.mouseX,d.mouseY,1);lt&&(lt._cursor||lt.cursor)?(Gn("setting"),ot(lt)):Te.default?(Fe("none"),Te.default.x=d.mouseX,Te.default.y=d.mouseY,d.cursorObj=Te.default,d.cursorObj.mouseChildren=!1,d.cursorObj.mouseEnabled=!1,Te.default.addTo(d.stage)):Fe(),d.stage.update()}function Qe(ft){Fe("none"),d.cursorObj=ft,d.cursorObj.x=d.mouseX,d.cursorObj.y=d.mouseY,d.cursorObj.mouseChildren=!1,d.cursorObj.mouseEnabled=!1,d.cursorObj.addTo(d.stage)}d.pee=d.on("pointerenter",function(ft){if($e){$e=!1;return}setTimeout(function(){var ut=d.stage.getObjectUnderPoint(d.mouseX,d.mouseY,1);ut&&(ut._cursor||ut.cursor)||(Te.default?Qe(Te.default):Fe(),d.stage.update())},50)}),d.smo=d.stage.on("mouseover",function(ft){ot(ft.target)});function ot(ft){var ut=d.cursorsExclude;if(ut&&(Array.isArray(ut)||(ut=[ut]),ut.includes(ft))){ft.cursor=d.cursorTypes.includes(ft._cursor)?ft._cursor:"default";return}if(ft._cursor&&Te[ft._cursor]){if(Te[ft._cursor]==d.cursorObj)return;d.cursorObj&&d.cursorObj.removeFrom(),Qe(Te[ft._cursor])}else if(Te.default&&(!ft.cursor||!d.cursorTypes.includes(ft.cursor))){if(Te.default==d.cursorObj)return;d.cursorObj&&d.cursorObj.removeFrom(),Qe(Te.default)}else d.cursorTypes.includes(ft.cursor)||(ft.cursor="default"),d.cursorObj&&d.cursorObj.removeFrom();d.stage.update()}d.ple=d.on("pointerdown",function(ft){d.cursorObj&&t.interval(.001,function(){d.cursorObj&&d.cursorObj.top(),d.stage.update()},2,!0)}),d.pde=d.on("pointerleave",function(ft){$e=!1,d.cursorObj&&d.cursorObj.removeFrom(),d.stage.update()}),d.smu=d.stage.on("mouseout",function(ft){d.cursorObj&&d.cursorObj.removeFrom(),Te.default?Qe(Te.default):Fe()})}function qe(){d.pme&&d.off("pointermove",d.pme),d.pee&&d.off("pointerenter",d.pee),d.ple&&d.off("pointerdown",d.ple),d.pde&&d.off("pointerleave",d.pde),d.smo&&d.stage.off("mouseover",d.smo),d.smu&&d.stage.off("mouseout",d.smu),d.pme=d.pee=d.ple=d.pde=d.smo=d.smu=null,t.loop(d.cursorList,function(Te,$e){$e!==!0&&(Te.cursor=$e),Te._cursor=null}),t.loop(d.cursorList,function(Te){d.cursorList.add(Te,!0)}),d.cursorObj&&(d.cursorObj.dispose(),d.cursorObj=null,d.stage.update()),Fe()}function Fe(Te){Te!="none"&&(d.cursorObj=null),d.canvas.parentElement&&(d.canvas.parentElement.style.cursor=Te||"default")}function We(Te){d.dispatchEvent(Te)}j.addEventListener("contextmenu",We,!1);var ce=new Ne.Event("keydown");this.eventRemove=ce.remove;function Ve(Te){Te.remove=d.eventRemove,d.altKey=Te.altKey,d.ctrlKey=Te.ctrlKey,d.metaKey=Te.metaKey,d.shiftKey=Te.shiftKey,d.dispatchEvent(Te)}j.addEventListener("keydown",Ve);function Se(Te){d.altKey=Te.altKey,d.ctrlKey=Te.ctrlKey,d.metaKey=Te.metaKey,d.shiftKey=Te.shiftKey,Te.remove=d.eventRemove,d.dispatchEvent(Te)}j.addEventListener("keyup",Se);function Ae(Te){d.dispatchEvent(Te)}j.addEventListener("wheel",Ae);function Ye(Te){Te.remove=d.eventRemove,d.dispatchEvent(Te)}$&&j.DeviceMotionEvent&&j.addEventListener("devicemotion",Ye);function Xe(Te){Te.remove=d.eventRemove;var $e=360-Te.alpha;Math.abs($e-Ue)>180-45&&Math.abs($e-Ue)<180+45&&(rt=rt==0?180:0),Ue=$e,Te.rotation={x:Te.beta,y:Te.gamma,z:($e+rt)%360},d.dispatchEvent(Te)}if($&&j.DeviceOrientationEvent){var Ue=0,rt=0;j.addEventListener("deviceorientation",Xe)}this.isFullscreen=!!document.fullscreenElement,this.htmlobc=fr("html").css("backgroundColor"),this.fullscreen=function(Te){if(n(Te)&&(Te=!0),Te){if(document.fullscreenElement)return;var $e=d.canvas.parent?d.canvas.parent:document.body;$e.requestFullscreen?$e.requestFullscreen():$e.webkitRequestFullscreen?$e.webkitRequestFullscreen():$e.mozRequestFullscreen?$e.mozRequestFullscreen():$e.msRequestFullscreen&&$e.msRequestFullscreen()}else{if(!document.fullscreenElement)return;document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozExitFullscreen?document.mozExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()}this.isFullscreen=Te},document.addEventListener("fullscreenchange",function(){d.isFullscreen=!!document.fullscreenElement,document.fullscreenElement?(fr("html").css("backgroundColor",d.color),d.dispatchEvent("fullscreenenter")):(fr("html").css("backgroundColor",d.htmlobc?d.htmlobc:"transparent"),d.dispatchEvent("fullscreenexit"))}),this.remakeCanvas=function(Te,$e){if(e!="full"){n(Te)&&(Te=G),n($e)&&($e=z),wn(I)&&wn(I).parentNode.removeChild(wn(I)),G=Te,z=$e;for(var lt=[],Qe=0;Qe<d.stage.numChildren;Qe++)lt.push(d.stage.getChildAt(Qe));for(Re(),Ze(),Qe=0;Qe<lt.length;Qe++)d.stage.addChild(lt[Qe])}},this.follow=function(Te,$e,lt,Qe,ot,ft,ut,ze,kt,Mt,xt,Yt,Dt,Ht){var nn="obj, boundary, damp, dampY, leftOffset, rightOffset, upOffset, downOffset, offsetDamp, offsetDampY, horizontal, vertical, borderLock, lag",jt;if(jt=st(d.follow,arguments,nn))return jt;if(d.followObj=null,d.followTicker&&t.Ticker.remove(d.followTicker),n(Te))return;Te.dirX=Te.dirY=0,d.followObj=Te,Te.followDampX=null,Te.followDampY=null,n($e)&&($e=new t.Boundary(0,0,d.stage.width,d.stage.height)),d.followBoundary=$e,n(lt)&&(lt=.05),n(Qe)&&(Qe=lt),n(ot)&&(ot=0),n(ft)&&(ft=0),n(ut)&&(ut=0),n(ze)&&(ze=0),n(kt)&&(kt=.02),n(Mt)&&(Mt=kt),n(xt)&&(xt=!0),n(Yt)&&(Yt=!0),n(Dt)&&(Dt=!1),n(Ht)&&(Ht=!1),Te.parent?Et():Te.on("added",Et);function Et(){var Qt=Te.parent;d.frameBorderLock=Dt,xt&&(d.followDampX=new t.Damp(Qt.x,lt),d.offsetDampX=new t.Damp($e.x+ot+($e.width-ot-ft)/2,kt)),Yt&&(d.followDampY=new t.Damp(Qt.y,Qe),d.offsetDampY=new t.Damp($e.y+ut+($e.height-ut-ze)/2,Mt)),d.followTicker=t.Ticker.add(function(){var Je=d.followBoundary;if(xt){var gt=Je.x+ot+(Je.width-ot-ft)/2;d.followOffsetX=[Ht?Je.x+Je.width-ot:gt,gt,Ht?Je.x+ot:gt],d.followObj&&(Qt.x=d.followDampX.convert(d.offsetDampX.convert(d.followOffsetX[Te.motionController?Te.motionController.dirX+1:1])-Te.x))}if(Yt){var Ot=Je.y+ut+(Je.height-ut-ze)/2;d.followOffsetY=[Ht?Je.y+Je.height-ze:Ot,Ot,Ht?Je.y+ut:Ot],d.followObj&&(Qt.y=d.followDampY.convert(d.offsetDampY.convert(d.followOffsetY[Te.motionController?Te.motionController.dirY+1:1])-Te.y))}d.frameBorderLock&&(Qt.x>d.followBoundary.x&&(Qt.x=d.followBoundary.x),Qt.y>d.followBoundary.y&&(Qt.y=d.followBoundary.y),Qt.x<d.followBoundary.x+d.followBoundary.width-Qt.width&&(Qt.x=d.followBoundary.x+d.followBoundary.width-Qt.width),Qt.y<d.followBoundary.y+d.followBoundary.height-Qt.height&&(Qt.y=d.followBoundary.y+d.followBoundary.height-Qt.height))})}return Te},n(t.blurCheck)&&t.setBlurDetect(),this.keyboardMessage=function(Te,$e,Mt,Qe,ot){var ft="color, backgroundColor, message, response, percent",ut;if(ut=st(d.keyboardMessage,arguments,ft))return ut;n(Te)&&(Te=t.yellow),n($e)&&($e="black"),n(Mt)&&(Mt="PRESS SCREEN FOR KEYBOARD CONTROL"),n(Qe)&&(Qe="YOU HAVE KEYBOARD CONTROL"),n(ot)&&(ot=80);function ze(){try{return window.self!==window.top}catch{return!0}}var kt=ze();kt&&(d.canvas.style.pointerEvents="none");var Mt=new t.Label({text:Mt,size:40,color:Te,backgroundColor:$e,paddingV:15,paddingH:30,shiftV:1,align:CENTER}).scaleTo(d.stage,ot).ske(10).reg(CENTER).pos(0,50,CENTER,BOTTOM);document.addEventListener("mousedown",xt),document.addEventListener("pointerdown",xt);function xt(){kt&&(d.canvas.style.pointerEvents="auto"),document.removeEventListener("mousedown",xt),document.removeEventListener("pointerdown",xt),Mt&&(Mt.text=Qe,Mt.animate({props:{alpha:0},wait:1,call:()=>{Mt.dispose(),Mt=null}}),d.stage.update())}return Mt},this.dispose=function(){d.zil&&d.zil.length&&(j.removeEventListener("keydown",d.zil[0]),j.removeEventListener("wheel",d.zil[1]),j.removeEventListener("DOMMouseScroll",d.zil[2])),se&&se.removeAllEventListeners(),J&&j.removeEventListener("resize",J),j.removeEventListener("resize",be),j.removeEventListener("contextmenu",We),j.removeEventListener("keydown",Ve),j.removeEventListener("keyup",Se),j.removeEventListener("wheel",Ae),j.removeEventListener("devicemotion",Ye),j.removeEventListener("deviceorientation",Xe),j.removeEventListener("mousedown",N,!0),j.removeEventListener("mousemove",N,!0),j.removeEventListener("mouseup",N),_||(document.body.style.overflow="auto"),Te(le);function Te($e){if($e.dispose)$e.dispose();else{if($e.removeAllEventListeners(),$e.numChildren)for(var lt=$e.numChildren-1;lt>=0;lt--)Te($e.getChildAt(lt));$e.parent&&$e.parent.removeChild($e)}$e=null}return wn(I)&&wn(I).parentNode.removeChild(wn(I)),d==t.tickerFrame&&(t.tickerFrame=null),d===j.zdf&&(j.zdf=j.S=j.W=j.H=null),le=null,d=null,!0},this.makeCircles=function(Te,$e){n(Te)&&(Te=100);var lt=[t.orange,t.green,t.pink,t.blue,t.brown,t.dark],Qe,ot;if($e)for(Qe=new t.Container({style:!1}),Qe.radius=Te,ot=0;ot<lt.length;ot++)Qe.addChild(new t.Circle(Qe.radius/lt.length*(lt.length-ot),lt[ot],null,null,null,null,null,null,!1));else{Qe=new t.Shape({style:!1});var ft=Qe.graphics;for(Qe.radius=Te,ot=0;ot<lt.length;ot++)ft.f(lt[ot]).dc(0,0,Qe.radius/lt.length*(lt.length-ot));Qe.setBounds(-Qe.radius,-Qe.radius,Qe.radius*2,Qe.radius*2)}return Qe},this.madeWith=function(Te,$e,lt,Qe,ot,ft,ut){var ze="color, text, edges, box, slats, borderColor, borderWidth",kt;if(kt=st(d.madeWith,arguments,ze))return kt;n(Te)&&(Te=t.dark),n($e)&&($e="Made with ZIM");var Mt=new t.Container,xt=Mt.icon=d.makeIcon(lt,Qe,ot,ft,ut).sca(.5).alp(.92).hov(1).addTo(Mt).tap(function(){xt.alp(.92),xt.stage.update(),nr("https://zimjs.com","_blank")});return Mt.label=new t.Label($e,16,null,Te).sca(.7).pos(0,-19,t.CENTER,t.BOTTOM,Mt),Mt},this.makeIcon=function(Te,$e,lt,Qe,ot){var ft="edges, box, slats, borderColor, borderWidth",ut;if(ut=st(d.makeIcon,arguments,ft))return ut;var ze=new t.Container(-20,-13,102,120).reg(-20,-13);n(Te)&&(Te=t.light),n($e)&&($e=t.dark),lt===!0&&(lt=[t.silver,t.silver,t.silver,t.silver,t.silver]),new t.Rectangle(ze.width,ze.height,$e,Qe,ot).loc(-20,-13,ze);var kt=[[lt?lt[0]:"#E474C3","AieA0IAAgCIAmhlIEXAAIg5Bng",41.7,19.5],[lt?lt[1]:"#50C5B7","AiSAzIAnhlID+AAIg5Blg",35.3,33.2],[lt?lt[2]:"#F48E25","AiFA0IAmhnIDlAAIg5Bng",28.9,46.7],[lt?lt[3]:"#EBCD36","Ah4AzIAmhlIDLAAIg5Blg",22.4,60.5],[lt?lt[4]:"#ABD140","AhrA0IAAgFIAlhiICxAAIg5Bng",16.1,74.3],[Te,"AlGHRIAnhnIH+AAIgbBngAlGlpIAnhnIJmAAIg5Bng",32.7,46.5]];return t.loop(kt,function(Mt){var xt=new t.Shape().addTo(ze);xt.graphics.f(Mt[0]).p(Mt[1]),xt.setTransform(Mt[2],Mt[3])}),ze.mouseChildren=!1,ze},this.makeAbstract=function(Te){n(Te)&&(Te="black");var $e=[[115.8,103.55,"#4ACBEB","Am6GkIAAtHIN0AAIAAClIrZAAIAAKig"],[127.55,73.3,"#A1E543","AAjLSIAAp6IEiAAIAAJ6gAlELOIAAp2IEiAAIAAJ2gAlEihIAAowIKEAAIAAIwg"],[32.55,73.05,"#B545E4","Ak6LQIAA2fIJ1AAIAAWfg"]],lt=new t.Rectangle(200,200);t.loop($e,function(ot){var ft=new t.Shape().f(ot[2]).p(ot[3]);ft.setTransform(ot[0]+20,ot[1]+27),ft.addTo(lt)},!0);var Qe=new t.Container;return lt.sca(.4).addTo(Qe),Qe.mouseChildren=!1,Qe},this.makeCat=function(Te){n(Te)&&(Te=246);var $e=[[16.95,241.15,0,"black",[1.5,2,1],"AgKAhIAVhB"],[58.65,244.378,0,"#A7A7A7",[3,2,1],"AmYAAIMxAB"],[105.64,107.14,"#EF7988",0,0,"AAEArQgNAAgjghQgiggAFgIQAFgJBEgCQBEgDAGAGQAHAIgfAkQgfAlgPAAIAAAAg"],[104.84,111.34,0,"black",[1,1,1],"AABA2IAPAYQAJAPAJAGQAKAHAMAAQAbAAAXgWQAQgPAVghQAVghAAgcQAAgnglgYQgbgSgxgCIgrACAAJADIgIAzAhphVQgXAVgMAWQgKAQgIAiQgIAkAFAMQALAfAqAOQAmANAcgIQANgEANgQQALgNAGgT"],[105.05,111.4,"#757B74",0,0,"AheBrQgvgRgQgeQgPgdAQgkQAZg8AEgFQAXgfA8gGQBVgKA+ATQBRAZgYBEQgVA/gnAZQgUAOgZAKQgJAJgVgbQgUgegCAAQgDAAgWAgQgWAUgZAAQgMAAgNgEg"],[86.18,93,"black",0,0,"Aj7g0QiYg0i9AyQA0g3BcgRQBagQBfAaQBkAbBEBBQBNBHASBpQhgiYibg0gAFxiDQAzgdA6AMQA9AMA2A4QgHgBAAACQAAAAgBABQAAAAAAAAQgBAAgBAAQAAAAgBgBQh8gshOAzQhIAvhBCYQALjABzhCg"],[78.5,63.23,"#705F6C","black",[1,1,1],"AHAg5IgNmIIBfGpQgOgQgSgMQgjgXgPASgAKeDZQg2g4g9gMQg6gMgzAdQhzBCgLDBQBBiZBIgvQBNgzB9AsQAEACAAgCQAAgCAHABgAqdBuIAAnsIDmHEQgegMgsgBQhXgChFA3gAoEDzQA0g3BdgRQBagQBeAaQBkAbBFBBQBMBIASBpQhfiYibg1QiYg0i+Ayg"],[86.28,98.01,"black","black",[1,1,1],"AJSh/QgEADgHgDQgFgBgBAFQgNBXhNA9QhTBEhagZQgGgCgPAFQgUAHgEAAQCNAeBchOQBGg7AWhigApRhnQAFABAIAAQAGABAAAAQBFBsCVA7QCpBDCrgzQACAAAHAJQAEAFAFAJQjAAzitg/Qing9g/iHg"],[96.95,97.3,"#0C0436",0,0,"AlZBJQgVgVAAgeQAAgcAVgVQAVgVAeAAQAdAAAVAVQAVAVAAAcQAAAegVAVQgVAVgdAAQgeAAgVgVgAD1AcQgVgVAAgdQAAgdAVgVQAVgVAeAAQAdAAAVAVQAVAVAAAdQAAAdgVAVQgVAVgdAAQgeAAgVgVg"],[96.88,97.2,"#EA9424",0,0,"AlpBYQgbgbAAgnQAAglAbgbQAbgbAnAAQAmAAAbAbQAbAbAAAlQAAAngbAbQgbAbgmAAQgnAAgbgbgADnArQgbgbAAgmQAAgmAbgbQAbgbAmAAQAnAAAbAbQAbAbAAAmQAAAmgbAbQgbAbgnAAQgmAAgbgbg"],[96.88,97.2,"#AFCE3A",0,0,"AlzBiQgggfAAgtQAAgrAggfQAfggAtAAQAsAAAgAgQAfAfAAArQAAAtgfAfQggAggsAAQgtAAgfgggADcA1QgfgfAAgsQAAgsAfgfQAgggAsAAQAtAAAfAgQAgAfAAAsQAAAsggAfQgfAggtAAQgsAAggggg"],[78.5,64.1,0,"black",[1,1,1],"AHAhCIgNmIIBfGpQgOgQgSgMQgjgXgPASgAKeDQQg2g4g9gMQg6gMgzAdQhzBCgLDBQCqAvBlhgQBJhFAGhagAoADiQAlgiBTgOQBYgOBaARQDrAsA0DTQjAAziog/Qihg+hAiIgAqdBlIAAnsIDmHEQgegMgsgBQhXgChFA3g"],[86.375,93.9,"#EACE35",0,0,"AltB+Qiig9g/iIQAkghBTgOQBZgPBaARQDrAtA0DRQhWAXhSAAQhkAAhcgjgADxB2QALjABzhBQAzgeA6AMQA9ANA2A4QgGBYhJBGQhEBAhiAAQgxAAg4gQg"],[73.45,154.83,"black","black",[2,1,1],"AkjjDIByAMQB/ANBEAFQB/AICXgSIgKFzQj4hflLiNQgDgBAFiag"],[79.42,123.62,"#A7A7A7","black",[2,1,1],"AEBpxIgBgBQAYiNAeiQQA8kgAfgMQAggNBLEqQAlCVAfCXIAXARQAbAXAZAcQBQBZAZBnQAZBngUB+QgKA/gPArQgeASgrAWQhYAuhFAXQg8AUh0AWIhoASIAAQzItygCQAvhKA1hoQBqjRAjiXQAri/AOjLIAFimQgegHhTgeQhEgZhgg/IhTg7QgekPgQkUQggonBEgWQBFgWCbEtQAkBGA3B9QAbA9AYA3QASAqAQAmIgjhQIABAAIJmgYIBUACIBQAK"]],lt=new t.Container(157.5,246);t.loop($e,function(ot){var ft=new t.Shape().f(ot[2]).s(ot[3]).ss(ot[4]?ot[4][0]:null,ot[4]?ot[4][1]:null,ot[4]?ot[4][2]:null).p(ot[5]);ft.setTransform(ot[0],ot[1]),ft.addTo(lt)},!0);var Qe=new t.Container;return lt.sca(Te/246).addTo(Qe).mov(0,-.4),S&&Qe.cache(),Qe.mouseChildren=!1,Qe}},t.extend(t.Frame,Ne.EventDispatcher,null,"cjsEventDispatcher",!1),t.Queue=function(){this.cjsEventDispatcher_constructor(),this.type="Queue",this.isLoading=!0},t.extend(t.Queue,Ne.EventDispatcher,null,"cjsEventDispatcher"),t.Pic=function(e,r,i,l,a,s,f){var c="file, width, height, noCors, style, group, inherit",w;if(w=st(t.Pic,arguments,c,this))return w;De("83.03"),this.group=s;var T=a===!1?{}:t.getStyle("Pic",this.group,f);if(n(e)&&(e=T.file!=null?T.file:null),n(l)&&(l=T.noCors!=null?T.noCors:!1),n(e)){dt&&tt("ZIM Pic - needs a file");return}this.zimContainer_constructor(r,i);var p=this,x=e;e=p.file=t.Pick.choose(e),r&&i?this.type="ACWD":this.type="AC";var P=l?t.image(e):t.asset(e);p.mouseChildren=!1,P.type=="Bitmap"||P.type=="Image"?(P.type=="Bitmap"?p.bitmap=P.clone().addTo(p):p.bitmap=P.getChildAt(0).clone().addTo(p),p.id=P.id,p.image=p.bitmap.image,p.src=p.bitmap.src,p.item=p.bitmap.item,p.setBounds(null),p.type="Pic",setTimeout(function(){p.dispatchEvent("ready"),p.dispatchEvent("complete")},20)):P.on("complete",function(){if(p.bitmap=P.getChildAt(0).clone().addTo(p),p.id=P.id,p.setBounds(null),p.type="Pic",p.commands)for(var m=0;m<p.commands.length;m++)p.commands[m][2]?p[p.commands[m][0]].apply(p,p.commands[m][1]):t[p.commands[m][0]].apply(p,p.commands[m][1]);p.image=p.bitmap.image,p.src=p.bitmap.src,p.item=p.bitmap.item,p.commands=null,p.dispatchEvent("ready"),p.dispatchEvent("complete"),p.stage&&p.stage.update()}),p.keyOut=function(m,v,I){return p.type=="AC"&&j.zdf?(j.zdf.ac("keyOut",arguments,p),p):(p.bitmap&&p.bitmap.keyOut(m,v,I),p.stage&&p.stage.update(),p)},a!==!1&&t.styleTransforms(this,T),p.clone=function(m){return this.cloneProps(new t.Pic(m?e:x,r,i,l,a,this.group,f))}},t.extend(t.Pic,t.Container,["clone"],"zimContainer",!1),t.Aud=function(e,r,i,l,a,s,f,c,w,T,p,x){var P="file, volume, loop, loopCount, pan, offset, delay, interrupt, maxNum, style, group, inherit",m;if(m=st(t.Aud,arguments,P,this))return m;De("83.05"),this.cjsEventDispatcher_constructor(),this.type="Aud",this.group=p;var v=T===!1?{}:t.getStyle(this.type,this.group,x);if(n(e)&&(e=v.file!=null?v.file:null),n(e)){dt&&tt("ZIM Sound - needs a file");return}n(r)&&(r=v.volume!=null?v.volume:1),n(i)&&(i=v.loop!=null?v.loop:!1),n(l)&&(l=v.loopCount!=null?v.loopCount:null),n(a)&&(a=v.pan!=null?v.pan:0),n(s)&&(s=v.offset!=null?v.offset:0),n(f)&&(f=v.delay!=null?v.delay:0),n(c)&&(c=v.interrupt!=null?v.interrupt:"none"),n(w)&&(w=v.maxNum!=null?v.maxNum:null);var I=this;e=I.file=t.Pick.choose(e);var g=I.sound=t.asset(e,null,null,w);g.type=="AC"?g.on("complete",function(){I.src=g.src,I.item=g.item,I.dispatchEvent("ready"),I.dispatchEvent("complete")}):setTimeout(function(){I.src=g.src,I.item=g.item,I.dispatchEvent("ready"),I.dispatchEvent("complete")},20),I.volume=r,I.loop=i,I.loopCount=l,I.pan=a,I.offset=s,I.delay=f,I.interrupt=c,I.maxNum=w,I.play=function(E,A,y,C,L,Y,_){var k="volume, loop, loopCount, pan, offset, delay, interrupt",$;return($=st(I.play,arguments,k))?$:(n(E)&&(E=I.volume),n(A)&&(A=I.loop),n(y)&&(y=I.loopCount),n(C)&&(C=I.pan),n(L)&&(L=I.offset),n(Y)&&(Y=I.delay),n(_)&&(_=I.interrupt),I.sound.play(E,A,y,C,L,Y,_))},I.dispose=function(){return I.sound&&I.sound.dispose(),I.sound=null,!0}},t.extend(t.Aud,Ne.EventDispatcher,null,"cjsEventDispatcher"),t.Vid=function(e,r,i,l,a,s,f,c,w,T,p,x){var P="file, width, height, scaling, volume, loop, align, valign, type, style, group, inherit",m;if(m=st(t.Vid,arguments,P,this))return m;De("83.07"),this.group=p;var v=T===!1?{}:t.getStyle("Vid",this.group,x);if(n(e)&&(e=v.file!=null?v.file:null),n(e)){dt&&tt("ZIM Vid - needs a file");return}n(r)&&(r=v.width!=null?v.width:null),n(i)&&(i=v.height!=null?v.height:null),n(l)&&(l="fit"),n(s)&&(s=v.loop!=null?v.loop:!1),n(a)&&(a=v.volume!=null?v.volume:1),n(f)&&(f=v.align!=null?v.align:"center"),n(c)&&(c=v.valign!=null?v.valign:"center"),n(w)&&(w=v.type!=null?v.type:"video/mp4"),this.zimContainer_constructor(r,i),r&&i?this.type="ACWD":this.type="AC";var I=this,g,E=e;e=t.Pick.choose(e),I.file=e,j.PATH!=null&&(t.PATH=j.PATH);var A="";e.split("/").length==1&&t.PATH&&(A=t.PATH),this.mouseChildren=!1;var y=I.source=document.createElement("video");document.body.appendChild(y),y.style.display="none",y.setAttribute("autoplay","autoplay"),y.setAttribute("playsinline","playsinline"),y.setAttribute("crossorigin","anonymous"),s&&y.setAttribute("loop","loop");var C=I.innerSource=document.createElement("source");e.split("?").length==1&&(e+="?playsinline=1"),C.setAttribute("src",A+e),C.setAttribute("type",w),y.appendChild(C),Y();var L=0;function Y(){L++>5&&I.dispatchEvent("error"),y.addEventListener("stalled",Y),y.addEventListener("error",Y),y.addEventListener("canplay",_)}function _(){I.type="Vid",y.removeEventListener("stalled",Y),y.removeEventListener("error",Y),y.removeEventListener("canplay",_),y.pause();var k=y.videoWidth,$=y.videoHeight;if(I.setBounds(0,0,r||k,i||$),g=I.bitmap=new t.Bitmap(y,k,$).addTo(I),g.setBounds(0,0,k,$),g.scaleTo(I,100,100,l).pos(0,0,f,c,I),I.commands)for(var O=0;O<I.commands.length;O++)I.commands[O][2]?I[I.commands[O][0]].apply(I,I.commands[O][1]):t[I.commands[O][0]].apply(I,I.commands[O][1]);I.commands=null,I.dispatchEvent("ready")}I.videoPaused=!0,I.play=function(){if(!g){dt&&tt("ZIM Vid - no file found");return}if(y.play(),y.volume=a,I.videoPaused=!1,!I.ticker)if(I.keyObj){var k=I.keyObj.color,$=I.keyObj.tolerance,O=I.keyObj.replacement;I.ticker=t.Ticker.add(function(){g.keyOut(k,$,O)})}else I.ticker=t.Ticker.add(function(){});return I},I.keyOut=function(k,$,O){return I.ticker?(t.Ticker.remove(I.ticker),I.ticker=t.Ticker.add(function(){g.keyOut(k,$,O)})):I.keyObj={color:k,tolerance:$,replacement:O},I},I.pause=function(k){return n(k)&&(k=!0),I.videoPaused=k,k?(y.pause(),I.ticker&&t.Ticker.remove(I.ticker)):(I.ticker&&t.Ticker.add(I.ticker),y.play()),I},Object.defineProperty(this,"duration",{get:function(){return y.duration},set:function(){}}),Object.defineProperty(this,"currentTime",{get:function(){return y.currentTime},set:function(k){y.currentTime=k}}),Object.defineProperty(this,"volume",{get:function(){return y.volume},set:function(k){a=k,y.volume=k}}),T!==!1&&t.styleTransforms(this,v),I.clone=function(k){return this.cloneProps(new t.Vid(k?e:E,r,i,l,a,s,f,c,w,T,this.group,x))},I.dispose=function(k,$,O){this.ticker&&t.Ticker.remove(this.ticker);var X=I.stage;return I.bitmap.dispose(),g=I.bitmap=null,y.pause(),y.removeAttribute("src"),y.load(),y.remove(),y=null,O||this.zimContainer_dispose(!0),X&&X.update(),!0}},t.extend(t.Vid,t.Container,["clone","dispose"],"zimContainer",!1),t.SVG=function(e,r,i,l,a,s,f,c,w,T,p){var x="svg, width, height, bitmap, splitTypes, geometric, showControls, interactive, style, group, inherit",P;if(P=st(t.SVG,arguments,x,this))return P;De("83.09"),this.group=T;var m=w===!1?{}:t.getStyle("SVG",this.group,p);if(n(e)&&(e=m.svg!=null?m.svg:null),n(e)){dt&&tt("ZIM SVG - needs a svg value");return}n(l)&&(l=m.bitmap!=null?m.bitmap:!0),n(a)&&(a=m.splitTypes!=null?m.splitTypes:!1),n(s)&&(s=m.geometric!=null?m.geometric:!0),n(f)&&(f=m.showControls!=null?m.showControls:!0),n(c)&&(c=m.interactive!=null?m.interactive:!0),this.zimContainer_constructor(r,i);var v=this;l&&(this.mouseChildren=!1);var I=e;e=t.Pick.choose(e),r&&i?this.type="ACWD":this.type="AC";var g=t.assets[e];if(g&&(v.src=g.src,v.file=g.file,v.item=g.item,v.svg=g.svg),g&&g.type=="Bitmap")v.type="SVG",v.bitmap=g.clone(),A();else if(g&&g.type=="AC")g.on("complete",function(){v.type="SVG",v.bitmap=g.bitmap.clone(),A(n(r)&&n(i))});else if(g&&g.type=="ACWB")n(r)&&n(i)&&v.setBounds(0,0,g.width,g.height),g.on("complete",function(){v.type="SVG",v.bitmap=g.bitmap.clone(),A()});else if(g&&g.type=="SVG")v.type="SVG",g.bitmap?v.bitmap=g.bitmap.clone():v.bitmap=g.clone(),A();else if(e&&e.match(/<svg/i)&&(v.svg=e),v.svg&&v.svg.match(/<svg/i))v.type="SVG",A();else{var E=t.asset(e);E.on("complete",function(){v.type="SVG",E.bitmap&&(v.src=E.bitmap.src,v.file=E.bitmap.file,v.item=E.bitmap.item,v.svg=E.bitmap.svg,v.bitmap=E.bitmap.clone()),A(n(r)&&n(i))})}function A(C){if(l)v.bitmap?(v.svg=v.bitmap.svg,v.bitmap.addTo(v),C&&y(),setTimeout(function(){v.dispatchEvent("ready"),v.dispatchEvent("complete")},20)):t.svgToBitmap(v.svg,function(_){v.bitmap=_,v.bitmap.addTo(v),y(),v.dispatchEvent("ready"),v.dispatchEvent("complete"),v.stage&&v.stage.update()});else if(v.bitmap&&(v.svg=v.bitmap.svg),e.match(/<svg/i)||g&&g.type=="SVG"||C){var L=new t.SVGContainer(v.svg);L.loop(function(_){_&&_.addTo(v)},!0),C&&y(),setTimeout(function(){v.dispatchEvent("ready"),v.dispatchEvent("complete")},20)}else{var Y=t.asset(e);Y.on("complete",function(){var _=new t.SVGContainer(Y);_.loop(function(k){k&&k.addTo(v)},!0),y(),v.dispatchEvent("ready"),v.dispatchEvent("complete"),v.stage&&v.stage.update()})}}function y(){if(n(r)&&n(i)&&v.setBounds(null),v.type="SVG",v.commands)for(var C=0;C<v.commands.length;C++)v.commands[C][2]?v[v.commands[C][0]].apply(v,v.commands[C][1]):t[v.commands[C][0]].apply(v,v.commands[C][1]);v.commands=null}v.keyOut=function(C,L,Y){return v.type=="AC"&&j.zdf?(j.zdf.ac("keyOut",arguments,v),v):(v.bitmap&&v.bitmap.keyOut(C,L,Y),v.stage&&v.stage.update(),v)},w!==!1&&t.styleTransforms(this,m),v.clone=function(C){return this.cloneProps(new t.SVG(C?e:I,r,i,l,a,s,f,c,w,this.group,p))}},t.extend(t.SVG,t.Container,["clone"],"zimContainer",!1),t.SensorAsk=function(e,r,i,l,a,s,f){var c="callback, sensorType, color, backgroundColor, style, group, inherit",w;if(w=st(t.SensorAsk,arguments,c,this))return w;De("83.01"),this.group=s;var T=a===!1?{}:t.getStyle("SensorAsk",this.group,f);if(n(r)&&(r=T.sensorType!=null?T.sensorType:"deviceorientation"),r!="devicemotion"&&(r="deviceorientation"),this.sensorType=r,!n(e)){n(i)&&(i=T.color!=null?T.color:t.dark),n(l)&&(l=T.backgroundColor!=null?T.backgroundColor:t.lighter),this.zimPane_constructor("",l,i,200,200,!1,null,!0,100,black.toAlpha(.3),null,null,null,!1,!1),this.type="SensorAsk";var p=this;if(Style.addGroup("sensorAsk",{width:100,color:i,rollColor:l,corner:10,backgroundColor:t.faint,rollBackgroundColor:i,borderColor:i,borderWidth:2}),p.yes=new t.Button({label:"YES",group:"sensorAsk"}).sca(.65).pos(0,30,CENTER,TOP,this).tap(function(){p.hide(!0);var P=DeviceMotionEvent;r!="devicemotion"&&(P=DeviceOrientationEvent),P.requestPermission().then(function(m){m!="denied"?e(!0):e(!1)})}),p.label=new t.Label("Use sensor?",null,null,i,null,null,null,"center").sca(.9).centerReg(this),p.no=new t.Button({label:"NO",group:"sensorAsk"}).sca(.65).pos(0,30,CENTER,BOTTOM,this).tap(function(){p.hide(!1),e(!1)}),new t.Circle(110,t.clear,i,1).center(this).alp(.8),new t.Circle(120,t.clear,i,1).center(this).alp(.5),new t.Circle(130,t.clear,i,1).center(this).alp(.2),a!==!1&&t.styleTransforms(this,T),typeof DeviceOrientationEvent<"u"&&DeviceOrientationEvent&&typeof DeviceOrientationEvent.requestPermission=="function")p.show();else{let P=function(m){r=="deviceorientation"?m.alpha==null||m.alpha==0&&m.beta==0&&m.gamma==0?e(!1):e(!0):!m.acceleration||m.acceleration.x==null||m.acceleration.x==0&&m.acceleration.y==0&&m.acceleration.z==0?e(!1):e(!0),x=!0,j.removeEventListener(r,P)};var x=!1;j.addEventListener(r,P),setTimeout(function(){x||e(!1)},100)}}},t.extend(t.SensorAsk,t.Pane,null,"zimPane",!1),t.colorsHex=["#fb4758","#f58e25","#ebcb35","#acd241","#50c4b7","#993399","#e472c4","#d1a170","#112233","#000000","#111111","#222222","#333333","#444444","#555555","#555555","#666666","#777777","#888888","#999999","#aaaaaa","#bbbbbb","#cccccc","#dddddd","#eeeeee","#ffffff","rgba(0,0,0,.01)","rgba(0,0,0,0)"],t.colors=["red","orange","yellow","green","blue","purple","pink","brown","interstellar","black","darker","licorice","dark","charcoal","grey","gray","granite","tin","pewter","silver","fog","mist","light","moon","lighter","white","faint","clear"],cn=0;cn<t.colors.length;cn++)t[t.colors[cn]]=t.colorsHex[cn];return String.prototype.darken=function(e){return t.darken(this,e)},String.prototype.lighten=function(e){return t.lighten(this,e)},String.prototype.toColor=function(e,r){return t.toColor(this,e,r)},String.prototype.toAlpha=function(e){return t.toAlpha(this,e)},t.FIT="fit",t.FILL="fill",t.FULL="full",t.LEFT="left",t.RIGHT="right",t.CENTER="center",t.MIDDLE="middle",t.START="start",t.END="end",t.TOP="top",t.BOTTOM="bottom",t.OVER="over",t.UNDER="under",t.HORIZONTAL="horizontal",t.VERTICAL="vertical",t.BOTH="both",t.RADIAL="radial",t.UP="up",t.DOWN="down",t.NEXT="next",t.PREV="prev",t.AUTO="auto",t.AVE="ave",t.DEFAULT="default",t.ALL="all",t.NONE="none",t.GET="get",t.POST="post",t.LOCALSTORAGE="localStorage",t.SOCKET="socket",t.TO="to",t.FROM="from",t.SINE="sine",t.SQUARE="square",t.TRIANGLE="triangle",t.SAW="saw",t.SAWTOOTH="saw",t.ZAP="zap",t.DISTILL=!1,t.distillery=[],t.distill=function(){!j.zns&&t&&(t.DISTILL||j.DISTILL)&&t.distillery.push("83.3","83.35");function e(r,i,l){return l.indexOf(r)===i}t.distillery.length>0?(t.distillery=t.distillery.filter(e),tt("zim.distill() - go to https://zimjs.com/distill and enter the following:"),Gn(t.distillery.join(" "))):tt("must set zim.DISTILL = true;")},t.parseAudioSprite=function(e,r){if(De("83.25"),!(n(e)||n(e.resources)||n(e.spritemap))){var i=e,l=i.resources[0],a=i.spritemap,s=[],f,c={src:l,data:{}};for(var w in a)f=a[w],s.push({id:w,startTime:Math.round(f.start*1e3),duration:Math.round((f.end-f.start)*1e3)});return c.data.audioSprite=s,r&&tt(JSON.stringify(c)),c}},t.previewAudioSprite=function(e,r,i){if(De("83.26"),!n(e)){if(n(r)&&(r=3),typeof i>"u"){if(n(j.zdf))return;var i=j.zdf}var l=i.width,a=e,s=[],f=[];if(a.constructor=={}.constructor)a.resources&&(a=t.parseAudioSprite(a)),a.audioSprite?t.loop(a.audioSprite,function(w){s.push(w[0].substr(0,r)),f.push(w[0])}):a.data&&a.data.audioSprite&&t.loop(a.data.audioSprite,function(w){s.push(w.id.substr(0,r)),f.push(w.id)});else return;var c=new t.Tabs({tabs:s,width:l,currentEnabled:!0}).addTo();return c.on("change",function(){i.asset(f[c.selectedIndex]).play()}),c}},t.svgToBitmap=function(e,r,i,l,a){if(De("83.27"),!n(e.draggable)){var s=new DOMParser;e=e.innerHTML?s.parseFromString(e.innerHTML,"text/xml"):e;var f=e.getElementsByTagName("svg"),c=f?e.getElementsByTagName("svg")[0]:null;e=c}if(!XMLSerializer&&dt){tt("ZIM svgToBitmap() - sorry, not supported in Browser");return}var w=typeof e=="string"?e:new XMLSerializer().serializeToString(e);if(w){var T=w.split(">")[0];if(T.length>1){var p=T.split(/width/i);if(p.length==1){var x=100,P=100,m=T.split(/viewBox/i);if(m.length>1){var v=m[1].split('"')[1];if(v){var I=v.split(" ");I.length>1&&(x=I[I.length-2],P=I[I.length-1])}}w=w.replace(/svg /i,'svg  width="'+x+'" height="'+P+'" ')}}w.match(/xmlns/i)||(w=w.replace(/svg /i,"svg  xmlns='http://www.w3.org/2000/svg' "))}var g=self.URL||self.webkitURL||self,E=new Image;E.onload=function(){var y=new t.Bitmap(E,i,l);r(y,a),g.revokeObjectURL(A)};var A=g.createObjectURL(new document.Blob([w],{type:"image/svg+xml"}));E.src=A},t.makeContent=function(e,r,i){De("83.29");var l;if(n(i)&&(i=t.dark),typeof e=="string"||typeof e=="number")e=this.message=new t.Label(e,null,null,i);else if(e.constructor=={}.constructor){var a=e;a.buttonScale||(a.buttonScale=.5),n(a.spacingH)&&(a.spacingH=20*a.buttonScale),n(a.spacingV)&&(a.spacingV=20);var s=a.spacingH,f=a.spacingV;a.align||(a.align="center"),e=new t.Container;var c=new jr(10,f).addTo(e);if(a.header&&a.header.pos(0,f,"left","top",e),a.message)var w=new t.Label(a.message,null,null,n(a.color)?i:a.color).loc(0,e.height+(a.header?f:0),e);if(a.display&&a.display.pos(0,-a.display.height-(a.header||a.message?f:0),"left","bottom",e),a.buttons){Array.isArray(a.buttons)||(a.buttons=[a.buttons]);for(var T=a.length*100,p=new t.Container().loc(0,e.height+(a.header||a.message||a.display?f:0),e),x=0;x<a.buttons.length;x++){var P=a.buttons[x],m=P.call||function(){};P.button||(P.button=new t.Button({width:P.width,label:P.label,backgroundColor:P.backgroundColor||P.bgColor,color:P.color,rollBackgroundColor:P.rollBackgroundColor||P.rollBgColor,rollColor:P.rollColor})),P.button.call=m,P.button.sca(a.buttonScale).loc(x==0?0:p.width+s,0,p).tap(function(I){I.target.call(I.target)})}}for(l=0;l<e.numChildren;l++){var v=e.getChildAt(l);v.lastY=v.y,a.align=="center"?v.center(e).loc(null,v.lastY):a.align=="right"&&v.pos(0,null,"right")}if(r&&typeof r=="number"&&(e.width=Math.min(e.width,r-s*2-(a.scrollBar===!0?12:a.scrollBar>0?a.scrollBar:0))),new t.Container(10,f).pos(0,-c.height,"center","bottom",e).bot(),c.top(),e.config=a,e.header=a.header,e.message=w,e.text=a.message,e.display=a.display,a.buttons)for(e.buttons=[],l=0;l<p.numChildren;l++)e.buttons.push(p.getChildAt(l))}return e},t}(ve||{});function De(t){ve&&(ve.DISTILL||j.DISTILL)&&ve.distillery.push(t)}function Vn(t,wt,It,St,bt,Ct){if(De("83.3"),t&&t.noDrag)return t;Ct!==!0&&(Ct=null);var Xt={drag:function(Ke,e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g){return dn(arguments)?(arguments[0].obj=this,ve.drag(arguments[0])):ve.drag(this,Ke,e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g)},noDrag:function(Ke){return ve.noDrag(this,Ke)},mouse:function(){return ve.mouse(this)},noMouse:function(){return ve.noMouse(this)},effect:function(Ke,e,r,i,l){return ve.effect(this,Ke,e,r,i,l)},noEffect:function(Ke,e){return ve.noEffect(this,Ke,e)},updateEffects:function(Ke){return ve.updateEffects(this,Ke)},wire:function(Ke,e,r,i,l,a,s){return dn(arguments)?(arguments[0].source=this,ve.wire(arguments[0])):ve.wire(this,Ke,e,r,i,l,a,s)},noWire:function(Ke,e,r){return dn(arguments)?(arguments[0].source=this,ve.noWire(arguments[0])):ve.noWire(this,Ke,e,r)},wired:function(Ke,e,r,i,l,a,s){return dn(arguments)?(arguments[0].target=this,ve.wired(arguments[0])):ve.wired(this,Ke,e,r,i,l,a,s)},noWired:function(Ke,e,r){return dn(arguments)?(arguments[0].target=this,ve.noWired(arguments[0])):ve.noWired(this,Ke,e,r)},bind:function(Ke,e,r,i,l){return dn(arguments)?(arguments[0].obj=this,ve.bind(arguments[0])):ve.bind(this,Ke,e,r,i,l)},noBind:function(Ke,e,r,i){return dn(arguments)?(arguments[0].obj=this,ve.noBind(arguments[0])):ve.noBind(this,Ke,e,r,i)},dragBoundary:function(Ke){return ve.dragBoundary(this,Ke)},dragRect:function(Ke){return ve.dragBoundary(this,Ke)},transform:function(Ke,e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O,X){return dn(arguments)?(arguments[0].obj=this,ve.transform(arguments[0])):ve.transform(this,Ke,e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O,X)},setSwipe:function(Ke){return ve.setSwipe(this,Ke)},gesture:function(Ke,e,r,i,l,a,s,f,c,w,T,p,x,P,m){return dn(arguments)?(arguments[0].obj=this,ve.gesture(arguments[0])):ve.gesture(this,Ke,e,r,i,l,a,s,f,c,w,T,p,x,P,m)},noGesture:function(Ke,e,r){return dn(arguments)?(arguments[0].obj=this,ve.noGesture(arguments[0])):ve.noGesture(this,Ke,e,r)},gestureBoundary:function(Ke,e){return ve.gestureBoundary(this,Ke,e)},gestureRect:function(Ke,e){return ve.gestureBoundary(this,Ke,e)},addPhysics:function(Ke,e,r,i,l,a,s,f,c,w,T){return dn(arguments)?(arguments[0].obj=this,ve.addPhysics(arguments[0])):ve.addPhysics(this,Ke,e,r,i,l,a,s,f,c,w,T)},removePhysics:function(){return ve.removePhysics(this)},hitTestPoint:function(Ke,e,r){return ve.hitTestPoint(this,Ke,e,r)},hitTestReg:function(Ke,e){return ve.hitTestReg(this,Ke,e)},hitTestRect:function(Ke,e,r,i){return ve.hitTestRect(this,Ke,e,r,i)},hitTestCircle:function(Ke,e,r,i){return ve.hitTestCircle(this,Ke,e,r,i)},hitTestCircleRect:function(Ke,e){return ve.hitTestCircleRect(this,Ke,e)},hitTestCircles:function(Ke,e){return ve.hitTestCircles(this,Ke,e)},hitTestBounds:function(Ke,e,r){return ve.hitTestBounds(this,Ke,e,r)},boundsToGlobal:function(Ke,e,r,i){return ve.boundsToGlobal(this,Ke,e,r,i)},resetBounds:function(Ke,e,r,i,l){return dn(arguments)?(arguments[0].obj=this,ve.resetBounds(arguments[0])):ve.resetBounds(this,Ke,e,r,i,l)},hitTestPath:function(Ke,e,r,i,l){return ve.hitTestPath(this,Ke,e,r,i,l)},hitTestGrid:function(Ke,e,r,i,l,a,s,f,c,w,T,p){return ve.hitTestGrid(this,Ke,e,r,i,l,a,s,f,c,w,T,p)},animate:function(Ke,e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O,X,R,Q,K,q,ne,U,D,d,u,o,S,F,h,b,ye,B,N,re,le,G,z,se,Oe,J,pe,Z,de,V){return Ke&&(Ke.props||Ke.obj)&&dn(arguments)?(arguments[0].target=this,ve.animate(arguments[0])):ve.animate(this,Ke,e,r,i,l,a,s,f,c,w,T,p,x,P,m,v,I,g,E,A,y,C,L,Y,_,k,$,O,X,R,Q,K,q,ne,U,D,d,u,o,S,F,h,b,ye,B,N,re,le,G,z,se,Oe,J,pe,Z,de,V)},pauseAnimate:function(){return this},stopAnimate:function(){return this},wiggle:function(Ke,e,r,i,l,a,s,f,c,w,T,p,x,P,m){return dn(arguments)?(arguments[0].target=this,ve.wiggle(arguments[0])):ve.wiggle(this,Ke,e,r,i,l,a,s,f,c,w,T,p,x,P,m)},loop:function(Ke,e,r,i,l,a,s,f){return ve.loop(this,Ke,e,r,i,l,a,s,f)},copyMatrix:function(Ke){return ve.copyMatrix(this,Ke)},duplicate:function(Ke){return ve.duplicate(this,Ke)},cur:function(Ke){return ve.cur(this,Ke)},sha:function(Ke,e,r,i){return ve.sha(this,Ke,e,r,i)},pos:function(Ke,e,r,i,l,a,s,f,c,w){return dn(arguments)?(arguments[0].obj=this,ve.pos(arguments[0])):ve.pos(this,Ke,e,r,i,l,a,s,f,c,w)},loc:function(Ke,e,r,i,l,a,s){return dn(arguments)?(arguments[0].obj=this,ve.loc(arguments[0])):ve.loc(this,Ke,e,r,i,l,a,s)},mov:function(Ke,e){return dn(arguments)?(arguments[0].obj=this,ve.mov(arguments[0])):ve.mov(this,Ke,e)},top:function(){return ve.top(this)},bot:function(){return ve.bot(this)},ord:function(Ke){return ve.ord(this,Ke)},dep:function(Ke){return ve.dep(this,Ke)},nam:function(Ke){return ve.nam(this,Ke)},alp:function(Ke){return ve.alp(this,Ke)},vis:function(Ke){return ve.vis(this,Ke)},ble:function(Ke){return ve.ble(this,Ke)},dye:function(Ke){return ve.dye(this,Ke)},hov:function(Ke,e){return ve.hov(this,Ke,e)},rot:function(Ke,e,r){return ve.rot(this,Ke,e,r)},siz:function(Ke,e,r){return ve.siz(this,Ke,e,r)},ske:function(Ke,e){return ve.ske(this,Ke,e)},reg:function(Ke,e,r){return ve.reg(this,Ke,e,r)},sca:function(Ke,e){return ve.sca(this,Ke,e)},scaleTo:function(Ke,e,r,i,l){return dn(arguments)?(arguments[0].obj=this,ve.scaleTo(arguments[0])):ve.scaleTo(this,Ke,e,r,i,l)},fit:function(Ke,e,r,i,l){return dn(arguments)?(arguments[0].obj=this,ve.fit(arguments[0])):ve.fit(this,Ke,e,r,i,l)},outline:function(Ke,e,r){return dn(arguments)?(arguments[0].obj=this,ve.outline(arguments[0])):ve.outline(this,Ke,e,r)},blendmodes:function(Ke){return ve.blendmodes(this,Ke)},addTo:function(Ke,e,r){return dn(arguments)?(arguments[0].obj=this,ve.addTo(arguments[0])):ve.addTo(this,Ke,e,r)},removeFrom:function(Ke){return ve.removeFrom(this,Ke)},added:function(Ke,e,r){return ve.added(this,Ke,e,r)},movement:function(Ke,e){return ve.movement(this,Ke,e)},noMovement:function(){return ve.noMovement(this)},tap:function(Ke,e,r,i,l,a,s,f,c){return dn(arguments)?(arguments[0].obj=this,ve.tap(arguments[0])):ve.tap(this,Ke,e,r,i,l,a,s,f,c)},noTap:function(){return ve.noTap(this)},hold:function(Ke,e,r,i){return ve.hold(this,Ke,e,r,i)},noHold:function(){return ve.noHold(this)},change:function(Ke,e){return ve.change(this,Ke,e)},noChange:function(){return ve.noChange(this)},centerReg:function(Ke,e,r){return dn(arguments)?(arguments[0].obj=this,ve.centerReg(arguments[0])):ve.centerReg(this,Ke,e,r)},center:function(Ke,e,r){return dn(arguments)?(arguments[0].obj=this,ve.center(arguments[0])):ve.center(this,Ke,e,r)},place:function(Ke){return ve.place(this,Ke)},placeReg:function(Ke){return ve.placeReg(this,Ke)},expand:function(Ke,e,r,i){return dn(arguments)?(arguments[0].obj=this,ve.expand(arguments[0])):ve.expand(this,Ke,e,r,i)},setMask:function(Ke,e){return ve.setMask(this,Ke,e)},cloneProps:function(Ke){return Ke.type=this.type,Ke.group=this.group,Ke.style=this.style,Ke.alpha=this.alpha,Ke.rotation=this.rotation,Ke.mouseEnabled=this.mouseEnabled,Ke.mouseChildren=this.mouseChildren,Ke.tickEnabled=this.tickEnabled,Ke.x=this.x,Ke.y=this.y,Ke.scaleX=this.scaleX,Ke.scaleY=this.scaleY,Ke.skewX=this.skewX,Ke.skewY=this.skewY,Ke.name&&(Ke.name=this.name),Ke.regX=this.regX*Ke.width/(this.width||1),Ke.regY=this.regY*Ke.height/(this.height||1),Ke.visible=this.visible,Ke.shadow=this.shadow,(!this.type||this.type=="Shape")&&ve.copyMatrix(Ke,this),Ke.compositeOperation=this.compositeOperation,Ke.snapToPixel=this.snapToPixel,this.filters&&this.filters.length>0&&(Ke.filters=this.filters.slice(0),Ke.cache()),Ke.mask=this.mask,Ke.hitArea=this.hitArea,(!this.type||this.type=="Shape"||this.type=="Blob"||this.type=="Squiggle")&&this._bounds&&Ke.setBounds(this._bounds.x,this._bounds.y,this._bounds.width,this._bounds.height),Ke},cloneChildren:function(Ke,e){Ke.children.length&&Ke.removeAllChildren();for(var r=Ke.children,i=0,l=this.children.length;i<l;i++){var a=this.children[i].clone(e);a.parent=Ke,r.push(a)}return Ke}};if(!n(Ct)){Ct=[];for(var qt in Xt)Ct.push(qt);return Ct}for(var At in Xt)Object.prototype.hasOwnProperty.call(Xt,At)&&(t[At]=Xt[At]);if(ve&&(t.cjsLocalToGlobal=t.localToGlobal,t.cjsGlobalToLocal=t.globalToLocal,t.cjsLocalToLocal=t.localToLocal,t.localToGlobal=function(Ke,e){return ve.localToGlobal(Ke,e,t,t.cjsLocalToGlobal)},t.globalToLocal=function(Ke,e){return ve.globalToLocal(Ke,e,t,t.cjsGlobalToLocal)},t.localToLocal=function(Ke,e,r){return ve.localToLocal(Ke,e,r,t)},t.hueBatch||ve.displayBase(t)),!n(wt)&&!n(It)&&!n(St)&&!n(bt)?wt=wt:!n(wt)&&!n(It)&&(St=wt,bt=It,wt=0,It=0),!n(wt)&&!n(It)&&!n(St)&&!n(bt))t.setBounds(wt,It,St,bt);else if(t.nominalBounds!=null&&t.getBounds&&t.getBounds()==null){var Nt=t.nominalBounds;t.setBounds(Nt.x,Nt.y,Nt.width,Nt.height)}return t.parent&&t.parent.actionFrames&&!t.parent.addPhysics&&Vn(t.parent,zdf?zdf.width:null,zdf?zdf.height:null),t}var Ci;function mi(t){De("83.35"),document.Window=Window,document.Blob=Blob,Ci="ignore",n(t)&&(t=[]),Array.isArray(t)||(t=[t]);var wt=Vn(null,null,null,null,null,!0),It=["loop","stopAnimate","pauseAnimate","animate","wiggle","wire","wired"];for(var St in ve)(wt.indexOf(St)==-1||It.indexOf(St)>=0)&&t.indexOf(St)==-1&&(window[St]=ve[St])}ve.fastFrame=function(t,wt){if(De("83.355"),Ne=t,n(j.zdf))return wt.frame=new ve.Frame({shim:{stage:wt,canvas:wt.canvas}}),j.zimDefaultFrame=j.zdf=wt.frame,ve.scaX=Ne.stageTransformable?1:wt.scaleX,ve.scaY=Ne.stageTransformable?1:wt.scaleY,wt.frame};ve.addWires=function(t){return De("83.365"),t.wire=function(){return Array.prototype.unshift.call(arguments,t),ve.wire.apply(null,arguments),t},t.noWire=function(){return Array.prototype.unshift.call(arguments,t),ve.noWire.apply(null,arguments),t},t.wired=function(){return Array.prototype.unshift.call(arguments,t),ve.wired.apply(null,arguments),t},t.noWired=function(){return Array.prototype.unshift.call(arguments,t),ve.noWired.apply(null,arguments),t},t};ve.setBlurDetect=function(){De("83.36"),ve.blurCheck=!0,ve.pauseAnimateOnBlur=!0,ve.pauseOnBlur=[],ve.blurDetect=function(){var t,wt,It={hidden:"visibilitychange",webkitHidden:"webkitvisibilitychange",mozHidden:"mozvisibilitychange",msHidden:"msvisibilitychange"};for(t in It)if(t in document){wt=It[t];break}return function(St){return St&&document.addEventListener(wt,St),!document[t]}}(),ve.blurDetect(function(){var t,wt,It;if(ve.blurDetect())setTimeout(function(){if(ve.pauseOnBlur)for(t=0;t<ve.pauseOnBlur.length;t++)wt=ve.pauseOnBlur[t],wt.pauseOnBlurPaused||wt.pause(!1);if(ve.pauseAnimateOnBlur&&ve.animatedObjects){var St=[],bt;for(t=0;t<ve.animatedObjects.objects.length;t++){wt=ve.animatedObjects.objects[t];var Ct=ve.copy(wt.tweenStates);if(!wt.tweenStates)wt.pauseAnimate(!1);else if(n(Ct.all)||Ct.all){if(wt.pauseAnimate(!1),!wt.dynamicAnimation)for(It in Ct)It!="all"&&Ct[It]===!1&&wt.pauseAnimate(!0,It)}else{wt.pauseAnimate(!0);for(It in Ct)It!="all"&&Ct[It]&&wt.pauseAnimate(!1,It)}wt.type=="Sprite"&&(wt.paused=!0),wt.parent&&wt.parent.type=="Particles"&&wt.parent.emitter&&wt.parent.emitter.focusWarm&&(bt=wt.parent.emitter,St.indexOf(wt.parent.emitter)<0&&St.push(wt.parent.emitter))}if(St.length>0)for(t=0;t<St.length;t++)St[t].doWarm(St[t].focusWarm)}},300),j.zdf&&j.zdf.dispatchEvent("tabfocus");else{if(ve.pauseOnBlur)for(t=0;t<ve.pauseOnBlur.length;t++)wt=ve.pauseOnBlur[t],wt.pauseOnBlurPaused=wt.paused,wt.pause(!0);ve.pauseAnimateOnBlur&&ve.animatedObjects&&ve.pauseAnimate(!0,"pauseOnBlur"),j.zdf&&j.zdf.dispatchEvent("tabblur")}})};var ii=!1;ve=function(t){t.ZIMON={stringify:function(It,St){if(De("83.39"),n(It))return;if(!ii){dt&&tt("ZIMON - set ZIMONON=true before using ZIMON.stringify()");return}return It=t.copy(It),bt(It),JSON.stringify({obj:It,key:St,zimon:1,info:"https://zimjs.com/zimon/"});function bt(Ct,Xt,qt){if(!n(Ct))if(Array.isArray(Ct))t.loop(Ct,function(Nt,Ke){bt(Nt,Ct,Ke)});else if(Ct.constructor=={}.constructor)t.loop(Ct,function(Nt,Ke){bt(Ke,Ct,Nt)});else if(Ct.type){var At={zimon:Ct.type};Ct.arguments&&(At.args=Array.prototype.slice.call(Ct.arguments),bt(At.args)),Ct.type=="series"&&(At.args=Array.prototype.slice.call(Ct.array),bt(At.args)),St&&St[Ct.type]&&St[Ct.type].props&&(At.props=[],t.loop(St[Ct.type].props,function(Nt){At.props.push(Ct[Nt])})),Xt?Xt[qt]=At:It=At}else typeof Ct!="string"&&typeof Ct!="number"&&typeof Ct!="boolean"&&Ct!==null&&dt&&tt("ZIMON - potentially bad JSON value"+Ct)}},parse:function(It,St){if(De("83.39"),n(It))return;var bt=JSON.parse(It),Ct=bt.obj;return St=bt.key,qt(Ct),Ct;function Xt(At){try{return Function("return("+At+")")()}catch{return dt&&tt("ZIMON - bad function scope or name: "+At),null}}function qt(At,Nt,Ke){if(!n(At)){if(Array.isArray(At))t.loop(At,function(s,f){qt(s,At,f)});else if(n(At.zimon)&&At.constructor=={}.constructor)t.loop(At,function(s,f){qt(f,At,s)});else if(At.zimon){var e=At.zimon,r="";St&&(St[e]&&St[e].scope?r=St[e].scope+".":St.scope&&(r=St.scope+"."));var i=Xt(r+e),l=At.args;n(l)&&(l=[]),qt(l);var a;At.type=="series"?a=t.series(l):a=i?new(i.bind.apply(i,[null].concat(Array.prototype.slice.call(l)))):null,Nt?Nt[Ke]=a:Ct=a,St&&St[e]&&St[e].props&&a&&t.loop(St[e].props,function(s,f){n(At.props[f])||(a[s]=At.props[f])})}}}}},t.Wonder=function(It,St,bt,Ct,Xt){var qt="wid, client, app, notes, server",At;if(At=st(t.Wonder,arguments,qt,this))return At;if(De("82"),n(It)){tt("zim.Wonder() - please provide Wonder ID (see https://zimjs.com/wonder/)");return}n(Xt)&&(Xt="https://wonder.zimjs.org/wonder");var Nt=this;n(t.wonderSession)&&(t.wonderSession="W"+t.rand(1e5,999999));var Ke=[],e=setInterval(i,1e3),r=0;function i(){Ke.length>0&&(t.async(Xt+"?wonder="+JSON.stringify(Ke)),Ke=[],r++)}var l,a=setInterval(function(){r>28&&(Ke.push({id:It,c:St,a:bt,n:Ct,k:l,t:"e",v:"frequency max - terminated",s:t.wonderSession}),tt("zim.Wonder() - frequency max - terminated"),Nt.dispose()),r=0},30*1e3);this.countsOff={},this.timesOff={},this.ordersOff={};function s(w,T){return n(w)?(tt("zim.Wonder "+T+" - please provide a keyword"),!1):!Nt[T+"sOff"][w]}this.count=function(w){s(w,"count")&&(l=w,Ke.push({id:It,c:St,a:bt,n:Ct,k:w,t:"c",v:1,s:t.wonderSession}))};var f={};this.timeStart=function(w){s(w,"time")&&(Nt.timeEnd(w),l=w,f[w]=new Date().getTime())};var c={};this.timePause=function(w){s(w,"time")&&(c[w]||(c[w]=new Date().getTime()))},this.timeUnpause=function(w){if(s(w,"time")&&c[w]){var T=new Date().getTime()-c[w];f[w]&&(f[w]+=T),delete c[w]}},this.timeEnd=function(w){if(s(w,"time")&&f[w]){var T=c[w]?c[w]:new Date().getTime(),p=Math.round((T-f[w])/1e3);delete c[w],delete f[w],Ke.push({id:It,c:St,a:bt,n:Ct,k:w,t:"t",v:p,s:t.wonderSession})}},this.order=function(w,T){if(s(w,"order")){if(l=w,n(T)){tt("zim.Wonder order() - please provide an item");return}Ke.push({id:It,c:St,a:bt,n:Ct,k:w,t:"o",v:T,s:t.wonderSession})}},this.countOff=function(w){Nt.countsOff[w]=1},this.countOn=function(w){delete Nt.countOff[w]},this.timeOff=function(w){Nt.timesOff[w]=1},this.timeOn=function(w){delete Nt.timesOff[w]},this.orderOff=function(w){Nt.ordersOff[w]=1},this.orderOn=function(w){delete Nt.ordersOff[w]},this.dispose=function(){return i(),clearInterval(e),clearInterval(a),!0}},t.VERSION="015/zim",t.getLatestVersions=function(It){De("82.2");var St="https://zimjs.com/live/getLatestVersions.php";function bt(Ct){It(JSON.parse(Ct))}t.async(St,bt,"returnLatestVersions")},typeof Ne<"u"&&(t.PWA=function(It,St,bt,Ct,Xt,qt,At){var Nt="call, label, backgroundColor, color, backdropColor, pane, noScale",Ke;if(Ke=st(t.PWA,arguments,Nt,this))return Ke;De("82.4"),this.cjsEventDispatcher_constructor(),this.type="PWA";var e,r=this,i=j.M=="ios"?`In Safari, please add to
home screen as an app`:`Please add to
home screen as an app`;if(n(St)&&(St=new t.Label({text:i,align:t.LEFT,lineHeight:44,color:Ct})),n(bt)&&(bt=t.yellow),n(qt)){qt=new t.Pane({width:1200,height:230,content:St,backgroundColor:bt,backdropColor:Xt});var l=new t.Container;new t.Shape().s(t.dark).ss(3,1,0,3).p("AAAj0IAAFJAA8hoIBuAAIAAFdIlTAAIAAldIBuAA").sca(1.7).addTo(l),new t.Shape().s(t.dark).ss(3,1,0,3).p("AhGAlIBGhGIBHBG").sca(1.7).addTo(l).mov(0,-38);var a=new t.Tile([l,St],2,1,40,0,!0);a.width>zdf.stage.width*.7&&(a.width=zdf.stage.width*.7),a.setBounds(-70,-10,480,100),l.mov(-30,35),a.center(qt)}M&&!(j.matchMedia("(display-mode: standalone)").matches||j.navigator.standalone||document.referrer.includes("android-app://"))?s():(It&&It.constructor===Function&&It(),setTimeout(function(){r.dispatchEvent("ready")},20));function s(){r.pane=e=qt.show(),e.on("close",function(){It&&It.constructor===Function&&It(),r.scaleEvent&&f.off("resize",r.scaleEvent),r.dispatchEvent("ready"),j.zdf.stage.update()});var f=f||j.zdf;f&&!At&&(e.scaleTo(f.stage,105).center(),(f.scaling=="full"||f.scaling=="tag")&&(r.scaleEvent=f.on("resize",function(){e.scaleTo(f.stage,105).center()})),f.stage.update())}this.show=function(){return s(),this}},t.extend(t.PWA,Ne.EventDispatcher,null,"cjsEventDispatcher",!1)),t.QR=function(It,St,bt,Ct,Xt,qt){var At="url, color, backgroundColor, size, clickable, correctLevel",Nt;if(Nt=st(t.QR,arguments,At,this))return Nt;De("82.5"),n(It)&&(It="https://zimjs.com"),n(Ct)&&(Ct=256),n(St)&&(St=t.black),n(bt)&&(bt=t.white),n(Xt)&&(Xt=!0),n(qt)&&(qt=2);var Ke=document.createElement("div");if(typeof QRCode>"u"){tt("ZIM QR - needs qrcode.js library - see docs");return}var e=new QRCode(Ke,{text:It,width:Ct,height:Ct,colorDark:St,colorLight:bt,correctLevel:qt});this.zimBitmap_constructor(e._oDrawing._oContext.canvas),Xt&&this.cur().on("click",function(){nr(It,"_blank")}),Ke=null},t.extend(t.QR,t.Bitmap,null,"zimBitmap",!1),t.GIF=function(It,St,bt,Ct){var Xt="file, width, height, startPaused",qt;if(qt=st(t.GIF,arguments,Xt,this))return qt;if(De("82.7"),typeof gifler>"u"){tt("ZIM GIF - needs gifler.js library - see docs");return}n(St)&&(St=100),n(bt)&&(bt=100);var At=this;At.paused=!1,this.zimBitmap_constructor(null,St,bt),this.cache();var Nt,Ke,e;if(j.PATH!=null&&(t.PATH=j.PATH),It.match(/http/)||It.match(/^\//)?e=It:e=(t.PATH?t.PATH:"")+It,At.gifler=gifler(e).animate(this.cacheCanvas).then(function(a){At.animator=a,Ct&&(Nt=setInterval(function(){At.animator.running()&&(Ke=setTimeout(function(){At.animator.stop(),At.paused=!0},.1),clearInterval(Nt))},.05))}),!At.ticker)if(At.keyObj){var r=At.keyObj.color,i=At.keyObj.tolerance,l=At.keyObj.replacement;At.ticker=t.Ticker.add(function(){At.keyOut(r,i,l)})}else At.ticker=t.Ticker.add(function(){});At.keyOut=function(a,s,f){return At.ticker?(t.Ticker.remove(At.ticker),At.ticker=t.Ticker.add(function(){At.keyOut(a,s,f)})):At.keyObj={color:a,tolerance:s,replacement:f},At},this.pause=function(a){return n(a)&&(a=!0),At.animator&&(Nt&&clearInterval(Nt),Ke&&clearTimeout(Ke),a&&At.animator.running()?(At.animator.stop(),t.Ticker.remove(At.ticker)):!a&&!At.animator.running()&&(At.animator.start(),t.Ticker.add(At.ticker))),At.paused=a,At},this.stop=function(){At.dispose()},this.reset=function(){return At.animator.reset(),At.paused&&(At.animator.start(),t.Ticker.add(At.ticker)),At},this.clone=function(){return this.cloneProps(new t.GIF(It,St,bt,Ct))},this.dispose=function(){At.animator.stop(),At.parent&&At.removeFrom(),t.Ticker.remove(At.ticker),t.gD(this)}},t.extend(t.GIF,t.Bitmap,["clone","dispose","keyOut"],"zimBitmap",!1),t.Theme={set:function(It,St,bt,Ct,Xt){var qt="name, lightenRatio, tint, tintRatio, exclude",At;if(At=st(t.Theme.set,arguments,qt))return At;De("82.8"),n(It)&&(It="zim");var Nt=It.toLowerCase();n(St)&&(St=0),bt==-1&&(bt=null),n(Ct)&&(Ct=0),Xt==-1&&(Xt=null),!n(Xt)&&!Array.isArray(Xt)&&(Xt=[Xt]),t.THEME=window.THEME={name:Nt,lightenRatio:St,tint:bt,tintRatio:Ct,exclude:Xt};var Ke={},e,r=t.colors.slice(0,8),i=t.colors.slice(8,25);Nt=="zim"?t.loop(t.colors,function(l,a){l=="clear"||l=="faint"||(Ke[l]=t.colorsHex[a])}):Nt=="html"?(t.loop(r,function(l){Ke[l]=l}),t.loop(i,function(l,a){Ke[l]=t.colorsHex[a+8]})):Nt=="future"?(e=["f25019","fd8918","ffc955","1dcfae","00a5ab","007175","00969b","d6b361"],t.loop(r,function(l,a){Ke[l]="#"+e[a]}),t.loop(i,function(l,a){Ke[l]=t.colorsHex[a+8].toColor("#1dcfae",.4-a*.025)})):Nt=="invert"?(Ke={},t.loop(t.colorsHex,function(l,a,s){if(a==s-2)return 1;Ke[t.colors[a]]=t.invertColor(l)})):Nt=="greyscale"?(e=["222222","aaaaaa","dddddd","888888","333333","111111","777777","bbbbbb"],t.loop(r,function(l,a){Ke[l]="#"+e[a]})):Nt=="neon"?(e=["FF3624","ff6f00","e2f705","a3f307","05f9e2","ED0AF5","ff33c9","e16d00"],t.loop(r,function(l,a){Ke[l]="#"+e[a]}),t.loop(i,function(l,a){Ke[l]=t.colorsHex[a+8].toColor("#000",.9)}),Ke.light=t.lighter,Ke.moon=t.lighter,Ke.lighter=t.white,Ke.white=t.white):Nt=="seventies"?(e=["e5771e","f4a127","ffecb4","6F8212","75c8ae","5a3d2b","956e4e","4c3607"],t.loop(r,function(l,a){Ke[l]="#"+e[a]}),t.loop(i,function(l,a){Ke[l]=t.colorsHex[a+8].toColor(a<8?"#344f00":"#f4a127",.8-a*.04)})):Nt=="warm"?(e=["965746","c07768","ffecb4","8da279","6da0b1","745c58","9a7e79","be8858"],t.loop(r,function(l,a){Ke[l]="#"+e[a]}),t.loop(i,function(l,a){Ke[l]=t.colorsHex[a+8].toColor(a<8?"#4e352e":"#745c58",.8-a*.05)})):Nt.constructor=={}.constructor&&(Ke=Nt,t.loop(Ke,function(l){t.colors.indexOf(l)==-1&&delete Ke[l]})),t.loop(Xt,function(l){l.toLowerCase()=="colors"?t.loop(t.colors,function(a,s){if(s>=8)return 1;Xt.push(a)}):(l.toLowerCase()=="greys"||l.toLowerCase()=="grays")&&t.loop(t.colors,function(a,s){s<8||Xt.push(a)})}),t.loop(Ke,function(l,a){Xt&&Xt.indexOf(l)!=-1||(bt&&(a=a.toColor(bt,Ct)),St!=0&&(a=a.lighten(St)),Pt||(window[l]=a),t[l]=a)})},apply:function(It,St,bt,Ct,Xt){var qt="name, lightenRatio, tint, tintRatio, exclude",At;if(At=st(t.Theme.apply,arguments,qt))return At;if(localStorage){n(It)&&(It="zim");var Nt=It.toLowerCase();n(St)&&(St=0),n(bt)&&(bt=-1),n(Ct)&&(Ct=0),n(Xt)?Xt=-1:Array.isArray(Xt)||(Xt=[Xt]),localStorage.setItem(wt,JSON.stringify({name:Nt,lightenRatio:St,tint:bt,tintRatio:Ct,exclude:Xt})),window.location.reload()}else tt("ZIM applyTheme() - needs localStorage")},clear:function(){localStorage&&localStorage.getItem(wt)&&localStorage.removeItem(wt),window.location.reload()}};var wt=window.location.href.replace(/[.\/:]/g,"");return localStorage&&localStorage.getItem(wt)?(t.THEME=window.THEME=JSON.parse(localStorage.getItem(wt)),t.Theme.set(or.name,or.lightenRatio,or.tint,or.tintRatio,or.exclude)):t.THEME=window.THEME=null,t}(ve||{});var Hr=[["zog",Gn],["zid",wn],["zss",vi],["zgo",nr],["zum",Qn],["zot",n],["zop",yi],["zil",Yr],["zet",fr],["zob",st],["zik",nt],["zta",xi],["zor",wi],["zogg",ti],["zogp",gi],["zogb",Rr],["zogr",ni],["zogy",tt],["zogo",ri],["zogl",Ar],["zogd",kr],["zimplify",mi],["zimify",Vn]];for(cn=0;cn<Hr.length;cn++)qn=Hr[cn],j[qn[0]]=ve[qn[0]]=qn[1];var qn,Jr=[["FIT",ve.FIT],["FILL",ve.FILL],["FULL",ve.FULL],["LEFT",ve.LEFT],["RIGHT",ve.RIGHT],["CENTER",ve.CENTER],["MIDDLE",ve.MIDDLE],["START",ve.START],["END",ve.END],["TOP",ve.TOP],["BOTTOM",ve.BOTTOM],["OVER",ve.OVER],["UNDER",ve.UNDER],["HORIZONTAL",ve.HORIZONTAL],["VERTICAL",ve.VERTICAL],["BOTH",ve.BOTH],["RADIAL",ve.RADIAL],["UP",ve.UP],["DOWN",ve.DOWN],["NEXT",ve.NEXT],["PREV",ve.PREV],["AUTO",ve.AUTO],["AVE",ve.AVE],["DEFAULT",ve.DEFAULT],["ALL",ve.ALL],["NONE",ve.NONE],["GET",ve.GET],["POST",ve.POST],["LOCALSTORAGE",ve.LOCALSTORAGE],["SOCKET",ve.SOCKET],["TO",ve.TO],["FROM",ve.FROM],["SINE",ve.SINE],["SQUARE",ve.SQUARE],["TRIANGLE",ve.TRIANGLE],["SAW",ve.SAW],["SAWTOOTH",ve.SAWTOOTH],["ZAP",ve.ZAP],["TAU",ve.TAU],["DEG",ve.DEG],["RAD",ve.RAD],["PHI",ve.PHI]];for(cn=0;cn<Jr.length;cn++)qn=Jr[cn],j[qn[0]]=qn[1];var qn;for(cn=0;cn<ve.colors.length;cn++)j[ve.colors[cn]]=ve.colorsHex[cn];j.zim=ve;var Ei=ve;var Pi=ve.chop,Mi=ve.shuffle,Ii=ve.pluck,Oi=ve.rand,Si=ve.seedRandom,bi=ve.odds,Li=ve.rarity,Bi=ve.repeats,Di=ve.series,Ri=ve.loop,Yi=ve.getTIME,$r=ve.timeout,Ti=ve.interval,_i=ve.async,Xi=ve.couple,Ni=ve.decouple,Fi=ve.convertColor,Gi=ve.colorRange,Vi=ve.lighten,Wi=ve.darken,Ui=ve.toColor,Qi=ve.toAlpha,qi=ve.toBW,Zi=ve.invertColor,Ki=ve.zimEase,Hi=ve.spline,Ji=ve.pointAlongCurve,$i=ve.distanceAlongCurve,ji=ve.closestPointAlongCurve,zi=ve.transformPoints,el=ve.trimEndPoints,tl=ve.reversePoints,nl=ve.appendPoints,rl=ve.prependPoints,il=ve.splitPoints,ll=ve.makeID,al=ve.makeSyllable,sl=ve.makePrimitive,ol=ve.makeMath,fl=ve.swapProperties,ul=ve.mobile,cl=ve.vee,dl=ve.extend,hl=ve.copy,pl=ve.merge,gl=ve.sortObject,vl=ve.arraysEqual,yl=ve.arrayMinMax,xl=ve.isEmpty,wl=ve.isJSON,Cl=ve.isPick,ml=ve.decimals,Tl=ve.countDecimals,Al=ve.sign,kl=ve.constrain,El=ve.dist,Pl=ve.rectIntersect,Ml=ve.boundsAroundPoints,Il=ve.angle,Ol=ve.smoothStep,Sl=ve.unicodeToUTF,bl=ve.capitalizeFirst,Ll=ve.Ajax,Bl=ve.Noise,Dl=ve.Point,Rl=ve.Bezier,Yl=ve.Boundary,_l=ve.GradientColor,Xl=ve.RadialColor,Nl=ve.BitmapColor,Fl=ve.Damp,Gl=ve.Proportion,Vl=ve.ProportionDamp,Wl=ve.Dictionary,Ul=ve.Hierarchy,Ql=ve.Pick,ql=ve.scrollX,Zl=ve.scrollY,Kl=ve.windowWidth,Hl=ve.windowHeight,Jl=ve.browserZoom,$l=ve.getQueryString,jl=ve.swapHTML,zl=ve.urlEncode,ea=ve.urlDecode,ta=ve.setCookie,na=ve.getCookie,ra=ve.deleteCookie,ia=ve.Stage,la=ve.StageGL,jr=ve.Container,aa=ve.Shape,sa=ve.Bitmap,oa=ve.Sprite,fa=ve.MovieClip,ua=ve.SVGContainer,ca=ve.CustomShape,da=ve.Circle,Sn=ve.Rectangle,ha=ve.Triangle,pa=ve.Poly,ga=ve.Line,va=ve.Squiggle;var ya=ve.Flare,xa=ve.MultiFlare,wa=ve.FlareBox,zr=ve.Label,Ca=ve.LabelOnPath,ma=ve.LabelOnArc,Ta=ve.LabelLetters,Aa=ve.Emoji,ka=ve.Button,Ea=ve.CheckBox,Pa=ve.RadioButtons,Ma=ve.Toggle,Ia=ve.Tip,Oa=ve.Pane,Sa=ve.Panel;var ba=ve.Page,La=ve.Central,Ba=ve.Layer,Da=ve.Waiter,Ra=ve.ProgressBar,Ya=ve.Indicator,_a=ve.TextInput,Xa=ve.List,Na=ve.Stepper,Fa=ve.Slider,Ga=ve.Selector,Va=ve.Dial,Wa=ve.Tabs,Ua=ve.Pad,Qa=ve.NumPad,qa=ve.DPad,Za=ve.Radial,Ka=ve.RadialMenu,Ha=ve.ColorPicker,Ja=ve.EmojiPicker,$a=ve.TextEditor,ja=ve.Keyboard,za=ve.Organizer,es=ve.Connectors,ts=ve.Marquee,ns=ve.Carousel,rs=ve.Loader,is=ve.TextArea,ls=ve.Tag,as=ve.localToGlobal,ss=ve.globalToLocal,os=ve.localToLocal,fs=ve.addTo,us=ve.removeFrom,cs=ve.added,ds=ve.centerReg,hs=ve.center,ps=ve.place,gs=ve.placeReg,vs=ve.pos,ys=ve.loc,xs=ve.mov,ws=ve.sca,Cs=ve.alp,ms=ve.vis,Ts=ve.ble,As=ve.dye,ks=ve.hov,Es=ve.rot,Ps=ve.siz,Ms=ve.ske,Is=ve.reg,Os=ve.top,Ss=ve.bot,bs=ve.ord,Ls=ve.cur,Bs=ve.sha,Ds=ve.dep,Rs=ve.nam,Ys=ve.movement,_s=ve.noMovement,Xs=ve.tap,Ns=ve.noTap,Fs=ve.hold,Gs=ve.noHold,Vs=ve.change,Ws=ve.noChange,Us=ve.drag,Qs=ve.noDrag,qs=ve.dragBoundary,Zs=ve.mouse,Ks=ve.noMouse,Hs=ve.wire,Js=ve.noWire,$s=ve.wired,js=ve.noWired,zs=ve.bind,eo=ve.noBind,to=ve.transform,no=ve.gesture,ro=ve.noGesture,io=ve.gestureBoundary,lo=ve.effect,ao=ve.updateEffects,so=ve.noEffect,oo=ve.addPhysics,fo=ve.removePhysics,uo=ve.hitTestPoint,co=ve.hitTestReg,ho=ve.hitTestRect,po=ve.hitTestCircle,go=ve.hitTestCircleRect,vo=ve.hitTestCircles,yo=ve.hitTestBounds,xo=ve.hitTestPath,wo=ve.hitTestGrid,Co=ve.animate,mo=ve.stopAnimate,To=ve.pauseAnimate,Ao=ve.wiggle,ko=ve.scaleTo,Eo=ve.fit,Po=ve.boundsToGlobal,Mo=ve.resetBounds,Io=ve.copyMatrix,Oo=ve.duplicate,So=ve.expand,bo=ve.setSwipe,Lo=ve.setMask,Bo=ve.outline,Do=ve.blendmodes,Ro=ve.Pages,Yo=ve.Arrow,_o=ve.HotSpots,Xo=ve.HotSpot,No=ve.Guide,Fo=ve.Grid,Go=ve.Wrapper,ei=ve.Tile,Vo=ve.Pack,Wo=ve.Beads,Uo=ve.Layout,Qo=ve.Accessibility,qo=ve.TextureActive,Zo=ve.TextureActives,Ko=ve.TextureActivesManager,Ho=ve.Manager,Jo=ve.ResizeManager,$o=ve.TransformManager,jo=ve.GuideManager,zo=ve.GridManager,ef=ve.LayoutManager,tf=ve.SelectionSet,nf=ve.SelectionManager,rf=ve.Bind,lf=ve.Swipe,af=ve.Swiper,sf=ve.MotionController,of=ve.GamePad,ff=ve.Portal,uf=ve.Physics,cf=ve.TimeLine,df=ve.BlurEffect,hf=ve.GlowEffect,pf=ve.ShadowEffect,gf=ve.ColorEffect,vf=ve.MultiEffect,yf=ve.AlphaEffect,xf=ve.Pixel,wf=ve.Parallax,Cf=ve.Flipper,mf=ve.Book,Tf=ve.Scrambler,Af=ve.Scroller,kf=ve.Dynamo,Ef=ve.Accelerator,Pf=ve.Emitter,Mf=ve.Generator,If=ve.Pen,Of=ve.SoundWave,Sf=ve.Synth,bf=ve.VR,Lf=ve.Frame,Bf=ve.Pic,Df=ve.Aud,Rf=ve.Vid,Yf=ve.SVG,_f=ve.SensorAsk,Xf=ve.distill,Nf=ve.parseAudioSprite,Ff=ve.previewAudioSprite,Gf=ve.svgToBitmap,Vf=ve.makeContent,Wf=ve.fastFrame,Uf=ve.addWires,Qf=ve.setBlurDetect,qf=ve.Wonder,Zf=ve.getLatestVersions,Kf=ve.PWA,Hf=ve.QR,Jf=ve.GIF,or=ve.THEME;export{Ef as Accelerator,Qo as Accessibility,Ll as Ajax,yf as AlphaEffect,Yo as Arrow,Df as Aud,Wo as Beads,Rl as Bezier,rf as Bind,sa as Bitmap,Nl as BitmapColor,hi as Blob,df as BlurEffect,mf as Book,Yl as Boundary,ka as Button,ns as Carousel,La as Central,Ea as CheckBox,da as Circle,gf as ColorEffect,Ha as ColorPicker,es as Connectors,jr as Container,ca as CustomShape,qa as DPad,Fl as Damp,Va as Dial,Wl as Dictionary,kf as Dynamo,Pf as Emitter,Aa as Emoji,Ja as EmojiPicker,ya as Flare,wa as FlareBox,Cf as Flipper,Lf as Frame,Jf as GIF,of as GamePad,Mf as Generator,hf as GlowEffect,_l as GradientColor,Fo as Grid,zo as GridManager,No as Guide,jo as GuideManager,Ul as Hierarchy,Xo as HotSpot,_o as HotSpots,Ya as Indicator,ja as Keyboard,zr as Label,Ta as LabelLetters,ma as LabelOnArc,Ca as LabelOnPath,Ba as Layer,Uo as Layout,ef as LayoutManager,ga as Line,Xa as List,rs as Loader,Ho as Manager,ts as Marquee,sf as MotionController,fa as MovieClip,vf as MultiEffect,xa as MultiFlare,Bl as Noise,Qa as NumPad,za as Organizer,Kf as PWA,Vo as Pack,Ua as Pad,ba as Page,Ro as Pages,Oa as Pane,Sa as Panel,wf as Parallax,If as Pen,uf as Physics,Bf as Pic,Ql as Pick,xf as Pixel,Dl as Point,pa as Poly,ff as Portal,Ra as ProgressBar,Gl as Proportion,Vl as ProportionDamp,Hf as QR,Za as Radial,Xl as RadialColor,Ka as RadialMenu,Pa as RadioButtons,Sn as Rectangle,Jo as ResizeManager,Yf as SVG,ua as SVGContainer,Tf as Scrambler,Af as Scroller,nf as SelectionManager,tf as SelectionSet,Ga as Selector,_f as SensorAsk,pf as ShadowEffect,aa as Shape,Fa as Slider,Of as SoundWave,oa as Sprite,va as Squiggle,ia as Stage,la as StageGL,Na as Stepper,lf as Swipe,af as Swiper,Sf as Synth,or as THEME,Wa as Tabs,ls as Tag,is as TextArea,$a as TextEditor,_a as TextInput,qo as TextureActive,Zo as TextureActives,Ko as TextureActivesManager,ei as Tile,cf as TimeLine,Ia as Tip,Ma as Toggle,$o as TransformManager,ha as Triangle,bf as VR,Rf as Vid,Da as Waiter,pi as Window,qf as Wonder,Go as Wrapper,oo as addPhysics,fs as addTo,Uf as addWires,cs as added,Cs as alp,Il as angle,Co as animate,nl as appendPoints,yl as arrayMinMax,vl as arraysEqual,_i as async,zs as bind,Ts as ble,Do as blendmodes,Ss as bot,Ml as boundsAroundPoints,Po as boundsToGlobal,Jl as browserZoom,bl as capitalizeFirst,hs as center,ds as centerReg,Vs as change,Pi as chop,ji as closestPointAlongCurve,Gi as colorRange,kl as constrain,Fi as convertColor,hl as copy,Io as copyMatrix,Tl as countDecimals,Xi as couple,Ls as cur,Wi as darken,ml as decimals,Ni as decouple,Ei as default,ra as deleteCookie,Ds as dep,El as dist,$i as distanceAlongCurve,Xf as distill,Us as drag,qs as dragBoundary,Oo as duplicate,As as dye,lo as effect,So as expand,dl as extend,Wf as fastFrame,Eo as fit,no as gesture,io as gestureBoundary,na as getCookie,Zf as getLatestVersions,$l as getQueryString,Yi as getTIME,ss as globalToLocal,yo as hitTestBounds,po as hitTestCircle,go as hitTestCircleRect,vo as hitTestCircles,wo as hitTestGrid,xo as hitTestPath,uo as hitTestPoint,ho as hitTestRect,co as hitTestReg,Fs as hold,ks as hov,Ti as interval,Zi as invertColor,xl as isEmpty,wl as isJSON,Cl as isPick,Vi as lighten,ys as loc,as as localToGlobal,os as localToLocal,Ri as loop,Vf as makeContent,ll as makeID,ol as makeMath,sl as makePrimitive,al as makeSyllable,pl as merge,ul as mobile,Zs as mouse,xs as mov,Ys as movement,Rs as nam,eo as noBind,Ws as noChange,Qs as noDrag,so as noEffect,ro as noGesture,Gs as noHold,Ks as noMouse,_s as noMovement,Ns as noTap,Js as noWire,js as noWired,bi as odds,bs as ord,Bo as outline,Nf as parseAudioSprite,To as pauseAnimate,ps as place,gs as placeReg,Ii as pluck,Ji as pointAlongCurve,vs as pos,rl as prependPoints,Ff as previewAudioSprite,Oi as rand,Li as rarity,Pl as rectIntersect,Is as reg,us as removeFrom,fo as removePhysics,Bi as repeats,Mo as resetBounds,tl as reversePoints,Es as rot,ws as sca,ko as scaleTo,ql as scrollX,Zl as scrollY,Si as seedRandom,Di as series,Qf as setBlurDetect,ta as setCookie,Lo as setMask,bo as setSwipe,Bs as sha,Mi as shuffle,Al as sign,Ps as siz,Ms as ske,Ol as smoothStep,gl as sortObject,Hi as spline,il as splitPoints,mo as stopAnimate,Gf as svgToBitmap,jl as swapHTML,fl as swapProperties,Xs as tap,$r as timeout,Qi as toAlpha,qi as toBW,Ui as toColor,Os as top,to as transform,zi as transformPoints,el as trimEndPoints,Sl as unicodeToUTF,ao as updateEffects,ea as urlDecode,zl as urlEncode,cl as vee,ms as vis,Ao as wiggle,Hl as windowHeight,Kl as windowWidth,Hs as wire,$s as wired,Ki as zimEase,Vn as zimify,mi as zimplify};
/*! ZIM - JavaScript Canvas Framework - Code Creativity
https://zimjs.com (c) 2023 modified MIT License
Donations welcome https://zimjs.com/donate
Node module - also see ES6 modules at https://zimjs.com/cdn
*/
