(()=>{var mi=Object.create;var zr=Object.defineProperty;var xi=Object.getOwnPropertyDescriptor;var wi=Object.getOwnPropertyNames;var _i=Object.getPrototypeOf,Ti=Object.prototype.hasOwnProperty;var Ci=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(v,a)=>(typeof require<"u"?require:v)[a]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var Ai=(e,v)=>()=>(v||e((v={exports:{}}).exports,v),v.exports);var Ei=(e,v,a,u)=>{if(v&&typeof v=="object"||typeof v=="function")for(let c of wi(v))!Ti.call(e,c)&&c!==a&&zr(e,c,{get:()=>v[c],enumerable:!(u=xi(v,c))||u.enumerable});return e};var bi=(e,v,a)=>(a=e!=null?mi(_i(e)):{},Ei(v||!e||!e.__esModule?zr(a,"default",{value:e,enumerable:!0}):a,e));var ei=Ai((Rn,cr)=>{var ne=ne||{};ne.stageTransformable=!0,ne.extend=function(e,v){"use strict";function a(){this.constructor=e}return a.prototype=v.prototype,e.prototype=new a},ne.promote=function(e,v){"use strict";var a=e.prototype,u=Object.getPrototypeOf&&Object.getPrototypeOf(a)||a.__proto__;if(u)for(var c in a[(v+="_")+"constructor"]=u.constructor,u)a.hasOwnProperty(c)&&typeof u[c]=="function"&&(a[v+c]=u[c]);return e},ne.indexOf=function(e,v){"use strict";for(var a=0,u=e.length;a<u;a++)if(v===e[a])return a;return-1},function(){"use strict";function e(){throw"UID cannot be instantiated"}e._nextID=0,e.get=function(){return e._nextID++},ne.UID=e}(),ne.deprecate=function(e,v){"use strict";return function(){var a="Deprecated property or method '"+v+"'. See docs for info.";return console&&(console.warn?console.warn(a):console.log(a)),e&&e.apply(this,arguments)}},function(){"use strict";function e(a,u,c){this.type=a,this.target=null,this.currentTarget=null,this.eventPhase=0,this.bubbles=!!u,this.cancelable=!!c,this.timeStamp=new Date().getTime(),this.defaultPrevented=!1,this.propagationStopped=!1,this.immediatePropagationStopped=!1,this.removed=!1}var v=e.prototype;v.preventDefault=function(){this.defaultPrevented=this.cancelable&&!0},v.stopPropagation=function(){this.propagationStopped=!0},v.stopImmediatePropagation=function(){this.immediatePropagationStopped=this.propagationStopped=!0},v.remove=function(){this.removed=!0},v.clone=function(){return new e(this.type,this.bubbles,this.cancelable)},v.set=function(a){for(var u in a)this[u]=a[u];return this},v.toString=function(){return"[Event (type="+this.type+")]"},ne.Event=e}(),function(){"use strict";function e(){this._listeners=null,this._captureListeners=null}var v=e.prototype;e.initialize=function(a){a.addEventListener=v.addEventListener,a.on=v.on,a.removeEventListener=a.off=v.removeEventListener,a.removeAllEventListeners=v.removeAllEventListeners,a.hasEventListener=v.hasEventListener,a.dispatchEvent=v.dispatchEvent,a._dispatchEvent=v._dispatchEvent,a.willTrigger=v.willTrigger},v.addEventListener=function(a,u,c){var x=c?this._captureListeners=this._captureListeners||{}:this._listeners=this._listeners||{},N=x[a];return N&&this.removeEventListener(a,u,c),(N=x[a])?N.push(u):x[a]=[u],u},v.on=function(a,u,c,x,N,z){return u.handleEvent&&(c=c||u,u=u.handleEvent),c=c||this,this.addEventListener(a,function(oe){u.call(c,oe,N),x&&oe.remove()},z)},v.removeEventListener=function(a,u,c){var x=c?this._captureListeners:this._listeners;if(x){var N=x[a];if(N){for(var z=0,oe=N.length;z<oe;z++)if(N[z]==u){oe==1?delete x[a]:N.splice(z,1);break}}}},v.off=v.removeEventListener,v.removeAllEventListeners=function(a){a?(this._listeners&&delete this._listeners[a],this._captureListeners&&delete this._captureListeners[a]):this._listeners=this._captureListeners=null},v.dispatchEvent=function(a,u,c){if(typeof a=="string"){var x=this._listeners;if(!(u||x&&x[a]))return!0;a=new ne.Event(a,u,c)}else a.target&&a.clone&&(a=a.clone());try{a.target=this}catch(ke){}if(a.bubbles&&this.parent){for(var N=this,z=[N];N.parent;)z.push(N=N.parent);for(var oe=z.length,Ee=oe-1;0<=Ee&&!a.propagationStopped;Ee--)z[Ee]._dispatchEvent(a,1+(Ee==0));for(Ee=1;Ee<oe&&!a.propagationStopped;Ee++)z[Ee]._dispatchEvent(a,3)}else this._dispatchEvent(a,2);return!a.defaultPrevented},v.hasEventListener=function(a){var u=this._listeners,c=this._captureListeners;return!!(u&&u[a]||c&&c[a])},v.willTrigger=function(a){for(var u=this;u;){if(u.hasEventListener(a))return!0;u=u.parent}return!1},v.toString=function(){return"[EventDispatcher]"},v._dispatchEvent=function(a,u){var c,x,N=u<=2?this._captureListeners:this._listeners;if(a&&N&&(x=N[a.type])&&(c=x.length)){try{a.currentTarget=this}catch(Ee){}try{a.eventPhase=0|u}catch(Ee){}a.removed=!1,x=x.slice();for(var z=0;z<c&&!a.immediatePropagationStopped;z++){var oe=x[z];oe.handleEvent?oe.handleEvent(a):oe(a),a.removed&&(this.off(a.type,oe,u==1),a.removed=!1)}}u===2&&this._dispatchEvent(a,2.1)},ne.EventDispatcher=e}(),function(){"use strict";function e(){throw"Ticker cannot be instantiated."}e.RAF_SYNCHED="synched",e.RAF="raf",e.TIMEOUT="timeout",e.timingMode=null,e.maxDelta=0,e.paused=!1,e.removeEventListener=null,e.removeAllEventListeners=null,e.dispatchEvent=null,e.hasEventListener=null,e._listeners=null,ne.EventDispatcher.initialize(e),e._addEventListener=e.addEventListener,e.addEventListener=function(){return e._inited||e.init(),e._addEventListener.apply(e,arguments)},e._inited=!1,e._startTime=0,e._pausedTime=0,e._ticks=0,e._pausedTicks=0,e._interval=50,e._lastTime=0,e._times=null,e._tickTimes=null,e._timerId=null,e._raf=!0,e._setInterval=function(u){e._interval=u,e._inited&&e._setupTick()},e.setInterval=ne.deprecate(e._setInterval,"Ticker.setInterval"),e._getInterval=function(){return e._interval},e.getInterval=ne.deprecate(e._getInterval,"Ticker.getInterval"),e._setFPS=function(u){e._setInterval(1e3/u)},e.setFPS=ne.deprecate(e._setFPS,"Ticker.setFPS"),e._getFPS=function(){return 1e3/e._interval},e.getFPS=ne.deprecate(e._getFPS,"Ticker.getFPS");try{Object.defineProperties(e,{interval:{get:e._getInterval,set:e._setInterval},framerate:{get:e._getFPS,set:e._setFPS}})}catch(u){console.log(u)}e.init=function(){e._inited||(e._inited=!0,e._times=[],e._tickTimes=[],e._startTime=e._getTime(),e._times.push(e._lastTime=0),e.interval=e._interval)},e.reset=function(){var u;e._raf?(u=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame)&&u(e._timerId):clearTimeout(e._timerId),e.removeAllEventListeners("tick"),e._timerId=e._times=e._tickTimes=null,e._startTime=e._lastTime=e._ticks=e._pausedTime=0,e._inited=!1},e.getMeasuredTickTime=function(u){var c=0,x=e._tickTimes;if(!x||x.length<1)return-1;u=Math.min(x.length,u||0|e._getFPS());for(var N=0;N<u;N++)c+=x[N];return c/u},e.getMeasuredFPS=function(u){var c=e._times;return!c||c.length<2?-1:(u=Math.min(c.length-1,u||0|e._getFPS()),1e3/((c[0]-c[u])/u))},e.getTime=function(u){return e._startTime?e._getTime()-(u?e._pausedTime:0):-1},e.getEventTime=function(u){return e._startTime?(e._lastTime||e._startTime)-(u?e._pausedTime:0):-1},e.getTicks=function(u){return e._ticks-(u?e._pausedTicks:0)},e._handleSynch=function(){e._timerId=null,e._setupTick(),e._getTime()-e._lastTime>=.97*(e._interval-1)&&e._tick()},e._handleRAF=function(){e._timerId=null,e._setupTick(),e._tick()},e._handleTimeout=function(){e._timerId=null,e._setupTick(),e._tick()},e._setupTick=function(){if(e._timerId==null){var u=e.timingMode;if(u==e.RAF_SYNCHED||u==e.RAF){var c=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame;if(c)return e._timerId=c(u==e.RAF?e._handleRAF:e._handleSynch),void(e._raf=!0)}e._raf=!1,e._timerId=setTimeout(e._handleTimeout,e._interval)}},e._tick=function(){var u,c,x=e.paused,N=e._getTime(),z=N-e._lastTime;for(e._lastTime=N,e._ticks++,x&&(e._pausedTicks++,e._pausedTime+=z),e.hasEventListener("tick")&&(u=new ne.Event("tick"),c=e.maxDelta,u.delta=c&&c<z?c:z,u.paused=x,u.time=N,u.runTime=N-e._pausedTime,e.dispatchEvent(u)),e._tickTimes.unshift(e._getTime()-N);100<e._tickTimes.length;)e._tickTimes.pop();for(e._times.unshift(N);100<e._times.length;)e._times.pop()};var v=window,a=v.performance.now||v.performance.mozNow||v.performance.msNow||v.performance.oNow||v.performance.webkitNow;e._getTime=function(){return(a&&a.call(v.performance)||new Date().getTime())-e._startTime},ne.Ticker=e}(),function(){"use strict";function e(a){this.readyState=a.readyState,this._video=a,this._canvas=null,this._lastTime=-1,this.readyState<2&&a.addEventListener("canplaythrough",this._videoReady.bind(this))}var v=e.prototype;v.getImage=function(){if(!(this.readyState<2)){var a,u=this._canvas,c=this._video;return u||((u=this._canvas=ne.createCanvas?ne.createCanvas():document.createElement("canvas")).width=c.videoWidth,u.height=c.videoHeight),2<=c.readyState&&c.currentTime!==this._lastTime&&((a=u.getContext("2d")).clearRect(0,0,u.width,u.height),a.drawImage(c,0,0,u.width,u.height),this._lastTime=c.currentTime),u}},v._videoReady=function(){this.readyState=2},ne.VideoBuffer=e}(),function(){"use strict";function e(a,u,c,x,N,z,oe,Ee,ke,t,r){this.Event_constructor(a,u,c),this.stageX=x,this.stageY=N,this.rawX=ke==null?x:ke,this.rawY=t==null?N:t,this.nativeEvent=z,this.pointerID=oe,this.primary=!!Ee,this.relatedTarget=r}var v=ne.extend(e,ne.Event);v._get_localX=function(){return this.currentTarget.globalToLocal(this.rawX,this.rawY).x},v._get_localY=function(){return this.currentTarget.globalToLocal(this.rawX,this.rawY).y},v._get_isTouch=function(){return this.pointerID!==-1};try{Object.defineProperties(v,{localX:{get:v._get_localX},localY:{get:v._get_localY},isTouch:{get:v._get_isTouch}})}catch(a){}v.clone=function(){return new e(this.type,this.bubbles,this.cancelable,this.stageX,this.stageY,this.nativeEvent,this.pointerID,this.primary,this.rawX,this.rawY)},v.toString=function(){return"[MouseEvent (type="+this.type+" stageX="+this.stageX+" stageY="+this.stageY+")]"},ne.MouseEvent=ne.promote(e,"Event")}(),function(){"use strict";function e(a,u,c,x,N,z){this.setValues(a,u,c,x,N,z)}var v=e.prototype;e.DEG_TO_RAD=Math.PI/180,e.identity=null,v.setValues=function(a,u,c,x,N,z){return this.a=a==null?1:a,this.b=u||0,this.c=c||0,this.d=x==null?1:x,this.tx=N||0,this.ty=z||0,this},v.append=function(a,u,c,x,N,z){var oe=this.a,Ee=this.b,ke=this.c,t=this.d;return a==1&&u==0&&c==0&&x==1||(this.a=oe*a+ke*u,this.b=Ee*a+t*u,this.c=oe*c+ke*x,this.d=Ee*c+t*x),this.tx=oe*N+ke*z+this.tx,this.ty=Ee*N+t*z+this.ty,this},v.prepend=function(a,u,c,x,N,z){var oe=this.a,Ee=this.c,ke=this.tx;return this.a=a*oe+c*this.b,this.b=u*oe+x*this.b,this.c=a*Ee+c*this.d,this.d=u*Ee+x*this.d,this.tx=a*ke+c*this.ty+N,this.ty=u*ke+x*this.ty+z,this},v.appendMatrix=function(a){return this.append(a.a,a.b,a.c,a.d,a.tx,a.ty)},v.prependMatrix=function(a){return this.prepend(a.a,a.b,a.c,a.d,a.tx,a.ty)},v.appendTransform=function(a,u,c,x,N,z,oe,Ee,ke){var t,r=N%360?(r=N*e.DEG_TO_RAD,t=Math.cos(r),Math.sin(r)):(t=1,0);return z||oe?(z*=e.DEG_TO_RAD,oe*=e.DEG_TO_RAD,this.append(Math.cos(oe),Math.sin(oe),-Math.sin(z),Math.cos(z),a,u),this.append(t*c,r*c,-r*x,t*x,0,0)):this.append(t*c,r*c,-r*x,t*x,a,u),(Ee||ke)&&(this.tx-=Ee*this.a+ke*this.c,this.ty-=Ee*this.b+ke*this.d),this},v.prependTransform=function(a,u,c,x,N,z,oe,Ee,ke){var t,r=N%360?(r=N*e.DEG_TO_RAD,t=Math.cos(r),Math.sin(r)):(t=1,0);return(Ee||ke)&&(this.tx-=Ee,this.ty-=ke),z||oe?(z*=e.DEG_TO_RAD,oe*=e.DEG_TO_RAD,this.prepend(t*c,r*c,-r*x,t*x,0,0),this.prepend(Math.cos(oe),Math.sin(oe),-Math.sin(z),Math.cos(z),a,u)):this.prepend(t*c,r*c,-r*x,t*x,a,u),this},v.rotate=function(N){N*=e.DEG_TO_RAD;var u=Math.cos(N),c=Math.sin(N),x=this.a,N=this.b;return this.a=x*u+this.c*c,this.b=N*u+this.d*c,this.c=-x*c+this.c*u,this.d=-N*c+this.d*u,this},v.skew=function(a,u){return a*=e.DEG_TO_RAD,u*=e.DEG_TO_RAD,this.append(Math.cos(u),Math.sin(u),-Math.sin(a),Math.cos(a),0,0),this},v.scale=function(a,u){return this.a*=a,this.b*=a,this.c*=u,this.d*=u,this},v.translate=function(a,u){return this.tx+=this.a*a+this.c*u,this.ty+=this.b*a+this.d*u,this},v.identity=function(){return this.a=this.d=1,this.b=this.c=this.tx=this.ty=0,this},v.invert=function(){var a=this.a,u=this.b,c=this.c,x=this.d,N=this.tx,z=a*x-u*c;return this.a=x/z,this.b=-u/z,this.c=-c/z,this.d=a/z,this.tx=(c*this.ty-x*N)/z,this.ty=-(a*this.ty-u*N)/z,this},v.isIdentity=function(){return this.tx===0&&this.ty===0&&this.a===1&&this.b===0&&this.c===0&&this.d===1},v.equals=function(a){return this.tx===a.tx&&this.ty===a.ty&&this.a===a.a&&this.b===a.b&&this.c===a.c&&this.d===a.d},v.transformPoint=function(a,u,c){return(c=c||{}).x=a*this.a+u*this.c+this.tx,c.y=a*this.b+u*this.d+this.ty,c},v.decompose=function(a){a==null&&(a={}),a.x=this.tx,a.y=this.ty,a.scaleX=Math.sqrt(this.a*this.a+this.b*this.b),a.scaleY=Math.sqrt(this.c*this.c+this.d*this.d);var u=Math.atan2(-this.c,this.d),c=Math.atan2(this.b,this.a);return Math.abs(1-u/c)<1e-5?(a.rotation=c/e.DEG_TO_RAD,this.a<0&&0<=this.d&&(a.rotation+=a.rotation<=0?180:-180),a.skewX=a.skewY=0):(a.skewX=u/e.DEG_TO_RAD,a.skewY=c/e.DEG_TO_RAD),a},v.copy=function(a){return this.setValues(a.a,a.b,a.c,a.d,a.tx,a.ty)},v.clone=function(){return new e(this.a,this.b,this.c,this.d,this.tx,this.ty)},v.toString=function(){return"[Matrix2D (a="+this.a+" b="+this.b+" c="+this.c+" d="+this.d+" tx="+this.tx+" ty="+this.ty+")]"},e.identity=new e,ne.Matrix2D=e}(),function(){"use strict";function e(a,u,c,x,N){this.setValues(a,u,c,x,N)}var v=e.prototype;v.setValues=function(a,u,c,x,N){return this.visible=a==null||!!a,this.alpha=u==null?1:u,this.shadow=c,this.compositeOperation=x,this.matrix=N||this.matrix&&this.matrix.identity()||new ne.Matrix2D,this},v.append=function(a,u,c,x,N){return this.alpha*=u,this.shadow=c||this.shadow,this.compositeOperation=x||this.compositeOperation,this.visible=this.visible&&a,N&&this.matrix.appendMatrix(N),this},v.prepend=function(a,u,c,x,N){return this.alpha*=u,this.shadow=this.shadow||c,this.compositeOperation=this.compositeOperation||x,this.visible=this.visible&&a,N&&this.matrix.prependMatrix(N),this},v.identity=function(){return this.visible=!0,this.alpha=1,this.shadow=this.compositeOperation=null,this.matrix.identity(),this},v.clone=function(){return new e(this.alpha,this.shadow,this.compositeOperation,this.visible,this.matrix.clone())},ne.DisplayProps=e}(),function(){"use strict";function e(a,u){this.setValues(a,u)}var v=e.prototype;v.setValues=function(a,u){return this.x=a||0,this.y=u||0,this},v.copy=function(a){return this.x=a.x,this.y=a.y,this},v.clone=function(){return new e(this.x,this.y)},v.toString=function(){return"[Point (x="+this.x+" y="+this.y+")]"},ne.Point=e}(),function(){"use strict";function e(a,u,c,x){this.setValues(a,u,c,x)}var v=e.prototype;v.setValues=function(a,u,c,x){return this.x=a||0,this.y=u||0,this.width=c||0,this.height=x||0,this},v.extend=function(a,u,c,x){return x=x||0,a+(c=c||0)>this.x+this.width&&(this.width=a+c-this.x),u+x>this.y+this.height&&(this.height=u+x-this.y),a<this.x&&(this.width+=this.x-a,this.x=a),u<this.y&&(this.height+=this.y-u,this.y=u),this},v.pad=function(a,u,c,x){return this.x-=u,this.y-=a,this.width+=u+x,this.height+=a+c,this},v.copy=function(a){return this.setValues(a.x,a.y,a.width,a.height)},v.contains=function(a,u,c,x){return c=c||0,x=x||0,a>=this.x&&a+c<=this.x+this.width&&u>=this.y&&u+x<=this.y+this.height},v.union=function(a){return this.clone().extend(a.x,a.y,a.width,a.height)},v.intersection=function(N){var u=N.x,c=N.y,x=u+N.width,N=c+N.height;return this.x>u&&(u=this.x),this.y>c&&(c=this.y),this.x+this.width<x&&(x=this.x+this.width),this.y+this.height<N&&(N=this.y+this.height),x<=u||N<=c?null:new e(u,c,x-u,N-c)},v.intersects=function(a){return a.x<=this.x+this.width&&this.x<=a.x+a.width&&a.y<=this.y+this.height&&this.y<=a.y+a.height},v.isEmpty=function(){return this.width<=0||this.height<=0},v.clone=function(){return new e(this.x,this.y,this.width,this.height)},v.toString=function(){return"[Rectangle (x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+")]"},ne.Rectangle=e}(),function(){"use strict";function e(a,u,c,x,N,z,oe){a.addEventListener&&(this.target=a,this.overLabel=c==null?"over":c,this.outLabel=u==null?"out":u,this.downLabel=x==null?"down":x,this.play=N,this._isPressed=!1,this._isOver=!1,this._enabled=!1,a.mouseChildren=!1,this.enabled=!0,this.handleEvent({}),z&&(oe&&(z.actionsEnabled=!1,z.gotoAndStop&&z.gotoAndStop(oe)),a.hitArea=z))}var v=e.prototype;v._setEnabled=function(a){var u;a!=this._enabled&&(u=this.target,(this._enabled=a)?(u.cursor="pointer",u.addEventListener("rollover",this),u.addEventListener("rollout",this),u.addEventListener("mousedown",this),u.addEventListener("pressup",this),u._reset&&(u.__reset=u._reset,u._reset=this._reset)):(u.cursor=null,u.removeEventListener("rollover",this),u.removeEventListener("rollout",this),u.removeEventListener("mousedown",this),u.removeEventListener("pressup",this),u.__reset&&(u._reset=u.__reset,delete u.__reset)))},v.setEnabled=ne.deprecate(v._setEnabled,"ButtonHelper.setEnabled"),v._getEnabled=function(){return this._enabled},v.getEnabled=ne.deprecate(v._getEnabled,"ButtonHelper.getEnabled");try{Object.defineProperties(v,{enabled:{get:v._getEnabled,set:v._setEnabled}})}catch(a){}v.toString=function(){return"[ButtonHelper]"},v.handleEvent=function(c){var u=this.target,c=c.type,c=c=="mousedown"?(this._isPressed=!0,this.downLabel):c=="pressup"?(this._isPressed=!1,this._isOver?this.overLabel:this.outLabel):c=="rollover"?(this._isOver=!0,this._isPressed?this.downLabel:this.overLabel):(this._isOver=!1,this._isPressed?this.overLabel:this.outLabel);this.play?u.gotoAndPlay&&u.gotoAndPlay(c):u.gotoAndStop&&u.gotoAndStop(c)},v._reset=function(){var a=this.paused;this.__reset(),this.paused=a},ne.ButtonHelper=e}(),function(){"use strict";function e(a,u,c,x){this.color=a||"black",this.offsetX=u||0,this.offsetY=c||0,this.blur=x||0}var v=e.prototype;e.identity=new e("transparent",0,0,0),v.toString=function(){return"[Shadow]"},v.clone=function(){return new e(this.color,this.offsetX,this.offsetY,this.blur)},ne.Shadow=e}(),function(){"use strict";function e(a){this.EventDispatcher_constructor(),this.complete=!0,this.framerate=0,this._animations=null,this._frames=null,this._images=null,this._data=null,this._loadCount=0,this._frameHeight=0,this._frameWidth=0,this._numFrames=0,this._regX=0,this._regY=0,this._spacing=0,this._margin=0,this._parseData(a)}var v=ne.extend(e,ne.EventDispatcher);v._getAnimations=function(){return this._animations.slice()},v.getAnimations=ne.deprecate(v._getAnimations,"SpriteSheet.getAnimations");try{Object.defineProperties(v,{animations:{get:v._getAnimations}})}catch(a){}v.getNumFrames=function(a){return a==null?this._frames?this._frames.length:this._numFrames||0:(a=this._data[a],a==null?0:a.frames.length)},v.getAnimation=function(a){return this._data[a]},v.getFrame=function(a){var u;return this._frames&&(u=this._frames[a])?u:null},v.getFrameBounds=function(a,u){return a=this.getFrame(a),a?(u||new ne.Rectangle).setValues(-a.regX,-a.regY,a.rect.width,a.rect.height):null},v.toString=function(){return"[SpriteSheet]"},v.clone=function(){throw"SpriteSheet cannot be cloned."},v._parseData=function(a){var u,c,x,N;if(a!=null){if(this.framerate=a.framerate||0,a.images&&0<(c=a.images.length))for(i=this._images=[],u=0;u<c;u++){var z,oe=a.images[u];typeof oe=="string"&&(z=oe,(oe=document.createElement("img")).src=z),i.push(oe),oe.getContext||oe.naturalWidth||(this._loadCount++,this.complete=!1,function(o,l){oe.onload=function(){o._handleImageLoad(l)}}(this,z),function(o,l){oe.onerror=function(){o._handleImageError(l)}}(this,z))}if(a.frames!=null)if(Array.isArray(a.frames))for(this._frames=[],u=0,c=(i=a.frames).length;u<c;u++){var Ee=i[u];this._frames.push({image:this._images[Ee[4]||0],rect:new ne.Rectangle(Ee[0],Ee[1],Ee[2],Ee[3]),regX:Ee[5]||0,regY:Ee[6]||0})}else x=a.frames,this._frameWidth=x.width,this._frameHeight=x.height,this._regX=x.regX||0,this._regY=x.regY||0,this._spacing=x.spacing||0,this._margin=x.margin||0,this._numFrames=x.count,this._loadCount==0&&this._calculateFrames();if(this._animations=[],(x=a.animations)!=null)for(N in this._data={},x){var ke={name:N},t=x[N];if(typeof t=="number")i=ke.frames=[t];else if(Array.isArray(t))if(t.length==1)ke.frames=[t[0]];else for(ke.speed=t[3],ke.next=t[2],i=ke.frames=[],u=t[0];u<=t[1];u++)i.push(u);else{ke.speed=t.speed,ke.next=t.next;var r=t.frames,i=ke.frames=typeof r=="number"?[r]:r.slice(0)}ke.next!==!0&&ke.next!==void 0||(ke.next=N),(ke.next===!1||i.length<2&&ke.next==N)&&(ke.next=null),ke.speed||(ke.speed=1),this._animations.push(N),this._data[N]=ke}}},v._handleImageLoad=function(a){--this._loadCount==0&&(this._calculateFrames(),this.complete=!0,this.dispatchEvent("complete"))},v._handleImageError=function(a){var u=new ne.Event("error");u.src=a,this.dispatchEvent(u),--this._loadCount==0&&this.dispatchEvent("complete")},v._calculateFrames=function(){if(!this._frames&&this._frameWidth!=0){this._frames=[];var a=this._numFrames||1e5,u=0,c=this._frameWidth,x=this._frameHeight,N=this._spacing,z=this._margin;e:for(var oe=0,Ee=this._images;oe<Ee.length;oe++)for(var ke=Ee[oe],t=ke.width||ke.naturalWidth,r=ke.height||ke.naturalHeight,i=z;i<=r-z-x;){for(var o=z;o<=t-z-c;){if(a<=u)break e;u++,this._frames.push({image:ke,rect:new ne.Rectangle(o,i,c,x),regX:this._regX,regY:this._regY}),o+=c+N}i+=x+N}this._numFrames=u}},ne.SpriteSheet=ne.promote(e,"EventDispatcher")}(),function(){"use strict";function e(){this.command=null,this._stroke=null,this._strokeStyle=null,this._oldStrokeStyle=null,this._strokeDash=null,this._oldStrokeDash=null,this._strokeIgnoreScale=!1,this._fill=null,this._instructions=[],this._commitIndex=0,this._activeInstructions=[],this._dirty=!1,this._storeIndex=0,this.clear()}var v=e.prototype,a=e;e.getRGB=function(c,x,N,z){return c!=null&&N==null&&(z=x,N=255&c,x=c>>8&255,c=c>>16&255),z==null?"rgb("+c+","+x+","+N+")":"rgba("+c+","+x+","+N+","+z+")"},e.getHSL=function(c,x,N,z){return z==null?"hsl("+c%360+","+x+"%,"+N+"%)":"hsla("+c%360+","+x+"%,"+N+"%,"+z+")"},e.BASE_64={A:0,B:1,C:2,D:3,E:4,F:5,G:6,H:7,I:8,J:9,K:10,L:11,M:12,N:13,O:14,P:15,Q:16,R:17,S:18,T:19,U:20,V:21,W:22,X:23,Y:24,Z:25,a:26,b:27,c:28,d:29,e:30,f:31,g:32,h:33,i:34,j:35,k:36,l:37,m:38,n:39,o:40,p:41,q:42,r:43,s:44,t:45,u:46,v:47,w:48,x:49,y:50,z:51,0:52,1:53,2:54,3:55,4:56,5:57,6:58,7:59,8:60,9:61,"+":62,"/":63},e.STROKE_CAPS_MAP=["butt","round","square"],e.STROKE_JOINTS_MAP=["miter","round","bevel"];var u=ne.createCanvas?ne.createCanvas():document.createElement("canvas");u.getContext&&(e._ctx=u.getContext("2d"),u.width=u.height=1),v._getInstructions=function(){return this._updateInstructions(),this._instructions},v.getInstructions=ne.deprecate(v._getInstructions,"Graphics.getInstructions");try{Object.defineProperties(v,{instructions:{get:v._getInstructions}})}catch(c){}v.isEmpty=function(){return!(this._instructions.length||this._activeInstructions.length)},v.draw=function(c,x){this._updateInstructions();for(var N=this._instructions,z=this._storeIndex,oe=N.length;z<oe;z++)N[z].exec(c,x)},v.drawAsPath=function(c){this._updateInstructions();for(var x,N=this._instructions,z=this._storeIndex,oe=N.length;z<oe;z++)(x=N[z]).path!==!1&&x.exec(c)},v.moveTo=function(c,x){return this.append(new a.MoveTo(c,x),!0)},v.lineTo=function(c,x){return this.append(new a.LineTo(c,x))},v.arcTo=function(c,x,N,z,oe){return this.append(new a.ArcTo(c,x,N,z,oe))},v.arc=function(c,x,N,z,oe,Ee){return this.append(new a.Arc(c,x,N,z,oe,Ee))},v.quadraticCurveTo=function(c,x,N,z){return this.append(new a.QuadraticCurveTo(c,x,N,z))},v.bezierCurveTo=function(c,x,N,z,oe,Ee){return this.append(new a.BezierCurveTo(c,x,N,z,oe,Ee))},v.rect=function(c,x,N,z){return this.append(new a.Rect(c,x,N,z))},v.closePath=function(){return this._activeInstructions.length?this.append(new a.ClosePath):this},v.clear=function(){return this._instructions.length=this._activeInstructions.length=this._commitIndex=0,this._strokeStyle=this._oldStrokeStyle=this._stroke=this._fill=this._strokeDash=this._oldStrokeDash=null,this._dirty=this._strokeIgnoreScale=!1,this},v.beginFill=function(c){return this._setFill(c?new a.Fill(c):null)},v.beginLinearGradientFill=function(c,x,N,z,oe,Ee){return this._setFill(new a.Fill().linearGradient(c,x,N,z,oe,Ee))},v.beginRadialGradientFill=function(c,x,N,z,oe,Ee,ke,t){return this._setFill(new a.Fill().radialGradient(c,x,N,z,oe,Ee,ke,t))},v.beginBitmapFill=function(c,x,N){return this._setFill(new a.Fill(null,N).bitmap(c,x))},v.endFill=function(){return this.beginFill()},v.setStrokeStyle=function(c,x,N,z,oe){return this._updateInstructions(!0),this._strokeStyle=this.command=new a.StrokeStyle(c,x,N,z,oe),this._stroke&&(this._stroke.ignoreScale=oe),this._strokeIgnoreScale=oe,this},v.setStrokeDash=function(c,x){return this._updateInstructions(!0),this._strokeDash=this.command=new a.StrokeDash(c,x),this},v.beginStroke=function(c){return this._setStroke(c?new a.Stroke(c):null)},v.beginLinearGradientStroke=function(c,x,N,z,oe,Ee){return this._setStroke(new a.Stroke().linearGradient(c,x,N,z,oe,Ee))},v.beginRadialGradientStroke=function(c,x,N,z,oe,Ee,ke,t){return this._setStroke(new a.Stroke().radialGradient(c,x,N,z,oe,Ee,ke,t))},v.beginBitmapStroke=function(c,x){return this._setStroke(new a.Stroke().bitmap(c,x))},v.endStroke=function(){return this.beginStroke()},v.curveTo=v.quadraticCurveTo,v.drawRect=v.rect,v.drawRoundRect=function(c,x,N,z,oe){return this.drawRoundRectComplex(c,x,N,z,oe,oe,oe,oe)},v.drawRoundRectComplex=function(c,x,N,z,oe,Ee,ke,t){return this.append(new a.RoundRect(c,x,N,z,oe,Ee,ke,t))},v.drawCircle=function(c,x,N){return this.append(new a.Circle(c,x,N))},v.drawEllipse=function(c,x,N,z){return this.append(new a.Ellipse(c,x,N,z))},v.drawPolyStar=function(c,x,N,z,oe,Ee){return this.append(new a.PolyStar(c,x,N,z,oe,Ee))},v.drawPolygon=function(c,x){return this.append(new a.Polygon(c,x))},v.append=function(c,x){return this._activeInstructions.push(c),this.command=c,x||(this._dirty=!0),this},v.decodePath=function(c){for(var x=[this.moveTo,this.lineTo,this.quadraticCurveTo,this.bezierCurveTo,this.closePath],N=[2,2,4,6,0],z=0,oe=c.length,Ee=[],ke=0,t=0,r=e.BASE_64;z<oe;){var i=c.charAt(z),o=r[i],l=o>>3,f=x[l];if(!f||3&o)throw"bad path data (@"+z+"): "+i;var h=N[l];l||(ke=t=0),z++;for(var p=2+(o>>2&1),_=Ee.length=0;_<h;_++){var b=(w=r[c.charAt(z)])>>5?-1:1,w=(31&w)<<6|r[c.charAt(z+1)];p==3&&(w=w<<6|r[c.charAt(z+2)]),w=b*w/10,_%2?ke=w+=ke:t=w+=t,Ee[_]=w,z+=p}f.apply(this,Ee)}return this},v.store=function(){return this._updateInstructions(!0),this._storeIndex=this._instructions.length,this},v.unstore=function(){return this._storeIndex=0,this},v.clone=function(){var c=new e;return c.command=this.command,c._stroke=this._stroke,c._strokeStyle=this._strokeStyle,c._strokeDash=this._strokeDash,c._strokeIgnoreScale=this._strokeIgnoreScale,c._fill=this._fill,c._instructions=this._instructions.slice(),c._commitIndex=this._commitIndex,c._activeInstructions=this._activeInstructions.slice(),c._dirty=this._dirty,c._storeIndex=this._storeIndex,c},v.toString=function(){return"[Graphics]"},v.mt=v.moveTo,v.lt=v.lineTo,v.at=v.arcTo,v.bt=v.bezierCurveTo,v.qt=v.quadraticCurveTo,v.a=v.arc,v.r=v.rect,v.cp=v.closePath,v.c=v.clear,v.f=v.beginFill,v.lf=v.beginLinearGradientFill,v.rf=v.beginRadialGradientFill,v.bf=v.beginBitmapFill,v.ef=v.endFill,v.ss=v.setStrokeStyle,v.sd=v.setStrokeDash,v.s=v.beginStroke,v.ls=v.beginLinearGradientStroke,v.rs=v.beginRadialGradientStroke,v.bs=v.beginBitmapStroke,v.es=v.endStroke,v.dr=v.drawRect,v.rr=v.drawRoundRect,v.rc=v.drawRoundRectComplex,v.dc=v.drawCircle,v.de=v.drawEllipse,v.dp=v.drawPolyStar,v.pg=v.drawPolygon,v.p=v.decodePath,v._updateInstructions=function(c){var x=this._instructions,N=this._activeInstructions,z=this._commitIndex;if(this._dirty&&N.length){x.length=z,x.push(e.beginCmd);var oe=N.length,Ee=x.length;x.length=Ee+oe;for(var ke=0;ke<oe;ke++)x[ke+Ee]=N[ke];this._fill&&x.push(this._fill),this._stroke&&(this._strokeDash!==this._oldStrokeDash&&x.push(this._strokeDash),this._strokeStyle!==this._oldStrokeStyle&&x.push(this._strokeStyle),c&&(this._oldStrokeStyle=this._strokeStyle,this._oldStrokeDash=this._strokeDash),x.push(this._stroke)),this._dirty=!1}c&&(N.length=0,this._commitIndex=x.length)},v._setFill=function(c){return this._updateInstructions(!0),this.command=this._fill=c,this},v._setStroke=function(c){return this._updateInstructions(!0),(this.command=this._stroke=c)&&(c.ignoreScale=this._strokeIgnoreScale),this},(a.LineTo=function(c,x){this.x=c,this.y=x}).prototype.exec=function(c){c.lineTo(this.x,this.y)},(a.MoveTo=function(c,x){this.x=c,this.y=x}).prototype.exec=function(c){c.moveTo(this.x,this.y)},(a.ArcTo=function(c,x,N,z,oe){this.x1=c,this.y1=x,this.x2=N,this.y2=z,this.radius=oe}).prototype.exec=function(c){c.arcTo(this.x1,this.y1,this.x2,this.y2,this.radius)},(a.Arc=function(c,x,N,z,oe,Ee){this.x=c,this.y=x,this.radius=N,this.startAngle=z,this.endAngle=oe,this.anticlockwise=!!Ee}).prototype.exec=function(c){c.arc(this.x,this.y,this.radius,this.startAngle,this.endAngle,this.anticlockwise)},(a.QuadraticCurveTo=function(c,x,N,z){this.cpx=c,this.cpy=x,this.x=N,this.y=z}).prototype.exec=function(c){c.quadraticCurveTo(this.cpx,this.cpy,this.x,this.y)},(a.BezierCurveTo=function(c,x,N,z,oe,Ee){this.cp1x=c,this.cp1y=x,this.cp2x=N,this.cp2y=z,this.x=oe,this.y=Ee}).prototype.exec=function(c){c.bezierCurveTo(this.cp1x,this.cp1y,this.cp2x,this.cp2y,this.x,this.y)},(a.Rect=function(c,x,N,z){this.x=c,this.y=x,this.w=N,this.h=z}).prototype.exec=function(c){c.rect(this.x,this.y,this.w,this.h)},(a.ClosePath=function(){}).prototype.exec=function(c){c.closePath()},(a.BeginPath=function(){}).prototype.exec=function(c){c.beginPath()},(v=(a.Fill=function(c,x){this.style=c,this.matrix=x}).prototype).exec=function(c){var x;this.style&&(c.fillStyle=this.style,(x=this.matrix)&&(c.save(),c.transform(x.a,x.b,x.c,x.d,x.tx,x.ty)),c.fill(),x&&c.restore())},v.linearGradient=function(c,x,N,z,oe,Ee){for(var ke=this.style=e._ctx.createLinearGradient(N,z,oe,Ee),t=0,r=c.length;t<r;t++)ke.addColorStop(x[t],c[t]);return ke.props={colors:c,ratios:x,x0:N,y0:z,x1:oe,y1:Ee,type:"linear"},this},v.radialGradient=function(c,x,N,z,oe,Ee,ke,t){for(var r=this.style=e._ctx.createRadialGradient(N,z,oe,Ee,ke,t),i=0,o=c.length;i<o;i++)r.addColorStop(x[i],c[i]);return r.props={colors:c,ratios:x,x0:N,y0:z,r0:oe,x1:Ee,y1:ke,r1:t,type:"radial"},this},v.bitmap=function(c,x,N){return N&&(this.matrix=N),(c.naturalWidth||c.getContext||2<=c.readyState)&&((this.style=e._ctx.createPattern(c,x||"")).props={image:c,repetition:x,type:"bitmap"}),this},v.path=!1,(v=(a.Stroke=function(c,x){this.style=c,this.ignoreScale=x}).prototype).exec=function(c){this.style&&(c.strokeStyle=this.style,this.ignoreScale&&(c.save(),c.setTransform(1,0,0,1,0,0)),c.stroke(),this.ignoreScale&&c.restore())},v.linearGradient=a.Fill.prototype.linearGradient,v.radialGradient=a.Fill.prototype.radialGradient,v.bitmap=a.Fill.prototype.bitmap,v.path=!1,(v=(a.StrokeStyle=function(c,x,N,z,oe){this.width=c,this.caps=x,this.joints=N,this.miterLimit=z,this.ignoreScale=oe}).prototype).exec=function(c){c.lineWidth=this.width==null?"1":this.width,c.lineCap=this.caps==null?"butt":isNaN(this.caps)?this.caps:e.STROKE_CAPS_MAP[this.caps],c.lineJoin=this.joints==null?"miter":isNaN(this.joints)?this.joints:e.STROKE_JOINTS_MAP[this.joints],c.miterLimit=this.miterLimit==null?"10":this.miterLimit,c.ignoreScale=this.ignoreScale!=null&&this.ignoreScale},v.path=!1,(a.StrokeDash=function(c,x){this.segments=c,this.offset=x||0}).prototype.exec=function(c){c.setLineDash&&(c.setLineDash(this.segments||a.StrokeDash.EMPTY_SEGMENTS),c.lineDashOffset=this.offset||0)},a.StrokeDash.EMPTY_SEGMENTS=[],(a.RoundRect=function(c,x,N,z,oe,Ee,ke,t){this.x=c,this.y=x,this.w=N,this.h=z,this.radiusTL=oe,this.radiusTR=Ee,this.radiusBR=ke,this.radiusBL=t}).prototype.exec=function(c){var x=(r<i?r:i)/2,N=0,z=0,oe=0,Ee=0,ke=this.x,t=this.y,r=this.w,i=this.h,o=this.radiusTL,l=this.radiusTR,f=this.radiusBR,h=this.radiusBL;o<0&&(o*=N=-1),x<o&&(o=x),l<0&&(l*=z=-1),x<l&&(l=x),f<0&&(f*=oe=-1),x<f&&(f=x),h<0&&(h*=Ee=-1),x<h&&(h=x),c.moveTo(ke+r-l,t),c.arcTo(ke+r+l*z,t-l*z,ke+r,t+l,l),c.lineTo(ke+r,t+i-f),c.arcTo(ke+r+f*oe,t+i+f*oe,ke+r-f,t+i,f),c.lineTo(ke+h,t+i),c.arcTo(ke-h*Ee,t+i+h*Ee,ke,t+i-h,h),c.lineTo(ke,t+o),c.arcTo(ke-o*N,t-o*N,ke+o,t,o),c.closePath()},(a.Circle=function(c,x,N){this.x=c,this.y=x,this.radius=N}).prototype.exec=function(c){c.arc(this.x,this.y,this.radius,0,2*Math.PI)},(a.Ellipse=function(c,x,N,z){this.x=c,this.y=x,this.w=N,this.h=z}).prototype.exec=function(c){var x=this.x,N=this.y,t=this.w,r=this.h,z=t/2*.5522848,oe=r/2*.5522848,Ee=x+t,ke=N+r,t=x+t/2,r=N+r/2;c.moveTo(x,r),c.bezierCurveTo(x,r-oe,t-z,N,t,N),c.bezierCurveTo(t+z,N,Ee,r-oe,Ee,r),c.bezierCurveTo(Ee,r+oe,t+z,ke,t,ke),c.bezierCurveTo(t-z,ke,x,r+oe,x,r)},(a.PolyStar=function(c,x,N,z,oe,Ee){this.x=c,this.y=x,this.radius=N,this.sides=z,this.pointSize=oe,this.angle=Ee}).prototype.exec=function(c){var x=this.x,N=this.y,z=this.radius,oe=(this.angle||0)/180*Math.PI,Ee=this.sides,ke=1-(this.pointSize||0),t=Math.PI/Ee;c.moveTo(x+Math.cos(oe)*z,N+Math.sin(oe)*z);for(var r=0;r<Ee+1&&(oe+=t,ke==1||(c.lineTo(x+Math.cos(oe)*z*ke,N+Math.sin(oe)*z*ke),r!=Ee));r++)oe+=t,c.lineTo(x+Math.cos(oe)*z,N+Math.sin(oe)*z);c.closePath()},(a.Polygon=function(c,x){this.points=c,x==null&&(x=!0),this.close=x}).prototype.exec=function(c){var x,N,z=this.points,oe=this.close,Ee=z[0];c.moveTo(Ee[0],Ee[1]);for(var ke=1;ke<z.length;ke++)x=z[ke],ke==1&&(N=[x[0],x[1]]),c.lineTo(x[0],x[1]);oe&&(c.lineTo(Ee[0],Ee[1]),c.lineTo(N[0],N[1])),c.closePath()},e.beginCmd=new a.BeginPath,ne.Graphics=e}(),function(){"use strict";function e(){this.EventDispatcher_constructor(),this.alpha=1,this.cacheCanvas=null,this.bitmapCache=null,this.id=ne.UID.get(),this.mouseEnabled=!0,this.tickEnabled=!0,this.name=null,this.parent=null,this.regX=0,this.regY=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.skewX=0,this.skewY=0,this.shadow=null,this.visible=!0,this.x=0,this.y=0,this.transformMatrix=null,this.compositeOperation=null,this.snapToPixel=!0,this.filters=null,this.mask=null,this.hitArea=null,this.cursor=null,this._props=new ne.DisplayProps,this._rectangle=new ne.Rectangle,this._bounds=null,this._webGLRenderStyle=e._StageGL_NONE}var v=ne.extend(e,ne.EventDispatcher);e._MOUSE_EVENTS=["click","dblclick","mousedown","mouseout","mouseover","pressmove","pressup","rollout","rollover"],e.suppressCrossDomainErrors=!1,e._snapToPixelEnabled=!1,e._StageGL_NONE=0,e._StageGL_SPRITE=1,e._StageGL_BITMAP=2;var a=ne.createCanvas?ne.createCanvas():document.createElement("canvas");a.getContext&&(e._hitTestCanvas=a,e._hitTestContext=a.getContext("2d"),a.width=a.height=1),v._getStage=function(){for(var u=this,c=ne.Stage;u.parent;)u=u.parent;return u instanceof c?u:null},v.getStage=ne.deprecate(v._getStage,"DisplayObject.getStage");try{Object.defineProperties(v,{stage:{get:v._getStage},cacheID:{get:function(){return this.bitmapCache&&this.bitmapCache.cacheID},set:function(u){this.bitmapCache&&(this.bitmapCache.cacheID=u)}},scale:{get:function(){return this.scaleX},set:function(u){this.scaleX=this.scaleY=u}}})}catch(u){}v.isVisible=function(){return!!(this.visible&&0<this.alpha&&this.scaleX!=0&&this.scaleY!=0)},v.draw=function(u,c){var x=this.bitmapCache;return!(!x||c)&&x.draw(u)},v.updateContext=function(u){var c=this,z=c.mask,x=c._props.matrix;z&&z.graphics&&!z.graphics.isEmpty()&&(z.getMatrix(x),u.transform(x.a,x.b,x.c,x.d,x.tx,x.ty),z.graphics.drawAsPath(u),u.clip(),x.invert(),u.transform(x.a,x.b,x.c,x.d,x.tx,x.ty)),this.getMatrix(x);var N=x.tx,z=x.ty;e._snapToPixelEnabled&&c.snapToPixel&&(N=N+(N<0?-.5:.5)|0,z=z+(z<0?-.5:.5)|0),u.transform(x.a,x.b,x.c,x.d,N,z),u.globalAlpha*=c.alpha,c.compositeOperation&&(u.globalCompositeOperation=c.compositeOperation),c.shadow&&this._applyShadow(u,c.shadow)},v.cache=function(u,c,x,N,z,oe){this.bitmapCache||(this.bitmapCache=new ne.BitmapCache),this.bitmapCache.define(this,u,c,x,N,z,oe)},v.updateCache=function(u){if(!this.bitmapCache)throw"cache() must be called before updateCache()";this.bitmapCache.update(u)},v.uncache=function(){this.bitmapCache&&(this.bitmapCache.release(),this.bitmapCache=void 0)},v.getCacheDataURL=function(){return this.bitmapCache?this.bitmapCache.getCacheDataURL():null},v.localToGlobal=function(u,c,x){return x=this.getConcatenatedMatrix(this._props.matrix).transformPoint(u,c,x||new ne.Point),this.stage&&ne.stageTransformable&&(x=this.stage.getConcatenatedMatrix(this._mtx).invert().transformPoint(x.x,x.y)),x},v.globalToLocal=function(u,c,x){var N;return this.stage&&ne.stageTransformable&&(u=(N=this.stage.getConcatenatedMatrix(this._mtx).transformPoint(u,c)).x,c=N.y),this.getConcatenatedMatrix(this._props.matrix).invert().transformPoint(u,c,x||new ne.Point)},v.localToLocal=function(u,c,x,N){return N=this.localToGlobal(u,c,N),x.globalToLocal(N.x,N.y,N)},v.setTransform=function(u,c,x,N,z,oe,Ee,ke,t){return this.x=u||0,this.y=c||0,this.scaleX=x==null?1:x,this.scaleY=N==null?1:N,this.rotation=z||0,this.skewX=oe||0,this.skewY=Ee||0,this.regX=ke||0,this.regY=t||0,this},v.getMatrix=function(x){var c=this,x=x&&x.identity()||new ne.Matrix2D;return c.transformMatrix?x.copy(c.transformMatrix):x.appendTransform(c.x,c.y,c.scaleX,c.scaleY,c.rotation,c.skewX,c.skewY,c.regX,c.regY)},v.getConcatenatedMatrix=function(u){for(var c=this,x=this.getMatrix(u);c=c.parent;)x.prependMatrix(c.getMatrix(c._props.matrix));return x},v.getConcatenatedDisplayProps=function(u){u=u?u.identity():new ne.DisplayProps;for(var c=this,x=c.getMatrix(u.matrix);u.prepend(c.visible,c.alpha,c.shadow,c.compositeOperation),c!=this&&x.prependMatrix(c.getMatrix(c._props.matrix)),c=c.parent;);return u},v.hitTest=function(u,c){var x=e._hitTestContext;return x.setTransform(1,0,0,1,-u,-c),this.draw(x),c=this._testHit(x),x.setTransform(1,0,0,1,0,0),x.clearRect(0,0,2,2),c},v.set=function(u){for(var c in u)this[c]=u[c];return this},v.getBounds=function(){if(this._bounds)return this._rectangle.copy(this._bounds);var u=this.cacheCanvas;if(u){var c=this._cacheScale;return this._rectangle.setValues(this._cacheOffsetX,this._cacheOffsetY,u.width/c,u.height/c)}return null},v.getTransformedBounds=function(){return this._getBounds()},v.setBounds=function(u,c,x,N){this._bounds=u!=null?(this._bounds||new ne.Rectangle).setValues(u,c,x,N):u},v.clone=function(){return this._cloneProps(new e)},v.toString=function(){return"[DisplayObject (name="+this.name+")]"},v._updateState=null,v._cloneProps=function(u){return u.alpha=this.alpha,u.mouseEnabled=this.mouseEnabled,u.tickEnabled=this.tickEnabled,u.name=this.name,u.regX=this.regX,u.regY=this.regY,u.rotation=this.rotation,u.scaleX=this.scaleX,u.scaleY=this.scaleY,u.shadow=this.shadow,u.skewX=this.skewX,u.skewY=this.skewY,u.visible=this.visible,u.x=this.x,u.y=this.y,u.compositeOperation=this.compositeOperation,u.snapToPixel=this.snapToPixel,u.filters=this.filters==null?null:this.filters.slice(0),u.mask=this.mask,u.hitArea=this.hitArea,u.cursor=this.cursor,u._bounds=this._bounds,u},v._applyShadow=function(u,c){c=c||Shadow.identity,u.shadowColor=c.color,u.shadowOffsetX=c.offsetX,u.shadowOffsetY=c.offsetY,u.shadowBlur=c.blur},v._tick=function(u){var c=this._listeners;c&&c.tick&&(u.target=null,u.propagationStopped=u.immediatePropagationStopped=!1,this.dispatchEvent(u))},v._testHit=function(u){try{var c=1<u.getImageData(0,0,1,1).data[3]}catch(x){if(!e.suppressCrossDomainErrors)throw"An error has occurred. This is most likely due to security restrictions on reading canvas pixel data with local or cross-domain images."}return c},v._getBounds=function(u,c){return this._transformBounds(this.getBounds(),u,c)},v._transformBounds=function(u,o,i){if(!u)return u;var N=u.x,z=u.y,l=u.width,f=u.height,h=this._props.matrix,h=i?h.identity():this.getMatrix(h);(N||z)&&h.appendTransform(0,0,1,1,0,0,0,-N,-z),o&&h.prependMatrix(o);var oe=l*h.a,Ee=l*h.b,ke=f*h.c,t=f*h.d,r=h.tx,i=h.ty,o=r,l=r,f=i,h=i;return(N=oe+r)<o?o=N:l<N&&(l=N),(N=oe+ke+r)<o?o=N:l<N&&(l=N),(N=ke+r)<o?o=N:l<N&&(l=N),(z=Ee+i)<f?f=z:h<z&&(h=z),(z=Ee+t+i)<f?f=z:h<z&&(h=z),(z=t+i)<f?f=z:h<z&&(h=z),u.setValues(o,f,l-o,h-f)},v._hasMouseEventListener=function(){for(var u=e._MOUSE_EVENTS,c=0,x=u.length;c<x;c++)if(this.hasEventListener(u[c]))return!0;return!!this.cursor},ne.DisplayObject=ne.promote(e,"EventDispatcher")}(),function(){"use strict";function e(){this.DisplayObject_constructor(),this.children=[],this.mouseChildren=!0,this.tickChildren=!0}var v=ne.extend(e,ne.DisplayObject);v._getNumChildren=function(){return this.children.length},v.getNumChildren=ne.deprecate(v._getNumChildren,"Container.getNumChildren");try{Object.defineProperties(v,{numChildren:{get:v._getNumChildren}})}catch(a){}v.initialize=e,v.isVisible=function(){var a=this.cacheCanvas||this.children.length;return!!(this.visible&&0<this.alpha&&this.scaleX!=0&&this.scaleY!=0&&a)},v.draw=function(a,u){if(this.DisplayObject_draw(a,u))return!0;for(var c=this.children.slice(),x=0,N=c.length;x<N;x++){var z=c[x];z.isVisible()&&(a.save(),z.updateContext(a),z.draw(a),a.restore())}return!0},v.addChild=function(a){if(a==null)return a;var u=arguments.length;if(1<u){for(var c=0;c<u;c++)this.addChild(arguments[c]);return arguments[u-1]}var x=a.parent,N=x===this;return x&&x._removeChildAt(ne.indexOf(x.children,a),N),(a.parent=this).children.push(a),N||a.dispatchEvent("added"),a},v.addChildAt=function(a,u){var c=arguments.length,x=arguments[c-1];if(x<0||x>this.children.length)return arguments[c-2];if(2<c){for(var N=0;N<c-1;N++)this.addChildAt(arguments[N],x+N);return arguments[c-2]}var z=a.parent,oe=z===this;return z&&z._removeChildAt(ne.indexOf(z.children,a),oe),(a.parent=this).children.splice(u,0,a),oe||a.dispatchEvent("added"),a},v.removeChild=function(a){var u=arguments.length;if(1<u){for(var c=!0,x=0;x<u;x++)c=c&&this.removeChild(arguments[x]);return c}return this._removeChildAt(ne.indexOf(this.children,a))},v.removeChildAt=function(a){var u=arguments.length;if(1<u){for(var c=[],x=0;x<u;x++)c[x]=arguments[x];c.sort(function(z,oe){return oe-z});for(var N=!0,x=0;x<u;x++)N=N&&this._removeChildAt(c[x]);return N}return this._removeChildAt(a)},v.removeAllChildren=function(){for(var a=this.children;a.length;)this._removeChildAt(0)},v.getChildAt=function(a){return this.children[a]},v.getChildByName=function(a){for(var u=this.children,c=0,x=u.length;c<x;c++)if(u[c].name==a)return u[c];return null},v.sortChildren=function(a){this.children.sort(a)},v.getChildIndex=function(a){return ne.indexOf(this.children,a)},v.swapChildrenAt=function(a,u){var c=this.children,x=c[a],N=c[u];x&&N&&(c[a]=N,c[u]=x)},v.swapChildren=function(a,u){for(var c,x,N=this.children,z=0,oe=N.length;z<oe&&(N[z]==a&&(c=z),N[z]==u&&(x=z),c==null||x==null);z++);z!=oe&&(N[c]=u,N[x]=a)},v.setChildIndex=function(a,u){var c=this.children,x=c.length;if(!(a.parent!=this||u<0||x<=u)){for(var N=0;N<x&&c[N]!=a;N++);N!=x&&N!=u&&(c.splice(N,1),c.splice(u,0,a))}},v.contains=function(a){for(;a;){if(a==this)return!0;a=a.parent}return!1},v.hitTest=function(a,u){return this.getObjectUnderPoint(a,u)!=null},v.getObjectsUnderPoint=function(a,N,c){var x=[],N=this.localToGlobal(a,N);return this._getObjectsUnderPoint(N.x,N.y,x,0<c,c==1),x},v.getObjectUnderPoint=function(a,u,c){return u=this.localToGlobal(a,u),this._getObjectsUnderPoint(u.x,u.y,null,0<c,c==1)},v.getBounds=function(){return this._getBounds(null,!0)},v.getTransformedBounds=function(){return this._getBounds()},v.clone=function(a){var u=this._cloneProps(new e);return a&&this._cloneChildren(u),u},v.toString=function(){return"[Container (name="+this.name+")]"},v._tick=function(a){if(this.tickChildren)for(var u=this.children.length-1;0<=u;u--){var c=this.children[u];c.tickEnabled&&c._tick&&c._tick(a)}this.DisplayObject__tick(a)},v._cloneChildren=function(a){a.children.length&&a.removeAllChildren();for(var u=a.children,c=0,x=this.children.length;c<x;c++){var N=this.children[c].clone(!0);N.parent=a,u.push(N)}},v._removeChildAt=function(a,u){if(a<0||a>this.children.length-1)return!1;var c=this.children[a];return c&&(c.parent=null),this.children.splice(a,1),u||c.dispatchEvent("removed"),!0},v._getObjectsUnderPoint=function(a,u,c,x,N,z){var oe,Ee,ke;if(this.stage&&ne.stageTransformable&&(oe=a,Ee=u,a=(ke=this.stage.getConcatenatedMatrix(this._mtx).transformPoint(a,u)).x,u=ke.y),!(z=z||0)&&!this._testMask(this,a,u))return null;var t=ne.DisplayObject._hitTestContext;N=N||x&&this._hasMouseEventListener();for(var r=this.children,i=r.length-1;0<=i;i--){var o=r[i],l=o.hitArea;if(o.visible&&(l||o.isVisible())&&(!x||o.mouseEnabled)&&(l||this._testMask(o,a,u))){if(!l&&o instanceof e){var f=o._getObjectsUnderPoint(oe!=null?oe:a,Ee!=null?Ee:u,c,x,N,z+1);if(!c&&f)return x&&!this.mouseChildren?this:f}else if(!x||N||o._hasMouseEventListener()){var h=o.getConcatenatedDisplayProps(o._props),f=h.matrix;if(l&&(f.appendMatrix(l.getMatrix(l._props.matrix)),h.alpha=l.alpha),t.globalAlpha=h.alpha,t.setTransform(f.a,f.b,f.c,f.d,f.tx-a,f.ty-u),(l||o).draw(t),this._testHit(t)){if(t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,2,2),!c)return x&&!this.mouseChildren?this:o;c.push(o)}}}}return null},v._testMask=function(N,u,c){var x=N.mask;if(!x||!x.graphics||x.graphics.isEmpty())return!0;var z=this._props.matrix,N=N.parent,z=N?N.getConcatenatedMatrix(z):z.identity();return z=x.getMatrix(x._props.matrix).prependMatrix(z),N=ne.DisplayObject._hitTestContext,N.setTransform(z.a,z.b,z.c,z.d,z.tx-u,z.ty-c),x.graphics.drawAsPath(N),N.fillStyle="#000",N.fill(),!!this._testHit(N)&&(N.setTransform(1,0,0,1,0,0),N.clearRect(0,0,2,2),!0)},v._getBounds=function(a,u){var c=this.DisplayObject_getBounds();if(c)return this._transformBounds(c,a,u);var x=this._props.matrix,x=u?x.identity():this.getMatrix(x);a&&x.prependMatrix(a);for(var N=this.children.length,z=null,oe=0;oe<N;oe++){var Ee=this.children[oe];Ee.visible&&(c=Ee._getBounds(x))&&(z?z.extend(c.x,c.y,c.width,c.height):z=c.clone())}return z},ne.Container=ne.promote(e,"DisplayObject")}(),function(){"use strict";function e(a){this.Container_constructor(),this.autoClear=!0,this.canvas=typeof a=="string"?document.getElementById(a):a,this.mouseX=0,this.mouseY=0,this.drawRect=null,this.snapToPixelEnabled=!1,this.mouseInBounds=!1,this.tickOnUpdate=!0,this.mouseMoveOutside=!1,this.preventSelection=!0,this._pointerData={},this._pointerCount=0,this._primaryPointerID=null,this._mouseOverIntervalID=null,this._nextStage=null,this._prevStage=null,this.enableDOMEvents(!0)}var v=ne.extend(e,ne.Container);v._get_nextStage=function(){return this._nextStage},v._set_nextStage=function(a){this._nextStage&&(this._nextStage._prevStage=null),a&&(a._prevStage=this),this._nextStage=a};try{Object.defineProperties(v,{nextStage:{get:v._get_nextStage,set:v._set_nextStage}})}catch(a){}v.update=function(a){var u;this.canvas&&(this.tickOnUpdate&&this.tick(a),this.dispatchEvent("drawstart",!1,!0)!==!1&&(ne.DisplayObject._snapToPixelEnabled=this.snapToPixelEnabled,u=this.drawRect,(a=this.canvas.getContext("2d")).setTransform(1,0,0,1,0,0),this.autoClear&&(u?a.clearRect(u.x,u.y,u.width,u.height):a.clearRect(0,0,this.canvas.width+1,this.canvas.height+1)),a.save(),this.drawRect&&(a.beginPath(),a.rect(u.x,u.y,u.width,u.height),a.clip()),this.updateContext(a),this.draw(a,!1),a.restore(),this.dispatchEvent("drawend")))},v.tick=function(a){if(this.tickEnabled&&this.dispatchEvent("tickstart",!1,!0)!==!1){var u=new ne.Event("tick");if(a)for(var c in a)a.hasOwnProperty(c)&&(u[c]=a[c]);this._tick(u),this.dispatchEvent("tickend")}},v.handleEvent=function(a){a.type=="tick"&&this.update(a)},v.clear=function(){var a;this.canvas&&((a=this.canvas.getContext("2d")).setTransform(1,0,0,1,0,0),a.clearRect(0,0,this.canvas.width+1,this.canvas.height+1))},v.toDataURL=function(a,u){var c,x,N=this.canvas.getContext("2d"),z=this.canvas.width,oe=this.canvas.height;return a&&(c=N.getImageData(0,0,z,oe),x=N.globalCompositeOperation,N.globalCompositeOperation="destination-over",N.fillStyle=a,N.fillRect(0,0,z,oe)),u=this.canvas.toDataURL(u||"image/png"),a&&(N.putImageData(c,0,0),N.globalCompositeOperation=x),u},v.enableMouseOver=function(a){if(this._mouseOverIntervalID&&(clearInterval(this._mouseOverIntervalID),this._mouseOverIntervalID=null,a==0&&this._testMouseOver(!0)),a==null)a=20;else if(a<=0)return;var u=this;this._mouseOverIntervalID=setInterval(function(){u._testMouseOver()},1e3/Math.min(50,a))},v.enableDOMEvents=function(a){a==null&&(a=!0);var u,c,x=this._eventListeners;if(!a&&x){for(u in x)(c=x[u]).t.removeEventListener(u,c.f,!1);this._eventListeners=null}else if(a&&!x&&this.canvas){var a=window.addEventListener?window:document,N=this;for(u in(x=this._eventListeners={}).mouseup={t:a,f:function(oe){N._handleMouseUp(oe)}},x.mousemove={t:a,f:function(oe){N._handleMouseMove(oe)}},x.dblclick={t:this.canvas,f:function(oe){N._handleDoubleClick(oe)}},x.mousedown={t:this.canvas,f:function(oe){N._handleMouseDown(oe)}},x)(c=x[u]).t.addEventListener(u,c.f,!1)}},v.clone=function(){throw"Stage cannot be cloned."},v.toString=function(){return"[Stage (name="+this.name+")]"},v._getElementRect=function(a){var u;try{u=a.getBoundingClientRect()}catch(ke){u={top:a.offsetTop,left:a.offsetLeft,width:a.offsetWidth,height:a.offsetHeight}}var c=(window.pageXOffset||document.scrollLeft||0)-(document.clientLeft||document.body.clientLeft||0),x=(window.pageYOffset||document.scrollTop||0)-(document.clientTop||document.body.clientTop||0),Ee=window.getComputedStyle?getComputedStyle(a,null):a.currentStyle,N=parseInt(Ee.paddingLeft)+parseInt(Ee.borderLeftWidth),z=parseInt(Ee.paddingTop)+parseInt(Ee.borderTopWidth),oe=parseInt(Ee.paddingRight)+parseInt(Ee.borderRightWidth),Ee=parseInt(Ee.paddingBottom)+parseInt(Ee.borderBottomWidth);return{left:u.left+c+N,right:u.right+c-oe,top:u.top+x+z,bottom:u.bottom+x-Ee}},v._getPointerData=function(a){return this._pointerData[a]||(this._pointerData[a]={x:0,y:0})},v._handleMouseMove=function(a){a=a||window.event,this._handlePointerMove(-1,a,a.pageX,a.pageY)},v._handlePointerMove=function(a,u,c,x,N){var z,oe;this._prevStage&&N===void 0||this.canvas&&(z=this._nextStage,N=(oe=this._getPointerData(a)).inBounds,this._updatePointerPosition(a,u,c,x),(N||oe.inBounds||this.mouseMoveOutside)&&(a===-1&&oe.inBounds==!N&&this._dispatchMouseEvent(this,N?"mouseleave":"mouseenter",!1,a,oe,u),this._dispatchMouseEvent(this,"stagemousemove",!1,a,oe,u),this._dispatchMouseEvent(oe.target,"pressmove",!0,a,oe,u)),z&&z._handlePointerMove(a,u,c,x,null))},v._updatePointerPosition=function(a,u,c,x){var Ee=this._getElementRect(this.canvas);c-=Ee.left,x-=Ee.top;var N=this.canvas.width,z=this.canvas.height;c/=(Ee.right-Ee.left)/N,x/=(Ee.bottom-Ee.top)/z;var oe,Ee=this._getPointerData(a);ne.stageTransformable?(this._mtx=this.getConcatenatedMatrix(this._mtx).invert(),(Ee.inBounds=0<=c&&0<=x&&c<=N-1&&x<=z-1)?(Ee.x=c,Ee.y=x,oe=this._mtx.transformPoint(Ee.x,Ee.y),Ee.x=oe.x,Ee.y=oe.y):this.mouseMoveOutside&&(Ee.x=c<0?0:N-1<c?N-1:c,Ee.y=x<0?0:z-1<x?z-1:x,oe=this._mtx.transformPoint(Ee.x,Ee.y),Ee.x=oe.x,Ee.y=oe.y),Ee.rawX=c,Ee.rawY=x,oe=this._mtx.transformPoint(Ee.rawX,Ee.rawY),Ee.rawX=oe.x,Ee.rawY=oe.y):((Ee.inBounds=0<=c&&0<=x&&c<=N-1&&x<=z-1)?(Ee.x=c,Ee.y=x):this.mouseMoveOutside&&(Ee.x=c<0?0:N-1<c?N-1:c,Ee.y=x<0?0:z-1<x?z-1:x),Ee.rawX=c,Ee.rawY=x),Ee.posEvtObj=u,a!==this._primaryPointerID&&a!==-1||(this.mouseX=Ee.x,this.mouseY=Ee.y,this.mouseInBounds=Ee.inBounds)},v._handleMouseUp=function(a){this._handlePointerUp(-1,a,!1)},v._handlePointerUp=function(a,u,c,x){var N,z,oe=this._nextStage,Ee=this._getPointerData(a);this._prevStage&&x===void 0||(N=null,z=Ee.target,x||!z&&!oe||(N=this._getObjectsUnderPoint(Ee.x,Ee.y,null,!0)),Ee.down&&(this._dispatchMouseEvent(this,"stagemouseup",!1,a,Ee,u,N),Ee.down=!1),N==z&&this._dispatchMouseEvent(z,"click",!0,a,Ee,u),this._dispatchMouseEvent(z,"pressup",!0,a,Ee,u),c?(a==this._primaryPointerID&&(this._primaryPointerID=null),delete this._pointerData[a]):Ee.target=null,oe&&oe._handlePointerUp(a,u,c,x||N&&this))},v._handleMouseDown=function(a){this._handlePointerDown(-1,a,a.pageX,a.pageY)},v._handlePointerDown=function(a,u,c,x,N){this.preventSelection&&u.preventDefault(),this._primaryPointerID!=null&&a!==-1||(this._primaryPointerID=a),x!=null&&this._updatePointerPosition(a,u,c,x);var z=null,oe=this._nextStage,Ee=this._getPointerData(a);N||(z=Ee.target=this._getObjectsUnderPoint(Ee.x,Ee.y,null,!0)),Ee.inBounds&&(this._dispatchMouseEvent(this,"stagemousedown",!1,a,Ee,u,z),Ee.down=!0),this._dispatchMouseEvent(z,"mousedown",!0,a,Ee,u),oe&&oe._handlePointerDown(a,u,c,x,N||z&&this)},v._testMouseOver=function(a,u,c){if(!this._prevStage||u!==void 0){var x=this._nextStage;if(this._mouseOverIntervalID){var N=this._getPointerData(-1);if(N&&(a||this.mouseX!=this._mouseOverX||this.mouseY!=this._mouseOverY||!this.mouseInBounds)){var z,oe,Ee=N.posEvtObj,ke=c||Ee&&Ee.target==this.canvas,t=null,r=-1,i="";!u&&(a||this.mouseInBounds&&ke)&&(t=this._getObjectsUnderPoint(this.mouseX,this.mouseY,null,!0),this._mouseOverX=this.mouseX,this._mouseOverY=this.mouseY);for(var o=this._mouseOverTarget||[],l=o[o.length-1],f=this._mouseOverTarget=[],h=t;h;)f.unshift(h),i=i||h.cursor,h=h.parent;for(this.canvas.style.cursor=i,!u&&c&&(c.canvas.style.cursor=i),z=0,oe=f.length;z<oe&&f[z]==o[z];z++)r=z;for(l!=t&&this._dispatchMouseEvent(l,"mouseout",!0,-1,N,Ee,t),z=o.length-1;r<z;z--)this._dispatchMouseEvent(o[z],"rollout",!1,-1,N,Ee,t);for(z=f.length-1;r<z;z--)this._dispatchMouseEvent(f[z],"rollover",!1,-1,N,Ee,l);l!=t&&this._dispatchMouseEvent(t,"mouseover",!0,-1,N,Ee,l),x&&x._testMouseOver(a,u||t&&this,c||ke&&this)}}else x&&x._testMouseOver(a,u,c)}},v._handleDoubleClick=function(a,u){var c=null,x=this._nextStage,N=this._getPointerData(-1);u||(c=this._getObjectsUnderPoint(N.x,N.y,null,!0),this._dispatchMouseEvent(c,"dblclick",!0,-1,N,a)),x&&x._handleDoubleClick(a,u||c&&this)},v._dispatchMouseEvent=function(a,u,c,x,N,z,oe){a&&(c||a.hasEventListener(u))&&(oe=new ne.MouseEvent(u,c,!1,N.x,N.y,z,x,x===this._primaryPointerID||x===-1,N.rawX,N.rawY,oe),a.dispatchEvent(oe))},ne.Stage=ne.promote(e,"Container")}(),function(){"use strict";function e(a,u){if(this.Stage_constructor(a),u!==void 0){if(typeof u!="object")throw"Invalid options object";var c=u.premultiply,x=u.transparent,N=u.antialias,z=u.preserveBuffer,oe=u.autoPurge}this.vocalDebug=!1,this._preserveBuffer=z||!1,this._antialias=N||!1,this._transparent=x||!1,this._premultiply=c||!1,this._autoPurge=void 0,this.autoPurge=oe,this._viewportWidth=0,this._viewportHeight=0,this._projectionMatrix=null,this._webGLContext=null,this._clearColor={r:.5,g:.5,b:.5,a:0},this._maxCardsPerBatch=e.DEFAULT_MAX_BATCH_SIZE,this._activeShader=null,this._vertices=null,this._vertexPositionBuffer=null,this._uvs=null,this._uvPositionBuffer=null,this._indices=null,this._textureIndexBuffer=null,this._alphas=null,this._alphaBuffer=null,this._textureDictionary=[],this._textureIDs={},this._batchTextures=[],this._baseTextures=[],this._batchTextureCount=8,this._lastTextureInsert=-1,this._batchID=0,this._drawID=0,this._slotBlacklist=[],this._isDrawing=0,this._lastTrackedCanvas=0,this.isCacheControlled=!1,this._cacheContainer=new ne.Container,this._initializeWebGL()}var v=ne.extend(e,ne.Stage);e.buildUVRects=function(a,u,c){if(!a||!a._frames)return null;u===void 0&&(u=-1),c===void 0&&(c=!1);for(var x=u!=-1&&c?u:0,N=u!=-1&&c?u+1:a._frames.length,z=x;z<N;z++){var oe,Ee=a._frames[z];Ee.uvRect||Ee.image.width<=0||Ee.image.height<=0||(oe=Ee.rect,Ee.uvRect={t:oe.y/Ee.image.height,l:oe.x/Ee.image.width,b:(oe.y+oe.height)/Ee.image.height,r:(oe.x+oe.width)/Ee.image.width})}return a._frames[u!=-1?u:0].uvRect||{t:0,l:0,b:1,r:1}},e.isWebGLActive=function(a){return a&&a instanceof WebGLRenderingContext&&typeof WebGLRenderingContext<"u"},e.VERTEX_PROPERTY_COUNT=6,e.INDICIES_PER_CARD=6,e.DEFAULT_MAX_BATCH_SIZE=1e4,e.WEBGL_MAX_INDEX_NUM=Math.pow(2,16),e.UV_RECT={t:0,l:0,b:1,r:1};try{e.COVER_VERT=new Float32Array([-1,1,1,1,-1,-1,1,1,1,-1,-1,-1]),e.COVER_UV=new Float32Array([0,0,1,0,0,1,1,0,1,1,0,1]),e.COVER_UV_FLIP=new Float32Array([0,1,1,1,0,0,1,1,1,0,0,0])}catch(a){}e.REGULAR_VERTEX_HEADER=(e.REGULAR_VARYING_HEADER="precision mediump float;varying vec2 vTextureCoord;varying lowp float indexPicker;varying lowp float alphaValue;")+"attribute vec2 vertexPosition;attribute vec2 uvPosition;attribute lowp float textureIndex;attribute lowp float objectAlpha;uniform mat4 pMatrix;",e.REGULAR_FRAGMENT_HEADER=e.REGULAR_VARYING_HEADER+"uniform sampler2D uSampler[{{count}}];",e.REGULAR_VERTEX_BODY="void main(void) {gl_Position = vec4((vertexPosition.x * pMatrix[0][0]) + pMatrix[3][0],(vertexPosition.y * pMatrix[1][1]) + pMatrix[3][1],pMatrix[3][2],1.0);alphaValue = objectAlpha;indexPicker = textureIndex;vTextureCoord = uvPosition;}",e.REGULAR_FRAGMENT_BODY="void main(void) {vec4 color = vec4(1.0, 0.0, 0.0, 1.0);if (indexPicker <= 0.5) {color = texture2D(uSampler[0], vTextureCoord);{{alternates}}}{{fragColor}}}",e.REGULAR_FRAG_COLOR_NORMAL="gl_FragColor = vec4(color.rgb, color.a * alphaValue);",e.REGULAR_FRAG_COLOR_PREMULTIPLY="if(color.a > 0.0035) {gl_FragColor = vec4(color.rgb/color.a, color.a * alphaValue);} else {gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);}",e.PARTICLE_VERTEX_BODY=e.REGULAR_VERTEX_BODY,e.PARTICLE_FRAGMENT_BODY=e.REGULAR_FRAGMENT_BODY,e.COVER_VERTEX_HEADER=(e.COVER_VARYING_HEADER="precision mediump float;varying highp vec2 vRenderCoord;varying highp vec2 vTextureCoord;")+"attribute vec2 vertexPosition;attribute vec2 uvPosition;uniform float uUpright;",e.COVER_FRAGMENT_HEADER=e.COVER_VARYING_HEADER+"uniform sampler2D uSampler;",e.COVER_VERTEX_BODY="void main(void) {gl_Position = vec4(vertexPosition.x, vertexPosition.y, 0.0, 1.0);vRenderCoord = uvPosition;vTextureCoord = vec2(uvPosition.x, abs(uUpright - uvPosition.y));}",e.COVER_FRAGMENT_BODY="void main(void) {vec4 color = texture2D(uSampler, vRenderCoord);gl_FragColor = color;}",v._get_isWebGL=function(){return!!this._webGLContext},v._set_autoPurge=function(a){(a=isNaN(a)?1200:a)!=-1&&(a=a<10?10:a),this._autoPurge=a},v._get_autoPurge=function(){return Number(this._autoPurge)};try{Object.defineProperties(v,{isWebGL:{get:v._get_isWebGL},autoPurge:{get:v._get_autoPurge,set:v._set_autoPurge}})}catch(a){}v._initializeWebGL=function(){if(this.canvas){if(!this._webGLContext||this._webGLContext.canvas!==this.canvas){var a={depth:!1,alpha:this._transparent,stencil:!0,antialias:this._antialias,premultipliedAlpha:this._premultiply,preserveDrawingBuffer:this._preserveBuffer},a=this._webGLContext=this._fetchWebGLContext(this.canvas,a);if(!a)return null;this.updateSimultaneousTextureCount(a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS)),this._maxTextureSlots=a.getParameter(a.MAX_COMBINED_TEXTURE_IMAGE_UNITS),this._createBuffers(a),this._initTextures(a),a.disable(a.DEPTH_TEST),a.enable(a.BLEND),a.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA),a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this._premultiply),this._webGLContext.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearColor.a),this.updateViewport(this._viewportWidth||this.canvas.width,this._viewportHeight||this.canvas.height)}}else this._webGLContext=null;return this._webGLContext},v.update=function(a){this.canvas&&(this.tickOnUpdate&&this.tick(a),this.dispatchEvent("drawstart"),this.autoClear&&this.clear(),this._webGLContext?(this._batchDraw(this,this._webGLContext),this._autoPurge==-1||this._drawID%(this._autoPurge/2|0)||this.purgeTextures(this._autoPurge)):((a=this.canvas.getContext("2d")).save(),this.updateContext(a),this.draw(a,!1),a.restore()),this.dispatchEvent("drawend"))},v.clear=function(){var a,u,c;this.canvas&&(e.isWebGLActive(this._webGLContext)?(a=this._webGLContext,u=this._clearColor,c=this._transparent?u.a:1,this._webGLContext.clearColor(u.r*c,u.g*c,u.b*c,c),a.clear(a.COLOR_BUFFER_BIT),this._webGLContext.clearColor(u.r,u.g,u.b,u.a)):this.Stage_clear())},v.draw=function(a,u){if(a===this._webGLContext&&e.isWebGLActive(this._webGLContext)){var c=this._webGLContext;return this._batchDraw(this,c,u),!0}return this.Stage_draw(a,u)},v.cacheDraw=function(a,u,c){if(e.isWebGLActive(this._webGLContext)){var x=this._webGLContext;return this._cacheDraw(x,a,u,c),!0}return!1},v.protectTextureSlot=function(a,u){if(a>this._maxTextureSlots||a<0)throw"Slot outside of acceptable range";this._slotBlacklist[a]=!!u},v.getTargetRenderTexture=function(a,u,c){var x=!1,N=this._webGLContext;if(a.__lastRT!==void 0&&a.__lastRT===a.__rtA&&(x=!0),!(N=x?(a.__rtB===void 0?a.__rtB=this.getRenderBufferTexture(u,c):(u==a.__rtB._width&&c==a.__rtB._height||this.resizeTexture(a.__rtB,u,c),this.setTextureParams(N)),a.__rtB):(a.__rtA===void 0?a.__rtA=this.getRenderBufferTexture(u,c):(u==a.__rtA._width&&c==a.__rtA._height||this.resizeTexture(a.__rtA,u,c),this.setTextureParams(N)),a.__rtA)))throw"Problems creating render textures, known causes include using too much VRAM by not releasing WebGL texture instances";return a.__lastRT=N},v.releaseTexture=function(a){var u,c;if(a){if(a.children)for(u=0,c=a.children.length;u<c;u++)this.releaseTexture(a.children[u]);a.cacheCanvas&&a.uncache();var x=void 0;if(a._storeID!==void 0){if(a===this._textureDictionary[a._storeID])return this._killTextureObject(a),void(a._storeID=void 0);x=a}else if(a._webGLRenderStyle===2)x=a.image;else if(a._webGLRenderStyle===1){for(u=0,c=a.spriteSheet._images.length;u<c;u++)this.releaseTexture(a.spriteSheet._images[u]);return}x!==void 0?(this._killTextureObject(this._textureDictionary[x._storeID]),x._storeID=void 0):this.vocalDebug&&console.log("No associated texture found on release")}},v.purgeTextures=function(a){a==null&&(a=100);for(var u=this._textureDictionary,c=u.length,x=0;x<c;x++){var N=u[x];N&&N._drawID+a<=this._drawID&&this._killTextureObject(N)}},v.updateSimultaneousTextureCount=function(a){var u=this._webGLContext,c=!1;for((a<1||isNaN(a))&&(a=1),this._batchTextureCount=a;!c;)try{this._activeShader=this._fetchShaderProgram(u),c=!0}catch(x){if(this._batchTextureCount==1)throw"Cannot compile shader "+x;this._batchTextureCount-=4,this._batchTextureCount<1&&(this._batchTextureCount=1),this.vocalDebug&&console.log("Reducing desired texture count due to errors: "+this._batchTextureCount)}},v.updateViewport=function(a,u){this._viewportWidth=0|a,this._viewportHeight=0|u,u=this._webGLContext,u&&(u.viewport(0,0,this._viewportWidth,this._viewportHeight),this._projectionMatrix=new Float32Array([2/this._viewportWidth,0,0,0,0,-2/this._viewportHeight,1,0,0,0,1,0,-1,1,.1,0]),this._projectionMatrixFlip=new Float32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),this._projectionMatrixFlip.set(this._projectionMatrix),this._projectionMatrixFlip[5]*=-1,this._projectionMatrixFlip[13]*=-1)},v.getFilterShader=function(a){a=a||this;var u=this._webGLContext,c=this._activeShader;if(a._builtShader)c=a._builtShader,a.shaderParamSetup&&(u.useProgram(c),a.shaderParamSetup(u,this,c));else try{c=this._fetchShaderProgram(u,"filter",a.VTX_SHADER_BODY,a.FRAG_SHADER_BODY,a.shaderParamSetup&&a.shaderParamSetup.bind(a)),(a._builtShader=c)._name=a.toString()}catch(x){console&&console.log("SHADER SWITCH FAILURE",x)}return c},v.getBaseTexture=function(N,z){var c=Math.ceil(0<N?N:1)||1,x=Math.ceil(0<z?z:1)||1,N=this._webGLContext,z=N.createTexture();return this.resizeTexture(z,c,x),this.setTextureParams(N,!1),z},v.resizeTexture=function(a,u,c){var x=this._webGLContext;x.bindTexture(x.TEXTURE_2D,a),x.texImage2D(x.TEXTURE_2D,0,x.RGBA,u,c,0,x.RGBA,x.UNSIGNED_BYTE,null),a.width=u,a.height=c},v.getRenderBufferTexture=function(a,u){var c=this._webGLContext,x=this.getBaseTexture(a,u);if(!x)return null;var N=c.createFramebuffer();return N?(x.width=a,x.height=u,c.bindFramebuffer(c.FRAMEBUFFER,N),c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,x,0),(N._renderTexture=x)._frameBuffer=N,x._storeID=this._textureDictionary.length,this._textureDictionary[x._storeID]=x,c.bindFramebuffer(c.FRAMEBUFFER,null),x):null},v.setTextureParams=function(a,u){u&&this._antialias?(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR)):(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST)),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE)},v.setClearColor=function(a){var u,c,x,N,z;typeof a=="string"?a.indexOf("#")==0?(a.length==4&&(a="#"+a.charAt(1)+a.charAt(1)+a.charAt(2)+a.charAt(2)+a.charAt(3)+a.charAt(3)),u=+("0x"+a.slice(1,3))/255,c=+("0x"+a.slice(3,5))/255,x=+("0x"+a.slice(5,7))/255,N=+("0x"+a.slice(7,9))/255):a.indexOf("rgba(")==0&&(z=a.slice(5,-1).split(","),u=Number(z[0])/255,c=Number(z[1])/255,x=Number(z[2])/255,N=Number(z[3])):(u=((4278190080&a)>>>24)/255,c=((16711680&a)>>>16)/255,x=((65280&a)>>>8)/255,N=(255&a)/255),this._clearColor.r=u||0,this._clearColor.g=c||0,this._clearColor.b=x||0,this._clearColor.a=N||0,this._webGLContext&&this._webGLContext.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearColor.a)},v.toString=function(){return"[StageGL (name="+this.name+")]"},v._fetchWebGLContext=function(a,u){var c,x;try{c=a.getContext("webgl",u)||a.getContext("experimental-webgl",u)}catch(N){}return c?(c.viewportWidth=a.width,c.viewportHeight=a.height):(x="Could not initialize WebGL",console.error?console.error(x):console.log(x)),c},v._fetchShaderProgram=function(a,u,c,x,N){var z,oe;switch(a.useProgram(null),u){case"filter":oe=e.COVER_VERTEX_HEADER+(c||e.COVER_VERTEX_BODY),z=e.COVER_FRAGMENT_HEADER+(x||e.COVER_FRAGMENT_BODY);break;case"particle":oe=e.REGULAR_VERTEX_HEADER+e.PARTICLE_VERTEX_BODY,z=e.REGULAR_FRAGMENT_HEADER+e.PARTICLE_FRAGMENT_BODY;break;case"override":oe=e.REGULAR_VERTEX_HEADER+(c||e.REGULAR_VERTEX_BODY),z=e.REGULAR_FRAGMENT_HEADER+(x||e.REGULAR_FRAGMENT_BODY);break;case"regular":default:oe=e.REGULAR_VERTEX_HEADER+e.REGULAR_VERTEX_BODY,z=e.REGULAR_FRAGMENT_HEADER+e.REGULAR_FRAGMENT_BODY}var Ee=this._createShader(a,a.VERTEX_SHADER,oe),ke=this._createShader(a,a.FRAGMENT_SHADER,z),t=a.createProgram();if(a.attachShader(t,Ee),a.attachShader(t,ke),a.linkProgram(t),t._type=u,!a.getProgramParameter(t,a.LINK_STATUS))throw a.useProgram(this._activeShader),a.getProgramInfoLog(t);switch(a.useProgram(t),u){case"filter":t.vertexPositionAttribute=a.getAttribLocation(t,"vertexPosition"),a.enableVertexAttribArray(t.vertexPositionAttribute),t.uvPositionAttribute=a.getAttribLocation(t,"uvPosition"),a.enableVertexAttribArray(t.uvPositionAttribute),t.samplerUniform=a.getUniformLocation(t,"uSampler"),a.uniform1i(t.samplerUniform,0),t.uprightUniform=a.getUniformLocation(t,"uUpright"),a.uniform1f(t.uprightUniform,0),N&&N(a,this,t);break;case"override":case"particle":case"regular":default:t.vertexPositionAttribute=a.getAttribLocation(t,"vertexPosition"),a.enableVertexAttribArray(t.vertexPositionAttribute),t.uvPositionAttribute=a.getAttribLocation(t,"uvPosition"),a.enableVertexAttribArray(t.uvPositionAttribute),t.textureIndexAttribute=a.getAttribLocation(t,"textureIndex"),a.enableVertexAttribArray(t.textureIndexAttribute),t.alphaAttribute=a.getAttribLocation(t,"objectAlpha"),a.enableVertexAttribArray(t.alphaAttribute);for(var r=[],i=0;i<this._batchTextureCount;i++)r[i]=i;t.samplerData=r,t.samplerUniform=a.getUniformLocation(t,"uSampler"),a.uniform1iv(t.samplerUniform,r),t.pMatrixUniform=a.getUniformLocation(t,"pMatrix")}return a.useProgram(this._activeShader),t},v._createShader=function(a,u,c){c=c.replace(/{{count}}/g,this._batchTextureCount);for(var x="",N=1;N<this._batchTextureCount;N++)x+="} else if (indexPicker <= "+N+".5) { color = texture2D(uSampler["+N+"], vTextureCoord);";if(c=(c=c.replace(/{{alternates}}/g,x)).replace(/{{fragColor}}/g,this._premultiply?e.REGULAR_FRAG_COLOR_PREMULTIPLY:e.REGULAR_FRAG_COLOR_NORMAL),u=a.createShader(u),a.shaderSource(u,c),a.compileShader(u),!a.getShaderParameter(u,a.COMPILE_STATUS))throw a.getShaderInfoLog(u);return u},v._createBuffers=function(a){var u,c=this._maxCardsPerBatch*e.INDICIES_PER_CARD,x=this._vertexPositionBuffer=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,x),u=2;for(var N=this._vertices=new Float32Array(c*u),z=0,oe=N.length;z<oe;z+=u)N[z]=N[z+1]=0;a.bufferData(a.ARRAY_BUFFER,N,a.DYNAMIC_DRAW),x.itemSize=u,x.numItems=c,x=this._uvPositionBuffer=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,x),u=2;var Ee=this._uvs=new Float32Array(c*u);for(z=0,oe=Ee.length;z<oe;z+=u)Ee[z]=Ee[z+1]=0;a.bufferData(a.ARRAY_BUFFER,Ee,a.DYNAMIC_DRAW),x.itemSize=u,x.numItems=c,x=this._textureIndexBuffer=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,x),u=1;var ke=this._indices=new Float32Array(c*u);for(z=0,oe=ke.length;z<oe;z++)ke[z]=0;a.bufferData(a.ARRAY_BUFFER,ke,a.DYNAMIC_DRAW),x.itemSize=u,x.numItems=c,x=this._alphaBuffer=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,x),u=1;var t=this._alphas=new Float32Array(c*u);for(z=0,oe=t.length;z<oe;z++)t[z]=1;a.bufferData(a.ARRAY_BUFFER,t,a.DYNAMIC_DRAW),x.itemSize=u,x.numItems=c},v._initTextures=function(){this._lastTextureInsert=-1,this._textureDictionary=[],this._textureIDs={},this._baseTextures=[],this._batchTextures=[];for(var a=0;a<this._batchTextureCount;a++){var u=this.getBaseTexture();if(!(this._baseTextures[a]=this._batchTextures[a]=u))throw"Problems creating basic textures, known causes include using too much VRAM by not releasing WebGL texture instances"}},v._loadTextureImage=function(a,u){var c=u.src;c||(u._isCanvas=!0,c=u.src="canvas_"+this._lastTrackedCanvas++);var x=this._textureIDs[c];return x===void 0&&(x=this._textureIDs[c]=this._textureDictionary.length),this._textureDictionary[x]===void 0&&(this._textureDictionary[x]=this.getBaseTexture()),c=this._textureDictionary[x],c?(c._batchID=this._batchID,c._storeID=x,c._imageData=u,this._insertTextureInBatch(a,c),u._storeID=x,u.complete||u.naturalWidth||u._isCanvas?this._updateTextureImageData(a,u):u.addEventListener("load",this._updateTextureImageData.bind(this,a,u))):(u="Problem creating desired texture, known causes include using too much VRAM by not releasing WebGL texture instances",console.error&&console.error(u)||console.log(u),(c=this._baseTextures[0])._batchID=this._batchID,c._storeID=-1,c._imageData=c,this._insertTextureInBatch(a,c)),c},v._updateTextureImageData=function(a,u){var c=u.width&u.width-1||u.height&u.height-1,x=this._textureDictionary[u._storeID];a.activeTexture(a.TEXTURE0+x._activeIndex),a.bindTexture(a.TEXTURE_2D,x),x.isPOT=!c,this.setTextureParams(a,x.isPOT);try{a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,u)}catch(z){var N="\nAn error has occurred. This is most likely due to security restrictions on WebGL images with local or cross-domain origins";console.error?(console.error(N),console.error(z)):console&&(console.log(N),console.log(z))}u._invalid=!1,x._w=u.width,x._h=u.height,this.vocalDebug&&(c&&console.warn("NPOT(Non Power of Two) Texture: "+u.src),(u.width>a.MAX_TEXTURE_SIZE||u.height>a.MAX_TEXTURE_SIZE)&&console&&console.error("Oversized Texture: "+u.width+"x"+u.height+" vs "+a.MAX_TEXTURE_SIZE+"max"))},v._insertTextureInBatch=function(a,u){if(this._batchTextures[u._activeIndex]!==u){var c=-1,x=(this._lastTextureInsert+1)%this._batchTextureCount,N=x;do if(this._batchTextures[N]._batchID!=this._batchID&&!this._slotBlacklist[N]){c=N;break}while((N=(N+1)%this._batchTextureCount)!==x);c===-1&&(this.batchReason="textureOverflow",this._drawBuffers(a),this.batchCardCount=0,c=x),(this._batchTextures[c]=u)._activeIndex=c,(z=u._imageData)&&z._invalid&&u._drawID!==void 0?this._updateTextureImageData(a,z):(a.activeTexture(a.TEXTURE0+c),a.bindTexture(a.TEXTURE_2D,u),this.setTextureParams(a)),this._lastTextureInsert=c}else{var z=u._imageData;u._storeID!=null&&z&&z._invalid&&this._updateTextureImageData(a,z)}u._drawID=this._drawID,u._batchID=this._batchID},v._killTextureObject=function(a){if(a){var u=this._webGLContext;if(a._storeID!==void 0&&0<=a._storeID){for(var c in this._textureDictionary[a._storeID]=void 0,this._textureIDs)this._textureIDs[c]==a._storeID&&delete this._textureIDs[c];a._imageData&&(a._imageData._storeID=void 0),a._imageData=a._storeID=void 0}a._activeIndex!==void 0&&this._batchTextures[a._activeIndex]===a&&(this._batchTextures[a._activeIndex]=this._baseTextures[a._activeIndex]);try{a._frameBuffer&&u.deleteFramebuffer(a._frameBuffer),a._frameBuffer=void 0}catch(x){this.vocalDebug&&console.log(x)}try{u.deleteTexture(a)}catch(x){this.vocalDebug&&console.log(x)}}},v._backupBatchTextures=function(a,u){var c=this._webGLContext;this._backupTextures||(this._backupTextures=[]),u===void 0&&(u=this._backupTextures);for(var x=0;x<this._batchTextureCount;x++)c.activeTexture(c.TEXTURE0+x),a?this._batchTextures[x]=u[x]:(u[x]=this._batchTextures[x],this._batchTextures[x]=this._baseTextures[x]),c.bindTexture(c.TEXTURE_2D,this._batchTextures[x]),this.setTextureParams(c,this._batchTextures[x].isPOT);a&&u===this._backupTextures&&(this._backupTextures=[])},v._batchDraw=function(a,u,c){0<this._isDrawing&&this._drawBuffers(u),this._isDrawing++,this._drawID++,this.batchCardCount=0,this.depth=0,this._appendToBatchGroup(a,u,new ne.Matrix2D,this.alpha,c),this.batchReason="drawFinish",this._drawBuffers(u),this._isDrawing--},v._cacheDraw=function(a,u,c,x){var N=this._activeShader,z=this._slotBlacklist,oe=this._maxTextureSlots-1,Ee=this._viewportWidth,ke=this._viewportHeight;this.protectTextureSlot(oe,!0);var t=u.getMatrix();(t=t.clone()).scale(1/x.scale,1/x.scale),(t=t.invert()).translate(-x.offX/x.scale*u.scaleX,-x.offY/x.scale*u.scaleY);var r=this._cacheContainer;r.children=[u],r.transformMatrix=t,this._backupBatchTextures(!1),c&&c.length?this._drawFilters(u,c,x):this.isCacheControlled?(a.clear(a.COLOR_BUFFER_BIT),this._batchDraw(r,a,!0)):(a.activeTexture(a.TEXTURE0+oe),u.cacheCanvas=this.getTargetRenderTexture(u,x._drawWidth,x._drawHeight),u=u.cacheCanvas,a.bindFramebuffer(a.FRAMEBUFFER,u._frameBuffer),this.updateViewport(x._drawWidth,x._drawHeight),this._projectionMatrix=this._projectionMatrixFlip,a.clear(a.COLOR_BUFFER_BIT),this._batchDraw(r,a,!0),a.bindFramebuffer(a.FRAMEBUFFER,null),this.updateViewport(Ee,ke)),this._backupBatchTextures(!0),this.protectTextureSlot(oe,!1),this._activeShader=N,this._slotBlacklist=z},v._drawFilters=function(a,u,c){var x,N=this._webGLContext,z=this._maxTextureSlots-1,oe=this._viewportWidth,Ee=this._viewportHeight,ke=this._cacheContainer,t=u.length;N.activeTexture(N.TEXTURE0+z),x=this.getTargetRenderTexture(a,c._drawWidth,c._drawHeight),N.bindFramebuffer(N.FRAMEBUFFER,x._frameBuffer),this.updateViewport(c._drawWidth,c._drawHeight),N.clear(N.COLOR_BUFFER_BIT),this._batchDraw(ke,N,!0),N.activeTexture(N.TEXTURE0),N.bindTexture(N.TEXTURE_2D,x),this.setTextureParams(N);for(var r=!1,i=0,o=u[i];this._activeShader=this.getFilterShader(o),this._activeShader&&(N.activeTexture(N.TEXTURE0+z),x=this.getTargetRenderTexture(a,c._drawWidth,c._drawHeight),N.bindFramebuffer(N.FRAMEBUFFER,x._frameBuffer),N.viewport(0,0,c._drawWidth,c._drawHeight),N.clear(N.COLOR_BUFFER_BIT),this._drawCover(N,r),N.activeTexture(N.TEXTURE0),N.bindTexture(N.TEXTURE_2D,x),this.setTextureParams(N),(1<t||u[0]._multiPass)&&(r=!r),o=o._multiPass!==null?o._multiPass:u[++i]),o;);this.isCacheControlled?(N.bindFramebuffer(N.FRAMEBUFFER,null),this.updateViewport(oe,Ee),this._activeShader=this.getFilterShader(this),N.clear(N.COLOR_BUFFER_BIT),this._drawCover(N,r)):(r&&(N.activeTexture(N.TEXTURE0+z),x=this.getTargetRenderTexture(a,c._drawWidth,c._drawHeight),N.bindFramebuffer(N.FRAMEBUFFER,x._frameBuffer),this._activeShader=this.getFilterShader(this),N.viewport(0,0,c._drawWidth,c._drawHeight),N.clear(N.COLOR_BUFFER_BIT),this._drawCover(N,!r)),N.bindFramebuffer(N.FRAMEBUFFER,null),this.updateViewport(oe,Ee),a.cacheCanvas=x)},v._appendToBatchGroup=function(a,u,c,x,N){a._glMtx||(a._glMtx=new ne.Matrix2D);var z,oe,Ee,ke,t=a._glMtx;t.copy(c),a.transformMatrix?t.appendMatrix(a.transformMatrix):t.appendTransform(a.x,a.y,a.scaleX,a.scaleY,a.rotation,a.skewX,a.skewY,a.regX,a.regY);for(var r=a.children.length,i=0;i<r;i++){var o=a.children[i];if(o.visible&&x)if(o.cacheCanvas&&!N||(o._updateState&&o._updateState(),!o.children)){this.batchCardCount+1>this._maxCardsPerBatch&&(this.batchReason="vertexOverflow",this._drawBuffers(u),this.batchCardCount=0),o._glMtx||(o._glMtx=new ne.Matrix2D);var l,f,h,p,_=o._glMtx;_.copy(t),o.transformMatrix?_.appendMatrix(o.transformMatrix):_.appendTransform(o.x,o.y,o.scaleX,o.scaleY,o.rotation,o.skewX,o.skewY,o.regX,o.regY);var b=o.cacheCanvas&&!N;if(o._webGLRenderStyle===2||b)l=!N&&o.cacheCanvas||o.image;else{if(o._webGLRenderStyle!==1||(f=o.spriteSheet.getFrame(o.currentFrame))===null)continue;l=f.image}var w=this._uvs,C=this._vertices,O=this._indices,P=this._alphas;if(l){if(l._storeID===void 0)h=this._loadTextureImage(u,l),this._insertTextureInBatch(u,h);else{if(!(h=this._textureDictionary[l._storeID])){this.vocalDebug&&console.log("Texture should not be looked up while not being stored.");continue}h._batchID!==this._batchID&&this._insertTextureInBatch(u,h)}var A,R=h._activeIndex;o._webGLRenderStyle===2||b?ke=!b&&o.sourceRect?(o._uvRect||(o._uvRect={}),p=o.sourceRect,(A=o._uvRect).t=p.y/l.height,A.l=p.x/l.width,A.b=(p.y+p.height)/l.height,A.r=(p.x+p.width)/l.width,oe=z=0,Ee=p.width+z,p.height+oe):(A=e.UV_RECT,b?(z=(p=o.bitmapCache).x+p._filterOffX/p.scale,oe=p.y+p._filterOffY/p.scale,Ee=p._drawWidth/p.scale+z,p._drawHeight/p.scale+oe):(oe=z=0,Ee=l.width+z,l.height+oe)):o._webGLRenderStyle===1&&(T=f.rect,A=(A=f.uvRect)||e.buildUVRects(o.spriteSheet,o.currentFrame,!1),z=-f.regX,oe=-f.regY,Ee=T.width-f.regX,ke=T.height-f.regY);var b=this.batchCardCount*e.INDICIES_PER_CARD,T=2*b;C[T]=z*_.a+oe*_.c+_.tx,C[1+T]=z*_.b+oe*_.d+_.ty,C[2+T]=z*_.a+ke*_.c+_.tx,C[3+T]=z*_.b+ke*_.d+_.ty,C[4+T]=Ee*_.a+oe*_.c+_.tx,C[5+T]=Ee*_.b+oe*_.d+_.ty,C[6+T]=C[2+T],C[7+T]=C[3+T],C[8+T]=C[4+T],C[9+T]=C[5+T],C[10+T]=Ee*_.a+ke*_.c+_.tx,C[11+T]=Ee*_.b+ke*_.d+_.ty,w[T]=A.l,w[1+T]=A.t,w[2+T]=A.l,w[3+T]=A.b,w[4+T]=A.r,w[5+T]=A.t,w[6+T]=A.l,w[7+T]=A.b,w[8+T]=A.r,w[9+T]=A.t,w[10+T]=A.r,w[11+T]=A.b,O[b]=O[1+b]=O[2+b]=O[3+b]=O[4+b]=O[5+b]=R,P[b]=P[1+b]=P[2+b]=P[3+b]=P[4+b]=P[5+b]=o.alpha*x,this.batchCardCount++}}else this._appendToBatchGroup(o,u,t,o.alpha*x)}},v._drawBuffers=function(a){if(!(this.batchCardCount<=0)){this.vocalDebug&&console.log("Draw["+this._drawID+":"+this._batchID+"] : "+this.batchReason);var u=this._activeShader,c=this._vertexPositionBuffer,x=this._textureIndexBuffer,N=this._uvPositionBuffer,z=this._alphaBuffer;a.useProgram(u),a.bindBuffer(a.ARRAY_BUFFER,c),a.vertexAttribPointer(u.vertexPositionAttribute,c.itemSize,a.FLOAT,!1,0,0),a.bufferSubData(a.ARRAY_BUFFER,0,this._vertices),a.bindBuffer(a.ARRAY_BUFFER,x),a.vertexAttribPointer(u.textureIndexAttribute,x.itemSize,a.FLOAT,!1,0,0),a.bufferSubData(a.ARRAY_BUFFER,0,this._indices),a.bindBuffer(a.ARRAY_BUFFER,N),a.vertexAttribPointer(u.uvPositionAttribute,N.itemSize,a.FLOAT,!1,0,0),a.bufferSubData(a.ARRAY_BUFFER,0,this._uvs),a.bindBuffer(a.ARRAY_BUFFER,z),a.vertexAttribPointer(u.alphaAttribute,z.itemSize,a.FLOAT,!1,0,0),a.bufferSubData(a.ARRAY_BUFFER,0,this._alphas),a.uniformMatrix4fv(u.pMatrixUniform,a.FALSE,this._projectionMatrix);for(var oe=0;oe<this._batchTextureCount;oe++){var Ee=this._batchTextures[oe];a.activeTexture(a.TEXTURE0+oe),a.bindTexture(a.TEXTURE_2D,Ee),this.setTextureParams(a,Ee.isPOT)}a.drawArrays(a.TRIANGLES,0,this.batchCardCount*e.INDICIES_PER_CARD),this._batchID++}},v._drawCover=function(a,u){0<this._isDrawing&&this._drawBuffers(a),this.vocalDebug&&console.log("Draw["+this._drawID+":"+this._batchID+"] : Cover");var c=this._activeShader,x=this._vertexPositionBuffer,N=this._uvPositionBuffer;a.clear(a.COLOR_BUFFER_BIT),a.useProgram(c),a.bindBuffer(a.ARRAY_BUFFER,x),a.vertexAttribPointer(c.vertexPositionAttribute,x.itemSize,a.FLOAT,!1,0,0),a.bufferSubData(a.ARRAY_BUFFER,0,e.COVER_VERT),a.bindBuffer(a.ARRAY_BUFFER,N),a.vertexAttribPointer(c.uvPositionAttribute,N.itemSize,a.FLOAT,!1,0,0),a.bufferSubData(a.ARRAY_BUFFER,0,u?e.COVER_UV_FLIP:e.COVER_UV),a.uniform1i(c.samplerUniform,0),a.uniform1f(c.uprightUniform,u?0:1),a.drawArrays(a.TRIANGLES,0,e.INDICIES_PER_CARD)},ne.StageGL=ne.promote(e,"Stage")}(),function(){function e(a){this.DisplayObject_constructor(),typeof a=="string"?(this.image=document.createElement("img"),this.image.src=a):this.image=a,this.sourceRect=null,this._webGLRenderStyle=ne.DisplayObject._StageGL_BITMAP}var v=ne.extend(e,ne.DisplayObject);v.initialize=e,v.isVisible=function(){var a=this.image,a=this.cacheCanvas||a&&(a.naturalWidth||a.getContext||2<=a.readyState);return!!(this.visible&&0<this.alpha&&this.scaleX!=0&&this.scaleY!=0&&a)},v.draw=function(a,u){if(this.DisplayObject_draw(a,u))return!0;var c,x,N,z,oe,Ee=this.image,ke=this.sourceRect;return Ee.getImage&&(Ee=Ee.getImage()),Ee&&(ke?(c=ke.x,x=ke.y,N=c+ke.width,z=x+ke.height,c<(u=oe=0)&&(oe-=c,c=0),(ke=Ee.width)<N&&(N=ke),x<0&&(u-=x,x=0),(ke=Ee.height)<z&&(z=ke),a.drawImage(Ee,c,x,N-c,z-x,oe,u,N-c,z-x)):a.drawImage(Ee,0,0)),!0},v.cache=function(a,u,c,x,N,z){this.bitmapCache||(this.bitmapCache=new ne.BitmapCache),this.bitmapCache.define(this,a,u,c,x,N,z)},v.updateCache=function(a){if(!this.bitmapCache)throw"cache() must be called before updateCache()";this.bitmapCache.update(a)},v.uncache=function(){this.bitmapCache&&(this.bitmapCache.release(),this.bitmapCache=void 0)},v.getCacheDataURL=function(){return this.bitmapCache?this.bitmapCache.getDataURL():null},v.getBounds=function(){var u=this.DisplayObject_getBounds();if(u)return u;var a=this.image,u=this.sourceRect||a;return a&&(a.naturalWidth||a.getContext||2<=a.readyState)?this._rectangle.setValues(0,0,u.width,u.height):null},v.clone=function(a){var u=this.image;return u&&a&&(u=u.cloneNode()),u=new e(u),this.sourceRect&&(u.sourceRect=this.sourceRect.clone()),this._cloneProps(u),u},v.toString=function(){return"[Bitmap (name="+this.name+")]"},ne.Bitmap=ne.promote(e,"DisplayObject")}(),function(){"use strict";function e(a,u){this.DisplayObject_constructor(),this.currentFrame=0,this.currentAnimation=null,this.paused=!0,this.spriteSheet=a,this.currentAnimationFrame=0,this.framerate=0,this._animation=null,this._currentFrame=null,this._skipAdvance=!1,this._webGLRenderStyle=ne.DisplayObject._StageGL_SPRITE,u!=null&&this.gotoAndPlay(u)}var v=ne.extend(e,ne.DisplayObject);v.initialize=e,v.isVisible=function(){var a=this.cacheCanvas||this.spriteSheet.complete;return!!(this.visible&&0<this.alpha&&this.scaleX!=0&&this.scaleY!=0&&a)},v.draw=function(a,u){if(this.DisplayObject_draw(a,u))return!0;this._normalizeFrame();var c=this.spriteSheet.getFrame(0|this._currentFrame);return c?(u=c.rect,u.width&&u.height&&a.drawImage(c.image,u.x,u.y,u.width,u.height,-c.regX,-c.regY,u.width,u.height),!0):!1},v.play=function(){this.paused=!1},v.stop=function(){this.paused=!0},v.gotoAndPlay=function(a){this.paused=!1,this._skipAdvance=!0,this._goto(a)},v.gotoAndStop=function(a){this.paused=!0,this._goto(a)},v.advance=function(a){var u=this.framerate||this.spriteSheet.framerate,u=u&&a!=null?a/(1e3/u):1;this._normalizeFrame(u)},v.getBounds=function(){return this.DisplayObject_getBounds()||this.spriteSheet.getFrameBounds(this.currentFrame,this._rectangle)},v.clone=function(){return this._cloneProps(new e(this.spriteSheet))},v.toString=function(){return"[Sprite (name="+this.name+")]"},v._cloneProps=function(a){return this.DisplayObject__cloneProps(a),a.currentFrame=this.currentFrame,a.currentAnimation=this.currentAnimation,a.paused=this.paused,a.currentAnimationFrame=this.currentAnimationFrame,a.framerate=this.framerate,a._animation=this._animation,a._currentFrame=this._currentFrame,a._skipAdvance=this._skipAdvance,a},v._tick=function(a){this.paused||(this._skipAdvance||this.advance(a&&a.delta),this._skipAdvance=!1),this.DisplayObject__tick(a)},v._normalizeFrame=function(a){a=a||0;var u=this._animation,c=this.paused,x=this._currentFrame;if(u){var N,z=u.speed||1,oe=this.currentAnimationFrame;if((N=u.frames.length)<=oe+a*z){var Ee=u.next;if(this._dispatchAnimationEnd(u,x,c,Ee,N-1))return;if(Ee)return this._goto(Ee,a-(N-oe)/z);this.paused=!0,oe=u.frames.length-1}else oe+=a*z;this.currentAnimationFrame=oe,this._currentFrame=u.frames[0|oe]}else if(x=this._currentFrame+=a,N=this.spriteSheet.getNumFrames(),N<=x&&0<N&&!this._dispatchAnimationEnd(u,x,c,N-1)&&(this._currentFrame-=N)>=N)return this._normalizeFrame();x=0|this._currentFrame,this.currentFrame!=x&&(this.currentFrame=x,this.dispatchEvent("change"))},v._dispatchAnimationEnd=function(a,u,c,x,N){var z,oe=a?a.name:null;return this.hasEventListener("animationend")&&((z=new ne.Event("animationend")).name=oe,z.next=x,this.dispatchEvent(z)),u=this._animation!=a||this._currentFrame!=u,u||c||!this.paused||(this.currentAnimationFrame=N,u=!0),u},v._goto=function(a,u){var c;this.currentAnimationFrame=0,isNaN(a)?(c=this.spriteSheet.getAnimation(a))&&(this._animation=c,this.currentAnimation=a,this._normalizeFrame(u)):(this.currentAnimation=this._animation=null,this._currentFrame=a,this._normalizeFrame())},ne.Sprite=ne.promote(e,"DisplayObject")}(),function(){"use strict";function e(a){this.DisplayObject_constructor(),this.graphics=a||new ne.Graphics}var v=ne.extend(e,ne.DisplayObject);v.isVisible=function(){var a=this.cacheCanvas||this.graphics&&!this.graphics.isEmpty();return!!(this.visible&&0<this.alpha&&this.scaleX!=0&&this.scaleY!=0&&a)},v.draw=function(a,u){return this.DisplayObject_draw(a,u)||this.graphics.draw(a,this),!0},v.clone=function(a){return a=a&&this.graphics?this.graphics.clone():this.graphics,this._cloneProps(new e(a))},v.toString=function(){return"[Shape (name="+this.name+")]"},ne.Shape=ne.promote(e,"DisplayObject")}(),function(){"use strict";function e(u,c,x){this.DisplayObject_constructor(),this.text=u,this.font=c,this.color=x,this.textAlign="left",this.textBaseline="top",this.maxWidth=null,this.outline=0,this.lineHeight=0,this.lineWidth=null}var v=ne.extend(e,ne.DisplayObject),a=ne.createCanvas?ne.createCanvas():document.createElement("canvas");a.getContext&&(e._workingContext=a.getContext("2d"),a.width=a.height=1),e.H_OFFSETS={start:0,left:0,center:-.5,end:-1,right:-1},e.V_OFFSETS={top:0,hanging:-.01,middle:-.4,alphabetic:-.8,ideographic:-.85,bottom:-1},v.isVisible=function(){var u=this.cacheCanvas||this.text!=null&&this.text!=="";return!!(this.visible&&0<this.alpha&&this.scaleX!=0&&this.scaleY!=0&&u)},v.draw=function(u,c){return this.DisplayObject_draw(u,c)?!0:(c=this.color||"#000",this.outline?(u.strokeStyle=c,u.lineWidth=+this.outline):u.fillStyle=c,this._drawText(this._prepContext(u)),!0)},v.getMeasuredWidth=function(){return this._getMeasuredWidth(this.text)},v.getMeasuredLineHeight=function(){return 1.2*this._getMeasuredWidth("M")},v.getMeasuredHeight=function(){return this._drawText(null,{}).height},v.getBounds=function(){var N=this.DisplayObject_getBounds();if(N)return N;if(this.text==null||this.text==="")return null;var u=this._drawText(null,{}),c=this.maxWidth&&this.maxWidth<u.width?this.maxWidth:u.width,x=c*e.H_OFFSETS[this.textAlign||"left"],N=(this.lineHeight||this.getMeasuredLineHeight())*e.V_OFFSETS[this.textBaseline||"top"];return this._rectangle.setValues(x,N,c,u.height)},v.getMetrics=function(){var u={lines:[]};return u.lineHeight=this.lineHeight||this.getMeasuredLineHeight(),u.vOffset=u.lineHeight*e.V_OFFSETS[this.textBaseline||"top"],this._drawText(null,u,u.lines)},v.clone=function(){return this._cloneProps(new e(this.text,this.font,this.color))},v.toString=function(){return"[Text (text="+(20<this.text.length?this.text.substr(0,17)+"...":this.text)+")]"},v._cloneProps=function(u){return this.DisplayObject__cloneProps(u),u.textAlign=this.textAlign,u.textBaseline=this.textBaseline,u.maxWidth=this.maxWidth,u.outline=this.outline,u.lineHeight=this.lineHeight,u.lineWidth=this.lineWidth,u},v._prepContext=function(u){return u.font=this.font||"10px sans-serif",u.textAlign=this.textAlign||"left",u.textBaseline=this.textBaseline||"top",u.lineJoin="miter",u.miterLimit=2.5,u},v._drawText=function(u,c,x){var N=!!u;N||((u=e._workingContext).save(),this._prepContext(u));for(var z=this.lineHeight||this.getMeasuredLineHeight(),oe=0,Ee=0,ke=String(this.text).split(/(?:\r\n|\r|\n)/),t=0,r=ke.length;t<r;t++){var i=ke[t],o=null;if(this.lineWidth!=null&&(o=u.measureText(i).width)>this.lineWidth)for(var l=i.split(/(\s)/),i=l[0],o=u.measureText(i).width,f=1,h=l.length;f<h;f+=2){var p=u.measureText(l[f]+l[f+1]).width;o+p>this.lineWidth?(N&&this._drawTextLine(u,i,Ee*z),x&&x.push(i),oe<o&&(oe=o),i=l[f+1],o=u.measureText(i).width,Ee++):(i+=l[f]+l[f+1],o+=p)}N&&this._drawTextLine(u,i,Ee*z),x&&x.push(i),c&&o==null&&(o=u.measureText(i).width),oe<o&&(oe=o),Ee++}return c&&(c.width=oe,c.height=Ee*z),N||u.restore(),c},v._drawTextLine=function(u,c,x){this.outline?u.strokeText(c,0,x,this.maxWidth||65535):u.fillText(c,0,x,this.maxWidth||65535)},v._getMeasuredWidth=function(u){var c=e._workingContext;return c.save(),u=this._prepContext(c).measureText(u).width,c.restore(),u},ne.Text=ne.promote(e,"DisplayObject")}(),function(){"use strict";function e(a,u){this.Container_constructor(),this.text=a||"",this.spriteSheet=u,this.lineHeight=0,this.letterSpacing=0,this.spaceWidth=0,this._oldProps={text:0,spriteSheet:0,lineHeight:0,letterSpacing:0,spaceWidth:0},this._oldStage=null,this._drawAction=null}var v=ne.extend(e,ne.Container);e.maxPoolSize=100,e._spritePool=[],v.draw=function(a,u){this.DisplayObject_draw(a,u)||(this._updateState(),this.Container_draw(a,u))},v.getBounds=function(){return this._updateText(),this.Container_getBounds()},v.isVisible=function(){var a=this.cacheCanvas||this.spriteSheet&&this.spriteSheet.complete&&this.text;return!!(this.visible&&0<this.alpha&&this.scaleX!==0&&this.scaleY!==0&&a)},v.clone=function(){return this._cloneProps(new e(this.text,this.spriteSheet))},v.addChild=v.addChildAt=v.removeChild=v.removeChildAt=v.removeAllChildren=function(){},v._updateState=function(){this._updateText()},v._cloneProps=function(a){return this.Container__cloneProps(a),a.lineHeight=this.lineHeight,a.letterSpacing=this.letterSpacing,a.spaceWidth=this.spaceWidth,a},v._getFrameIndex=function(a,u){var c,x=u.getAnimation(a);return x||(a!=(c=a.toUpperCase())||a!=(c=a.toLowerCase())||(c=null),c&&(x=u.getAnimation(c))),x&&x.frames[0]},v._getFrame=function(a,u){return a=this._getFrameIndex(a,u),a==null?a:u.getFrame(a)},v._getLineHeight=function(a){return a=this._getFrame("1",a)||this._getFrame("T",a)||this._getFrame("L",a)||a.getFrame(0),a?a.rect.height:1},v._getSpaceWidth=function(a){return a=this._getFrame("1",a)||this._getFrame("l",a)||this._getFrame("e",a)||this._getFrame("a",a)||a.getFrame(0),a?a.rect.width:1},v._updateText=function(){var a,u,c=0,x=0,N=this._oldProps,z=!1,oe=this.spaceWidth,Ee=this.lineHeight,ke=this.spriteSheet,t=e._spritePool,r=this.children,i=0,o=r.length;for(u in N)N[u]!=this[u]&&(N[u]=this[u],z=!0);if(z){var l=!!this._getFrame(" ",ke);l||oe||(oe=this._getSpaceWidth(ke)),Ee=Ee||this._getLineHeight(ke);for(var f=0,h=this.text.length;f<h;f++){var p,_=this.text.charAt(f);_!=" "||l?_!="\n"&&_!="\r"?(p=this._getFrameIndex(_,ke))!=null&&(i<o?a=r[i]:(r.push(a=t.length?t.pop():new ne.Sprite),a.parent=this,o++),a.spriteSheet=ke,a.gotoAndStop(p),a.x=c,a.y=x,i++,c+=a.getBounds().width+this.letterSpacing):(_=="\r"&&this.text.charAt(f+1)=="\n"&&f++,c=0,x+=Ee):c+=oe}for(;i<o;)t.push(a=r.pop()),a.parent=null,o--;t.length>e.maxPoolSize&&(t.length=e.maxPoolSize)}},ne.BitmapText=ne.promote(e,"Container")}(),function(){"use strict";function e(u){var c,x,N,z;this.Container_constructor(),e.inited||e.init(),u instanceof String||1<arguments.length?(c=u,x=arguments[1],N=arguments[2],z=arguments[3],N==null&&(N=-1),u=null):u&&(c=u.mode,x=u.startPosition,N=u.loop,z=u.labels),u=u||{labels:z},this.mode=c||e.INDEPENDENT,this.startPosition=x||0,this.loop=N===!0?-1:N||0,this.currentFrame=0,this.paused=u.paused||!1,this.actionsEnabled=!0,this.autoReset=!0,this.frameBounds=this.frameBounds||u.frameBounds,this.framerate=null,u.useTicks=u.paused=!0,this.timeline=new ne.Timeline(u),this._synchOffset=0,this._rawPosition=-1,this._bound_resolveState=this._resolveState.bind(this),this._t=0,this._managed={}}var v=ne.extend(e,ne.Container);e.INDEPENDENT="independent",e.SINGLE_FRAME="single",e.SYNCHED="synched",e.inited=!1,e.init=function(){e.inited||(a.install(),e.inited=!0)},v._getLabels=function(){return this.timeline.getLabels()},v.getLabels=ne.deprecate(v._getLabels,"MovieClip.getLabels"),v._getCurrentLabel=function(){return this.timeline.currentLabel},v.getCurrentLabel=ne.deprecate(v._getCurrentLabel,"MovieClip.getCurrentLabel"),v._getDuration=function(){return this.timeline.duration},v.getDuration=ne.deprecate(v._getDuration,"MovieClip.getDuration");try{Object.defineProperties(v,{labels:{get:v._getLabels},currentLabel:{get:v._getCurrentLabel},totalFrames:{get:v._getDuration},duration:{get:v._getDuration}})}catch(u){}function a(){throw"MovieClipPlugin cannot be instantiated."}v.initialize=e,v.isVisible=function(){return!!(this.visible&&0<this.alpha&&this.scaleX!=0&&this.scaleY!=0)},v.draw=function(u,c){return this.DisplayObject_draw(u,c)||(this._updateState(),this.Container_draw(u,c)),!0},v.play=function(){this.paused=!1},v.stop=function(){this.paused=!0},v.gotoAndPlay=function(u){this.paused=!1,this._goto(u)},v.gotoAndStop=function(u){this.paused=!0,this._goto(u)},v.advance=function(u){var c=e.INDEPENDENT;if(this.mode===c){for(var x=this,N=x.framerate;(x=x.parent)&&N===null;)x.mode===c&&(N=x._framerate);if(this._framerate=N,!(this.totalFrames<=1)){var u=N!==null&&N!==-1&&u!==null?u/(1e3/N)+this._t:1,z=0|u;for(this._t=u-z;!this.paused&&z--;)this._updateTimeline(this._rawPosition+1,!1)}}},v.clone=function(){throw"MovieClip cannot be cloned."},v.toString=function(){return"[MovieClip (name="+this.name+")]"},v._updateState=function(){this._rawPosition!==-1&&this.mode===e.INDEPENDENT||this._updateTimeline(-1)},v._tick=function(u){this.advance(u&&u.delta),this.Container__tick(u)},v._goto=function(u){u=this.timeline.resolve(u),u!=null&&(this._t=0,this._updateTimeline(u,!0))},v._reset=function(){this._rawPosition=-1,this._t=this.currentFrame=0,this.paused=!1},v._updateTimeline=function(u,c){var x=this.mode!==e.INDEPENDENT,N=this.timeline;x&&(u=this.startPosition+(this.mode===e.SINGLE_FRAME?0:this._synchOffset)),u<0&&(u=0),this._rawPosition===u&&!x||(this._rawPosition=u,N.loop=this.loop,N.setPosition(u,x||!this.actionsEnabled,c,this._bound_resolveState))},v._renderFirstFrame=function(){var u=this.timeline,c=u.rawPosition;u.setPosition(0,!0,!0,this._bound_resolveState),u.rawPosition=c},v._resolveState=function(){var u,c=this.timeline;for(u in this.currentFrame=c.position,this._managed)this._managed[u]=1;for(var x=c.tweens,N=0,z=x.length;N<z;N++){var oe=x[N],Ee=oe.target;Ee===this||oe.passive||(oe=oe._stepPosition,Ee instanceof ne.DisplayObject?this._addManagedChild(Ee,oe):this._setState(Ee.state,oe))}for(var ke=this.children,N=ke.length-1;0<=N;N--){var t=ke[N].id;this._managed[t]===1&&(this.removeChildAt(N),delete this._managed[t])}},v._setState=function(u,c){if(u)for(var x=u.length-1;0<=x;x--){var N,z=u[x],oe=z.t,Ee=z.p;for(N in Ee)oe[N]=Ee[N];this._addManagedChild(oe,c)}},v._addManagedChild=function(u,c){u._off||(this.addChildAt(u,0),u instanceof e&&(u._synchOffset=c,u.mode===e.INDEPENDENT&&u.autoReset&&!this._managed[u.id]&&u._reset()),this._managed[u.id]=2)},v._getBounds=function(u,c){var x=this.DisplayObject_getBounds();return x||this.frameBounds&&(x=this._rectangle.copy(this.frameBounds[this.currentFrame])),x?this._transformBounds(x,u,c):this.Container__getBounds(u,c)},ne.MovieClip=ne.promote(e,"Container"),a.priority=100,a.ID="MovieClip",a.install=function(){ne.Tween._installPlugin(a)},a.init=function(u,c,x){c==="startPosition"&&u.target instanceof e&&u._addPlugin(a)},a.step=function(u,c,x){},a.change=function(u,c,x,N,z,oe){if(x==="startPosition")return(z===1?c:c.prev).props[x]}}(),function(){"use strict";function e(){throw"SpriteSheetUtils cannot be instantiated"}var v=ne.createCanvas?ne.createCanvas():document.createElement("canvas");v.getContext&&(e._workingCanvas=v,e._workingContext=v.getContext("2d"),v.width=v.height=1),e.extractFrame=function(a,u){isNaN(u)&&(u=a.getAnimation(u).frames[0]);var c=a.getFrame(u);return c?(a=c.rect,u=e._workingCanvas,u.width=a.width,u.height=a.height,e._workingContext.drawImage(c.image,a.x,a.y,a.width,a.height,0,0,a.width,a.height),a=document.createElement("img"),a.src=u.toDataURL("image/png"),a):null},e.addFlippedFrames=ne.deprecate(null,"SpriteSheetUtils.addFlippedFrames"),e.mergeAlpha=ne.deprecate(null,"SpriteSheetUtils.mergeAlpha"),e._flip=function(a,u,c,x){for(var N=a._images,z=e._workingCanvas,oe=e._workingContext,Ee=N.length/u,ke=0;ke<Ee;ke++){var t=N[ke];t.__tmp=ke,oe.setTransform(1,0,0,1,0,0),oe.clearRect(0,0,z.width+1,z.height+1),z.width=t.width,z.height=t.height,oe.setTransform(c?-1:1,0,0,x?-1:1,c?t.width:0,x?t.height:0),oe.drawImage(t,0,0);var r=document.createElement("img");r.src=z.toDataURL("image/png"),r.width=t.width||t.naturalWidth,r.height=t.height||t.naturalHeight,N.push(r)}for(var i=a._frames,o=i.length/u,ke=0;ke<o;ke++){var l=(t=i[ke]).rect.clone(),f={image:r=N[t.image.__tmp+Ee*u],rect:l,regX:t.regX,regY:t.regY};c&&(l.x=(r.width||r.naturalWidth)-l.x-l.width,f.regX=l.width-t.regX),x&&(l.y=(r.height||r.naturalHeight)-l.y-l.height,f.regY=l.height-t.regY),i.push(f)}var h="_"+(c?"h":"")+(x?"v":""),p=a._animations,_=a._data,b=p.length/u;for(ke=0;ke<b;ke++){var w=p[ke],C={name:w+h,speed:(t=_[w]).speed,next:t.next,frames:[]};t.next&&(C.next+=h);for(var O=0,P=(i=t.frames).length;O<P;O++)C.frames.push(i[O]+o*u);_[C.name]=C,p.push(C.name)}},ne.SpriteSheetUtils=e}(),function(){"use strict";function e(a){this.EventDispatcher_constructor(),this.maxWidth=2048,this.maxHeight=2048,this.spriteSheet=null,this.scale=1,this.padding=1,this.timeSlice=.3,this.progress=-1,this.framerate=a||0,this._frames=[],this._animations={},this._data=null,this._nextFrameIndex=0,this._index=0,this._timerID=null,this._scale=1}var v=ne.extend(e,ne.EventDispatcher);e.ERR_DIMENSIONS="frame dimensions exceed max spritesheet dimensions",e.ERR_RUNNING="a build is already running",v.addFrame=function(a,u,c,x,N){if(this._data)throw e.ERR_RUNNING;return u=u||a.bounds||a.nominalBounds,!u&&a.getBounds&&(u=a.getBounds()),u?(c=c||1,this._frames.push({source:a,sourceRect:u,scale:c,funct:x,data:N,index:this._frames.length,height:u.height*c})-1):null},v.addAnimation=function(a,u,c,x){if(this._data)throw e.ERR_RUNNING;this._animations[a]={frames:u,next:c,speed:x}},v.addMovieClip=function(a,u,c,x,N,z){if(this._data)throw e.ERR_RUNNING;var oe=a.frameBounds,Ee=u||a.bounds||a.nominalBounds;if(!Ee&&a.getBounds&&(Ee=a.getBounds()),Ee||oe){for(var ke,t=this._frames.length,r=a.timeline.duration,i=0;i<r;i++){var o=oe&&oe[i]?oe[i]:Ee;this.addFrame(a,o,c,this._setupMovieClipFrame,{i,f:x,d:N})}var l,f=a.timeline._labels,h=[];for(l in f)h.push({index:f[l],label:l});if(h.length)for(h.sort(function(O,P){return O.index-P.index}),i=0,ke=h.length;i<ke;i++){for(var p=h[i].label,_=t+h[i].index,b=t+(i==ke-1?r:h[i+1].index),w=[],C=_;C<b;C++)w.push(C);z&&!(p=z(p,a,_,b))||this.addAnimation(p,w,!0)}}},v.build=function(){if(this._data)throw e.ERR_RUNNING;for(this._startBuild();this._drawNext(););return this._endBuild(),this.spriteSheet},v.buildAsync=function(a){if(this._data)throw e.ERR_RUNNING;this.timeSlice=a,this._startBuild();var u=this;this._timerID=setTimeout(function(){u._run()},50-50*Math.max(.01,Math.min(.99,this.timeSlice||.3)))},v.stopAsync=function(){clearTimeout(this._timerID),this._data=null},v.clone=function(){throw"SpriteSheetBuilder cannot be cloned."},v.toString=function(){return"[SpriteSheetBuilder]"},v._startBuild=function(){var a=this.padding||0;this.progress=0,this.spriteSheet=null,this._index=0,this._scale=this.scale;var u=[];this._data={images:[],frames:u,framerate:this.framerate,animations:this._animations};var c=this._frames.slice();if(c.sort(function(ke,t){return ke.height<=t.height?-1:1}),c[c.length-1].height+2*a>this.maxHeight)throw e.ERR_DIMENSIONS;for(var x=0,N=0,z=0;c.length;){var oe,Ee=this._fillRow(c,x,z,u,a);Ee.w>N&&(N=Ee.w),x+=Ee.h,Ee.h&&c.length||((oe=ne.createCanvas?ne.createCanvas():document.createElement("canvas")).width=this._getSize(N,this.maxWidth),oe.height=this._getSize(x,this.maxHeight),this._data.images[z]=oe,Ee.h||(N=x=0,z++))}},v._setupMovieClipFrame=function(a,u){var c=a.actionsEnabled;a.actionsEnabled=!1,a.gotoAndStop(u.i),a.actionsEnabled=c,u.f&&u.f(a,u.d,u.i)},v._getSize=function(a,u){for(var c=4;Math.pow(2,++c)<a;);return Math.min(u,Math.pow(2,c))},v._fillRow=function(a,u,c,x,N){for(var z=this.maxWidth,oe=this.maxHeight-(u+=N),Ee=N,ke=0,t=a.length-1;0<=t;t--){var r=a[t],i=this._scale*r.scale,p=r.sourceRect,o=r.source,l=Math.floor(i*p.x-N),f=Math.floor(i*p.y-N),h=Math.ceil(i*p.height+2*N),p=Math.ceil(i*p.width+2*N);if(z<p)throw e.ERR_DIMENSIONS;oe<h||z<Ee+p||(r.img=c,r.rect=new ne.Rectangle(Ee,u,p,h),ke=ke||h,a.splice(t,1),x[r.index]=[Ee,u,p,h,c,Math.round(-l+i*o.regX-N),Math.round(-f+i*o.regY-N)],Ee+=p)}return{w:Ee,h:ke}},v._endBuild=function(){this.spriteSheet=new ne.SpriteSheet(this._data),this._data=null,this.progress=1,this.dispatchEvent("complete")},v._run=function(){for(var a,u=50*Math.max(.01,Math.min(.99,this.timeSlice||.3)),c=new Date().getTime()+u,x=!1;c>new Date().getTime();)if(!this._drawNext()){x=!0;break}x?this._endBuild():(a=this)._timerID=setTimeout(function(){a._run()},50-u);var N=this.progress=this._index/this._frames.length;this.hasEventListener("progress")&&((u=new ne.Event("progress")).progress=N,this.dispatchEvent(u))},v._drawNext=function(){var a=this._frames[this._index],u=a.scale*this._scale,c=a.rect,x=a.sourceRect,N=this._data.images[a.img].getContext("2d");return a.funct&&a.funct(a.source,a.data),N.save(),N.beginPath(),N.rect(c.x,c.y,c.width,c.height),N.clip(),N.translate(Math.ceil(c.x-x.x*u),Math.ceil(c.y-x.y*u)),N.scale(u,u),a.source.draw(N),N.restore(),++this._index<this._frames.length},ne.SpriteSheetBuilder=ne.promote(e,"EventDispatcher")}(),function(){"use strict";function e(a){this.DisplayObject_constructor(),typeof a=="string"&&(a=document.getElementById(a)),this.mouseEnabled=!1;var u=a.style;u.position="absolute",u.transformOrigin=u.WebkitTransformOrigin=u.msTransformOrigin=u.MozTransformOrigin=u.OTransformOrigin="0% 0%",this.htmlElement=a,this._oldProps=null,this._oldStage=null,this._drawAction=null}var v=ne.extend(e,ne.DisplayObject);v.isVisible=function(){return this.htmlElement!=null},v.draw=function(a,u){return!0},v.cache=function(){},v.uncache=function(){},v.updateCache=function(){},v.hitTest=function(){},v.localToGlobal=function(){},v.globalToLocal=function(){},v.localToLocal=function(){},v.clone=function(){throw"DOMElement cannot be cloned."},v.toString=function(){return"[DOMElement (name="+this.name+")]"},v._tick=function(a){var u=this.stage;u&&u!==this._oldStage&&(this._drawAction&&u.off("drawend",this._drawAction),this._drawAction=u.on("drawend",this._handleDrawEnd,this),this._oldStage=u),this.DisplayObject__tick(a)},v._handleDrawEnd=function(a){var u,c,x,N,z,oe=this.htmlElement;oe&&(u=oe.style,x=(c=this.getConcatenatedDisplayProps(this._props)).matrix,(z=c.visible?"visible":"hidden")!=u.visibility&&(u.visibility=z),c.visible&&(N=1e4,(z=(oe=this._oldProps)&&oe.matrix)&&z.equals(x)||(z="matrix("+(x.a*N|0)/N+","+(x.b*N|0)/N+","+(x.c*N|0)/N+","+(x.d*N|0)/N+","+(x.tx+.5|0),u.transform=u.WebkitTransform=u.OTransform=u.msTransform=z+","+(x.ty+.5|0)+")",u.MozTransform=z+"px,"+(x.ty+.5|0)+"px)",(oe=oe||(this._oldProps=new ne.DisplayProps(!0,null))).matrix.copy(x)),oe.alpha!=c.alpha&&(u.opacity=""+(c.alpha*N|0)/N,oe.alpha=c.alpha)))},ne.DOMElement=ne.promote(e,"DisplayObject")}(),function(){"use strict";function e(){this.usesContext=!1,this._multiPass=null,this.VTX_SHADER_BODY=null,this.FRAG_SHADER_BODY=null}var v=e.prototype;v.getBounds=function(a){return a},v.shaderParamSetup=function(a,u,c){},v.applyFilter=function(a,u,c,x,N,z,oe,Ee){z=z||a,oe==null&&(oe=u),Ee==null&&(Ee=c);try{var ke=a.getImageData(u,c,x,N)}catch(t){return!1}return!!this._applyFilter(ke)&&(z.putImageData(ke,oe,Ee),!0)},v.toString=function(){return"[Filter]"},v.clone=function(){return new e},v._applyFilter=function(a){return!0},ne.Filter=e}(),function(){"use strict";function e(){this.width=void 0,this.height=void 0,this.x=void 0,this.y=void 0,this.scale=1,this.offX=0,this.offY=0,this.cacheID=0,this._filterOffX=0,this._filterOffY=0,this._cacheDataURLID=0,this._cacheDataURL=null,this._drawWidth=0,this._drawHeight=0}var v=e.prototype;e.getFilterBounds=function(a,u){u=u||new ne.Rectangle;var c=a.filters,x=c&&c.length;if(!!x<=0)return u;for(var N=0;N<x;N++){var z=c[N];z&&z.getBounds&&(z=z.getBounds())&&(N==0?u.setValues(z.x,z.y,z.width,z.height):u.extend(z.x,z.y,z.width,z.height))}return u},v.toString=function(){return"[BitmapCache]"},v.define=function(a,u,c,x,N,z,oe){if(!a)throw"No symbol to cache";this._options=oe,this.target=a,this.width=1<=x?x:1,this.height=1<=N?N:1,this.x=u||0,this.y=c||0,this.scale=z||1,this.update()},v.update=function(a){if(!this.target)throw"define() must be called before update()";var u=e.getFilterBounds(this.target),c=this.target.cacheCanvas;this._drawWidth=Math.ceil(this.width*this.scale)+u.width,this._drawHeight=Math.ceil(this.height*this.scale)+u.height,c&&this._drawWidth==c.width&&this._drawHeight==c.height||this._updateSurface(),this._filterOffX=u.x,this._filterOffY=u.y,this.offX=this.x*this.scale+this._filterOffX,this.offY=this.y*this.scale+this._filterOffY,this._drawToCache(a),this.cacheID=this.cacheID?this.cacheID+1:1},v.release=function(){var a;this._webGLCache?(this._webGLCache.isCacheControlled||(this.__lastRT&&(this.__lastRT=void 0),this.__rtA&&this._webGLCache._killTextureObject(this.__rtA),this.__rtB&&this._webGLCache._killTextureObject(this.__rtB),this.target&&this.target.cacheCanvas&&this._webGLCache._killTextureObject(this.target.cacheCanvas)),this._webGLCache=!1):(a=this.target.stage)instanceof ne.StageGL&&a.releaseTexture(this.target.cacheCanvas),this.target=this.target.cacheCanvas=null,this.cacheID=this._cacheDataURLID=this._cacheDataURL=void 0,this.width=this.height=this.x=this.y=this.offX=this.offY=0,this.scale=1},v.getCacheDataURL=function(){var a=this.target&&this.target.cacheCanvas;return a?(this.cacheID!=this._cacheDataURLID&&(this._cacheDataURLID=this.cacheID,this._cacheDataURL=a.toDataURL?a.getCacheDataURL():null),this._cacheDataURL):null},v.draw=function(a){return!!this.target&&(a.drawImage(this.target.cacheCanvas,this.x+this._filterOffX/this.scale,this.y+this._filterOffY/this.scale,this._drawWidth/this.scale,this._drawHeight/this.scale),!0)},v._updateSurface=function(){if(!this._options||!this._options.useGL)return(a=(a=this.target.cacheCanvas)||(this.target.cacheCanvas=ne.createCanvas?ne.createCanvas():document.createElement("canvas"))).width=this._drawWidth,void(a.height=this._drawHeight);if(!this._webGLCache)if(this._options.useGL==="stage"){if(!this.target.stage||!this.target.stage.isWebGL){var u="Cannot use 'stage' for cache because the object's parent stage is ";throw u+=this.target.stage?"non WebGL.":"not set, please addChild to the correct stage."}this.target.cacheCanvas=!0,this._webGLCache=this.target.stage}else if(this._options.useGL==="new")this.target.cacheCanvas=document.createElement("canvas"),this._webGLCache=new ne.StageGL(this.target.cacheCanvas,{antialias:!0,transparent:!0,autoPurge:-1}),this._webGLCache.isCacheControlled=!0;else{if(!(this._options.useGL instanceof ne.StageGL))throw"Invalid option provided to useGL, expected ['stage', 'new', StageGL, undefined], got "+this._options.useGL;this.target.cacheCanvas=!0,this._webGLCache=this._options.useGL,this._webGLCache.isCacheControlled=!0}var a=this.target.cacheCanvas,u=this._webGLCache;u.isCacheControlled&&(a.width=this._drawWidth,a.height=this._drawHeight,u.updateViewport(this._drawWidth,this._drawHeight)),this.target.filters?(u.getTargetRenderTexture(this.target,this._drawWidth,this._drawHeight),u.getTargetRenderTexture(this.target,this._drawWidth,this._drawHeight)):u.isCacheControlled||u.getTargetRenderTexture(this.target,this._drawWidth,this._drawHeight)},v._drawToCache=function(a){var u=this.target.cacheCanvas,c=this.target,x=this._webGLCache;x?(x.cacheDraw(c,c.filters,this),(u=this.target.cacheCanvas).width=this._drawWidth,u.height=this._drawHeight):(x=u.getContext("2d"),a||x.clearRect(0,0,this._drawWidth+1,this._drawHeight+1),x.save(),x.globalCompositeOperation=a,x.setTransform(this.scale,0,0,this.scale,-this._filterOffX,-this._filterOffY),x.translate(-this.x,-this.y),c.draw(x,!0),x.restore(),c.filters&&c.filters.length&&this._applyFilters(x)),u._invalid=!0},v._applyFilters=function(a){for(var u,c=this.target.filters,x=this._drawWidth,N=this._drawHeight,z=0,oe=c[z];oe.usesContext?(u&&(a.putImageData(u,0,0),u=null),oe.applyFilter(a,0,0,x,N)):(u=u||a.getImageData(0,0,x,N),oe._applyFilter(u)),oe=oe._multiPass!==null?oe._multiPass:c[++z],oe;);u&&a.putImageData(u,0,0)},ne.BitmapCache=e}(),function(){"use strict";function e(a,u,c){this.Filter_constructor(),this._blurX=a,this._blurXTable=[],this._lastBlurX=null,this._blurY=u,this._blurYTable=[],this._lastBlurY=null,this._quality,this._lastQuality=null,this.FRAG_SHADER_TEMPLATE="uniform float xWeight[{{blurX}}];uniform float yWeight[{{blurY}}];uniform vec2 textureOffset;void main(void) {vec4 color = vec4(0.0);float xAdj = ({{blurX}}.0-1.0)/2.0;float yAdj = ({{blurY}}.0-1.0)/2.0;vec2 sampleOffset;for(int i=0; i<{{blurX}}; i++) {for(int j=0; j<{{blurY}}; j++) {sampleOffset = vRenderCoord + (textureOffset * vec2(float(i)-xAdj, float(j)-yAdj));color += texture2D(uSampler, sampleOffset) * (xWeight[i] * yWeight[j]);}}gl_FragColor = color.rgba;}",(isNaN(c)||c<1)&&(c=1),this.setQuality(0|c)}var v=ne.extend(e,ne.Filter);v.getBlurX=function(){return this._blurX},v.getBlurY=function(){return this._blurY},v.setBlurX=function(a){(isNaN(a)||a<0)&&(a=0),this._blurX=a},v.setBlurY=function(a){(isNaN(a)||a<0)&&(a=0),this._blurY=a},v.getQuality=function(){return this._quality},v.setQuality=function(a){(isNaN(a)||a<0)&&(a=0),this._quality=0|a},v._getShader=function(){var a=this._lastBlurX!==this._blurX,u=this._lastBlurY!==this._blurY,c=this._lastQuality!==this._quality;return a||u||c?((a||c)&&(this._blurXTable=this._getTable(this._blurX*this._quality)),(u||c)&&(this._blurYTable=this._getTable(this._blurY*this._quality)),this._updateShader(),this._lastBlurX=this._blurX,this._lastBlurY=this._blurY,void(this._lastQuality=this._quality)):this._compiledShader},v._setShader=function(){this._compiledShader};try{Object.defineProperties(v,{blurX:{get:v.getBlurX,set:v.setBlurX},blurY:{get:v.getBlurY,set:v.setBlurY},quality:{get:v.getQuality,set:v.setQuality},_builtShader:{get:v._getShader,set:v._setShader}})}catch(a){console.log(a)}v._getTable=function(a){if(a<=1)return[1];for(var u=[],a=Math.ceil(2*a),c=(a+=a%2?0:1)/2|0,x=-c;x<=c;x++){var N=x/c*4.2;u.push(1/Math.sqrt(2*Math.PI)*Math.pow(Math.E,-Math.pow(N,2)/4))}var z=u.reduce(function(oe,Ee){return oe+Ee});return u.map(function(oe,Ee,ke){return oe/z})},v._updateShader=function(){var a;this._blurX!==void 0&&this._blurY!==void 0&&(a=(a=(a=this.FRAG_SHADER_TEMPLATE).replace(/\{\{blurX\}\}/g,this._blurXTable.length.toFixed(0))).replace(/\{\{blurY\}\}/g,this._blurYTable.length.toFixed(0)),this.FRAG_SHADER_BODY=a)},v.shaderParamSetup=function(a,u,c){a.uniform1fv(a.getUniformLocation(c,"xWeight"),this._blurXTable),a.uniform1fv(a.getUniformLocation(c,"yWeight"),this._blurYTable),a.uniform2f(a.getUniformLocation(c,"textureOffset"),2/(u._viewportWidth*this._quality),2/(u._viewportHeight*this._quality))},e.MUL_TABLE=[1,171,205,293,57,373,79,137,241,27,391,357,41,19,283,265,497,469,443,421,25,191,365,349,335,161,155,149,9,278,269,261,505,245,475,231,449,437,213,415,405,395,193,377,369,361,353,345,169,331,325,319,313,307,301,37,145,285,281,69,271,267,263,259,509,501,493,243,479,118,465,459,113,446,55,435,429,423,209,413,51,403,199,393,97,3,379,375,371,367,363,359,355,351,347,43,85,337,333,165,327,323,5,317,157,311,77,305,303,75,297,294,73,289,287,71,141,279,277,275,68,135,67,133,33,262,260,129,511,507,503,499,495,491,61,121,481,477,237,235,467,232,115,457,227,451,7,445,221,439,218,433,215,427,425,211,419,417,207,411,409,203,202,401,399,396,197,49,389,387,385,383,95,189,47,187,93,185,23,183,91,181,45,179,89,177,11,175,87,173,345,343,341,339,337,21,167,83,331,329,327,163,81,323,321,319,159,79,315,313,39,155,309,307,153,305,303,151,75,299,149,37,295,147,73,291,145,289,287,143,285,71,141,281,35,279,139,69,275,137,273,17,271,135,269,267,133,265,33,263,131,261,130,259,129,257,1],e.SHG_TABLE=[0,9,10,11,9,12,10,11,12,9,13,13,10,9,13,13,14,14,14,14,10,13,14,14,14,13,13,13,9,14,14,14,15,14,15,14,15,15,14,15,15,15,14,15,15,15,15,15,14,15,15,15,15,15,15,12,14,15,15,13,15,15,15,15,16,16,16,15,16,14,16,16,14,16,13,16,16,16,15,16,13,16,15,16,14,9,16,16,16,16,16,16,16,16,16,13,14,16,16,15,16,16,10,16,15,16,14,16,16,14,16,16,14,16,16,14,15,16,16,16,14,15,14,15,13,16,16,15,17,17,17,17,17,17,14,15,17,17,16,16,17,16,15,17,16,17,11,17,16,17,16,17,16,17,17,16,17,17,16,17,17,16,16,17,17,17,16,14,17,17,17,17,15,16,14,16,15,16,13,16,15,16,14,16,15,16,12,16,15,16,17,17,17,17,17,13,16,15,17,17,17,16,15,17,17,17,16,15,17,17,14,16,17,17,16,17,17,16,15,17,16,14,17,16,15,17,16,17,17,16,17,15,16,17,14,17,16,15,17,16,17,13,17,16,17,17,16,17,14,17,16,17,16,17,16,17,9],v.getBounds=function(a){var u=0|this.blurX,c=0|this.blurY;if(u<=0&&c<=0)return a;var x=Math.pow(this.quality,.2);return(a||new ne.Rectangle).pad(c*x+1,u*x+1,c*x+1,u*x+1)},v.clone=function(){return new e(this.blurX,this.blurY,this.quality)},v.toString=function(){return"[BlurFilter]"},v._applyFilter=function(a){var u=this._blurX>>1;if(isNaN(u)||u<0)return!1;var c=this._blurY>>1;if(isNaN(c)||c<0||u==0&&c==0)return!1;var x=this.quality;(isNaN(x)||x<1)&&(x=1),3<(x|=0)&&(x=3),x<1&&(x=1);for(var N=a.data,z=0,oe=0,k=0,Ee=0,ke=0,t=0,r=0,i=0,o=0,l=0,f=0,h=0,p=0,_=0,b=0,w=u+u+1|0,C=c+c+1|0,O=0|a.width,P=0|a.height,A=O-1|0,R=P-1|0,T=1+u|0,L=1+c|0,S={r:0,b:0,g:0,a:0},E=S,k=1;k<w;k++)E=E.n={r:0,b:0,g:0,a:0};E.n=S;var X={r:0,b:0,g:0,a:0},q=X;for(k=1;k<C;k++)q=q.n={r:0,b:0,g:0,a:0};q.n=X;for(var V=null,I=0|e.MUL_TABLE[u],te=0|e.SHG_TABLE[u],B=0|e.MUL_TABLE[c],Z=0|e.SHG_TABLE[c];0<x--;){r=t=0;for(var U=I,ee=te,oe=P;-1<--oe;){for(i=T*(h=N[0|t]),o=T*(p=N[t+1|0]),l=T*(_=N[t+2|0]),f=T*(b=N[t+3|0]),E=S,k=T;-1<--k;)E.r=h,E.g=p,E.b=_,E.a=b,E=E.n;for(k=1;k<T;k++)Ee=t+((A<k?A:k)<<2)|0,i+=E.r=N[Ee],o+=E.g=N[Ee+1],l+=E.b=N[Ee+2],f+=E.a=N[Ee+3],E=E.n;for(V=S,z=0;z<O;z++)N[t++]=i*U>>>ee,N[t++]=o*U>>>ee,N[t++]=l*U>>>ee,N[t++]=f*U>>>ee,Ee=r+((Ee=z+u+1)<A?Ee:A)<<2,i-=V.r-(V.r=N[Ee]),o-=V.g-(V.g=N[Ee+1]),l-=V.b-(V.b=N[Ee+2]),f-=V.a-(V.a=N[Ee+3]),V=V.n;r+=O}for(U=B,ee=Z,z=0;z<O;z++){for(i=L*(h=N[t=z<<2|0])|0,o=L*(p=N[t+1|0])|0,l=L*(_=N[t+2|0])|0,f=L*(b=N[t+3|0])|0,q=X,k=0;k<L;k++)q.r=h,q.g=p,q.b=_,q.a=b,q=q.n;for(ke=O,k=1;k<=c;k++)t=ke+z<<2,i+=q.r=N[t],o+=q.g=N[t+1],l+=q.b=N[t+2],f+=q.a=N[t+3],q=q.n,k<R&&(ke+=O);if(t=z,V=X,0<x)for(oe=0;oe<P;oe++)N[(Ee=t<<2)+3]=b=f*U>>>ee,0<b?(N[Ee]=i*U>>>ee,N[Ee+1]=o*U>>>ee,N[Ee+2]=l*U>>>ee):N[Ee]=N[Ee+1]=N[Ee+2]=0,Ee=z+((Ee=oe+L)<R?Ee:R)*O<<2,i-=V.r-(V.r=N[Ee]),o-=V.g-(V.g=N[Ee+1]),l-=V.b-(V.b=N[Ee+2]),f-=V.a-(V.a=N[Ee+3]),V=V.n,t+=O;else for(oe=0;oe<P;oe++)N[(Ee=t<<2)+3]=b=f*U>>>ee,0<b?(b=255/b,N[Ee]=(i*U>>>ee)*b,N[Ee+1]=(o*U>>>ee)*b,N[Ee+2]=(l*U>>>ee)*b):N[Ee]=N[Ee+1]=N[Ee+2]=0,Ee=z+((Ee=oe+L)<R?Ee:R)*O<<2,i-=V.r-(V.r=N[Ee]),o-=V.g-(V.g=N[Ee+1]),l-=V.b-(V.b=N[Ee+2]),f-=V.a-(V.a=N[Ee+3]),V=V.n,t+=O}}return!0},ne.BlurFilter=ne.promote(e,"Filter")}(),function(){"use strict";function e(a){this.Filter_constructor(),this.alphaMap=a,this._alphaMap=null,this._mapData=null,this._mapTexture=null,this.FRAG_SHADER_BODY="uniform sampler2D uAlphaSampler;void main(void) {vec4 color = texture2D(uSampler, vRenderCoord);vec4 alphaMap = texture2D(uAlphaSampler, vTextureCoord);gl_FragColor = vec4(color.rgb, color.a * (alphaMap.r * ceil(alphaMap.a)));}"}var v=ne.extend(e,ne.Filter);v.shaderParamSetup=function(a,u,c){this._mapTexture||(this._mapTexture=a.createTexture()),a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,this._mapTexture),u.setTextureParams(a),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,this.alphaMap),a.uniform1i(a.getUniformLocation(c,"uAlphaSampler"),1)},v.clone=function(){var a=new e(this.alphaMap);return a._alphaMap=this._alphaMap,a._mapData=this._mapData,a},v.toString=function(){return"[AlphaMapFilter]"},v._applyFilter=function(a){if(!this.alphaMap)return!0;if(!this._prepAlphaMap())return!1;for(var u=a.data,c=this._mapData,x=0,N=u.length;x<N;x+=4)u[x+3]=c[x]||0;return!0},v._prepAlphaMap=function(){if(!this.alphaMap)return!1;if(this.alphaMap==this._alphaMap&&this._mapData)return!0;this._mapData=null;var a,u=this._alphaMap=this.alphaMap,c=u;u instanceof HTMLCanvasElement?a=c.getContext("2d"):((c=ne.createCanvas?ne.createCanvas():document.createElement("canvas")).width=u.width,c.height=u.height,(a=c.getContext("2d")).drawImage(u,0,0));try{var x=a.getImageData(0,0,u.width,u.height)}catch(N){return!1}return this._mapData=x.data,!0},ne.AlphaMapFilter=ne.promote(e,"Filter")}(),function(){"use strict";function e(a){this.Filter_constructor(),this.mask=a,this.usesContext=!0,this.FRAG_SHADER_BODY="uniform sampler2D uAlphaSampler;void main(void) {vec4 color = texture2D(uSampler, vRenderCoord);vec4 alphaMap = texture2D(uAlphaSampler, vTextureCoord);gl_FragColor = vec4(color.rgb, color.a * alphaMap.a);}"}var v=ne.extend(e,ne.Filter);v.shaderParamSetup=function(a,u,c){this._mapTexture||(this._mapTexture=a.createTexture()),a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,this._mapTexture),u.setTextureParams(a),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,this.mask),a.uniform1i(a.getUniformLocation(c,"uAlphaSampler"),1)},v.applyFilter=function(a,u,c,x,N,z,oe,Ee){return!this.mask||(oe==null&&(oe=u),Ee==null&&(Ee=c),(z=z||a).save(),a==z&&(z.globalCompositeOperation="destination-in",z.drawImage(this.mask,oe,Ee),z.restore(),!0))},v.clone=function(){return new e(this.mask)},v.toString=function(){return"[AlphaMaskFilter]"},ne.AlphaMaskFilter=ne.promote(e,"Filter")}(),function(){"use strict";function e(a,u,c,x,N,z,oe,Ee){this.Filter_constructor(),this.redMultiplier=a!=null?a:1,this.greenMultiplier=u!=null?u:1,this.blueMultiplier=c!=null?c:1,this.alphaMultiplier=x!=null?x:1,this.redOffset=N||0,this.greenOffset=z||0,this.blueOffset=oe||0,this.alphaOffset=Ee||0,this.FRAG_SHADER_BODY="uniform vec4 uColorMultiplier;uniform vec4 uColorOffset;void main(void) {vec4 color = texture2D(uSampler, vRenderCoord);gl_FragColor = (color * uColorMultiplier) + uColorOffset;}"}var v=ne.extend(e,ne.Filter);v.shaderParamSetup=function(a,u,c){a.uniform4f(a.getUniformLocation(c,"uColorMultiplier"),this.redMultiplier,this.greenMultiplier,this.blueMultiplier,this.alphaMultiplier),a.uniform4f(a.getUniformLocation(c,"uColorOffset"),this.redOffset/255,this.greenOffset/255,this.blueOffset/255,this.alphaOffset/255)},v.toString=function(){return"[ColorFilter]"},v.clone=function(){return new e(this.redMultiplier,this.greenMultiplier,this.blueMultiplier,this.alphaMultiplier,this.redOffset,this.greenOffset,this.blueOffset,this.alphaOffset)},v._applyFilter=function(a){for(var u=a.data,c=u.length,x=0;x<c;x+=4)u[x]=u[x]*this.redMultiplier+this.redOffset,u[x+1]=u[x+1]*this.greenMultiplier+this.greenOffset,u[x+2]=u[x+2]*this.blueMultiplier+this.blueOffset,u[x+3]=u[x+3]*this.alphaMultiplier+this.alphaOffset;return!0},ne.ColorFilter=ne.promote(e,"Filter")}(),function(){"use strict";function e(a,u,c,x){this.setColor(a,u,c,x)}var v=e.prototype;e.DELTA_INDEX=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10],e.LENGTH=(e.IDENTITY_MATRIX=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1]).length,v.setColor=function(a,u,c,x){return this.reset().adjustColor(a,u,c,x)},v.reset=function(){return this.copy(e.IDENTITY_MATRIX)},v.adjustColor=function(a,u,c,x){return this.adjustHue(x),this.adjustContrast(u),this.adjustBrightness(a),this.adjustSaturation(c)},v.adjustBrightness=function(a){return a==0||isNaN(a)||(a=this._cleanValue(a,255),this._multiplyMatrix([1,0,0,0,a,0,1,0,0,a,0,0,1,0,a,0,0,0,1,0,0,0,0,0,1])),this},v.adjustContrast=function(a){return a==0||isNaN(a)||(u=(a=this._cleanValue(a,100))<0?127+a/100*127:127*(u=(u=a%1)==0?e.DELTA_INDEX[a]:e.DELTA_INDEX[a<<0]*(1-u)+e.DELTA_INDEX[1+(a<<0)]*u)+127,this._multiplyMatrix([u/127,0,0,0,.5*(127-u),0,u/127,0,0,.5*(127-u),0,0,u/127,0,.5*(127-u),0,0,0,1,0,0,0,0,0,1])),this;var u},v.adjustSaturation=function(a){return a==0||isNaN(a)?this:(a=1+(0<(a=this._cleanValue(a,100))?3*a/100:a/100),this._multiplyMatrix([.3086*(1-a)+a,.6094*(1-a),.082*(1-a),0,0,.3086*(1-a),.6094*(1-a)+a,.082*(1-a),0,0,.3086*(1-a),.6094*(1-a),.082*(1-a)+a,0,0,0,0,0,1,0,0,0,0,0,1]),this)},v.adjustHue=function(z){if(z==0||isNaN(z))return this;z=this._cleanValue(z,180)/180*Math.PI;var u=Math.cos(z),c=Math.sin(z),x=.213,N=.715,z=.072;return this._multiplyMatrix([x+.787*u+c*-x,N+u*-N+c*-N,z+u*-z+.928*c,0,0,x+u*-x+.143*c,N+u*(1-N)+.14*c,z+u*-z+-.283*c,0,0,x+u*-x+-.787*c,N+u*-N+c*N,z+.928*u+c*z,0,0,0,0,0,1,0,0,0,0,0,1]),this},v.concat=function(a){return(a=this._fixMatrix(a)).length!=e.LENGTH||this._multiplyMatrix(a),this},v.clone=function(){return new e().copy(this)},v.toArray=function(){for(var a=[],u=0,c=e.LENGTH;u<c;u++)a[u]=this[u];return a},v.copy=function(a){for(var u=e.LENGTH,c=0;c<u;c++)this[c]=a[c];return this},v.toString=function(){return"[ColorMatrix]"},v._multiplyMatrix=function(a){for(var u,c=[],x=0;x<5;x++){for(u=0;u<5;u++)c[u]=this[u+5*x];for(u=0;u<5;u++){for(var N=0,z=0;z<5;z++)N+=a[u+5*z]*c[z];this[u+5*x]=N}}},v._cleanValue=function(a,u){return Math.min(u,Math.max(-u,a))},v._fixMatrix=function(a){return a instanceof e&&(a=a.toArray()),a.length<e.LENGTH?a=a.slice(0,a.length).concat(e.IDENTITY_MATRIX.slice(a.length,e.LENGTH)):a.length>e.LENGTH&&(a=a.slice(0,e.LENGTH)),a},ne.ColorMatrix=e}(),function(){"use strict";function e(a){this.Filter_constructor(),this.matrix=a,this.FRAG_SHADER_BODY="uniform mat4 uColorMatrix;uniform vec4 uColorMatrixOffset;void main(void) {vec4 color = texture2D(uSampler, vRenderCoord);mat4 m = uColorMatrix;vec4 newColor = vec4(0,0,0,0);newColor.r = color.r*m[0][0] + color.g*m[0][1] + color.b*m[0][2] + color.a*m[0][3];newColor.g = color.r*m[1][0] + color.g*m[1][1] + color.b*m[1][2] + color.a*m[1][3];newColor.b = color.r*m[2][0] + color.g*m[2][1] + color.b*m[2][2] + color.a*m[2][3];newColor.a = color.r*m[3][0] + color.g*m[3][1] + color.b*m[3][2] + color.a*m[3][3];gl_FragColor = newColor + uColorMatrixOffset;}"}var v=ne.extend(e,ne.Filter);v.shaderParamSetup=function(a,u,c){var x=this.matrix,N=new Float32Array([x[0],x[1],x[2],x[3],x[5],x[6],x[7],x[8],x[10],x[11],x[12],x[13],x[15],x[16],x[17],x[18]]);a.uniformMatrix4fv(a.getUniformLocation(c,"uColorMatrix"),!1,N),a.uniform4f(a.getUniformLocation(c,"uColorMatrixOffset"),x[4]/255,x[9]/255,x[14]/255,x[19]/255)},v.toString=function(){return"[ColorMatrixFilter]"},v.clone=function(){return new e(this.matrix)},v._applyFilter=function(a){for(var u,c,x,N,z=a.data,oe=z.length,a=this.matrix,Ee=a[0],ke=a[1],t=a[2],r=a[3],i=a[4],o=a[5],l=a[6],f=a[7],h=a[8],p=a[9],_=a[10],b=a[11],w=a[12],C=a[13],O=a[14],P=a[15],A=a[16],R=a[17],T=a[18],L=a[19],S=0;S<oe;S+=4)u=z[S],c=z[S+1],x=z[S+2],N=z[S+3],z[S]=u*Ee+c*ke+x*t+N*r+i,z[S+1]=u*o+c*l+x*f+N*h+p,z[S+2]=u*_+c*b+x*w+N*C+O,z[S+3]=u*P+c*A+x*R+N*T+L;return!0},ne.ColorMatrixFilter=ne.promote(e,"Filter")}(),function(){"use strict";function e(){throw"Touch cannot be instantiated"}e.isSupported=function(){return!!("ontouchstart"in window||window.MSPointerEvent&&0<window.navigator.msMaxTouchPoints||window.PointerEvent&&0<window.navigator.maxTouchPoints)},e.enable=function(v,a,u,c){return!!(v&&v.canvas&&e.isSupported())&&(v.__touch||(v.__touch={pointers:{},multitouch:!a,preventDefault:!u,count:0},c?"ontouchstart"in window?e._enable(v):(window.PointerEvent||window.MSPointerEvent)&&e._IE_enable(v):"ontouchstart"in window||ne.BrowserDetect.isChrome||ne.BrowserDetect.isEdge||ne.BrowserDetect.isFirefox?e._enable(v):(window.PointerEvent||window.MSPointerEvent)&&e._IE_enable(v)),!0)},e.disable=function(v){v&&("ontouchstart"in window||ne.BrowserDetect.isChrome||ne.BrowserDetect.isFirefox?e._disable(v):(window.PointerEvent||window.MSPointerEvent)&&e._IE_disable(v),delete v.__touch)},e._enable=function(v){var a=v.canvas,u=v.__touch.f=function(c){e._handleEvent(v,c)};a.addEventListener("pointerdown",function(c){c.pointerType=="touch"?v.enableDOMEvents(!1):c.pointerType=="mouse"&&v.enableDOMEvents(!0)},!1),a.addEventListener("touchstart",u,!1),a.addEventListener("touchmove",u,!1),a.addEventListener("touchend",u,!1),a.addEventListener("touchcancel",u,!1)},e._disable=function(v){var a=v.canvas;a&&(v=v.__touch.f,a.removeEventListener("touchstart",v,!1),a.removeEventListener("touchmove",v,!1),a.removeEventListener("touchend",v,!1),a.removeEventListener("touchcancel",v,!1))},e._handleEvent=function(v,a){if(v){v.__touch.preventDefault&&a.preventDefault&&a.preventDefault();for(var u=a.changedTouches,c=a.type,x=0,N=u.length;x<N;x++){var z=u[x],oe=z.identifier;z.target==v.canvas&&(c==="touchstart"?this._handleStart(v,oe,a,z.pageX,z.pageY):c==="touchmove"?this._handleMove(v,oe,a,z.pageX,z.pageY):c!=="touchend"&&c!=="touchcancel"||this._handleEnd(v,oe,a))}}},e._IE_enable=function(v){var a=v.canvas,u=v.__touch.f=function(c){e._IE_handleEvent(v,c)};a.style["-webkit-tap-highlight-color"]="transparent",window.PointerEvent===void 0?(a.addEventListener("MSPointerDown",u,!1),window.addEventListener("MSPointerMove",u,!1),window.addEventListener("MSPointerUp",u,!1),window.addEventListener("MSPointerCancel",u,!1),v.__touch.preventDefault&&(a.style.msTouchAction="none")):(a.addEventListener("pointerdown",u,!1),window.addEventListener("pointermove",u,!1),window.addEventListener("pointerup",u,!1),window.addEventListener("pointercancel",u,!1),v.__touch.preventDefault&&(a.style.touchAction="none")),v.__touch.activeIDs={}},e._IE_disable=function(v){var a=v.__touch.f;window.PointerEvent===void 0?(window.removeEventListener("MSPointerMove",a,!1),window.removeEventListener("MSPointerUp",a,!1),window.removeEventListener("MSPointerCancel",a,!1),v.canvas&&v.canvas.removeEventListener("MSPointerDown",a,!1)):(window.removeEventListener("pointermove",a,!1),window.removeEventListener("pointerup",a,!1),window.removeEventListener("pointercancel",a,!1),v.canvas&&v.canvas.removeEventListener("pointerdown",a,!1))},e._IE_handleEvent=function(v,a){if(v){v.__touch.preventDefault&&a.preventDefault&&a.preventDefault();var u=a.type,c=a.pointerId,x=v.__touch.activeIDs;if(u==="MSPointerDown"||u==="pointerdown"){if(a.srcElement==v.canvas)switch(x[c]=!0,this._handleStart(v,c,a,a.pageX,a.pageY),a.pointerType){case"mouse":v.enableDOMEvents(!0);break;case"touch":v.enableDOMEvents(!1)}}else x[c]&&(u==="MSPointerMove"||u==="pointermove"?this._handleMove(v,c,a,a.pageX,a.pageY):u!=="MSPointerUp"&&u!=="MSPointerCancel"&&u!=="pointerup"&&u!=="pointercancel"||(delete x[c],this._handleEnd(v,c,a)))}},e._handleStart=function(v,a,u,c,x){var N,z=v.__touch;!z.multitouch&&z.count||(N=z.pointers)[a]||(N[a]=!0,z.count++,v._handlePointerDown(a,u,c,x))},e._handleMove=function(v,a,u,c,x){v.__touch.pointers[a]&&v._handlePointerMove(a,u,c,x)},e._handleEnd=function(v,a,u){var c=v.__touch,x=c.pointers;x[a]&&(c.count--,v._handlePointerUp(a,u,!0),delete x[a])},ne.Touch=e}(),function(){"use strict";var e=ne.EaselJS=ne.EaselJS||{};e.version="1.0.0",e.buildDate="Thu, 12 Oct 2017 16:34:05 GMT"}(),function(){"use strict";var e=ne.PreloadJS=ne.PreloadJS||{};e.version="NEXT",e.buildDate="Thu, 14 Sep 2017 22:19:45 GMT"}(),function(){"use strict";ne.proxy=function(e,v){var a=Array.prototype.slice.call(arguments,2);return function(){return e.apply(v,Array.prototype.slice.call(arguments,0).concat(a))}}}(),function(){"use strict";function e(v,a,u){this.Event_constructor("error"),this.title=v,this.message=a,this.data=u}ne.extend(e,ne.Event).clone=function(){return new ne.ErrorEvent(this.title,this.message,this.data)},ne.ErrorEvent=ne.promote(e,"Event")}(),function(){"use strict";function e(v,a){this.Event_constructor("progress"),this.loaded=v,this.total=a==null?1:a,this.progress=a==0?0:this.loaded/this.total}ne.extend(e,ne.Event).clone=function(){return new ne.ProgressEvent(this.loaded,this.total)},ne.ProgressEvent=ne.promote(e,"Event")}(window),(function(){var e,v,a,u,c=typeof define=="function"&&define.amd,x={function:!0,object:!0},N=x[typeof Rn]&&Rn&&!Rn.nodeType&&Rn,z=x[typeof window]&&window||this,oe=N&&x[typeof cr]&&cr&&!cr.nodeType&&typeof global=="object"&&global;function Ee(p,t){p=p||z.Object(),t=t||z.Object();var r=p.Number||z.Number,i=p.String||z.String,he=p.Object||z.Object,o=p.Date||z.Date,l=p.SyntaxError||z.SyntaxError,f=p.TypeError||z.TypeError,h=p.Math||z.Math,p=p.JSON||z.JSON;typeof p=="object"&&p&&(t.stringify=p.stringify,t.parse=p.parse);var _,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B,Z,U,ee,ae,re,he=he.prototype,j=he.toString,G=new o(-0xc782b5b800cec);try{G=G.getUTCFullYear()==-109252&&G.getUTCMonth()===0&&G.getUTCDate()===1&&G.getUTCHours()==10&&G.getUTCMinutes()==37&&G.getUTCSeconds()==6&&G.getUTCMilliseconds()==708}catch(g){}function y(g){if(y[g]!==w)return y[g];var d;if(g=="bug-string-char-index")d="a"[0]!="a";else if(g=="json")d=y("json-stringify")&&y("json-parse");else{var D,K='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if(g=="json-stringify"){var m=t.stringify,F=typeof m=="function"&&G;if(F){(D=function(){return 1}).toJSON=D;try{F=m(0)==="0"&&m(new r)==="0"&&m(new i)=='""'&&m(j)===w&&m(w)===w&&m()===w&&m(D)==="1"&&m([D])=="[1]"&&m([w])=="[null]"&&m(null)=="null"&&m([w,j,null])=="[null,null,null]"&&m({a:[D,!0,!1,null,"\0\b\n\f\r	"]})==K&&m(null,D)==="1"&&m([1,2],null,1)=="[\n 1,\n 2\n]"&&m(new o(-864e13))=='"-271821-04-20T00:00:00.000Z"'&&m(new o(864e13))=='"+275760-09-13T00:00:00.000Z"'&&m(new o(-621987552e5))=='"-000001-01-01T00:00:00.000Z"'&&m(new o(-1))=='"1969-12-31T23:59:59.999Z"'}catch(Q){F=!1}}d=F}if(g=="json-parse"){var Ce=t.parse;if(typeof Ce=="function")try{if(Ce("0")===0&&!Ce(!1)){var Y=(D=Ce(K)).a.length==5&&D.a[0]===1;if(Y){try{Y=!Ce('"	"')}catch(Q){}if(Y)try{Y=Ce("01")!==1}catch(Q){}if(Y)try{Y=Ce("1.")!==1}catch(Q){}}}}catch(Q){Y=!1}d=Y}}return y[g]=!!d}return y("json")||(C="[object Function]",O="[object Number]",P="[object String]",A="[object Array]",R=y("bug-string-char-index"),G||(T=h.floor,L=[0,31,59,90,120,151,181,212,243,273,304,334],S=function(g,d){return L[d]+365*(g-1970)+T((g-1969+(d=+(1<d)))/4)-T((g-1901+d)/100)+T((g-1601+d)/400)}),(_=he.hasOwnProperty)||(_=function(g){var d,D={__proto__:null};return D.__proto__={toString:1},_=D.toString!=j?function(F){var m=this.__proto__,F=F in(this.__proto__=null,this);return this.__proto__=m,F}:(d=D.constructor,function(K){var m=(this.constructor||d).prototype;return K in this&&!(K in m&&this[K]===m[K])}),D=null,_.call(this,g)}),b=function(g,d){var D,K,m,F=0;for(m in(D=function(){this.valueOf=0}).prototype.valueOf=0,K=new D)_.call(K,m)&&F++;return D=K=null,(b=F?F==2?function(Ce,Y){var Q,ce={},pe=j.call(Ce)==C;for(Q in Ce)pe&&Q=="prototype"||_.call(ce,Q)||!(ce[Q]=1)||!_.call(Ce,Q)||Y(Q)}:function(Ce,Y){var Q,ce,pe=j.call(Ce)==C;for(Q in Ce)pe&&Q=="prototype"||!_.call(Ce,Q)||(ce=Q==="constructor")||Y(Q);(ce||_.call(Ce,Q="constructor"))&&Y(Q)}:(K=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],function(Ce,Y){var Q,ce,pe=j.call(Ce)==C,J=!pe&&typeof Ce.constructor!="function"&&x[typeof Ce.hasOwnProperty]&&Ce.hasOwnProperty||_;for(Q in Ce)pe&&Q=="prototype"||!J.call(Ce,Q)||Y(Q);for(ce=K.length;Q=K[--ce];J.call(Ce,Q)&&Y(Q));}))(g,d)},y("json-stringify")||(E={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},k=function(g,d){return("000000"+(d||0)).slice(-g)},X=function(g){for(var d='"',D=0,K=g.length,m=!R||10<K,F=m&&(R?g.split(""):g);D<K;D++){var Ce=g.charCodeAt(D);switch(Ce){case 8:case 9:case 10:case 12:case 13:case 34:case 92:d+=E[Ce];break;default:if(Ce<32){d+="\\u00"+k(2,Ce.toString(16));break}d+=m?F[D]:g.charAt(D)}}return d+'"'},q=function(g,d,D,K,m,F,Ce){var Y,Q,ce,pe,J,ue,ye,Xe,se,Ae,ie,_e,$,xe;try{Y=d[g]}catch(Be){}if(typeof Y=="object"&&Y)if((Q=j.call(Y))!="[object Date]"||_.call(Y,"toJSON"))typeof Y.toJSON=="function"&&(Q!=O&&Q!=P&&Q!=A||_.call(Y,"toJSON"))&&(Y=Y.toJSON(g));else if(-1/0<Y&&Y<1/0){if(S){for(J=T(Y/864e5),ce=T(J/365.2425)+1970-1;S(ce+1,0)<=J;ce++);for(pe=T((J-S(ce,0))/30.42);S(ce,pe+1)<=J;pe++);J=1+J-S(ce,pe),ue=T(($=(Y%864e5+864e5)%864e5)/36e5)%24,ye=T($/6e4)%60,Xe=T($/1e3)%60,$=$%1e3}else ce=Y.getUTCFullYear(),pe=Y.getUTCMonth(),J=Y.getUTCDate(),ue=Y.getUTCHours(),ye=Y.getUTCMinutes(),Xe=Y.getUTCSeconds(),$=Y.getUTCMilliseconds();Y=(ce<=0||1e4<=ce?(ce<0?"-":"+")+k(6,ce<0?-ce:ce):k(4,ce))+"-"+k(2,pe+1)+"-"+k(2,J)+"T"+k(2,ue)+":"+k(2,ye)+":"+k(2,Xe)+"."+k(3,$)+"Z"}else Y=null;if(D&&(Y=D.call(d,g,Y)),Y===null)return"null";if((Q=j.call(Y))=="[object Boolean]")return""+Y;if(Q==O)return-1/0<Y&&Y<1/0?""+Y:"null";if(Q==P)return X(""+Y);if(typeof Y=="object"){for(_e=Ce.length;_e--;)if(Ce[_e]===Y)throw f();if(Ce.push(Y),se=[],$=F,F+=m,Q==A){for(ie=0,_e=Y.length;ie<_e;ie++)Ae=q(ie,Y,D,K,m,F,Ce),se.push(Ae===w?"null":Ae);xe=se.length?m?"[\n"+F+se.join(",\n"+F)+"\n"+$+"]":"["+se.join(",")+"]":"[]"}else b(K||Y,function(Be){var me=q(Be,Y,D,K,m,F,Ce);me!==w&&se.push(X(Be)+":"+(m?" ":"")+me)}),xe=se.length?m?"{\n"+F+se.join(",\n"+F)+"\n"+$+"}":"{"+se.join(",")+"}":"{}";return Ce.pop(),xe}},t.stringify=function(g,d,D){var K,m,F,Ce;if(x[typeof d]&&d){if((Ce=j.call(d))==C)m=d;else if(Ce==A){F={};for(var Y,Q=0,ce=d.length;Q<ce;Y=d[Q++],(Ce=j.call(Y))!=P&&Ce!=O||(F[Y]=1));}}if(D)if((Ce=j.call(D))==O){if(0<(D-=D%1))for(K="",10<D&&(D=10);K.length<D;K+=" ");}else Ce==P&&(K=D.length<=10?D:D.slice(0,10));return q("",((Y={})[""]=g,Y),m,F,K,"",[])}),y("json-parse")||(V=i.fromCharCode,I={92:"\\",34:'"',47:"/",98:"\b",116:"	",110:"\n",102:"\f",114:"\r"},Z=function(){throw te=B=null,l()},U=function(){for(var g,d,D,K,m,F=B,Ce=F.length;te<Ce;)switch(m=F.charCodeAt(te)){case 9:case 10:case 13:case 32:te++;break;case 123:case 125:case 91:case 93:case 58:case 44:return g=R?F.charAt(te):F[te],te++,g;case 34:for(g="@",te++;te<Ce;)if((m=F.charCodeAt(te))<32)Z();else if(m==92)switch(m=F.charCodeAt(++te)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:g+=I[m],te++;break;case 117:for(d=++te,D=te+4;te<D;te++)48<=(m=F.charCodeAt(te))&&m<=57||97<=m&&m<=102||65<=m&&m<=70||Z();g+=V("0x"+F.slice(d,te));break;default:Z()}else{if(m==34)break;for(m=F.charCodeAt(te),d=te;32<=m&&m!=92&&m!=34;)m=F.charCodeAt(++te);g+=F.slice(d,te)}if(F.charCodeAt(te)==34)return te++,g;Z();default:if(d=te,m==45&&(K=!0,m=F.charCodeAt(++te)),48<=m&&m<=57){for(m==48&&48<=(m=F.charCodeAt(te+1))&&m<=57&&Z(),K=!1;te<Ce&&48<=(m=F.charCodeAt(te))&&m<=57;te++);if(F.charCodeAt(te)==46){for(D=++te;D<Ce&&48<=(m=F.charCodeAt(D))&&m<=57;D++);D==te&&Z(),te=D}if((m=F.charCodeAt(te))==101||m==69){for((m=F.charCodeAt(++te))!=43&&m!=45||te++,D=te;D<Ce&&48<=(m=F.charCodeAt(D))&&m<=57;D++);D==te&&Z(),te=D}return+F.slice(d,te)}if(K&&Z(),F.slice(te,te+4)=="true")return te+=4,!0;if(F.slice(te,te+5)=="false")return te+=5,!1;if(F.slice(te,te+4)=="null")return te+=4,null;Z()}return"$"},ee=function(g){var d,D;if(g=="$"&&Z(),typeof g=="string"){if((R?g.charAt(0):g[0])=="@")return g.slice(1);if(g=="["){for(d=[];(g=U())!="]";D=D||!0)!D||g==","&&(g=U())!="]"||Z(),g==","&&Z(),d.push(ee(g));return d}if(g=="{"){for(d={};(g=U())!="}";D=D||!0)!D||g==","&&(g=U())!="}"||Z(),g!=","&&typeof g=="string"&&(R?g.charAt(0):g[0])=="@"&&U()==":"||Z(),d[g.slice(1)]=ee(U());return d}Z()}return g},ae=function(g,d,D){D=re(g,d,D),D===w?delete g[d]:g[d]=D},re=function(g,d,D){var K,m=g[d];if(typeof m=="object"&&m)if(j.call(m)==A)for(K=m.length;K--;)ae(m,K,D);else b(m,function(F){ae(m,F,D)});return D.call(g,d,m)},t.parse=function(g,d){var D;return te=0,B=""+g,D=ee(U()),U()!="$"&&Z(),te=B=null,d&&j.call(d)==C?re(((g={})[""]=D,g),"",d):D})),t.runInContext=Ee,t}!oe||oe.global!==oe&&oe.window!==oe&&oe.self!==oe||(z=oe),N&&!c?Ee(z,N):(e=z.JSON,v=z.JSON3,a=!1,u=Ee(z,z.JSON3={noConflict:function(){return a||(a=!0,z.JSON=e,z.JSON3=v,e=v=null),u}}),z.JSON={parse:u.parse,stringify:u.stringify}),c&&define(function(){return u})}).call(Rn),function(){var e={a:function(){return e.el("a")},svg:function(){return e.el("svg")},object:function(){return e.el("object")},image:function(){return e.el("image")},img:function(){return e.el("img")},style:function(){return e.el("style")},link:function(){return e.el("link")},script:function(){return e.el("script")},audio:function(){return e.el("audio")},video:function(){return e.el("video")},text:function(v){return document.createTextNode(v)},el:function(v){return document.createElement(v)}};ne.Elements=e}(),function(){var e={ABSOLUTE_PATT:/^(?:\w+:)?\/{2}/i,RELATIVE_PATT:/^[./]*?\//i,EXTENSION_PATT:/\/?[^/]+\.(\w{1,5})$/i,parseURI:function(v){var a={absolute:!1,relative:!1,protocol:null,hostname:null,port:null,pathname:null,search:null,hash:null,host:null};if(v==null)return a;var u,c=ne.Elements.a();for(u in c.href=v,a)u in c&&(a[u]=c[u]);var x=v.indexOf("?");return-1<x&&(v=v.substr(0,x)),e.ABSOLUTE_PATT.test(v)?a.absolute=!0:e.RELATIVE_PATT.test(v)&&(a.relative=!0),(v=v.match(e.EXTENSION_PATT))&&(a.extension=v[1].toLowerCase()),a},formatQueryString:function(v,a){if(v==null)throw new Error("You must specify data.");var u,c=[];for(u in v)c.push(u+"="+escape(v[u]));return a&&(c=c.concat(a)),c.join("&")},buildURI:function(v,a){if(a==null)return v;var u,c=[],x=v.indexOf("?");return x!=-1&&(u=v.slice(x+1),c=c.concat(u.split("&"))),x!=-1?v.slice(0,x)+"?"+this.formatQueryString(a,c):v+"?"+this.formatQueryString(a,c)},isCrossDomain:function(v){var a=ne.Elements.a();return a.href=v.src,v=ne.Elements.a(),v.href=location.href,a.hostname!=""&&(a.port!=v.port||a.protocol!=v.protocol||a.hostname!=v.hostname)},isLocal:function(v){var a=ne.Elements.a();return a.href=v.src,a.hostname==""&&a.protocol=="file:"}};ne.URLUtils=e}(),function(){var e={container:null,appendToHead:function(v){e.getHead().appendChild(v)},appendToBody:function(v){var a;e.container==null&&(e.container=document.createElement("div"),e.container.id="preloadjs-container",(a=e.container.style).visibility="hidden",a.position="absolute",a.width=e.container.style.height="10px",a.overflow="hidden",a.transform=a.msTransform=a.webkitTransform=a.oTransform="translate(-10px, -10px)",e.getBody().appendChild(e.container)),e.container.appendChild(v)},getHead:function(){return document.head||document.getElementsByTagName("head")[0]},getBody:function(){return document.body||document.getElementsByTagName("body")[0]},removeChild:function(v){v.parent&&v.parent.removeChild(v)},isImageTag:function(v){return v instanceof HTMLImageElement},isAudioTag:function(v){return!!window.HTMLAudioElement&&v instanceof HTMLAudioElement},isVideoTag:function(v){return!!window.HTMLVideoElement&&v instanceof HTMLVideoElement}};ne.DomUtils=e}(),function(){var e={parseXML:function(v){var a=null;try{window.DOMParser&&(a=new DOMParser().parseFromString(v,"text/xml"))}catch(u){}if(!a)try{(a=new ActiveXObject("Microsoft.XMLDOM")).async=!1,a.loadXML(v)}catch(u){a=null}return a},parseJSON:function(v){if(v==null)return null;try{return JSON.parse(v)}catch(a){throw a}}};ne.DataUtils=e}(),function(){var e={BINARY:"binary",CSS:"css",FONT:"font",FONTCSS:"fontcss",IMAGE:"image",JAVASCRIPT:"javascript",JSON:"json",JSONP:"jsonp",MANIFEST:"manifest",SOUND:"sound",VIDEO:"video",SPRITESHEET:"spritesheet",SVG:"svg",TEXT:"text",XML:"xml"};ne.Types=e}(),function(){var e={POST:"POST",GET:"GET"};ne.Methods=e}(),function(){"use strict";function e(){this.src=null,this.type=null,this.id=null,this.maintainOrder=!1,this.callback=null,this.data=null,this.method=ne.Methods.GET,this.values=null,this.headers=null,this.withCredentials=!1,this.mimeType=null,this.crossOrigin=null,this.loadTimeout=a.LOAD_TIMEOUT_DEFAULT}var v=e.prototype={},a=e;a.LOAD_TIMEOUT_DEFAULT=8e3,a.create=function(u){if(typeof u=="string"){var c=new e;return c.src=u,c}if(u instanceof a)return u;if(u instanceof Object&&u.src)return u.loadTimeout==null&&(u.loadTimeout=a.LOAD_TIMEOUT_DEFAULT),u;throw new Error("Type not recognized.")},v.set=function(u){for(var c in u)this[c]=u[c];return this},ne.LoadItem=a}(),function(){var e={isBinary:function(v){switch(v){case ne.Types.IMAGE:case ne.Types.BINARY:return!0;default:return!1}},isText:function(v){switch(v){case ne.Types.TEXT:case ne.Types.JSON:case ne.Types.MANIFEST:case ne.Types.XML:case ne.Types.CSS:case ne.Types.SVG:case ne.Types.JAVASCRIPT:case ne.Types.SPRITESHEET:return!0;default:return!1}},getTypeByExtension:function(v){if(v==null)return ne.Types.TEXT;switch(v.toLowerCase()){case"jpeg":case"jpg":case"gif":case"png":case"webp":case"bmp":return ne.Types.IMAGE;case"ogg":case"mp3":case"webm":return ne.Types.SOUND;case"mp4":case"webm":case"ts":return ne.Types.VIDEO;case"json":return ne.Types.JSON;case"xml":return ne.Types.XML;case"css":return ne.Types.CSS;case"js":return ne.Types.JAVASCRIPT;case"svg":return ne.Types.SVG;default:return ne.Types.TEXT}}};ne.RequestUtils=e}(),function(){"use strict";function e(u,c,x){this.EventDispatcher_constructor(),this.loaded=!1,this.canceled=!1,this.progress=0,this.type=x,this.resultFormatter=null,this._item=u?ne.LoadItem.create(u):null,this._preferXHR=c,this._result=null,this._rawResult=null,this._loadedItems=null,this._tagSrcAttribute=null,this._tag=null}var v=ne.extend(e,ne.EventDispatcher),a=e;try{Object.defineProperties(a,{POST:{get:ne.deprecate(function(){return ne.Methods.POST},"AbstractLoader.POST")},GET:{get:ne.deprecate(function(){return ne.Methods.GET},"AbstractLoader.GET")},BINARY:{get:ne.deprecate(function(){return ne.Types.BINARY},"AbstractLoader.BINARY")},CSS:{get:ne.deprecate(function(){return ne.Types.CSS},"AbstractLoader.CSS")},FONT:{get:ne.deprecate(function(){return ne.Types.FONT},"AbstractLoader.FONT")},FONTCSS:{get:ne.deprecate(function(){return ne.Types.FONTCSS},"AbstractLoader.FONTCSS")},IMAGE:{get:ne.deprecate(function(){return ne.Types.IMAGE},"AbstractLoader.IMAGE")},JAVASCRIPT:{get:ne.deprecate(function(){return ne.Types.JAVASCRIPT},"AbstractLoader.JAVASCRIPT")},JSON:{get:ne.deprecate(function(){return ne.Types.JSON},"AbstractLoader.JSON")},JSONP:{get:ne.deprecate(function(){return ne.Types.JSONP},"AbstractLoader.JSONP")},MANIFEST:{get:ne.deprecate(function(){return ne.Types.MANIFEST},"AbstractLoader.MANIFEST")},SOUND:{get:ne.deprecate(function(){return ne.Types.SOUND},"AbstractLoader.SOUND")},VIDEO:{get:ne.deprecate(function(){return ne.Types.VIDEO},"AbstractLoader.VIDEO")},SPRITESHEET:{get:ne.deprecate(function(){return ne.Types.SPRITESHEET},"AbstractLoader.SPRITESHEET")},SVG:{get:ne.deprecate(function(){return ne.Types.SVG},"AbstractLoader.SVG")},TEXT:{get:ne.deprecate(function(){return ne.Types.TEXT},"AbstractLoader.TEXT")},XML:{get:ne.deprecate(function(){return ne.Types.XML},"AbstractLoader.XML")}})}catch(u){}v.getItem=function(){return this._item},v.getResult=function(u){return u?this._rawResult:this._result},v.getTag=function(){return this._tag},v.setTag=function(u){this._tag=u},v.load=function(){this._createRequest(),this._request.on("complete",this,this),this._request.on("progress",this,this),this._request.on("loadStart",this,this),this._request.on("abort",this,this),this._request.on("timeout",this,this),this._request.on("error",this,this);var u=new ne.Event("initialize");u.loader=this._request,this.dispatchEvent(u),this._request.load()},v.cancel=function(){this.canceled=!0,this.destroy()},v.destroy=function(){this._request&&(this._request.removeAllEventListeners(),this._request.destroy()),this._request=null,this._item=null,this._rawResult=null,this._result=null,this._loadItems=null,this.removeAllEventListeners()},v.getLoadedItems=function(){return this._loadedItems},v._createRequest=function(){this._preferXHR?this._request=new ne.XHRRequest(this._item):this._request=new ne.TagRequest(this._item,this._tag||this._createTag(),this._tagSrcAttribute)},v._createTag=function(u){return null},v._sendLoadStart=function(){this._isCanceled()||this.dispatchEvent("loadstart")},v._sendProgress=function(u){var c;this._isCanceled()||(c=null,typeof u=="number"?(this.progress=u,c=new ne.ProgressEvent(this.progress)):(c=u,this.progress=u.loaded/u.total,c.progress=this.progress,!isNaN(this.progress)&&this.progress!=1/0||(this.progress=0)),this.hasEventListener("progress")&&this.dispatchEvent(c))},v._sendComplete=function(){var u;this._isCanceled()||(this.loaded=!0,(u=new ne.Event("complete")).rawResult=this._rawResult,this._result!=null&&(u.result=this._result),this.dispatchEvent(u))},v._sendError=function(u){!this._isCanceled()&&this.hasEventListener("error")&&(u==null&&(u=new ne.ErrorEvent("PRELOAD_ERROR_EMPTY")),this.dispatchEvent(u))},v._isCanceled=function(){return!(window.createjs!=null&&!this.canceled)},v.resultFormatter=null,v.handleEvent=function(u){switch(u.type){case"complete":this._rawResult=u.target._response;var c=this.resultFormatter&&this.resultFormatter(this);c instanceof Function?c.call(this,ne.proxy(this._resultFormatSuccess,this),ne.proxy(this._resultFormatFailed,this)):(this._result=c||this._rawResult,this._sendComplete());break;case"progress":this._sendProgress(u);break;case"error":this._sendError(u);break;case"loadstart":this._sendLoadStart();break;case"abort":case"timeout":this._isCanceled()||this.dispatchEvent(new ne.ErrorEvent("PRELOAD_"+u.type.toUpperCase()+"_ERROR"))}},v._resultFormatSuccess=function(u){this._result=u,this._sendComplete()},v._resultFormatFailed=function(u){this._sendError(u)},v.toString=function(){return"[PreloadJS AbstractLoader]"},ne.AbstractLoader=ne.promote(e,"EventDispatcher")}(),function(){"use strict";function e(a,u,c){this.AbstractLoader_constructor(a,u,c),this.resultFormatter=this._formatResult,this._tagSrcAttribute="src",this.on("initialize",this._updateXHR,this)}var v=ne.extend(e,ne.AbstractLoader);v.load=function(){this._tag||(this._tag=this._createTag(this._item.src)),this._tag.preload="auto",this._tag.load(),this.AbstractLoader_load()},v._createTag=function(){},v._createRequest=function(){this._preferXHR?this._request=new ne.XHRRequest(this._item):this._request=new ne.MediaTagRequest(this._item,this._tag||this._createTag(),this._tagSrcAttribute)},v._updateXHR=function(a){a.loader.setResponseType&&a.loader.setResponseType("blob")},v._formatResult=function(a){var u,c;return this._tag.removeEventListener&&this._tag.removeEventListener("canplaythrough",this._loadedHandler),this._tag.onstalled=null,this._preferXHR&&(u=window.URL||window.webkitURL,c=a.getResult(!0),a.getTag().src=u.createObjectURL(c)),a.getTag()},ne.AbstractMediaLoader=ne.promote(e,"AbstractLoader")}(),function(){"use strict";function e(a){this._item=a}var v=ne.extend(e,ne.EventDispatcher);v.load=function(){},v.destroy=function(){},v.cancel=function(){},ne.AbstractRequest=ne.promote(e,"EventDispatcher")}(),function(){"use strict";function e(a,u,c){this.AbstractRequest_constructor(a),this._tag=u,this._tagSrcAttribute=c,this._loadedHandler=ne.proxy(this._handleTagComplete,this),this._addedToDOM=!1}var v=ne.extend(e,ne.AbstractRequest);v.load=function(){this._tag.onload=ne.proxy(this._handleTagComplete,this),this._tag.onreadystatechange=ne.proxy(this._handleReadyStateChange,this),this._tag.onerror=ne.proxy(this._handleError,this);var a=new ne.Event("initialize");a.loader=this._tag,this.dispatchEvent(a),this._loadTimeout=setTimeout(ne.proxy(this._handleTimeout,this),this._item.loadTimeout),this._tag[this._tagSrcAttribute]=this._item.src,this._tag.parentNode==null&&(ne.DomUtils.appendToBody(this._tag),this._addedToDOM=!0)},v.destroy=function(){this._clean(),this._tag=null,this.AbstractRequest_destroy()},v._handleReadyStateChange=function(){clearTimeout(this._loadTimeout);var a=this._tag;a.readyState!="loaded"&&a.readyState!="complete"||this._handleTagComplete()},v._handleError=function(){this._clean(),this.dispatchEvent("error")},v._handleTagComplete=function(){this._rawResult=this._tag,this._result=this.resultFormatter&&this.resultFormatter(this)||this._rawResult,this._clean(),this.dispatchEvent("complete")},v._handleTimeout=function(){this._clean(),this.dispatchEvent(new ne.Event("timeout"))},v._clean=function(){this._tag.onload=null,this._tag.onreadystatechange=null,this._tag.onerror=null,this._addedToDOM&&this._tag.parentNode!=null&&this._tag.parentNode.removeChild(this._tag),clearTimeout(this._loadTimeout)},v._handleStalled=function(){},ne.TagRequest=ne.promote(e,"AbstractRequest")}(),function(){"use strict";function e(a,u,c){this.AbstractRequest_constructor(a),this._tag=u,this._tagSrcAttribute=c,this._loadedHandler=ne.proxy(this._handleTagComplete,this)}var v=ne.extend(e,ne.TagRequest);v.load=function(){var a=ne.proxy(this._handleStalled,this);this._stalledCallback=a;var u=ne.proxy(this._handleProgress,this);this._handleProgress=u,this._tag.addEventListener("stalled",a),this._tag.addEventListener("progress",u),this._tag.addEventListener&&this._tag.addEventListener("canplaythrough",this._loadedHandler,!1),this.TagRequest_load()},v._handleReadyStateChange=function(){clearTimeout(this._loadTimeout);var a=this._tag;a.readyState!="loaded"&&a.readyState!="complete"||this._handleTagComplete()},v._handleStalled=function(){},v._handleProgress=function(a){!a||0<a.loaded&&a.total==0||(a=new ne.ProgressEvent(a.loaded,a.total),this.dispatchEvent(a))},v._clean=function(){this._tag.removeEventListener&&this._tag.removeEventListener("canplaythrough",this._loadedHandler),this._tag.removeEventListener("stalled",this._stalledCallback),this._tag.removeEventListener("progress",this._progressCallback),this.TagRequest__clean()},ne.MediaTagRequest=ne.promote(e,"TagRequest")}(),function(){"use strict";function e(a){this.AbstractRequest_constructor(a),this._request=null,this._loadTimeout=null,this._xhrLevel=1,this._response=null,this._rawResponse=null,this._canceled=!1,this._handleLoadStartProxy=ne.proxy(this._handleLoadStart,this),this._handleProgressProxy=ne.proxy(this._handleProgress,this),this._handleAbortProxy=ne.proxy(this._handleAbort,this),this._handleErrorProxy=ne.proxy(this._handleError,this),this._handleTimeoutProxy=ne.proxy(this._handleTimeout,this),this._handleLoadProxy=ne.proxy(this._handleLoad,this),this._handleReadyStateChangeProxy=ne.proxy(this._handleReadyStateChange,this),this._createXHR(a)}var v=ne.extend(e,ne.AbstractRequest);e.ACTIVEX_VERSIONS=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.5.0","Msxml2.XMLHTTP.4.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],v.getResult=function(a){return a&&this._rawResponse?this._rawResponse:this._response},v.cancel=function(){this.canceled=!0,this._clean(),this._request.abort()},v.load=function(){if(this._request!=null){this._request.addEventListener!=null?(this._request.addEventListener("loadstart",this._handleLoadStartProxy,!1),this._request.addEventListener("progress",this._handleProgressProxy,!1),this._request.addEventListener("abort",this._handleAbortProxy,!1),this._request.addEventListener("error",this._handleErrorProxy,!1),this._request.addEventListener("timeout",this._handleTimeoutProxy,!1),this._request.addEventListener("load",this._handleLoadProxy,!1),this._request.addEventListener("readystatechange",this._handleReadyStateChangeProxy,!1)):(this._request.onloadstart=this._handleLoadStartProxy,this._request.onprogress=this._handleProgressProxy,this._request.onabort=this._handleAbortProxy,this._request.onerror=this._handleErrorProxy,this._request.ontimeout=this._handleTimeoutProxy,this._request.onload=this._handleLoadProxy,this._request.onreadystatechange=this._handleReadyStateChangeProxy),this._xhrLevel==1&&(this._loadTimeout=setTimeout(ne.proxy(this._handleTimeout,this),this._item.loadTimeout));try{this._item.values?this._request.send(ne.URLUtils.formatQueryString(this._item.values)):this._request.send()}catch(a){this.dispatchEvent(new ne.ErrorEvent("XHR_SEND",null,a))}}else this._handleError()},v.setResponseType=function(a){a==="blob"&&(a=window.URL?"blob":"arraybuffer",this._responseType=a),this._request.responseType=a},v.getAllResponseHeaders=function(){return this._request.getAllResponseHeaders instanceof Function?this._request.getAllResponseHeaders():null},v.getResponseHeader=function(a){return this._request.getResponseHeader instanceof Function?this._request.getResponseHeader(a):null},v._handleProgress=function(a){!a||0<a.loaded&&a.total==0||(a=new ne.ProgressEvent(a.loaded,a.total),this.dispatchEvent(a))},v._handleLoadStart=function(a){clearTimeout(this._loadTimeout),this.dispatchEvent("loadstart")},v._handleAbort=function(a){this._clean(),this.dispatchEvent(new ne.ErrorEvent("XHR_ABORTED",null,a))},v._handleError=function(a){this._clean(),this.dispatchEvent(new ne.ErrorEvent(a.message))},v._handleReadyStateChange=function(a){this._request.readyState==4&&this._handleLoad()},v._handleLoad=function(a){if(!this.loaded){this.loaded=!0;var u=this._checkError();if(u)this._handleError(u);else{if(this._response=this._getResponse(),this._responseType==="arraybuffer")try{this._response=new Blob([this._response])}catch(c){window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,c.name==="TypeError"&&window.BlobBuilder&&((u=new BlobBuilder).append(this._response),this._response=u.getBlob())}this._clean(),this.dispatchEvent(new ne.Event("complete"))}}},v._handleTimeout=function(a){this._clean(),this.dispatchEvent(new ne.ErrorEvent("PRELOAD_TIMEOUT",null,a))},v._checkError=function(){var a=parseInt(this._request.status);return 400<=a&&a<=599?new Error(a):a==0&&/^https?:/.test(location.protocol)?new Error(0):null},v._getResponse=function(){if(this._response!=null)return this._response;if(this._request.response!=null)return this._request.response;try{if(this._request.responseText!=null)return this._request.responseText}catch(a){}try{if(this._request.responseXML!=null)return this._request.responseXML}catch(a){}return null},v._createXHR=function(a){var u=ne.URLUtils.isCrossDomain(a),c={},x=null;if(window.XMLHttpRequest)x=new XMLHttpRequest,u&&x.withCredentials===void 0&&window.XDomainRequest&&(x=new XDomainRequest);else{for(var N=0,z=s.ACTIVEX_VERSIONS.length;N<z;N++){var oe=s.ACTIVEX_VERSIONS[N];try{x=new ActiveXObject(oe);break}catch(t){}}if(x==null)return!1}a.mimeType==null&&ne.RequestUtils.isText(a.type)&&(a.mimeType="text/plain; charset=utf-8"),a.mimeType&&x.overrideMimeType&&x.overrideMimeType(a.mimeType),this._xhrLevel=typeof x.responseType=="string"?2:1;var Ee=null,Ee=a.method==ne.Methods.GET?ne.URLUtils.buildURI(a.src,a.values):a.src;if(x.open(a.method||ne.Methods.GET,Ee,!0),u&&x instanceof XMLHttpRequest&&this._xhrLevel==1&&(c.Origin=location.origin),a.values&&a.method==ne.Methods.POST&&(c["Content-Type"]="application/x-www-form-urlencoded"),u||c["X-Requested-With"]||(c["X-Requested-With"]="XMLHttpRequest"),a.headers)for(var ke in a.headers)c[ke]=a.headers[ke];for(ke in c)x.setRequestHeader(ke,c[ke]);return x instanceof XMLHttpRequest&&a.withCredentials!==void 0&&(x.withCredentials=a.withCredentials),this._request=x,!0},v._clean=function(){clearTimeout(this._loadTimeout),this._request.removeEventListener!=null?(this._request.removeEventListener("loadstart",this._handleLoadStartProxy),this._request.removeEventListener("progress",this._handleProgressProxy),this._request.removeEventListener("abort",this._handleAbortProxy),this._request.removeEventListener("error",this._handleErrorProxy),this._request.removeEventListener("timeout",this._handleTimeoutProxy),this._request.removeEventListener("load",this._handleLoadProxy),this._request.removeEventListener("readystatechange",this._handleReadyStateChangeProxy)):(this._request.onloadstart=null,this._request.onprogress=null,this._request.onabort=null,this._request.onerror=null,this._request.ontimeout=null,this._request.onload=null,this._request.onreadystatechange=null)},v.toString=function(){return"[PreloadJS XHRRequest]"},ne.XHRRequest=ne.promote(e,"AbstractRequest")}(),function(){"use strict";function e(u,c,x){this.AbstractLoader_constructor(),this._plugins=[],this._typeCallbacks={},this._extensionCallbacks={},this.next=null,this.maintainScriptOrder=!0,this.stopOnError=!1,this._maxConnections=1,this._availableLoaders=[ne.FontLoader,ne.ImageLoader,ne.JavaScriptLoader,ne.CSSLoader,ne.JSONLoader,ne.JSONPLoader,ne.SoundLoader,ne.ManifestLoader,ne.SpriteSheetLoader,ne.XMLLoader,ne.SVGLoader,ne.BinaryLoader,ne.VideoLoader,ne.TextLoader],this._defaultLoaderLength=this._availableLoaders.length,this.init(u,c,x)}var v=ne.extend(e,ne.AbstractLoader),a=e;try{Object.defineProperties(a,{POST:{get:ne.deprecate(function(){return ne.Methods.POST},"AbstractLoader.POST")},GET:{get:ne.deprecate(function(){return ne.Methods.GET},"AbstractLoader.GET")},BINARY:{get:ne.deprecate(function(){return ne.Types.BINARY},"AbstractLoader.BINARY")},CSS:{get:ne.deprecate(function(){return ne.Types.CSS},"AbstractLoader.CSS")},FONT:{get:ne.deprecate(function(){return ne.Types.FONT},"AbstractLoader.FONT")},FONTCSS:{get:ne.deprecate(function(){return ne.Types.FONTCSS},"AbstractLoader.FONTCSS")},IMAGE:{get:ne.deprecate(function(){return ne.Types.IMAGE},"AbstractLoader.IMAGE")},JAVASCRIPT:{get:ne.deprecate(function(){return ne.Types.JAVASCRIPT},"AbstractLoader.JAVASCRIPT")},JSON:{get:ne.deprecate(function(){return ne.Types.JSON},"AbstractLoader.JSON")},JSONP:{get:ne.deprecate(function(){return ne.Types.JSONP},"AbstractLoader.JSONP")},MANIFEST:{get:ne.deprecate(function(){return ne.Types.MANIFEST},"AbstractLoader.MANIFEST")},SOUND:{get:ne.deprecate(function(){return ne.Types.SOUND},"AbstractLoader.SOUND")},VIDEO:{get:ne.deprecate(function(){return ne.Types.VIDEO},"AbstractLoader.VIDEO")},SPRITESHEET:{get:ne.deprecate(function(){return ne.Types.SPRITESHEET},"AbstractLoader.SPRITESHEET")},SVG:{get:ne.deprecate(function(){return ne.Types.SVG},"AbstractLoader.SVG")},TEXT:{get:ne.deprecate(function(){return ne.Types.TEXT},"AbstractLoader.TEXT")},XML:{get:ne.deprecate(function(){return ne.Types.XML},"AbstractLoader.XML")}})}catch(u){}v.init=function(u,c,x){this.preferXHR=!0,this._preferXHR=!0,this.setPreferXHR(u),this._paused=!1,this._basePath=c,this._crossOrigin=x,this._loadStartWasDispatched=!1,this._currentlyLoadingScript=null,this._currentLoads=[],this._loadQueue=[],this._loadQueueBackup=[],this._loadItemsById={},this._loadItemsBySrc={},this._loadedResults={},this._loadedRawResults={},this._numItems=0,this._numItemsLoaded=0,this._scriptOrder=[],this._loadedScripts=[],this._lastProgress=NaN},v.registerLoader=function(u){if(!u||!u.canLoadItem)throw new Error("loader is of an incorrect type.");if(this._availableLoaders.indexOf(u)!=-1)throw new Error("loader already exists.");this._availableLoaders.unshift(u)},v.unregisterLoader=function(u){u=this._availableLoaders.indexOf(u),u!=-1&&u<this._defaultLoaderLength-1&&this._availableLoaders.splice(u,1)},v.setPreferXHR=function(u){return this.preferXHR=u!=0&&window.XMLHttpRequest!=null,this.preferXHR},v.removeAll=function(){this.remove()},v.remove=function(u){var c=null;if(u&&!Array.isArray(u))c=[u];else if(u)c=u;else if(0<arguments.length)return;var x=!1;if(c){for(;c.length;){for(var N=c.pop(),z=this.getResult(N),oe=this._loadQueue.length-1;0<=oe;oe--)if((Ee=this._loadQueue[oe].getItem()).id==N||Ee.src==N){this._loadQueue.splice(oe,1)[0].cancel();break}for(oe=this._loadQueueBackup.length-1;0<=oe;oe--)if((Ee=this._loadQueueBackup[oe].getItem()).id==N||Ee.src==N){this._loadQueueBackup.splice(oe,1)[0].cancel();break}if(z)this._disposeItem(this.getItem(N));else for(var oe=this._currentLoads.length-1;0<=oe;oe--){var Ee=this._currentLoads[oe].getItem();if(Ee.id==N||Ee.src==N){this._currentLoads.splice(oe,1)[0].cancel(),x=!0;break}}}x&&this._loadNext()}else{for(var ke in this.close(),this._loadItemsById)this._disposeItem(this._loadItemsById[ke]);this.init(this.preferXHR,this._basePath)}},v.reset=function(){for(var u in this.close(),this._loadItemsById)this._disposeItem(this._loadItemsById[u]);for(var c=[],x=0,N=this._loadQueueBackup.length;x<N;x++)c.push(this._loadQueueBackup[x].getItem());this.loadManifest(c,!1)},v.installPlugin=function(u){if(u!=null&&u.getPreloadHandlers!=null){this._plugins.push(u);var c=u.getPreloadHandlers();if(c.scope=u,c.types!=null)for(var x=0,N=c.types.length;x<N;x++)this._typeCallbacks[c.types[x]]=c;if(c.extensions!=null)for(x=0,N=c.extensions.length;x<N;x++)this._extensionCallbacks[c.extensions[x]]=c}},v.setMaxConnections=function(u){this._maxConnections=u,!this._paused&&0<this._loadQueue.length&&this._loadNext()},v.loadFile=function(u,c,x){u!=null?(this._addItem(u,null,x),c!==!1?this.setPaused(!1):this.setPaused(!0)):(c=new ne.ErrorEvent("PRELOAD_NO_FILE"),this._sendError(c))},v.loadManifest=function(u,c,x){var N=null,z=null;if(Array.isArray(u)){if(u.length==0){var oe=new ne.ErrorEvent("PRELOAD_MANIFEST_EMPTY");return void this._sendError(oe)}N=u}else if(typeof u=="string")N=[{src:u,type:a.MANIFEST}];else{if(typeof u!="object")return oe=new ne.ErrorEvent("PRELOAD_MANIFEST_NULL"),void this._sendError(oe);u.src!==void 0?(u.type==null?u.type=a.MANIFEST:u.type!=a.MANIFEST&&(oe=new ne.ErrorEvent("PRELOAD_MANIFEST_TYPE"),this._sendError(oe)),N=[u]):u.manifest!==void 0&&(N=u.manifest,z=u.path)}for(var Ee=0,ke=N.length;Ee<ke;Ee++)this._addItem(N[Ee],z,x);c!==!1?this.setPaused(!1):this.setPaused(!0)},v.load=function(){this.setPaused(!1)},v.getItem=function(u){return this._loadItemsById[u]||this._loadItemsBySrc[u]},v.getResult=function(u,c){return u=this._loadItemsById[u]||this._loadItemsBySrc[u],u==null?null:(u=u.id,(c&&this._loadedRawResults[u]?this._loadedRawResults:this._loadedResults)[u])},v.getItems=function(u){var c,x=[];for(c in this._loadItemsById){var N=this._loadItemsById[c],z=this.getResult(c);u===!0&&z==null||x.push({item:N,result:z,rawResult:this.getResult(c,!0)})}return x},v.setPaused=function(u){this._paused=u,this._paused||this._loadNext()},v.close=function(){for(;this._currentLoads.length;)this._currentLoads.pop().cancel();this._scriptOrder.length=0,this._loadedScripts.length=0,this.loadStartWasDispatched=!1,this._itemCount=0,this._lastProgress=NaN},v._addItem=function(u,c,x){c=this._createLoadItem(u,c,x),c==null||(x=this._createLoader(c))!=null&&("plugins"in x&&(x.plugins=this._plugins),c._loader=x,this._loadQueue.push(x),this._loadQueueBackup.push(x),this._numItems++,this._updateProgress(),(this.maintainScriptOrder&&c.type==ne.Types.JAVASCRIPT||c.maintainOrder===!0)&&(this._scriptOrder.push(c),this._loadedScripts.push(null)))},v._createLoadItem=function(u,c,x){var N=ne.LoadItem.create(u);if(N==null)return null;if(u="",x=x||this._basePath,N.src instanceof Object){if(!N.type)return null;c?(u=c,oe=ne.URLUtils.parseURI(c),x==null||oe.absolute||oe.relative||(u=x+u)):x!=null&&(u=x)}else{var z=ne.URLUtils.parseURI(N.src);z.extension&&(N.ext=z.extension),N.type==null&&(N.type=ne.RequestUtils.getTypeByExtension(N.ext));var oe,Ee=N.src;z.absolute||z.relative||(c?(u=c,oe=ne.URLUtils.parseURI(c),Ee=c+Ee,x==null||oe.absolute||oe.relative||(u=x+u)):x!=null&&(u=x)),N.src=u+N.src}if(N.path=u,N.id!==void 0&&N.id!==null&&N.id!==""||(N.id=Ee),Ee=this._typeCallbacks[N.type]||this._extensionCallbacks[N.ext],Ee){if(Ee=Ee.callback.call(Ee.scope,N,this),Ee===!1)return null;Ee===!0||Ee!=null&&(N._loader=Ee),(z=ne.URLUtils.parseURI(N.src)).extension!=null&&(N.ext=z.extension)}return this._loadItemsById[N.id]=N,(this._loadItemsBySrc[N.src]=N).crossOrigin==null&&(N.crossOrigin=this._crossOrigin),N},v._createLoader=function(u){if(u._loader!=null)return u._loader;for(var c=this.preferXHR,x=0;x<this._availableLoaders.length;x++){var N=this._availableLoaders[x];if(N&&N.canLoadItem(u))return new N(u,c)}return null},v._loadNext=function(){if(!this._paused){this._loadStartWasDispatched||(this._sendLoadStart(),this._loadStartWasDispatched=!0),this._numItems==this._numItemsLoaded?(this.loaded=!0,this._sendComplete(),this.next&&this.next.load&&this.next.load()):this.loaded=!1;for(var u=0;u<this._loadQueue.length&&!(this._currentLoads.length>=this._maxConnections);u++){var c=this._loadQueue[u];this._canStartLoad(c)&&(this._loadQueue.splice(u,1),u--,this._loadItem(c))}}},v._loadItem=function(u){u.on("fileload",this._handleFileLoad,this),u.on("progress",this._handleProgress,this),u.on("complete",this._handleFileComplete,this),u.on("error",this._handleError,this),u.on("fileerror",this._handleFileError,this),this._currentLoads.push(u),this._sendFileStart(u.getItem()),u.load()},v._handleFileLoad=function(u){u.target=null,this.dispatchEvent(u)},v._handleFileError=function(u){u=new ne.ErrorEvent("FILE_LOAD_ERROR",null,u.item),this._sendError(u)},v._handleError=function(u){var c=u.target;this._numItemsLoaded++,this._finishOrderedItem(c,!0),this._updateProgress(),u=new ne.ErrorEvent("FILE_LOAD_ERROR",null,c.getItem()),this._sendError(u),this.stopOnError?this.setPaused(!0):(this._removeLoadItem(c),this._cleanLoadItem(c),this._loadNext())},v._handleFileComplete=function(u){var c=u.target,x=c.getItem(),N=c.getResult();this._loadedResults[x.id]=N,u=c.getResult(!0),u!=null&&u!==N&&(this._loadedRawResults[x.id]=u),this._saveLoadedItems(c),this._removeLoadItem(c),this._finishOrderedItem(c)||this._processFinishedLoad(x,c),this._cleanLoadItem(c)},v._saveLoadedItems=function(u){var c=u.getLoadedItems();if(c!==null)for(var x=0;x<c.length;x++){var N=c[x].item;this._loadItemsBySrc[N.src]=N,this._loadItemsById[N.id]=N,this._loadedResults[N.id]=c[x].result,this._loadedRawResults[N.id]=c[x].rawResult}},v._finishOrderedItem=function(u,c){var x=u.getItem();return this.maintainScriptOrder&&x.type==ne.Types.JAVASCRIPT||x.maintainOrder?(u instanceof ne.JavaScriptLoader&&(this._currentlyLoadingScript=!1),u=ne.indexOf(this._scriptOrder,x),u==-1?!1:(this._loadedScripts[u]=c===!0||x,this._checkScriptLoadOrder(),!0)):!1},v._checkScriptLoadOrder=function(){for(var u=this._loadedScripts.length,c=0;c<u;c++){var x,N=this._loadedScripts[c];if(N===null)break;N!==!0&&(x=this._loadedResults[N.id],N.type==ne.Types.JAVASCRIPT&&ne.DomUtils.appendToHead(x),x=N._loader,this._processFinishedLoad(N,x),this._loadedScripts[c]=!0)}},v._processFinishedLoad=function(u,c){var x;this._numItemsLoaded++,this.maintainScriptOrder||u.type!=ne.Types.JAVASCRIPT||(x=c.getTag(),ne.DomUtils.appendToHead(x)),this._updateProgress(),this._sendFileComplete(u,c),this._loadNext()},v._canStartLoad=function(u){if(!this.maintainScriptOrder||u.preferXHR||(u=u.getItem(),u.type!=ne.Types.JAVASCRIPT))return!0;if(this._currentlyLoadingScript)return!1;for(var c=this._scriptOrder.indexOf(u),x=0;x<c;){if(this._loadedScripts[x]==null)return!1;x++}return this._currentlyLoadingScript=!0},v._removeLoadItem=function(u){for(var c=this._currentLoads.length,x=0;x<c;x++)if(this._currentLoads[x]==u){this._currentLoads.splice(x,1);break}},v._cleanLoadItem=function(u){u=u.getItem(),u&&delete u._loader},v._handleProgress=function(u){u=u.target,this._sendFileProgress(u.getItem(),u.progress),this._updateProgress()},v._updateProgress=function(){var u=this._numItemsLoaded/this._numItems,c=this._numItems-this._numItemsLoaded;if(0<c){for(var x=0,N=0,z=this._currentLoads.length;N<z;N++)x+=this._currentLoads[N].progress;u+=x/c*(c/this._numItems)}this._lastProgress!=u&&(this._sendProgress(u),this._lastProgress=u)},v._disposeItem=function(u){delete this._loadedResults[u.id],delete this._loadedRawResults[u.id],delete this._loadItemsById[u.id],delete this._loadItemsBySrc[u.src]},v._sendFileProgress=function(u,c){var x;this._isCanceled()||this._paused||this.hasEventListener("fileprogress")&&((x=new ne.Event("fileprogress")).progress=c,x.loaded=c,x.total=1,x.item=u,this.dispatchEvent(x))},v._sendFileComplete=function(u,c){var x;this._isCanceled()||this._paused||((x=new ne.Event("fileload")).loader=c,x.item=u,x.result=this._loadedResults[u.id],x.rawResult=this._loadedRawResults[u.id],u.completeHandler&&u.completeHandler(x),this.hasEventListener("fileload")&&this.dispatchEvent(x))},v._sendFileStart=function(u){var c=new ne.Event("filestart");c.item=u,this.hasEventListener("filestart")&&this.dispatchEvent(c)},v.toString=function(){return"[PreloadJS LoadQueue]"},ne.LoadQueue=ne.promote(e,"AbstractLoader")}(),function(){"use strict";function e(v){this.AbstractLoader_constructor(v,!0,ne.Types.TEXT)}ne.extend(e,ne.AbstractLoader),e.canLoadItem=function(v){return v.type==ne.Types.TEXT},ne.TextLoader=ne.promote(e,"AbstractLoader")}(),function(){"use strict";function e(a){this.AbstractLoader_constructor(a,!0,ne.Types.BINARY),this.on("initialize",this._updateXHR,this)}var v=ne.extend(e,ne.AbstractLoader);e.canLoadItem=function(a){return a.type==ne.Types.BINARY},v._updateXHR=function(a){a.loader.setResponseType("arraybuffer")},ne.BinaryLoader=ne.promote(e,"AbstractLoader")}(),function(){"use strict";function e(a,u){this.AbstractLoader_constructor(a,u,ne.Types.CSS),this.resultFormatter=this._formatResult,this._tagSrcAttribute="href",this._tag=u?ne.Elements.style():ne.Elements.link(),this._tag.rel="stylesheet",this._tag.type="text/css"}var v=ne.extend(e,ne.AbstractLoader);e.canLoadItem=function(a){return a.type==ne.Types.CSS},v._formatResult=function(a){var u;return this._preferXHR?(u=a.getTag()).styleSheet?u.styleSheet.cssText=a.getResult(!0):(a=ne.Elements.text(a.getResult(!0)),u.appendChild(a)):u=this._tag,ne.DomUtils.appendToHead(u),u},ne.CSSLoader=ne.promote(e,"AbstractLoader")}(),function(){"use strict";function e(a,u){this.AbstractLoader_constructor(a,u,a.type),this._faces={},this._watched=[],this._count=0,this._watchInterval=null,this._loadTimeout=null,this._injectCSS=a.injectCSS===void 0||a.injectCSS,this.dispatchEvent("initialize")}var v=ne.extend(e,ne.AbstractLoader);e.canLoadItem=function(a){return a.type==ne.Types.FONT||a.type==ne.Types.FONTCSS},e.sampleText="abcdefghijklmnopqrstuvwxyz ABCDEFGHIJKLMNOPQRSTUVWXYZ",e._ctx=document.createElement("canvas").getContext("2d"),e._referenceFonts=["serif","monospace"],e.WEIGHT_REGEX=/[- ._]*(thin|normal|book|regular|medium|black|heavy|[1-9]00|(?:extra|ultra|semi|demi)?[- ._]*(?:light|bold))[- ._]*/gi,e.STYLE_REGEX=/[- ._]*(italic|oblique)[- ._]*/gi,e.FONT_FORMAT={woff2:"woff2",woff:"woff",ttf:"truetype",otf:"truetype"},e.FONT_WEIGHT={thin:100,extralight:200,ultralight:200,light:300,semilight:300,demilight:300,book:"normal",regular:"normal",semibold:600,demibold:600,extrabold:800,ultrabold:800,black:900,heavy:900},e.WATCH_DURATION=10,v.load=function(){var a;if(this.type==ne.Types.FONTCSS){if(!this._watchCSS())return void this.AbstractLoader_load()}else this._item.src instanceof Array?this._watchFontArray():(a=this._defFromSrc(this._item.src),this._watchFont(a),this._injectStyleTag(this._cssFromDef(a)));this._loadTimeout=setTimeout(ne.proxy(this._handleTimeout,this),this._item.loadTimeout),this.dispatchEvent("loadstart")},v._handleTimeout=function(){this._stopWatching(),this.dispatchEvent(new ne.ErrorEvent("PRELOAD_TIMEOUT"))},v._createRequest=function(){return this._request},v.handleEvent=function(a){switch(a.type){case"complete":this._rawResult=a.target._response,this._result=!0,this._parseCSS(this._rawResult);break;case"error":this._stopWatching(),this.AbstractLoader_handleEvent(a)}},v._watchCSS=function(){var a=this._item.src;return a instanceof HTMLStyleElement&&(this._injectCSS&&!a.parentNode&&(document.head||document.getElementsByTagName("head")[0]).appendChild(a),this._injectCSS=!1,a="\n"+a.textContent),a.search(/\n|\r|@font-face/i)!==-1?(this._parseCSS(a),!0):(this._request=new ne.XHRRequest(this._item),!1)},v._parseCSS=function(a){for(var u=/@font-face\s*\{([^}]+)}/g;;){var c=u.exec(a);if(!c)break;this._watchFont(this._parseFontFace(c[1]))}this._injectStyleTag(a)},v._watchFontArray=function(){for(var a=this._item.src,u="",c=a.length-1;0<=c;c--){var x=a[c],x=typeof x=="string"?this._defFromSrc(x):this._defFromObj(x);this._watchFont(x),u+=this._cssFromDef(x)+"\n"}this._injectStyleTag(u)},v._injectStyleTag=function(a){var u,c;this._injectCSS&&(u=document.head||document.getElementsByTagName("head")[0],(c=document.createElement("style")).type="text/css",c.styleSheet?c.styleSheet.cssText=a:c.appendChild(document.createTextNode(a)),u.appendChild(c))},v._parseFontFace=function(a){var u=this._getCSSValue(a,"font-family"),c=this._getCSSValue(a,"src");return u&&c?this._defFromObj({family:u,src:c,style:this._getCSSValue(a,"font-style"),weight:this._getCSSValue(a,"font-weight")}):null},v._watchFont=function(a){a&&!this._faces[a.id]&&(this._faces[a.id]=a,this._watched.push(a),this._count++,this._calculateReferenceSizes(a),this._startWatching())},v._startWatching=function(){this._watchInterval==null&&(this._watchInterval=setInterval(ne.proxy(this._watch,this),e.WATCH_DURATION))},v._stopWatching=function(){clearInterval(this._watchInterval),clearTimeout(this._loadTimeout),this._watchInterval=null},v._watch=function(){for(var a=this._watched,u=e._referenceFonts,c=a.length,x=c-1;0<=x;x--)for(var N=a[x],z=N.refs,oe=z.length-1;0<=oe;oe--)if(this._getTextWidth(N.family+","+u[oe],N.weight,N.style)!=z[oe]){var Ee=new ne.Event("fileload");N.type="font-family",Ee.item=N,this.dispatchEvent(Ee),a.splice(x,1);break}c!==a.length&&(Ee=new ne.ProgressEvent(this._count-a.length,this._count),this.dispatchEvent(Ee)),c===0&&(this._stopWatching(),this._sendComplete())},v._calculateReferenceSizes=function(a){for(var u=e._referenceFonts,c=a.refs=[],x=0;x<u.length;x++)c[x]=this._getTextWidth(u[x],a.weight,a.style)},v._defFromSrc=function(a){var u=/[- ._]+/g,c=a,x=null,N=c.search(/[?#]/);N!==-1&&(c=c.substr(0,N)),(N=c.lastIndexOf("."))!==-1&&(x=c.substr(N+1),c=c.substr(0,N)),(N=c.lastIndexOf("/"))!==-1&&(c=c.substr(N+1));var z=c,oe=z.match(e.WEIGHT_REGEX);return oe&&(oe=oe[0],z=z.replace(oe,""),oe=oe.replace(u,"").toLowerCase()),N=c.match(e.STYLE_REGEX),N&&(z=z.replace(N[0],""),N="italic"),z=z.replace(u,""),a="local('"+c.replace(u," ")+"'), url('"+a+"')",x=e.FONT_FORMAT[x],x&&(a+=" format('"+x+"')"),this._defFromObj({family:z,weight:e.FONT_WEIGHT[oe]||oe,style:N,src:a})},v._defFromObj=function(a){return a={family:a.family,src:a.src,style:a.style||"normal",weight:a.weight||"normal"},a.id=a.family+";"+a.style+";"+a.weight,a},v._cssFromDef=function(a){return"@font-face {\n	font-family: '"+a.family+"';\n	font-style: "+a.style+";\n	font-weight: "+a.weight+";\n	src: "+a.src+";\n}"},v._getTextWidth=function(a,u,c){var x=e._ctx;return x.font=c+" "+u+" 72px "+a,x.measureText(e.sampleText).width},v._getCSSValue=function(a,u){return a=new RegExp(u+":s*([^;}]+?)s*[;}]").exec(a),a&&a[1]?a[1]:null},ne.FontLoader=ne.promote(e,"AbstractLoader")}(),function(){"use strict";function e(a,u){this.AbstractLoader_constructor(a,u,ne.Types.IMAGE),this.resultFormatter=this._formatResult,this._tagSrcAttribute="src",ne.DomUtils.isImageTag(a)?this._tag=a:ne.DomUtils.isImageTag(a.src)?this._tag=a.src:ne.DomUtils.isImageTag(a.tag)&&(this._tag=a.tag),this._tag!=null?this._preferXHR=!1:this._tag=ne.Elements.img(),this.on("initialize",this._updateXHR,this)}var v=ne.extend(e,ne.AbstractLoader);e.canLoadItem=function(a){return a.type==ne.Types.IMAGE},v.load=function(){var a;this._tag.src!=""&&this._tag.complete?this._sendComplete():((a=this._item.crossOrigin)==1&&(a="Anonymous"),a==null||ne.URLUtils.isLocal(this._item)||(this._tag.crossOrigin=a),this.AbstractLoader_load())},v._updateXHR=function(a){a.loader.mimeType="text/plain; charset=x-user-defined-binary",a.loader.setResponseType&&a.loader.setResponseType("blob")},v._formatResult=function(a){return this._formatImage},v._formatImage=function(a,u){var c=this._tag,x=window.URL||window.webkitURL;this._preferXHR&&(x?(this.getResult(!0)&&(x=x.createObjectURL(this.getResult(!0)),c.src=x),c.addEventListener("load",this._cleanUpURL,!1),c.addEventListener("error",this._cleanUpURL,!1)):c.src=this._item.src),c.complete?a(c):(c.onload=ne.proxy(function(){a(this._tag),c.onload=c.onerror=null},this),c.onerror=ne.proxy(function(N){u(new ne.ErrorEvent("IMAGE_FORMAT",null,N)),c.onload=c.onerror=null},this))},v._cleanUpURL=function(a){(window.URL||window.webkitURL).revokeObjectURL(a.target.src)},ne.ImageLoader=ne.promote(e,"AbstractLoader")}(),function(){"use strict";function e(a,u){this.AbstractLoader_constructor(a,u,ne.Types.JAVASCRIPT),this.resultFormatter=this._formatResult,this._tagSrcAttribute="src",this.setTag(ne.Elements.script())}var v=ne.extend(e,ne.AbstractLoader);e.canLoadItem=function(a){return a.type==ne.Types.JAVASCRIPT},v._formatResult=function(a){var u=a.getTag();return this._preferXHR&&(u.text=a.getResult(!0)),u},ne.JavaScriptLoader=ne.promote(e,"AbstractLoader")}(),function(){"use strict";function e(a){this.AbstractLoader_constructor(a,!0,ne.Types.JSON),this.resultFormatter=this._formatResult}var v=ne.extend(e,ne.AbstractLoader);e.canLoadItem=function(a){return a.type==ne.Types.JSON},v._formatResult=function(a){var u=null;try{u=ne.DataUtils.parseJSON(a.getResult(!0))}catch(x){var c=new ne.ErrorEvent("JSON_FORMAT",null,x);return this._sendError(c),x}return u},ne.JSONLoader=ne.promote(e,"AbstractLoader")}(),function(){"use strict";function e(a){this.AbstractLoader_constructor(a,!1,ne.Types.JSONP),this.setTag(ne.Elements.script()),this.getTag().type="text/javascript"}var v=ne.extend(e,ne.AbstractLoader);e.canLoadItem=function(a){return a.type==ne.Types.JSONP},v.cancel=function(){this.AbstractLoader_cancel(),this._dispose()},v.load=function(){if(this._item.callback==null)throw new Error("callback is required for loading JSONP requests.");if(window[this._item.callback]!=null)throw new Error("JSONP callback '"+this._item.callback+"' already exists on window. You need to specify a different callback or re-name the current one.");window[this._item.callback]=ne.proxy(this._handleLoad,this),ne.DomUtils.appendToBody(this._tag),this._loadTimeout=setTimeout(ne.proxy(this._handleTimeout,this),this._item.loadTimeout),this._tag.src=this._item.src},v._handleLoad=function(a){this._result=this._rawResult=a,this._sendComplete(),this._dispose()},v._handleTimeout=function(){this._dispose(),this.dispatchEvent(new ne.ErrorEvent("timeout"))},v._dispose=function(){ne.DomUtils.removeChild(this._tag),delete window[this._item.callback],clearTimeout(this._loadTimeout)},ne.JSONPLoader=ne.promote(e,"AbstractLoader")}(),function(){"use strict";function e(u,c){this.AbstractLoader_constructor(u,c,ne.Types.MANIFEST),this.plugins=null,this._manifestQueue=null}var v=ne.extend(e,ne.AbstractLoader),a=e;a.MANIFEST_PROGRESS=.25,a.canLoadItem=function(u){return u.type==ne.Types.MANIFEST},v.load=function(){this.AbstractLoader_load()},v._createRequest=function(){var u=this._item.callback;this._request=new(u!=null?ne.JSONPLoader:ne.JSONLoader)(this._item)},v.handleEvent=function(u){switch(u.type){case"complete":return this._rawResult=u.target.getResult(!0),this._result=u.target.getResult(),this._sendProgress(a.MANIFEST_PROGRESS),void this._loadManifest(this._result);case"progress":return u.loaded*=a.MANIFEST_PROGRESS,this.progress=u.loaded/u.total,!isNaN(this.progress)&&this.progress!=1/0||(this.progress=0),void this._sendProgress(u)}this.AbstractLoader_handleEvent(u)},v.destroy=function(){this.AbstractLoader_destroy(),this._manifestQueue.close()},v._loadManifest=function(u){if(u&&u.manifest){var c=this._manifestQueue=new ne.LoadQueue(this._preferXHR);c.on("fileload",this._handleManifestFileLoad,this),c.on("progress",this._handleManifestProgress,this),c.on("complete",this._handleManifestComplete,this,!0),c.on("error",this._handleManifestError,this,!0);for(var x=0,N=this.plugins.length;x<N;x++)c.installPlugin(this.plugins[x]);c.loadManifest(u)}else this._sendComplete()},v._handleManifestFileLoad=function(u){u.target=null,this.dispatchEvent(u)},v._handleManifestComplete=function(u){this._loadedItems=this._manifestQueue.getItems(!0),this._sendComplete()},v._handleManifestProgress=function(u){this.progress=u.progress*(1-a.MANIFEST_PROGRESS)+a.MANIFEST_PROGRESS,this._sendProgress(this.progress)},v._handleManifestError=function(u){var c=new ne.Event("fileerror");c.item=u.data,this.dispatchEvent(c)},ne.ManifestLoader=ne.promote(e,"AbstractLoader")}(),function(){"use strict";function e(a,u){this.AbstractMediaLoader_constructor(a,u,ne.Types.SOUND),ne.DomUtils.isAudioTag(a)||ne.DomUtils.isAudioTag(a.src)?this._tag=a:ne.DomUtils.isAudioTag(a.tag)&&(this._tag=ne.DomUtils.isAudioTag(a)?a:a.src),this._tag!=null&&(this._preferXHR=!1)}var v=ne.extend(e,ne.AbstractMediaLoader);e.canLoadItem=function(a){return a.type==ne.Types.SOUND},v._createTag=function(a){var u=ne.Elements.audio();return u.autoplay=!1,u.preload="none",u.src=a,u},ne.SoundLoader=ne.promote(e,"AbstractMediaLoader")}(),function(){"use strict";function e(a,u){this.AbstractMediaLoader_constructor(a,u,ne.Types.VIDEO),ne.DomUtils.isVideoTag(a)||ne.DomUtils.isVideoTag(a.src)?(this.setTag(ne.DomUtils.isVideoTag(a)?a:a.src),this._preferXHR=!1):this.setTag(this._createTag())}var v=e;ne.extend(e,ne.AbstractMediaLoader)._createTag=function(){return ne.Elements.video()},v.canLoadItem=function(a){return a.type==ne.Types.VIDEO},ne.VideoLoader=ne.promote(e,"AbstractMediaLoader")}(),function(){"use strict";function e(u,c){this.AbstractLoader_constructor(u,c,ne.Types.SPRITESHEET),this._manifestQueue=null}var v=ne.extend(e,ne.AbstractLoader),a=e;a.SPRITESHEET_PROGRESS=.25,a.canLoadItem=function(u){return u.type==ne.Types.SPRITESHEET},v.destroy=function(){this.AbstractLoader_destroy(),this._manifestQueue.close()},v._createRequest=function(){var u=this._item.callback;this._request=new(u!=null?ne.JSONPLoader:ne.JSONLoader)(this._item)},v.handleEvent=function(u){switch(u.type){case"complete":return this._rawResult=u.target.getResult(!0),this._result=u.target.getResult(),this._sendProgress(a.SPRITESHEET_PROGRESS),void this._loadManifest(this._result);case"progress":return u.loaded*=a.SPRITESHEET_PROGRESS,this.progress=u.loaded/u.total,!isNaN(this.progress)&&this.progress!=1/0||(this.progress=0),void this._sendProgress(u)}this.AbstractLoader_handleEvent(u)},v._loadManifest=function(u){var c;u&&u.images&&((c=this._manifestQueue=new ne.LoadQueue(this._preferXHR,this._item.path,this._item.crossOrigin)).on("complete",this._handleManifestComplete,this,!0),c.on("fileload",this._handleManifestFileLoad,this),c.on("progress",this._handleManifestProgress,this),c.on("error",this._handleManifestError,this,!0),c.loadManifest(u.images))},v._handleManifestFileLoad=function(u){var c,x=u.result;x!=null&&(u=(c=this.getResult().images).indexOf(u.item.src),c[u]=x)},v._handleManifestComplete=function(u){this._result=new ne.SpriteSheet(this._result),this._loadedItems=this._manifestQueue.getItems(!0),this._sendComplete()},v._handleManifestProgress=function(u){this.progress=u.progress*(1-a.SPRITESHEET_PROGRESS)+a.SPRITESHEET_PROGRESS,this._sendProgress(this.progress)},v._handleManifestError=function(u){var c=new ne.Event("fileerror");c.item=u.data,this.dispatchEvent(c)},ne.SpriteSheetLoader=ne.promote(e,"AbstractLoader")}(),function(){"use strict";function e(a,u){this.AbstractLoader_constructor(a,u,ne.Types.SVG),this.resultFormatter=this._formatResult,this._tagSrcAttribute="data",u?this.setTag(ne.Elements.svg()):(this.setTag(ne.Elements.object()),this.getTag().type="image/svg+xml")}var v=ne.extend(e,ne.AbstractLoader);e.canLoadItem=function(a){return a.type==ne.Types.SVG},v._formatResult=function(c){var u=ne.DataUtils.parseXML(c.getResult(!0)),c=c.getTag();return!this._preferXHR&&document.body.contains(c)&&document.body.removeChild(c),u.documentElement==null?u:(u=u.documentElement,document.importNode&&(u=document.importNode(u,!0)),c.appendChild(u),c)},ne.SVGLoader=ne.promote(e,"AbstractLoader")}(),function(){"use strict";function e(a){this.AbstractLoader_constructor(a,!0,ne.Types.XML),this.resultFormatter=this._formatResult}var v=ne.extend(e,ne.AbstractLoader);e.canLoadItem=function(a){return a.type==ne.Types.XML},v._formatResult=function(a){return ne.DataUtils.parseXML(a.getResult(!0))},ne.XMLLoader=ne.promote(e,"AbstractLoader")}(),function(){var e=ne.SoundJS=ne.SoundJS||{};e.version="NEXT",e.buildDate="Thu, 14 Sep 2017 22:19:45 GMT"}(),function(){"use strict";function e(){throw"BrowserDetect cannot be instantiated"}var v=e.agent=window.navigator.userAgent;e.isWindowPhone=-1<v.indexOf("IEMobile")||-1<v.indexOf("Windows Phone"),e.isFirefox=-1<v.indexOf("Firefox"),e.isOpera=window.opera!=null,e.isChrome=-1<v.indexOf("Chrome"),e.isIOS=(-1<v.indexOf("iPod")||-1<v.indexOf("iPhone")||-1<v.indexOf("iPad"))&&!e.isWindowPhone,e.isAndroid=-1<v.indexOf("Android")&&!e.isWindowPhone,e.isBlackberry=-1<v.indexOf("Blackberry"),e.isEdge=-1<v.indexOf("Edg"),ne.BrowserDetect=e}(),function(){"use strict";function e(){this.interrupt=null,this.delay=null,this.offset=null,this.loop=null,this.volume=null,this.pan=null,this.startTime=null,this.duration=null}var v=e.prototype={},a=e;a.create=function(u){if(typeof u=="string")return console&&(console.warn||console.log)("Deprecated behaviour. Sound.play takes a configuration object instead of individual arguments. See docs for info."),new ne.PlayPropsConfig().set({interrupt:u});if(u==null||u instanceof a||u instanceof Object)return new ne.PlayPropsConfig().set(u);if(u==null)throw new Error("PlayProps configuration not recognized.")},v.set=function(u){if(u!=null)for(var c in u)this[c]=u[c];return this},v.toString=function(){return"[PlayPropsConfig]"},ne.PlayPropsConfig=a}(),function(){"use strict";function e(){throw"Sound cannot be instantiated"}var v=e;function a(c,x){this.init(c,x)}v.INTERRUPT_ANY="any",v.INTERRUPT_EARLY="early",v.INTERRUPT_LATE="late",v.INTERRUPT_NONE="none",v.PLAY_INITED="playInited",v.PLAY_SUCCEEDED="playSucceeded",v.PLAY_INTERRUPTED="playInterrupted",v.PLAY_FINISHED="playFinished",v.PLAY_FAILED="playFailed",v.SUPPORTED_EXTENSIONS=["mp3","ogg","opus","mpeg","wav","m4a","mp4","aiff","wma","mid"],v.EXTENSION_MAP={m4a:"mp4"},v.FILE_PATTERN=/^(?:(\w+:)\/{2}(\w+(?:\.\w+)*\/?))?([/.]*?(?:[^?]+)?\/)?((?:[^/?]+)\.(\w+))(?:\?(\S+)?)?$/,v.defaultInterruptBehavior=v.INTERRUPT_NONE,v.alternateExtensions=[],v.activePlugin=null,v._masterVolume=1,v._getMasterVolume=function(){return this._masterVolume},v.getVolume=ne.deprecate(v._getMasterVolume,"Sound.getVolume"),v._setMasterVolume=function(c){if(Number(c)!=null&&(c=Math.max(0,Math.min(1,c)),v._masterVolume=c,!this.activePlugin||!this.activePlugin.setVolume||!this.activePlugin.setVolume(c)))for(var x=this._instances,N=0,z=x.length;N<z;N++)x[N].setMasterVolume(c)},v.setVolume=ne.deprecate(v._setMasterVolume,"Sound.setVolume"),v._masterMute=!1,v._getMute=function(){return this._masterMute},v.getMute=ne.deprecate(v._getMute,"Sound.getMute"),v._setMute=function(c){if(c!=null&&(this._masterMute=c,!this.activePlugin||!this.activePlugin.setMute||!this.activePlugin.setMute(c)))for(var x=this._instances,N=0,z=x.length;N<z;N++)x[N].setMasterMute(c)},v.setMute=ne.deprecate(v._setMute,"Sound.setMute"),v._getCapabilities=function(){return v.activePlugin==null?null:v.activePlugin._capabilities},v.getCapabilities=ne.deprecate(v._getCapabilities,"Sound.getCapabilities"),Object.defineProperties(v,{volume:{get:v._getMasterVolume,set:v._setMasterVolume},muted:{get:v._getMute,set:v._setMute},capabilities:{get:v._getCapabilities}}),v._pluginsRegistered=!1,v._lastID=0,v._instances=[],v._idHash={},v._preloadHash={},v._defaultPlayPropsHash={},v.addEventListener=null,v.removeEventListener=null,v.removeAllEventListeners=null,v.dispatchEvent=null,v.hasEventListener=null,v._listeners=null,ne.EventDispatcher.initialize(v),v.getPreloadHandlers=function(){return{callback:ne.proxy(v.initLoad,v),types:["sound"],extensions:v.SUPPORTED_EXTENSIONS}},v._handleLoadComplete=function(c){var x=c.target.getItem().src;if(v._preloadHash[x])for(var N=0,z=v._preloadHash[x].length;N<z;N++){var oe=v._preloadHash[x][N];v._preloadHash[x][N]=!0,v.hasEventListener("fileload")&&((c=new ne.Event("fileload")).src=oe.src,c.id=oe.id,c.data=oe.data,c.sprite=oe.sprite,v.dispatchEvent(c))}},v._handleLoadError=function(c){var x=c.target.getItem().src;if(v._preloadHash[x])for(var N=0,z=v._preloadHash[x].length;N<z;N++){var oe=v._preloadHash[x][N];v._preloadHash[x][N]=!1,v.hasEventListener("fileerror")&&((c=new ne.Event("fileerror")).src=oe.src,c.id=oe.id,c.data=oe.data,c.sprite=oe.sprite,v.dispatchEvent(c))}},v._registerPlugin=function(c){return!!c.isSupported()&&(v.activePlugin=new c,!0)},v.registerPlugins=function(c){v._pluginsRegistered=!0;for(var x=0,N=c.length;x<N;x++)if(v._registerPlugin(c[x]))return!0;return!1},v.initializeDefaultPlugins=function(){return v.activePlugin!=null||!v._pluginsRegistered&&!!v.registerPlugins([ne.WebAudioPlugin,ne.HTMLAudioPlugin])},v.isReady=function(){return v.activePlugin!=null},v.initLoad=function(c){return c.type=="video"||v._registerSound(c)},v._registerSound=function(c){if(!v.initializeDefaultPlugins()||(c.src instanceof Object?(Ee=v._parseSrc(c.src)).src=c.path+Ee.src:Ee=v._parsePath(c.src),Ee==null))return!1;c.src=Ee.src,c.type="sound";var x=c.data,N=null;if(x!=null&&(isNaN(x.channels)?isNaN(x)||(N=parseInt(x)):N=parseInt(x.channels),x.audioSprite))for(var z,oe=x.audioSprite.length;oe--;)z=x.audioSprite[oe],v._idHash[z.id]={src:c.src,startTime:parseInt(z.startTime),duration:parseInt(z.duration)},z.defaultPlayProps&&(v._defaultPlayPropsHash[z.id]=ne.PlayPropsConfig.create(z.defaultPlayProps));c.id!=null&&(v._idHash[c.id]={src:c.src});var Ee=v.activePlugin.register(c);return a.create(c.src,N),x!=null&&isNaN(x)?c.data.channels=N||a.maxPerChannel():c.data=N||a.maxPerChannel(),Ee.type&&(c.type=Ee.type),c.defaultPlayProps&&(v._defaultPlayPropsHash[c.src]=ne.PlayPropsConfig.create(c.defaultPlayProps)),Ee},v.registerSound=function(c,x,N,z,oe){if(oe={src:c,id:x,data:N,defaultPlayProps:oe},c instanceof Object&&c.src&&(z=x,oe=c),((oe=ne.LoadItem.create(oe)).path=z)==null||oe.src instanceof Object||(oe.src=z+oe.src),z=v._registerSound(oe),!z)return!1;if(v._preloadHash[oe.src]||(v._preloadHash[oe.src]=[]),v._preloadHash[oe.src].push(oe),v._preloadHash[oe.src].length==1)z.on("complete",this._handleLoadComplete,this),z.on("error",this._handleLoadError,this),v.activePlugin.preload(z);else if(v._preloadHash[oe.src][0]==1)return!0;return oe},v.registerSounds=function(c,x){var N=[];c.path&&(x?x+=c.path:x=c.path,c=c.manifest);for(var z=0,oe=c.length;z<oe;z++)N[z]=ne.Sound.registerSound(c[z].src,c[z].id,c[z].data,x,c[z].defaultPlayProps);return N},v.removeSound=function(c,x){if(v.activePlugin==null)return!1;var N,z;if(c instanceof Object&&c.src&&(c=c.src),(N=c instanceof Object?v._parseSrc(c):(c=v._getSrcById(c).src,v._parsePath(c)))==null)return!1;for(z in c=N.src,x!=null&&(c=x+c),v._idHash)v._idHash[z].src==c&&delete v._idHash[z];return a.removeSrc(c),delete v._preloadHash[c],v.activePlugin.removeSound(c),!0},v.removeSounds=function(c,x){var N=[];c.path&&(x?x+=c.path:x=c.path,c=c.manifest);for(var z=0,oe=c.length;z<oe;z++)N[z]=ne.Sound.removeSound(c[z].src,x);return N},v.removeAllSounds=function(){v._idHash={},v._preloadHash={},a.removeAll(),v.activePlugin&&v.activePlugin.removeAllSounds()},v.loadComplete=function(c){if(!v.isReady())return!1;var x=v._parsePath(c);return c=(x?v._getSrcById(x.src):v._getSrcById(c)).src,v._preloadHash[c]!=null&&v._preloadHash[c][0]==1},v._parsePath=function(c){typeof c!="string"&&(c=c.toString());var x=c.match(v.FILE_PATTERN);if(x==null)return!1;for(var N=x[4],z=x[5],oe=v.capabilities,Ee=0;!oe[z];)if(z=v.alternateExtensions[Ee++],Ee>v.alternateExtensions.length)return null;return{name:N,src:c=c.replace("."+x[5],"."+z),extension:z}},v._parseSrc=function(c){var x,N={name:void 0,src:void 0,extension:void 0},z=v.capabilities;for(x in c)if(c.hasOwnProperty(x)&&z[x]){N.src=c[x],N.extension=x;break}if(!N.src)return!1;var oe=N.src.lastIndexOf("/");return N.name=oe!=-1?N.src.slice(oe+1):N.src,N},v.play=function(c,x){var N;return ne.WebAudioPlugin&&ne.WebAudioPlugin.context&&(console.log("audio context available"),(N=ne.WebAudioPlugin.context).state!=="interrupted"&&N.state!=="suspended"||N.resume()),x=ne.PlayPropsConfig.create(x),c=v.createInstance(c,x.startTime,x.duration),N&&(c.audioCtx=N),v._playInstance(c,x)||c._playFailed(),c},v.createInstance=function(c,x,N){if(!v.initializeDefaultPlugins())return new ne.DefaultSoundInstance(c,x,N);var z=v._defaultPlayPropsHash[c];c=v._getSrcById(c);var oe=v._parsePath(c.src),Ee=null;return oe!=null&&oe.src!=null?(a.create(oe.src),x==null&&(x=c.startTime),Ee=v.activePlugin.create(oe.src,x,N||c.duration),(z=z||v._defaultPlayPropsHash[oe.src])&&Ee.applyPlayProps(z)):Ee=new ne.DefaultSoundInstance(c,x,N),Ee.uniqueId=v._lastID++,Ee},v.stop=function(){for(var c=this._instances,x=c.length;x--;)c[x].stop()},v.setDefaultPlayProps=function(c,x){c=v._getSrcById(c),v._defaultPlayPropsHash[v._parsePath(c.src).src]=ne.PlayPropsConfig.create(x)},v.getDefaultPlayProps=function(c){return c=v._getSrcById(c),v._defaultPlayPropsHash[v._parsePath(c.src).src]},v._playInstance=function(c,x){var N=v._defaultPlayPropsHash[c.src]||{};if(x.interrupt==null&&(x.interrupt=N.interrupt||v.defaultInterruptBehavior),x.delay==null&&(x.delay=N.delay||0),x.offset==null&&(x.offset=c.position),x.loop==null&&(x.loop=c.loop),x.volume==null&&(x.volume=c.volume),x.pan==null&&(x.pan=c.pan),x.delay==0){if(!v._beginPlaying(c,x))return!1}else N=setTimeout(function(){v._beginPlaying(c,x)},x.delay),c.delayTimeoutId=N;return this._instances.push(c),!0},v._beginPlaying=function(c,x){return a.add(c,x.interrupt)?c._beginPlaying(x)?!0:(c=ne.indexOf(this._instances,c),-1<c&&this._instances.splice(c,1),!1):!1},v._getSrcById=function(c){return v._idHash[c]||{src:c}},v._playFinished=function(c){a.remove(c),c=ne.indexOf(this._instances,c),-1<c&&this._instances.splice(c,1)},ne.Sound=e,a.channels={},a.create=function(c,x){return a.get(c)==null&&(a.channels[c]=new a(c,x),!0)},a.removeSrc=function(c){var x=a.get(c);return x!=null&&(x._removeAll(),delete a.channels[c],!0)},a.removeAll=function(){for(var c in a.channels)a.channels[c]._removeAll();a.channels={}},a.add=function(c,x){var N=a.get(c.src);return N!=null&&N._add(c,x)},a.remove=function(c){var x=a.get(c.src);return x!=null&&(x._remove(c),!0)},a.maxPerChannel=function(){return u.maxDefault},a.get=function(c){return a.channels[c]};var u=a.prototype;u.constructor=a,u.src=null,u.max=null,u.maxDefault=100,u.length=0,u.init=function(c,x){this.src=c,this.max=x||this.maxDefault,this.max==-1&&(this.max=this.maxDefault),this._instances=[]},u._get=function(c){return this._instances[c]},u._add=function(c,x){return!!this._getSlot(x,c)&&(this._instances.push(c),this.length++,!0)},u._remove=function(c){return c=ne.indexOf(this._instances,c),c!=-1&&(this._instances.splice(c,1),this.length--,!0)},u._removeAll=function(){for(var c=this.length-1;0<=c;c--)this._instances[c].stop()},u._getSlot=function(c,x){var N,z;if(c!=e.INTERRUPT_NONE&&(z=this._get(0))==null)return!0;for(var oe=0,Ee=this.max;oe<Ee;oe++){if((N=this._get(oe))==null)return!0;if(N.playState==e.PLAY_FINISHED||N.playState==e.PLAY_INTERRUPTED||N.playState==e.PLAY_FAILED){z=N;break}c!=e.INTERRUPT_NONE&&(c==e.INTERRUPT_EARLY&&N.position<z.position||c==e.INTERRUPT_LATE&&N.position>z.position)&&(z=N)}return z!=null&&(z._interrupt(),this._remove(z),!0)},u.toString=function(){return"[Sound SoundChannel]"}}(),function(){"use strict";function e(a,u,c,x){this.EventDispatcher_constructor(),this.src=a,this.uniqueId=-1,this.playState=null,this.delayTimeoutId=null,this._volume=1,Object.defineProperty(this,"volume",{get:this._getVolume,set:this._setVolume}),this._pan=0,Object.defineProperty(this,"pan",{get:this._getPan,set:this._setPan}),this._startTime=Math.max(0,u||0),Object.defineProperty(this,"startTime",{get:this._getStartTime,set:this._setStartTime}),this._duration=Math.max(0,c||0),Object.defineProperty(this,"duration",{get:this._getDuration,set:this._setDuration}),this._playbackResource=null,Object.defineProperty(this,"playbackResource",{get:this._getPlaybackResource,set:this._setPlaybackResource}),x!==!1&&x!==!0&&this._setPlaybackResource(x),this._position=0,Object.defineProperty(this,"position",{get:this._getPosition,set:this._setPosition}),this._loop=0,Object.defineProperty(this,"loop",{get:this._getLoop,set:this._setLoop}),this._muted=!1,Object.defineProperty(this,"muted",{get:this._getMuted,set:this._setMuted}),this._paused=!1,Object.defineProperty(this,"paused",{get:this._getPaused,set:this._setPaused})}var v=ne.extend(e,ne.EventDispatcher);v.play=function(a){return a=ne.PlayPropsConfig.create(a),this.playState==ne.Sound.PLAY_SUCCEEDED?(this.applyPlayProps(a),void(this._paused&&this._setPaused(!1))):(this._cleanUp(),ne.Sound._playInstance(this,a),this)},v.stop=function(){return this._position=0,this._paused=!1,this._handleStop(),this._cleanUp(),this.playState=ne.Sound.PLAY_FINISHED,this},v.destroy=function(){this._cleanUp(),this.src=null,this.playbackResource=null,this.removeAllEventListeners()},v.applyPlayProps=function(a){return a.offset!=null&&this._setPosition(a.offset),a.loop!=null&&this._setLoop(a.loop),a.volume!=null&&this._setVolume(a.volume),a.pan!=null&&this._setPan(a.pan),a.startTime!=null&&(this._setStartTime(a.startTime),this._setDuration(a.duration)),this},v.toString=function(){return"[AbstractSoundInstance]"},v._getPaused=function(){return this._paused},v._setPaused=function(a){if(!(a!==!0&&a!==!1||this._paused==a||a==1&&this.playState!=ne.Sound.PLAY_SUCCEEDED))return(this._paused=a)?this._pause():this._resume(),clearTimeout(this.delayTimeoutId),this},v._setVolume=function(a){return a==this._volume||(this._volume=Math.max(0,Math.min(1,a)),this._muted||this._updateVolume()),this},v._getVolume=function(){return this._volume},v._setMuted=function(a){if(a===!0||a===!1)return this._muted=a,this._updateVolume(),this},v._getMuted=function(){return this._muted},v._setPan=function(a){return a==this._pan||(this._pan=Math.max(-1,Math.min(1,a)),this._updatePan()),this},v._getPan=function(){return this._pan},v._getPosition=function(){return this._paused||this.playState!=ne.Sound.PLAY_SUCCEEDED||(this._position=this._calculateCurrentPosition()),this._position},v._setPosition=function(a){return this._position=Math.max(0,a),this.playState==ne.Sound.PLAY_SUCCEEDED&&this._updatePosition(),this},v._getStartTime=function(){return this._startTime},v._setStartTime=function(a){return a==this._startTime||(this._startTime=Math.max(0,a||0),this._updateStartTime()),this},v._getDuration=function(){return this._duration},v._setDuration=function(a){return a==this._duration||(this._duration=Math.max(0,a||0),this._updateDuration()),this},v._setPlaybackResource=function(a){return this._playbackResource=a,this._duration==0&&this._playbackResource&&this._setDurationFromSource(),this},v._getPlaybackResource=function(){return this._playbackResource},v._getLoop=function(){return this._loop},v._setLoop=function(a){this._playbackResource!=null&&(this._loop!=0&&a==0?this._removeLooping(a):this._loop==0&&a!=0&&this._addLooping(a)),this._loop=a},v._sendEvent=function(a){a=new ne.Event(a),this.dispatchEvent(a)},v._cleanUp=function(){clearTimeout(this.delayTimeoutId),this._handleCleanUp(),this._paused=!1,ne.Sound._playFinished(this)},v._interrupt=function(){this._cleanUp(),this.playState=ne.Sound.PLAY_INTERRUPTED,this._sendEvent("interrupted")},v._beginPlaying=function(a){return this._setPosition(a.offset),this._setLoop(a.loop),this._setVolume(a.volume),this._setPan(a.pan),a.startTime!=null&&(this._setStartTime(a.startTime),this._setDuration(a.duration)),this._playbackResource!=null&&this._position<this._duration?(this._paused=!1,this._handleSoundReady(),this.playState=ne.Sound.PLAY_SUCCEEDED,this._sendEvent("succeeded"),!0):(this._playFailed(),!1)},v._playFailed=function(){this._cleanUp(),this.playState=ne.Sound.PLAY_FAILED,this._sendEvent("failed")},v._handleSoundComplete=function(a){if((this._position=0)!=this._loop)return this._loop--,this._handleLoop(),void this._sendEvent("loop");this._cleanUp(),this.playState=ne.Sound.PLAY_FINISHED,this._sendEvent("complete")},v._handleSoundReady=function(){},v._updateVolume=function(){},v._updatePan=function(){},v._updateStartTime=function(){},v._updateDuration=function(){},v._setDurationFromSource=function(){},v._calculateCurrentPosition=function(){},v._updatePosition=function(){},v._removeLooping=function(a){},v._addLooping=function(a){},v._pause=function(){},v._resume=function(){},v._handleStop=function(){},v._handleCleanUp=function(){},v._handleLoop=function(){},ne.AbstractSoundInstance=ne.promote(e,"EventDispatcher"),ne.DefaultSoundInstance=ne.AbstractSoundInstance}(),function(){"use strict";function e(){this._capabilities=null,this._loaders={},this._audioSources={},this._soundInstances={},this._volume=1,this._loaderClass,this._soundInstanceClass}var v=e.prototype;e._capabilities=null,e.isSupported=function(){return!0},v.register=function(a){var u=this._loaders[a.src];return u&&!u.canceled?this._loaders[a.src]:(this._audioSources[a.src]=!0,this._soundInstances[a.src]=[],(u=new this._loaderClass(a)).on("complete",this._handlePreloadComplete,this),this._loaders[a.src]=u)},v.preload=function(a){a.on("error",this._handlePreloadError,this),a.load()},v.isPreloadStarted=function(a){return this._audioSources[a]!=null},v.isPreloadComplete=function(a){return!(this._audioSources[a]==null||this._audioSources[a]==1)},v.removeSound=function(a){if(this._soundInstances[a]){for(var u=this._soundInstances[a].length;u--;)this._soundInstances[a][u].destroy();delete this._soundInstances[a],delete this._audioSources[a],this._loaders[a]&&this._loaders[a].destroy(),delete this._loaders[a]}},v.removeAllSounds=function(){for(var a in this._audioSources)this.removeSound(a)},v.create=function(a,u,c){return this.isPreloadStarted(a)||this.preload(this.register(a)),c=new this._soundInstanceClass(a,u,c,this._audioSources[a]),this._soundInstances[a]&&this._soundInstances[a].push(c),c.setMasterVolume&&c.setMasterVolume(ne.Sound.volume),c.setMasterMute&&c.setMasterMute(ne.Sound.muted),c},v.setVolume=function(a){return this._volume=a,this._updateVolume(),!0},v.getVolume=function(){return this._volume},v.setMute=function(a){return this._updateVolume(),!0},v.toString=function(){return"[AbstractPlugin]"},v._handlePreloadComplete=function(a){var u=a.target.getItem().src;this._audioSources[u]=a.result;for(var c=0,x=this._soundInstances[u].length;c<x;c++)this._soundInstances[u][c].setPlaybackResource(this._audioSources[u]),this._soundInstances[u]=null},v._handlePreloadError=function(a){},v._updateVolume=function(){},ne.AbstractPlugin=e}(),function(){"use strict";function e(a){this.AbstractLoader_constructor(a,!0,ne.Types.SOUND)}var v=ne.extend(e,ne.AbstractLoader);e.context=null,v.toString=function(){return"[WebAudioLoader]"},v._createRequest=function(){this._request=new ne.XHRRequest(this._item,!1),this._request.setResponseType("arraybuffer")},v._sendComplete=function(a){e.context.decodeAudioData(this._rawResult,ne.proxy(this._handleAudioDecoded,this),ne.proxy(this._sendError,this))},v._handleAudioDecoded=function(a){this._result=a,this.AbstractLoader__sendComplete()},ne.WebAudioLoader=ne.promote(e,"AbstractLoader")}(),function(){"use strict";function e(u,c,x,N){this.AbstractSoundInstance_constructor(u,c,x,N),this.gainNode=a.context.createGain(),this.panNode=a.context.createPanner(),this.panNode.panningModel=a._panningModel,this.panNode.connect(this.gainNode),this._updatePan(),this.sourceNode=null,this._soundCompleteTimeout=null,this._sourceNodeNext=null,this._playbackStartTime=0,this._endedHandler=ne.proxy(this._handleSoundComplete,this)}var v=ne.extend(e,ne.AbstractSoundInstance),a=e;a.context=null,a._scratchBuffer=null,a.destinationNode=null,a._panningModel="equalpower",v.destroy=function(){this.AbstractSoundInstance_destroy(),this.panNode.disconnect(0),this.panNode=null,this.gainNode.disconnect(0),this.gainNode=null},v.toString=function(){return"[WebAudioSoundInstance]"},v._updatePan=function(){this.panNode.setPosition(this._pan,0,-.5)},v._removeLooping=function(u){this._sourceNodeNext=this._cleanUpAudioNode(this._sourceNodeNext)},v._addLooping=function(u){this.playState==ne.Sound.PLAY_SUCCEEDED&&(this._sourceNodeNext=this._createAndPlayAudioNode(this._playbackStartTime,0))},v._setDurationFromSource=function(){this._duration=1e3*this.playbackResource.duration},v._handleCleanUp=function(){this.sourceNode&&this.playState==ne.Sound.PLAY_SUCCEEDED&&(this.sourceNode=this._cleanUpAudioNode(this.sourceNode),this._sourceNodeNext=this._cleanUpAudioNode(this._sourceNodeNext)),this.gainNode.numberOfOutputs!=0&&this.gainNode.disconnect(0),clearTimeout(this._soundCompleteTimeout),this._playbackStartTime=0},v._cleanUpAudioNode=function(u){if(u){if(u.stop(0),u.disconnect(0),ne.BrowserDetect.isIOS)try{u.buffer=a._scratchBuffer}catch(c){}u=null}return u},v._handleSoundReady=function(u){this.gainNode.connect(a.destinationNode);var c=.001*this._duration,x=Math.min(.001*Math.max(0,this._position),c);this.sourceNode=this._createAndPlayAudioNode(a.context.currentTime-c,x),this._playbackStartTime=this.sourceNode.startTime-x,this._soundCompleteTimeout=setTimeout(this._endedHandler,1e3*(c-x)),this._loop!=0&&(this._sourceNodeNext=this._createAndPlayAudioNode(this._playbackStartTime,0))},v._createAndPlayAudioNode=function(u,c){var x=a.context.createBufferSource();x.buffer=this.playbackResource,x.connect(this.panNode);var N=.001*this._duration;return x.startTime=u+N,x.start(x.startTime,c+.001*this._startTime,N-c),x},v._pause=function(){this._position=1e3*(a.context.currentTime-this._playbackStartTime),this.sourceNode=this._cleanUpAudioNode(this.sourceNode),this._sourceNodeNext=this._cleanUpAudioNode(this._sourceNodeNext),this.gainNode.numberOfOutputs!=0&&this.gainNode.disconnect(0),clearTimeout(this._soundCompleteTimeout)},v._resume=function(){this._handleSoundReady()},v._updateVolume=function(){var u=this._muted?0:this._volume;u!=this.gainNode.gain.value&&(this.gainNode.gain.value=u)},v._calculateCurrentPosition=function(){return 1e3*(a.context.currentTime-this._playbackStartTime)},v._updatePosition=function(){this.sourceNode=this._cleanUpAudioNode(this.sourceNode),this._sourceNodeNext=this._cleanUpAudioNode(this._sourceNodeNext),clearTimeout(this._soundCompleteTimeout),this._paused||this._handleSoundReady()},v._handleLoop=function(){this._cleanUpAudioNode(this.sourceNode),this.sourceNode=this._sourceNodeNext,this._playbackStartTime=this.sourceNode.startTime,this._sourceNodeNext=this._createAndPlayAudioNode(this._playbackStartTime,0),this._soundCompleteTimeout=setTimeout(this._endedHandler,this._duration)},v._updateDuration=function(){this.playState==ne.Sound.PLAY_SUCCEEDED&&(this._pause(),this._resume())},ne.WebAudioSoundInstance=ne.promote(e,"AbstractSoundInstance")}(),function(){"use strict";function e(){this.AbstractPlugin_constructor(),this._panningModel=a._panningModel,this.context=a.context,this.dynamicsCompressorNode=this.context.createDynamicsCompressor(),this.dynamicsCompressorNode.connect(this.context.destination),this.gainNode=this.context.createGain(),this.gainNode.connect(this.dynamicsCompressorNode),ne.WebAudioSoundInstance.destinationNode=this.gainNode,this._capabilities=a._capabilities,this._loaderClass=ne.WebAudioLoader,this._soundInstanceClass=ne.WebAudioSoundInstance,this._addPropsToClasses()}var v=ne.extend(e,ne.AbstractPlugin),a=e;a._capabilities=null,a._panningModel="equalpower",a.context=null,a._scratchBuffer=null,a._unlocked=!1,a.DEFAULT_SAMPLE_RATE=44100,a.isSupported=function(){var u=ne.BrowserDetect.isIOS||ne.BrowserDetect.isAndroid||ne.BrowserDetect.isBlackberry;return!(location.protocol=="file:"&&!u&&!this._isFileXHRSupported())&&(a._generateCapabilities(),a.context!=null)},a.playEmptySound=function(){var u;a.context!=null&&((u=a.context.createBufferSource()).buffer=a._scratchBuffer,u.connect(a.context.destination),u.start(0,0,0))},a._isFileXHRSupported=function(){return document.location.host},a._generateCapabilities=function(){if(a._capabilities==null){var u=document.createElement("audio");if(u.canPlayType==null||a.context==null&&(a.context=a._createAudioContext(),a.context==null))return null;a._scratchBuffer==null&&(a._scratchBuffer=a.context.createBuffer(1,1,22050)),a._compatibilitySetUp(),"ontouchstart"in window&&a.context.state!="running"&&(a._unlock(),document.addEventListener("mousedown",a._unlock,!0),document.addEventListener("touchstart",a._unlock,!0),document.addEventListener("touchend",a._unlock,!0)),a._capabilities={panning:!0,volume:!0,tracks:-1};for(var c=ne.Sound.SUPPORTED_EXTENSIONS,x=ne.Sound.EXTENSION_MAP,N=0,z=c.length;N<z;N++){var oe=c[N],Ee=x[oe]||oe;a._capabilities[oe]=u.canPlayType("audio/"+oe)!="no"&&u.canPlayType("audio/"+oe)!=""||u.canPlayType("audio/"+Ee)!="no"&&u.canPlayType("audio/"+Ee)!=""}a.context.destination.numberOfChannels<2&&(a._capabilities.panning=!1)}},a._createAudioContext=function(){var u=window.AudioContext||window.webkitAudioContext;if(u==null)return null;var c,x,N=new u;return console.warn("The AudioContext is ready"),/(iPhone|iPad)/i.test(navigator.userAgent)&&N.sampleRate!==a.DEFAULT_SAMPLE_RATE&&(c=N.createBuffer(1,1,a.DEFAULT_SAMPLE_RATE),(x=N.createBufferSource()).buffer=c,x.connect(N.destination),x.start(0),x.disconnect(),N.close(),N=new u),N},a._compatibilitySetUp=function(){var u;a._panningModel="equalpower",a.context.createGain||(a.context.createGain=a.context.createGainNode,(u=a.context.createBufferSource()).__proto__.start=u.__proto__.noteGrainOn,u.__proto__.stop=u.__proto__.noteOff,a._panningModel=0)},a._unlock=function(){a._unlocked||(a.playEmptySound(),a.context.state=="running"&&(document.removeEventListener("mousedown",a._unlock,!0),document.removeEventListener("touchend",a._unlock,!0),document.removeEventListener("touchstart",a._unlock,!0),a._unlocked=!0))},v.toString=function(){return"[WebAudioPlugin]"},v._addPropsToClasses=function(){var u=this._soundInstanceClass;u.context=this.context,u._scratchBuffer=a._scratchBuffer,u.destinationNode=this.gainNode,u._panningModel=this._panningModel,this._loaderClass.context=this.context},v._updateVolume=function(){var u=ne.Sound._masterMute?0:this._volume;u!=this.gainNode.gain.value&&(this.gainNode.gain.value=u)},ne.WebAudioPlugin=ne.promote(e,"AbstractPlugin")}(),function(){"use strict";function e(){throw"HTMLAudioTagPool cannot be instantiated"}var v=e;function a(c){this._tags=[]}v._tags={},v._tagPool=new a,v._tagUsed={},v.get=function(c){var x=v._tags[c];return x==null?(x=v._tags[c]=v._tagPool.get()).src=c:v._tagUsed[c]?(x=v._tagPool.get()).src=c:v._tagUsed[c]=!0,x},v.set=function(c,x){x==v._tags[c]?v._tagUsed[c]=!1:v._tagPool.set(x)},v.remove=function(c){var x=v._tags[c];return x!=null&&(v._tagPool.set(x),delete v._tags[c],delete v._tagUsed[c],!0)},v.getDuration=function(c){return c=v._tags[c],c!=null&&c.duration?1e3*c.duration:0},ne.HTMLAudioTagPool=e;var u=a.prototype;u.constructor=a,u.get=function(){var c=this._tags.length==0?this._createTag():this._tags.pop();return c.parentNode==null&&document.body.appendChild(c),c},u.set=function(c){ne.indexOf(this._tags,c)==-1&&(this._tags.src=null,this._tags.push(c))},u.toString=function(){return"[TagPool]"},u._createTag=function(){var c=document.createElement("audio");return c.autoplay=!1,c.preload="none",c}}(),function(){"use strict";function e(a,u,c,x){this.AbstractSoundInstance_constructor(a,u,c,x),this._audioSpriteStopTime=null,this._delayTimeoutId=null,this._endedHandler=ne.proxy(this._handleSoundComplete,this),this._readyHandler=ne.proxy(this._handleTagReady,this),this._stalledHandler=ne.proxy(this._playFailed,this),this._audioSpriteEndHandler=ne.proxy(this._handleAudioSpriteLoop,this),this._loopHandler=ne.proxy(this._handleSoundComplete,this),c?this._audioSpriteStopTime=.001*(u+c):this._duration=ne.HTMLAudioTagPool.getDuration(this.src)}var v=ne.extend(e,ne.AbstractSoundInstance);v.setMasterVolume=function(a){this._updateVolume()},v.setMasterMute=function(a){this._updateVolume()},v.toString=function(){return"[HTMLAudioSoundInstance]"},v._removeLooping=function(){this._playbackResource!=null&&(this._playbackResource.loop=!1,this._playbackResource.removeEventListener(ne.HTMLAudioPlugin._AUDIO_SEEKED,this._loopHandler,!1))},v._addLooping=function(){this._playbackResource==null||this._audioSpriteStopTime||(this._playbackResource.addEventListener(ne.HTMLAudioPlugin._AUDIO_SEEKED,this._loopHandler,!1),this._playbackResource.loop=!0)},v._handleCleanUp=function(){var a=this._playbackResource;if(a!=null){a.pause(),a.loop=!1,a.removeEventListener(ne.HTMLAudioPlugin._AUDIO_ENDED,this._endedHandler,!1),a.removeEventListener(ne.HTMLAudioPlugin._AUDIO_READY,this._readyHandler,!1),a.removeEventListener(ne.HTMLAudioPlugin._AUDIO_STALLED,this._stalledHandler,!1),a.removeEventListener(ne.HTMLAudioPlugin._AUDIO_SEEKED,this._loopHandler,!1),a.removeEventListener(ne.HTMLAudioPlugin._TIME_UPDATE,this._audioSpriteEndHandler,!1);try{a.currentTime=this._startTime}catch(u){}ne.HTMLAudioTagPool.set(this.src,a),this._playbackResource=null}},v._beginPlaying=function(a){return this._playbackResource=ne.HTMLAudioTagPool.get(this.src),this.AbstractSoundInstance__beginPlaying(a)},v._handleSoundReady=function(a){if(this._playbackResource.readyState!==4){var u=this._playbackResource;return u.addEventListener(ne.HTMLAudioPlugin._AUDIO_READY,this._readyHandler,!1),u.addEventListener(ne.HTMLAudioPlugin._AUDIO_STALLED,this._stalledHandler,!1),u.preload="auto",void u.load()}this._updateVolume(),this._playbackResource.currentTime=.001*(this._startTime+this._position),this._audioSpriteStopTime?this._playbackResource.addEventListener(ne.HTMLAudioPlugin._TIME_UPDATE,this._audioSpriteEndHandler,!1):(this._playbackResource.addEventListener(ne.HTMLAudioPlugin._AUDIO_ENDED,this._endedHandler,!1),this._loop!=0&&(this._playbackResource.addEventListener(ne.HTMLAudioPlugin._AUDIO_SEEKED,this._loopHandler,!1),this._playbackResource.loop=!0)),this._playbackResource.play()},v._handleTagReady=function(a){this._playbackResource.removeEventListener(ne.HTMLAudioPlugin._AUDIO_READY,this._readyHandler,!1),this._playbackResource.removeEventListener(ne.HTMLAudioPlugin._AUDIO_STALLED,this._stalledHandler,!1),this._handleSoundReady()},v._pause=function(){this._playbackResource.pause()},v._resume=function(){this._playbackResource.play()},v._updateVolume=function(){var a;this._playbackResource==null||(a=this._muted||ne.Sound._masterMute?0:this._volume*ne.Sound._masterVolume)!=this._playbackResource.volume&&(this._playbackResource.volume=a)},v._calculateCurrentPosition=function(){return 1e3*this._playbackResource.currentTime-this._startTime},v._updatePosition=function(){this._playbackResource.removeEventListener(ne.HTMLAudioPlugin._AUDIO_SEEKED,this._loopHandler,!1),this._playbackResource.addEventListener(ne.HTMLAudioPlugin._AUDIO_SEEKED,this._handleSetPositionSeek,!1);try{this._playbackResource.currentTime=.001*(this._position+this._startTime)}catch(a){this._handleSetPositionSeek(null)}},v._handleSetPositionSeek=function(a){this._playbackResource!=null&&(this._playbackResource.removeEventListener(ne.HTMLAudioPlugin._AUDIO_SEEKED,this._handleSetPositionSeek,!1),this._playbackResource.addEventListener(ne.HTMLAudioPlugin._AUDIO_SEEKED,this._loopHandler,!1))},v._handleAudioSpriteLoop=function(a){this._playbackResource.currentTime<=this._audioSpriteStopTime||(this._playbackResource.pause(),this._loop==0?this._handleSoundComplete(null):(this._position=0,this._loop--,this._playbackResource.currentTime=.001*this._startTime,this._paused||this._playbackResource.play(),this._sendEvent("loop")))},v._handleLoop=function(a){this._loop==0&&(this._playbackResource.loop=!1,this._playbackResource.removeEventListener(ne.HTMLAudioPlugin._AUDIO_SEEKED,this._loopHandler,!1))},v._updateStartTime=function(){this._audioSpriteStopTime=.001*(this._startTime+this._duration),this.playState==ne.Sound.PLAY_SUCCEEDED&&(this._playbackResource.removeEventListener(ne.HTMLAudioPlugin._AUDIO_ENDED,this._endedHandler,!1),this._playbackResource.addEventListener(ne.HTMLAudioPlugin._TIME_UPDATE,this._audioSpriteEndHandler,!1))},v._updateDuration=function(){this._audioSpriteStopTime=.001*(this._startTime+this._duration),this.playState==ne.Sound.PLAY_SUCCEEDED&&(this._playbackResource.removeEventListener(ne.HTMLAudioPlugin._AUDIO_ENDED,this._endedHandler,!1),this._playbackResource.addEventListener(ne.HTMLAudioPlugin._TIME_UPDATE,this._audioSpriteEndHandler,!1))},v._setDurationFromSource=function(){this._duration=ne.HTMLAudioTagPool.getDuration(this.src),this._playbackResource=null},ne.HTMLAudioSoundInstance=ne.promote(e,"AbstractSoundInstance")}(),function(){"use strict";function e(){this.AbstractPlugin_constructor(),this._capabilities=a._capabilities,this._loaderClass=ne.SoundLoader,this._soundInstanceClass=ne.HTMLAudioSoundInstance}var v=ne.extend(e,ne.AbstractPlugin),a=e;a.MAX_INSTANCES=30,a._AUDIO_READY="canplaythrough",a._AUDIO_ENDED="ended",a._AUDIO_SEEKED="seeked",a._AUDIO_STALLED="stalled",a._TIME_UPDATE="timeupdate",a._capabilities=null,a.isSupported=function(){return a._generateCapabilities(),a._capabilities!=null},a._generateCapabilities=function(){if(a._capabilities==null){var u=document.createElement("audio");if(u.canPlayType==null)return null;a._capabilities={panning:!1,volume:!0,tracks:-1};for(var c=ne.Sound.SUPPORTED_EXTENSIONS,x=ne.Sound.EXTENSION_MAP,N=0,z=c.length;N<z;N++){var oe=c[N],Ee=x[oe]||oe;a._capabilities[oe]=u.canPlayType("audio/"+oe)!="no"&&u.canPlayType("audio/"+oe)!=""||u.canPlayType("audio/"+Ee)!="no"&&u.canPlayType("audio/"+Ee)!=""}}},v.register=function(x){var c=ne.HTMLAudioTagPool.get(x.src),x=this.AbstractPlugin_register(x);return x.setTag(c),x},v.removeSound=function(u){this.AbstractPlugin_removeSound(u),ne.HTMLAudioTagPool.remove(u)},v.create=function(u,c,x){return x=this.AbstractPlugin_create(u,c,x),x.playbackResource=null,x},v.toString=function(){return"[HTMLAudioPlugin]"},v.setVolume=v.getVolume=v.setMute=null,ne.HTMLAudioPlugin=ne.promote(e,"AbstractPlugin")}(),function(){"use strict";function e(a){this.EventDispatcher_constructor(),this.ignoreGlobalPause=!1,this.loop=0,this.useTicks=!1,this.reversed=!1,this.bounce=!1,this.timeScale=1,this.duration=0,this.position=0,this.rawPosition=-1,this._paused=!0,this._next=null,this._prev=null,this._parent=null,this._labels=null,this._labelList=null,this._status=-1,this._lastTick=0,a&&(this.useTicks=!!a.useTicks,this.ignoreGlobalPause=!!a.ignoreGlobalPause,this.loop=a.loop===!0?-1:a.loop||0,this.reversed=!!a.reversed,this.bounce=!!a.bounce,this.timeScale=a.timeScale||1,a.onChange&&this.addEventListener("change",a.onChange),a.onComplete&&this.addEventListener("complete",a.onComplete))}var v=ne.extend(e,ne.EventDispatcher);v._setPaused=function(a){return ne.Tween._register(this,a),this},v.setPaused=ne.deprecate(v._setPaused,"AbstractTween.setPaused"),v._getPaused=function(){return this._paused},v.getPaused=ne.deprecate(v._getPaused,"AbstactTween.getPaused"),v._getCurrentLabel=function(a){var u=this.getLabels();a==null&&(a=this.position);for(var c=0,x=u.length;c<x&&!(a<u[c].position);c++);return c===0?null:u[c-1].label},v.getCurrentLabel=ne.deprecate(v._getCurrentLabel,"AbstractTween.getCurrentLabel");try{Object.defineProperties(v,{paused:{set:v._setPaused,get:v._getPaused},currentLabel:{get:v._getCurrentLabel}})}catch(a){}v.advance=function(a,u){this.setPosition(this.rawPosition+a*this.timeScale,u)},v.setPosition=function(a,u,c,x){var N=this.duration,z=this.loop,oe=this.rawPosition,Ee=0,ke=0,t=!1;if(a<0&&(a=0),N===0){if(t=!0,oe!==-1)return t}else{if(ke=a-(Ee=a/N|0)*N,(t=z!==-1&&z*N+N<=a)&&(a=(ke=N)*(Ee=z)+N),a===oe)return t;!this.reversed!=!(this.bounce&&Ee%2)&&(ke=N-ke)}this.position=ke,this.rawPosition=a,this._updatePosition(c,t),t&&(this.paused=!0),x&&x(this),u||this._runActions(oe,a,c,!c&&oe===-1),this.dispatchEvent("change"),t&&this.dispatchEvent("complete")},v.calculatePosition=function(a){var u=this.duration,c=this.loop,x=0,N=0;return u===0?0:(c!==-1&&c*u+u<=a?(N=u,x=c):N=a<0?0:a-(x=a/u|0)*u,!this.reversed!=!(this.bounce&&x%2)?u-N:N)},v.getLabels=function(){var a=this._labelList;if(!a){a=this._labelList=[];var u,c=this._labels;for(u in c)a.push({label:u,position:c[u]});a.sort(function(x,N){return x.position-N.position})}return a},v.setLabels=function(a){this._labels=a,this._labelList=null},v.addLabel=function(a,u){this._labels||(this._labels={}),this._labels[a]=u;var c=this._labelList;if(c){for(var x=0,N=c.length;x<N&&!(u<c[x].position);x++);c.splice(x,0,{label:a,position:u})}},v.gotoAndPlay=function(a){this.paused=!1,this._goto(a)},v.gotoAndStop=function(a){this.paused=!0,this._goto(a)},v.resolve=function(a){var u=Number(a);return isNaN(u)&&(u=this._labels&&this._labels[a]),u},v.toString=function(){return"[AbstractTween]"},v.clone=function(){throw"AbstractTween can not be cloned."},v._init=function(a){a&&a.paused||(this.paused=!1),a&&a.position!=null&&this.setPosition(a.position)},v._updatePosition=function(a,u){},v._goto=function(a){a=this.resolve(a),a!=null&&this.setPosition(a,!1,!0)},v._runActions=function(a,u,c,x){if(this._actionHead||this.tweens){var N,z,oe,Ee,ke=this.duration,t=this.reversed,r=this.bounce,i=this.loop;if(ke===0?(N=z=oe=Ee=0,t=r=!1):(oe=a-(N=a/ke|0)*ke,Ee=u-(z=u/ke|0)*ke),i!==-1&&(i<z&&(Ee=ke,z=i),i<N&&(oe=ke,N=i)),c)return this._runActionsRange(Ee,Ee,c,x);if(N!==z||oe!==Ee||c||x){N===-1&&(N=oe=0);var o=a<=u,l=N;do{var f=!t!=!(r&&l%2),h=l===N?oe:o?0:ke,p=l===z?Ee:o?ke:0;if(f&&(h=ke-h,p=ke-p),(!r||l===N||h!==p)&&this._runActionsRange(h,p,c,x||l!==N&&!r))return!0}while(x=!1,o&&++l<=z||!o&&--l>=z)}}},v._runActionsRange=function(a,u,c,x){},ne.AbstractTween=ne.promote(e,"EventDispatcher")}(),function(){"use strict";function e(c,x){this.AbstractTween_constructor(x),this.pluginData=null,this.target=c,this.passive=!1,this._stepHead=new a(null,0,0,{},null,!0),this._stepTail=this._stepHead,this._stepPosition=0,this._actionHead=null,this._actionTail=null,this._plugins=null,this._pluginIds=null,this._injected=null,x&&(this.pluginData=x.pluginData,x.override&&e.removeTweens(c)),this.pluginData||(this.pluginData={}),this._init(x)}var v=ne.extend(e,ne.AbstractTween);function a(c,x,N,z,oe,Ee){this.next=null,this.prev=c,this.t=x,this.d=N,this.props=z,this.ease=oe,this.passive=Ee,this.index=c?c.index+1:0}function u(c,x,N,z,oe){this.next=null,this.prev=c,this.t=x,this.d=0,this.scope=N,this.funct=z,this.params=oe}e.IGNORE={},e._tweens=[],e._plugins=null,e._tweenHead=null,e._tweenTail=null,e._inTick=0,e.get=function(c,x){return new e(c,x)},e.tick=function(c,x){for(var N=e._tweenHead,z=e._inTick=Date.now();N;){var oe=N._next,Ee=N._status;N._lastTick=z,Ee===1?N._status=0:Ee===-1?e._delist(N):x&&!N.ignoreGlobalPause||N._paused||N.advance(N.useTicks?1:c),N=oe}e._inTick=0},e.handleEvent=function(c){c.type==="tick"&&this.tick(c.delta,c.paused)},e.removeTweens=function(c){if(c.tweenjs_count){for(var x=e._tweenHead;x;){var N=x._next;x.target===c&&e._register(x,!0),x=N}c.tweenjs_count=0}},e.removeAllTweens=function(){for(var c=e._tweenHead;c;){var x=c._next;c._paused=!0,c.target&&(c.target.tweenjs_count=0),c._next=c._prev=null,c=x}e._tweenHead=e._tweenTail=null},e.hasActiveTweens=function(c){return c?!!c.tweenjs_count:!!e._tweenHead},e._installPlugin=function(c){for(var x=c.priority=c.priority||0,N=e._plugins=e._plugins||[],z=0,oe=N.length;z<oe&&!(x<N[z].priority);z++);N.splice(z,0,c)},e._register=function(c,x){var N,z=c.target;!x&&c._paused?(z&&(z.tweenjs_count=z.tweenjs_count?z.tweenjs_count+1:1),(N=e._tweenTail)?(e._tweenTail=N._next=c)._prev=N:e._tweenHead=e._tweenTail=c,c._status=e._inTick?1:0,!e._inited&&ne.Ticker&&(ne.Ticker.addEventListener("tick",e),e._inited=!0)):x&&!c._paused&&(z&&z.tweenjs_count--,e._inTick&&c._lastTick!==e._inTick||e._delist(c),c._status=-1),c._paused=x},e._delist=function(c){var x=c._next,N=c._prev;x?x._prev=N:e._tweenTail=N,N?N._next=x:e._tweenHead=x,c._next=c._prev=null},v.wait=function(c,x){return 0<c&&this._addStep(+c,this._stepTail.props,null,x),this},v.to=function(c,x,N){return(x==null||x<0)&&(x=0),N=this._addStep(+x,null,N),this._appendProps(c,N),this},v.label=function(c){return this.addLabel(c,this.duration),this},v.call=function(c,x,N){return this._addAction(N||this.target,c,x||[this])},v.set=function(c,x){return this._addAction(x||this.target,this._set,[c])},v.play=function(c){return this._addAction(c||this,this._set,[{paused:!1}])},v.pause=function(c){return this._addAction(c||this,this._set,[{paused:!0}])},v.w=v.wait,v.t=v.to,v.c=v.call,v.s=v.set,v.toString=function(){return"[Tween]"},v.clone=function(){throw"Tween can not be cloned."},v._addPlugin=function(c){var x=this._pluginIds||(this._pluginIds={}),N=c.ID;if(N&&!x[N]){x[N]=!0;for(var z=this._plugins||(this._plugins=[]),oe=c.priority||0,Ee=0,ke=z.length;Ee<ke;Ee++)if(oe<z[Ee].priority)return void z.splice(Ee,0,c);z.push(c)}},v._updatePosition=function(c,x){var N=this._stepHead.next,z=this.position,oe=this.duration;if(this.target&&N){for(var Ee=N.next;Ee&&Ee.t<=z;)Ee=(N=N.next).next;oe=x?oe===0?1:z/oe:(z-N.t)/N.d,this._updateTargetProps(N,oe,x)}this._stepPosition=N?z-N.t:0},v._updateTargetProps=function(c,x,N){if(!(this.passive=!!c.passive)){var z,oe,Ee,ke,t=c.prev.props,r=c.props;(ke=c.ease)&&(x=ke(x,0,1,1));var i=this._plugins;e:for(var o in t){if(z=(oe=t[o])!==(Ee=r[o])&&typeof oe=="number"?oe+(Ee-oe)*x:1<=x?Ee:oe,i)for(var l=0,f=i.length;l<f;l++){var h=i[l].change(this,c,o,z,x,N);if(h===e.IGNORE)continue e;h!==void 0&&(z=h)}this.target[o]=z}}},v._runActionsRange=function(c,x,N,z){var oe=x<c,Ee=oe?this._actionTail:this._actionHead,ke=x,t=c;oe&&(ke=c,t=x);for(var r=this.position;Ee;){var i=Ee.t;if((i===x||t<i&&i<ke||z&&i===c)&&(Ee.funct.apply(Ee.scope,Ee.params),r!==this.position))return!0;Ee=oe?Ee.prev:Ee.next}},v._appendProps=function(c,x,N){var z,oe,Ee,ke,t=this._stepHead.props,r=this.target,i=e._plugins,o=x.prev,l=o.props,f=x.props||(x.props=this._cloneProps(l)),h={};for(z in c)if(c.hasOwnProperty(z)&&(h[z]=f[z]=c[z],t[z]===void 0)){if(ke=void 0,i){for(oe=i.length-1;0<=oe;oe--)if((Ee=i[oe].init(this,z,ke))!==void 0&&(ke=Ee),ke===e.IGNORE){delete f[z],delete h[z];break}}ke!==e.IGNORE&&(ke===void 0&&(ke=r[z]),l[z]=ke===void 0?null:ke)}for(z in h){Ee=c[z];for(var p,_=o;(p=_)&&(_=p.prev);)if(_.props!==p.props){if(_.props[z]!==void 0)break;_.props[z]=l[z]}}if(N!==!1&&(i=this._plugins))for(oe=i.length-1;0<=oe;oe--)i[oe].step(this,x,h);(N=this._injected)&&(this._injected=null,this._appendProps(N,x,!1)),this.step=x},v._injectProp=function(c,x){(this._injected||(this._injected={}))[c]=x},v._addStep=function(c,x,N,z){return z=new a(this._stepTail,this.duration,c,x,N,z||!1),this.duration+=c,this._stepTail=this._stepTail.next=z},v._addAction=function(c,x,N){return N=new u(this._actionTail,this.duration,c,x,N),this._actionTail?this._actionTail.next=N:this._actionHead=N,this._actionTail=N,this},v._set=function(c){for(var x in c)this[x]=c[x]},v._cloneProps=function(c){var x,N={};for(x in c)N[x]=c[x];return N},ne.Tween=ne.promote(e,"AbstractTween")}(),function(){"use strict";function e(a){var u,c;a instanceof Array||a==null&&1<arguments.length?(u=a,c=arguments[1],a=arguments[2]):a&&(u=a.tweens,c=a.labels),this.AbstractTween_constructor(a),this.tweens=[],u&&this.addTween.apply(this,u),this.setLabels(c),this._init(a)}var v=ne.extend(e,ne.AbstractTween);v.addTween=function(a){a._parent&&a._parent.removeTween(a);var u=arguments.length;if(1<u){for(var c=0;c<u;c++)this.addTween(arguments[c]);return arguments[u-1]}if(u===0)return null;this.tweens.push(a),a._parent=this,a.paused=!0;var x=a.duration;return 0<a.loop&&(x*=a.loop+1),x>this.duration&&(this.duration=x),0<=this.rawPosition&&a.setPosition(this.rawPosition),a},v.removeTween=function(a){var u=arguments.length;if(1<u){for(var c=!0,x=0;x<u;x++)c=c&&this.removeTween(arguments[x]);return c}if(u===0)return!0;for(var N=this.tweens,x=N.length;x--;)if(N[x]===a)return N.splice(x,1),a._parent=null,a.duration>=this.duration&&this.updateDuration(),!0;return!1},v.updateDuration=function(){for(var a=this.duration=0,u=this.tweens.length;a<u;a++){var c=this.tweens[a],x=c.duration;0<c.loop&&(x*=c.loop+1),x>this.duration&&(this.duration=x)}},v.toString=function(){return"[Timeline]"},v.clone=function(){throw"Timeline can not be cloned."},v._updatePosition=function(a,u){for(var c=this.position,x=0,N=this.tweens.length;x<N;x++)this.tweens[x].setPosition(c,!0,a)},v._runActionsRange=function(a,u,c,x){for(var N=this.position,z=0,oe=this.tweens.length;z<oe;z++)if(this.tweens[z]._runActions(a,u,c,x),N!==this.position)return!0},ne.Timeline=ne.promote(e,"AbstractTween")}(),function(){"use strict";function e(){throw"Ease cannot be instantiated."}e.none=e.linear=function(v){return v},e.get=function(v){return v<-1?v=-1:1<v&&(v=1),function(a){return v==0?a:v<0?a*(a*-v+1+v):a*((2-a)*v+(1-v))}},e.getPowIn=function(v){return function(a){return Math.pow(a,v)}},e.getPowOut=function(v){return function(a){return 1-Math.pow(1-a,v)}},e.getPowInOut=function(v){return function(a){return(a*=2)<1?.5*Math.pow(a,v):1-.5*Math.abs(Math.pow(2-a,v))}},e.quadIn=e.getPowIn(2),e.quadOut=e.getPowOut(2),e.quadInOut=e.getPowInOut(2),e.cubicIn=e.getPowIn(3),e.cubicOut=e.getPowOut(3),e.cubicInOut=e.getPowInOut(3),e.quartIn=e.getPowIn(4),e.quartOut=e.getPowOut(4),e.quartInOut=e.getPowInOut(4),e.quintIn=e.getPowIn(5),e.quintOut=e.getPowOut(5),e.quintInOut=e.getPowInOut(5),e.sineIn=function(v){return 1-Math.cos(v*Math.PI/2)},e.sineOut=function(v){return Math.sin(v*Math.PI/2)},e.sineInOut=function(v){return-.5*(Math.cos(Math.PI*v)-1)},e.backIn=(e.getBackIn=function(v){return function(a){return a*a*((v+1)*a-v)}})(1.7),e.backOut=(e.getBackOut=function(v){return function(a){return--a*a*((v+1)*a+v)+1}})(1.7),e.backInOut=(e.getBackInOut=function(v){return v*=1.525,function(a){return(a*=2)<1?a*a*((v+1)*a-v)*.5:.5*((a-=2)*a*((v+1)*a+v)+2)}})(1.7),e.circIn=function(v){return-(Math.sqrt(1-v*v)-1)},e.circOut=function(v){return Math.sqrt(1- --v*v)},e.circInOut=function(v){return(v*=2)<1?-.5*(Math.sqrt(1-v*v)-1):.5*(Math.sqrt(1-(v-=2)*v)+1)},e.bounceIn=function(v){return 1-e.bounceOut(1-v)},e.bounceOut=function(v){return v<1/2.75?7.5625*v*v:v<2/2.75?7.5625*(v-=1.5/2.75)*v+.75:v<2.5/2.75?7.5625*(v-=2.25/2.75)*v+.9375:7.5625*(v-=2.625/2.75)*v+.984375},e.bounceInOut=function(v){return v<.5?.5*e.bounceIn(2*v):.5*e.bounceOut(2*v-1)+.5},e.elasticIn=(e.getElasticIn=function(v,a){var u=2*Math.PI;return function(c){if(c==0||c==1)return c;var x=a/u*Math.asin(1/v);return-(v*Math.pow(2,10*--c)*Math.sin((c-x)*u/a))}})(1,.3),e.elasticOut=(e.getElasticOut=function(v,a){var u=2*Math.PI;return function(c){if(c==0||c==1)return c;var x=a/u*Math.asin(1/v);return v*Math.pow(2,-10*c)*Math.sin((c-x)*u/a)+1}})(1,.3),e.elasticInOut=(e.getElasticInOut=function(v,a){var u=2*Math.PI;return function(c){var x=a/u*Math.asin(1/v);return(c*=2)<1?v*Math.pow(2,10*--c)*Math.sin((c-x)*u/a)*-.5:v*Math.pow(2,-10*--c)*Math.sin((c-x)*u/a)*.5+1}})(1,.3*1.5),ne.Ease=e}(),function(){"use strict";function e(){throw"MotionGuidePlugin cannot be instantiated."}var v=e;v.priority=0,v.ID="MotionGuide",v.install=function(){return ne.Tween._installPlugin(e),ne.Tween.IGNORE},v.init=function(a,u,c){u=="guide"&&a._addPlugin(v)},v.step=function(a,u,c){for(var x in c)if(x==="guide"){var N=u.props.guide,z=v._solveGuideData(c.guide,N);N.valid=!z;var oe=N.endData;if(a._injectProp("x",oe.x),a._injectProp("y",oe.y),z||!N.orient)break;if(z=u.prev.props.rotation===void 0?a.target.rotation||0:u.prev.props.rotation,N.startOffsetRot=z-N.startData.rotation,N.orient=="fixed")N.endAbsRot=oe.rotation+N.startOffsetRot,N.deltaRotation=0;else{var oe=c.rotation===void 0?a.target.rotation||0:c.rotation,Ee=oe-N.endData.rotation-N.startOffsetRot,ke=Ee%360;switch(N.endAbsRot=oe,N.orient){case"auto":N.deltaRotation=Ee;break;case"cw":N.deltaRotation=(360+ke)%360+360*Math.abs(Ee/360|0);break;case"ccw":N.deltaRotation=(ke-360)%360+-360*Math.abs(Ee/360|0)}}a._injectProp("rotation",N.endAbsRot)}},v.change=function(a,u,c,x,N,z){var oe=u.props.guide;if(oe&&u.props!==u.prev.props&&oe!==u.prev.props.guide)return c==="guide"&&!oe.valid||c=="x"||c=="y"||c==="rotation"&&oe.orient?ne.Tween.IGNORE:void v._ratioToPositionData(N,oe,a.target)},v.debug=function(a,u,c){a=a.guide||a;var x=v._findPathProblems(a);if(x&&console.error("MotionGuidePlugin Error found: \n"+x),!u)return x;var N=a.path,z=N.length;for(u.save(),u.lineCap="round",u.lineJoin="miter",u.beginPath(),u.moveTo(N[0],N[1]),t=2;t<z;t+=4)u.quadraticCurveTo(N[t],N[t+1],N[t+2],N[t+3]);u.strokeStyle="black",u.lineWidth=4.5,u.stroke(),u.strokeStyle="white",u.lineWidth=3,u.stroke(),u.closePath();var oe=c.length;if(c&&oe){var Ee={},ke={};v._solveGuideData(a,Ee);for(var t=0;t<oe;t++)Ee.orient="fixed",v._ratioToPositionData(c[t],Ee,ke),u.beginPath(),u.moveTo(ke.x,ke.y),u.lineTo(ke.x+9*Math.cos(.0174533*ke.rotation),ke.y+9*Math.sin(.0174533*ke.rotation)),u.strokeStyle="black",u.lineWidth=4.5,u.stroke(),u.strokeStyle="red",u.lineWidth=3,u.stroke(),u.closePath()}return u.restore(),x},v._solveGuideData=function(O,u){if(C=v.debug(O))return C;var c=u.path=O.path;u.orient=O.orient,u.subLines=[],u.totalLength=0,u.startOffsetRot=0,u.deltaRotation=0,u.startData={ratio:0},u.endData={ratio:1},u.animSpan=1;for(var x,N,z,oe,Ee=c.length,ke={},t=c[0],r=c[1],i=2;i<Ee;i+=4){x=c[i],N=c[i+1],z=c[i+2],oe=c[i+3];for(var o={weightings:[],estLength:0,portion:0},l=t,f=r,h=1;h<=10;h++){v._getParamsForCurve(t,r,x,N,z,oe,h/10,!1,ke);var p=ke.x-l,_=ke.y-f,b=Math.sqrt(p*p+_*_);o.weightings.push(b),o.estLength+=b,l=ke.x,f=ke.y}for(u.totalLength+=o.estLength,h=0;h<10;h++)b=o.estLength,o.weightings[h]=o.weightings[h]/b;u.subLines.push(o),t=z,r=oe}b=u.totalLength;var w=u.subLines.length;for(i=0;i<w;i++)u.subLines[i].portion=u.subLines[i].estLength/b;var C=isNaN(O.start)?0:O.start,O=isNaN(O.end)?1:O.end;v._ratioToPositionData(C,u,u.startData),v._ratioToPositionData(O,u,u.endData),u.startData.ratio=C,u.endData.ratio=O,u.animSpan=u.endData.ratio-u.startData.ratio},v._ratioToPositionData=function(a,u,c){for(var x,N,z,oe=u.subLines,Ee=0,ke=a*u.animSpan+u.startData.ratio,t=oe.length,r=0;r<t;r++){if(ke<=Ee+(N=oe[r].portion)){z=r;break}Ee+=N}z===void 0&&(z=t-1,Ee-=N);var i=oe[z].weightings,o=N;for(t=i.length,r=0;r<t&&!(ke<=Ee+(N=i[r]*o));r++)Ee+=N;z=4*z+2,x=r/10+(ke-Ee)/N*.1;var l=u.path;return v._getParamsForCurve(l[z-2],l[z-1],l[z],l[z+1],l[z+2],l[z+3],x,u.orient,c),u.orient&&(.99999<=a&&a<=1.00001&&u.endAbsRot!==void 0?c.rotation=u.endAbsRot:c.rotation+=u.startOffsetRot+a*u.deltaRotation),c},v._getParamsForCurve=function(a,u,c,x,N,z,oe,Ee,ke){var t=1-oe;ke.x=t*t*a+2*t*oe*c+oe*oe*N,ke.y=t*t*u+2*t*oe*x+oe*oe*z,Ee&&(ke.rotation=57.2957795*Math.atan2((x-u)*t+(z-x)*oe,(c-a)*t+(N-c)*oe))},v._findPathProblems=function(a){var u=a.path,c=u&&u.length||0;if(c<6||(c-2)%4){var x="	Cannot parse 'path' array due to invalid number of entries in path. ";return x+="There should be an odd number of points, at least 3 points, and 2 entries per point (x & y). ",x+="See 'CanvasRenderingContext2D.quadraticCurveTo' for details as 'path' models a quadratic bezier.\n\n",x+="Only [ "+c+" ] values found. Expected: "+Math.max(4*Math.ceil((c-2)/4)+2,6)}for(var N=0;N<c;N++)if(isNaN(u[N]))return"All data in path array must be numeric";return x=a.start,isNaN(x)&&x!==void 0?"'start' out of bounds. Expected 0 to 1, got: "+x:(x=a.end,isNaN(x)&&x!==void 0?"'end' out of bounds. Expected 0 to 1, got: "+x:(a=a.orient,a&&a!="fixed"&&a!="auto"&&a!="cw"&&a!="ccw"?'Invalid orientation value. Expected ["fixed", "auto", "cw", "ccw", undefined], got: '+a:void 0))},ne.MotionGuidePlugin=e}(),function(){"use strict";var e=ne.TweenJS=ne.TweenJS||{};e.version="NEXT",e.buildDate="Thu, 14 Sep 2017 22:19:45 GMT"}(),Rn.createjs=Rn.createjs||{},function(){"use strict";function e(){throw"CSSPlugin cannot be instantiated."}var v=e;function a(u,c){for(var x,N,z,oe=[!1,u];x=v.TRANSFORM_RE.exec(u);)x[3]!=="*"?(N=[x[1]],z=c&&c[oe.length],!c||z&&N[0]===z[0]||(console.log("transforms don't match: ",N[0],z&&z[0]),c=null),function(Ee,ke,t){for(;;){var r=v.TRANSFORM_VALUE_RE.exec(Ee);if(!r)return;(t=t||[]).push(+r[1],r[2]),ke&&ke[t.length-1]!==r[2]&&(console.log("transform units don't match: ",t[0],ke[t.length-1],r[2]),ke=null)}}(x[2],z,N),oe.push(N)):oe.push(c[oe.length]);return oe[0]=!!c,oe}v.priority=100,v.ID="CSS",v.VALUE_RE=/^(-?[\d.]+)([a-z%]*)$/,v.TRANSFORM_VALUE_RE=/(?:^| |,)(-?[\d.]+)([a-z%]*)/g,v.TRANSFORM_RE=/(\w+?)\(([^)]+)\)|(?:^| )(\*)(?:$| )/g,v.compute=!1,v.install=function(){ne.Tween._installPlugin(e)},v.init=function(u,c,x){var N=u.pluginData;if(!N.CSS_disabled&&u.target instanceof HTMLElement){var z,oe=x||(z=u.target,oe=c,((x=N.CSS_compute)||x==null&&v.compute?window.getComputedStyle(z):z.style)[oe]);if(oe!==void 0)return u._addPlugin(e),u=N.CSS||(N.CSS={}),c==="transform"?(u[c]="_t",a(oe)):(N=v.VALUE_RE.exec(oe),N===null?(u[c]="",oe):(u[c]=N[2],parseFloat(N[1])))}},v.step=function(u,c,x){x.transform&&(c.props.transform=a(c.props.transform,c.prev.props.transform))},v.change=function(u,c,x,N,z,oe){var Ee=u.pluginData.CSS[x];if(Ee!==void 0)return x==="transform"?N=function(ke,t,r){if(r===1)return t[1];if(r===0||!t[0])return ke[1];for(var i,o,l="",f=ke.length,h=2;h<f;h++){var p=ke[h],_=t[h];for(l+=p[0]+"(",i=1,o=p.length;i<o;i+=2)l+=p[i]+(_[i]-p[i])*r,l+=_[i+1]||p[i+1],i<o-2&&(l+=", ");l+=")",h<f-1&&(l+=" ")}return l}(c.prev.props[x],c.props[x],z):N+=Ee,u.target.style[x]=N,ne.Tween.IGNORE},ne.CSSPlugin=v}(),ne.CSSPlugin.install(),Rn.createjs=Rn.createjs||{},function(){"use strict";function e(){throw"DotPlugin cannot be instantiated."}var v=e;v.priority=100,v.ID="Dot",v.install=function(){ne.Tween._installPlugin(e)},v.init=function(a,u,c){var x=a.pluginData;if(!x.Dot_disabled&&u[0]==="."){a._addPlugin(e);for(var N=a.target,z=u.split("."),oe=1,Ee=z.length;oe<Ee-1;oe++)if(!(N=N[z[oe]]))return ne.Tween.IGNORE;var ke=z[oe],a=N[ke],c=c===void 0?a:c;return x.Dot=x.Dot||{},x.Dot[u]={t:N,n:ke},c}},v.step=function(a,u,c){},v.change=function(Ee,u,c,x,N,z){var oe,Ee=Ee.pluginData.Dot;if(Ee&&(oe=Ee[c]))return oe.t[oe.n]=x,ne.Tween.IGNORE},ne.DotPlugin=v}(),Rn.createjs=Rn.createjs||{},function(){"use strict";function e(){throw"RelativePlugin plugin cannot be instantiated."}var v=e;v.ID="Relative",v.install=function(){ne.Tween._installPlugin(e)},v.init=function(a,u,c){a.pluginData.Relative_disabled||a._addPlugin(v)},v.step=function(a,u,c){for(var x in c){var N,z,oe=c[x];typeof oe=="string"&&(N=u.prev.props[x],(z=oe[0])!=="+"&&z!=="-"||isNaN(oe=+oe+N)||(u.props[x]=oe))}},v.change=function(a,u,c,x,N,z){},ne.RelativePlugin=v}(),ne.DotPlugin.install(),ne.RelativePlugin.install(),window.addEventListener("DOMContentLoaded",function(){var e=document.createElement("style");e.innerHTML="canvas {-webkit-tap-highlight-color: transparent;}",document.body.appendChild(e)});window.createjs=ne;cr.exports=function(){return ne}});var Fi=bi(ei(),1);var le=window||{},$e=le.createjs,Dt=le.zns,Ct=le.zon==null?!0:le.zon,ki,Pi,dn,Hn=Ct?console.log.bind(console):function(){},er=" border:thin solid black; color: black",oi=Ct?console.log.bind(console,"%c Z ","background: #acd241;"+er):function(){},Si=Ct?console.log.bind(console,"%c Z ","background: #e472c4;"+er):function(){},Yr=Ct?console.log.bind(console,"%c Z ","background: #50c4b7;"+er):function(){},li=Ct?console.log.bind(console,"%c Z ","background: #fb4758;"+er):function(){},ht=Ct?console.log.bind(console,"%c Z ","background: #ebcb35;"+er):function(){},ui=Ct?console.log.bind(console,"%c Z ","background: #f58e25;"+er):function(){},kr=Ct?console.log.bind(console,"%c Z ","background: #eeeeee;"+er):function(){},Pr=Ct?console.log.bind(console,"%c Z ","background: #444444; border:thin solid black; color: white"):function(){};function _n(e){return qe("1"),document.getElementById(e)}function Ii(e){if(qe("2"),document.getElementById(e))return document.getElementById(e).style;Ct&&ht("zss(): id not found")}function sr(e,v,a,u,c,x){if(qe("3"),n(v)&&v!=""||v=="_self")le.location.href=e;else{var N="";return a&&(N+="width="+a+","),u&&(N+="height="+u+","),c&&(N+="fullscreen=yes,"),x&&(N+="modal=yes,alwaysRaised=yes"),le.open(e,v,N)}}function Zn(e){if(qe("4"),!n(e))return Number(String(e).replace(/[^\d.-]/g,""))}function n(e){return e==null}function Mi(e){qe("5"),!n(e)&&(e.stopImmediatePropagation&&e.stopImmediatePropagation(),le.event&&(le.event.cancelBubble=!0))}function Xr(){return qe("6"),le.zilK&&(le.removeEventListener("keydown",le.zilK),le.removeEventListener("wheel",le.zilW),le.removeEventListener("DOMMouseScroll",le.zilS)),le.zilK=function(e){e||(e=event),e.keyCode&&e.keyCode>=32&&e.keyCode<=40&&e.preventDefault()},le.zilW=function(e){e||(e=event),e.preventDefault()},le.zilS=le.zilW,le.addEventListener("keydown",le.zilK,{passive:!1}),le.addEventListener("wheel",le.zilW,{passive:!1}),le.addEventListener("DOMMouseScroll",le.zilS,{passive:!1}),[le.zilK,le.zilW,le.zilS]}function dr(e,v){qe("6.1");function a(){var u=this;this.on=function(c,x){if(!(n(e)||n(c)||n(x)))for(var N=u.tags,z=0;z<N.length;z++)N[z].addEventListener(c,x)},this.off=function(c,x){if(!(n(e)||n(c)||n(x)))for(var N=u.tags,z=0;z<N.length;z++)N[z].removeEventListener(c,x)},Object.defineProperty(u,"tags",{get:function(){return n(e)?[]:typeof e=="string"||e instanceof String?(v&&ui(e,document.querySelector(e)),v?[document.querySelector(e)]:document.querySelectorAll(e)):typeof e.innerHTML=="string"?[e]:[]},set:function(){}}),this.css=function(c,x){for(var N=u.tags,z=0;z<N.length;z++)if(arguments.length==1&&arguments[0].constructor==={}.constructor)for(var oe in c)N[z].style[oe]=c[oe];else{if(arguments.length==1)return u.tags[0].style[c];N[z].style[c]=x}},this.prop=function(c,x){if(!n(c)){for(var N=u.tags,z=[],oe=0;oe<N.length;oe++)if(n(x))if(c.constructor==={}.constructor)for(var Ee in c)N[oe][Ee]=c[Ee];else z.push(N[oe][c]);else N[oe][c]=x;if(n(x))return z}}}return new a}function pn(e){return e.length==1&&e[0]!=null&&e[0].constructor==={}.constructor}function mt(e,v,a,u){var c=Se&&(Se.ZIMONON||fi);if(pn(v)){qe("7");var x=v[0],N;for(var z in x)(N=z.match(/^(.+)gColor$/))&&(x[N[1]+"ackgroundColor"]=x[z],delete x[z]);var oe=n(a)?e.toString().split(/\n/,1)[0].match(/\((.*)\)/)[1].replace(/\s+/g,"").split(","):a.replace(/\s+/g,"").split(","),Ee=[],ke,t;for(ke=0;ke<oe.length;ke++)t=oe[ke].split("=")[0],oe[ke]=t,Ee.push(x[t]);for(ke in x)oe.indexOf(ke)<0&&Ct&&ht(e,"bad argument "+ke);var r;return(r=Object.prototype.isPrototypeOf.call(e.prototype,u)?new(e.bind.apply(e,[null].concat(Ee))):e.apply(null,Ee))?(c&&!r.arguments&&(r.arguments=[x]),r):!0}else c&&u&&v&&n(u.arguments)&&(u.arguments=Array.prototype.slice.call(v))}function dt(e){if(qe("7.5"),qe("17.6"),!n(e))return Se.Pick.choose(e)}var Oi=console.table&&Ct?console.table.bind(console):function(){},Li=function(){for(var e=0;e<arguments.length;e++)if(!n(arguments[e]))return arguments[e]},Se=function(e){e.chop=function(t,r,i,o,l,f){if(qe("7.8"),!n(t)){n(r)&&(r=3),n(i)&&(i=3),n(o)&&(o=!0),n(l)&&(l=0),n(f)&&(f=1),t.getBounds||(t=new e.Bitmap(t));var h=t.getBounds();n(h)&&ht("ZIM chop() - obj must have bounds");var p=h.width/r,_=h.height/i,b=l,w=[];return e.loop(i,function(C){e.loop(r,function(O){var P=new e.Bitmap(t,p+b*2,_+b*2,O*p-b,C*_-b,f);l!=0?(P.setBounds(b,b,p,_),P.regX=b,P.regY=b):P.setBounds(b,b,p,_),w.push(P)})}),o?new e.Tile(w,r,i,0,0,!0).sca(t.scaleX,t.scaleY):w}},e.shuffle=function(t,r){if(qe("8"),!n(t)){Array.isArray(t)||(t=Object.values(arguments));var i=t.length,o,l;if(i==0)return t;if(r){for(var f=e.copy(t);e.arraysEqual(f,t);)e.shuffle(t);return t}else{for(;--i;)o=Math.floor(Math.random()*(i+1)),l=t[i],t[i]=t[o],t[o]=l;return t}}},e.pluck=function(t,r){if(qe("9.26"),n(t)||t.length==0)return null;Array.isArray(t)||(t=Object.values(arguments));var i=Math.floor(Math.random()*t.length),o=t[i];return r&&t.splice(i,1),o},e.rand=function(t,r,i,o){if(qe("9"),n(t)&&n(r))return Math.random();(n(t)||isNaN(t))&&(t=0),(n(r)||isNaN(r))&&(r=0),(t%1!=0||r%1!=0)&&(i=!1),n(i)&&(i=!0),o&&Math.random()>.5&&(t*=-1,r*=-1),i&&(t>r?t++:r>t&&r++);var l;return t==0&&r==0?0:(r==0?l=Math.random()*t:l=Math.min(t,r)+Math.random()*(Math.max(t,r)-Math.min(t,r)),i?Math.floor(l):l)},e.seedRandom=function(t){return qe("9.01"),function(r,i,o,l,f,h,p,_,b){function w(X){var q,V=X.length,I=this,te=0,B=I.i=I.j=0,Z=I.S=[];for(V||(X=[V++]);l>te;)Z[te]=te++;for(te=0;l>te;te++)Z[te]=Z[B=E&B+X[te%V]+(q=Z[te])],Z[B]=q;(I.g=function(U){for(var ee,ae=0,re=I.i,he=I.j,j=I.S;U--;)ee=j[re=E&re+1],ae=ae*l+j[E&(j[re]=j[he=E&he+ee])+(j[he]=ee)];return I.i=re,I.j=he,ae})(l)}function C(X,q){var V,I=[],te=typeof X;if(q&&te=="object")for(V in X)try{I.push(C(X[V],q-1))}catch(B){+function(){}()}return I.length?I:te=="string"?X:X+"\0"}function O(X,q){for(var V,I=X+"",te=0;te<I.length;)q[E&te]=E&(V^=19*q[E&te])+I.charCodeAt(te++);return A(q)}function P(X){try{return R?A(R.randomBytes(l)):(r.crypto.getRandomValues(X=new Uint8Array(l)),A(X))}catch(q){return[+new Date,r,(X=r.navigator)&&X.plugins,r.screen,A(i)]}}function A(X){return String.fromCharCode.apply(0,X)}var R,T=o.pow(l,f),L=o.pow(2,h),S=2*L,E=l-1,k=o["seed"+b]=function(X,q,V){var I=[];q=q==1?{entropy:!0}:q||{};var te=O(C(q.entropy?[X,A(i)]:X==null?P():X,3),I),B=new w(I);return O(A(B.S),i),(q.pass||V||function(Z,U,ee){return ee?(o[b]=Z,U):Z})(function(){for(var Z=B.g(f),U=T,ee=0;L>Z;)Z=(Z+ee)*l,U*=l,ee=B.g(1);for(;Z>=S;)Z/=2,U/=2,ee>>>=1;return(Z+ee)/U},te,"global"in q?q.global:this==o)};if(O(o[b](),i),p&&p.exports){p.exports=k;try{R=Ci("crypto")}catch(X){}}else _&&_.amd&&_(function(){return k})}(this,[],Math,256,6,52,typeof module=="object"&&module,typeof define=="function"&&define,"random"),e.randomO||(e.randomO=Math.random),n(t)?Math.random=e.randomO:Math.seedrandom(t),t},e.odds=function(t){return qe("9.1"),(n(t)||isNaN(t))&&(t=50),Math.random()<=t/100},e.rarity=function(t,r,i,o){if(qe("9.2"),n(t)||t.constructor!={}.constructor)return[];n(r)&&(r=!0),n(i)&&(i=!0),n(o)&&(o=!1);var l=[];return e.loop(t,function(f,h){var p=e.colors.indexOf(f);p!=-1&&(f=e.colorsHex[p]);var _;Array.isArray(h)?(+f==+f?f=new Number(f):f=new String(f),f._payload=h[1],f.dynamicPayload=o,Object.defineProperty(f,"payload",{get:function(){return!this.dynamicPayload&&this._lastPayload!=null?this._lastPayload:(this._lastPayload=e.Pick.choose(this._payload),this._lastPayload)},set:function(b){this._lastPayload=null,this._payload=b}}),_=h[0],e.loop(_,function(){l.push(f)})):(_=h,e.loop(_,function(){+f==+f&&(f=+f),l.push(f)}))}),r&&e.shuffle(l),l},e.repeats=function(t,r){if(qe("9.25"),n(t)||!Array.isArray(t))return 0;var i={},o=0,l=0;return e.loop(t,function(f){i[f]!=null?(i[f]++,l++):i[f]=0,i[f]>o&&(o=i[f])}),r?l:o},e.series=function(){qe("13.61");var t,r;if(arguments.length==0)return function(){};arguments.length==1&&Array.isArray(arguments[0])?t=arguments[0]:arguments.length==1&&arguments[0].constructor=={}.constructor?(r=arguments[0],n(r.min)&&(r.min=0),n(r.max)&&(r.max=1),n(r.step)&&(r.step=1),t=[],e.loop(Math.floor(Math.abs(r.max-r.min)+r.step),function(T){t.push(T+r.min)},null,null,r.step),r=null):t=Array.prototype.slice.call(arguments);var i=0,o=1,l=1,f=0,h=0,p=!1,_=!1,b=!1,w=!1,C=!1,O,P,A=function(T,L){if(f&&h%f!=0)return h++,P;h++;var S=t.length,E;if((w||C)&&i%S==0&&e.shuffle(t),E=t[(S*10+i)%S],i==0&&(O=E),C&&i%S==0&&S>1)for(;E==P;)e.shuffle(t),E=t[(S*10+i)%S];return p?o>0&&i+o*l>=S?(o=-1,i=S-1-(i+l-(S-1))):o<0&&i+o*l<0?(o=1,i=l-i):i+=o*l:_?o>0&&i+o*l>=S?(o=-1,i=S-1-(i+l-(S-1))+l):o<0&&i+o*l<0?(o=1,i=l-i-l):i+=o*l:b?o>0&&i+o*l>=S?i=S-1:o<0&&i+o*l<0?i=0:i+=o*l:i+=o*l,P=E,e.isPick(E)?E.noPick&&L?E:e.Pick.choose(E):E},R=A.original=e.copy(t);return A.array=t,A.type="series",Object.defineProperty(A,"index",{get:function(){var T=t.length;return(T*10+i)%T},set:function(T){i=T,h=0}}),Object.defineProperty(A,"length",{get:function(){return t.length},set:function(){}}),A.jump=function(T){return i=T,A},A.reverse=function(T){return n(T)&&(T=!0),T?o=-1:o=1,i=t.length-1,A},A.bounce=function(T){n(T)&&(T=!0);var L=t.length;return i=(L*10+i)%L,p=T,A},A.flip=function(T){n(T)&&(T=!0);var L=t.length;return i=(L*10+i)%L,_=T,A},A.step=function(T){return n(T)&&(T=1),l=Math.floor(T),A},A.every=function(T){return n(T)&&(T=1),f=Math.abs(T),h=0,A},A.constrain=function(T){return n(T)&&(T=!0),b=T,A},A.random=function(T){return n(T)&&(T=!0),T||(t=R),w=T==!0,A},A.mix=function(T){return n(T)&&(T=!0),T||(t=R),C=T==!0,A},A.shuffle=function(T){return n(T)&&(T=!0),T?e.shuffle(t):t=R,A},A},e.makeSeries=function(t){if(qe("13.6"),n(t))return function(){};var r=0,i=function(){return t[r++%t.length]};return i.array=t,i},e.loop=function(t,r,i,o,l,f,h,p){var _="obj, call, reverse, interval, step, start, end, immediate",b;if(b=mt(e.loop,arguments,_))return b;if(qe("9.5"),n(t)||n(r))return;n(i)&&(i=!1),n(o)&&(o=0),(n(l)||l<=0)&&(l=1),n(p)&&(p=!0),t.constructor===Number&&(t=Number(t)),t.constructor===String&&(t=String(t));var w=typeof t=="number"?"number":t.constructor===Array?"array":t.constructor==={}.constructor?"object":typeof t=="string"?"string":t instanceof NodeList?"nodelist":t instanceof HTMLCollection?"htmlcollection":t.type&&t.type=="Dictionary"?"Dictionary":"invalid";if(w=="invalid")return;var C,O,P,A;if(w=="number"||w=="string"||w=="array"||w=="nodelist"||w=="htmlcollection"||w=="Dictionary"){if(w=="Dictionary"){var R=e.copy(t.values);t=e.copy(t.objects)}if(C=w=="number"?t:t.length,O=L(C-1),O==0)return;if(i)if(o===0){for(P=f;P>=h;P-=l)if(w=="number"?A=r(P,O,f,h,t):w=="array"||w=="string"?A=r(t[P],P,O,f,h,t):w=="Dictionary"?A=r(t[P],R[P],P,O,f,h,t):A=r(t.item(P),P,O,f,h,t),typeof A<"u"&&A!="next")return A}else e.interval(o,function(S){if(P=S.count,p||P--,l&&(P*=l),P=f-P,w=="number"?A=r(P,O,f,h,t):w=="array"||w=="string"?A=r(t[P],P,O,f,h,t):w=="Dictionary"?A=r(t[P],R[P],P,O,f,h,t):A=r(t.item(P),P,O,f,h,t),A=="next")S.next();else if(typeof A<"u")return S.clear(),A},O,p);else if(o===0){for(P=f;P<=h;P+=l)if(w=="number"?A=r(P,O,f,h,t):w=="array"||w=="string"?A=r(t[P],P,O,f,h,t):w=="Dictionary"?A=r(t[P],R[P],P,O,f,h,t):A=r(t.item(P),P,O,f,h,t),typeof A<"u"&&A!="next")return A}else e.interval(o,function(S){if(P=S.count,p||P--,l&&(P*=l),w=="number"?A=r(P,O,f,h,t,S):w=="array"||w=="string"?A=r(t[P],P,O,f,h,t,S):w=="Dictionary"?A=r(t[P],R[P],P,O,f,h,t):A=r(t.item(P),P,O,f,h,t,S),A=="next")S.next();else if(typeof A<"u")return S.clear(),A},O,p);return!0}else if(w=="object"){C=0;var T=[];for(P in t)C++,T.push(P);if(O=L(C-1),O==0)return;if(i)if(o===0){for(P=f;P>=h;P-=l)if(A=r(T[P],t[T[P]],P,O,f,h,t),typeof A<"u")return A}else e.interval(o,function(S){if(P=S.count,p||P--,l&&(P*=l),P=f-P,A=r(T[P],t[T[P]],P,O,f,h,t),A=="next")S.next();else if(typeof A<"u")return S.clear(),A},O,p);else if(o===0){for(P=f;P<=h;P+=l)if(A=r(T[P],t[T[P]],P,O,f,h,t),typeof A<"u")return A}else e.interval(o,function(S){if(P=S.count,p||P--,l&&(P*=l),A=r(T[P],t[T[P]],P,O,f,h,t),A=="next")S.next();else if(typeof A<"u")return S.clear(),A},O,p);return!0}function L(S){return n(f)&&(f=i?S:0),n(h)&&(h=i?0:S),i&&h>f||!i&&f>h||(f<0&&h)<0||f>S&&h>S?0:(f=Math.max(0,Math.min(f,S)),h=Math.max(0,Math.min(h,S)),Math.floor((i?f-h:h-f)/l)+1)}};function v(t,r,i,o,l){e.timeCheck||(qe("9.99"),e.timeCheck=!0);var f=n(le.TIME)?n(e.TIME)?"seconds":e.TIME:le.TIME;return f&&f.toLowerCase&&(f=f.toLowerCase()),f!="milliseconds"&&f!="ms"&&(f="seconds"),r&&r.toLowerCase&&(r=r.toLowerCase()),(r=="ms"||r=="milliseconds"||r=="seconds"||r=="s")&&(f=r),n(t)?f.charAt(0):(f=="ms"&&(f="milliseconds"),f=="s"&&(f="seconds"),f=f.charAt(0),l||a(t,f,i,o),f)}function a(t,r,i,o){n(i)&&(i=10),n(o)&&(o=9),!(!e.TIMECHECK&&!le.TIMECHECK)&&(r!="m"&&t>i||r=="m"&&t<o)&&Ct&&ht("TIME - warning: time is in "+(r=="m"?"milliseconds":"seconds")+" ("+t+")")}if(e.timeout=function(t,r,i,o){var l="time, call, pauseOnBlur, timeUnit",f;if(f=mt(e.timeout,arguments,l,this))return f;if(qe("9.7"),!n(r)&&typeof r=="function"){var h=e.interval(t,r,1,!1,i,o);return h.type="timeoutObj",h}},e.interval=function(t,r,i,o,l,f){var h="time, call, total, immediate, pauseOnBlur, timeUnit",p;if(p=mt(e.interval,arguments,h,this))return p;if(qe("9.8"),n(r)||typeof r!="function")return;var _=v(t,f);if(n(t)&&(t=_=="s"?1:1e3),n(o)&&(o=!1),!n(i)&&(isNaN(i)||i<=0))return;n(i)&&(i=-1);var b={count:0,total:i,paused:!1,time:t,active:!0,timeUnit:f};l&&(n(e.blurCheck)&&e.setBlurDetect(),e.pauseOnBlur.push(b));function w(){b.startTime=Date.now(),b.interval=e.Pick.choose(b.time),b.id=setTimeout(function(){b.paused||b.active&&(b.count++,r(b),w(),C())},b.interval*(_=="s"?1e3:1))}o&&setTimeout(function(){r(b),C()},10);function C(){i!=-1&&b.count>=(o?b.total-1:b.total)&&b.clear()}var O;return b.type="intervalOjbect",b.pause=function(P,A,R){n(P)&&(P=!0),P?(clearTimeout(O),clearTimeout(b.id),cancelAnimationFrame(b.rid),b.pauseTimeLeft=b.interval-(Date.now()-b.startTime)/(_=="s"?1e3:1)):(b.paused||b.pause(!0),O=setTimeout(function(){b.count++,r(b),w(),C()},A?0:(R?b.interval:b.pauseTimeLeft)*(_=="s"?1e3:1)),b.pauseTimeLeft=null),b.paused=P},b.next=function(){b.count++,r(b),C()},b.clear=function(){b.active=!1,clearTimeout(O),cancelAnimationFrame(b.rid),clearTimeout(b.id);var P=b.count;for(var A in b)delete b[A];b.active=!1,b.count=P,b.pause=function(){},b.clear=function(){}},w(),b},e.async=function(t,r,i,o,l){if(qe("29"),!n(t)){var f=document.createElement("script"),h=v(o);n(o)&&(o=h=="s"?2:2e3);var p;r?(i?p=i:p=r.toString().split(/\n/,1)[0].match(/^function\s?([^\s(]*)/)[1],e.asyncList||(e.asyncList={}),e.asyncList[p]||(e.asyncList[p]=[]),e.asyncList[p].push(r),e.async[p]=function(){var _=f,b=!1,w=setTimeout(function(){b=l,typeof r=="function"&&r("asyncError",l?"cancelled":"timeout")},o*(h=="s"?1e3:1));return function(C){clearTimeout(w),e.asyncList[p]&&(r=e.asyncList[p].shift()),typeof r=="function"&&!b&&r(C),_&&_.parentNode.removeChild(_),_=null}}()):(e.async.z_s&&e.async.z_s.parentNode&&e.async.z_s.parentNode.removeChild(e.async.z_s),e.async.z_s=f),t.match(/\?/)||(t+="?"),f.setAttribute("src",t+"&r="+Math.random()),document.getElementsByTagName("head")[0].appendChild(f)}},e.couple=function(t){if(qe("29.2"),!e.isJSON(t))return t;var r=JSON.parse(t),i={};for(var o in r){var l=r[o];for(var f in l)i[o+"_"+f]=l[f]}return JSON.stringify(i)},e.decouple=function(t){if(qe("29.3"),!e.isJSON(t))return t;var r=JSON.parse(t),i={};for(var o in r){var l=o.split("_",2);if(l.length!=2)return t;i[l[0]]||(i[l[0]]={}),i[l[0]][l[1]]=r[o]}return JSON.stringify(i)},e.convertColor=function(t,r,i){if(e.convertColorCheck||(qe("27.5"),e.convertColorCheck=!0),n(r)&&(r="hex"),n(t)||!t.toLowerCase)return;t=dt(t),t=t.toLowerCase(),r=r.toLowerCase();var o=["black","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgrey","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","grey","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgrey","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"],l=["000000","f0f8ff","faebd7","00ffff","7fffd4","f0ffff","f5f5dc","ffe4c4","ffebcd","0000ff","8a2be2","a52a2a","deb887","5f9ea0","7fff00","d2691e","ff7f50","6495ed","fff8dc","dc143c","00ffff","00008b","008b8b","b8860b","a9a9a9","a9a9a9","006400","bdb76b","8b008b","556b2f","ff8c00","9932cc","8b0000","e9967a","8fbc8f","483d8b","2f4f4f","2f4f4f","00ced1","9400d3","ff1493","00bfff","696969","696969","1e90ff","b22222","fffaf0","228b22","ff00ff","dcdcdc","f8f8ff","ffd700","daa520","808080","808080","008000","adff2f","f0fff0","ff69b4","cd5c5c","4b0082","fffff0","f0e68c","e6e6fa","fff0f5","7cfc00","fffacd","add8e6","f08080","e0ffff","fafad2","d3d3d3","d3d3d3","90ee90","ffb6c1","ffa07a","20b2aa","87cefa","778899","778899","b0c4de","ffffe0","00ff00","32cd32","faf0e6","ff00ff","800000","66cdaa","0000cd","ba55d3","9370db","3cb371","7b68ee","00fa9a","48d1cc","c71585","191970","f5fffa","ffe4e1","ffe4b5","ffdead","000080","fdf5e6","808000","6b8e23","ffa500","ff4500","da70d6","eee8aa","98fb98","afeeee","db7093","ffefd5","ffdab9","cd853f","ffc0cb","dda0dd","b0e0e6","800080","663399","ff0000","bc8f8f","4169e1","8b4513","fa8072","f4a460","2e8b57","fff5ee","a0522d","c0c0c0","87ceeb","6a5acd","708090","708090","fffafa","00ff7f","4682b4","d2b48c","008080","d8bfd8","ff6347","40e0d0","ee82ee","f5deb3","ffffff","f5f5f5","ffff00","9acd32"];if(r=="zim"){var f=e.colorsHex.indexOf(t);return f<0?t:e.colors[e.colorsHex.indexOf(t)]}r=="hsv"&&r=="hsl";var h,p;if(h=t.match(/rgba\((.*)\)/)){p=h[1].split(",");var _=p.pop();if(n(i)&&(i=_),r=="array")return p.push(_),p;if(t="rgb("+p.join(",")+")",r=="rgb")return t;if(r=="hsl")return C(p[0],p[1],p[2])}function b(S){var E=Number(S).toString(16);return E.length<2&&(E="0"+E),E}function w(S,E,k,X,q){return(q-X)*(S-E)/(k-E)+X}function C(S,E,k){S/=255,E/=255,k/=255;let X=Math.max(S,E,k),q=X-Math.min(S,E,k),V=q?X===S?(E-k)/q:X===E?2+(k-S)/q:4+(S-E)/q:0;return[60*V<0?60*V+360:60*V,100*(q?X<=.5?q/(2*X-q):q/(2-(2*X-q)):0),100*(2*X-q)/2]}function O(S){var E=S.split(","),k=b(E[0]),X=b(E[1]),q=b(E[2]),V=n(V)?"":b(Math.round(Number(E[3])*255));return[k,X,q,V]}n(i)&&(i=1);var P,A,R;if(h=t.match(/rgb\((.*)\)/))return r=="rgba"?"rgba("+h[1]+","+i+")":r=="hex"?(P=i!=1?","+i:"",A=O(h[1]+P),"#"+A[0]+A[1]+A[2]+A[3]):r=="hexnumber"?(P=i!=1?","+i:0,A=O(h[1]+P),parseInt(A[0]+""+A[1]+A[2],16)):r=="string"?(t=O(h[1]).join("").toLowerCase(),R=l.indexOf(t),R==-1?"#"+t:o[R]):r=="array"?(P=i!=1?","+i:0,O(h[1]+P)):r=="hsl"?(p=h[1].split(","),C(p[0],p[1],p[2])):t;function T(S){var E;return/^#([A-Fa-f0-9]{3}){1,2}$/.test(S)?(E=S.substring(1).split(""),E.length==3&&(E=[E[0],E[0],E[1],E[1],E[2],E[2]]),E="0x"+E.join(""),r=="rgb"?"rgb("+[E>>16&255,E>>8&255,E&255]+")":r=="array"?[E>>16&255,E>>8&255,E&255,i]:"rgba("+[E>>16&255,E>>8&255,E&255].join(",")+","+i+")"):/^#([A-Fa-f0-9]{4}){1,2}$/.test(S)?(E=S.substring(1).split(""),E.length==8&&(i=E.slice(-2).join(""),E=E.slice(0,6)),E.length==4&&(i=E[3]+""+E[3],E=[E[0],E[0],E[1],E[1],E[2],E[2]]),i=parseInt(i,16)/255,E="0x"+E.join(""),r=="rgb"?"rgb("+[E>>16&255,E>>8&255,E&255]+")":"rgba("+[E>>16&255,E>>8&255,E&255].join(",")+","+i+")"):r=="rgb"?"rgb(0,0,0)":"rgba(0,0,0,1)"}if(r=="hsl")return e.convertColor(e.convertColor(t,"rgb"),"hsl");if(r=="array"||r=="rgb"||r=="rgba")return t.charAt(0)=="#"?T(t):T(e.convertColor(t));if(r=="hex"){if(t.charAt(0)=="#")if(i!=1)if(P=b(Math.round(i*255)),t.length==4||t.length==5){var L=t.split("");return L[1]=L[1]+""+L[1],L[2]=L[2]+""+L[2],L[3]=L[3]+""+L[3],L[4]=P,L.join("")}else return t.length==9?t.substring(0,o.length-2)+P:t+P;else return t}else if(r=="hexnumber"){if(t.charAt(0)=="#")return parseInt(t.replace(/^#/,""),16)}else t.charAt(0)=="#"&&(t=t.replace("#",""),t.length==3&&(t=t.charAt(0)+t.charAt(0)+t.charAt(1)+t.charAt(1)+t.charAt(2)+t.charAt(2)));return r=="string"?(R=l.indexOf(t),R==-1?"#"+t:o[R]):r=="hexnumber"?parseInt(l[o.indexOf(t.toLowerCase())!=-1?o.indexOf(t):0],16):(P=i!=1?b(Math.round(i*255)):"","#"+l[o.indexOf(t.toLowerCase())!=-1?o.indexOf(t):0]+P)},e.colorRange=function(t,r,i){e.colorRangeCheck||(qe("27.6"),e.colorRangeCheck=!0),n(i)&&(i=.5),i=Math.max(0,Math.min(1,i)),n(t)&&(t="white"),n(r)&&(r="black");var o=t,l=r,f=e.convertColor(t,"rgb"),h=e.convertColor(r,"rgb");t=f.substring(4,f.length-1).split(","),r=h.substring(4,h.length-1).split(",");var p,_="#",b;if(i==0)_=o;else if(i==1)_=l;else for(var w=0;w<t.length;w++)p=r[w]-t[w],b=Math.floor(parseInt(t[w],10)+p*i).toString(16),b.length<2&&(b="0"+b),_+=b;return _},e.lighten=function(t,r){return e.lightenCheck||(qe("27.65"),e.lightenCheck=!0),n(r)&&(r=.5),r>=0?e.colorRange(String(t),"#FFFFFF",r):e.colorRange(String(t),"#000000",-r)},e.darken=function(t,r){return n(r)&&(r=.5),e.darkenCheck||(qe("27.66"),e.darkenCheck=!0),r>=0?e.colorRange(String(t),"#000000",r):e.colorRange(String(t),"#ffffff",-r)},e.toColor=function(t,r,i){return e.toColorCheck||(qe("27.67"),e.toColorCheck=!0),n(i)&&(i=.5),e.colorRange(String(t),r,i)},e.toAlpha=function(t,r){return e.toAlphaCheck||(qe("27.68"),e.toAlphaCheck=!0),n(r)&&(r=.5),e.convertColor(String(t),"rgba",r)},e.toBW=function(t){if(t.indexOf("#")===0&&(t=t.slice(1)),t.length===3&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),t.length!==6)return ht("ZIM toBW() - needs hex input"),t;var r=parseInt(t.slice(0,2),16),i=parseInt(t.slice(2,4),16),o=parseInt(t.slice(4,6),16);return r*.299+i*.587+o*.114>186?"#000000":"#FFFFFF"},e.invertColor=function(t){if(e.invertColorCheck||(qe("27.86"),e.invertColorCheck=!0),t.indexOf("#")===0&&(t=t.slice(1)),t.length===3&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),t.length!==6)return ht("ZIM invertColor() - needs hex input"),t;var r=parseInt(t.slice(0,2),16),i=parseInt(t.slice(2,4),16),o=parseInt(t.slice(4,6),16);r=(255-r).toString(16),i=(255-i).toString(16),o=(255-o).toString(16);function l(f,h){h=h||2;var p=new Array(h).join("0");return(p+f).slice(-h)}return"#"+l(r)+l(i)+l(o)},e.zimEase=function(t,r,i,o,l){qe("27.69");var f=!1;n(l)&&(l=!0);var h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V;if(t){if(Array.isArray(t[1])){f=!0,V=t[1],t=t[0];var I=0,te=V[0],B=V[1],Z=V[2],U=V[3],ee=1,ae=5*(te-I),re=10*(B-I)-4*ae,he=10*(Z-I)+30*(te-B),j=5*(U+I)-20*(Z+te)+30*B,G=ee-I-j-he-re-ae}h=0,p=t[0],_=t[1],b=t[2],w=t[3],C=1,O=5*(p-h),P=10*(_-h)-4*O,A=10*(b-h)+30*(p-_),R=5*(w+h)-20*(b+p)+30*_,T=C-h-R-A-P-O}else r?(T=r[0],R=r[1],A=r[2],P=r[3],O=r[4],p=O/5,_=(P+4*O)/10,b=(A+6*O+3*P)/10,w=(R+4*O+3*P+2*A)/5):(T=0,R=0,A=0,P=0,O=1);return i?(X=function(){return e.zimEase(null,[T,R,A,P,O],!0)},q={reverse:X,points:[p,_,b,w],polynomials:[T,R,A,P,O]},q.noPick=function(y){if(l){if(y<.025)return 0;if(y>.975)return 1}return y<.5?(y*=2,L=y*100,S=100,E=(L/=S)*L,k=E*L,(T*k*E+R*E*E+A*k+P*E+O*L)/2):(y=1-(y-.5)*2,L=y*100,S=100,E=(L/=S)*L,k=E*L,1-(T*k*E+R*E*E+A*k+P*E+O*L)/2)}):f?(X=function(){return Ct&&ht("zimEase - multi array points cannot be reversed"),e.zimEase(null,[T,R,A,P,O])},q={reverse:X,points:[[p,_,b,w],[te,B,Z,U]],polynomials:[[T,R,A,P,O],[G,j,he,re,ae]]},q.noPick=function(y){if(l){if(y<.025)return 0;if(y>.975)return 1}return y<.5?(y*=2,L=y*100,S=100,E=(L/=S)*L,k=E*L,(T*k*E+R*E*E+A*k+P*E+O*L)/2):(y=(y-.5)*2,L=y*100,S=100,E=(L/=S)*L,k=E*L,.5+(G*k*E+j*E*E+he*k+re*E+ae*L)/2)}):(X=function(){return e.zimEase(null,[T,R,A,P,O],null,!0)},q={reverse:X,points:[p,_,b,w],polynomials:[T,R,A,P,O]},o?q.noPick=function(y){if(l){if(y<.025)return 0;if(y>.975)return 1}return L=100-y*100,S=100,E=(L/=S)*L,k=E*L,1-(T*k*E+R*E*E+A*k+P*E+O*L)}:q.noPick=function(y){if(l){if(y<.025)return 0;if(y>.975)return 1}return L=y*100,S=100,E=(L/=S)*L,k=E*L,T*k*E+R*E*E+A*k+P*E+O*L}),q.noPick.reverse=X,q},e.spline=function(t,r,i,o,l){qe("27.695"),n(t)&&(t=[]),n(r)&&(r=1),n(i)&&(i=!1),n(l)&&(l=i);var f;function h(U,ee){if(!Array.isArray(U[0]))for(f=0;f<U.length;f++)U[f]=[U[f].x,U[f].y];if(ee){var ae=U[U.length-1],re=U[U.length-2],he=U[0],j=U[1];U.unshift(ae),U.unshift(re),U.push(he),U.push(j)}var G=[];for(f=0;f<U.length;f++)G.push(U[f][0],U[f][1]);return G}t=h(t,i);var p=t.length,_=p-4,b=i?t[2]:t[0],w=i?t[3]:t[1],C="M"+[b,w];o&&o.mt(b,w);var O=i?2:0,P=i?p-4:p-2,A=2;for(f=O;f<P;f+=A){var R=f?t[f-2]:t[0],T=f?t[f-1]:t[1],L=t[f+0],S=t[f+1],E=t[f+2],k=t[f+3],X=f!==_?t[f+4]:E,q=f!==_?t[f+5]:k,V=L+(E-R)/6*r,I=S+(k-T)/6*r,te=E-(X-L)/6*r,B=k-(q-S)/6*r;C+="C"+[V,I,te,B,E,k],o&&o.bt(V,I,te,B,E,k)}if(l){var Z=C.split("C");Z.pop(),C=Z.join("C")}return C},e.pointAlongCurve=function(t,r,i,o){if(qe("27.7"),!(!t||!t[0]||!t[1]||!t[2]||!t[3])){n(o)&&(o=!1);var l=new e.Bezier(t[0],t[1],t[2],t[3]),f,h,p,_,b,w;if(o?(f=l.mx(r),h=l.my(r)):(f=l.x(r),h=l.y(r)),i){var C=r-.05,O=r+.05;C<0&&(C=0),O>1&&(O=1),o?(p=l.mx(C),_=l.my(C),b=l.mx(O),w=l.my(O)):(p=l.x(C),_=l.y(C),b=l.x(O),w=l.y(O));var P=e.angle(p,_,b,w);return{x:f,y:h,angle:P}}return{x:f,y:h}}},e.distanceAlongCurve=function(t){qe("27.8");var r=e.dist(t[0],t[3]),i=e.dist(t[0],t[1])+e.dist(t[1],t[2])+e.dist(t[2],t[3]);return(r+i)/2},e.closestPointAlongCurve=function(t,r,i,o,l){qe("27.9");var f=1e7,h,p=0,_=0;return n(i)&&(i=10),e.loop(r,function(b,w){var C=new e.Bezier(b[0],b[1],b[2],b[3]);e.loop(i,function(O,P){var A={x:C.x(O/P),y:C.y(O/P)},R=e.dist(t,A);R<f&&(f=R,h=A,p=w,_=O)})}),l?(p*i+_)/(r.length*i)*100:o?h:p},e.transformPoints=function(t,r,i,o,l){if(qe("27.95"),!(n(t)||!Array.isArray(t))){n(o)&&(o=0),n(l)&&(l=0),t=e.copy(t);var f=o,h=l;r=="rotation"&&(o!=0&&(t=e.transformPoints(t,"x",-f)),l!=0&&(t=e.transformPoints(t,"y",-h)));for(var p,_=0;_<t.length;_++)if(p=t[_],!!Array.isArray(p)){if(r=="x")p[0]+=i;else if(r=="y")p[1]+=i;else if(r=="scaleX")p[0]=(p[0]-o)*i+o,p[4]=p[4]*i,p[6]=p[6]*i;else if(r=="scaleY")p[1]=(p[1]-l)*i+l,p[5]=p[5]*i,p[7]=p[7]*i;else if(r=="scale")p[0]=(p[0]-o)*i+o,p[4]=p[4]*i,p[6]=p[6]*i,p[1]=(p[1]-l)*i+l,p[5]=p[5]*i,p[7]=p[7]*i;else if(r=="rotation"){var b=i*Math.PI/180,w=p[0],C=p[1];p[0]=w*Math.cos(b)-C*Math.sin(b),p[1]=C*Math.cos(b)+w*Math.sin(b),w=p[4],C=p[5],p[4]=w*Math.cos(b)-C*Math.sin(b),p[5]=C*Math.cos(b)+w*Math.sin(b),w=p[6],C=p[7],p[6]=w*Math.cos(b)-C*Math.sin(b),p[7]=C*Math.cos(b)+w*Math.sin(b)}}return r=="rotation"&&(o!=0&&(t=e.transformPoints(t,"x",f)),l!=0&&(t=e.transformPoints(t,"y",h))),t}},e.trimPointEnds=function(t){qe("27.97"),t[0][4]=0,t[0][5]=0,t[0][8]="free",t[t.length-1][6]=0,t[t.length-1][7]=0,t[t.length-1][8]="free"},e.reversePoints=function(t){return qe("27.975"),t.reverse(),e.loop(t,function(r){var i=r[6];r[6]=r[4],r[4]=i;var o=r[7];r[7]=r[5],r[5]=o}),t},e.appendPoints=function(t,r,i){return qe("27.98"),n(t)&&n(r)?[]:n(t)?r:(n(r)||(t[t.length-1][6]=r[0][6],t[t.length-1][7]=r[0][7],i&&(t[t.length-1][8]=i),r.shift(),t=t.concat(r)),t)},e.prependPoints=function(t,r,i){return qe("27.985"),n(t)&&n(r)?[]:n(t)?r:(n(r)||(r[r.length-1][6]=t[0][6],r[r.length-1][7]=t[0][7],i&&(t[t.length-1][8]=i),t.shift(),t=r.concat(t)),t)},e.splitPoints=function(t,r,i){if(qe("27.99"),!n(t)&&(n(r)&&(r=Math.floor(t.length/2)),!(r<0||r>t.length-1))){n(i)&&(i=!0);var o=e.copy(t.slice(0,r+1)),l=e.copy(t.slice(r));return i&&(e.trimPointEnds(o),e.trimPointEnds(l)),[o,l]}},e.makeID=function(t,r,i){qe("13.5"),n(t)&&(t="mixed"),n(r)&&(r=5),n(i)&&(i="uppercase");var o,l=[2,3,4,5,6,7,8,9],f="abcdefghjkmnpqrstuvwxyz".split("");t.constructor===Array?o=t:t=="numbers"?o=l:t=="letters"?o=f:o=l.concat(f);for(var h="",p,_,b=0;b<r;b++)p=o[Math.floor(Math.random()*o.length)],_=Math.random(),i=="uppercase"||i=="mixed"&&_>.5?p.toUpperCase&&(p=p.toUpperCase()):p.toLowerCase&&(p=p.toLowerCase()),h+=String(p);return h},e.makeSyllable=function(t,r){qe("13.55");var i="bcdfghjklmnprstvwxz",o="aeiouaeiouaeiouy";n(t)&&(t=3),n(r)&&(r=e.rand()<.3);function l(p){var _=e.rand(p.length-1),b=p.substring(_,_+1);return b}var f="",h=r?o:i;return e.loop(t,function(){f+=l(h),h=h==o?i:o}),f},e.makePrimitive=function(t){qe("13.56");function r(i){return Array.isArray(i)?(e.loop(i,function(o){o=r(o)}),i):i.constructor==={}.constructor?(e.loop(i,function(o,l){i[o]=r(l)}),i):i instanceof String?String(i):i instanceof Number?Number(i):i instanceof Boolean?!!i:i}return r(t)},e.makeMath=function(){qe("13.565");for(var t=Object.getOwnPropertyNames(Math),r=0;r<t.length;r++)le[t[r]]=Math[t[r]]},e.swapProperties=function(t,r,i){if(qe("17.1"),n(r)||n(i)||n(r[t])||n(i[t]))return!1;var o=i[t];return i[t]=r[t],r[t]=o,!0},e.mobile=function(t){return qe("28"),!n(le.MOBILE)&&le.MOBILE!="default"?le.MOBILE:!n(e.MOBILE)&&e.MOBILE!="default"?e.MOBILE:(n(t)&&(t=!0),/ip(hone|od|ad)/i.test(navigator.userAgent)?"ios":/android|nexus/i.test(navigator.userAgent)?"android":/blackberry/i.test(navigator.userAgent)?"blackberry":/nokia|phone|mobile/i.test(navigator.userAgent)?"windows":/opera mini|webos/i.test(navigator.userAgent)?"other":t&&le.orientation!==void 0?/safari/i.test(navigator.userAgent)?"ios":!0:!1)},e.vee=function(t){return qe("28.5"),!n(t)&&(t.type=="Pick"||Array.isArray(t)||t.constructor=={}.constructor&&(!n(t.max)||!n(t.noPick))||typeof t=="function")},e.extend=function(t,r,i,o,l){var f="subclass, superclass, override, prefix, prototype",h;if(h=mt(e.extend,arguments,f))return h;if(n(t)||n(r)){Ct&&t!=e.StageGL&&ht("zim.extend() - please supply a class and its superclass");return}n(o)&&(o="super"),n(i)&&(i=[]),Array.isArray(i)||(i=[i]),n(l)&&(l=!0);var p={};for(var _ in t.prototype)Object.defineProperty(p,_,Object.getOwnPropertyDescriptor(t.prototype,_));function b(){this.constructor=t}b.prototype=r.prototype,t.prototype=new b;for(_ in p)Object.defineProperty(t.prototype,_,Object.getOwnPropertyDescriptor(p,_));var w=t.prototype,C=Object.getPrototypeOf&&Object.getPrototypeOf(w)||w.__proto__;if(C){w[(o+="_")+"constructor"]=C.constructor;for(var O,P=0;P<i.length;P++)O=i[P],typeof C[O]=="function"&&(w[o+O]=C[O]);if(l)for(O in C)Object.prototype.hasOwnProperty.call(w,O)&&typeof C[O]=="function"&&(w[o+O]=C[O])}return t},e.copy=function(t,r,i){if(e.copyCheck||(qe("10"),e.copyCheck=!0),n(r)&&(r=!1),n(i)&&(i=!0),t==null||!(t instanceof Array||t.constructor=={}.constructor))return r&&t!=null&&t.clone&&t.type&&(t.type!="Container"&&t.type!="Stage"&&t.type!="StageGL"||i)?t.clone():t;if(t instanceof Array){for(var o=[],l=0;l<t.length;l++)o[l]=e.copy(t[l],r,i);return o}if(t.constructor=={}.constructor){var f={};for(var h in t){var p=e.copy(t[h],r,i);Object.prototype.hasOwnProperty.call(t,h)&&(f[h]=p)}return f}},e.merge=function(){e.mergeCheck||(qe("12"),e.mergeCheck=!0);var t={},r,i;for(r=0;r<arguments.length;r++)for(i in arguments[r])Object.prototype.hasOwnProperty.call(arguments[r],i)&&(t[i]=arguments[r][i]);return t},e.sortObject=function(t,r,i){qe("12.1");var o=function(p){return p[r]},l=Object.entries(t).sort(function(p,_){return i?o(p[1])<o(_[1])?1:o(p[1])>o(_[1])?-1:0:o(p[1])>o(_[1])?1:o(p[1])<o(_[1])?-1:0}),f=new Map(l),h={};return f.forEach((p,_)=>{h[_]=p}),h},e.arraysEqual=function(t,r,i){if(qe("11"),n(t)||n(r)||(n(i)&&(i=!0),t.length!=r.length))return!1;for(var o=0;o<t.length;o++)if(t[o]instanceof Array&&r[o]instanceof Array){if(!e.arraysEqual(t[o],r[o],i))return!1}else{if(i&&t[o]!=r[o])return!1;if(!i)return e.arraysEqual(t.sort(),r.sort(),!0)}return!0},e.arrayMinMax=function(t){if(qe("11.2"),!Array.isArray(t))return{min:null,max:null};for(var r=t[0],i=t[0],o=t.length;o--;)r=t[o]<r?t[o]:r,i=t[o]>i?t[o]:i;return r=isNaN(r)?null:r,i=isNaN(i)?null:i,{min:r,max:i}},e.isEmpty=function(t){if(e.zimEmptyCheck||(qe("11.5"),e.zimEmptyCheck=!0),!n(t)){var r=0;for(var i in t){r++;break}return r==0}},e.isJSON=function(t){if(qe("11.6"),typeof t!="string")return!1;try{return JSON.parse(t),!0}catch(r){return!1}},e.isPick=function(t){if(e.zimPickCheck||(qe("11.7"),e.zimPickCheck=!0),!n(t))return Array.isArray(t)||t.constructor=={}.constructor&&(t.min!=null&&t.max!=null||t.noPick)||t.constructor===Function&&(t.array!=null||t()!=null)},e.zut=function(t){if(n(t)||typeof t=="object")return!0},e.decimals=function(t,r,i,o,l,f,h){if(e.zimDecimalCheck||(qe("13"),e.zimDecimalCheck=!0),n(t))return 0;n(r)&&(r=1),n(i)&&(i=0),n(o)&&(o=1),n(l)&&(l=!0),n(f)&&(f=!1);var p=Math.round(t*Math.pow(10,r))/Math.pow(10,r);if(f){var _=p-Math.floor(p);p=e.decimals(Math.floor(p)+_*60/100,2)}var b=e.sign(p),w,C,O;if(i>0)for(w=String(p).indexOf("."),C=String(p).length,w<0&&(w=C++,p+="."),O=0;O<i-(C-w-1);O++)p+="0";if(o>1){b==-1&&(p=p.substr(1,p.length-1)),w=String(p).indexOf("."),C=String(p).length;var P=w<0?C:w;for(O=0;O<o-P;O++)p="0"+p;b==-1&&(p="-"+p)}return o==0&&(p=p.toString().replace(/^0\./,".")),i+o>0&&!l&&Number(p)==0&&(p=0),f&&(p=String(p).replace(".",":")),e.zut(h)?p:null},e.countDecimals=function(t){return e.zimCountDecimalsCheck||(qe("13.05"),e.zimCountDecimalsCheck=!0),t%1?t.toString().split(".")[1].length:0},e.sign=function(t){return e.zimSignCheck||(qe("13.1"),e.zimSignCheck=!0),t?t<0?-1:1:0},e.constrain=function(t,r,i,o){if(qe("13.2"),!n(t)){if(n(r)&&(r=0),n(i)&&(i=Number.MAX_VALUE),i<r){var l=r;i=r,r=l}return n(o)&&(o=!1),o&&t<0?Math.max(-i,Math.min(t,-r)):Math.max(r,Math.min(t,i))}},e.dist=function(t,r,i,o){if(e.zimDistCheck||(qe("13.3"),e.zimDistCheck=!0),!(n(t)||n(r)))return!n(t.x)&&!n(r.x)?(o=r.y,i=r.x,r=t.y,t=t.x):(n(i)&&(i=0),n(o)&&(o=0)),Math.sqrt(Math.pow(i-t,2)+Math.pow(o-r,2))},e.rectIntersect=function(t,r,i){return e.zimRectIntersectCheck||(qe("13.32"),e.zimRectIntersectCheck=!0),n(i)&&(i=0),!(t.x>=r.x+r.width+i||t.x+t.width+i<=r.x||t.y>=r.y+r.height+i||t.y+t.height+i<=r.y)},e.boundsAroundPoints=function(t){e.zimBoundsAroundPointsCheck||(qe("13.34"),e.zimBoundsAroundPointsCheck=!0);for(var r=1e4,i=1e4,o=-1e4,l=-1e4,f=0;f<t.length;f++){var h=t[f];h.x<r&&(r=h.x),h.x>o&&(o=h.x),h.y<i&&(i=h.y),h.y>l&&(l=h.y)}return{x:r,y:i,width:o-r,height:l-i}},e.angle=function(t,r,i,o){if(e.angleCheck||(qe("13.4"),e.angleCheck=!0),!(n(t)||n(r)))return n(i)&&(i=t,t=0),n(o)&&(o=r,r=0),(Math.atan2(o-r,i-t)*180/Math.PI+360)%360},e.TAU=Math.PI*2,e.DEG=180/Math.PI,e.RAD=Math.PI/180,e.PHI=Math.pow(5,.5)*.5+.5,e.smoothStep=function(t,r,i){qe("13.7");var o=e.constrain((t-r)/(i-r),0,1);return o*o*o*(o*(o*6-15)+10)},e.unicodeToUTF=function(t){if(qe("13.75"),!!t){t!=" "&&(t=t.replace(/^\s+/g,""));var r,i="",o="";return r=t.charCodeAt(0),i=r,o=t.charCodeAt(1),o>=56320&&o<=57343&&(r=(i-55296)*1024+(o-56320)+65536),i=i.toString(16),o=o.toString(16),r=r.toString(16),"\\u"+i+"\\u"+o}},e.capitalizeFirst=function(t){return qe("13.78"),t.charAt(0).toUpperCase()+t.slice(1)},e.Ajax=function(t,r,i,o){qe("13.8");var l=new XMLHttpRequest;this.master=t,this.couple=r,this.lock=i,this.unique=o;var f=this;this.get=function(h,p){var _=n(f.master)?"":"&master="+encodeURI(t),b=n(f.lock)?"":"&lock="+encodeURI(i),w=f.unique?"&unique=true":"";l.open("GET",h+_+b+w,!0),l.onload=function(){l.status==200?p(e.isJSON(l.responseText)?JSON.parse(l.responseText):l.responseText):p(null,"Error: "+l.status)},l.send()},this.post=function(h,p,_,b,w){var C="url, data, command, extra, callback",O;if(O=mt(f.post,arguments,C))return O;if(!n(h)){l.open("POST",h,!0),l.setRequestHeader("Content-type","application/x-www-form-urlencoded"),l.onload=function(){var L=l.responseText;e.isJSON(L)&&(f.couple&&(L=e.decouple(L)),L=JSON.parse(L)),w(L)},e.isJSON(p)||(p=JSON.stringify(p)),f.couple&&(p=e.couple(p));var P=n(f.master)?"":"&master="+encodeURIComponent(f.master),A=n(f.lock)?"":"&lock="+encodeURIComponent(f.lock),R=n(_)?"":"&command="+encodeURIComponent(_),T=n(b)?"":"&extra="+encodeURIComponent(b);l.send("data="+encodeURIComponent(p)+P+A+R+T)}},this.put=function(h,p,_){l.open("PUT",h,!0),l.setRequestHeader("Content-type","application/json"),l.onload=function(){_(e.isJSON(l.responseText)?JSON.parse(l.responseText):f.http.responseText)},l.send(JSON.stringify(p))}},e.Noise=function(t){"use strict";qe("13.9"),n(t)&&(t=Math.random()*1e6);var r=t;this.seed=t;var i=this,o={};o.NORM_2D=1/47,o.NORM_3D=1/103,o.NORM_4D=1/30,o.SQUISH_2D=(Math.sqrt(2+1)-1)/2,o.SQUISH_3D=(Math.sqrt(3+1)-1)/3,o.SQUISH_4D=(Math.sqrt(4+1)-1)/4,o.STRETCH_2D=(1/Math.sqrt(2+1)-1)/2,o.STRETCH_3D=(1/Math.sqrt(3+1)-1)/3,o.STRETCH_4D=(1/Math.sqrt(4+1)-1)/4,o.base2D=[[1,1,0,1,0,1,0,0,0],[1,1,0,1,0,1,2,1,1]],o.base3D=[[0,0,0,0,1,1,0,0,1,0,1,0,1,0,0,1],[2,1,1,0,2,1,0,1,2,0,1,1,3,1,1,1],[1,1,0,0,1,0,1,0,1,0,0,1,2,1,1,0,2,1,0,1,2,0,1,1]],o.base4D=[[0,0,0,0,0,1,1,0,0,0,1,0,1,0,0,1,0,0,1,0,1,0,0,0,1],[3,1,1,1,0,3,1,1,0,1,3,1,0,1,1,3,0,1,1,1,4,1,1,1,1],[1,1,0,0,0,1,0,1,0,0,1,0,0,1,0,1,0,0,0,1,2,1,1,0,0,2,1,0,1,0,2,1,0,0,1,2,0,1,1,0,2,0,1,0,1,2,0,0,1,1],[3,1,1,1,0,3,1,1,0,1,3,1,0,1,1,3,0,1,1,1,2,1,1,0,0,2,1,0,1,0,2,1,0,0,1,2,0,1,1,0,2,0,1,0,1,2,0,0,1,1]],o.gradients2D=[5,2,2,5,-5,2,-2,5,5,-2,2,-5,-5,-2,-2,-5],o.gradients3D=[-11,4,4,-4,11,4,-4,4,11,11,4,4,4,11,4,4,4,11,-11,-4,4,-4,-11,4,-4,-4,11,11,-4,4,4,-11,4,4,-4,11,-11,4,-4,-4,11,-4,-4,4,-11,11,4,-4,4,11,-4,4,4,-11,-11,-4,-4,-4,-11,-4,-4,-4,-11,11,-4,-4,4,-11,-4,4,-4,-11],o.gradients4D=[3,1,1,1,1,3,1,1,1,1,3,1,1,1,1,3,-3,1,1,1,-1,3,1,1,-1,1,3,1,-1,1,1,3,3,-1,1,1,1,-3,1,1,1,-1,3,1,1,-1,1,3,-3,-1,1,1,-1,-3,1,1,-1,-1,3,1,-1,-1,1,3,3,1,-1,1,1,3,-1,1,1,1,-3,1,1,1,-1,3,-3,1,-1,1,-1,3,-1,1,-1,1,-3,1,-1,1,-1,3,3,-1,-1,1,1,-3,-1,1,1,-1,-3,1,1,-1,-1,3,-3,-1,-1,1,-1,-3,-1,1,-1,-1,-3,1,-1,-1,-1,3,3,1,1,-1,1,3,1,-1,1,1,3,-1,1,1,1,-3,-3,1,1,-1,-1,3,1,-1,-1,1,3,-1,-1,1,1,-3,3,-1,1,-1,1,-3,1,-1,1,-1,3,-1,1,-1,1,-3,-3,-1,1,-1,-1,-3,1,-1,-1,-1,3,-1,-1,-1,1,-3,3,1,-1,-1,1,3,-1,-1,1,1,-3,-1,1,1,-1,-3,-3,1,-1,-1,-1,3,-1,-1,-1,1,-3,-1,-1,1,-1,-3,3,-1,-1,-1,1,-3,-1,-1,1,-1,-3,-1,1,-1,-1,-3,-3,-1,-1,-1,-1,-3,-1,-1,-1,-1,-3,-1,-1,-1,-1,-3],o.lookupPairs2D=[0,1,1,0,4,1,17,0,20,2,21,2,22,5,23,5,26,4,39,3,42,4,43,3],o.lookupPairs3D=[0,2,1,1,2,2,5,1,6,0,7,0,32,2,34,2,129,1,133,1,160,5,161,5,518,0,519,0,546,4,550,4,645,3,647,3,672,5,673,5,674,4,677,3,678,4,679,3,680,13,681,13,682,12,685,14,686,12,687,14,712,20,714,18,809,21,813,23,840,20,841,21,1198,19,1199,22,1226,18,1230,19,1325,23,1327,22,1352,15,1353,17,1354,15,1357,17,1358,16,1359,16,1360,11,1361,10,1362,11,1365,10,1366,9,1367,9,1392,11,1394,11,1489,10,1493,10,1520,8,1521,8,1878,9,1879,9,1906,7,1910,7,2005,6,2007,6,2032,8,2033,8,2034,7,2037,6,2038,7,2039,6],o.lookupPairs4D=[0,3,1,2,2,3,5,2,6,1,7,1,8,3,9,2,10,3,13,2,16,3,18,3,22,1,23,1,24,3,26,3,33,2,37,2,38,1,39,1,41,2,45,2,54,1,55,1,56,0,57,0,58,0,59,0,60,0,61,0,62,0,63,0,256,3,258,3,264,3,266,3,272,3,274,3,280,3,282,3,2049,2,2053,2,2057,2,2061,2,2081,2,2085,2,2089,2,2093,2,2304,9,2305,9,2312,9,2313,9,16390,1,16391,1,16406,1,16407,1,16422,1,16423,1,16438,1,16439,1,16642,8,16646,8,16658,8,16662,8,18437,6,18439,6,18469,6,18471,6,18688,9,18689,9,18690,8,18693,6,18694,8,18695,6,18696,9,18697,9,18706,8,18710,8,18725,6,18727,6,131128,0,131129,0,131130,0,131131,0,131132,0,131133,0,131134,0,131135,0,131352,7,131354,7,131384,7,131386,7,133161,5,133165,5,133177,5,133181,5,133376,9,133377,9,133384,9,133385,9,133400,7,133402,7,133417,5,133421,5,133432,7,133433,5,133434,7,133437,5,147510,4,147511,4,147518,4,147519,4,147714,8,147718,8,147730,8,147734,8,147736,7,147738,7,147766,4,147767,4,147768,7,147770,7,147774,4,147775,4,149509,6,149511,6,149541,6,149543,6,149545,5,149549,5,149558,4,149559,4,149561,5,149565,5,149566,4,149567,4,149760,9,149761,9,149762,8,149765,6,149766,8,149767,6,149768,9,149769,9,149778,8,149782,8,149784,7,149786,7,149797,6,149799,6,149801,5,149805,5,149814,4,149815,4,149816,7,149817,5,149818,7,149821,5,149822,4,149823,4,149824,37,149825,37,149826,36,149829,34,149830,36,149831,34,149832,37,149833,37,149842,36,149846,36,149848,35,149850,35,149861,34,149863,34,149865,33,149869,33,149878,32,149879,32,149880,35,149881,33,149882,35,149885,33,149886,32,149887,32,150080,49,150082,48,150088,49,150098,48,150104,47,150106,47,151873,46,151877,45,151881,46,151909,45,151913,44,151917,44,152128,49,152129,46,152136,49,152137,46,166214,43,166215,42,166230,43,166247,42,166262,41,166263,41,166466,48,166470,43,166482,48,166486,43,168261,45,168263,42,168293,45,168295,42,168512,31,168513,28,168514,31,168517,28,168518,25,168519,25,280952,40,280953,39,280954,40,280957,39,280958,38,280959,38,281176,47,281178,47,281208,40,281210,40,282985,44,282989,44,283001,39,283005,39,283208,30,283209,27,283224,30,283241,27,283256,22,283257,22,297334,41,297335,41,297342,38,297343,38,297554,29,297558,24,297562,29,297590,24,297594,21,297598,21,299365,26,299367,23,299373,26,299383,23,299389,20,299391,20,299584,31,299585,28,299586,31,299589,28,299590,25,299591,25,299592,30,299593,27,299602,29,299606,24,299608,30,299610,29,299621,26,299623,23,299625,27,299629,26,299638,24,299639,23,299640,22,299641,22,299642,21,299645,20,299646,21,299647,20,299648,61,299649,60,299650,61,299653,60,299654,59,299655,59,299656,58,299657,57,299666,55,299670,54,299672,58,299674,55,299685,52,299687,51,299689,57,299693,52,299702,54,299703,51,299704,56,299705,56,299706,53,299709,50,299710,53,299711,50,299904,61,299906,61,299912,58,299922,55,299928,58,299930,55,301697,60,301701,60,301705,57,301733,52,301737,57,301741,52,301952,79,301953,79,301960,76,301961,76,316038,59,316039,59,316054,54,316071,51,316086,54,316087,51,316290,78,316294,78,316306,73,316310,73,318085,77,318087,77,318117,70,318119,70,318336,79,318337,79,318338,78,318341,77,318342,78,318343,77,430776,56,430777,56,430778,53,430781,50,430782,53,430783,50,431e3,75,431002,72,431032,75,431034,72,432809,74,432813,69,432825,74,432829,69,433032,76,433033,76,433048,75,433065,74,433080,75,433081,74,447158,71,447159,68,447166,71,447167,68,447378,73,447382,73,447386,72,447414,71,447418,72,447422,71,449189,70,449191,70,449197,69,449207,68,449213,69,449215,68,449408,67,449409,67,449410,66,449413,64,449414,66,449415,64,449416,67,449417,67,449426,66,449430,66,449432,65,449434,65,449445,64,449447,64,449449,63,449453,63,449462,62,449463,62,449464,65,449465,63,449466,65,449469,63,449470,62,449471,62,449472,19,449473,19,449474,18,449477,16,449478,18,449479,16,449480,19,449481,19,449490,18,449494,18,449496,17,449498,17,449509,16,449511,16,449513,15,449517,15,449526,14,449527,14,449528,17,449529,15,449530,17,449533,15,449534,14,449535,14,449728,19,449729,19,449730,18,449734,18,449736,19,449737,19,449746,18,449750,18,449752,17,449754,17,449784,17,449786,17,451520,19,451521,19,451525,16,451527,16,451528,19,451529,19,451557,16,451559,16,451561,15,451565,15,451577,15,451581,15,451776,19,451777,19,451784,19,451785,19,465858,18,465861,16,465862,18,465863,16,465874,18,465878,18,465893,16,465895,16,465910,14,465911,14,465918,14,465919,14,466114,18,466118,18,466130,18,466134,18,467909,16,467911,16,467941,16,467943,16,468160,13,468161,13,468162,13,468163,13,468164,13,468165,13,468166,13,468167,13,580568,17,580570,17,580585,15,580589,15,580598,14,580599,14,580600,17,580601,15,580602,17,580605,15,580606,14,580607,14,580824,17,580826,17,580856,17,580858,17,582633,15,582637,15,582649,15,582653,15,582856,12,582857,12,582872,12,582873,12,582888,12,582889,12,582904,12,582905,12,596982,14,596983,14,596990,14,596991,14,597202,11,597206,11,597210,11,597214,11,597234,11,597238,11,597242,11,597246,11,599013,10,599015,10,599021,10,599023,10,599029,10,599031,10,599037,10,599039,10,599232,13,599233,13,599234,13,599235,13,599236,13,599237,13,599238,13,599239,13,599240,12,599241,12,599250,11,599254,11,599256,12,599257,12,599258,11,599262,11,599269,10,599271,10,599272,12,599273,12,599277,10,599279,10,599282,11,599285,10,599286,11,599287,10,599288,12,599289,12,599290,11,599293,10,599294,11,599295,10],o.p2D=[0,0,1,-1,0,0,-1,1,0,2,1,1,1,2,2,0,1,2,0,2,1,0,0,0],o.p3D=[0,0,1,-1,0,0,1,0,-1,0,0,-1,1,0,0,0,1,-1,0,0,-1,0,1,0,0,-1,1,0,2,1,1,0,1,1,1,-1,0,2,1,0,1,1,1,-1,1,0,2,0,1,1,1,-1,1,1,1,3,2,1,0,3,1,2,0,1,3,2,0,1,3,1,0,2,1,3,0,2,1,3,0,1,2,1,1,1,0,0,2,2,0,0,1,1,0,1,0,2,0,2,0,1,1,0,0,1,2,0,0,2,2,0,0,0,0,1,1,-1,1,2,0,0,0,0,1,-1,1,1,2,0,0,0,0,1,1,1,-1,2,3,1,1,1,2,0,0,2,2,3,1,1,1,2,2,0,0,2,3,1,1,1,2,0,2,0,2,1,1,-1,1,2,0,0,2,2,1,1,-1,1,2,2,0,0,2,1,-1,1,1,2,0,0,2,2,1,-1,1,1,2,0,2,0,2,1,1,1,-1,2,2,0,0,2,1,1,1,-1,2,0,2,0],o.p4D=[0,0,1,-1,0,0,0,1,0,-1,0,0,1,0,0,-1,0,0,-1,1,0,0,0,0,1,-1,0,0,0,1,0,-1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,-1,0,0,-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,2,1,1,0,0,1,1,1,-1,0,1,1,1,0,-1,0,2,1,0,1,0,1,1,-1,1,0,1,1,0,1,-1,0,2,0,1,1,0,1,-1,1,1,0,1,0,1,1,-1,0,2,1,0,0,1,1,1,-1,0,1,1,1,0,-1,1,0,2,0,1,0,1,1,-1,1,0,1,1,0,1,-1,1,0,2,0,0,1,1,1,-1,0,1,1,1,0,-1,1,1,1,4,2,1,1,0,4,1,2,1,0,4,1,1,2,0,1,4,2,1,0,1,4,1,2,0,1,4,1,1,0,2,1,4,2,0,1,1,4,1,0,2,1,4,1,0,1,2,1,4,0,2,1,1,4,0,1,2,1,4,0,1,1,2,1,2,1,1,0,0,3,2,1,0,0,3,1,2,0,0,1,2,1,0,1,0,3,2,0,1,0,3,1,0,2,0,1,2,0,1,1,0,3,0,2,1,0,3,0,1,2,0,1,2,1,0,0,1,3,2,0,0,1,3,1,0,0,2,1,2,0,1,0,1,3,0,2,0,1,3,0,1,0,2,1,2,0,0,1,1,3,0,0,2,1,3,0,0,1,2,2,3,1,1,1,0,2,1,1,1,-1,2,2,0,0,0,2,3,1,1,0,1,2,1,1,-1,1,2,2,0,0,0,2,3,1,0,1,1,2,1,-1,1,1,2,2,0,0,0,2,3,1,1,1,0,2,1,1,1,-1,2,0,2,0,0,2,3,1,1,0,1,2,1,1,-1,1,2,0,2,0,0,2,3,0,1,1,1,2,-1,1,1,1,2,0,2,0,0,2,3,1,1,1,0,2,1,1,1,-1,2,0,0,2,0,2,3,1,0,1,1,2,1,-1,1,1,2,0,0,2,0,2,3,0,1,1,1,2,-1,1,1,1,2,0,0,2,0,2,3,1,1,0,1,2,1,1,-1,1,2,0,0,0,2,2,3,1,0,1,1,2,1,-1,1,1,2,0,0,0,2,2,3,0,1,1,1,2,-1,1,1,1,2,0,0,0,2,2,1,1,1,-1,0,1,1,1,0,-1,0,0,0,0,0,2,1,1,-1,1,0,1,1,0,1,-1,0,0,0,0,0,2,1,-1,1,1,0,1,0,1,1,-1,0,0,0,0,0,2,1,1,-1,0,1,1,1,0,-1,1,0,0,0,0,0,2,1,-1,1,0,1,1,0,1,-1,1,0,0,0,0,0,2,1,-1,0,1,1,1,0,-1,1,1,0,0,0,0,0,2,1,1,1,-1,0,1,1,1,0,-1,2,2,0,0,0,2,1,1,-1,1,0,1,1,0,1,-1,2,2,0,0,0,2,1,1,-1,0,1,1,1,0,-1,1,2,2,0,0,0,2,1,1,1,-1,0,1,1,1,0,-1,2,0,2,0,0,2,1,-1,1,1,0,1,0,1,1,-1,2,0,2,0,0,2,1,-1,1,0,1,1,0,1,-1,1,2,0,2,0,0,2,1,1,-1,1,0,1,1,0,1,-1,2,0,0,2,0,2,1,-1,1,1,0,1,0,1,1,-1,2,0,0,2,0,2,1,-1,0,1,1,1,0,-1,1,1,2,0,0,2,0,2,1,1,-1,0,1,1,1,0,-1,1,2,0,0,0,2,2,1,-1,1,0,1,1,0,1,-1,1,2,0,0,0,2,2,1,-1,0,1,1,1,0,-1,1,1,2,0,0,0,2,3,1,1,0,0,0,2,2,0,0,0,2,1,1,1,-1,3,1,0,1,0,0,2,0,2,0,0,2,1,1,1,-1,3,1,0,0,1,0,2,0,0,2,0,2,1,1,1,-1,3,1,1,0,0,0,2,2,0,0,0,2,1,1,-1,1,3,1,0,1,0,0,2,0,2,0,0,2,1,1,-1,1,3,1,0,0,0,1,2,0,0,0,2,2,1,1,-1,1,3,1,1,0,0,0,2,2,0,0,0,2,1,-1,1,1,3,1,0,0,1,0,2,0,0,2,0,2,1,-1,1,1,3,1,0,0,0,1,2,0,0,0,2,2,1,-1,1,1,3,1,0,1,0,0,2,0,2,0,0,2,-1,1,1,1,3,1,0,0,1,0,2,0,0,2,0,2,-1,1,1,1,3,1,0,0,0,1,2,0,0,0,2,2,-1,1,1,1,3,3,2,1,0,0,3,1,2,0,0,4,1,1,1,1,3,3,2,0,1,0,3,1,0,2,0,4,1,1,1,1,3,3,0,2,1,0,3,0,1,2,0,4,1,1,1,1,3,3,2,0,0,1,3,1,0,0,2,4,1,1,1,1,3,3,0,2,0,1,3,0,1,0,2,4,1,1,1,1,3,3,0,0,2,1,3,0,0,1,2,4,1,1,1,1,3,3,2,1,0,0,3,1,2,0,0,2,1,1,1,-1,3,3,2,0,1,0,3,1,0,2,0,2,1,1,1,-1,3,3,0,2,1,0,3,0,1,2,0,2,1,1,1,-1,3,3,2,1,0,0,3,1,2,0,0,2,1,1,-1,1,3,3,2,0,0,1,3,1,0,0,2,2,1,1,-1,1,3,3,0,2,0,1,3,0,1,0,2,2,1,1,-1,1,3,3,2,0,1,0,3,1,0,2,0,2,1,-1,1,1,3,3,2,0,0,1,3,1,0,0,2,2,1,-1,1,1,3,3,0,0,2,1,3,0,0,1,2,2,1,-1,1,1,3,3,0,2,1,0,3,0,1,2,0,2,-1,1,1,1,3,3,0,2,0,1,3,0,1,0,2,2,-1,1,1,1,3,3,0,0,2,1,3,0,0,1,2,2,-1,1,1,1];function l(S){var E=new Uint32Array(1);return E[0]=S[0]*1664525+1013904223,E}function f(S,E,k){this.dx=-E-S*o.SQUISH_2D,this.dy=-k-S*o.SQUISH_2D,this.xsb=E,this.ysb=k}function h(S,E,k,X){this.dx=-E-S*o.SQUISH_3D,this.dy=-k-S*o.SQUISH_3D,this.dz=-X-S*o.SQUISH_3D,this.xsb=E,this.ysb=k,this.zsb=X}function p(S,E,k,X,q){this.dx=-E-S*o.SQUISH_4D,this.dy=-k-S*o.SQUISH_4D,this.dz=-X-S*o.SQUISH_4D,this.dw=-q-S*o.SQUISH_4D,this.xsb=E,this.ysb=k,this.zsb=X,this.wsb=q}var _=[],b,w,C,O,P,A;for(b=0;b<o.p2D.length;b+=4){for(O=o.base2D[o.p2D[b]],P=null,A=null,w=0;w<O.length;w+=3)A=new f(O[w],O[w+1],O[w+2]),P===null?_[b/4]=A:P.next=A,P=A;A.next=new f(o.p2D[b+1],o.p2D[b+2],o.p2D[b+3])}for(this.lookup2D=[],b=0;b<o.lookupPairs2D.length;b+=2)this.lookup2D[o.lookupPairs2D[b]]=_[o.lookupPairs2D[b+1]];var R=[];for(b=0;b<o.p3D.length;b+=9){for(O=o.base3D[o.p3D[b]],P=null,A=null,w=0;w<O.length;w+=4)A=new h(O[w],O[w+1],O[w+2],O[w+3]),P===null?R[b/9]=A:P.next=A,P=A;A.next=new h(o.p3D[b+1],o.p3D[b+2],o.p3D[b+3],o.p3D[b+4]),A.next.next=new h(o.p3D[b+5],o.p3D[b+6],o.p3D[b+7],o.p3D[b+8])}for(this.lookup3D=[],b=0;b<o.lookupPairs3D.length;b+=2)this.lookup3D[o.lookupPairs3D[b]]=R[o.lookupPairs3D[b+1]];var T=[];for(b=0;b<o.p4D.length;b+=16){for(O=o.base4D[o.p4D[b]],P=null,A=null,w=0;w<O.length;w+=5)A=new p(O[w],O[w+1],O[w+2],O[w+3],O[w+4]),P===null?T[b/16]=A:P.next=A,P=A;A.next=new p(o.p4D[b+1],o.p4D[b+2],o.p4D[b+3],o.p4D[b+4],o.p4D[b+5]),A.next.next=new p(o.p4D[b+6],o.p4D[b+7],o.p4D[b+8],o.p4D[b+9],o.p4D[b+10]),A.next.next.next=new p(o.p4D[b+11],o.p4D[b+12],o.p4D[b+13],o.p4D[b+14],o.p4D[b+15])}for(this.lookup4D=[],b=0;b<o.lookupPairs4D.length;b+=2)this.lookup4D[o.lookupPairs4D[b]]=T[o.lookupPairs4D[b+1]];this.perm=new Uint8Array(256),this.perm2D=new Uint8Array(256),this.perm3D=new Uint8Array(256),this.perm4D=new Uint8Array(256);var L=new Uint8Array(256);for(b=0;b<256;b++)L[b]=b;for(t=new Uint32Array(1),t[0]=r,t=l(l(l(t))),b=255;b>=0;b--)t=l(t),C=new Uint32Array(1),C[0]=(t[0]+31)%(b+1),C[0]<0&&(C[0]+=b+1),this.perm[b]=L[C[0]],this.perm2D[b]=this.perm[b]&14,this.perm3D[b]=this.perm[b]%24*3,this.perm4D[b]=this.perm[b]&252,L[C[0]]=L[b];this.simplex1D=function(S){return i.simplex2D(S,1)},this.simplex2D=function(S,E){var k=(S+E)*o.STRETCH_2D,X=[S+k,E+k],q=X[0],V=X[1],I=[Math.floor(q),Math.floor(V)],te=I[0],B=I[1],Z=(te+B)*o.SQUISH_2D,U=[S-(te+Z),E-(B+Z)],ee=U[0],ae=U[1],re=[q-te,V-B],he=re[0],j=re[1],G=he+j,y=new Uint32Array(4);y[0]=he-j+1,y[1]=G,y[2]=G+j,y[3]=G+he;for(var g=y[0]|y[1]<<1|y[2]<<2|y[3]<<4,d=i.lookup2D[g],D=0;typeof d<"u";){var K=[ee+d.dx,ae+d.dy],m=K[0],F=K[1],Ce=2-m*m-F*F;if(Ce>0){var Y=[te+d.xsb,B+d.ysb],Q=Y[0],ce=Y[1],pe=i.perm2D[i.perm[Q&255]+ce&255],J=o.gradients2D[pe]*m+o.gradients2D[pe+1]*F;Ce*=Ce,D+=Ce*Ce*J}d=d.next}return D*o.NORM_2D},this.simplex3D=function(S,E,k){var X=(S+E+k)*o.STRETCH_3D,q=[S+X,E+X,k+X],V=q[0],I=q[1],te=q[2],B=[Math.floor(V),Math.floor(I),Math.floor(te)],Z=B[0],U=B[1],ee=B[2],ae=(Z+U+ee)*o.SQUISH_3D,re=[S-(Z+ae),E-(U+ae),k-(ee+ae)],he=re[0],j=re[1],G=re[2],y=[V-Z,I-U,te-ee],g=y[0],d=y[1],D=y[2],K=g+d+D,m=new Uint32Array(7);m[0]=d-D+1,m[1]=g-d+1,m[2]=g-D+1,m[3]=K,m[4]=K+D,m[5]=K+d,m[6]=K+g;for(var F=m[0]|m[1]<<1|m[2]<<2|m[3]<<3|m[4]<<5|m[5]<<7|m[6]<<9,Ce=i.lookup3D[F],Y=0;typeof Ce<"u";){var Q=[he+Ce.dx,j+Ce.dy,G+Ce.dz],ce=Q[0],pe=Q[1],J=Q[2],ue=2-ce*ce-pe*pe-J*J;if(ue>0){var ye=[Z+Ce.xsb,U+Ce.ysb,ee+Ce.zsb],Xe=ye[0],se=ye[1],Ae=ye[2],ie=i.perm3D[i.perm[i.perm[Xe&255]+se&255]+Ae&255],_e=o.gradients3D[ie]*ce+o.gradients3D[ie+1]*pe+o.gradients3D[ie+2]*J;ue*=ue,Y+=ue*ue*_e}Ce=Ce.next}return Y*o.NORM_3D},this.simplex4D=function(S,E,k,X){var q=(S+E+k+X)*o.STRETCH_4D,V=[S+q,E+q,k+q,X+q],I=V[0],te=V[1],B=V[2],Z=V[3],U=[Math.floor(I),Math.floor(te),Math.floor(B),Math.floor(Z)],ee=U[0],ae=U[1],re=U[2],he=U[3],j=(ee+ae+re+he)*o.SQUISH_4D,G=S-(ee+j),y=E-(ae+j),g=k-(re+j),d=X-(he+j),D=[I-ee,te-ae,B-re,Z-he],K=D[0],m=D[1],F=D[2],Ce=D[3],Y=K+m+F+Ce,Q=new Uint32Array(11);Q[0]=F-Ce+1,Q[1]=m-F+1,Q[2]=m-Ce+1,Q[3]=K-m+1,Q[4]=K-F+1,Q[5]=K-Ce+1,Q[6]=Y<<6,Q[7]=Y+Ce,Q[8]=Y+F,Q[9]=Y+m,Q[10]=Y+K;for(var ce=Q[0]|Q[1]<<1|Q[2]<<2|Q[3]<<3|Q[4]<<4|Q[5]<<5|Q[6]<<6|Q[7]<<8|Q[8]<<11|Q[9]<<14|Q[10]<<17,pe=i.lookup4D[ce],J=0;typeof pe<"u";){var ue=[G+pe.dx,y+pe.dy,g+pe.dz,d+pe.dw],ye=ue[0],Xe=ue[1],se=ue[2],Ae=ue[3],ie=2-ye*ye-Xe*Xe-se*se-Ae*Ae;if(ie>0){var _e=[ee+pe.xsb,ae+pe.ysb,re+pe.zsb,he+pe.wsb],$=_e[0],xe=_e[1],Be=_e[2],me=_e[3],Oe=i.perm4D[i.perm[i.perm[i.perm[$&255]+xe&255]+Be&255]+me&255],Ye=o.gradients4D[Oe]*ye+o.gradients4D[Oe+1]*Xe+o.gradients4D[Oe+2]*se+o.gradients4D[Oe+3]*Ae;ie*=ie,J+=ie*ie*Ye}pe=pe.next}return J*o.NORM_4D}},typeof $e<"u"&&(e.Point=function(t,r,i,o,l,f,h,p,_,b){qe("13.45"),n(t)&&(t=0),n(r)&&(r=0),n(i)&&(i=0),n(o)&&(o=0),n(l)&&(l=0),n(f)&&(f=0),n(h)&&(h=0),n(p)&&(p=0),n(_)&&(_=0),n(b)&&(b=0),this.createjsPoint_constructor(t,r),this.type="Point",this.x=t,this.y=r,this.z=i,this.q=o,this.r=l,this.s=f,this.t=h,this.u=p,this.v=_,this.w=b,this.angle=function(w){return this.createjsPoint_angle(w)*180/Math.PI},this.project=function(w,C){return this.createjsPoint_project(w*Math.PI/180,C)}},e.extend(e.Point,$e.Point,["angle","project"],"createjsPoint")),e.Bezier=function(r,i,o,l){qe("13.47"),this.a=r,this.b=i,this.c=o,this.d=l,this.len=100,this.arcLengths=new Array(this.len+1),this.arcLengths[0]=0;for(var f=this.x(0),h=this.y(0),p=0,_=1;_<=this.len;_+=1){var b=this.x(_*.01),w=this.y(_*.01),C=f-b,O=h-w;p+=Math.sqrt(C*C+O*O),this.arcLengths[_]=p,f=b,h=w}this.length=p},e.Bezier.prototype={map:function(t){for(var r=t*this.arcLengths[this.len],i=0,o=this.len,l=0;i<o;)l=i+((o-i)/2|0),this.arcLengths[l]<r?i=l+1:o=l;this.arcLengths[l]>r&&l--;var f=this.arcLengths[l];return f===r?l/this.len:(l+(r-f)/(this.arcLengths[l+1]-f))/this.len},mx:function(t){return this.x(this.map(t))},my:function(t){return this.y(this.map(t))},x:function(t){return(1-t)*(1-t)*(1-t)*this.a.x+3*((1-t)*(1-t))*t*this.b.x+3*(1-t)*(t*t)*this.c.x+t*t*t*this.d.x},y:function(t){return(1-t)*(1-t)*(1-t)*this.a.y+3*((1-t)*(1-t))*t*this.b.y+3*(1-t)*(t*t)*this.c.y+t*t*t*this.d.y}},e.Boundary=function(t,r,i,o){qe("13.46"),t.x&&(o=t.height,i=t.width,r=t.y,t=t.x),!(n(t)||n(r)||n(i)||n(o))&&(this.x=t,this.y=r,this.width=i,this.height=o,this.contract=function(l,f,h,p){return n(l)?this:(n(f)&&(f=l),n(h)?h=l*2:h=h+l,n(p)?p=f*2:p=p+f,this.x+=l,this.y+=f,this.width-=h,this.height-=p,this)})},e.GradientColor=function(t,r,i,o,l,f){if(qe("13.465"),this.type="GradientColor",this.colors=n(t)?["black","white"]:t,Array.isArray(this.colors)||(this.colors=[this.colors,this.colors]),this.colors.length==1&&this.colors.push(this.colors[0]),this.ratios=n(r)?0:r,!Array.isArray(this.ratios)){this.angle=this.ratios,this.ratios=[];for(var h=0;h<this.colors.length;h++)this.ratios.push(h/(this.colors.length-1))}!n(i)&&(n(o)||n(l)||n(f))?(this.angle=i,i=null):n(this.angle)&&n(i)&&n(o)&&n(l)&&n(f)?this.angle=0:(this.x0=n(i)?0:i,this.y0=n(o)?0:o,this.x1=n(l)?0:l,this.y1=n(f)?100:f)},e.RadialColor=function(t,r,i,o,l,f,h,p){if(qe("13.466"),this.type="RadialColor",this.colors=n(t)?["black","white"]:t,Array.isArray(this.colors)||(this.colors=[this.colors,this.colors]),this.colors.length==1&&this.colors.push(this.colors[0]),this.ratios=r,!Array.isArray(this.ratios)){this.ratios=[];for(var _=0;_<this.colors.length;_++)this.ratios.push(_/(this.colors.length-1))}this.x0=i,this.y0=o,this.r0=l,this.x1=f,this.y1=h,this.r1=p},e.BitmapColor=function(t,r,i){qe("13.467"),this.type="BitmapColor",typeof t=="string"&&le.asset&&(t=le.asset(t)),t.type!="Bitmap"&&t.bitmap&&(t=t.bitmap),this.image=t.type=="Bitmap"?t.image:t,this.repetition=r,this.matrix=i},e.Damp=function(t,r){qe("14");var i="startValue, damp",o;if(o=mt(e.Damp,arguments,i,this))return o;this.lastValue=n(t)?0:t,this.damp=n(r)?.1:r},e.Damp.prototype.convert=function(t){return this.lastValue=this.lastValue+(t-this.lastValue)*this.damp},e.Damp.prototype.immediate=function(t){return this.lastValue=t,this},e.Proportion=function(t,r,i,o,l,f,h){var p="baseMin, baseMax, targetMin, targetMax, factor, targetRound, clamp",_;if(_=mt(e.Proportion,arguments,p,this))return _;qe("15"),n(i)&&(i=0),n(o)&&(o=1),n(l)&&(l=1),n(f)&&(f=!1),n(h)&&(h=!0);var b,w;this.convert=function(C){if(n(C)&&(C=t),!(isNaN(C)||r-t==0))return h&&(C=Math.max(C,t),C=Math.min(C,r)),b=(C-t)/(r-t),l>0?w=i+(o-i)*b:w=o-(o-i)*b,f&&(w=Math.round(w)),w}},e.ProportionDamp=function(t,r,i,o,l,f,h,p){var _="baseMin, baseMax, targetMin, targetMax, damp, factor, targetRound, clamp",b;if(b=mt(e.ProportionDamp,arguments,_,this))return b;qe("16"),n(i)&&(i=0),n(o)&&(o=1),n(l)&&(l=.1),n(f)&&(f=1),n(h)&&(h=!1),n(p)&&(p=!0),this.damp=l;var w=this,C,O,P,A,R,T=0,L=0;C=t,L=i;var S=setInterval(E,20);function E(){isNaN(C)||r-t==0||(p&&(C=Math.max(C,t),C=Math.min(C,r)),O=(C-t)/(r-t),P=o-i,f>0?A=i+P*O:A=o-P*O,T=A,R=T-L,L+=R*w.damp)}this.immediate=function(k){return w.convert(k),E(),L=A,h&&(L=Math.round(L)),w},this.immediateValue=function(k){return T=L=k,w},this.convert=function(k){return C=k,h?Math.round(L):L},this.dispose=function(){return clearInterval(S),!0}},e.Dictionary=function(t){qe("17"),this.length=0,this.unique=t;var r=this.objects=[],i=this.values=[];this.type="Dictionary",this.add=function(o,l){n(o)||(n(l)&&(l=!0),this.unique&&this.remove(o),r.push(o),i.push(l),this.length++)},this.at=function(o){if(!n(o)){var l=r.indexOf(o);return l>-1?i[l]:null}},this.remove=function(o){if(n(o))return!1;var l=r.indexOf(o);return l>-1?(r.splice(l,1),i.splice(l,1),this.length--,!0):!1},this.clear=function(){return r=this.objects=[],i=this.values=[],this.length=null,this},this.dispose=function(){return r=null,i=null,this.length=null,!0}},e.Hierarchy=function(t,r){qe("17.5");var i=this;if(n(t))return;n(r)&&(r=!1);var o;i.processSimple=function(p){var _=0,b={};function w(C,O,P,A){if(n(C)||(p=C),p.constructor=={}.constructor){var R;p.list&&(R=p,p=p.list),A&&R&&e.loop(R,function(T,L){T!="list"&&(A[T]=L)}),e.loop(p,function(T,L){var S={},E=O["id"+_]={obj:T,level:P,open:r,opened:!1,list:S};_++,w(L,S,P+1,E)})}else Array.isArray(p)&&e.loop(p,function(T){O["id"+_]={obj:T},_++})}return w(t,b,0),o=_,b},i.processComplex=function(p){var _=0;function b(w,C){e.loop(w,function(O,P){P.level=C,n(P.open)&&(P.open=r),n(P.opened)&&(P.opened=!1),P.list&&b(P.list,C+1),_++})}return b(p,0),o=_,p},n(t.id0)?i.data=i.processSimple(t):i.data=i.processComplex(t),i.getLinearList=function(p){return n(p)&&(p=i.data),l(p)[0]},i.getLinearIDs=function(p){return n(p)&&(p=i.data),l(p)[1]};function l(p){var _=[],b=[];function w(C,O){e.loop(C,function(P,A){_.push(A.obj),b.push(P),A.open&&w(A.list,O+1)})}return w(p,0),[_,b]}i.getData=function(p){var _;function b(w){e.loop(w,function(C,O){if(C==p)return _=O,_;b(O.list)})}return b(i.data),_},i.getNextSibling=function(p){var _,b;function w(C){e.loop(C,function(O,P){if(!b&&_)return b=O,b;O==p?_=P:w(P.list)})}return w(i.data),b},i.getPrevSibling=function(p){var _=[],b;function w(C,O){e.loop(C,function(P,A){if(P==p)return b=_[O]||_[O-1],b;_[O]=P,w(A.list,O+1)})}return w(i.data,0),b},i.insertBefore=function(p,_,b){return f("insertBefore",p,_,b)},i.insertAfter=function(p,_,b){return f("insertAfter",p,_,b)},i.removeItem=function(p){return f("removeItem",null,p)},i.replaceItem=function(p,_){var b=i.getData(_);return b.obj=p,f("replaceItem")};function f(p,_,b,w){var C=0,O={},P=i.data;function A(R,T,L,S){e.loop(R,function(E,k){if(!(p=="removeItem"&&E==b)){var X,q,V;p=="insertBefore"&&E==b&&(C=h(T,C,L,_,w)),X={},q=k.list,k.list=X,k.opened=!1,k.open=!1,V=T["id"+C]=k,V.obj.type&&V.obj.type=="TabsButton"&&(V.obj=V.obj.text),C++,A(q,X,L+1),p=="insertAfter"&&E==b&&(C=h(T,C,L,_,w))}})}return A(P,O,0),o=C,O}function h(p,_,b,w,C){if(C){var O={};Array.isArray(w)&&(w=w[0]),p["id"+_]={obj:w,level:b,open:!1,opened:!1,list:O},_++,Array.isArray(C)||(C=[C]),e.loop(C,function(P){O["id"+_]={obj:P,level:b+1,open:!1,opened:!1,list:{}},_++})}else Array.isArray(w)||(w=[w]),e.loop(w,function(P){p["id"+_]={obj:P,level:b,open:!1,opened:!1,list:{}},_++});return _}i.getParent=function(p){var _=i.data;function b(w,C){var O=e.loop(w,function(P,A){if(P==p)return o-=1,C;if(A.list&&!e.isEmpty(A.list))return b(A.list,P)});if(O!==!0)return O}return b(_)},Object.defineProperty(i,"length",{get:function(){return o},set:function(){Ct&&ht("Hierarchy() - length is read only")}})},e.Pick=function(t){e.pickCheck||(qe("17.6"),e.pickCheck=!0),this.choices=t,this.num=function(i){for(var o=[],l=0;l<i;l++)o.push(e.Pick.choose(this));return this.choices=e.Pick.series(o),this};var r=this;this.loop=function(i,o){for(var l,f=0;f<i;f++)if(l=o(e.Pick.choose(r),f,i),typeof l<"u")return l}},e.Pick.prototype.type="Pick",e.Pick.series=function(){return e.pickCheck||(qe("17.6"),e.pickCheck=!0),e.series.apply(null,arguments)},e.Pick.rand=function(t,r,i,o){return e.pickCheck||(qe("17.6"),e.pickCheck=!0),e.rand(t,r,i,o)},e.Pick.choose=function(t,r,i){if(e.pickCheck||(qe("17.6"),e.pickCheck=!0),r==null&&(r=!0),t==null)return t;if(t.type=="Pick"||r){var o=t.choices||t,l;return Array.isArray(o)?(l=o[Math.floor(Math.random()*o.length)],e.Pick.choose(l)):o.constructor==={}.constructor?n(o.noPick)?n(o.max)?o:(n(o.integer)&&(o.integer=!1),l=e.Pick.rand(o.min,o.max,o.integer,o.negative),l):o.noPick:o instanceof Function?(o.count==null?o.count=0:o.count++,e.Pick.choose(o(i,!0))):t}else return t},e.Pick.getMinMax=function(t){return!n(t.min)&&!n(t.max)?t:Array.isArray(t)?e.arrayMinMax(t):t.type=="series"?e.arrayMinMax(t.array):{min:null,max:null}},e.scrollX=function(t,r){return qe("18"),e.abstractScroll("X","Left",t,r)},e.scrollY=function(t,r){return qe("19"),e.abstractScroll("Y","Top",t,r)},e.abstractScroll=function(t,r,i,o){qe("20");var l=v(o),f=t=="X"?"Y":"X";if(n(i))return document.documentElement&&document.documentElement["scroll"+r]||document.body["scroll"+r];if(n(o))le.scrollTo(e["scroll"+f](),i);else{var h=50,p=o*(l=="s"?1e3:1);p<h&&(p=h);var _=p/h,b=e["scroll"+t](),w=i-b,C=w/_,O=0,P=setInterval(function(){O++,b+=C,le.scrollTo(e["scroll"+f](),b),O>=_&&(le.scrollTo(e["scroll"+f](),i),clearInterval(P))},h)}return i},e.windowWidth=function(){qe("21");var t=isNaN(le.innerWidth)?le.clientWidth:le.innerWidth,r=isNaN(le.innerHeight)?le.clientHeight:le.innerHeight;if(e.mobile()&&!n(le.orientation)&&!le.parent&&(t>r&&Math.abs(le.orientation)!=90||r>t&&Math.abs(le.orientation)==90)){var i=t;t=r,r=i}return le.zdf&&le.zdf.swapRotation?r:t},e.windowHeight=function(){qe("22");var t=isNaN(le.innerWidth)?le.clientWidth:le.innerWidth,r=isNaN(le.innerHeight)?le.clientHeight:le.innerHeight;if(e.mobile()&&!n(le.orientation)&&!le.parent&&(t>r&&Math.abs(le.orientation)!=90||r>t&&Math.abs(le.orientation)==90)){var i=t;t=r,r=i}return le.zdf&&le.zdf.swapRotation?t:r},e.browserZoom=function(){if(e.zimBZ)return n(e.zimBZA)?e.decimals((le.devicePixelRatio||1)/e.zimBZ1,2):e.zimBZA;if(qe("22.2"),e.zimBZ=!0,typeof t>"u")if(le.zdf)var t=le.zdf;else return e.zimBZA=1,1;if(t.retina)e.zimBZ1=le.devicePixelRatio||1;else return e.zimBZA=1,1},e.getQueryString=function(t){if(qe("22.5"),n(t)&&(t=location.search.replace("?","")),t=="")return{};for(var r=t.split("&"),i={},o=0;o<r.length;o++){var l=r[o].split("=");typeof i[l[0]]>"u"?i[l[0]]=decodeURIComponent((l[1]+"").replace(/\+/g,"%20")):typeof i[l[0]]=="string"?i[l[0]]=[i[l[0]],decodeURIComponent((l[1]+"").replace(/\+/g,"%20"))]:i[l[0]].push(decodeURIComponent((l[1]+"").replace(/\+/g,"%20")))}return i},e.swapHTML=function(t,r){return qe("17.2"),e.swapProperties("innerHTML",_n(t),_n(r))},e.urlEncode=function(t){return qe("23"),t=(t+"").toString(),encodeURIComponent(t).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A").replace(/%20/g,"+")},e.urlDecode=function(t){return qe("24"),decodeURIComponent((t+"").replace(/\+/g,"%20"))},e.setCookie=function(t,r,i){if(qe("25"),!(n(t)||n(r))){var o;if(i){var l=new Date;l.setTime(l.getTime()+i*24*60*60*1e3),o="; expires="+l.toGMTString()}else o="";return document.cookie=t+"="+escape(r)+o+"; path=/",!0}},e.getCookie=function(t){qe("26");for(var r=document.cookie.split(/;\s*/),i=new Array,o,l=0;l<r.length;l++)o=r[l].split("="),i[o[0]]=o[1];if(!(typeof i[t]>"u"))return unescape(i[t])},e.deleteCookie=function(t){return qe("27"),n(e.getCookie(t))?!1:(e.setCookie(t,"",-1),!0)},$e==null)return Ct&&li("ZIM >= 4.3.0 requires createjs namespace to be loaded (import createjs before zim)"),e;e.localToGlobal=function(r,i,o,l){if(e.coordinatesCheck||(qe("50.43"),e.coordinatesCheck=!0),!(r==null||i==null)){var f=l.call(o,r,i),h=o.stage;if(!le.zdf){if(!h)return f;le.zdf={stage:h,canvas:h.canvas}}return f.x/=e.scaX,f.y/=e.scaY,f}},e.globalToLocal=function(r,i,o,l){if(e.coordinatesCheck||(qe("50.43"),e.coordinatesCheck=!0),!(r==null||i==null)){var f=o.stage;if(!le.zdf){if(!f)return l.call(o,r,i);le.zdf={stage:f,canvas:f.canvas}}r*=e.scaX,i*=e.scaY;var h=l.call(o,r,i);return h}},e.localToLocal=function(r,i,o,l){if(e.coordinatesCheck||(qe("50.43"),e.coordinatesCheck=!0),!(r==null||i==null||o==null)){var f=l.localToGlobal(r,i),h=l.stage;if(!le.zdf){if(!h)return o.globalToLocal(f.x,f.y);le.zdf={stage:h,canvas:h.canvas}}if(h||(h=le.zdf.stage),o==h)return f;if(f)return o.globalToLocal(f.x,f.y)}},e.displayBase=function(t){e.zimDBCheck||(qe("50.432"),e.zimDBCheck=!0);var r=t;if(Object.defineProperty(t,"width",{enumerable:!0,get:function(){var p=this.getBounds();return n(p)?null:Math.abs(p.width*this.scaleX)},set:function(p){if(t.scaleDimensions!==!1){var _=this.getBounds();if(n(_)||_.width==0){Ct&&ht("DisplayObject() - width needs bounds set with setBounds()");return}var b=p/_.width;this.scaleX=this.scaleY=b}else{var w=t.width!=0?t.height/t.width:0;t.setWidth(p),t.setHeight(p*w),t.drawShape()}}}),Object.defineProperty(t,"height",{enumerable:!0,get:function(){var p=this.getBounds();return n(p)?null:Math.abs(p.height*this.scaleY)},set:function(p){if(t.scaleDimensions!==!1){var _=this.getBounds();if(n(_)||_.height==0){Ct&&ht("DisplayObject() - height needs bounds set with setBounds()");return}var b=p/_.height;this.scaleX=this.scaleY=b}else{var w=t.height!=0?t.width/t.height:0;t.setHeight(p),t.setWidth(p*w),t.drawShape()}}}),Object.defineProperty(t,"widthOnly",{enumerable:!0,get:function(){var p=this.getBounds();return n(p)?null:Math.abs(p.width*this.scaleX)},set:function(p){if(t.scaleDimensions!==!1){var _=this.getBounds();if((n(_)||_.width==0)&&Ct){ht("DisplayObject() - widthOnly needs bounds set with setBounds()");return}var b=p/_.width;this.scaleX=b}else t.setWidth(p),t.drawShape()}}),Object.defineProperty(t,"heightOnly",{enumerable:!0,get:function(){var p=this.getBounds();return n(p)?null:Math.abs(p.height*this.scaleY)},set:function(p){if(t.scaleDimensions!==!1){var _=this.getBounds();if((n(_)||_.height==0)&&Ct){ht("DisplayObject() - heightOnly needs bounds set with setBounds()");return}var b=p/_.height;this.scaleY=b}else t.setHeight(p),t.drawShape()}}),Object.defineProperty(t,"level",{enumerable:!0,get:function(){return this.parent?this.parent.getChildIndex(this):null},set:function(p){this.parent&&this.parent.setChildIndex(this,Math.max(0,Math.min(p,this.parent.numChildren-1)))}}),Object.defineProperty(t,"depth",{enumerable:!0,get:function(){return this._depth},set:function(p){if(this._depth=p,!n(this.vrChannel)){var _=this.vrParallaxDistance?p*this.vrParallax*this.vrParallaxDistance:0;this.vrChannel=="left"?this.x=this.vrStartX+p+_:this.vrChannel=="right"&&(this.x=this.vrStartX-p+_)}}}),Object.defineProperty(t,"blendMode",{enumerable:!0,get:function(){return this.compositeOperation},set:function(p){this.compositeOperation=p}}),!r.name){var i;Object.defineProperty(r,"name",{get:function(){return i},set:function(p){i=p,e.zimObjectIDs[p]=r}})}r._draggable,Object.defineProperty(r,"draggable",{get:function(){return this._draggable},set:function(p){p!=this._draggable&&(this._draggable=p,this._draggable?this.drag():this.noDrag())}});var o,l;r.on("mousedown",function(p){p.target.stage&&(o=p.target.stage.frame,o.allowDefault&&(l=!0,o.allowDefault=!1))}),r.on("pressup",function(){o&&l&&(o.allowDefault=!0)});for(var f=["hue","saturation","brightness","contrast"],h=0;h<f.length;h++)-function(){for(var p=f[h],_=0;_<2;_++)-function(){var b=_==0?"":"Batch";Object.defineProperty(r,p+b,{get:function(){return r.effects&&r.effects.multi?r.effects.multi[p]:0},set:function(w){!r.effects||!r.effects.multi?r.effect(new e.MultiEffect(p=="hue"?w:0,p=="saturation"?w:0,p=="brightness"?w:0,p=="contrast"?w:0)):r.effects.multi[p]=w,b==""&&r.updateEffects()}})}()}()},e.gD=function(t){if(e.zimGDCheck||(qe("50.435"),e.zimGDCheck=!0),!!t){if(t.z_bc){var r=t.z_bc;r.width=r.height=1,r.getContext&&r.getContext("2d").clearRect(0,0,1,1),delete t.z_bc}e.KEYFOCUS==t&&(e.KEYFOCUS=null),le.KEYFOCUS==t&&(le.KEYFOCUS=null),t.veeObj&&(t.veeObj=null),t.draggable&&t.noDrag(),t.zimTweens&&t.stopAnimate(),t.zimWire&&t.noWire(),t.zimWired&&t.noWired(),t.zimClickHoldDownEvent&&t.noHold(),t.transformControls&&t.transformControls.dispose(),t.zimClickDownEvent&&(t.zimClickDownEvent=null),t.zimClickUpEvent&&(t.zimClickUpEvent=null),t.physics&&t.removePhysics(),t.name&&e.zimObjectIDs[t.name]==t&&delete e.zimObjectIDs[t.name]}},e.Stage=function(t,r,i){if(qe("50.44"),!n(t)){var o=t.tagName=="CANVAS"?t:_n(t);n(o)||(this.cjsStage_constructor(t),this.setBounds(0,0,o.width,o.height),this.type="Stage",le.zdf||(le.zimDefaultFrame=le.zdf={stage:this}),i?$e.Touch.enable(this,!0):r&&$e.Touch.enable(this,!1),this.cache=function(l,f,h,p,_,b){if(n(h))if(n(l)){var w=this.getBounds();if(!n(w)){var C=this.borderWidth>0?this.borderWidth/2:0;l=w.x-C,f=w.y-C,h=w.width+C*2,p=w.height+C*2}}else h=l,p=f,l=0,f=0;return this.cjsStage_cache(l,f,h,p,_,b),this.z_bc=this.cacheCanvas,this},this.on("mousedown",function(l){var f=l.clone();f.type="pressdown",l.target.dispatchEvent(f)},void 0,!1,void 0,!0),this.loop=function(l,f,h,p,_,b){return e.loop(this,l,f,h,p,_,b)},this.hitTestGrid=function(l,f,h,p,_,b,w,C,O,P,A,R){return e.hitTestGrid(this,l,f,h,p,_,b,w,C,O,P,A,R)},this.disposeAllChildren=function(){for(var l=this.numChildren-1;l>=0;l--){var f=this.getChildAt(l);f.dispose&&f.dispose()}return this},this.frame=le.zdf,$e&&!$e.stageTransformable&&(le.zdf.retina||typeof exportRoot<"u")&&(Object.defineProperty(this,"scale",{get:function(){return this.cjsStage_scale},set:function(l){this.cjsStage_scaleX=l,this.cjsStage_scaleY=l,e.scaX=$e.stageTransformable?1:l,e.scaY=$e.stageTransformable?1:l}}),Object.defineProperty(this,"scaleX",{get:function(){return this.cjsStage_scaleX},set:function(l){this.cjsStage_scaleX=l,e.scaX=$e.stageTransformable?1:l}}),Object.defineProperty(this,"scaleY",{get:function(){return this.cjsStage_scaleY},set:function(l){this.cjsStage_scaleY=l,e.scaY=$e.stageTransformable?1:l}}),this.localToGlobal=function(l,f){return e.localToGlobal(l,f,this,this.cjsStage_localToGlobal)},this.globalToLocal=function(l,f){return e.globalToLocal(l,f,this,this.cjsStage_globalToLocal)},this.localToLocal=function(l,f,h){return e.localToLocal(l,f,h,this)}))}},e.extend(e.Stage,$e.Stage,["cache","localToLocal","localToGlobal","globalToLocal"],"cjsStage",!1),e.StageGL=function(t,r,i,o){if(qe("50.45"),!n(t)){var l=t.tagName=="CANVAS"?t:_n(t);n(l)||(this.cjsStageGL_constructor(t,r),this.setBounds(0,0,l.width,l.height),this.type="StageGL",le.zdf||(le.zdf={stage:this}),o?$e.Touch.enable(this,!0):i&&$e.Touch.enable(this,!1),this.cache=function(f,h,p,_,b,w){if(n(p))if(n(f)){var C=this.getBounds();if(!n(C)){var O=this.borderWidth>0?this.borderWidth/2:0;f=C.x-O,h=C.y-O,p=C.width+O*2,_=C.height+O*2}}else p=f,_=h,f=0,h=0;return this.cjsStageGL_cache(f,h,p,_,b,w),this.z_bc=this.cacheCanvas,this},this.on("mousedown",function(f){var h=f.clone();h.type="pressdown",f.target.dispatchEvent(h)},void 0,!1,void 0,!0),this.loop=function(f,h,p,_,b,w){return e.loop(this,f,h,p,_,b,w)},this.hitTestGrid=function(f,h,p,_,b,w,C,O,P,A,R,T){return e.hitTestGrid(this,f,h,p,_,b,w,C,O,P,A,R,T)},this.disposeAllChildren=function(){for(var f=this.numChildren-1;f>=0;f--){var h=this.getChildAt(f);h.dispose&&h.dispose()}return this},this.frame=le.zdf,$e&&!$e.stageTransformable&&(le.zdf.retina||typeof exportRoot<"u")&&(Object.defineProperty(this,"scale",{get:function(){return this.cjsStage_scale},set:function(f){this.cjsStage_scaleX=f,this.cjsStage_scaleY=f,e.scaX=$e.stageTransformable?1:f,e.scaY=$e.stageTransformable?1:f}}),Object.defineProperty(this,"scaleX",{get:function(){return this.cjsStage_scaleX},set:function(f){this.cjsStage_scaleX=f,e.scaX=$e.stageTransformable?1:f}}),Object.defineProperty(this,"scaleY",{get:function(){return this.cjsStage_scaleY},set:function(f){this.cjsStage_scaleY=f,e.scaY=$e.stageTransformable?1:f}}),this.localToGlobal=function(f,h){return e.localToGlobal(f,h,this,this.cjsStageGL_localToGlobal)},this.globalToLocal=function(f,h){return e.globalToLocal(f,h,this,this.cjsStageGL_globalToLocal)},this.localToLocal=function(f,h,p){return e.localToLocal(f,h,p,this)}))}},e.extend(e.StageGL,$e.StageGL,["cache","localToLocal","localToGlobal","globalToLocal"],"cjsStageGL",!1),e.Container=function(t,r,i,o,l,f,h){var p="a, b, c, d, style, group, inherit",_;if(_=mt(e.Container,arguments,p,this))return _;e.containerCheck||(qe("50.5"),qe("50.435"),e.containerCheck=!0),this.cjsContainer_constructor(),this.type="Container",this.group=f;var b=this,w=l===!1?{}:e.getStyle(this.type,this.group,h);n(t)&&(t=w.a!=null?w.a:null),n(r)&&(r=w.b!=null?w.b:null),n(i)&&(i=w.c!=null?w.c:null),n(o)&&(o=w.d!=null?w.d:null);var C=O(t,r,i,o);function O(A,R,T,L){var S=[];return n(A)?S=[A,R,T,L]:n(R)?A.x?S=[A.x,A.y,A.width,A.height]:(S[0]=0,S[1]=0,S[2]=A,S[3]=A):n(T)?(S[0]=0,S[1]=0,S[2]=A,S[3]=R):(S[0]=A,S[1]=R,S[2]=T,S[3]=L),n(S[3])&&(S[3]=S[2]),S}n(t)||this.setBounds(C[0],C[1],C[2],C[3]),this.cache=function(A,R,T,L,S,E,k,X,q){if(b.type=="AC"&&le.zdf)return le.zdf.ac("cache",arguments,b),b;var V="a,b,c,d,scale,options,margin,rtl,willReadFrequently",I;if(I=mt(b.cache,arguments,V))return I;var te=b.getBounds();if(n(T))if(n(A)){if(!n(te)){var B=b.borderWidth>0?b.borderWidth/2:0;A=te.x-B,R=te.y-B,T=te.width+B*2,L=te.height+B*2}}else T=A,L=R,A=0,R=0;return b.type=="Triangle"&&(A-=b.borderWidth?b.borderWidth:0,T+=b.borderWidth?b.borderWidth*2:0,R-=b.borderWidth?b.borderWidth:0,L+=b.borderWidth?b.borderWidth*2:0),n(k)&&(k=0),b.cjsContainer_cache(A-k,R-k,T+k*2,L+k*2,S,E,X,q),te&&b.setBounds(te.x,te.y,te.width,te.height),b.z_bc=b.canvas=b.cacheCanvas,b},this.uncache=function(){return b.cjsContainer_uncache(),b},this.childrenToBitmap=function(){var A=this.cacheCanvas,R=new e.Bitmap(this.cache().cacheCanvas);return A||this.uncache(),this.removeAllChildren(),R.addTo(this),this};var P=le.zdf||1;$e&&!$e.stageTransformable&&P.retina&&(this.localToGlobal=function(A,R){return e.localToGlobal(A,R,this,this.cjsContainer_localToGlobal)},this.globalToLocal=function(A,R){return e.globalToLocal(A,R,this,this.cjsContainer_globalToLocal)},this.localToLocal=function(A,R,T){return e.localToLocal(A,R,T,this)}),this.setBounds=function(A,R,T,L){var S=O(A,R,T,L);return b.cjsContainer_setBounds(S[0],S[1],S[2],S[3]),b},this.getBounds=function(A){return A?b.boundsToGlobal(null,null,null,A):b.cjsContainer_getBounds()},this.disposeAllChildren=function(){for(var A=this.numChildren-1;A>=0;A--){var R=this.getChildAt(A);R.dispose&&R.dispose()}return this},e.displayBase(b),l!==!1&&e.styleTransforms(this,w),this.clone=function(A){if(this.type=="AC"&&le.zdf)return Ct&&ht("ZIM asset() - cannot clone lazy-loaded asset - use Frame() assets parameter or loadAssets() method"),le.zdf.ac("clone",arguments,this),this;var R=this.getBounds();return n(R)&&(R={x:null,y:null,width:null,height:null}),this.cloneChildren(this.cloneProps(new e.Container(R.x,R.y,R.width,R.height,l,this.group,h)),A)},this.hasProp=function(A){return!n(this[A])||Object.prototype.hasOwnProperty.call(this,A)}},e.Container.prototype.dispose=function(t){return u(this,t),!0},e.Container.prototype.specialColor=function(t,r,i){if(r.type=="GradientColor"){if(!n(r.angle))if(i.width){var o=i.getBounds();if(r.angle+=360*1e5,r.angle%=360,i.type=="Circle"){var l=o.width/2*Math.cos(r.angle*RAD),f=o.width/2*Math.sin(r.angle*RAD);r.x0=-l,r.y0=-f,r.x1=l,r.y1=f}else{var h=r.angle%90,p=o.width*Math.sin(h*RAD),_=p*Math.sin(h*RAD),b=-p*Math.cos(h*RAD),w=o.height*Math.sin(h*RAD),C=o.width+w*Math.cos(h*RAD),O=w*Math.sin(h*RAD),P=o.height*Math.sin(h*RAD),A=-P*Math.cos(h*RAD),R=o.height-P*Math.sin(h*RAD);r.angle>=0&&r.angle<90?(r.x0=o.x+_,r.y0=o.y+b,r.x1=o.x+C,r.y1=o.y+O):r.angle>=90&&r.angle<180?(r.x0=o.x+_,r.y0=o.y+b,r.x1=o.x+A,r.y1=o.y+R):r.angle>=180&&r.angle<270?(r.x0=o.x+C,r.y0=o.y+O,r.x1=o.x+_,r.y1=o.y+b):(r.x0=o.x+A,r.y0=o.y+R,r.x1=o.x+_,r.y1=o.y+b)}}else{t.style=r.colors[0];return}t.linearGradient(r.colors,r.ratios,r.x0,r.y0,r.x1,r.y1)}else if(r.type=="RadialColor"){if(n(r.x0))if(i.width){var o=i.getBounds();r.r0=0,i.type=="Circle"?(r.x0=0,r.y0=0,r.r1=o.width/2):(r.x0=o.x+o.width/2,r.y0=o.y+o.height/2,r.r1=Math.sqrt(Math.pow(o.width/2,2)+Math.pow(o.height/2,2))),r.x1=r.x0,r.y1=r.y0}else{t.style=r.colors[0];return}t.radialGradient(r.colors,r.ratios,r.x0,r.y0,r.r0,r.x1,r.y1,r.r1)}else r.type=="BitmapColor"&&t.bitmap(r.image,r.repetition,r.matrix)};function u(t,r){if(t&&e.gD(t),!r&&t&&t.dispose&&t.dispose!==e.Container.prototype.dispose&&t.dispose(null,null,!0),t&&t.addChild&&(t.dispatchEvent("removed"),t.removeAllEventListeners(),t.numChildren))for(var i=t.numChildren-1;i>=0;i--)u(t.getChildAt(i));t&&t.parent&&t.parent.removeChild(t)}e.extend(e.Container,$e.Container,["cache","uncache","setBounds","getBounds","clone","localToLocal","localToGlobal","globalToLocal"],"cjsContainer",!1),Wn(e.Container.prototype),e.Shape=function(t,r,i,o,l,f,h,p,_){var b="a, b, c, d, graphics, optimize, style, group, inherit",w;if(w=mt(e.Shape,arguments,b,this))return w;qe("50.6"),this.cjsShape_constructor(l),this.type="Shape",this.group=p;var C=h===!1?{}:e.getStyle(this.type,this.group,_),O=this;n(t)&&(t=C.a!=null?C.a:null),n(r)&&(r=C.b!=null?C.b:null),n(i)&&(i=C.c!=null?C.c:null),n(o)&&(o=C.d!=null?C.d:null),n(l)&&(l=C.graphics!=null?C.graphics:null),n(f)&&(f=C.optimize!=null?C.optimize:!1);var P=A(t,r,i,o);function A(S,E,k,X){var q=[];return n(S)?q=[S,E,k,X]:n(E)?S.x?q=[S.x,S.y,S.width,S.height]:(q[0]=0,q[1]=0,q[2]=S,q[3]=S):n(k)?(q[0]=0,q[1]=0,q[2]=S,q[3]=E):(q[0]=S,q[1]=E,q[2]=k,q[3]=X),n(q[3])&&(q[3]=q[2]),q}if(n(t)||this.setBounds(P[0],P[1],P[2],P[3]),!f)for(var R=["mt","lt","a","at","bt","ct","qt","cp","c","f","lf","rf","bf","ef","ss","sd","s","ls","rs","bs","es","dr","rr","rc","dc","de","dp","pg","p"],T=0;T<R.length;T++)~function(){var S=T;O[R[S]]=function(){return R[S]=="ct"?O.graphics.curveTo.apply(O.graphics,arguments):O.graphics[R[S]].apply(O.graphics,arguments),O}}();Object.defineProperty(O,"command",{get:function(){return O.graphics.command},set:function(){}}),this.cache=function(S,E,k,X,q,V,I,te,B){var Z="a,b,c,d,scale,options,margin,rtl,willReadFrequently",U;if(U=mt(O.cache,arguments,Z))return U;var ee=O.getBounds();if(n(k))if(n(S)){if(!n(ee)){var ae=O.borderWidth>0?O.borderWidth/2:0;S=ee.x-ae,E=ee.y-ae,k=ee.width+ae*2,X=ee.height+ae*2}}else k=S,X=E,S=0,E=0;return n(I)&&(I=0),O.cjsShape_cache(S-I,E-I,k+I*2,X+I*2,q,V,te,B),O.z_bc=O.canvas=O.cacheCanvas,O},this.setBounds=function(S,E,k,X){var q=A(S,E,k,X);return this.cjsShape_setBounds(q[0],q[1],q[2],q[3]),this},this.getBounds=function(S){return S?O.boundsToGlobal(null,null,null,S):O.cjsShape_getBounds()},h!==!1&&e.styleTransforms(this,C),this.clone=function(S){n(S)&&(S=!0);var E=this.getBounds();n(E)&&(E={x:null,y:null,width:null,height:null});var k=O.cloneProps(new e.Shape(E.x,E.y,E.width,E.height,l,h,p,_));return S?k.graphics=O.graphics.clone():k.graphics=O.graphics,k};var L=le.zdf||1;$e&&!$e.stageTransformable&&L.retina&&(this.localToGlobal=function(S,E){return e.localToGlobal(S,E,this,this.cjsShape_localToGlobal)},this.globalToLocal=function(S,E){return e.globalToLocal(S,E,this,this.cjsShape_globalToLocal)},this.localToLocal=function(S,E,k){return e.localToLocal(S,E,k,this)}),this.hasProp=function(S){return!n(this[S])||Object.prototype.hasOwnProperty.call(this,S)},e.displayBase(O),this.dispose=function(){e.gD(this),this.graphics.c(),this.dispatchEvent("removed"),this.removeAllEventListeners(),this.parent&&this.parent.removeChild(this)}},e.extend(e.Shape,$e.Shape,["cache","clone","setBounds","getBounds","localToLocal","localToGlobal","globalToLocal"],"cjsShape",!1),Wn(e.Shape.prototype),e.Bitmap=function(t,r,i,o,l,f,h,p,_){var b="image, width, height, left, top, scale, style, group, inherit",w;if(w=mt(e.Bitmap,arguments,b,this))return w;qe("50.7"),this.group=p;var C=h===!1?{}:e.getStyle("Bitmap",this.group,_);n(f)&&(f=C.scale!=null?C.scale:1),n(r)&&(r=C.width!=null?C.width:t?t.width:100),n(i)&&(i=C.height!=null?C.height:t?t.height:100),n(o)&&(o=C.left!=null?C.left:0),n(l)&&(l=C.top!=null?C.top:0);var O=!1,P=t;if(!n(t)&&t.uncache){O=!0;var A=t.cacheCanvas,R=t;t.cache(o,l,r,i,f),this.z_bc=t=t.cacheCanvas}this.cjsBitmap_constructor(t),R&&!A&&R.uncache();var T=this;this.type="Bitmap",!n(r)&&!n(i)&&this.setBounds(0,0,r,i),this.drawImageData=function(k,X,q,V,I,te){if(n(k)&&(k=0),n(X)&&(X=0),n(q)&&(q=0),n(V)&&(V=0),n(I)&&(I=r),n(te)&&(te=i),!T.proxyCanvas){var B=T.proxyCanvas=document.createElement("canvas");B.setAttribute("width",r),B.setAttribute("height",i),T.proxyContext=B.getContext("2d"),t=P=T.image=B}T.proxyContext&&T.proxyContext.putImageData(T.imageData,k,X,q,V,I,te)},le.zdf&&(le.zdf.canvas.getContext("2d")?this.imageData=le.zdf.canvas.getContext("2d").createImageData(r,i):this.imageData=document.createElement("canvas").getContext("2d").createImageData(r,i),n(t)&&T.drawImageData(),t&&t.match&&t.match(/data:image/i)&&setTimeout(function(){T.stage&&T.stage.update(),setTimeout(function(){T.stage&&T.stage.update()},50)},50)),t&&t.nodeName&&t.nodeName.toLowerCase()!="video"&&(O?T.sourceRect={x:0,y:0,width:r*f,height:i*f}:T.sourceRect={x:o,y:l,width:r,height:i});function L(k,X,q,V){var I=[];return n(k)?I=[k,X,q,V]:n(X)?k.x?I=[k.x,k.y,k.width,k.height]:(I[0]=0,I[1]=0,I[2]=k,I[3]=k):n(q)?(I[0]=0,I[1]=0,I[2]=k,I[3]=X):(I[0]=k,I[1]=X,I[2]=q,I[3]=V),n(I[3])&&(I[3]=I[2]),I}this.setBounds=function(k,X,q,V){var I=L(k,X,q,V);return T.cjsBitmap_setBounds(I[0],I[1],I[2],I[3]),T},this.getBounds=function(k){return k?T.boundsToGlobal(null,null,null,k):T.cjsBitmap_getBounds()},this.cache=function(k,X,q,V,I,te,B,Z){var U="a,b,c,d,scale,options,rtl,willReadFrequently",ee;if(ee=mt(T.cache,arguments,U))return ee;var ae;if(n(q))if(n(k)){if(ae=this.getBounds(),!n(ae)){var re=this.borderWidth>0?this.borderWidth/2:0;k=ae.x-re,X=ae.y-re,q=ae.width+re*2,V=ae.height+re*2}}else q=k,V=X,k=0,X=0;return ae=T.getBounds(),T.cjsBitmap_cache(k,X,q,V,I,te,B,Z),T.setBounds(ae.x,ae.y,ae.width,ae.height),T.z_bc=T.canvas=T.cacheCanvas,T},this.clone=function(){var k=this.cloneProps(new e.Bitmap(P,r,i,o,l,f,h,this.group,_));return k.cloned=!0,k.src=T.src,k.file=T.file,k.image=T.image,k.svg=T.svg,k.item=T.item,k};var S=le.zdf||1;$e&&!$e.stageTransformable&&S.retina&&(this.localToGlobal=function(k,X){return e.localToGlobal(k,X,this,this.cjsBitmap_localToGlobal)},this.globalToLocal=function(k,X){return e.globalToLocal(k,X,this,this.cjsBitmap_globalToLocal)},this.localToLocal=function(k,X,q){return e.localToLocal(k,X,q,this)}),this.hasProp=function(k){return!n(this[k])||Object.prototype.hasOwnProperty.call(this,k)};var E;this.getColorAt=function(k,X,q){E||(T.cache(null,null,null,null,null,null,null,!0),E=T.cacheCanvas.getContext("2d"),T.uncache());var V=E.getImageData(k,X,1,1).data;return V[3]/=255,q?V:"rgba("+V[0]+","+V[1]+","+V[2]+","+V[3]+")"},this.keyOut=function(k,X,q){n(k)&&(k="#389b26"),n(X)&&(X=.1),Array.isArray(k)||(k=[k]),Array.isArray(X)||(X=[X]),!n(q)&&!Array.isArray(q)&&(q=[q]);var V,I,te=[],B=[],Z=[];for(V=0;V<k.length;V++)te[V]=e.convertColor(k[V],"array"),X[V]!=null?B[V]=X[V]*255:B[V]=X[0]*255,q&&(q[V]!=null?(Z[V]=e.convertColor(q[V],"array"),Z[V][3]*=255):(Z[V]=e.convertColor(q[0],"array"),Z[V][3]*=255));T.cacheCanvas&&T.updateCache(),E||(T.cache(null,null,null,null,null,null,null,!0),E=T.cacheCanvas.getContext("2d"));var U=E.getImageData(o,l,r,i),ee=U.data,ae=ee.length/4;if(q)for(V=0;V<ae;V++){var re=ee[V*4+0],he=ee[V*4+1],j=ee[V*4+2];for(I=0;I<k.length;I++)re>te[I][0]-B[I]&&re<te[I][0]+B[I]&&he>te[I][1]-B[I]&&he<te[I][1]+B[I]&&j>te[I][2]-B[I]&&j<te[I][2]+B[I]&&(ee[V*4+0]=Z[I][0],ee[V*4+1]=Z[I][1],ee[V*4+2]=Z[I][2],ee[V*4+3]=Z[I][3])}else for(V=0;V<ae;V++){var re=ee[V*4+0],he=ee[V*4+1],j=ee[V*4+2];for(I=0;I<k.length;I++)re>te[I][0]-B[I]&&re<te[I][0]+B[I]&&he>te[I][1]-B[I]&&he<te[I][1]+B[I]&&j>te[I][2]-B[I]&&j<te[I][2]+B[I]&&(ee[V*4+3]=0)}return E.putImageData(U,l,o),this},e.displayBase(T),h!==!1&&e.styleTransforms(this,C),this.doDispose=function(){e.gD(this),this.dispatchEvent("removed"),this.removeAllEventListeners(),this.cloned||this.id&&(this.stage&&this.stage.frame?S=this.stage.frame:S=le.zdf,S&&S.assets&&S.assets[this.id]&&delete S.assets[this.id],e.assets[this.id]&&delete e.assets[this.id]),this.parent&&this.parent.removeChild(this)}},e.Bitmap.fromData=function(t,r){var i=100,o=100,l=new Image;l.onload=function(){i=l.naturalWidth,o=l.naturalHeight,n(i)&&(i=l.width),n(o)&&(o=l.height);var f=new e.Bitmap(t,i,o);setTimeout(function(){r(f)},50)},l.src=t},e.extend(e.Bitmap,$e.Bitmap,["cache","clone","dispose","setBounds","getBounds","localToLocal","localToGlobal","globalToLocal"],"cjsBitmap",!1),e.Bitmap.prototype.dispose=function(){return this.doDispose()},Wn(e.Bitmap.prototype),e.Sprite=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E){var k="image, cols, rows, count, offsetX, offsetY, spacingX, spacingY, width, height, animations, json, id, globalControl, spriteSheet, label, frame, style, group, inherit",X;if(X=mt(e.Sprite,arguments,k,this))return X;qe("50.8"),this.type="Sprite",this.group=S;var q=L===!1?{}:e.getStyle(this.type,this.group,E),V=this,I;if(n(T)&&(T=q.frame!=null?q.frame:le.zdf),t&&typeof t=="string"&&(t=T.asset(t)),n(C)&&!n(t)){n(r)&&(r=q.cols!=null?q.cols:1),n(i)&&(i=q.rows!=null?q.rows:1),n(o)&&(o=q.count!=null?q.count:r*i),n(l)&&(l=q.offsetX!=null?q.offsetX:0),n(f)&&(f=q.offsetY!=null?q.offsetY:0),n(h)&&(h=q.spacingX!=null?q.spacingX:0),n(p)&&(p=q.spacingY!=null?q.spacingY:0),n(_)&&(_=q.width!=null?q.width:t.width),n(b)&&(b=q.height!=null?q.height:t.height),t.bitmap&&(t=t.bitmap);var te=(_-l+h)/r-h,B=(b-f+p)/i-p,Z=[],U=0;e:for(var ee=0;ee<i;ee++)for(var ae=0;ae<r;ae++){if(++U>o)break e;Z.push([l+ae*(te+h),f+ee*(B+p),te,B])}g(t,Z,w)}else if(A)I=A,w=I.animations;else if(C){var T=V.stage?V.stage.frame:le.zdf;typeof C=="string"&&(C=T.asset(C));var re,he,j;if(C.frames&&!Array.isArray(C.frames)){re=[];for(he in C.frames)j=C.frames[he].frame,re.push([j.x,j.y,j.w,j.h]);C.frames=re}if(C.frames&&!Array.isArray(C.frames[0])){for(re=[],he=0;he<C.frames.length;he++){var j=C.frames[he].frame;re.push([j.x,j.y,j.w,j.h])}C.frames=re}if(!C.images&&C.meta&&C.meta.image&&(C.images=[C.meta.image]),Z=C.frames,w=C.animations,!n(t))g(t,Z,w);else{var G=C.images?C.images[0]:null;if(!G||!G.split)I=new $e.SpriteSheet(C);else{var y=[];e.loop(C.images,function(F){var Ce=F.split("/").pop();T.asset(Ce)&&T.asset(Ce).type!="EmptyAsset"?y.push(T.asset(Ce)):T.asset(F)&&T.asset(F).type!="EmptyAsset"||T.asset(F).type!="EmptyAsset"?y.push(T.asset(F)):Ct&&ht("Sprite() - please preload Sprite in Frame or with loadAssets")}),g(y,Z,w)}}}else return;function g(m,F,Ce){Array.isArray(m)||(m=[m]),e.loop(m,function(Q,ce){m[ce]=Q.image});var Y={images:m,frames:F,animations:Ce||[]};I=new $e.SpriteSheet(Y)}this.animations=w,this.cjsSprite_constructor(I,R),n(R)||this.stop(),n(O)&&(O=e.makeID()),this.id=O,n(P)&&(P=!0),V.globalControl=P;var d=0,D;this.parseFrames=function(m,F,Ce,Y){var Q=[],ce=Number.MAX_VALUE,pe=0;if(n(m))n(F)&&(F=0),n(Ce)&&(Ce=V.totalFrames-1),se(F,Ce);else{if(n(V.animations)||n(V.animations[m]))return[];var J=V.animations[m];ue(J)}function ue(Be){Array.isArray(Be)?ye(Be):Be.constructor=={}.constructor?Xe(Be):isNaN(Be)||Q.push({f:Math.floor(Be),s:1})}function ye(Be){se(Be[0],Be[1],Be[3]),Be[2]&&!n(V.animations[Be[2]])&&ue(V.animations[Be[2]])}function Xe(Be){if(!n(Be.frames)){n(Be.speed)&&(Be.speed=1);for(var me=0;me<Be.frames.length;me++)Be.speed<ce&&(ce=Be.speed),Be.speed>pe&&(pe=Be.speed),Q.push({f:Be.frames[me],s:Be.speed});Be.next&&!n(V.animations[Be.next])&&ue(V.animations[Be.next])}}function se(Be,me,Oe){n(Oe)&&(Oe=1);var Ye;if(me>Be)for(Ye=Be;Ye<=me;Ye++)de(Ye);else for(Ye=me;Ye<=Be;Ye++)de(Be-(Ye-me));function de(ve){Oe<ce&&(ce=Oe),Oe>pe&&(pe=Oe),Q.push({f:ve,s:Oe})}}if(Y)return Q;ce=e.constrain(e.decimals(ce),.1),pe=e.constrain(e.decimals(pe),.1);for(var Ae=[],ie=ce!=pe,_e,$=0;$<Q.length;$++)if(_e=Q[$],ie)for(var xe=0;xe<e.constrain(Math.round(ce<1?_e.s/ce:_e.s),.1);xe++)Ae.push(_e.f);else Ae.push(_e.f);return Ae},this.run=function(m,F,Ce,Y,Q,ce,pe,J,ue,ye,Xe,se,Ae,ie,_e,$,xe,Be,me,Oe,Ye,de,ve,Me,we,Fe,ge,Ve,He){var Le="time, label, call, params, wait, waitedCall, waitedParams, loop, loopCount, loopWait, loopCall, loopParams, loopWaitCall, loopWaitParams, loopPick, rewind, rewindWait, rewindCall, rewindParams, rewindWaitCall, rewindWaitParams, rewindTime, rewindEase, startFrame, endFrame, tweek, id, globalControl, pauseOnBlur",fe;if(fe=mt(V.run,arguments,Le))return fe;var Ge=v(),Qe;n(Fe)&&(Fe=1),n(ge)||(V.id=ge),n(Ve)||(V.globalControl=Ve);var Ke;if(Array.isArray(F)){var st,yt;Qe=[],Ke=0;for(var We,at=0;at<F.length;at++){st=F[at],st.lookup=V.parseFrames(st.label,st.startFrame,st.endFrame),at==0&&(We=st.lookup[0]),delete st.startFrame,delete st.endFrame,st.obj=e.merge(st.obj,{normalizedFrame:st.lookup.length-1}),st.set=e.merge(st.set,{normalizedFrames:{noPick:st.lookup},normalizedFrame:0}),n(st.wait)&&(st.wait=Ke*Fe),yt=st.label,delete st.label,Qe.push(st),Ke=0;var ct=n(st.time)?m:st.time;we-Me>0&&(Ke=ct/(we-Me)/2)}if(Qe.length==0)return this;Qe.length==1?(m=Qe[0].time,F=yt,Pe()):V.gotoAndStop(We)}else Pe();function Pe(){D=V.parseFrames(F,Me,we),d=0,V.gotoAndStop(D[d]),Me=we=null,Qe={normalizedFrame:D.length-1}}n(m)&&(m=Ge=="s"?1:1e3),V.running&&V.stopAnimate(V.id),V.running=!0,Array.isArray(Qe)||(Ke=0,we-Me>0&&(Ke=m/Math.abs(we-Me)/2),D&&D.length>0&&(Ke=m/D.length/2),!n(J)&&n(ye)&&(ye=Ke*Fe),!n($)&&n(xe)&&(xe=Ke*Fe));var Ie=function(){V.running=!1,V.stop(),Ce&&typeof Ce=="function"&&Ce(Y||V)};return e.animate({target:V,obj:Qe,time:m,ease:"linear",call:Ie,params:Y,wait:Q,waitedCall:ce,waitedParams:pe,loop:J,loopCount:ue,loopWait:ye,loopCall:Xe,loopParams:se,loopWaitCall:Ae,loopWaitParams:ie,rewind:$,rewindWait:xe,rewindCall:Be,rewindParams:me,rewindWaitCall:Oe,rewindWaitParams:Ye,rewindTime:de,rewindEase:ve,override:!1,pauseOnBlur:He,id:V.id}),V.runPaused=!1,V},this.runPaused=!0,this.pauseRun=function(m){return n(m)&&(m=!0),V.runPaused=m,V.globalControl?e.pauseAnimate(m,V.id):V.pauseAnimate(m,V.id),V},this.stopRun=function(){return V.runPaused=!0,V.running=!1,V.globalControl?e.stopAnimate(V.id):V.stopAnimate(V.id),V},Object.defineProperty(this,"frame",{get:function(){return this.currentFrame},set:function(m){m=Math.round(m),this.paused?this.gotoAndStop(m):this.gotoAndPlay(m)}}),Object.defineProperty(this,"normalizedFrame",{get:function(){return d},set:function(m){d=Math.round(m),this.gotoAndStop(D[d])}}),Object.defineProperty(this,"normalizedFrames",{get:function(){return D},set:function(m){D=m}}),Object.defineProperty(this,"totalFrames",{get:function(){return I.getNumFrames()},set:function(){ht("zim.Sprite - totalFrames is read only")}}),L!==!1&&e.styleTransforms(this,q),this.clone=function(){var m=this.cloneProps(new e.Sprite(t,r,i,o,l,f,h,p,_,b,w,C,null,P,A,R,T,L,this.group,E));return V.frame>=0&&m.run({startFrame:V.frame,endFrame:V.frame}),m},$e&&!$e.stageTransformable&&T.retina&&(this.localToGlobal=function(m,F){return e.localToGlobal(m,F,this,this.cjsSprite_localToGlobal)},this.globalToLocal=function(m,F){return e.globalToLocal(m,F,this,this.cjsSprite_globalToLocal)},this.localToLocal=function(m,F,Ce){return e.localToLocal(m,F,Ce,this)}),this.hasProp=function(m){return!n(this[m])||Object.prototype.hasOwnProperty.call(this,m)},e.displayBase(V);function K(m,F,Ce,Y){var Q=[];return n(m)?Q=[m,F,Ce,Y]:n(F)?m.x?Q=[m.x,m.y,m.width,m.height]:(Q[0]=0,Q[1]=0,Q[2]=m,Q[3]=m):n(Ce)?(Q[0]=0,Q[1]=0,Q[2]=m,Q[3]=F):(Q[0]=m,Q[1]=F,Q[2]=Ce,Q[3]=Y),n(Q[3])&&(Q[3]=Q[2]),Q}this.setBounds=function(m,F,Ce,Y){var Q=K(m,F,Ce,Y);return V.cjsSprite_setBounds(Q[0],Q[1],Q[2],Q[3]),V},this.getBounds=function(m){return m?V.boundsToGlobal(null,null,null,m):V.cjsSprite_getBounds()},this.dispose=function(){e.gD(this),this.dispatchEvent("removed"),this.removeAllEventListeners(),this.parent&&this.parent.removeChild(this)}},e.extend(e.Sprite,$e.Sprite,["clone","setBounds","getBounds","localToLocal","localToGlobal","globalToLocal"],"cjsSprite",!1),Wn(e.Sprite.prototype),e.MovieClip=function(t,r,i,o,l,f,h){var p="mode, startPosition, loop, labels, style, group, inherit",_;if(_=mt(e.MovieClip,arguments,p,this))return _;qe("50.9"),this.type="MovieClip",this.group=f;var b=l===!1?{}:e.getStyle(this.type,this.group,h);n(t)&&(t=b.mode!=null?b.mode:null),n(r)&&(r=b.startPosition!=null?b.startPosition:null),n(i)&&(i=b.loop!=null?b.loop:null),n(o)&&(o=b.labels!=null?b.labels:null),this.cjsMovieClip_constructor(t,r,i,o),l!==!1&&e.styleTransforms(this,b),this.clone=function(){return this.cloneProps(new e.MovieClip(t,r,i,o,l,this.group,h))},this.hasProp=function(O){return!n(this[O])||Object.prototype.hasOwnProperty.call(this,O)};var w=le.zdf||1;$e&&!$e.stageTransformable&&w.retina&&(this.localToGlobal=function(O,P){return e.localToGlobal(O,P,this,this.cjsMovieClip_localToGlobal)},this.globalToLocal=function(O,P){return e.globalToLocal(O,P,this,this.cjsMovieClip_globalToLocal)},this.localToLocal=function(O,P,A){return e.localToLocal(O,P,A,this)}),e.displayBase(this);function C(O,P,A,R){var T=[];return n(O)?T=[O,P,A,R]:n(P)?O.x?T=[O.x,O.y,O.width,O.height]:(T[0]=0,T[1]=0,T[2]=O,T[3]=O):n(A)?(T[0]=0,T[1]=0,T[2]=O,T[3]=P):(T[0]=O,T[1]=P,T[2]=A,T[3]=R),n(T[3])&&(T[3]=T[2]),T}this.setBounds=function(O,P,A,R){var T=C(O,P,A,R);return that.cjsMovieClip_setBounds(T[0],T[1],T[2],T[3]),that},this.getBounds=function(O){return O?that.boundsToGlobal(null,null,null,O):that.cjsMovieClip_getBounds()},this.dispose=function(){e.gD(this),this.dispatchEvent("removed"),this.removeAllEventListeners(),this.parent&&this.parent.removeChild(this)}},e.extend(e.MovieClip,$e.MovieClip,["clone","setBounds","getBounds","localToLocal","localToGlobal","globalToLocal"],"cjsMovieClip",!1),Wn(e.MovieClip.prototype),e.SVGContainer=function(t,r,i,o,l,f,h,p){var _="svg, splitTypes, geometric, showControls, interactive, style, group, inherit",b;if(b=mt(e.SVGContainer,arguments,_,this))return b;qe("50.95"),this.group=h;var w=f===!1?{}:e.getStyle("SVGContainer",this.group,p);t&&t.type=="Bitmap"&&(t=t.svg);var C=this,O=new e.Point(0,0),P;function A(){function K(Xe,se){return Q(Xe)||Y(Xe,se)||F(Xe,se)||m()}function m(){throw new TypeError("Invalid")}function F(Xe,se){if(Xe){if(typeof Xe=="string")return Ce(Xe,se);var Ae=Object.prototype.toString.call(Xe).slice(8,-1);if(Ae==="Object"&&Xe.constructor&&(Ae=Xe.constructor.name),Ae==="Map"||Ae==="Set")return Array.from(Xe);if(Ae==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Ae))return Ce(Xe,se)}}function Ce(Xe,se){(se==null||se>Xe.length)&&(se=Xe.length);for(var Ae=0,ie=new Array(se);Ae<se;Ae++)ie[Ae]=Xe[Ae];return ie}function Y(Xe,se){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(Xe)))){var Ae=[],ie=!0,_e=!1,$=void 0;try{for(var xe=Xe[Symbol.iterator](),Be;!(ie=(Be=xe.next()).done)&&(Ae.push(Be.value),!(se&&Ae.length===se));ie=!0);}catch(me){_e=!0,$=me}finally{try{!ie&&xe.return!=null&&xe.return()}finally{if(_e)throw $}}return Ae}}function Q(Xe){if(Array.isArray(Xe))return Xe}var ce=Math.PI*2,pe=function(se,Ae,ie,_e,$,xe,Be){var me=se.x,Oe=se.y;me*=Ae,Oe*=ie;var Ye=_e*me-$*Oe,de=$*me+_e*Oe;return{x:Ye+xe,y:de+Be}},J=function(se,Ae){var ie=Ae===1.5707963267948966?.551915024494:Ae===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(Ae/4),_e=Math.cos(se),$=Math.sin(se),xe=Math.cos(se+Ae),Be=Math.sin(se+Ae);return[{x:_e-$*ie,y:$+_e*ie},{x:xe+Be*ie,y:Be-xe*ie},{x:xe,y:Be}]},ue=function(se,Ae,ie,_e){var $=se*_e-Ae*ie<0?-1:1,xe=se*ie+Ae*_e;return xe>1&&(xe=1),xe<-1&&(xe=-1),$*Math.acos(xe)},ye=function(se,Ae,ie,_e,$,xe,Be,me,Oe,Ye,de,ve){var Me=Math.pow($,2),we=Math.pow(xe,2),Fe=Math.pow(de,2),ge=Math.pow(ve,2),Ve=Me*we-Me*ge-we*Fe;Ve<0&&(Ve=0),Ve/=Me*ge+we*Fe,Ve=Math.sqrt(Ve)*(Be===me?-1:1);var He=Ve*$/xe*ve,Le=Ve*-xe/$*de,fe=Ye*He-Oe*Le+(se+ie)/2,Ge=Oe*He+Ye*Le+(Ae+_e)/2,Qe=(de-He)/$,Ke=(ve-Le)/xe,st=(-de-He)/$,yt=(-ve-Le)/xe,We=ue(1,0,Qe,Ke),at=ue(Qe,Ke,st,yt);return me===0&&at>0&&(at-=ce),me===1&&at<0&&(at+=ce),[fe,Ge,We,at]};return function(se){var Ae=se.px,ie=se.py,_e=se.cx,$=se.cy,xe=se.rx,Be=se.ry,me=se.xAxisRotation,Oe=me===void 0?0:me,Ye=se.largeArcFlag,de=Ye===void 0?0:Ye,ve=se.sweepFlag,Me=ve===void 0?0:ve,we=[];if(xe===0||Be===0)return[];var Fe=Math.sin(Oe*ce/360),ge=Math.cos(Oe*ce/360),Ve=ge*(Ae-_e)/2+Fe*(ie-$)/2,He=-Fe*(Ae-_e)/2+ge*(ie-$)/2;if(Ve===0&&He===0)return[];xe=Math.abs(xe),Be=Math.abs(Be);var Le=Math.pow(Ve,2)/Math.pow(xe,2)+Math.pow(He,2)/Math.pow(Be,2);Le>1&&(xe*=Math.sqrt(Le),Be*=Math.sqrt(Le));var fe=ye(Ae,ie,_e,$,xe,Be,de,Me,Fe,ge,Ve,He),Ge=K(fe,4),Qe=Ge[0],Ke=Ge[1],st=Ge[2],yt=Ge[3],We=Math.abs(yt)/(ce/4);Math.abs(1-We)<1e-7&&(We=1);var at=Math.max(Math.ceil(We),1);yt/=at;for(var ct=0;ct<at;ct++)we.push(J(st,yt)),st+=yt;return we.map(function(Pe){var Ie=pe(Pe[0],xe,Be,ge,Fe,Qe,Ke),be=Ie.x,ze=Ie.y,it=pe(Pe[1],xe,Be,ge,Fe,Qe,Ke),je=it.x,tt=it.y,Te=pe(Pe[2],xe,Be,ge,Fe,Qe,Ke),et=Te.x,Ue=Te.y;return{x1:be,y1:ze,x2:je,y2:tt,x:et,y:Ue}})}}n(r)&&(r=!1),n(i)&&(i=!0);var R,T;function L(K){e.loop(K,function(m){var F=m.tagName.toLowerCase();if(F=="path"&&D(m),F=="circle"&&E("circle",m),F=="rect"&&E("rect",m),F=="ellipse"&&E("ellipse",m),F=="line"&&E("line",m),F=="polygon"&&E("polygon",m),F=="polyline"&&E("polyline",m),F=="g"){var Ce=m.getAttribute("style"),Y,Q,ce,pe,J;if(Ce){var ue=S(Ce);Y=ue[0],Q=ue[1],ce=ue[2],pe=ue[3],J=ue[4]}y=m.getAttribute("transform"),B=m.getAttribute("fill")?m.getAttribute("fill"):n(Y)?te:Y,U=m.getAttribute("stroke")?m.getAttribute("stroke"):n(Q)?Z:Q,ae=m.getAttribute("stroke-width")?m.getAttribute("stroke-width"):n(ce)?ee:ce,he=m.getAttribute("fill-opacity")?m.getAttribute("fill-opacity"):n(pe)?re:pe,G=m.getAttribute("stroke-opacity")?m.getAttribute("stroke-opacity"):n(J)?j:J}L(m.children),m.tagName.toLowerCase()=="g"&&(B=te,U=Z,ae=ee,he=re,G=j,y=null)})}function S(K){var m=K.split(";"),F,Ce,Y,Q,ce;return e.loop(m,function(pe){pe=pe.replace(/,/g,"");var J=pe.split(":"),ue=J[0].trim().toLowerCase(),ye=J[1].trim().toLowerCase().replace("px","");ue=="fill"&&(F=ye),ue=="stroke"&&(Ce=ye),ue=="stroke-width"&&(Y=ye),ue=="opacity"&&(Q=ye,ce=ye),ue=="fill-opacity"&&(Q=ye),ue=="stroke-opacity"&&(ce=ye)}),[F,Ce,Y,Q,ce]}function E(K,m){var F,Ce=d(m),Y=Ce[0],Q=Ce[1],ce=Ce[2],pe=Ce[5],J=Ce[6];if(K=="circle"){var ue=Number(m.getAttribute("r").trim()),ye=ue*.5523;i?F=new e.Circle(Number(m.getAttribute("r")),Y,Q,ce):F=new e.Blob(Y,Q,ce,4,ue,ye,"mirror",null,o,null,null,null,null,null,null,null,null,null,null,null,null,null,l)}else if(K=="rect")if(i)F=new e.Rectangle(Number(m.getAttribute("width")),Number(m.getAttribute("height")),Y,Q,ce,Number(m.getAttribute("rx")));else{var Xe=Number(m.getAttribute("width")),se=Number(m.getAttribute("height")),Ae=Number(m.getAttribute("rx")),ie=Number(m.getAttribute("ry"));if(Ae&&ie){var _e=Ae*.5523,$=ie*.5523;F=new e.Blob(Y,Q,ce,[[Ae,0,0,0,-_e,0,0,0,"free"],[Xe-Ae,0,0,0,0,0,_e,0,"free"],[Xe,ie,0,0,0,-$,0,0,"free"],[Xe,se-ie,0,0,0,0,0,$,"free"],[Xe-Ae,se,0,0,_e,0,0,0,"free"],[Ae,se,0,0,0,0,-_e,0,"free"],[0,se-ie,0,0,0,$,0,0,"free"],[0,ie,0,0,0,0,0,-$,"free"]],null,null,null,null,o,null,null,null,null,null,null,null,null,null,null,null,null,null,l)}else F=new e.Blob(Y,Q,ce,[[0,0],[Xe,0],[Xe,se],[0,se]],null,null,null,null,o,null,null,null,null,null,null,null,null,null,null,null,null,null,l)}else if(K=="line")F=new e.Squiggle(Q,ce,[[Number(m.getAttribute("x1")),Number(m.getAttribute("y1"))],[Number(m.getAttribute("x2")),Number(m.getAttribute("y2"))]],null,null,null,null,o,null,null,null,null,null,null,null,null,null,null,null,null,null,l);else if(K=="polygon"||K=="polyline"){var xe=m.getAttribute("points");xe=xe.replace(/-/g," -"),xe=xe.replace(/\s+/g," ");var Be=[];if(xe.indexOf(",")!=-1)e.loop(xe.split(" "),function(Ye){var de=Ye.split(",");Be.push([Number(de[0].trim()),Number(de[1].trim())])});else{var me;e.loop(xe.split(" "),function(Ye,de){(de+1)%2==0&&Be.push([me,Ye.trim()]),me=Ye.trim()})}K=="polygon"?F=new Blob(Y,Q,ce,Be):F=new e.Squiggle(Q,ce,Be,null,null,null,null,o,null,null,null,null,null,null,null,null,null,null,null,null,null,l)}else K=="ellipse"&&(F=new e.Blob(Y,Q,ce,X(0,0,Number(m.getAttribute("rx")),Number(m.getAttribute("ry"))),null,null,null,null,o,null,null,null,null,null,null,null,null,null,null,null,null,null,l));F.loc(pe,J,C);var Oe=m.getAttribute("transform");(Oe||y)&&k(F,Oe||y),l&&(F.type=="Rectangle"||F.type=="Circle")&&F.transform({showReg:!1,visible:o})}function k(K,m){var F=m.split(")");e.loop(F,function(Ce){if(Ce!=""){var Y=Ce.trim().split("("),Q=Y[0].trim().toLowerCase(),ce=Y[1].trim().toLowerCase().replace("px","").replace("deg","");if(Q=="translate"){var pe=ce.split(",");K.mov(Number(pe[0].trim()),pe[1]?Number(pe[1].trim()):0)}if(Q=="scale"){var J=ce.split(",");K.type=="Blob"||K.type=="Squiggle"?J.length==1?K.transformPoints("scale",Number(J[0].trim())):J.length==2&&(K.transformPoints("scaleX",Number(J[0].trim())),K.transformPoints("scaleY",Number(J[1].trim()))):J.length==1?K.sca(Number(J[0].trim())):J.length==2&&K.sca(Number(J[0].trim()),Number(J[1].trim()))}if(Q=="rotate"){var ue=ce.split(",");ue.length==1?ue.push(0,0):ue.length==2&&ue.push(0),K.rot(Number(ue[0].trim()),Number(ue[1].trim()),Number(ue[2].trim()))}Q=="skewX"&&(K.skewX=ce),Q=="skewY"&&(K.skewY=ce)}})}function X(K,m,F,Ce){var Y=.5522848,Q=F*Y,ce=Ce*Y,pe=K+F,J=m+Ce,ue=[[K-F,m,0,0,K,J+ce-Ce,K,m-ce,"mirror"],[K,m-Ce,0,0,K-Q,m,pe+Q-F,m,"mirror"],[pe,m,0,0,K,m-ce,K+Q-Q,J+ce-Ce,"mirror"],[K,J,0,0,pe-F+Q,m,K-Q,m,"mirror"]];return ue}if(!n(t)){if(t.replace&&(t=t.replace(/style\s?=[^"]*"[^"]*"/ig,"")),n(t.draggable))t.getAttribute||(R=new DOMParser,t=R.parseFromString(t,"image/svg+xml").documentElement),T=this.svg=t;else{R=new DOMParser,t=t.innerHTML?R.parseFromString(t.innerHTML,"text/xml"):t;var q=t.getElementsByTagName("svg");T=this.svg=q?t.getElementsByTagName("svg")[0]:null}var V,I;if(n(T)||(V=T.getAttribute("width"),I=T.getAttribute("height")),V&&(V=Number(V.trim())),I&&(I=Number(I.trim())),this.zimContainer_constructor(V,I),this.type="SVGContainer",n(T))return;var te=e.black,B=e.black,Z=e.black,U=e.black,ee=2,ae=2,re=1,he=1,j=1,G=1,y,g=t.getElementsByTagName("svg");g.length==0&&(g=[t]),L(g)}function d(K){var m,F,Ce,Y,Q,ce=K.getAttribute("style");if(ce){var pe=S(ce);m=pe[0],F=pe[1],Ce=pe[2],Y=pe[3],Q=pe[4]}m=K.getAttribute("fill")?K.getAttribute("fill"):n(m)?B:m,F=K.getAttribute("stroke")?K.getAttribute("stroke"):n(F)?U:F,Ce=K.getAttribute("stroke-width")?K.getAttribute("stroke-width"):n(Ce)?ae:Ce,Y=K.getAttribute("fill-opacity")?K.getAttribute("fill-opacity"):n(Y)?he:Y,Q=K.getAttribute("stroke-opacity")?K.getAttribute("stroke-opacity"):n(Q)?G:Q;var J=K.getAttribute("x")?K.getAttribute("x"):0;J=K.getAttribute("cx")?K.getAttribute("cx"):J;var ue=K.getAttribute("y")?K.getAttribute("y"):0;return ue=K.getAttribute("cy")?K.getAttribute("cy"):ue,!n(Y)&&!n(m)&&(m=e.convertColor(m,"rgba",Number(Y))),!n(Q)&&!n(F)&&(F=e.convertColor(F,"rgba",Number(Q))),[m,F,Number(Ce),Number(Y),Number(Q),Number(J),Number(ue)]}function D(K,m){n(m)&&(m=!0);var F=["M","m","L","l","H","h","V","v","C","c","S","s","Q","q","T","t","A","a","z","Z"],Ce=["m","l","h","v","c","s","q","t","a","z"],Y=new e.Point(0,0),Q;if(n(K.getAttribute)?Q=K:Q=K.getAttribute("d"),Q=Q.replace(/,/g," "),Q=Q.replace(/([a-zA-Z])/g," $1 "),Q=Q.replace(/-/g," -"),Q=Q.replace(/\s+/g," "),Q=Q.replace(/\.(\d*)\./g,".$1 ."),m)var ce=d(K),pe=ce[0],J=ce[1],ue=ce[2];var ye,Xe,se=[],Ae=[0,0],ie=new e.Point(0,0),_e=new e.Point(0,0,0,0),$=new e.Point(0,0,0,0,0,0),xe=new e.Point(0,0,0,0,0,0,0),Be=Q.split(" "),me=Be.slice(1,Be.length),Oe=[],Ye=!1,de,ve,Me=!1,we,Fe="squiggle",ge=null;e.loop(me,function(He,Le){if(Le==0&&(O.x=0,O.y=0,Ae=[0,0],de="",ve=""),F.indexOf(He)==-1){we=="lxo"&&(we="lx",Oe.push("l"),Ye=!0),we=="lyo"&&(we="ly",Ye=!0),we=="Lxo"&&(we="Lx",Oe.push("L"),Ye=!0),we=="Lyo"&&(we="Ly",Ye=!0),Xe=Number(He),Xe=Math.round(Xe*100)/100,we=="X"?(O.x=Xe,we="Y"):we=="Y"?(O.y=Xe,we="Lxo",se.push([O.x,O.y])):we=="x"?(O.x=O.x+Xe,we="y"):we=="y"&&(O.y=O.y+Xe,we="lxo",se.push([O.x,O.y])),we=="H"||we=="h"?(Y.x=se[se.length-1][0],Y.y=se[se.length-1][1],Y.x=Y.x+(we=="h"?Xe:Xe-O.x),se.push([Y.x,Y.y]),we="Lx"):(we=="V"||we=="v")&&(Y.x=se[se.length-1][0],Y.y=se[se.length-1][1],Y.y=Y.y+(we=="v"?Xe:Xe-O.y),se.push([Y.x,Y.y]),we="lx"),we=="Lx"?(ie.x=Xe,we="Ly"):we=="Ly"?(ie.y=Xe,Y.x=ie.x,Y.y=ie.y,se.push([Y.x,Y.y]),we="Lx"):we=="lx"?(Oe.length>0&&(Y.x!=0&&Y.y!=0?(O.x=Y.x,O.y=Y.y):(O.x=Y.x+O.x,O.y=Y.y+O.y)),ie.x=O.x+Xe,Ye?we="lyo":we="ly"):we=="ly"&&(ie.y=O.y+Xe,Y.x=ie.x,Y.y=ie.y,se.push([Y.x,Y.y]),we="lx");var fe;if(we=="qx"||we=="Qx"?(se.length>0?(O.x=se[se.length-1][0],O.y=se[se.length-1][1]):(O.x=0,O.y=0),_e.x=we=="qx"?O.x+Xe:Xe,we=we=="qx"?"qy":"Qy"):we=="qy"||we=="Qy"?(_e.y=we=="qy"?O.y+Xe:Xe,we=we=="qy"?"qz":"Qz",Me&&(Me=!1,fe=se[se.length-1],fe[6]=-fe[4],fe[7]=-fe[5],fe[8]="mirror",Y.x=_e.x,Y.y=_e.y,se[se.length]=[Y.x,Y.y,0,0,-fe[6],fe[7],0,0,"free"],we=we=="qy"?"qx":"Qx")):we=="qz"||we=="Qz"?(_e.z=we=="qz"?O.x+Xe:Xe,we=we=="qz"?"qq":"Qq"):(we=="qq"||we=="Qq")&&(_e.w=we=="qq"?O.y+Xe:Xe,fe=se[se.length-1],Y.x=fe[0],Y.y=fe[1],se.length==1?(fe[2]=0,fe[3]=0,fe[4]=0,fe[5]=0,fe[6]=2/3*(_e.x-Y.x),fe[7]=2/3*(_e.y-Y.y),fe[8]="free"):se[se.length]=[Y.x,Y.y,0,0,0,0,2/3*(_e.x-Y.x),2/3*(_e.y-Y.y),"free"],Y.x=_e.z,Y.y=_e.w,se[se.length]=[Y.x,Y.y,0,0,2/3*(_e.x-Y.x),2/3*(_e.y-Y.y),0,0,"free"],we=we=="qq"?"qx":"Qx"),we=="cx"||we=="Cx")se.length>0?(O.x=se[se.length-1][0],O.y=se[se.length-1][1]):(O.x=0,O.y=0),$.x=we=="cx"?O.x+Xe:Xe,we=we=="cx"?"cy":"Cy";else if(we=="cy"||we=="Cy")$.y=we=="cy"?O.y+Xe:Xe,we=we=="cy"?"cz":"Cz";else if(we=="cz"||we=="Cz")$.z=we=="cz"?O.x+Xe:Xe,we=we=="cz"?"cq":"Cq";else if(we=="cq"||we=="Cq")$.q=we=="cq"?O.y+Xe:Xe,we=we=="cq"?"cr":"Cr",Me&&(de=="s"?ve="s":ve="S",fe=se[se.length-1],fe[2]=0,fe[3]=0,n(fe[4])&&(fe[4]=0),n(fe[5])&&(fe[5]=0),fe[6]=-fe[4],fe[7]=-fe[5],fe[8]="mirror",Y.x=$.z,Y.y=$.q,se[se.length]=[Y.x,Y.y,0,0,$.x-Y.x,$.y-Y.y,0,0,"free"],we=we=="cr"?"cx":"Cx");else if(we=="cr"||we=="Cr")$.r=we=="cr"?O.x+Xe:Xe,we=we=="cr"?"cs":"Cs";else if(we=="cs"||we=="Cs")$.s=we=="cs"?O.y+Xe:Xe,fe=se[se.length-1],se.length==1&&(fe[2]=0,fe[3]=0,fe[4]=0,fe[5]=0),fe[6]=$.x-fe[0],fe[7]=$.y-fe[1],fe[8]="free",Y.x=$.r,Y.y=$.s,se[se.length]=[Y.x,Y.y,0,0,$.z-Y.x,$.q-Y.y,0,0,"free"],we=we=="cs"?"cx":"Cx";else if(we=="ax"||we=="Ax")se.length>0?(O.x=se[se.length-1][0],O.y=se[se.length-1][1]):(O.x=0,O.y=0),xe.x=Xe,we=we=="ax"?"ay":"Ay";else if(we=="ay"||we=="Ay")xe.y=Xe,we=we=="ay"?"az":"Az";else if(we=="az"||we=="Az")xe.z=Xe,we=we=="az"?"aq":"Aq";else if(we=="aq"||we=="Aq")xe.q=Xe,we=we=="aq"?"ar":"Ar";else if(we=="ar"||we=="Ar")xe.r=Xe,we=we=="ar"?"as":"As";else if(we=="as"||we=="As")xe.s=we=="as"?O.x+Xe:Xe,we=we=="as"?"at":"At";else if(we=="at"||we=="At"){xe.t=we=="at"?O.y+Xe:Xe,P||(P=A());var Ge=P({px:O.x,py:O.y,cx:xe.s,cy:xe.t,rx:xe.x,ry:xe.y,xAxisRotation:xe.z,largeArcFlag:xe.q,sweepFlag:xe.r});e.loop(Ge,function(Qe,Ke){fe=se[se.length-1],se.length==1&&(fe[2]=0,fe[3]=0,fe[4]=0,fe[5]=0),Ke==0&&se.length==1?(fe[6]=Qe.x1-Y.x-O.x,fe[7]=Qe.y1-Y.y-O.y):(fe[6]=Qe.x1-Y.x,fe[7]=Qe.y1-Y.y),fe[8]="free",Y.x=Qe.x,Y.y=Qe.y,se[se.length]=[Y.x,Y.y,0,0,Qe.x2-Y.x,Qe.y2-Y.y,0,0,"free"]}),we=we=="at"?"ax":"Ax"}}else Oe.push(He),He!="s"&&(Me=!1),Oe.length>1&&(He=="M"||He=="m")&&(Ve(Oe),He=="M"?(O.x=0,O.y=0):(O.x=se[se.length-1][0],O.y=se[se.length-1][1]),se=[],Oe=[],Oe.push(He)),He=="M"?we="X":He=="m"?we="x":He=="L"?(we="Lx",r&&ge&&ge!="l"&&Ve(Oe),ge="l"):He=="l"?(we="lx",r&&ge&&ge!="l"&&Ve(Oe),ge="l"):He=="H"?(we="H",r&&ge&&ge!="l"&&Ve(Oe),ge="l"):He=="h"?(we="h",r&&ge&&ge!="l"&&Ve(Oe),ge="l"):He=="V"?(we="V",r&&ge&&ge!="l"&&Ve(Oe),ge="l"):He=="v"?(we="v",r&&ge&&ge!="l"&&Ve(Oe),ge="l"):He=="C"?(we="Cx",r&&ge&&ge!="c"&&Ve(Oe),ge="c"):He=="c"?(we="cx",r&&ge&&ge!="c"&&Ve(Oe),ge="c"):He=="S"?(Me=!0,we="Cx",r&&ge&&ge!="c"&&Ve(Oe),ge="c"):He=="s"?(Me=!0,we="cx",r&&ge&&ge!="c"&&Ve(Oe),ge="c"):He=="Q"?(we="Qx",r&&ge&&ge!="q"&&Ve(Oe),ge="q"):He=="q"?(we="qx",r&&ge&&ge!="q"&&Ve(Oe),ge="q"):He=="T"?(Me=!0,we="Qx",r&&ge&&ge!="q"&&Ve(Oe),ge="q"):He=="t"?(Me=!0,we="qx",r&&ge&&ge!="q"&&Ve(Oe),ge="q"):He=="A"?(we="Ax",r&&ge&&ge!="a"&&Ve(),ge="a"):He=="a"?(we="ax",r&&ge&&ge!="a"&&Ve(),ge="a"):(He=="z"||He=="Z")&&(Fe="blob")});function Ve(){de=Oe[Oe.length-1],se.length>=2&&(de=="z"||de=="Z")&&(Fe="blob"),Fe=="squiggle"?ye=new e.Squiggle(J,ue,se,null,null,null,null,o,null,null,null,null,null,null,null,null,null,null,null,null,null,l):ye=new e.Blob(pe,J,ue,se,null,null,null,null,o,null,null,null,null,null,null,null,null,null,null,null,null,null,l),ye.loc(0,0,C),de=Oe[Oe.length-1],ve=Oe[Oe.length-2],Ce.indexOf(de)>=0?(Ae[0]=se[se.length-1][0],Ae[1]=se[se.length-1][1],O.x=se[se.length-1][0],O.y=se[se.length-1][1],se=[],se.push([Ae[0],Ae[1]])):(Ae=[0,0],se=[[0,0]]),Oe=[],de!="z"&&de!="Z"&&Oe.push(de),Y.x=0,Y.y=0;var He=K.getAttribute("transform");(He||y)&&k(ye,He||y)}return m&&Ve(),se}C.processPath=function(K){return D(K,!1)},f!==!1&&e.styleTransforms(this,w),this.clone=function(){return C.cloneProps(new e.SVGContainer(t,r,i,o,l,f,this.group,p))}},e.extend(e.SVGContainer,e.Container,"clone","zimContainer",!1),e.CustomShape=function(t,r,i,o){e.zimCustomShapeCheck||(qe("50.97"),e.zimCustomShapeCheck=!0),this.zimContainer_constructor(t,r,i,o,!1);var l=this;this.mouseChildren=!1,l._dashedOffset=5,Object.defineProperty(l,"color",{get:function(){return l._color},set:function(f){n(f)&&(f="black"),l._color=f,f&&f.type?l.specialColor(l.colorCommand,f,l):l.colorCommand.style=f}}),this.setColorRange=function(f,h){return n(h)?(l.startColor=l.color,l.endColor=f):n(f)?(l.startColor=l.color,l.endColor=h):(l.startColor=f,l.endColor=h),l},l._colorRange=0,Object.defineProperty(l,"colorRange",{get:function(){return l._colorRange},set:function(f){l._colorRange=f,!n(l.startColor)&&!n(l.endColor)&&(l.color=e.colorRange(l.startColor,l.endColor,f))}}),Object.defineProperty(l,"borderColor",{get:function(){return l._borderColor},set:function(f){l._borderColor=f,f&&!l.borderWidth&&(l.borderWidth=1),l.borderColorCommand?f&&f.type?l.specialColor(l.borderColorCommand,f,l):l.borderColorCommand.style=f:l.drawShape()}}),Object.defineProperty(l,"borderWidth",{get:function(){return l._borderWidth},set:function(f){f>0||(f=0),l._borderWidth=f,!l.borderWidthCommand||l._borderWidth==0?(l.borderWidthCommand=null,l.drawShape()):(l.borderWidthCommand.width=l._borderWidth,l._dashed&&(l.borderDashedCommand.segments=l._dashed,l.borderDashedCommand.offset=l._dashedOffset))}}),Object.defineProperty(l,"thickness",{get:function(){return l._thickness},set:function(f){f>0||(f=0),l._thickness=f,!l.thicknessCommand||l._thickness==0?l.drawShape():(l.thicknessCommand.width=l._thickness,l._dashed&&(l.dashedCommand.segments=l._dashed,l.dashedCommand.offset=l._dashedOffset))}}),Object.defineProperty(l,"dashed",{get:function(){return l._dashed},set:function(f){l._dashed=f,f&&!Array.isArray(l._dashed)&&(l.dashed=[10,10]);var h;if(l.type=="Squiggle"||l.type=="Line"){if(!l.thicknessCommand||l._thickness==0)return;h=l.dashedCommand}else{if(!l.borderWidthCommand||l._borderWidth==0)return;h=l.borderDashedCommand}h?l._dashed?(h.segments=l._dashed,h.offset=l._dashedOffset):(h.segments=null,h.offset=null):l.drawShape()}}),Object.defineProperty(l,"dashedOffset",{get:function(){return l._dashedOffset},set:function(f){isNaN(f)&&(f=5),l._dashedOffset=f;var h;if(l.type=="Squiggle"||l.type=="Line"){if(!l.thicknessCommand||l._thickness==0)return;h=l.dashedCommand}else{if(!l.borderWidthCommand||l._borderWidth==0)return;h=l.borderDashedCommand}h?l._dashed?(h.segments=l._dashed,h.offset=l._dashedOffset):(h.segments=null,h.offset=null):l.drawShape()}}),Object.defineProperty(l,"corner",{get:function(){return l._corner},set:function(f){l._corner=f,l.drawShape()}}),this.linearGradient=function(f,h,p,_,b,w){return this.linearGradientParams=Array.prototype.slice.call(arguments),this.colorCommand.linearGradient(f,h,p,_,b,w),this},this.radialGradient=function(f,h,p,_,b,w,C,O){return this.radialGradientParams=Array.prototype.slice.call(arguments),this.colorCommand.radialGradient(f,h,p,_,b,w,C,O),this},this.cloneAll=function(f,h,p,_){var b=this.getBounds();n(b)&&(b={x:null,y:null,width:null,height:null});var w=this.cloneChildren(this.cloneProps(new e.Container(b.x,b.y,b.width,b.height,h,p,_)),f);return w.mouseChildren=!1,w.type=this.type,w}},e.extend(e.CustomShape,e.Container,null,"zimContainer",!1),e.Circle=function(t,r,i,o,l,f,h,p,_,b,w){var C="radius, color, borderColor, borderWidth, dashed, percent, percentClose, strokeObj, style, group, inherit",O;if(O=mt(e.Circle,arguments,C,this))return O;qe("51"),this.zimCustomShape_constructor(null,null,null,null,!1),this.type="Circle",this.group=b;var P=_===!1?{}:e.getStyle(this.type,this.group,w);n(t)&&(t=P.radius!=null?P.radius:50),n(l)&&(l=P.dashed!=null?P.dashed:!1),n(i)&&(i=P.borderColor!=null?P.borderColor:null),n(o)&&(o=P.borderWidth!=null?P.borderWidth:null),i<0||o<0?i=o=null:i!=null&&o==null&&(o=1),n(r)&&(r=P.color!=null?P.color:o>0?"rgba(0,0,0,0)":e.black),n(f)&&(f=P.percent!=null?P.percent:100),n(h)&&(h=P.percentClose!=null?P.percentClose:!0),n(p)&&(p=P.strokeObj!=null?P.strokeObj:{});var A=R(t,r,i,o,f);this.veeObj={radius:A[0],color:A[1],borderColor:A[2],borderWidth:A[3],percent:A[4]};function R(){return arguments}t=e.Pick.choose(t),r=e.Pick.choose(r),i=e.Pick.choose(i),o=e.Pick.choose(o),f=e.Pick.choose(f);var T=this;T._radius=t,T._color=r,T._borderColor=i,T._borderWidth=o,T._dashed=l,T._dashed&&!Array.isArray(T._dashed)&&(T._dashed=[10,10]);var L=this.shape=new $e.Shape;this.addChild(L);var S=L.graphics;T.drawShape=function(){S.c(),T.colorCommand=S.f(T._color).command,T._color&&T._color.type&&T.specialColor(T.colorCommand,T._color,T),(n(T._borderWidth)||T._borderWidth>0)&&(!n(T._borderColor)||!n(T._borderWidth))&&(n(T._borderColor)&&(T._borderColor=e.black),T.borderColorCommand=S.s(T._borderColor).command,T._borderColor&&T._borderColor.type&&T.specialColor(T.borderColorCommand,T._borderColor,T),T.borderWidthCommand=S.ss(T._borderWidth,p.caps,p.joints,p.miterLimit,p.ignoreScale).command,T._dashed&&(T.borderDashedCommand=S.sd(Array.isArray(T._dashed)?T._dashed:[10,10],T._dashedOffset).command));var E=T._radius*2;if(typeof f=="number"&&f>=0&&f<100){var k=360*f/100/2;S.arc(0,0,T._radius,(-k-90)*Math.PI/180,(k-90)*Math.PI/180,!1),h&&S.cp(),E=T._radius-Math.cos(k*Math.PI/180)*T._radius}else S.dc(0,0,T._radius);T.setBounds(-T._radius,-T._radius,T._radius*2,E)},T.drawShape(),r.type&&(T.color=r),Object.defineProperty(T,"radius",{get:function(){return T._radius},set:function(E){T._radius=E,T.drawShape()}}),Object.defineProperty(T,"percentage",{get:function(){return f},set:function(E){f=E,T.drawShape()}}),Object.defineProperty(T,"percentClose",{get:function(){return h},set:function(E){h=E,T.drawShape()}}),_!==!1&&e.styleTransforms(this,P),this.clone=function(E){var k=T.cloneProps(new e.Circle(E||!e.isPick(A[0])?T.radius:A[0],E||!e.isPick(A[1])?T.color:A[1],E||!e.isPick(A[2])?T.borderColor:A[2],E||!e.isPick(A[3])?T.borderWidth:A[3],T.dashed,E||!e.isPick(A[4])?f:A[4],h,p,_,this.group,w));return T.linearGradientParams&&k.linearGradient.apply(k,T.linearGradientParams),T.radialGradientParams&&k.radialGradient.apply(k,T.radialGradientParams),k}},e.extend(e.Circle,e.CustomShape,"clone","zimCustomShape",!1),e.Rectangle=function(t,r,i,o,l,f,h,p,_,b,w,C){var O="width, height, color, borderColor, borderWidth, corner, dashed, strokeObj, scaleDimensions, style, group, inherit",P;if(P=mt(e.Rectangle,arguments,O,this))return P;qe("52"),this.zimCustomShape_constructor(null,null,null,null,!1),this.type="Rectangle",this.group=w;var A=b===!1?w!=null?e.getStyle(null,null,C,this.group):{}:e.getStyle(this.type,this.group,C);n(t)&&(t=A.width!=null?A.width:null),n(r)&&(r=A.height!=null?A.height:n(t)?100:t),n(t)&&(t=r),n(f)&&(f=A.corner!=null?A.corner:0),n(h)&&(h=A.dashed!=null?A.dashed:!1),n(o)&&(o=A.borderColor!=null?A.borderColor:null),n(l)&&(l=A.borderWidth!=null?A.borderWidth:null),o<0||l<0?o=l=null:o!=null&&l==null&&(l=1),n(i)&&(i=A.color!=null?A.color:l>0?"rgba(0,0,0,0)":e.black),n(p)&&(p=A.strokeObj!=null?A.strokeObj:{}),n(_)&&(_=A.scaleDimensions!=null?A.scaleDimensions:!0);var R=T(t,r,i,o,l);this.veeObj={width:R[0],height:R[1],color:R[2],borderColor:R[3],borderWidth:R[4]};function T(){return arguments}t=e.Pick.choose(t),r=e.Pick.choose(r),i=e.Pick.choose(i),o=e.Pick.choose(o),l=e.Pick.choose(l);var L=this;L._color=i,L._borderColor=o,L._borderWidth=l,L._dashed=h,L._dashed&&!Array.isArray(L._dashed)&&(L._dashed=[10,10]),L._corner=f,L.scaleDimensions=_,L.setWidth=function(k){t=k},L.setHeight=function(k){r=k};var S=this.shape=new $e.Shape;this.addChild(S);var E=S.graphics;L.drawShape=function(){if(E.c(),L.colorCommand=E.f(L._color).command,i&&i.type&&L.specialColor(L.colorCommand,i,L),(n(L._borderWidth)||L._borderWidth>0)&&(!n(L._borderColor)||!n(L._borderWidth))&&(n(L._borderColor)&&(L._borderColor=e.black),L.borderColorCommand=E.s(L._borderColor).command,L._borderColor&&L._borderColor.type&&L.specialColor(L.borderColorCommand,L._borderColor,L),L.borderWidthCommand=E.ss(L._borderWidth,p.caps,p.joints,p.miterLimit,p.ignoreScale).command,L._dashed&&(L.borderDashedCommand=E.sd(Array.isArray(L._dashed)?L._dashed:[10,10],L._dashedOffset).command)),Array.isArray(L._corner)){var k=L._corner;Array.isArray(k)&&k.length==2&&(k=[k,k,k,k]);for(var X=[],q=!1,V=0;V<k.length;V++)Array.isArray(k[V])?(q=!0,X.push(k[V])):X.push([k[V],k[V]]);k=X,q?E.mt(0,k[0][1]).curveTo(0,0,k[0][0],0).lt(t-k[1][0],0).curveTo(t,0,t,k[1][1]).lt(t,r-k[2][1]).curveTo(t,r,t-k[2][0],r).lt(k[3][0],r).curveTo(0,r,0,r-k[3][1]).cp():E.rc(0,0,t,r,L._corner[0],L._corner[1],L._corner[2],L._corner[3])}else L._corner>0?E.rr(0,0,t,r,L._corner):E.r(0,0,t,r);L.setBounds(0,0,t,r),i.type&&(L.color=i)},L.drawShape(),(b!==!1||w!=null)&&e.styleTransforms(this,A),this.clone=function(k,X){var q=n(X)?b:X,V=L.cloneProps(new e.Rectangle(k||!e.isPick(R[0])?t:R[0],k||!e.isPick(R[1])?r:R[1],k||!e.isPick(R[2])?L.color:R[2],k||!e.isPick(R[3])?L.borderColor:R[3],k||!e.isPick(R[4])?L.borderWidth:R[4],f,L._dashed,p,L.scaleDimensions,q,this.group,C));return V}},e.extend(e.Rectangle,e.CustomShape,"clone","zimCustomShape",!1),e.Triangle=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P){var A="a, b, c, color, borderColor, borderWidth, corner, center, adjust, dashed, strokeObj, style, group, inherit",R;if(R=mt(e.Triangle,arguments,A,this))return R;qe("53"),this.zimCustomShape_constructor(null,null,null,null,!1),this.type="Triangle",this.group=O;var T=C===!1?{}:e.getStyle(this.type,this.group,P);n(t)&&(t=T.a!=null?T.a:100),n(r)&&(r=T.b!=null?T.b:t),n(i)&&(i=T.c!=null?T.c:t),r==-1&&(r=Math.sqrt(Math.pow(t,2)+Math.pow(i,2))),i==-1&&(i=Math.sqrt(Math.pow(t,2)+Math.pow(r,2))),n(h)&&(h=T.corner!=null?T.corner:0),n(p)&&(p=T.center!=null?T.center:!0),n(_)&&(_=T.adjust!=null?T.adjust:0),n(l)&&(l=T.borderColor!=null?T.borderColor:null),n(f)&&(f=T.borderWidth!=null?T.borderWidth:null),l<0||f<0?l=f=null:l!=null&&f==null&&(f=1),n(o)&&(o=T.color!=null?T.color:f>0?"rgba(0,0,0,0)":e.black),n(_)&&(_=T.adjust!=null?T.adjust:0),n(w)&&(w=T.strokeObj!=null?T.strokeObj:{});var L=S(t,r,i,o,l,f);this.veeObj={a:L[0],b:L[1],c:L[2],color:L[3],borderColor:L[4],borderWidth:L[5]};function S(){return arguments}t=e.Pick.choose(t),r=e.Pick.choose(r),i=e.Pick.choose(i),this.a=t,this.b=r,this.c=i,o=e.Pick.choose(o),l=e.Pick.choose(l),f=e.Pick.choose(f);var E=this;E._color=o,E._borderColor=l,E._borderWidth=f,E._dashed=b,E._dashed&&!Array.isArray(E._dashed)&&(E._dashed=[10,10]),E._corner=h;var k=[t,r,i];k.sort(function(Z,U){return U-Z});var X=k[0],q=k[1],V=k[2],I=[k.indexOf(t),k.indexOf(r),k.indexOf(i)];if(X>q+V){ht("zim display - Triangle(): invalid triangle lengths");return}var te=this.shape=new $e.Shape;this.adjusted=_,this.addChild(te);var B=te.graphics;E.drawShape=function(){var Z=[];Array.isArray(E._corner)?Z=E._corner:Z.push(E._corner,E._corner,E._corner);for(var U=0;U<3;U++)(Z[U]<0||typeof Z[U]!="number")&&(Z[U]=0);B.c(),E.colorCommand=B.f(E._color).command,E._color&&E._color.type&&E.specialColor(E.colorCommand,E._color,E),(n(E._borderWidth)||E._borderWidth>0)&&(!n(E._borderColor)||!n(E._borderWidth))&&(n(E._borderColor)&&(E._borderColor=e.black),E.borderColorCommand=B.s(E._borderColor).command,E._borderColor&&E._borderColor.type&&E.specialColor(E.borderColorCommand,E._borderColor,E),E.borderWidthCommand=B.ss(E._borderWidth,w.caps,w.joints,w.miterLimit,w.ignoreScale).command,E._dashed&&(E.borderDashedCommand=B.sd(Array.isArray(E._dashed)?E._dashed:[10,10],E._dashedOffset).command)),E.one={x:0,y:0},E.two={x:t,y:0};var ee=Math.acos((Math.pow(q,2)+Math.pow(V,2)-Math.pow(X,2))/(2*q*V))*180/Math.PI,ae=Math.asin(q*Math.sin(ee*Math.PI/180)/X)*180/Math.PI,re=180-ee-ae,he=[ee,ae,re];E.angles=[he[I[1]],he[I[2]],he[I[0]]];var j=E.angles[1],G=Math.cos(j*Math.PI/180)*r,y=Math.sin(j*Math.PI/180)*r,g=Math.max(t,t-G),d=y;E.setBounds(0,_,g,d),te.y=d,E.three={x:t-G,y:0-y};var D=t*Z[0]/(Z[0]+Z[1]||1);B.mt(D,0).at(t,0,t-G,0-y,Z[1]).at(t-G,0-y,0,0,Z[2]).at(0,0,t,0,Z[0]).lt(D,0),B.cp(),p&&(E.regX=g/2,E.regY=d/2),_&&(E.shape.y+=_)},E.drawShape(),o.type&&(E.color=o),C!==!1&&e.styleTransforms(this,T),this.clone=function(Z,U){var ee=n(U)?C:U,ae=E.cloneProps(new e.Triangle(Z||!e.isPick(L[0])?t:L[0],Z||!e.isPick(L[1])?r:L[1],Z||!e.isPick(L[2])?i:L[2],Z||!e.isPick(L[3])?E.color:L[3],Z||!e.isPick(L[4])?E.borderColor:L[4],Z||!e.isPick(L[5])?E.borderWidth:L[5],h,p,_,b,w,ee,this.group,P));return E.linearGradientParams&&ae.linearGradient.apply(ae,E.linearGradientParams),E.radialGradientParams&&ae.radialGradient.apply(ae,E.radialGradientParams),ae}},e.extend(e.Triangle,e.CustomShape,"clone","zimCustomShape"),e.Poly=function(t,r,i,o,l,f,h,p,_,b,w){var C="radius, sides, pointSize, color, borderColor, borderWidth, dashed, strokeObj, style, group, inherit",O;if(O=mt(e.Poly,arguments,C,this))return O;qe("53.1"),this.zimCustomShape_constructor(null,null,null,null,!1),this.type="Poly",this.group=b;var P=_===!1?{}:e.getStyle(this.type,this.group,w);n(t)&&(t=P.radius!=null?P.radius:50),n(r)&&(r=P.sides!=null?P.sides:5),n(i)&&(i=P.pointSize!=null?P.pointSize:0),n(h)&&(h=P.dashed!=null?P.dashed:!1),n(l)&&(l=P.borderColor!=null?P.borderColor:null),n(f)&&(f=P.borderWidth!=null?P.borderWidth:null),l<0||f<0?l=f=null:l!=null&&f==null&&(f=1),n(o)&&(o=P.color!=null?P.color:f>0?"rgba(0,0,0,0)":e.black),n(p)&&(p=P.strokeObj!=null?P.strokeObj:{});var A=R(t,r,i,o,l,f);this.veeObj={radius:A[0],sides:A[1],pointSize:A[2],color:A[3],borderColor:A[4],borderWidth:A[5]};function R(){return arguments}t=e.Pick.choose(t),r=e.Pick.choose(r),i=e.Pick.choose(i),o=e.Pick.choose(o),l=e.Pick.choose(l),f=e.Pick.choose(f);var T=this;T._radius=t,T._color=o,T._sides=r,T._pointSize=i,T._borderColor=l,T._borderWidth=f,T._dashed=h,T._dashed&&!Array.isArray(T._dashed)&&(T._dashed=[10,10]);var L=this.shape=new $e.Shape;this.addChild(L),L.rotation=-90;var S=L.graphics;T.drawShape=function(){S.c(),T.colorCommand=S.f(T._color).command,T._color&&T._color.type&&T.specialColor(T.colorCommand,T._color,T),(n(T._borderWidth)||T._borderWidth>0)&&(!n(T._borderColor)||!n(T._borderWidth))&&(n(T._borderColor)&&(T._borderColor=e.black),T.borderColorCommand=S.s(T._borderColor).command,T._borderColor&&T._borderColor.type&&T.specialColor(T.borderColorCommand,T._borderColor,T),T.borderWidthCommand=S.ss(T._borderWidth,p.caps,p.joints,p.miterLimit,p.ignoreScale).command,T._dashed&&(T.borderDashedCommand=S.sd(Array.isArray(T._dashed)?T._dashed:[10,10],T._dashedOffset).command)),S.dp(0,0,T._radius,T._sides,T._pointSize),T.setBounds(-T._radius,-T._radius,T._radius*2,T._radius*2)},T.drawShape(),o.type&&(T.color=o),Object.defineProperty(T,"radius",{get:function(){return T._radius},set:function(E){T._radius=E,T.drawShape()}}),Object.defineProperty(T,"sides",{get:function(){return T._sides},set:function(E){T._sides=E,T.drawShape()}}),Object.defineProperty(T,"pointSize",{get:function(){return T._pointSize},set:function(E){T._pointSize=E,T.drawShape()}}),_!==!1&&e.styleTransforms(this,P),this.clone=function(E){var k=T.cloneProps(new e.Poly(E||!e.isPick(A[0])?T.radius:A[0],E||!e.isPick(A[1])?T.sides:A[1],E||!e.isPick(A[2])?T.pointSize:A[2],E||!e.isPick(A[3])?T.color:A[3],E||!e.isPick(A[4])?T.borderColor:A[4],E||!e.isPick(A[5])?T.borderWidth:A[5],T.dashed,p,_,this.group,w));return T.linearGradientParams&&k.linearGradient.apply(k,T.linearGradientParams),T.radialGradientParams&&k.radialGradient.apply(k,T.radialGradientParams),k}},e.extend(e.Poly,e.CustomShape,"clone","zimCustomShape",!1),e.Line=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A){var R="length, thickness, color, startHead, endHead, dashed, strokeObj, lineType, lineOrientation, curveH, curveV, points, style, group, inherit",T;if(T=mt(e.Line,arguments,R,this))return T;qe("53.15"),this.zimCustomShape_constructor(null,null,null,null,!1),this.type="Line",this.group=P;var L=O===!1?{}:e.getStyle(this.type,this.group,A);n(t)&&(t=L.length!=null?L.length:100),n(f)&&(f=L.dashed!=null?L.dashed:!1),n(r)&&(r=L.thickness!=null?L.thickness:3),n(i)&&(i=L.color!=null?L.color:e.black),n(o)&&(o=L.startHead!=null?L.startHead:null),n(l)&&(l=L.endHead!=null?L.endHead:null),n(h)&&(h=L.strokeObj!=null?L.strokeObj:{}),n(p)&&(p=L.lineType!=null?L.lineType:"straight"),p!=="corner"&&p!="curve"&&(p="straight"),n(_)&&(_=L.lineOrientation!=null?L.lineOrientation:"auto"),_!=="vertical"&&_!="horizontal"&&(_="auto"),n(b)&&(b=L.curveH!=null?L.curveH:20),n(w)&&(w=L.curveV!=null?L.curveV:20),n(h)&&(h=L.strokeObj!=null?L.strokeObj:{});var S=E(t,i,r,o,l);this.veeObj={length:S[0],color:S[1],thickness:S[2],startHead:S[3],endHead:S[4]};function E(){return arguments}t=e.Pick.choose(t),i=e.Pick.choose(i),r=e.Pick.choose(r),o=e.Pick.choose(o),l=e.Pick.choose(l),o&&o.clone&&(o=o.clone()),l&&l.clone&&(l=l.clone());var k=this;k._length=t,k._color=i,k._thickness=r,k._dashed=f,k._dashed&&!Array.isArray(k._dashed)&&(k._dashed=[10,10]),k._startX=0,k._startY=0,k._endX=t,k._endY=0,k._startHead=o,k._endHead=l,k._points=C,k._lineOrientation=_,k.angle=0,k.lineType=p,k._startHead&&X("start",k._startHead),k._endHead&&X("end",k._endHead);function X(I,te){if(te=="triangle"||te=="arrow"){var B=k["_"+I+"Head"]=new e.Triangle(r*4,r*4,r*4,i);B.rotation=90}else te=="circle"&&(k["_"+I+"Head"]=new e.Circle(r*2.2,i));n(k["_"+I+"Head"].startAngle)&&(k["_"+I+"Head"].startAngle=k["_"+I+"Head"].rotation)}o=k._startHead,l=k._endHead,o&&o.type=="Triangle"&&(o.startRegY=o.regY),l&&l.type=="Triangle"&&(l.startRegY=l.regY);var q=this.shape=new $e.Shape;this.addChild(q);var V=q.graphics;k.drawShape=function(I,te){V.c(),k.colorCommand=V.s(k._color).command,i&&i.type&&k.specialColor(k.colorCommand,i,k),k.thicknessCommand=V.ss(k._thickness,h.caps,h.joints,h.miterLimit,h.ignoreScale).command,k._dashed&&(k.dashedCommand=V.sd(Array.isArray(k._dashed)?k._dashed:[10,10],k._dashedOffset).command);var B,Z;if(k._points){var U=k._points[0];k._startX=U[0],k._startY=U[1];var ee=k._points[k._points.length-1],ae=[ee[ee.length-2],ee[ee.length-1]];k._endX=ae[0],k._endY=ae[1],V.mt(U[0],U[1]);for(var re=1;re<k._points.length;re++){var he=k._points[re];re==1&&(B=[k._startX,k._startY,he[0],he[1]]),he.length==2?V.lt(he[0],he[1]):he.length==4?V.qt(he[0],he[1],he[2],he[3]):he.length==6&&V.bt(he[0],he[1],he[2],he[3],he[4],he[5])}if(he.length>=4)Z=[he[he.length-4],he[he.length-3],k._endX,k._endY];else{var j=k._points[k._points.length-2];Z=[j[j.lenth-2],j[j.lenth-1],k._endX,k._endY]}}else{var G=k._startX,y=k._startY,g=k._endX,d=k._endY,D;if(k.lineType=="straight"?(o&&o.type=="Triangle"&&(o.regY=0,D=e.dist(G,y,g,d),D!=0&&(G=G+k._startHead.height/2*(g-G)/D),D!=0&&(y=y+k._startHead.height/2*(d-y)/D)),l&&l.type=="Triangle"&&(l.regY=0,D=e.dist(G,y,g,d),D!=0&&(g=g-k._endHead.height/2*(g-G)/D),D!=0&&(d=d-k._endHead.height/2*(d-y)/D))):(I?k._lineOrientation=="horizontal"||k.autoOrientation=="horizontal"?o&&o.type=="Triangle"&&(o.regY=0,g>G?G=Math.min(g,G+k._startHead.height/2):G=Math.max(g,G-k._startHead.height/2)):o&&o.type=="Triangle"&&(o.regY=0,d>y?y=Math.min(d,y+k._startHead.height/2):y=Math.max(d,y-k._startHead.height/2)):o&&o.type=="Triangle"&&(o.regY=o.startRegY),te?k._lineOrientation=="horizontal"||k.autoOrientation=="horizontal"?l&&l.type=="Triangle"&&(l.regY=0,g>G?g-=k._endHead.height/2:g+=k._endHead.height/2):l&&l.type=="Triangle"&&(l.regY=0,d>y?d-=k._endHead.height/2:d+=k._endHead.height/2):l&&l.type=="Triangle"&&(l.regY=l.startRegY)),k.lineType=="straight")V.mt(G,y).lt(g,d),B=Z=[G,y,g,d];else if(k.lineType=="corner"){var K=G+(g-G)*.4,m=y+(d-y)*.4;k._lineOrientation=="auto"&&(k.autoOrientation=Math.abs(G-g)>Math.abs(y-d)?"horizontal":"vertical"),k._lineOrientation=="horizontal"||k.autoOrientation=="horizontal"?(B=Z=[G,y,K,y],V.mt(G,y).lt(K,y).lt(K,d).lt(g,d)):(B=Z=[G,y,G,m],V.mt(G,y).lt(G,m).lt(g,m).lt(g,d))}else{var F=G>g?-1:1,Ce=y>d?-1:1,Y=G,Q=y,ce=Math.abs(G-g),pe=Math.abs(y-d),J=Math.min(b,ce*.5),ue=Math.min(w,pe*.5);k._lineOrientation=="auto"&&(k.autoOrientation=Math.abs(G-g)>Math.abs(y-d)?"horizontal":"vertical");var ye,Xe,se,Ae;k._lineOrientation=="horizontal"||k.autoOrientation=="horizontal"?(ye=pe-ue*2,Xe=(ce-J*2)/2,V.mt(Y,Q),Xe>0&&(Y=Y+Xe*F,V.lt(Y,Q)),Ae=Q,Q=Q+ue*Ce,Y=Y+J*F,V.qt(Y,Ae,Y,Q),B=Z=[G,y,Y,y],ye>0&&(Q=Q+ye*Ce,V.lt(Y,Q)),Q=Q+ue*Ce,se=Y,Y=Y+J*F,V.qt(se,Q,Y,Q),Xe>0&&(Y=Y+Xe*F,V.lt(Y,Q))):(ye=ce-J*2,Xe=(pe-ue*2)/2,V.mt(Y,Q),Xe>0&&(Q=Q+Xe*Ce,V.lt(Y,Q)),se=Y,Y=Y+J*F,Q=Q+ue*Ce,V.qt(se,Q,Y,Q),B=Z=[G,y,G,Q],ye>0&&(Y=Y+ye*F,V.lt(Y,Q)),Y=Y+J*F,Ae=Q,Q=Q+ue*Ce,V.qt(Y,Ae,Y,Q),Xe>0&&(Q=Q+Xe*Ce,V.lt(Y,Q)))}}if(k.setBounds(Math.min(k._startX,k._endX),Math.min(k._startY,k._endY),Math.abs(k._startX-k._endX),Math.abs(k._startY-k._endY)),k._length=Math.sqrt(Math.pow(k._startX-k._endX,2)+Math.pow(k._startY-k._endY,2)),k.angle=Math.atan2(k._endY-k._startY,k._endX-k._startX)*180/Math.PI,k._startHead&&k._startHead.loc){k._startHead.loc(k._startX,k._startY,k);var ie=Math.atan2(B[3]-B[1],B[2]-B[0])*180/Math.PI;k._startHead.rotation=ie-180+k._startHead.startAngle}if(k._endHead&&k._endHead.loc){k._endHead.loc(k._endX,k._endY,k);var _e=Math.atan2(Z[3]-Z[1],Z[2]-Z[0])*180/Math.PI;k._endHead.rotation=_e+k._endHead.startAngle}},k.drawShape(),i.type&&(k.color=i),this.setPoints=function(I,te,B,Z,U,ee){return Array.isArray(I)&&n(te)?(k.points=I,k):(I&&!n(I.x)?(k._startX=n(I.x)?k._startX:I.x,k._startY=n(I.y)?k._startY:I.y,te&&(k._endX=n(te.x)?k._endX:te.x,k._endY=n(te.y)?k._endY:te.y)):(k._startX=n(I)?k._startX:I,k._startY=n(te)?k._startY:te,k._endX=n(B)?k._endX:B,k._endY=n(Z)?k._endY:Z),k.drawShape(U,ee),k)},this.from=function(I,te,B){n(B)&&(B=!0);var Z,U;if(I&&I.parent&&k.parent&&B){var ee=I.parent.localToLocal(I.x,I.y,k.parent);Z=ee.x,U=ee.y}return I&&!n(I.x)?(k._startX=n(Z)?n(I.x)?k._startX:I.x:Z,k._startY=n(U)?n(I.y)?k._startY:I.y:U):(k._startX=n(I)?k._startX:I,k._startY=n(te)?k._startY:te),k.drawShape(),k},this.to=function(I,te,B){n(B)&&(B=!0);var Z,U;if(I&&I.parent&&k.parent&&B){var ee=I.parent.localToLocal(I.x,I.y,k.parent);Z=ee.x,U=ee.y}return I&&!n(I.x)?(k._endX=n(Z)?n(I.x)?k._endX:I.x:Z,k._endY=n(U)?n(I.y)?k._endY:I.y:U):(k._endX=n(I)?k._endX:I,k._endY=n(te)?k._endY:te),k.drawShape(),k},Object.defineProperty(k,"length",{get:function(){return k._length},set:function(I){var te=k.length!=0?I/k.length:0;if(!isNaN(te)){var B=k.scaleX,Z=k.scaleY;k.scaleX*=te,k.scaleY*=te;var U=k.localToGlobal(k._startX,k._startY),ee=k.localToGlobal(k._endX,k._endY);k.scaleX=B,k.scaleY=Z;var ae=k.globalToLocal(U.x,U.y),re=k.globalToLocal(ee.x,ee.y);k.setPoints(ae,re)}}}),Object.defineProperty(k,"startPoint",{get:function(){return new e.Point(k._startX,k._startY)},set:function(I){k._startX=n(I.x)?k._startX:I.x,k._startY=n(I.y)?k._startY:I.y,k.drawShape()}}),Object.defineProperty(k,"endPoint",{get:function(){return new e.Point(k._endX,k._endY)},set:function(I){k._endX=n(I.x)?k._endX:I.x,k._endY=n(I.y)?k._endY:I.y,k.drawShape()}}),Object.defineProperty(k,"startHead",{get:function(){return k._startHead},set:function(I){k._startHead=I,k.drawShape()}}),Object.defineProperty(k,"endHead",{get:function(){return k._endHead},set:function(I){k._endHead=I,k.drawShape()}}),Object.defineProperty(k,"startX",{get:function(){return k._startX},set:function(I){k._startX=I||0,k.drawShape()}}),Object.defineProperty(k,"startY",{get:function(){return k._startY},set:function(I){k._startY=I||0,k.drawShape()}}),Object.defineProperty(k,"endX",{get:function(){return k._endX},set:function(I){k._endX=I||0,k.drawShape()}}),Object.defineProperty(k,"endY",{get:function(){return k._endY},set:function(I){k._endY=I||0,k.drawShape()}}),Object.defineProperty(k,"points",{get:function(){return k._points},set:function(I){I&&(k._points=I,k.drawShape())}}),Object.defineProperty(k,"lineOrientation",{get:function(){return k._lineOrientation},set:function(I){I&&(k._lineOrientation=I,k.drawShape())}}),O!==!1&&e.styleTransforms(this,L),this.clone=function(I){var te=I||!e.isPick(S[3])?k._startHead:S[3];te&&te.clone&&(te=te.clone(),te.rotation=k._startHead.startAngle);var B=I||!e.isPick(S[4])?k._endHead:S[4];B&&B.clone&&(B=B.clone(),B.rotation=k._endHead.startAngle);var Z=k.cloneProps(new e.Line(I||!e.isPick(S[0])?k.length:S[0],I||!e.isPick(S[2])?k.thickness:S[2],I||!e.isPick(S[1])?k.color:S[1],te,B,k.dashed,h,p,k._lineOrientation,b,w,e.copy(C),O,this.group,A));return k.points?Z.setPoints(k.points):Z.setPoints(k._startX,k._startY,k._endX,k._endY),k.linearGradientParams&&Z.linearGradient.apply(Z,k.linearGradientParams),k.radialGradientParams&&Z.radialGradient.apply(Z,k.radialGradientParams),Z}},e.extend(e.Line,e.CustomShape,"clone","zimCustomShape",!1),e.Squiggle=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te){var B="color, thickness, points, length, controlLength, controlType, lockControlType, showControls, lockControls, handleSize, allowToggle, move, dashed, onTop, circleColor, circleBorderColor, stickColor, stickThickness, selectColor, selectPoints, editPoints, interactive, strokeObj, style, group, inherit",Z;if(Z=mt(e.Squiggle,arguments,B,this))return Z;qe("53.2"),this.group=I;var U=V===!1?{}:e.getStyle("Squiggle",this.group,te);if(n(r)&&(r=U.thickness!=null?U.thickness:6),n(o)&&(o=U.length!=null?U.length:300),n(i)&&(i=U.points!=null?U.points:5),typeof i=="string"){var ee=new e.SVGContainer;i=ee.processPath(i)}var ae=typeof i!="number",re=typeof i=="number"?i:i.length;if(re==0)return;n(l)&&(l=U.controlLength!=null?U.controlLength:o/re),this.zimCustomShape_constructor(o,l,null,null,!1),this.type="Squiggle",this.mouseChildren=!0,n(O)&&(O=U.dashed!=null?U.dashed:!1),n(t)&&(t=U.color!=null?U.color:e.blue),t.style&&(this.colorCommand=t,t=e.black),n(f)&&(f=U.controlType!=null?U.controlType:null);var he=f;n(f)&&(f="mirror"),n(h)&&(h=U.lockControlType!=null?U.lockControlType:!1),n(X)&&(X=U.interactive!=null?U.interactive:!0),n(p)&&(p=U.showControls!=null?U.showControls:X);var j=p;n(_)&&(_=U.lockControls!=null?U.lockControls:!X),n(b)&&(b=U.handleSize!=null?U.handleSize:e.mobile()?20:10),n(w)&&(w=U.allowToggle!=null?U.allowToggle:X),n(C)&&(C=U.move!=null?U.move:X),n(A)&&(A=U.circleColor!=null?U.circleColor:e.light),n(R)&&(R=U.circleBorderColor!=null?U.circleBorderColor:e.dark),n(T)&&(T=U.stickColor!=null?U.stickColor:e.darker),n(L)&&(L=U.stickThickness!=null?U.stickThickness:1),n(S)&&(S=U.selectColor!=null?U.selectColor:e.white),n(E)&&(E=U.selectPoints!=null?U.selectPoints:X),this.circleColor=A,this.circleBorderColor=R,this.stickColor=T,this.stickThickness=L,n(P)&&(P=U.onTop!=null?U.onTop:!0),n(k)&&(k=U.editPoints!=null?U.editPoints:X),n(q)&&(q=U.strokeObj!=null?U.strokeObj:{});var G=y(t);this.veeObj={color:G[0]};function y(){return arguments}t=e.Pick.choose(t);var g=this,d;this.types=["mirror","straight","free","none"],this.interactive=X,this.num=re,this.onTop=P,this.move=C,this.editPoints=k,this.allowToggle=w,this.lockControlType=h,this.selectPoints=E,this.lockControls=_;var D,K,m;g._color=t,g._thickness=r,g._dashed=O,g._dashed&&!Array.isArray(g._dashed)&&(g._dashed=[10,10]);var F,Ce,Y,Q,ce=g.move,pe=2,J,ue;he&&typeof i!="number"&&e.loop(i,function(me){me[8]=he,he=="none"&&(me[4]=me[5]=me[6]=me[7]=0)}),ye();function ye(){ue&&ue.removeAllEventListeners(),g.num=re=typeof i=="number"?i:i.length,re=Math.max(2,re),l=o/re,F=g.shape=new e.Shape({style:!1}).addTo(g);var me=g.sticks=new e.Shape({style:!1}).addTo(g);b<=0&&me.removeFrom();var Oe=F.graphics;Oe.c();var Ye=me.graphics;Ye.c();var de=b/10*8,ve=b;g.selectPoints?(g.selectedBalls=new e.SelectionSet,g.selectedRect1s=new e.SelectionSet,g.selectedRect2s=new e.SelectionSet,g.selectionManager=new e.SelectionManager([g.selectedBalls,g.selectedRect1s,g.selectedRect2s],"ctrl",!1)):g.selectionManager=new e.SelectionManager(null,"ctrl");var Me=e.mobile();ue=g.controls=new e.Container({style:!1}).addTo(g),g.interactive&&ue.drag({onTop:!Me}),D=[],m=[],K=[];var we,Fe,ge,Ve,He,Le,fe,Ge,Qe;for(we=0;we<re;we++){if(Ve=new e.Container({style:!1}).addTo(ue),Ve.num=we,typeof i=="number"){var Ke=e.Pick.choose(l);ge=new e.Container(Ke,r,null,null,!1).addTo(g).loc({x:we*o/(re-1)-Ke/2,y:we%2*Ke}),fe=new e.Circle(de,g.selectPoints&&g.selectedBalls.isSelected(we)?S:g.circleColor,g.circleBorderColor,2,null,null,null,null,!1).centerReg(ge).loc({x:Ke/2,y:0}),He=new e.Rectangle(ve,ve,g.selectPoints&&g.selectedRect1s.isSelected(we)?S:Ie(f),b==0?null:e.dark,b==0?null:2,null,null,null,null,!1).centerReg(ge).loc({x:0,y:0}),Le=new e.Rectangle(ve,ve,g.selectPoints&&g.selectedRect2s.isSelected(we)?S:Ie(f),b==0?null:e.dark,b==0?null:2,null,null,null,null,!1).centerReg(ge).loc({x:Ke,y:0});var st=ge.localToLocal(fe.x,fe.y,ue);fe.x=st.x,fe.y=st.y,fe.addTo(Ve,null,!1);var yt=ge.localToLocal(He.x,He.y,ue);He.x=f=="none"?0:yt.x-fe.x,He.y=f=="none"?0:yt.y-fe.y,He.addTo(Ve,null,!1);var We=ge.localToLocal(Le.x,Le.y,ue);Le.x=f=="none"?0:We.x-fe.x,Le.y=f=="none"?0:We.y-fe.y,Le.addTo(Ve,null,!1),Ve.x=fe.x,Ve.y=fe.y,fe.x=0,fe.y=0,f=="none"&&fe.addTo(Ve,null,!1)}else Qe=i[we],Ge=Qe[8]?Qe[8]:f,Ve.loc({x:Qe[0],y:Qe[1]}),fe=new e.Circle(de,g.circleColor,g.circleBorderColor,2,null,null,null,null,!1).centerReg({add:!1}).addTo(Ve).loc({x:Qe[2],y:Qe[3]}),He=new e.Rectangle(ve,ve,Ie(Ge),b==0?null:e.dark,b==0?null:2,null,null,null,null,!1).centerReg({add:!1}).addTo(Ve,0).loc({x:Qe[4],y:Qe[5]}),Le=new e.Rectangle(ve,ve,Ie(Ge),b==0?null:e.dark,b==0?null:2,null,null,null,null,!1).centerReg({add:!1}).addTo(Ve,0).loc({x:Qe[6],y:Qe[7]});fe.mySet=Ve,fe.rect1=He,fe.rect2=Le,fe.index=we,Me?fe.on("mousedown",ct):fe.on("dblclick",Pe),He.ball=fe,He.other=Le,Le.ball=fe,Le.other=He,b==0&&(fe.expand(10),He.expand(10),Le.expand(10)),Me&&(fe.expand(),He.expand(),Le.expand()),Fe=[Ve,fe,He,Le,Qe?Qe[8]:f],D.push(Fe),K.push(fe),m.push(Ve)}var at=!1;function ct(Te){at?(Te.preventDefault(),Pe(Te)):(at=!0,setTimeout(function(){at=!1},300))}function Pe(Te){if(!g.lockControlType){var et=Te.target,Ue=D[et.index][4]?D[et.index][4]:f;Math.abs(et.rect1.x)<=2&&Math.abs(et.rect1.y)<=2&&Math.abs(et.rect2.x)<=2&&Math.abs(et.rect2.y)<=2&&(Ue="none"),Ue=="none"&&et.parent.addChildAt(et,0),Ue=g.types[(g.types.indexOf(Ue)+(g.shiftKey?-1:1)+g.types.length)%g.types.length],Ue=="none"&&(et.rect1.x=et.rect1.y=et.rect2.x=et.rect2.y=0,et.parent.addChild(et),Te.stopImmediatePropagation()),D[et.index][4]=Ue,et.rect1.color=Ie(Ue),et.rect2.color=Ie(Ue),g.drawShape(),t.type&&(g.color=t);var Re=new $e.Event("change");Re.controlType="bezierSwitch",g.dispatchEvent(Re),et.stage.update()}}function Ie(Te){var et={straight:"#e472c4",free:"#ebcb35",none:"#50c4b7"};return et[Te]?et[Te]:"#993399"}var be=e.mobile();g.drawShape=function(){Oe.c();var Te=be?10:6,et,Ue,Re,Ze,Je,nt,pt,De,lt,vt,rt,xt,wt,_t,ft;if(r<Te)for(Oe.s("rgba(0,0,0,.01)").ss(Te),Ze=D[0][0],lt=Ze.localToLocal(D[0][1].x,D[0][1].y,F),Oe.mt(lt.x,lt.y),et=0;et<D.length;et++)Ue=et,Re=(et+1)%D.length,Ze=D[Ue][0],Je=D[Ue][1],nt=D[Ue][2],pt=D[Ue][3],De=D[Re][0],vt=D[Re][1],rt=D[Re][2],wt=Ze.localToLocal(pt.x,pt.y,F),_t=De.localToLocal(rt.x,rt.y,F),ft=De.localToLocal(vt.x,vt.y,F),et!=D.length-1&&Oe.bt(wt.x,wt.y,_t.x,_t.y,ft.x,ft.y);for(g.colorCommand||(g.colorCommand=Oe.s(g._color).command,t&&t.type&&g.specialColor(g.colorCommand,t,g)),g.thicknessCommand||(g.thicknessCommand=Oe.ss(g._thickness,q.caps,q.joints,q.miterLimit,q.ignoreScale).command),g._dashed&&(g.dashedCommand||(g.dashedCommand=Oe.sd(Array.isArray(g._dashed)?g._dashed:[10,10],g._dashedOffset).command)),Ze=D[0][0],lt=Ze.localToLocal(D[0][1].x,D[0][1].y,F),Oe.mt(lt.x,lt.y),Ye.c().s(g.stickColor).ss(g.stickThickness),et=0;et<D.length;et++)Ue=et,Re=(et+1)%D.length,Ze=D[Ue][0],Je=D[Ue][1],nt=D[Ue][2],pt=D[Ue][3],De=D[Re][0],vt=D[Re][1],rt=D[Re][2],wt=Ze.localToLocal(pt.x,pt.y,F),_t=De.localToLocal(rt.x,rt.y,F),ft=De.localToLocal(vt.x,vt.y,F),et!=D.length-1&&Oe.bt(wt.x,wt.y,_t.x,_t.y,ft.x,ft.y),lt=Ze.localToLocal(Je.x,Je.y,F),xt=Ze.localToLocal(nt.x,nt.y,F),et==0&&(nt.visible=0),et!=0&&Ye.mt(lt.x,lt.y).lt(xt.x,xt.y),et!=D.length-1&&Ye.mt(lt.x,lt.y).lt(wt.x,wt.y),et==D.length-1&&(pt.visible=0);g._dashed&&Oe.append(g.dashedCommand),Oe.append(g.thicknessCommand),Oe.append(g.colorCommand)},g.drawShape(),t.type&&(g.color=t);var ze;ue.on("mousedown",function(Te){if(d=Te.target.stage,!g.lockControls){if(g.selectPoints&&(g.keyFocus=!0),ze={x:Te.target.x,y:Te.target.y},Te.target.rect1)fe=Te.target,fe.startX=fe.x,fe.startY=fe.y,fe.rect1.startX=fe.rect1.x,fe.rect1.startY=fe.rect1.y,fe.rect2.startX=fe.rect2.x,fe.rect2.startY=fe.rect2.y;else{var et=Te.target;et.startX=et.x,et.startY=et.y,fe=et.ball;var Ue=fe.index,Re=f;if(n(D[Ue][4])||(Re=D[Ue][4]),Re=="straight"){var Ze=et.other,Je=Ze.x-fe.x,nt=Ze.y-fe.y;Ze.stickLength=Math.sqrt(Math.pow(Je,2)+Math.pow(nt,2))}}if(g.selectPoints){var pt=g.selectionManager.currentSet;if(pt&&pt.selections&&pt.selections.length>0)for(we=0;we<pt.selections.length;we++){var De=g.pointObjects[pt.selections[we]];De[1].startX=De[1].x,De[1].startY=De[1].y,De[2].startX=De[2].x,De[2].startY=De[2].y,De[3].startX=De[3].x,De[3].startY=De[3].y}}}}),g.selectPoints&&ue.tap(function(Te){if(Te.target.rect1){var et=Te.target;g.selectedBalls.toggle(et.parent.num)}else{var Ue=Te.target;Ue.color="white",et=Ue.ball,et.rect1==Ue?g.selectedRect1s.toggle(et.parent.num):g.selectedRect2s.toggle(et.parent.num)}for(we=0;we<g.pointObjects.length;we++){var Re=g.pointObjects[we];Re[1].color=g.selectedBalls.isSelected(we)?S:g.circleColor,Re[2].color=g.selectedRect1s.isSelected(we)?S:Ie(Re[4]),Re[3].color=g.selectedRect2s.isSelected(we)?S:Ie(Re[4])}d.update()}),ue.on("pressmove",function(Te){if(!g.lockControls)if(g.selectPoints){var et=Xe();if(et.indexOf(Te.target)==-1)J(Te.target),g.drawShape();else if(et.length>0){for(var Ue=Te.target.x-Te.target.startX,Re=Te.target.y-Te.target.startY,Ze=0;Ze<et.length;Ze++){var Je=et[Ze];Je.x=Je.startX+Ue,Je.y=Je.startY+Re,J(Je)}g.drawShape()}}else J(Te.target),g.drawShape()}),ue.on("pressup",function(Te){if(!g.lockControls){var et=Te.target.x!=ze.x||Te.target.y!=ze.y,Ue=new $e.Event("change");Te.target.rect1?(Ue.controlType="bezierPoint",it(Te.target)):Ue.controlType="bezierHandle",et&&g.dispatchEvent(Ue)}});function it(Te){if(g.selectPoints){var et=Xe();if(et&&et.indexOf(Te)==-1)se(Te);else if(et&&et.length>0)for(var Ue=0;Ue<et.length;Ue++)se(et[Ue]);else se(Te)}else se(Te)}g.changeControl=function(Te,et,Ue,Re,Ze,Je,nt,pt,De){var lt="index, type, rect1X, rect1Y, rect2X, rect2Y, circleX, circleY, update",vt;if(vt=mt(g.changeControl,arguments,lt))return vt;if(n(Te)){for(we=0;we<D.length;we++)g.changeControl(we,et,Ue,Re,Ze,Je,nt,pt);return}var rt=D[Te];rt[4]=et,et=="none"?(n(nt)||(rt[2].x=nt),n(pt)||(rt[2].y=pt),rt[2].x=rt[1].x,rt[2].y=rt[1].y,rt[3].x=rt[1].x,rt[3].y=rt[1].y,rt[1].parent.addChild(rt[1])):(n(Ue)||(rt[2].x=Ue),n(Re)||(rt[2].y=Re),n(Ze)||(rt[3].x=Ze),n(Je)||(rt[3].y=Je),n(nt)||(rt[1].x=nt),n(pt)||(rt[1].y=pt),rt[1].parent.addChildAt(rt[1],0)),De&&(g.update(),d&&d.update())},g.transformPoints=function(Te,et,Ue,Re,Ze){return n(Ze)&&(Ze=!0),g.points=e.transformPoints(g.points,Te,et,Ue,Re),Ze&&g.approximateBounds(),g},g.traverse=function(Te,et,Ue,Re,Ze){var Je=e.copy(g.segmentRatios);Je.unshift(0),n(Ue)&&(Ue=et+1);var nt=Je[et]*100,pt=Je[Ue]*100,De;!Ze&&nt>pt?De=100-nt+pt:!Ze&&nt<pt?De=pt-nt:Ze&&nt>pt?De=-(nt-pt):Ze&&nt<pt&&(De=-(100-pt+nt));var lt=new $e.Event("traversed");return lt.obj=Te,Te.animate({ease:"linear",props:{path:g,startPercent:nt,percent:De},time:Re,call:function(){g.dispatchEvent(lt)}}),g},g.reversePoints=function(){return i=e.copy(g.points),g.points=e.reversePoints(e.copy(g.points)),g.update(),g},g.appendPoints=function(Te,et){var Ue=e.copy(g.points);return g.points=e.appendPoints(Ue,Te,et),g.update(),g},g.prependPoints=function(Te,et){var Ue=e.copy(g.points);return g.points=e.rependPoints(Ue,i,et),g.update(),g},g.splitPoints=function(Te){var et=e.copy(g.points);if(!(Te<1||Te>et.length-1)){var Ue=e.splitPoints(et,Te),Re=Ue[0],Ze=Ue[1],Je=g.clone();return g.points=Re,g.update(),Je.points=Ze,g.parent&&Je.addTo(g.parent),Je}},g.makeBlob=function(Te,et){n(Te)&&(Te="mirror"),n(et)&&(et=5);var Ue=e.copy(g.points);e.loop(Ue,function(Ze,Je,nt){Ze[8]||(Ze[8]="mirror"),Je==0&&(Te=="free"&&(Ze[4]=Ze[5]=0),Ze[8]=Te),Je==nt-1&&(Te=="free"&&(Ze[6]=Ze[7]=0),Ze[8]=Te)}),Math.abs(Ue[0][0]-Ue[Ue.length-1][0])<et&&Math.abs(Ue[0][1]-Ue[Ue.length-1][1])<et&&(Ue[0][4]=Ue[Ue.length-1][4],Ue[0][5]=Ue[Ue.length-1][5],Ue.pop());var Re=new e.Blob({points:Ue,borderColor:g.color,borderWidth:g.thickness,showControls:g.controlsVisible,interactive:g.interactive,onTop:g.onTop,dashed:g.dashed,stickColor:g.stickColor,stickThickness:g.stickThickness});return Re},g.update=function(Te){return Te?g.points=g.pointsAdjusted:g.drawShape(),g.zimAnimateChanged=!0,g},g.interactive&&(C&&F.drag({onTop:!1}),Ce=F.on("mousedown",function(Te){d=Te.target.stage,ze={x:F.x,y:F.y},g.selectPoints&&(g.keyFocus=!0),je()}),Y=F.on("pressmove",function(){ue.x=F.x,ue.y=F.y,me.x=F.x,me.y=F.y}),Q=F.on("pressup",function(){var Te=F.x!=ze.x||F.y!=ze.y,et=F.localToLocal(g.regX,g.regY,g.parent);if(g.x=et.x,g.y=et.y,ue.x=ue.y=me.x=me.y=F.x=F.y=0,Te){var Ue=new $e.Event("change");Ue.controlType="move",g.dispatchEvent(Ue)}d&&d.update()}),g.move||ie(!0));function je(){if(g.onTop){var Te=g.parent.numChildren-1;g.parent.getChildAt(Te).type=="Keyboard"&&Te--,g.parent.setChildIndex(g,Te)}}g.toggleEvent=g.on("mousedown",function(){g.allowToggle&&(j||(g.showControls(),g.dispatchEvent("controlsshow")))}),g.added(function(){d=g.stage,g.toggleStageEvent&&d.off("stagemousedown",g.toggleStageEvent),g.toggleStageEvent=d.on("stagemousedown",function(Te){!g.allowToggle||!g.stage||j&&!g.hitTestPoint(Te.stageX/e.scaX,Te.stageY/e.scaY,!1)&&(g.hideControls(),g.dispatchEvent("controlshide"))})}),g.clickEvent=g.on("click",function(){g.ctrlKey&&setTimeout(function(){g.clone(!0).addTo(g.stage).mov(0,100),g.allowToggle&&(g.hideControls(),g.dispatchEvent("controlshide"));var Te=new $e.Event("change");Te.controlType="move",g.dispatchEvent(Te),g.stage.update()},50)}),g.hideControls=function(){return g.toggled=!1,ue.visible=!1,me.visible=!1,j=!1,g.stage&&g.stage.update(),!g.allowToggle&&g.move&&ie(),g},p||g.hideControls(),g.showControls=function(){return g.toggled=!0,ue.visible=!0,me.visible=!0,j=!0,ue.x=F.x,ue.y=F.y,me.x=F.x,me.y=F.y,g.addChildAt(F,0),g.move&&!g.allowToggle&&Ae(),g.stage&&g.stage.update(),g},g.toggle=function(Te){return Te===!0?g.showControls():Te===!1||j?g.hideControls():g.showControls(),g},g.recordData=function(Te){n(Te)&&(Te=!1);var et={type:"Squiggle",index:g.parent?g.parent.getChildIndex(g):-1,x:g.x,y:g.y,points:g.getPoints(),color:g.color,thickness:g.thickness,move:g.move,allowToggle:g.allowToggle,controlsVisible:j};return Te?JSON.stringify(et):et},g.setData=function(Te,et){if(!n(Te)){if(et)try{Te=JSON.parse(Te)}catch(Je){return}var Ue=Te.index;n(Ue)&&(Ue=-1),delete Te.index;var Re=Te.points;n(Re)||g.setPoints(Re),delete Te.points,g.num=Re.length;for(var Ze in Te)g[Ze]=Te[Ze];return g.parent&&g.parent.setChildIndex(g,Ue),g.update(),g}},g.getPoints=function(Te){n(Te)&&(Te=!1);var et=g.points;if(Te){if(!g.pane){var Ue=g.pane=new e.Pane({container:g.stage,width:Math.min(500,g.stage.width-20),height:Math.min(500,g.stage.height-20),draggable:!0}),Re=g.textArea=new e.TextArea(Math.min(400,g.stage.width-70),Math.min(400,g.stage.height-70));Re.centerReg(Ue)}g.textArea.text=JSON.stringify(et),g.pane.show()}return et},g.recordPoints=g.getPoints,g.setPoints=function(Te){for(var et,Ue,Re=0;Re<Te.length;Re++)et=D[Re],Ue=Te[Re],!n(et)&&(et[0].x=Ue[0],et[0].y=Ue[1],et[1].x=Ue[2],et[1].y=Ue[3],et[2].x=Ue[4],et[2].y=Ue[5],et[3].x=Ue[6],et[3].y=Ue[7],et[4]=Ue[8]);return g.update(),g},V!==!1&&e.styleTransforms(g,U),g.clone=function(Te,et){var Ue=[],Re=!1;e.loop(g.pointControls,function(Je){Je.scaleX+Je.scaleY+Je.regX+Je.regY+Je.rotation!=2&&(Re=!0),Ue.push([Je.scaleX,Je.scaleY,Je.regX,Je.regY,Je.rotation])});var Ze=g.cloneProps(new e.Squiggle(et?g.colorCommand:Te||!e.isPick(G[0])?g.color:G[0],g.thickness,g.getPoints(),o,l,f,h,ue.visible,_,b,g.allowToggle,g.move,O,P,g.circleColor,g.circleBorderColor,g.stickColor,g.stickThickness,S,E,g.editPoints,X,q,V,g.group,te));return Re&&(e.loop(Ze.pointControls,function(Je,nt){Je.scaleX=Ue[nt][0],Je.scaleY=Ue[nt][1],Je.regX=Ue[nt][2],Je.regY=Ue[nt][3],Je.rotation=Ue[nt][4]}),Ze.update()),g.linearGradientParams&&Ze.linearGradient.apply(Ze,g.linearGradientParams),g.radialGradientParams&&Ze.radialGradient.apply(Ze,g.radialGradientParams),Ze},g.shape.on("mousedown",function(Te){d=Te.target.stage,g.editPoints&&(g.controlsVisible?(g.pressX=Te.stageX/e.scaX,g.pressY=Te.stageY/e.scaX):(g.pressX=null,g.pressY=null))}),g.addPointFactor=10,g.addMinDistance=15,g.shape.on("pressup",function(Te){if(g.editPoints&&g.pressX&&Math.abs(g.pressX-Te.stageX/e.scaX)<pe&&Math.abs(g.pressY-Te.stageY/e.scaY)<pe){g.selectPoints&&(g.lastPoints=e.copy(g.points));var et=g.points,Ue=g.globalToLocal(Te.stageX/e.scaX,Te.stageY/e.scaY),Re=e.closestPointAlongCurve(Ue,g.segmentPoints);if(g.editPoints=="anywhere")et.splice(Re+1,0,[Ue.x,Ue.y,0,0,0,0,0,0]),g.points=et,g.changeControl({index:Re+1,type:"mirror",update:!0});else{var Ze=g.pointsAdjusted,Je=g.getSegmentPoint(Ze[Re],Ze[(Re+1)%Ze.length]),nt=e.distanceAlongCurve(Je),pt=Math.round(nt/g.addPointFactor),De=g.interpolate(pt,Re,!1,et),lt=1e4,vt;if(e.loop(De,function(_t,ft){var Ot=e.dist(_t,Ue);Ot<lt&&(lt=Ot,vt=ft)}),lt<g.addMinDistance){var rt=g.segmentRatios,xt=rt[Re],wt=Re>0?rt[Re-1]:0;g.addPoint(100*(wt+(xt-wt)*(vt/(pt+1))))}}g.lastSelectedIndex=Re+1,g.lastSelected=g.controls.getChildAt(g.lastSelectedIndex),g.stage.update()}}),g.controls.on("click",function(Te){g.lastSelected=Te.target.parent,g.lastSelectedIndex=g.controls.getChildIndex(Te.target.parent),g.editPoints&&g.selectionManager.shiftKey&&tt(Te)});function tt(Te){if(Te.target.type=="Circle"){var et=g.lastSelectedIndex=g.controls.getChildIndex(Te.target.parent);if(g.controls.numChildren<=2)return;var Ue=g.points;g.selectPoints&&(g.lastPoints=e.copy(Ue)),Ue.splice(et,1),g.points=Ue,g.stage.update(),g.lastSelected=g.lastSelectedIndex=null}}g.controls.hold(tt),j||g.hideControls(),g.dispatchEvent("update")}function Xe(){var me=[],Oe=g.selectionManager.currentSet;if(Oe&&Oe.selections&&Oe.selections.length>0)for(var Ye=0;Ye<Oe.selections.length;Ye++){var de=g.pointObjects[Oe.selections[Ye]];if(Oe==g.selectedBalls)me.push(de[1]);else if(Oe==g.selectedRect1s)me.push(de[2]);else if(Oe==g.selectedRect2s)me.push(de[3]);else continue}return me}function se(me){if(me.type=="Circle"){var Oe=me,Ye=Oe.mySet,de=Oe.rect1,ve=Oe.rect2;de.x-=Oe.x,de.y-=Oe.y,ve.x-=Oe.x,ve.y-=Oe.y,Ye.x+=Oe.x,Ye.y+=Oe.y,Oe.x=0,Oe.y=0}}g.selectionManager.on("keydown",function(me){if(g.selectPoints&&g.keyFocus&&me.keyCode>=37&&me.keyCode<=40){var Oe=Xe();if(Oe.length>0){for(var Ye=0;Ye<Oe.length;Ye++){var de=Oe[Ye];me.keyCode==37?de.x-=g.selectionManager.shiftKey?10:1:me.keyCode==39?de.x+=g.selectionManager.shiftKey?10:1:me.keyCode==38?de.y-=g.selectionManager.shiftKey?10:1:me.keyCode==40&&(de.y+=g.selectionManager.shiftKey?10:1),J(de)}g.drawShape(),g.dispatchEvent("update"),g.stage&&g.stage.update()}}}),g.selectionManager.on("keyup",function(me){if(g.selectPoints&&g.keyFocus&&me.keyCode>=37&&me.keyCode<=40){var Oe=Xe();if(Oe.length>0)for(var Ye=0;Ye<Oe.length;Ye++)se(Oe[Ye])}}),g.selectionManager.on("undo",function(){if(g.selectPoints&&g.keyFocus&&g.lastPoints){var me=e.copy(g.lastPoints);g.lastPoints=e.copy(g.points),g.points=me,g.stage&&g.stage.update()}}),J=function(me){if(!g.lockControls){var Oe;if(me.rect1){Oe=me;var Ye=Oe.x-Oe.startX,de=Oe.y-Oe.startY;Oe.rect1.x=Oe.rect1.startX+Ye,Oe.rect1.y=Oe.rect1.startY+de,Oe.rect2.x=Oe.rect2.startX+Ye,Oe.rect2.y=Oe.rect2.startY+de}else{var ve=me,Me=ve.other;Oe=ve.ball;var we=Oe.index,Fe=f;if(n(D[we][4])||(Fe=D[we][4]),Fe=="straight"||Fe=="mirror"){var ge=ve.x-Oe.x,Ve=ve.y-Oe.y;if(Fe=="mirror")Me.x=Oe.x-ge,Me.y=Oe.y-Ve;else{var He=Math.atan2(Ve,ge),Le=-Me.stickLength*Math.cos(He+Math.PI),fe=-Me.stickLength*Math.sin(He+Math.PI);Me.x=Oe.x-Le,Me.y=Oe.y-fe}}}}},Object.defineProperty(g,"move",{get:function(){return C},set:function(me){C!=me&&(C=me,me?Ae():ie())}}),Object.defineProperty(g,"interactive",{get:function(){return X},set:function(me){X=me,j=X,g.allowToggle=X,g.editPoints=X,g.lockControls=!X,g.selectPoints=X,g.move=X;var Oe=g.points;g.points=Oe}}),Object.defineProperty(g,"allowToggle",{get:function(){return w},set:function(me){w!=me&&(w=me,w?g.move&&Ae():!j&&g.move&&ie())}});function Ae(){g.move!="always"&&(ce||(ce=!0,F.drag({onTop:!1}),Ce=F.on("mousedown",Ce),Y=F.on("pressmove",Y),Q=F.on("pressup",Q)))}function ie(me){g.move!="always"&&(!me&&!ce||(ce=!1,F.noDrag(),F.off("mousedown",Ce),F.off("pressmove",Y),F.off("pressup",Q)))}var _e=_;Object.defineProperty(g,"lockControls",{get:function(){return _e},set:function(me){_e=me,me?(g.controls.mouseChildren=!1,g.controls.mouseEnabled=!1):(g.controls.mouseChildren=!0,g.controls.mouseEnabled=!0)}}),g.lockControls=_e,Object.defineProperty(g,"controlsVisible",{get:function(){return j},set:function(me){j=me,me?g.showControls():g.hideControls()}}),le.KEYFOCUS!=null&&(e.KEYFOCUS=le.KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return e.KEYFOCUS==g},set:function(){e.KEYFOCUS=g}}),e.KEYFOCUS||$();function $(){if(g.selectPoints){g.keyFocus=!0;var me=document.activeElement;me&&me.blur()}}Object.defineProperty(g,"points",{get:function(){for(var me=[],Oe,Ye,de=0;de<D.length;de++)Ye=D[de],Oe=[e.decimals(Ye[0].x),e.decimals(Ye[0].y),e.decimals(Ye[1].x),e.decimals(Ye[1].y),e.decimals(Ye[2].x),e.decimals(Ye[2].y),e.decimals(Ye[3].x),e.decimals(Ye[3].y)],Ye[4]&&Ye[4]!=="mirror"&&Oe.push(Ye[4]),me.push(Oe);return me},set:function(me){var Oe=g.x,Ye=g.y,de=g.visible,ve=[],Me=!1;e.loop(g.pointControls,function(we){we.scaleX+we.scaleY+we.regX+we.regY+we.rotation!=2&&(Me=!0),ve.push([we.scaleX,we.scaleY,we.regX,we.regY,we.rotation])}),g.dispose(!0),i=me,ye(),g.lockControls=_e,g.x=Oe,g.y=Ye,g.visible=de,Me&&(e.loop(g.pointControls,function(we,Fe){we.scaleX=ve[Fe][0],we.scaleY=ve[Fe][1],we.regX=ve[Fe][2],we.regY=ve[Fe][3],we.rotation=ve[Fe][4]}),g.update())}}),Object.defineProperty(g,"pointsAdjusted",{get:function(){var me=[],Oe,Ye,de,ve=g.pointObjects;return e.loop(ve.length,function(Me){if(de=ve[Me],Ye=D[Me],de[0].rotation==0&&de[0].scaleX==0&&de[0].scaleY==0)Oe=[e.decimals(Ye[0].x),e.decimals(Ye[0].y),e.decimals(Ye[1].x),e.decimals(Ye[1].y),e.decimals(Ye[2].x),e.decimals(Ye[2].y),e.decimals(Ye[3].x),e.decimals(Ye[3].y)];else{var we=de[0].localToLocal(de[2].x,de[2].y,de[0].parent),Fe=de[0].localToLocal(de[3].x,de[3].y,de[0].parent);Oe=[e.decimals(Ye[0].x),e.decimals(Ye[0].y),e.decimals(Ye[1].x),e.decimals(Ye[1].y),e.decimals(we.x-Ye[0].x),e.decimals(we.y-Ye[0].y),e.decimals(Fe.x-Ye[0].x),e.decimals(Fe.y-Ye[0].y)]}Ye[4]&&Ye[4]!=="mirror"&&Oe.push(Ye[4]),me.push(Oe)}),me},set:function(){Ct&&ht("Squiggle() - pointsAdjusted is read only")}}),Object.defineProperty(g,"pointObjects",{get:function(){return D},set:function(){Ct&&ht("Squiggle() - pointObjects is read only - but its contents can be manipulated - use squiggle.update() after changes")}}),Object.defineProperty(g,"pointControls",{get:function(){return m},set:function(){Ct&&ht("Squiggle() - pointControls is read only - but its contents can be manipulated - use blob.update() after changes")}}),Object.defineProperty(g,"pointCircles",{get:function(){return K},set:function(){Ct&&ht("Squiggle() - pointCircles is read only - but its contents can be manipulated - use blob.update() after changes")}}),Object.defineProperty(g,"segmentPoints",{get:function(){var me=[],Oe=g.pointsAdjusted;return e.loop(Oe.length-1,function(Ye){var de=g.getSegmentPoint(Oe[Ye],Oe[Ye+1]);me.push(de)}),me},set:function(){Ct&&ht("Squiggle() - segmentPoints is read only")}}),Object.defineProperty(g,"segmentRatios",{get:function(){var me=[],Oe=0;e.loop(g.segmentPoints,function(ve){var Me=e.distanceAlongCurve(ve);me.push(Me),Oe+=Me});var Ye=[],de=0;return e.loop(me,function(ve){var Me=ve/Oe;de+=Me,Ye.push(de)}),Ye},set:function(){Ct&&ht("Squiggle() - segmentRatios is read only")}}),g.approximateBounds=function(me,Oe,Ye){n(me)&&(me=80),n(Ye)&&(Ye=0),me/=g.num;var de=g.interpolate(me,null,!0,null,!0),ve=e.boundsAroundPoints(de);if(g.setBounds(ve.x-Ye,ve.y-Ye,ve.width+Ye*2,ve.height+Ye*2),Oe){if(!g.parent)return Ct&&ht("approximateBounds() - add to stage to first to see points"),g;g.hitPathPoints?g.hitPathPoints.removeAllChildren():g.hitPathPoints=new e.Container().addTo(),g.hitPathPoints.top();for(var Me=0;Me<de.length;Me++){var we=de[Me];we=g.localToGlobal(we.x,we.y),new e.Circle(3).loc(we.x,we.y,g.hitPathPoints)}}return g},g.getPointAngle=function(me){var Oe=g.pointObjects[me][0],Ye=g.pointObjects[me][2],de=g.pointObjects[me][3],ve,Me;return Oe==g.stage?(ve=new e.Point(Ye.x,Ye.y),Me=new e.Point(de.x,de.y)):(ve=Oe.localToGlobal(Ye.x,Ye.y),Me=Oe.localToGlobal(de.x,de.y)),e.angle(ve.x,ve.y,Me.x,Me.y)},g.getSegmentPoint=function(me,Oe){if(!(n(me)||n(Oe))){(me[2]!=0||me[3]!=0)&&(me[4]-=me[2],me[5]-=me[3],me[6]-=me[2],me[7]-=me[3],me[0]+=me[2],me[1]+=me[3],me[2]=0,me[3]=0),(Oe[2]!=0||Oe[3]!=0)&&(Oe[4]-=Oe[2],Oe[5]-=Oe[3],Oe[6]-=Oe[2],Oe[7]-=Oe[3],Oe[0]+=Oe[2],Oe[1]+=Oe[3],Oe[2]=0,Oe[3]=0);var Ye={x:me[0],y:me[1]},de={x:me[0]+me[6],y:me[1]+me[7]},ve={x:Oe[0]+Oe[4],y:Oe[1]+Oe[5]},Me={x:Oe[0],y:Oe[1]};return(ue.x!=0||ue.y!=0)&&(Ye.x+=ue.x,de.x+=ue.x,ve.x+=ue.x,Me.x+=ue.x,Ye.y+=ue.y,de.y+=ue.y,ve.y+=ue.y,Me.y+=ue.y),[Ye,de,ve,Me]}},g.getAdjacentSegmentData=function(me){n(me)&&(me=0);var Oe=g.pointsAdjusted;return g.num==2?[[g.getSegmentPoint(Oe[0],Oe[1])],[0]]:me==0?[[g.getSegmentPoint(Oe[0],Oe[1]),g.getSegmentPoint(Oe[1],Oe[2])],[0,1]]:me>=g.num-2?[[g.getSegmentPoint(Oe[g.num-3],Oe[g.num-2]),g.getSegmentPoint(Oe[g.num-2],Oe[g.num-1])],[g.num-3,g.num-2]]:[[g.getSegmentPoint(Oe[me-1],Oe[me]),g.getSegmentPoint(Oe[me],Oe[me+1]),g.getSegmentPoint(Oe[me+1],Oe[me+2])],[me-1,me,me+1]]},g.getCurvePoint=function(me,Oe,Ye,de,ve){(n(me)||isNaN(me))&&(me=0),n(Oe)&&(Oe=g.segmentRatios),n(Ye)&&(Ye=g.segmentPoints),n(de)&&(de=!1),n(ve)&&(ve=!1);var Me=Oe,we=Ye,Fe=e.loop(Me,function(Ge,Qe){if(Ge>=me)return Qe}),ge=Fe>0?Me[Fe-1]:0,Ve=Fe>0?Me[Fe]-Me[Fe-1]:Me[Fe];if(Ve){var He=(me-ge)/Ve,Le=e.pointAlongCurve(we[Fe],He,de,!0),fe=g.localToGlobal(Le.x,Le.y);return fe.angle=Le.angle,fe.z=Fe,n(fe)?void 0:fe}};function xe(me,Oe,Ye){return{x:me.x+(Oe.x-me.x)*Ye,y:me.y+(Oe.y-me.y)*Ye}}function Be(me,Oe,Ye,de,ve,Me,we,Fe){var ge=me.length-1,Ve=0,He=0;de==100&&g.type=="Squiggle"&&(de=99.99),de=(de+1e5)%100,e.loop(Ye,function(Ie,be){if(de/100<Ie)return ge=be,He=Ie,!0;Ve=Ie});var Le=g.segmentPoints[ge],fe=He>0?(de/100-Ve)/(He-Ve):0,Ge=e.pointAlongCurve(Le,fe,null,Fe),Qe=[Ge.x,Ge.y,0,0];if(!Me){if(we){g.interpolatedPoints.push({x:Ge.x,y:Ge.y,r:de/100});return}if(ve!="none"){var Ke=xe(Le[0],Le[1],fe),st=xe(Le[1],Le[2],fe),yt=xe(Le[2],Le[3],fe),We=xe(Ke,st,fe),at=xe(st,yt,fe);Qe[4]=We.x-Ge.x,Qe[5]=We.y-Ge.y,Qe[6]=at.x-Ge.x,Qe[7]=at.y-Ge.y;var ct=g.localToLocal(Ke.x,Ke.y,Oe[ge]);me[ge][6]=ct.x,me[ge][7]=ct.y;var Pe=g.localToLocal(yt.x,yt.y,Oe[(ge+1)%me.length]);me[(ge+1)%me.length][4]=Pe.x,me[(ge+1)%me.length][5]=Pe.y}ve&&(Qe[8]=ve),me.splice(ge+1,0,Qe)}}this.addPoint=function(me,Oe){n(me)&&(me=100);var Ye=g.points,de=g.segmentRatios,ve=g.pointControls;return Oe=Oe||he,Be(Ye,ve,de,me,Oe),g.points=Ye,g.num=Ye.length,g},this.removePoint=function(me){if(!(n(me)||me<0)){var Oe=e.copy(g.points);return Oe.splice(me,1),g.points=Oe,g.stage&&g.stage.update(),g}},this.addPoints=function(me,Oe,Ye,de,ve,Me,we){n(Me)&&(Me=e.copy(g.points));var Fe=e.copy(g.segmentRatios),ge=0;if(ve&&(g.interpolatedPoints=[]),de)var Ve=Fe.length*me;return e.loop(Fe,function(He,Le){ve&&Be(Me,g.pointControls,g.segmentRatios,ge*100,Oe,!n(Ye)&&Le!=Ye,ve,we);var fe=de?Math.round(Ve*(He-ge)):me,Ge=1/(fe+1);e.loop(fe,function(Qe){var Ke=ge+(He-ge)*Ge*(Qe+1);Be(Me,g.pointControls,g.segmentRatios,Ke*100,Oe,!n(Ye)&&Le!=Ye,ve,we),!ve&&me>0&&(g.points=Me)}),ge=He}),ve&&g.type=="Squiggle"&&Be(Me,g.pointControls,g.segmentRatios,100,Oe,!1,ve,we),g.stage&&g.stage.update(),g.num=Me.length,g},this.interpolate=function(me,Oe,Ye,de,ve){return n(me)&&(me=1),g.addPoints(me,"none",Oe,Ye,!0,de,ve),g.interpolatedPoints},ae&&g.approximateBounds(),this.dispose=function(me,Oe,Ye){if(g.shape){if(e.gD(g),d&&g.toggleStageEvent&&d.off("stagemousedown",g.toggleStageEvent),g.controls.noDrag(),g.controls.removeAllEventListeners(),g.selectPoints&&g.selectionManager&&g.selectionManager.dispose(),g.selectedBalls=null,g.selectedRect1s=null,g.selectedRect2s=null,g.selectionManager=null,g.off("mousedown",g.toggleEvent),g.off("click",g.clickEvent),me){g.shape.dispose(),g.shape=null;for(var de=0;de<g.points.length;de++)g.pointObjects[de][0].removeAllEventListeners(),g.pointObjects[de][1].removeAllEventListeners(),g.pointObjects[de][2].removeAllEventListeners(),g.pointObjects[de][3].removeAllEventListeners();g.controls.removeFrom(g),g.sticks.dispose(),D=null,K=null}else g.removeAllEventListeners(),D=null,K=null,Ye||this.zimCustomShape_dispose(!0);return!0}}},e.extend(e.Squiggle,e.CustomShape,["clone","dispose"],"zimCustomShape",!1),e.Blob=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B){var Z="color, borderColor, borderWidth, points, radius, controlLength, controlType, lockControlType, showControls, lockControls, handleSize, allowToggle, move, dashed, onTop, circleColor, circleBorderColor, stickColor, stickThickness, selectColor, selectPoints, editPoints, interactive, strokeObj, style, group, inherit",U;if(U=mt(e.Blob,arguments,Z,this))return U;qe("53.5"),this.group=te;var ee=I===!1?{}:e.getStyle("Blob",this.group,B);n(l)&&(l=ee.radius!=null?ee.radius:100),this.zimCustomShape_constructor(-l,-l,l*2,l*2,!1),this.type="Blob",this.mouseChildren=!0,n(P)&&(P=ee.dashed!=null?ee.dashed:!1),n(r)&&(r=ee.borderColor!=null?ee.borderColor:null),n(i)&&(i=ee.borderWidth!=null?ee.borderWidth:null),r<0||i<0?r=i=null:r!=null&&i==null&&(i=1),n(t)&&(t=ee.color!=null?ee.color:i>0?"rgba(0,0,0,0)":e.green),t.style&&(this.colorCommand=t,t=e.black),r&&r.style&&(this.borderColorCommand=r,r=e.black),n(o)&&(o=ee.points!=null?ee.points:4);var ae=typeof o!="number",re=typeof o=="number"?o:o.length,he=f;n(f)&&(f=ee.controlLength!=null?ee.controlLength:l*4/re),n(h)&&(h=ee.controlType!=null?ee.controlType:null);var j=h;n(h)&&(h="straight"),n(p)&&(p=ee.lockControlType!=null?ee.lockControlType:!1),n(q)&&(q=ee.interactive!=null?ee.interactive:!0),n(_)&&(_=ee.showControls!=null?ee.showControls:q);var G=_;n(b)&&(b=ee.lockControls!=null?ee.lockControls:!q),n(w)&&(w=ee.handleSize!=null?ee.handleSize:e.mobile()?20:10),n(C)&&(C=ee.allowToggle!=null?ee.allowToggle:q),n(O)&&(O=ee.move!=null?ee.move:q),n(R)&&(R=ee.circleColor!=null?ee.circleColor:e.light),n(T)&&(T=ee.circleBorderColor!=null?ee.circleBorderColor:e.dark),n(L)&&(L=ee.stickColor!=null?ee.stickColor:e.darker),n(S)&&(S=ee.stickThickness!=null?ee.stickThickness:1),n(E)&&(E=ee.selectColor!=null?ee.selectColor:e.white),n(k)&&(k=ee.selectPoints!=null?ee.selectPoints:q),this.circleColor=R,this.circleBorderColor=T,this.stickColor=L,this.stickThickness=S,n(A)&&(A=ee.onTop!=null?ee.onTop:!0),n(X)&&(X=ee.editPoints!=null?ee.editPoints:q),n(V)&&(V=ee.strokeObj!=null?ee.strokeObj:{});var y=g(t,r);this.veeObj={color:y[0],borderColor:y[1]};function g(){return arguments}t=e.Pick.choose(t),r=e.Pick.choose(r);var d=this;this.interactive=q,this.num=re,this.editPoints=X,this.selectPoints=k,this.lockControls=b,this.onTop=A,this.move=O,this.allowToggle=C,this.lockControlType=p,this.types=["mirror","straight","free","none"];var D,K,m;d._color=t,d._borderColor=r,d._borderWidth=i,d._dashed=P,d._dashed&&!Array.isArray(d._dashed)&&(d._dashed=[10,10]);var F,Ce,Y,Q,ce,pe=d.move,J=2,ue,ye;o=Xe(o);function Xe(de){(de=="circle"||de=="rectangle"||de=="triangle")&&(de=="circle"&&(de=new e.Circle(l)),de=="rectangle"&&(de=new e.Rectangle(l*2,l*2).centerReg({add:!1})),de=="triangle"&&(de=new e.Triangle(l*2,l*2,l*2)));var ve;if(de.type=="Circle"||de.type=="Rectangle"||de.type=="Triangle"||de.type=="Flare"){var Me=de.getBounds();if(de.type=="Circle")ve=4,he=f=l*2*.5523;else if(de.type=="Rectangle")de.centerReg({add:!1}),ve=[[Me.x-Me.width/2,Me.y-Me.height/2],[Me.x+Me.width/2,Me.y-Me.height/2],[Me.x+Me.width/2,Me.y+Me.height/2],[Me.x-Me.width/2,Me.y+Me.height/2]],d.setBounds(Me.x-Me.width/2,Me.y-Me.height/2,Me.width,Me.height),d.regX=de.regX-Me.width/2,d.regY=de.regY-Me.height/2;else if(de.type=="Triangle")ve=[[de.three.x-de.width/2,de.three.y+de.height/2+de.adjusted],[de.two.x-de.width/2,de.two.y+de.height/2+de.adjusted],[de.one.x-de.width/2,de.one.y+de.height/2+de.adjusted]],d.setBounds(Me.x-Me.width/2,Me.y-Me.height/2,Me.width,Me.height);else if(de.type=="Flare"){var we=Me.width/2+Me.x,Fe=Me.height/2+Me.y;ve=[];var ge=e.copy(de.points),Ve={x:null,y:null};e.loop(ge,(He,Le)=>{var fe=Math.round(He.x),Ge=Math.round(He.y);fe==Ve.x&&Ge==Ve.y||(Ve={x:fe,y:Ge},ve.push([fe-we,He.y-Fe]))}),d.setBounds(-de.width/2,-de.height/2,de.width,de.height)}return ve}else return de}if(typeof o=="string"){var se=new e.SVGContainer;o=se.processPath(o),o[0][0]==o[o.length-1][0]&&o[0][1]==o[o.length-1][1]&&(o[0][4]=o[o.length-1][4],o[0][5]=o[o.length-1][5],o.pop())}j&&typeof o!="number"&&e.loop(o,function(de){de[8]=j,j=="none"&&(de[4]=de[5]=de[6]=de[7]=0)}),Ae();function Ae(){if(ye&&ye.removeAllEventListeners(),d.selectPoints?(d.selectedBalls=new e.SelectionSet,d.selectedRect1s=new e.SelectionSet,d.selectedRect2s=new e.SelectionSet,d.selectionManager=new e.SelectionManager([d.selectedBalls,d.selectedRect1s,d.selectedRect2s],"ctrl",!1)):d.selectionManager=new e.SelectionManager(null,"ctrl"),re=typeof o=="number"?o:o.length,re<=0)return;n(he)&&(f=l*4/re),F=d.shape=new e.Shape({style:!1}).addTo(d);var de=d.sticks=new e.Shape({style:!1}).addTo(d);w<=0&&de.removeFrom();var ve=F.graphics;ve.c();var Me=de.graphics;Me.c();var we=w/10*8,Fe=w,ge=e.mobile();ye=d.controls=new e.Container({style:!1}).addTo(d),d.interactive&&ye.drag({onTop:!ge}),D=[],m=[],K=[];var Ve,He,Le,fe,Ge,Qe,Ke,st,yt;for(Ve=0;Ve<re;Ve++){if(fe=new e.Container({style:!1}).addTo(ye),fe.num=Ve,typeof o=="number"){var We=e.Pick.choose(f);Le=new e.Container(We,l,null,null,!1).reg(We/2,l).addTo(d),Le.rotation=Ve/re*360,Ke=new e.Circle(we,d.selectPoints&&d.selectedBalls.isSelected(Ve)?E:d.circleColor,d.circleBorderColor,2,null,null,null,null,!1).centerReg(Le).loc({x:We/2,y:0}),Ge=new e.Rectangle(Fe,Fe,d.selectPoints&&d.selectedRect1s.isSelected(Ve)?E:it(h),w==0?null:e.dark,w==0?null:2,null,null,null,null,!1).centerReg(Le).loc({x:0,y:0}),Qe=new e.Rectangle(Fe,Fe,d.selectPoints&&d.selectedRect2s.isSelected(Ve)?E:it(h),w==0?null:e.dark,w==0?null:2,null,null,null,null,!1).centerReg(Le).loc({x:We,y:0});var at=Le.localToLocal(Ke.x,Ke.y,ye);Ke.x=at.x,Ke.y=at.y,Ke.addTo(fe,null,!1);var ct=Le.localToLocal(Ge.x,Ge.y,ye);Ge.x=h=="none"?0:ct.x-Ke.x,Ge.y=h=="none"?0:ct.y-Ke.y,Ge.addTo(fe,null,!1);var Pe=Le.localToLocal(Qe.x,Qe.y,ye);Qe.x=h=="none"?0:Pe.x-Ke.x,Qe.y=h=="none"?0:Pe.y-Ke.y,Qe.addTo(fe,null,!1),fe.x=Ke.x,fe.y=Ke.y,Ke.x=0,Ke.y=0,h=="none"&&Ke.addTo(fe,null,!1)}else yt=o[Ve],st=yt[8]?yt[8]:h,fe.loc({x:yt[0],y:yt[1]}),Ke=new e.Circle(we,d.circleColor,d.circleBorderColor,2,null,null,null,null,!1).centerReg({add:!1}).addTo(fe).loc({x:yt[2],y:yt[3]}),Ge=new e.Rectangle(Fe,Fe,it(st),w==0?null:e.dark,w==0?null:2,null,null,null,null,!1).centerReg({add:!1}).addTo(fe,0).loc({x:yt[4],y:yt[5]}),Qe=new e.Rectangle(Fe,Fe,it(st),w==0?null:e.dark,w==0?null:2,null,null,null,null,!1).centerReg({add:!1}).addTo(fe,0).loc({x:yt[6],y:yt[7]});Ke.mySet=fe,Ke.rect1=Ge,Ke.rect2=Qe,Ke.index=Ve,w==0&&(Ke.expand(10),Ge.expand(10),Qe.expand(10)),ge?Ke.on("mousedown",be):Ke.on("dblclick",ze),Ge.ball=Ke,Ge.other=Qe,Qe.ball=Ke,Qe.other=Ge,ge&&(Ke.expand(),Ge.expand(),Qe.expand()),He=[fe,Ke,Ge,Qe,yt?yt[8]:h],D.push(He),K.push(Ke),m.push(fe)}var Ie=!1;function be(Ue){Ie?(Ue.preventDefault(),ze(Ue)):(Ie=!0,setTimeout(function(){Ie=!1},300))}function ze(Ue){if(!d.lockControlType){var Re=Ue.target,Ze=D[Re.index][4]?D[Re.index][4]:h;Math.abs(Re.rect1.x)<=2&&Math.abs(Re.rect1.y)<=2&&Math.abs(Re.rect2.x)<=2&&Math.abs(Re.rect2.y)<=2&&(Ze="none"),Ze=="none"&&Re.parent.addChildAt(Re,0),Ze=d.types[(d.types.indexOf(Ze)+(d.shiftKey?-1:1)+d.types.length)%d.types.length],Ze=="none"&&(Re.rect1.x=Re.rect1.y=Re.rect2.x=Re.rect2.y=0,Re.parent.addChild(Re),Ue.stopImmediatePropagation()),D[Re.index][4]=Ze,Re.rect1.color=it(Ze),Re.rect2.color=it(Ze),d.drawShape();var Je=new $e.Event("change");Je.controlType="bezierSwitch",d.dispatchEvent(Je),Re.stage.update()}}function it(Ue){var Re={mirror:"#993399",free:"#ebcb35",none:"#50c4b7"};return Re[Ue]?Re[Ue]:"#e472c4"}d.drawShape=function(){var Ue,Re,Ze,Je,nt,pt,De,lt,vt,rt,xt,wt,_t;ve.c(),d.colorCommand||(d.colorCommand=ve.f(d._color).command,t&&t.type&&d.specialColor(d.colorCommand,t,d)),(n(d._borderWidth)||d._borderWidth>0)&&(!n(d._borderColor)||!n(d._borderWidth))&&(n(d._borderColor)&&(d._borderColor=e.black),d.borderColorCommand||(d.borderColorCommand=ve.s(d._borderColor).command,d._borderColor&&d._borderColor.type&&d.specialColor(d.borderColorCommand,d._borderColor,d)),d.borderWidthCommand||(d.borderWidthCommand=ve.ss(d._borderWidth,V.caps,V.joints,V.miterLimit,V.ignoreScale).command),d._dashed&&(d.borderDashedCommand||(d.borderDashedCommand=ve.sd(Array.isArray(d._dashed)?d._dashed:[10,10],d._dashedOffset).command))),Ze=D[0][0],De=Ze.localToLocal(D[0][1].x,D[0][1].y,F),ve.mt(De.x,De.y),Me.c().s(d.stickColor).ss(d.stickThickness);for(var ft=0;ft<D.length;ft++)Ue=ft,Re=(ft+1)%D.length,Ze=D[Ue][0],Ke=D[Ue][1],Je=D[Ue][2],nt=D[Ue][3],pt=D[Re][0],lt=D[Re][1],vt=D[Re][2],xt=Ze.localToLocal(nt.x,nt.y,F),wt=pt.localToLocal(vt.x,vt.y,F),_t=pt.localToLocal(lt.x,lt.y,F),ve.bt(xt.x,xt.y,wt.x,wt.y,_t.x,_t.y),De=Ze.localToLocal(Ke.x,Ke.y,F),rt=Ze.localToLocal(Je.x,Je.y,F),Me.mt(De.x,De.y).lt(rt.x,rt.y),Me.mt(De.x,De.y).lt(xt.x,xt.y);ve.cp(),ve.append(d.colorCommand),d._dashed&&ve.append(d.borderDashedCommand),d.borderWidthCommand&&ve.append(d.borderWidthCommand),d.borderColorCommand&&ve.append(d.borderColorCommand)},d.drawShape(),t.type&&(d.color=t);var je;ye.on("mousedown",function(Ue){if(!d.lockControls){d.selectPoints&&(d.keyFocus=!0),je={x:Ue.target.x,y:Ue.target.y};var Re;if(Ue.target.rect1)Re=Ue.target,Re.startX=Re.x,Re.startY=Re.y,Re.rect1.startX=Re.rect1.x,Re.rect1.startY=Re.rect1.y,Re.rect2.startX=Re.rect2.x,Re.rect2.startY=Re.rect2.y;else{var Ze=Ue.target;Ze.startX=Ze.x,Ze.startY=Ze.y,Re=Ze.ball;var Je=Re.index,nt=h;if(n(D[Je][4])||(nt=D[Je][4]),nt=="straight"){var pt=Ze.other,De=pt.x-Re.x,lt=pt.y-Re.y;pt.stickLength=Math.sqrt(Math.pow(De,2)+Math.pow(lt,2))}}if(d.selectPoints){var vt=d.selectionManager.currentSet;if(vt&&vt.selections&&vt.selections.length>0)for(var rt=0;rt<vt.selections.length;rt++){var xt=d.pointObjects[vt.selections[rt]];xt[1].startX=xt[1].x,xt[1].startY=xt[1].y,xt[2].startX=xt[2].x,xt[2].startY=xt[2].y,xt[3].startX=xt[3].x,xt[3].startY=xt[3].y}}}}),d.selectPoints&&ye.tap(function(Ue){var Re;if(Ue.target.rect1)Re=Ue.target,d.selectedBalls.toggle(Re.parent.num);else{var Ze=Ue.target;Ze.color="white",Re=Ze.ball,Re.rect1==Ze?d.selectedRect1s.toggle(Re.parent.num):d.selectedRect2s.toggle(Re.parent.num)}for(var Je=0;Je<d.pointObjects.length;Je++){var nt=d.pointObjects[Je];nt[1].color=d.selectedBalls.isSelected(Je)?E:d.circleColor,nt[2].color=d.selectedRect1s.isSelected(Je)?E:it(nt[4]),nt[3].color=d.selectedRect2s.isSelected(Je)?E:it(nt[4])}Ue.target.stage.update()}),ye.on("pressmove",function(Ue){if(!d.lockControls)if(d.selectPoints){var Re=ie();if(Re.indexOf(Ue.target)==-1)ue(Ue.target),d.drawShape();else if(Re.length>0){for(var Ze=Ue.target.x-Ue.target.startX,Je=Ue.target.y-Ue.target.startY,nt=0;nt<Re.length;nt++){var pt=Re[nt];pt.x=pt.startX+Ze,pt.y=pt.startY+Je,ue(pt)}d.drawShape()}}else ue(Ue.target),d.drawShape()}),ye.on("pressup",function(Ue){if(!d.lockControls){var Re=Ue.target.x!=je.x||Ue.target.y!=je.y,Ze=new $e.Event("change");Ue.target.rect1?(Ze.controlType="bezierPoint",tt(Ue.target)):Ze.controlType="bezierHandle",Re&&d.dispatchEvent(Ze)}});function tt(Ue){if(d.selectPoints){var Re=ie();if(Re&&Re.indexOf(Ue)==-1)_e(Ue);else if(Re&&Re.length>0)for(var Ze=0;Ze<Re.length;Ze++)_e(Re[Ze]);else _e(Ue)}else _e(Ue)}d.changeControl=function(Ue,Re,Ze,Je,nt,pt,De,lt,vt){var rt="index, type, rect1X, rect1Y, rect2X, rect2Y, circleX, circleY, update",xt;if(xt=mt(d.changeControl,arguments,rt))return xt;if(n(Ue)){for(var wt=0;wt<D.length;wt++)d.changeControl(wt,Re,Ze,Je,nt,pt,De,lt);return d}var _t=D[Ue];return _t[4]=Re,Re=="none"?(n(De)||(_t[1].x=De),n(lt)||(_t[1].y=lt),_t[2].x=_t[1].x,_t[2].y=_t[1].y,_t[3].x=_t[1].x,_t[3].y=_t[1].y,_t[1].parent.addChild(_t[1])):(n(De)||(_t[1].x=De),n(lt)||(_t[1].y=lt),n(Ze)||(_t[2].x=Ze),n(Je)||(_t[2].y=Je),n(nt)||(_t[3].x=nt),n(pt)||(_t[3].y=pt),_t[1].parent.addChildAt(_t[1],0)),_t[2].color=it(Re),_t[3].color=it(Re),vt&&(d.update(),d.stage&&d.stage.update()),d},d.transformPoints=function(Ue,Re,Ze,Je,nt){return n(nt)&&(nt=!0),d.points=e.transformPoints(d.points,Ue,Re,Ze,Je),nt&&d.approximateBounds(),d},d.traverse=function(Ue,Re,Ze,Je,nt){var pt=e.copy(d.segmentRatios);pt.unshift(0),n(Ze)&&(Ze=Re+1);var De=pt[Re]*100,lt=pt[Ze]*100,vt;!nt&&De>lt?vt=100-De+lt:!nt&&De<lt?vt=lt-De:nt&&De>lt?vt=-(De-lt):nt&&De<lt&&(vt=-(100-lt+De));var rt=new $e.Event("traversed");return rt.obj=Ue,Ue.animate({ease:"linear",props:{path:d,startPercent:De,percent:vt},time:Je,call:function(){d.dispatchEvent(rt)}}),d},d.reversePoints=function(Ue){return n(Ue)&&(Ue=!0),o=e.copy(d.points),o.reverse(),Ue&&o.unshift(o.pop()),e.loop(o,function(Re){var Ze=Re[6];Re[6]=Re[4],Re[4]=Ze;var Je=Re[7];Re[7]=Re[5],Re[5]=Je}),d.points=o,d.update(),d},d.splitPoints=function(Ue){var Re=e.copy(d.points);if(!(Ue<1||Ue>Re.length-1)){var Ze=e.copy(Re.slice(0,Ue+1)),Je=e.copy(Re.slice(Ue));e.trimPointEnds(Ze),e.trimPointEnds(Je);var nt=d.clone();return d.points=Ze,d.update(),nt.points=Je,d.parent&&nt.addTo(d.parent),nt}},d.makeSquiggle=function(Ue){var Re=e.copy(d.points);n(Ue)&&(Ue=0),Ue=(Ue+Re.length*1e3)%Re.length;var Ze=e.copy(Re.slice(Ue)),Je=e.copy(Re.slice(0,Ue+1));Re=Ze.concat(Je),e.trimPointEnds(Re);var nt=new e.Squiggle({points:Re,color:d.borderColor,thickness:d.borderWidth,showControls:d.controlsVisible,interactive:d.interactive,onTop:d.onTop,dashed:d.dashed,stickColor:d.stickColor,stickThickness:d.stickThickness});return nt},d.update=function(Ue){return Ue?d.points=d.pointsAdjusted:d.drawShape(),d.zimAnimateChanged=!0,d},d.move&&d.interactive&&F.drag({onTop:!1}),Ce=F.on("mousedown",function(Ue){ce=Ue.target.stage,je={x:F.x,y:F.y},d.selectPoints&&(d.keyFocus=!0),Te()}),Y=F.on("pressmove",function(){ye.x=F.x,ye.y=F.y,de.x=F.x,de.y=F.y}),Q=F.on("pressup",function(){var Ue=F.x!=je.x||F.y!=je.y,Re=F.localToLocal(d.regX,d.regY,d.parent);if(d.x=Re.x,d.y=Re.y,ye.x=ye.y=de.x=de.y=F.x=F.y=0,Ue){var Ze=new $e.Event("change");Ze.controlType="move",d.dispatchEvent(Ze)}ce.update()}),O||xe(!0);function Te(){if(d.onTop){var Ue=d.parent.numChildren-1;d.parent.getChildAt(Ue).type=="Keyboard"&&Ue--,d.parent.setChildIndex(d,Ue)}}d.toggleEvent=d.on("mousedown",function(){d.allowToggle&&(G||(d.showControls(),d.dispatchEvent("controlsshow")))}),d.added(function(){ce=d.stage,d.toggleStageEvent&&d.stage.off("stagemousedown",d.toggleStageEvent),d.toggleStageEvent=d.stage.on("stagemousedown",function(Ue){!d.allowToggle||!d.stage||G&&!d.hitTestPoint(Ue.stageX/e.scaX,Ue.stageY/e.scaY,!1)&&(d.hideControls(),d.dispatchEvent("controlshide"))})}),d.clickEvent=d.on("click",function(){d.ctrlKey&&setTimeout(function(){d.clone(!0).addTo(d.stage).mov(100),d.allowToggle&&(d.hideControls(),d.dispatchEvent("controlshide"));var Ue=new $e.Event("change");Ue.controlType="move",d.dispatchEvent(Ue),d.stage.update()},50)}),d.hideControls=function(){return d.toggled=!1,ye.visible=!1,de.visible=!1,G=!1,d.stage&&d.stage.update(),!d.allowToggle&&d.move&&xe(),d},G||d.hideControls(),d.showControls=function(){return d.toggled=!0,ye.visible=!0,de.visible=!0,G=!0,ye.x=F.x,ye.y=F.y,de.x=F.x,de.y=F.y,d.addChildAt(F,0),d.move&&!d.allowToggle&&$(),d.stage&&d.stage.update(),d},d.toggle=function(Ue){return Ue===!0?d.showControls():Ue===!1||G?d.hideControls():d.showControls(),d},d.recordData=function(Ue){n(Ue)&&(Ue=!1);var Re={type:"Blob",index:d.parent?d.parent.getChildIndex(d):-1,x:d.x,y:d.y,points:d.getPoints(),color:d.color,borderColor:d.borderColor,borderWidth:d.borderWidth,move:d.move,allowToggle:d.allowToggle,controlsVisible:G};return Ue?JSON.stringify(Re):Re},d.setData=function(Ue,Re){if(!n(Ue)){if(Re)try{Ue=JSON.parse(Ue)}catch(pt){return}var Ze=Ue.index;n(Ze)&&(Ze=-1),delete Ue.index;var Je=Ue.points;n(Je)||d.setPoints(Je),delete Ue.points,this.num=Je.length;for(var nt in Ue)d[nt]=Ue[nt];return d.parent&&d.parent.setChildIndex(d,Ze),d}},d.getPoints=function(Ue){n(Ue)&&(Ue=!1);var Re=d.points;if(Ue){if(!Ze){var Ze=d.pane=new e.Pane({displayClose:!1,container:d.stage,width:Math.min(500,d.stage.width-20),height:Math.min(500,d.stage.height-20),draggable:!0}),Je=d.textArea=new e.TextArea(Math.min(400,d.stage.width-70),Math.min(400,d.stage.height-70));Je.centerReg(Ze)}Ze.show(),Je.text=JSON.stringify(Re)}return Re},d.recordPoints=d.getPoints,d.setPoints=function(Ue){for(var Re,Ze,Je=0;Je<Ue.length;Je++)Re=D[Je],Ze=Ue[Je],!n(Re)&&(Re[0].x=Ze[0],Re[0].y=Ze[1],Re[1].x=Ze[2],Re[1].y=Ze[3],Re[2].x=Ze[4],Re[2].y=Ze[5],Re[3].x=Ze[6],Re[3].y=Ze[7],Re[4]=Ze[8],Re[2].color=it(Re[4]),Re[3].color=it(Re[4]));return d.update(),d},I!==!1&&e.styleTransforms(d,ee),d.clone=function(Ue,Re){var Ze=[],Je=!1;e.loop(d.pointControls,function(pt){pt.scaleX+pt.scaleY+pt.regX+pt.regY+pt.rotation!=2&&(Je=!0),Ze.push([pt.scaleX,pt.scaleY,pt.regX,pt.regY,pt.rotation])});var nt=d.cloneProps(new e.Blob(Re?d.colorCommand:Ue||!e.isPick(y[0])?d.color:y[0],Re?d.borderColorCommand:Ue||!e.isPick(y[1])?d.borderColor:y[1],d.borderWidth,d.getPoints(),l,f,h,p,ye.visible,b,w,d.allowToggle,d.move,P,A,d.circleColor,d.circleBorderColor,d.stickColor,d.stickThickness,E,k,d.editPoints,q,V,I,d.group,B));return Je&&(e.loop(nt.pointControls,function(pt,De){pt.scaleX=Ze[De][0],pt.scaleY=Ze[De][1],pt.regX=Ze[De][2],pt.regY=Ze[De][3],pt.rotation=Ze[De][4]}),nt.update()),d.linearGradientParams&&nt.linearGradient.apply(nt,d.linearGradientParams),d.radialGradientParams&&nt.radialGradient.apply(nt,d.radialGradientParams),nt},d.shapeMousedownEvent=d.shape.on("mousedown",function(Ue){ce=Ue.target.stage,d.editPoints&&(d.controlsVisible?(d.pressX=Ue.stageX/e.scaX,d.pressY=Ue.stageY/e.scaY):(d.pressX=null,d.pressY=null))}),d.addPointFactor=10,d.addMinDistance=15,d.shapePressupEvent=d.shape.on("pressup",function(Ue){if(d.editPoints&&d.pressX&&Math.abs(d.pressX-Ue.stageX/e.scaX)<J&&Math.abs(d.pressY-Ue.stageY/e.scaY)<J){d.selectPoints&&(d.lastPoints=e.copy(d.points));var Re=d.points,Ze=d.globalToLocal(Ue.stageX/e.scaX,Ue.stageY/e.scaY),Je=e.closestPointAlongCurve(Ze,d.segmentPoints);if(d.editPoints=="anywhere")Re.splice(Je+1,0,[Ze.x,Ze.y,0,0,0,0,0,0]),d.points=Re,d.changeControl({index:Je+1,type:"mirror",update:!0});else{var nt=d.pointsAdjusted,pt=d.getSegmentPoint(nt[Je],nt[(Je+1)%nt.length]),De=e.distanceAlongCurve(pt),lt=Math.round(De/d.addPointFactor),vt=d.interpolate(lt,Je,!1,Re),rt=1e4,xt;if(e.loop(vt,function(Ot,Rt){if(Rt!=0){var St=e.dist(Ot,Ze);St<rt&&(rt=St,xt=Rt)}}),rt<d.addMinDistance){var wt=d.segmentRatios,_t=wt[Je],ft=Je>0?wt[Je-1]:0;d.addPoint(100*(ft+(_t-ft)*(xt/(lt+1))))}}d.lastSelectedIndex=Je+1,d.lastSelected=d.controls.getChildAt(d.lastSelectedIndex),d.stage.update()}}),d.controlsClickEvent=d.controls.on("click",function(Ue){d.lastSelected=Ue.target.parent,d.lastSelectedIndex=d.controls.getChildIndex(Ue.target.parent),d.editPoints&&d.selectionManager.shiftKey&&et(Ue)});function et(Ue){if(Ue.target.type=="Circle"){var Re=d.lastSelectedIndex=d.controls.getChildIndex(Ue.target.parent);if(d.controls.numChildren<=2)return;var Ze=d.points;d.selectPoints&&(d.lastPoints=e.copy(Ze)),Ze.splice(Re,1),d.points=Ze,d.stage.update(),d.lastSelected=d.lastSelectedIndex=null}}d.controls.hold(et),G||d.hideControls(),d.dispatchEvent("update")}function ie(){var de=[],ve=d.selectionManager.currentSet;if(ve&&ve.selections&&ve.selections.length>0)for(var Me=0;Me<ve.selections.length;Me++){var we=d.pointObjects[ve.selections[Me]];if(ve==d.selectedBalls)de.push(we[1]);else if(ve==d.selectedRect1s)de.push(we[2]);else if(ve==d.selectedRect2s)de.push(we[3]);else continue}return de}function _e(de){if(d.selectPoints&&de.type=="Circle"){var ve=de,Me=ve.mySet,we=ve.rect1,Fe=ve.rect2;we.x-=ve.x,we.y-=ve.y,Fe.x-=ve.x,Fe.y-=ve.y,Me.x+=ve.x,Me.y+=ve.y,ve.x=0,ve.y=0}}d.selectionManager.on("keydown",function(de){if(d.selectPoints&&d.keyFocus&&de.keyCode>=37&&de.keyCode<=40){var ve=ie();if(ve.length>0){for(var Me=0;Me<ve.length;Me++){var we=ve[Me];de.keyCode==37?we.x-=d.selectionManager.shiftKey?10:1:de.keyCode==39?we.x+=d.selectionManager.shiftKey?10:1:de.keyCode==38?we.y-=d.selectionManager.shiftKey?10:1:de.keyCode==40&&(we.y+=d.selectionManager.shiftKey?10:1),ue(we)}d.drawShape(),d.dispatchEvent("update"),d.stage&&d.stage.update()}}}),d.selectionManager.on("keyup",function(de){if(d.selectPoints&&d.keyFocus&&de.keyCode>=37&&de.keyCode<=40){var ve=ie();if(ve.length>0)for(var Me=0;Me<ve.length;Me++)_e(ve[Me])}}),d.selectionManager.on("undo",function(){if(d.selectPoints&&d.keyFocus&&d.lastPoints){var de=e.copy(d.lastPoints);d.lastPoints=e.copy(d.points),d.points=de,d.stage&&d.stage.update()}}),ue=function(de){if(!d.lockControls){var ve;if(de.rect1){ve=de;var Me=ve.x-ve.startX,we=ve.y-ve.startY;ve.rect1.x=ve.rect1.startX+Me,ve.rect1.y=ve.rect1.startY+we,ve.rect2.x=ve.rect2.startX+Me,ve.rect2.y=ve.rect2.startY+we}else{var Fe=de,ge=Fe.other;ve=Fe.ball;var Ve=ve.index,He=h;if(n(D[Ve][4])||(He=D[Ve][4]),He=="straight"||He=="mirror"){var Le=Fe.x-ve.x,fe=Fe.y-ve.y;if(He=="mirror")ge.x=ve.x-Le,ge.y=ve.y-fe;else{var Ge=Math.atan2(fe,Le),Qe=-ge.stickLength*Math.cos(Ge+Math.PI),Ke=-ge.stickLength*Math.sin(Ge+Math.PI);ge.x=ve.x-Qe,ge.y=ve.y-Ke}}}}},Object.defineProperty(d,"move",{get:function(){return O},set:function(de){O!=de&&(O=de,de?$():xe())}}),Object.defineProperty(d,"interactive",{get:function(){return q},set:function(de){q=de,G=q,d.allowToggle=q,d.editPoints=q,d.lockControls=!q,d.selectPoints=q,d.move=q;var ve=d.points;d.points=ve}}),Object.defineProperty(d,"allowToggle",{get:function(){return C},set:function(de){C!=de&&(C=de,C?d.move&&$():!G&&d.move&&xe())}});function $(){d.move!="always"&&(pe||(pe=!0,F.drag({onTop:!1}),Ce=F.on("mousedown",Ce),Y=F.on("pressmove",Y),Q=F.on("pressup",Q)))}function xe(de){d.move!="always"&&(!de&&!pe||(pe=!1,F.noDrag(),F.off("mousedown",Ce),F.off("pressmove",Y),F.off("pressup",Q)))}Object.defineProperty(d,"controlsVisible",{get:function(){return G},set:function(de){G=de,de?d.showControls():d.hideControls()}});var Be=b;Object.defineProperty(d,"lockControls",{get:function(){return Be},set:function(de){Be=de,de?(d.controls.mouseChildren=!1,d.controls.mouseEnabled=!1):(d.controls.mouseChildren=!0,d.controls.mouseEnabled=!0)}}),d.lockControls=Be,le.KEYFOCUS!=null&&(e.KEYFOCUS=le.KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return e.KEYFOCUS==d},set:function(){e.KEYFOCUS=d}}),d.selectPoints&&!e.KEYFOCUS&&me();function me(){d.keyFocus=!0;var de=document.activeElement;de&&de.blur()}Object.defineProperty(d,"points",{get:function(){for(var de=[],ve,Me,we=0;we<D.length;we++)Me=D[we],ve=[e.decimals(Me[0].x),e.decimals(Me[0].y),e.decimals(Me[1].x),e.decimals(Me[1].y),e.decimals(Me[2].x),e.decimals(Me[2].y),e.decimals(Me[3].x),e.decimals(Me[3].y)],Me[4]&&Me[4]!=="straight"&&ve.push(Me[4]),de.push(ve);return de},set:function(de){var ve=d.x,Me=d.y,we=d.visible,Fe=[],ge=!1;e.loop(d.pointControls,function(Ve){Ve.scaleX+Ve.scaleY+Ve.regX+Ve.regY+Ve.rotation!=2&&(ge=!0),Fe.push([Ve.scaleX,Ve.scaleY,Ve.regX,Ve.regY,Ve.rotation])}),d.dispose(!0),o=Xe(de),d.shape&&(d.shape.graphics.clear(),d.sticks.graphics.clear(),d.controls.noDrag(),d.removeAllChildren(),delete d.shape,delete d.sticks,delete d.controls),d.visible=!1,Ae(),d.lockControls=Be,d.x=ve,d.y=Me,d.visible=we,ge&&(e.loop(d.pointControls,function(Ve,He){Ve.scaleX=Fe[He][0],Ve.scaleY=Fe[He][1],Ve.regX=Fe[He][2],Ve.regY=Fe[He][3],Ve.rotation=Fe[He][4]}),d.update())}}),Object.defineProperty(d,"pointsAdjusted",{get:function(){var de=[],ve,Me,we,Fe=d.pointObjects;return e.loop(Fe.length,function(ge){if(we=Fe[ge],Me=D[ge],we[0].rotation==0&&we[0].scaleX==0&&we[0].scaleY==0)ve=[e.decimals(Me[0].x),e.decimals(Me[0].y),e.decimals(Me[1].x),e.decimals(Me[1].y),e.decimals(Me[2].x),e.decimals(Me[2].y),e.decimals(Me[3].x),e.decimals(Me[3].y)];else{var Ve=we[0].localToLocal(we[2].x,we[2].y,we[0].parent),He=we[0].localToLocal(we[3].x,we[3].y,we[0].parent);ve=[e.decimals(Me[0].x),e.decimals(Me[0].y),e.decimals(Me[1].x),e.decimals(Me[1].y),e.decimals(Ve.x-Me[0].x),e.decimals(Ve.y-Me[0].y),e.decimals(He.x-Me[0].x),e.decimals(He.y-Me[0].y)]}Me[4]&&Me[4]!=="mirror"&&ve.push(Me[4]),de.push(ve)}),de},set:function(){Ct&&ht("Blob() - pointsAdjusted is read only")}}),Object.defineProperty(d,"pointObjects",{get:function(){return D},set:function(){Ct&&ht("Blob() - pointObjects is read only - but its contents can be manipulated - use blob.update() after changes")}}),Object.defineProperty(d,"pointControls",{get:function(){return m},set:function(){Ct&&ht("Blob() - pointControls is read only - but its contents can be manipulated - use blob.update() after changes")}}),Object.defineProperty(d,"pointCircles",{get:function(){return K},set:function(){Ct&&ht("Blob() - pointCircles is read only - but its contents can be manipulated - use blob.update() after changes")}}),Object.defineProperty(d,"segmentPoints",{get:function(){var de=d.pointsAdjusted,ve=[];return e.loop(de.length,function(Me,we){var Fe=d.getSegmentPoint(de[Me],de[Me<we-1?Me+1:0]);ve.push(Fe)}),ve},set:function(){Ct&&ht("Blob() - segmentPoints is read only")}}),Object.defineProperty(d,"segmentRatios",{get:function(){var de=[],ve=0;e.loop(d.segmentPoints,function(Fe){var ge=e.distanceAlongCurve(Fe);de.push(ge),ve+=ge});var Me=[],we=0;return e.loop(de,function(Fe){var ge=Fe/ve;we+=ge,Me.push(we)}),Me},set:function(){Ct&&ht("Blob() - segmentRatios is read only")}}),d.approximateBounds=function(de,ve){n(de)&&(de=80),de/=d.num;var Me=d.interpolate(de,null,!0,null,!0),we=e.boundsAroundPoints(Me);if(d.setBounds(we.x,we.y,we.width,we.height),ve){if(!d.parent)return Ct&&ht("approximateBounds() - add to stage to first to see points"),d;d.hitPathPoints?d.hitPathPoints.removeAllChildren():d.hitPathPoints=new e.Container().addTo(),d.hitPathPoints.top();for(var Fe=0;Fe<Me.length;Fe++){var ge=Me[Fe];ge=d.localToGlobal(ge.x,ge.y),new e.Circle(3).loc(ge.x,ge.y,d.hitPathPoints)}}return d},d.getPointAngle=function(de){var ve=d.pointObjects[de][0],Me=d.pointObjects[de][2],we=d.pointObjects[de][3],Fe,ge;return ve==d.stage?(Fe=new e.Point(Me.x,Me.y),ge=new e.Point(we.x,we.y)):(Fe=ve.localToGlobal(Me.x,Me.y),ge=ve.localToGlobal(we.x,we.y)),e.angle(Fe.x,Fe.y,ge.x,ge.y)},d.getSegmentPoint=function(de,ve){if(!(n(de)||n(ve))){(de[2]!=0||de[3]!=0)&&(de[4]-=de[2],de[5]-=de[3],de[6]-=de[2],de[7]-=de[3],de[0]+=de[2],de[1]+=de[3],de[2]=0,de[3]=0),(ve[2]!=0||ve[3]!=0)&&(ve[4]-=ve[2],ve[5]-=ve[3],ve[6]-=ve[2],ve[7]-=ve[3],ve[0]+=ve[2],ve[1]+=ve[3],ve[2]=0,ve[3]=0);var Me={x:de[0],y:de[1]},we={x:de[0]+de[6],y:de[1]+de[7]},Fe={x:ve[0]+ve[4],y:ve[1]+ve[5]},ge={x:ve[0],y:ve[1]};return(ye.x!=0||ye.y!=0)&&(Me.x+=ye.x,we.x+=ye.x,Fe.x+=ye.x,ge.x+=ye.x,Me.y+=ye.y,we.y+=ye.y,Fe.y+=ye.y,ge.y+=ye.y),[Me,we,Fe,ge]}},d.getAdjacentSegmentData=function(de){n(de)&&(de=0);var ve=d.pointsAdjusted;if(d.num==2)return[[d.getSegmentPoint(ve[0],ve[1]),d.getSegmentPoint(ve[1],ve[0])],[0,1]];if(de==0)return[[d.getSegmentPoint(ve[d.num-1],ve[0]),d.getSegmentPoint(ve[0],ve[1]),d.getSegmentPoint(ve[1],ve[2])],[d.num-1,0,1]];if(de>=d.num-1)return[[d.getSegmentPoint(ve[d.num-2],ve[d.num-1]),d.getSegmentPoint(ve[d.num-1],ve[0]),d.getSegmentPoint(ve[0],ve[1])],[d.num-2,d.num-1,0]];var Me=de+2>=d.num?0:de+2;return[[d.getSegmentPoint(ve[de-1],ve[de]),d.getSegmentPoint(ve[de],ve[de+1]),d.getSegmentPoint(ve[de+1],ve[Me])],[de-1,de,de+1]]},d.getCurvePoint=function(de,ve,Me,we){n(ve)&&(ve=d.segmentRatios),n(Me)&&(Me=d.segmentPoints),n(we)&&(we=!1);var Fe=ve,ge=Me,Ve=e.loop(Fe,function(Ke,st){if(Ke>=de)return st}),He=Ve>0?Fe[Ve-1]:0,Le=Ve>0?Fe[Ve]-Fe[Ve-1]:Fe[Ve],fe=(de-He)/Le,Ge=e.pointAlongCurve(ge[Ve],fe,we,!0);if(!n(Ge)){var Qe=d.localToGlobal(Ge.x,Ge.y);return Qe.angle=Ge.angle,Qe.z=Ve,n(Qe)?void 0:Qe}};function Oe(de,ve,Me){return{x:de.x+(ve.x-de.x)*Me,y:de.y+(ve.y-de.y)*Me}}function Ye(de,ve,Me,we,Fe,ge,Ve,He){var Le=de.length-1,fe=0,Ge=0;we==100&&d.type=="Squiggle"&&(we=99.99),we=(we+1e5)%100,e.loop(Me,function(it,je){if(we/100<it)return Le=je,Ge=it,!0;fe=it});var Qe=d.segmentPoints[Le],Ke=Ge>0?(we/100-fe)/(Ge-fe):0,st=e.pointAlongCurve(Qe,Ke,null,He),yt=[st.x,st.y,0,0];if(!ge){if(Ve){d.interpolatedPoints.push({x:st.x,y:st.y,r:we/100});return}if(Fe!="none"){var We=Oe(Qe[0],Qe[1],Ke),at=Oe(Qe[1],Qe[2],Ke),ct=Oe(Qe[2],Qe[3],Ke),Pe=Oe(We,at,Ke),Ie=Oe(at,ct,Ke);yt[4]=Pe.x-st.x,yt[5]=Pe.y-st.y,yt[6]=Ie.x-st.x,yt[7]=Ie.y-st.y;var be=d.localToLocal(We.x,We.y,ve[Le]);de[Le][6]=be.x,de[Le][7]=be.y;var ze=d.localToLocal(ct.x,ct.y,ve[(Le+1)%de.length]);de[(Le+1)%de.length][4]=ze.x,de[(Le+1)%de.length][5]=ze.y}Fe&&(yt[8]=Fe),de.splice(Le+1,0,yt)}}this.addPoint=function(de,ve){n(de)&&(de=100);var Me=d.points,we=d.segmentRatios,Fe=d.pointControls;return ve=ve||j,Ye(Me,Fe,we,de,ve),d.points=Me,d.num=Me.length,d},this.removePoint=function(de){if(!(n(de)||de<0)){var ve=e.copy(d.points);return ve.splice(de,1),d.points=ve,d.stage&&d.stage.update(),d}},this.addPoints=function(de,ve,Me,we,Fe,ge,Ve){n(ge)&&(ge=e.copy(d.points));var He=e.copy(d.segmentRatios),Le=0;if(Fe&&(d.interpolatedPoints=[]),we)var fe=He.length*de;return e.loop(He,function(Ge,Qe){Fe&&Ye(ge,d.pointControls,d.segmentRatios,Le*100,ve,!n(Me)&&Qe!=Me,Fe,Ve);var Ke=we?Math.round(fe*(Ge-Le)):de,st=1/(Ke+1);e.loop(Ke,function(yt){var We=Le+(Ge-Le)*st*(yt+1);Ye(ge,d.pointControls,d.segmentRatios,We*100,ve,!n(Me)&&Qe!=Me,Fe,Ve),!Fe&&de>0&&(d.points=ge)}),Le=Ge}),Fe&&d.type=="Squiggle"&&Ye(ge,d.pointControls,d.segmentRatios,100,ve,null,Fe,Ve),d.stage&&d.stage.update(),d.num=ge.length,d},this.interpolate=function(de,ve,Me,we,Fe){return n(de)&&(de=1),d.addPoints(de,"none",ve,Me,!0,we,Fe),d.interpolatedPoints},ae&&d.approximateBounds(),this.dispose=function(de,ve,Me){if(d.shape){if(e.gD(d),ce&&d.toggleStageEvent&&ce.off("stagemousedown",d.toggleStageEvent),d.controls.noDrag(),d.controls.removeAllEventListeners(),d.selectPoints&&d.selectionManager&&d.selectionManager.dispose(),d.selectedBalls=null,d.selectedRect1s=null,d.selectedRect2s=null,d.selectionManager=null,d.off("mousedown",d.toggleEvent),d.off("click",d.clickEvent),de){d.shape.dispose(),d.shape=null;for(var we=0;we<d.points.length;we++)d.pointObjects[we][0].removeAllEventListeners(),d.pointObjects[we][1].removeAllEventListeners(),d.pointObjects[we][2].removeAllEventListeners(),d.pointObjects[we][3].removeAllEventListeners();d.controls.removeFrom(d),d.sticks.dispose(),D=null,K=null}else d.removeAllEventListeners(),D=null,K=null,Me||this.zimCustomShape_dispose(!0);return!0}}},e.extend(e.Blob,e.CustomShape,["clone","dispose"],"zimCustomShape",!1),ki=e.Blob,e.Flare=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B,Z,U,ee,ae,re,he){var j="color, borderColor, borderWidth, crossAngle, thickness, thicknessA, thicknessB, pin, startX, startY, lengths, angles, anglesA, anglesB, anglesEnd, cross, crossColors, close, dashed, strokeObj, spineColor, spineBorderWidth, spineBorderColor, spineDashed, spineStrokeObj, closeColor, closeBorderWidth, closeBorderColor, closeDashed, closeStrokeObj, style, group, inherit",G;if(G=mt(e.Flare,arguments,j,this))return G;qe("53.6"),this.zimContainer_constructor(),this.type="Flare",this.group=re;var y=ae===!1?{}:e.getStyle(this.type,this.group,he),g=this;n(r)&&(r=y.borderColor!=null?y.borderColor:null),n(i)&&(i=y.borderWidth!=null?y.borderWidth:null),r<0||i<0?r=i=null:r!=null&&i==null&&(i=1),n(t)&&(t=y.color!=null?y.color:i>0?"rgba(0,0,0,0)":e.black),(n(i)||i>0)&&(!n(r)||!n(i))&&n(r)&&(r=e.black),n(o)&&(o=y.crossAngle!=null?y.crossAngle:0);var d=o;o-=90,n(l)&&(l=y.thickness!=null?y.thickness:null),n(f)&&(f=y.thicknessA!=null?y.thicknessA:null),n(h)&&(h=y.thicknessB!=null?y.thicknessB:null),n(l)?n(h)&&!n(f)?h=f:n(f)&&!n(h)?f=h:h=f=10:n(h)&&!n(f)?h=l-f:n(f)&&!n(h)?f=l-h:h=f=l/2,g.thickness=f+h,n(R)&&(R=y.cross!=null?y.cross:!0),n(T)&&(T=y.crossColors!=null?y.crossColors:null),!n(T)&&!Array.isArray(T)&&(T=[T]),n(L)&&(L=y.close!=null?y.close:!1),n(_)&&(_=y.startX!=null?y.startX:0),n(b)&&(b=y.startY!=null?y.startY:0),n(w)&&(w=y.lengths!=null?y.lengths:[200]),Array.isArray(w)||(w=[w]),n(C)&&(C=y.angles!=null?y.angles:[0]),Array.isArray(C)||(C=[C]),n(O)&&(O=y.anglesA!=null?y.anglesA:[10]),Array.isArray(O)||(O=[O]),n(P)&&(P=y.anglesB!=null?y.anglesB:e.copy(O)),Array.isArray(P)||(P=[P]),n(A)&&(A=y.anglesEnd!=null?y.anglesEnd:[0]),Array.isArray(A)||(A=[A]),n(E)&&(E=y.strokeObj!=null?y.strokeObj:{miterLimit:2}),n(q)&&(q=y.spineBorderColor!=null?y.spineBorderColor:null),n(X)&&(X=y.spineBorderWidth!=null?y.spineBorderWidth:null),q<0||X<0?q=X=null:q!=null&&X==null&&(X=1),n(k)&&(k=y.spineColor!=null?y.spineColor:X>0?"rgba(0,0,0,0)":e.black),n(V)&&(V=y.spineDashed!=null?y.spineDashed:null),n(I)&&(I=y.spineStrokeObj!=null?y.spineStrokeObj:{miterLimit:2}),(n(X)||X>0)&&(!n(q)||!n(X))&&n(q)&&(q=r||e.black),n(Z)&&(Z=y.closeBorderColor!=null?y.closeBorderColor:null),n(B)&&(B=y.closeBorderWidth!=null?y.closeBorderWidth:null),Z<0||B<0?Z=B=null:Z!=null&&B==null&&(B=1),n(te)&&(te=y.closeColor!=null?y.closeColor:B>0?"rgba(0,0,0,0)":null),n(U)&&(U=y.closeDashed!=null?y.closeDashed:null),n(ee)&&(ee=y.closeStrokeObj!=null?y.closeStrokeObj:{miterLimit:2}),(n(B)||B>0)&&(!n(Z)||!n(B))&&n(Z)&&(Z=r||e.black),this.thicknessA=f,this.thicknessB=h,this.cross=R,this.close=L,this.lengths=w,this.angles=C,this.anglesA=O,this.anglesB=P,this.anglesEnd=A,this.crossColors=T,D(w,C,O,P,A,R,T,L),t.type&&(g.color=t);function D(Y,Q,ce,pe,J,ue,ye,Xe){g.removeAllChildren();var se=g.shape=new e.Shape().addTo(g);if(g.colorCommand=se.c().f(t).command,t&&t.type&&g.specialColor(g.colorCommand,t,g),(n(i)||i>0)&&(!n(r)||!n(i))&&(n(r)&&(r=e.black),g.borderColorCommand=se.s(r).command,r&&r.type&&g.specialColor(g.borderColorCommand,r,g),g.borderWidthCommand=se.ss(i,E.caps,E.joints,E.miterLimit,E.ignoreScale).command,S&&(g.borderDashedCommand=se.sd([10,10],5).command)),se.mt(0,0),X>0){var Ae=g.spineShape=new e.Shape().addTo(g);g.spineColorCommand=Ae.c().f(k).command,k&&k.type&&g.specialColor(g.spineColorCommand,k,g),(n(X)||X>0)&&(!n(q)||!n(X))&&(n(q)&&(q=e.black),g.spineBorderColorCommand=Ae.s(q).command,q&&q.type&&g.specialColor(g.spineBorderColorCommand,q,g),g.spineBorderWidthCommand=Ae.ss(X,I.caps,I.joints,I.miterLimit,I.ignoreScale).command,V&&(g.spineBorderDashedCommand=Ae.sd([10,10],5).command))}if(!n(te)){var ie=g.closeShape=new e.Shape().addTo(g);g.closeColorCommand=ie.c().f(te).command,te&&te.type&&g.specialColor(g.closeColorCommand,te,g),(n(B)||B>0)&&(!n(Z)||!n(B))&&(n(Z)&&(Z=e.black),g.closeBorderColorCommand=ie.s(Z).command,Z&&Z.type&&g.specialColor(g.closeBorderColorCommand,Z,g),g.closeBorderWidthCommand=ie.ss(B,ee.caps,ee.joints,ee.miterLimit,ee.ignoreScale).command,U&&(g.closeBorderDashedCommand=ie.sd([10,10],5).command)),se.mt(0,0)}var _e=_,$=b,xe=o,Be=xe-180,me=f,Oe=h,Ye=Math.max(Y.length,Q.length,ce.length,pe.length,J.length),de,ve,Me=Be,we=[],Fe=[],ge=[];g.points=[];var Ve=g.pinPoints=[];e.loop(Ye,function(fe){var Ge=He(fe),Qe=Math.cos(Ge.a*e.RAD),Ke=Math.sin(Ge.a*e.RAD),st=new e.Point(_e+Ge.A.x*Qe-Ge.A.y*Ke,$+Ge.A.x*Ke+Ge.A.y*Qe),yt=new e.Point(_e+Ge.B.x*Qe-Ge.B.y*Ke,$+Ge.B.x*Ke+Ge.B.y*Qe),We=new e.Point(_e+Ge.C.x*Qe-Ge.C.y*Ke,$+Ge.C.x*Ke+Ge.C.y*Qe),at=new e.Point(_e+Ge.D.x*Qe-Ge.D.y*Ke,$+Ge.D.x*Ke+Ge.D.y*Qe);we.push(st,yt),Fe.unshift(We,at),ge.push([st,yt,We,at]);var ct=new e.Point(_e+Ge.F.x*Qe-Ge.F.y*Ke,$+Ge.F.x*Ke+Ge.F.y*Qe),Pe=new e.Point(_e+Ge.E.x*Qe-Ge.E.y*Ke,$+Ge.E.x*Ke+Ge.E.y*Qe);fe==0&&g.pinPoints.push(ct),g.pinPoints.push(Pe),_e=Pe.x,$=Pe.y,me=Ge.tA,Oe=Ge.tB}),g.points=we.concat(Fe),ue?(g.crossCommands=[],e.loop(ge,function(fe,Ge){se.mt(fe[0].x,fe[0].y),!n(ye)&&!n(ye[Ge])&&(se.f(ye[Ge]),g.crossCommands[Ge]=se.f(ye[Ge]).command,ye[Ge]&&ye[Ge].type&&g.specialColor(g.crossCommands[Ge],ye[Ge],g),se.mt(fe[0].x,fe[0].y)),se.lt(fe[1].x,fe[1].y).lt(fe[2].x,fe[2].y).lt(fe[3].x,fe[3].y).cp()}),Xe&&se.mt(ge[ge.length-1][1].x,ge[ge.length-1][1].y).lt(ge[ge.length-1][2].x,ge[ge.length-1][2].y).lt(ge[0][3].x,ge[0][3].y).lt(ge[0][0].x,ge[0][0].y).cp()):(e.loop(we,function(fe,Ge){Ge==0?se.mt(fe.x,fe.y):se.lt(fe.x,fe.y)}),Xe&&(se.lt(we[0].x,we[0].y),se.cp()),e.loop(Fe,function(fe,Ge){Ge==0&&Xe?se.mt(fe.x,fe.y):se.lt(fe.x,fe.y)}),Xe&&se.lt(Fe[0].x,Fe[0].y),se.cp()),Ae&&(e.loop(Ve,function(fe,Ge){Ge==0?Ae.mt(fe.x,fe.y):Ae.lt(fe.x,fe.y)}),Xe&&Ae.lt(Ve[0].x,Ve[0].y).cp()),n(te)||(e.loop(Fe,function(fe,Ge){Ge==0?ie.mt(fe.x,fe.y):ie.lt(fe.x,fe.y)}),Xe&&ie.lt(Fe[0].x,Fe[0].y).cp());function He(fe){var Ge=Q[fe],Qe=Y[fe],Ke=ce[fe],st=pe[fe],yt=J[fe];if(ye)var We=ye[fe];n(Ge)&&(Ge=Me,g.angles[fe]=Ge),n(Qe)&&(Qe=200,g.lengths[fe]=Qe),n(Ke)&&(Ke=0,g.anglesA[fe]=Ke),n(st)&&(st=0,g.anglesB[fe]=st),n(yt)&&(yt=0,g.anglesEnd[fe]=yt),ye&&n(We)&&(We=t,g.crossColors[fe]=We),yt=yt+90;var at=180-yt,ct=Math.cos((Me-Ge)*e.RAD),Pe=Math.sin((Me-Ge)*e.RAD),Ie=new e.Point(0,0),be=new e.Point(Qe,0);if(n(de))var ze=new e.Point(Math.cos(xe*e.RAD)*me,Math.sin(xe*e.RAD)*me);else ze=new e.Point(de.x*ct-de.y*Pe,de.x*Pe+de.y*ct);var it=Le(Qe,ze.x,ze.y,Ke,at),je=new e.Point(Qe-it.x,-it.y),tt;n(ve)?tt=new e.Point(Math.cos(Be*e.RAD)*me,Math.sin(Be*e.RAD)*Oe):tt=new e.Point(ve.x*ct-ve.y*Pe,ve.x*Pe+ve.y*ct);var Te=Le(Qe,tt.x,tt.y,st,yt),et=new e.Point(Qe-Te.x,Te.y);return de=new e.Point(je.x-Qe,je.y),ve=new e.Point(et.x-Qe,et.y),Me=Ge,{a:Ge,A:ze,B:je,C:et,D:tt,E:be,F:Ie,tA:it.t,tB:Te.t}}function Le(fe,Ge,Qe,Ke,st){var yt=st-90,We=90-yt,at=180-Ke-We,ct=Math.tan(yt*e.RAD)*Qe,Pe=fe-Ge-ct,Ie=Pe/Math.sin(at*e.RAD)*Math.sin(Ke*e.RAD),be=Math.sqrt(Math.pow(Qe,2)+Math.pow(ct,2)),ze=Ie+be,it=ze*Math.sin(yt*e.RAD),je=ze*Math.cos(yt*e.RAD);return{x:it,y:je,t:ze}}}this.add=function(Y,Q,ce,pe,J,ue,ye,Xe){var se="lengths, angles, anglesA, anglesB, anglesEnd, cross, crossColors, close",Ae;return(Ae=mt(g.add,arguments,se))?Ae:(n(ue)||(g.cross=ue),n(Xe)||(g.close=Xe),n(Y)||(Array.isArray(Y)||(Y=[Y]),n(g.lengths)?g.lengths=Y:g.lengths=g.lengths.concat(Y)),n(Q)||(Array.isArray(Q)||(Q=[Q]),n(g.angles)?g.angles=Q:g.angles=g.angles.concat(Q)),n(ce)||(Array.isArray(ce)||(ce=[ce]),n(g.anglesA)?g.anglesA=ce:g.anglesA=g.anglesA.concat(ce)),n(pe)||(Array.isArray(pe)||(pe=[pe]),n(g.anglesB)?g.anglesB=pe:g.anglesB=g.anglesB.concat(pe)),n(J)||(Array.isArray(J)||(J=[J]),n(g.anglesEnd)?g.anglesEnd=J:g.anglesEnd=g.anglesEnd.concat(J)),n(ye)||(n(g.crossColors)?Ct&&ht("Flare() - must set crossColor for original object parameters"):(Array.isArray(ye)||(ye=[ye]),n(g.crossColors)?g.crossColors=ye:g.crossColors=g.crossColors.concat(ye))),g.remake(),g)},this.remake=function(){return f=this.thicknessA,h=this.thicknessB,D(g.lengths,g.angles,g.anglesA,g.anglesB,g.anglesEnd,g.cross,g.crossColors,g.close),g},Object.defineProperty(g,"color",{get:function(){return t},set:function(Y){n(Y)&&(Y=e.black),t=Y,Y&&Y.type?g.specialColor(g.colorCommand,Y,g):g.colorCommand.style=Y}});var K,m;this.setColorRange=function(Y,Q){return n(Q)?(K=g.color,m=Y):n(Y)?(K=g.color,m=Q):(K=Y,m=Q),g};var F=0;Object.defineProperty(g,"colorRange",{get:function(){return F},set:function(Y){F=Y,!n(K)&&!n(m)&&(g.color=e.colorRange(K,m,Y))}}),Object.defineProperty(g,"borderColor",{get:function(){return r},set:function(Y){r=Y,g.borderColorCommand?Y&&Y.type?g.specialColor(g.borderColorCommand,Y,g):g.borderColorCommand.style=Y:D()}}),Object.defineProperty(g,"borderWidth",{get:function(){return i},set:function(Y){Y>0||(Y=0),i=Y,!g.borderWidthCommand||i==0?D():(g.borderWidthCommand.width=i,S&&(g.borderDashedCommand.segments=[20,10],g.borderDashedCommand.offset=5))}}),Object.defineProperty(g,"spineColor",{get:function(){return k},set:function(Y){n(Y)&&(Y=e.black),k=Y,g.spineColorCommand?Y&&Y.type?g.specialColor(g.spineColorCommand,Y,g):g.spineColorCommand.style=Y:D()}}),Object.defineProperty(g,"spineBorderColor",{get:function(){return q},set:function(Y){q=Y,g.spineBorderColorCommand?Y&&Y.type?g.specialColor(g.spineBorderColorCommand,Y,g):g.spineBorderColorCommand.style=Y:D()}}),Object.defineProperty(g,"spineBorderWidth",{get:function(){return X},set:function(Y){Y>0||(Y=0),X=Y,!g.spineBorderWidthCommand||X==0?D():(g.spineBorderWidthCommand.width=X,V&&(g.spineBorderDashedCommand.segments=[20,10],g.spineBorderDashedCommand.offset=5))}}),Object.defineProperty(g,"closeColor",{get:function(){return te},set:function(Y){n(Y)&&(Y=e.black),te=Y,g.closeColorCommand?Y&&Y.type?g.specialColor(g.closeColorCommand,Y,g):g.closeColorCommand.style=Y:D()}}),Object.defineProperty(g,"closeBorderColor",{get:function(){return Z},set:function(Y){Z=Y,g.closeBorderColorCommand?Y&&Y.type?g.specialColor(g.closeBorderColorCommand,Y,g):g.closeBorderColorCommand.style=Y:D()}}),Object.defineProperty(g,"closeBorderWidth",{get:function(){return B},set:function(Y){Y>0||(Y=0),B=Y,!g.closeBorderWidthCommand||B==0?D():(g.closeBorderWidthCommand.width=B,U&&(g.closeBorderDashedCommand.segments=[20,10],g.closeBorderDashedCommand.offset=5))}}),Object.defineProperty(g,"pin",{get:function(){return p},set:function(Y){Y>0||(Y=0),Y>g.pinPoints.length-1&&(p=0),p=Y;var Q=g.pinPoints[p];Q&&(g.regX=Q.x,g.regY=Q.y)}});var Ce=e.boundsAroundPoints(g.points);this.setBounds(Ce.x,Ce.y,Ce.width,Ce.height),n(p)||(g.pin=p),this.mouseChildren=!1,ae!==!1&&e.styleTransforms(this,y),this.clone=function(){return g.cloneProps(new e.Flare(t,r,i,d,e.copy(l),e.copy(f),e.copy(h),p,_,b,e.copy(w),e.copy(C),e.copy(O),e.copy(P),e.copy(A),R,e.copy(T),L,S,E,k,X,q,V,I,te,B,Z,U,ee,ae,this.group,he))}},e.extend(e.Flare,e.Container,["clone"],"zimContainer",!1),e.MultiFlare=function(t,r,i,o,l,f,h){var p="flares, pins, angles, endToEnd, style, group, inherit",_;if(_=mt(e.MultiFlare,arguments,p,this))return _;qe("53.7"),this.zimContainer_constructor(),this.type="MultiFlare",this.group=f;var b=l===!1?{}:e.getStyle(this.type,this.group,h),w=this;n(t)&&(t=b.flares!=null?b.flares:[]),Array.isArray(t)||(t=[t]),n(r)&&(r=b.pins!=null?b.pins:null),n(i)&&(i=b.angles!=null?b.angles:null),n(o)&&(o=b.endToEnd!=null?b.endToEnd:!1),w.flares=t,w.pins=r,w.angles=i,w.endToEnd=o,w.mouseChildren=!1,w.add=function(C,O){return n(C)||(n(O)&&(O=!0),Array.isArray(C)||(C=[C]),e.loop(C,function(P){O?w.flares.push(P.clone()):w.flares.push(P)}),w.remake(),w.stage&&w.stage.update()),w},w.remove=function(C){return n(C)||(Array.isArray(C)||(C=[C]),e.loop(C,function(O){var P=w.flares.indexOf(O);P>=0&&w.flares.splice(P,1)}),w.remake(),w.stage&&w.stage.update()),w},w.remake=function(){w.removeAllChildren(),e.loop(w.flares,function(C,O){if(r&&!n(r[O])&&(C.pin=r[O]),i&&!n(i[O])&&(C.rotation=i[O]),C.addTo(w),w.flares.push(C),o&&O>0){var P=t[O-1],A=P.pinPoints[P.pinPoints.length-1],R=P.localToLocal(A.x,A.y,w),T=C.pinPoints[0],L=C.localToLocal(T.x,T.y,w);C.mov(R.x-L.x,R.y-L.y)}})},w.remake(),l!==!1&&e.styleTransforms(this,b),this.clone=function(){return w.cloneProps(new e.MultiFlare(e.copy(t,!0),e.copy(r),e.copy(i),o,l,this.group,h))}},e.extend(e.MultiFlare,e.Container,["clone"],"zimContainer",!1),e.FlareBox=function(t,r,i,o,l,f,h,p,_,b,w){var C="width, height, color, borderColor, borderWidth, flares, corners, pins, style, group, inherit",O;if(O=mt(e.FlareBox,arguments,C,this))return O;qe("53.8"),this.group=b;var P=_===!1?{}:e.getStyle("FlareBox",this.group,w);n(t)&&(t=P.width!=null?P.width:220),n(r)&&(r=P.height!=null?P.height:80),this.zimContainer_constructor(t,r),this.type="FlareBox";var A=this;if(this.mouseChildren=!1,n(o)&&(o=P.borderColor!=null?P.borderColor:null),n(l)&&(l=P.borderWidth!=null?P.borderWidth:null),o<0||l<0?o=l=null:o!=null&&l==null&&(l=1),n(i)&&(i=P.color!=null?P.color:l>0?"rgba(0,0,0,0)":e.black),(n(l)||l>0)&&(!n(o)||!n(l))&&n(o)&&(o=e.black),n(f)&&(f=P.flares!=null?P.flares:null),n(h)&&(h=P.corners!=null?P.corners:null),n(p)&&(p=P.pins!=null?P.pins:null),A.backing=new e.Rectangle(t,r,i,o,l).addTo(this),!n(f)){if(f.type!="MultiFlare"){if(!Array.isArray(f)){if(f.type!="Flare")return;f=[f]}f=new e.MultiFlare(f,p)}f.addTo(A),A.multiFlare=f,A.flares=A.multiFlare.flares,f.loop(function(R,T){p&&!n(p[T])?R.pin=p[T]:n(R.pin)&&(R.pin=0),h&&!n(h[T])?R.corner=h[T]:n(R.corner)&&(R.corner=0),R.corner==1?R.loc(t,0):R.corner==2?R.loc(t,r):R.corner==3?R.loc(0,r):R.loc(0,0),R.rot((R.corner-R.pin)*90)}),_!==!1&&e.styleTransforms(this,P),this.clone=function(){return A.cloneProps(new e.FlareBox(t,r,i,o,l,e.copy(f,!0),e.copy(h),e.copy(p),_,this.group,w))}}},e.extend(e.FlareBox,e.Container,["clone"],"zimContainer",!1),e.Label=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B,Z,U,ee,ae,re,he,j,G){var y="text, size, font, color, rollColor, shadowColor, shadowBlur, align, valign, bold, italic, variant, lineWidth, lineHeight, backing, outlineColor, outlineWidth, backgroundColor, backgroundBorderColor, backgroundBorderWidth, corner, backgroundDashed, padding, paddingH, paddingV, shiftH, shiftV, rollPersist, labelWidth, labelHeight, maxSize, splitWords, style, group, inherit",g;if(g=mt(e.Label,arguments,y,this))return g;qe("54"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Label",this.group=j;var d=he===!1?{}:e.getStyle(this.type,this.group,G);n(t)&&(t=d.text!=null?d.text:"LABEL"),n(r)&&(r=d.size!=null?d.size:36),n(i)&&(i=d.font!=null?d.font:"arial"),n(o)&&(o=d.color!=null?d.color:e.black),n(b)&&(b=d.bold!=null?d.bold:!1),n(w)&&(w=d.italic!=null?d.italic:!1);var D=K(t,r,i,o,b,w);this.veeObj={text:D[0],size:D[1],font:D[2],color:D[3],bold:D[4],italic:D[5]};function K(){return arguments}t=e.Pick.choose(t);var m=!1;t===""&&(t=" ",m=!0),r=e.Pick.choose(r),i=e.Pick.choose(i),i=i.replace("+"," ");var F=["ttf","otf","woff2","woff","fnt"],Ce=i.split(".");Ce.length>0&&F.indexOf(Ce[1])!=-1&&(i=Ce[0]),o=e.Pick.choose(o),b=e.Pick.choose(b),w=e.Pick.choose(w),n(l)&&(l=d.rollColor!=null?d.rollColor:null),(n(f)||f=="ignore")&&(f=d.shadowColor!=null&&f!="ignore"?d.shadowColor:-1),(n(h)||h=="ignore")&&(h=d.shadowBlur!=null&&h!="ignore"?d.shadowBlur:14),n(p)&&(p=d.align!=null?d.align:"left"),n(_)&&(_=d.valign!=null?d.valign:"top"),(!n(R)||!n(d.outlineColor))&&n(T)&&(T=d.outlineWidth!=null?d.outlineWidth:Math.round(r*.2)),(!n(T)||!n(d.outlineWidth))&&n(R)&&(R=d.outlineColor!=null?d.outlineColor:e.black),n(T)&&(T=d.outlineWidth!=null?d.outlineWidth:0),(n(L)||L=="ignore")&&(L=d.backgroundColor!=null&&L!="ignore"?d.backgroundColor:null),n(S)&&(S=d.backgroundBorderColor!=null&&S!="ignore"?d.backgroundBorderColor:null),n(E)&&(E=d.backgroundBorderWidth!=null&&E!="ignore"?d.backgroundBorderWidth:null),(n(q)||q=="ignore")&&(q=d.padding!=null&&q!="ignore"?d.padding:10),n(V)&&(V=d.paddingH!=null?d.paddingH:q),n(I)&&(I=d.paddingV!=null?d.paddingV:q),n(te)&&(te=d.shiftH!=null?d.shiftH:0),n(B)&&(B=d.shiftV!=null?d.shiftV:0),n(C)&&(C=d.variant!=null?d.variant:!1),n(O)&&(O=d.lineWidth!=null?d.lineWidth:null),n(P)&&(P=d.lineHeight!=null?d.lineHeight:null),(n(A)||A=="ignore")&&(A=d.backing!=null&&A!="ignore"?d.backing.clone():null),n(Z)&&(Z=d.rollPersist!=null?d.rollPersist:!1),d.labelWidth!=null&&(O=d.labelWidth),n(U)||(O=U),p=="middle"&&(p="center"),n(ee)&&(ee=d.labelHeight!=null?d.labelHeight:null),n(ae)&&(ae=d.maxSize!=null?d.maxSize:null),r=ae?Math.min(r,ae):r,n(re)&&(re=d.splitWords!=null?d.splitWords:!1);var Y=le.zdf&&le.zdf.retina,Q=this;this.mouseChildren=!1,this.paddingV=I,this.paddingH=V,le.DIR&&le.DIR=="rtl"||!le.DIR&&e.DIR=="rtl"?p=="start"?p="right":p=="end"&&(p="left"):p=="start"?p="left":p=="end"&&(p="right");var ce=[];ce[0]=w?"italic":"normal",ce[1]=C?"small-caps":"normal",ce[2]=b?"bold":"normal",ce[3]=r+"px",ce[4]=i;var pe=ce.join(" ");t=String(t);var J,ue=!1,ye=O,Xe=ee;if(n(A)&&n(L)){var se=new $e.Shape;Q.hitArea=se}else ye&&(ye=ye-V*2),Xe&&(Xe=Xe-I*2);function Ae(fe){var Ge=new $e.Text(fe,pe,o);return Ge.lineWidth=ye,Ge.lineHeight=P,Ge}J=Ae(t);function ie(fe,Ge,Qe){var Ke=Math.ceil(ye/Ge*Qe.length),st=Qe.substr(0,Ke),yt=Ae(st),We=yt.getMeasuredWidth();if(We>ye)for(;We>ye;)Ke--,st=Qe.substr(0,Ke),yt=Ae(st),We=yt.getMeasuredWidth();else if(We<ye){for(;We<ye;)Ke++,st=Qe.substr(0,Ke),yt=Ae(st),We=yt.getMeasuredWidth();Ke--,st=Qe.substr(0,Ke)}var at=Qe.substr(Ke,Qe.length);return{endIndex:Ke,start:st,end:at}}if(re&&ye>r*1.2)for(var _e=J.getMetrics(),$=0;_e.width>ye&&$<1e3;)$++,e.loop(_e.lines,function(fe,Ge){fe=fe.replace(/^[\s\t]+/,"");var Qe=Ae(fe),Ke=Qe.getMeasuredWidth();if(Ke>ye){var st=ie(Qe,Ke,fe);return _e.lines[Ge]=st.start,_e.lines.length>Ge+1?(st.end.trim(),_e.lines[Ge+1]=st.end+" "+_e.lines[Ge+1]):_e.lines.push(st.end),J=Ae(_e.lines.join(" ")),_e=J.getMetrics(),!1}});if(this.label=J,J.textAlign=p,J.textBaseline="alphabetic",T>0){var xe=this.outlineLabel=J.clone();xe.color=R,xe.outline=T}f!=-1&&h>0&&(J.shadow=new $e.Shadow(f,3,3,h)),this.addChild(J);function Be(){Q.removeChild(Q.background),Q.background=new e.Rectangle(Q.getBounds().width+V*2,Q.getBounds().height+I*2,L,S,E,k,X,null,null,!1),e.center(Q.background,Q,0),Q.setBounds(Q.background.x,Q.background.y,Q.background.width,Q.background.height)}function me(){var fe=J.getBounds(),Ge=fe.y,Qe=fe.height;if(ye&&!Xe){var Ke=fe.x,st=ye;p=="right"?Ke=fe.x-ye+fe.width:p=="center"&&(Ke=-ye/2),J.setBounds(Ke,Ge,st,Qe),fe=J.getBounds()}var yt;_=="baseline"?yt=fe.y:_=="top"?(J.y=r-r/6,yt=0):_=="center"||_=="middle"?(yt=-fe.height/2,J.y=r*.3):yt=-fe.height,Q.setBounds(fe.x,yt,d.width?d.width-q*2:fe.width,d.height?d.height-q*2:fe.height),Q.hitArea&&Q.hitArea.graphics.c().f("black").r(Q.getBounds().x,Q.getBounds().y,Q.getBounds().width,Q.getBounds().height),(_=="center"||_=="middle")&&(e.pos(J,null,0),e.mov(J,0,1)),ee||(A?ue&&de():n(L)||Be()),_!="baseline"&&!Y&&(J.y+=r/32),ve()}if(me(),!n(A)){if(A.type=="Pattern"){if(Q.backing=new e.Container(Q.width+V*2,Q.height+I*2,null,null,!1).centerReg(null,null,!1),f!=-1&&h>0){var Oe=new e.Rectangle(Q.width+V*2-2,Q.height+I-2,"#666",null,null,k,null,null,null,!1).center(Q.backing);Oe.shadow=new $e.Shadow(f,3,3,h)}var Ye=new e.Rectangle(Q.width+V*2,Q.height+I*2,L,null,null,k,null,null,null,!1).addTo(Q.backing);A.centerReg(Ye),A.setMask(Ye),Q.backing.pattern=A}else Q.backing=A;Q.backing.center(Q,0),A=Q.backing,de(),ue=!0}function de(){var fe=A.boundsToGlobal(),Ge=Q.boundsToGlobal(fe,!0);Q.setBounds(Ge.x,Ge.y,Ge.width,Ge.height)}function ve(){e.pos(J,p=="left"||p=="right"?A||Q.background?V:0:null,_=="top"||_=="baseline"||_=="bottom"?A||Q.background?I:0:null,p=="right",_=="bottom"),J.x+=te,J.y+=B}ve();function Me(){xe&&(xe.x=J.x,xe.y=J.y,Q.addChildAt(xe,Q.background||Q.backing?1:0))}Me(),Object.defineProperty(Q,"text",{get:function(){var fe=J.text==" "&&m?"":J.text;return fe},set:function(fe){m=!1,fe===""&&(fe=" ",m=!0),J.text=String(fe),J.setBounds(null),Q.setBounds(null),me(),xe&&(xe.text=String(fe)),!n(O)&&!n(ee)&&(Le(),xe&&Me())}}),Object.defineProperty(Q,"size",{get:function(){return r},set:function(fe){r=ae?Math.min(fe,ae):fe,ce[3]=r+"px",this.label.font=ce.join(" "),xe&&(xe.font=ce.join(" ")),J.setBounds(null),Q.setBounds(null),me(),Me()}}),Object.defineProperty(Q,"bold",{get:function(){return!!this.label.font.match("bold")},set:function(fe){b=fe,ce[2]=fe?"bold":"normal",this.label.font=ce.join(" "),xe&&(xe.font=ce.join(" "))}}),Object.defineProperty(Q,"italic",{get:function(){return!!this.label.font.match("italic")},set:function(fe){w=fe,ce[0]=fe?"italic":"normal",this.label.font=ce.join(" "),xe&&(xe.font=ce.join(" "))}}),Object.defineProperty(Q,"variant",{get:function(){return!!this.label.font.match("small-caps")},set:function(fe){C=fe,ce[1]=fe?"small-caps":"normal",this.label.font=ce.join(" "),xe&&(xe.font=ce.join(" "))}}),Object.defineProperty(Q,"font",{get:function(){return ce[4]},set:function(fe){n(fe)||(i=fe,ce[4]=fe,this.label.font=ce.join(" "),xe&&(xe.font=ce.join(" ")))}}),Object.defineProperty(Q,"align",{get:function(){return p},set:function(fe){n(fe)||(p=fe,this.label.textAlign=p,xe&&(xe.textAlign=p),me(),Me())}}),Object.defineProperty(Q,"valign",{get:function(){return _},set:function(fe){n(fe)||(_=fe,me(),Me())}}),Object.defineProperty(Q,"color",{get:function(){return o},set:function(fe){l==o&&(l=fe),o=fe,J.color=o,!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&Q.stage&&Q.stage.update()}}),Object.defineProperty(Q,"colorOnly",{get:function(){return o},set:function(fe){o=fe,J.color=o,!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&Q.stage&&Q.stage.update()}});var we,Fe;this.setColorRange=function(fe,Ge){return n(Ge)?(we=Q.color,Fe=fe):n(fe)?(we=Q.color,Fe=Ge):(we=fe,Fe=Ge),Q};var ge=0;Object.defineProperty(Q,"colorRange",{get:function(){return ge},set:function(fe){ge=fe,!n(we)&&!n(Fe)&&(Q.color=e.colorRange(we,Fe,fe))}}),Object.defineProperty(Q,"backgroundColor",{get:function(){return L},set:function(fe){L=fe,Q.background?Q.background.color=fe:Q.backing?Q.backing.color=fe:Be(),!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&Q.stage&&Q.stage.update()}}),Object.defineProperty(Q,"outlineColor",{get:function(){return R},set:function(fe){R=fe,xe&&(xe.color=R),!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&Q.stage&&Q.stage.update()}}),Object.defineProperty(Q,"rollColor",{get:function(){return l},set:function(fe){!Q.mouseoverEvent&&fe&&Ve(),fe==null&&Q.mouseoverEvent&&He(),l=fe}}),this._enabled=!0,Object.defineProperty(Q,"enabled",{get:function(){return Q._enabled},set:function(fe){c(Q,fe),J.color=o,Q.mouseChildren=!1,!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&Q.stage&&Q.stage.update()}}),this.showRollColor=function(fe){return n(fe)&&(fe=!0),fe?J.color=l:J.color=o,Q.stage&&Q.stage.update(),Q};function Ve(){Q.mouseoverEvent=Q.on("mouseover",function(){Q.showRollColor&&Q.showRollColor()}),Q.mouseoutEvent=Q.on("mouseout",function(){Q.rollPersist||Q.showRollColor(!1)}),Q.pressupEvent=Q.on("pressup",function(){Q.rollPersist&&Q.showRollColor(!1)})}function He(){Q.off("mouseover",Q.mouseoverEvent),Q.off("mouseout",Q.mouseoutEvent),Q.off("pressup",Q.pressupEvent)}l&&Ve(),Object.defineProperty(Q,"labelWidth",{get:function(){return O},set:function(fe){fe>0&&(O=fe,ye=O,(!n(A)||!n(L))&&ye&&(ye=ye-V*2),Q.label.lineWidth=ye,xe&&(xe.lineWidth=ye),J.setBounds(null),Q.setBounds(null),me(),ee&&Le(),!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&Q.stage&&Q.stage.update())}}),Object.defineProperty(Q,"labelHeight",{get:function(){return ee},set:function(fe){fe>0&&(ee=fe,Xe=ee,(!n(A)||!n(L))&&Xe&&(Xe=Xe-I*2),O&&Le(),Q.setBounds(null),!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&Q.stage&&Q.stage.update())}}),!n(O)&&!n(ee)&&Le();function Le(){Q.size=ae||200;for(var fe=0;P<Xe/2&&(Q.height>Xe||Q.width>ye)&&(fe++,Q.size=Q.size/2,!(fe>50)););for(fe=0;Q.height<=Xe&&Q.width<=ye&&(fe++,Q.size=Math.ceil(Q.size+1),!(fe>50)););Q.size=Q.size-1,Me(),J.setBounds(null);var Ge=J.getBounds(),Qe=Ge.y,Ke=Ge.height;Xe&&(_=="bottom"?Qe=Qe-Xe+Ke:(_=="center"||_=="middle")&&(Qe=(Qe+Qe-Xe+Ke)/2),Ke=Xe),J.setBounds(Ge.x,Qe,Ge.width,Ke),Q.setBounds(null),Ge=Q.getBounds(),Q.setBounds(Ge.x,Ge.y,Ge.width,Ge.height),A?ue&&de():n(L)||Be()}he!==!1&&e.styleTransforms(this,d),this.clone=function(fe){return Q.cloneProps(new e.Label(fe||!e.isPick(D[0])?Q.text:D[0],fe||!e.isPick(D[1])?r:D[1],fe||!e.isPick(D[2])?i:D[2],fe||!e.isPick(D[3])?o:D[3],l,f,h,p,_,fe||!e.isPick(D[4])?b:D[4],fe||!e.isPick(D[5])?w:D[5],C,O,P,n(A)?null:A.clone(fe),R,T,L,S,E,k,X,q,V,I,te,B,Z,U,ee,ae,re,he,this.group,G))}},e.extend(e.Label,e.Container,"clone","zimContainer"),e.LabelOnPath=function(t,r,i,o,l,f,h,p,_,b,w,C){var O="label, path, percentAngle, percents, showPath, allowToggle, interactive, onTop, rtl, style, group, inherit",P;if(P=mt(e.LabelOnPath,arguments,O,this))return P;qe("54.5"),this.zimContainer_constructor(null,null,null,null,!1),this.type="LabelOnPath",this.group=w;var A=b===!1?{}:e.getStyle(this.type,this.group,C);n(t)&&(t=A.label!=null?A.label:new e.Label("Label on Path")),n(r)&&(r=A.path!=null?A.path:new e.Squiggle({points:[[0,0,0,0,-86,57,86,-57],[300,150,0,0,-133,21,133,-21]]})),n(i)&&(i=A.percentAngle!=null?A.percentAngle:100),n(o)&&(o=A.percents!=null?A.percents:null),n(l)&&(l=A.showPath!=null?A.showPath:!0),n(f)&&(f=A.allowToggle!=null?A.allowToggle:!0),n(h)&&(h=A.interactive!=null?A.interactive:!0),n(p)&&(p=A.onTop!=null?A.onTop:!1),n(_)&&(_=A.rtl!=null?A.rtl:le.DIR=="rtl"||e.DIR=="rtl"),_&&r.reversePoints();var R=t.color;r.addTo(this);var T=this;this.path=r,this.allowToggle=f,r.interactive=h,typeof t=="string"&&(t=new e.Label(t));var L=r.alpha;l||r.alp(0),r.onTop=p;var S=this.letters=new e.Container().addTo(this);if(!o){o=[];for(var E=0;E<t.text.length;E++)o.push(e.decimals(1/(t.text.length-(r.type=="Blob"?0:1))*100*E))}this.percents=o;function k(){var q;for(q=S.numChildren-1;q>=0;q--)S.getChildAt(q).dispose();for(T.numLetters=t.text.length,q=0;q<T.numLetters;q++){var V=t.clone();V.text=t.text[q],V.centerReg(S).reg(null,V.height),V.text!=""&&V.text!=" "&&V.expand(0),T.allowToggle&&V.cur("pointer"),V.on("mousedown",function(){T.allowToggle&&T.toggle()})}T.resize()}this.resize=function(){for(var q=r.segmentRatios,V=r.segmentPoints,I=0;I<this.numLetters;I++){var te=r.getCurvePoint(o[I]/100,q,V,!0);if(te){var B=this.globalToLocal(te.x,te.y);B&&(S.getChildAt(I).loc(B).rot((te.angle>180?te.angle-360:te.angle)*i/100),_&&(S.getChildAt(I).rotation+=180))}}return this},k(),this.showPath=function(q){return this.toggle(!0),r.toggle(q),this},this.hidePath=function(){return this.toggle(!1),this},Object.defineProperty(T,"text",{get:function(){return t.text},set:function(q){t.text=q,o=[];for(var V=0;V<t.text.length;V++)o.push(e.decimals(1/(t.text.length-(r.type=="Blob"?0:1))*100*V));k()}}),Object.defineProperty(this,"color",{get:function(){return R},set:function(q){R=q;for(var V=0;V<T.letters.numChildren;V++)T.letters.getChildAt(V).color=R;T.stage&&T.stage.update()}}),Object.defineProperty(T,"interactive",{get:function(){return h},set:function(q){h=q,r.interactive=q,this.ticker&&e.Ticker.remove(this.ticker),h&&(this.ticker=e.Ticker.add(function(){T.resize()}))}}),this.interactive&&(this.ticker=e.Ticker.add(function(){T.resize()}));var X=T.toggled=l;this.toggle=function(q){if(this.allowToggle)return n(q)?X=!X:q?X=!0:X=!1,X?(r.alp(L),this.interactive&&(r.showControls(),S.mouseEnabled=!1,S.mouseChildren=!1,S.cur("default"),this.controlHideEvent&&r.off("controlshide",this.controlHideEvent),this.controlHideEvent=r.on("controlshide",function(){S.mouseEnabled=!0,S.mouseChildren=!0,S.cur("pointer"),L=r.alpha,r.alp(0),X=!1,T.toggled=X,T.stage&&T.stage.update()},null,!0))):(L=r.alpha,r.alp(0),S.mouseEnabled=!0,S.mouseChildren=!0,S.cur("pointer")),T.toggled=X,T.stage&&T.stage.update(),T},T.toggle(!0),b!==!1&&e.styleTransforms(this,A),this.clone=function(){return T.cloneProps(new e.LabelOnPath(T.label.clone(),T.path.clone(),i,e.copy(o),l,f,h,p,_,b,this.group,C))},this.dispose=function(q,V,I){return this.ticker&&e.Ticker.remove(this.ticker),I||this.zimContainer_dispose(!0),!0}},e.extend(e.LabelOnPath,e.Container,["clone","dispose"],"zimContainer",!1),e.LabelOnArc=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L){var S="label, size, font, color, radius, flip, spacing, letterSpacing, angles, showCircle, arcColor, arcBorderColor, arcBorderWidth, radiusSpread, rtl, style, group, inherit",E;if(E=mt(e.LabelOnArc,arguments,S,this))return E;qe("54.55"),this.group=T;var k=R===!1?{}:e.getStyle("LabelOnArc",this.group,L);n(r)&&(r=k.size!=null?k.size:30),n(t)&&(t=k.label!=null?k.label:new e.Label("Label on Arc",r)),n(i)&&(i=k.font!=null?k.font:"verdana"),n(o)&&(o=k.color!=null?k.color:e.white),n(l)&&(l=k.radius!=null?k.radius:100),n(f)&&(f=k.flip!=null?k.flip:!1),n(h)&&(h=k.spacing!=null?k.spacing:0),n(p)&&(p=k.letterSpacing!=null?k.letterSpacing:5),n(_)&&(_=k.angles!=null?k.angles:null);var X=!n(_),q=e.copy(_);n(b)&&(b=k.showCircle!=null?k.showCircle:!1),n(w)&&(w=k.arcColor!=null?k.arcColor:null),n(C)&&(C=k.arcBorderColor!=null?k.arcBorderColor:null),n(O)&&(O=k.arcBorderWidth!=null?k.arcBorderWidth:null),n(P)&&(P=k.radiusSpread!=null?k.radiusSpread:!1),n(A)&&(A=k.rtl!=null?k.rtl:le.DIR=="rtl"||e.DIR=="rtl");var V=this.outerRadius=l+h+t.height;this.innerRadius=l+h,this.zimContainer_constructor(-V,-V,V*2,V*2,!1),this.type="LabelOnArc";var I=this;t.type!="Label"&&(t=new e.Label(t,r,i,o)),t.text;var te,B,Z,U,ee,ae;function re(){if(I.disposeAllChildren(),f){var G=t.text.split("").reverse().join("");t.text=G}te=I.letters=new e.Container(I.width,I.height).centerReg(I),I.numLetters=t.text.length,I.letterHeight=t.height,B=I.labels=[];var y;for(y=0;y<I.numLetters;y++){var g=t.clone();B.push(g),g.text=t.text[y],g.letterHolder=new e.Container(g.width,g.height),g.centerReg(g.letterHolder).rot(f?180:0)}if(A&&B.reverse(),U=I.circle=new e.Circle(l),b&&U.addTo(I),Z=I.arc=new e.Shape().addTo(I),he(),_){for(ee=0,y=0;y<_.length;y++)ee+=_[y];ee+=_[_.length-1]/2}j()}re();function he(){ee=0,ae=[0];for(var G=0;G<I.numLetters;G++){var y=B[G],g=Math.atan((y.width+p)/2/(l+h))*180/Math.PI*2;ae.push(g),ee+=g,y.letterHolder.centerReg(te).reg(null,l+h+y.height+(f?y.height*.13:0))}I.circle.radius=l,(w||C||O)&&(O>0&&n(C)?C=e.black:n(O)&&!n(C)&&(O=2),Z.graphics.c().f(null).s(C).ss(O).arc(0,0,l,(I.startAngle-90)*Math.PI/180,(I.startAngle-90+ee)*Math.PI/180))}function j(){var G;if(!X)for(_=[],G=0;G<ae.length-1;G++)_[G]=Math.round((ae[G]+ae[G+1])/2*100)/100;I.angles=_,I.startAngle=-ee/2;var y=I.startAngle;for(G=0;G<te.numChildren;G++){var g=te.getChildAt(G);y=g.rotation=y+_[G]}}Object.defineProperty(this,"radius",{get:function(){return l},set:function(G){l=G,he(),!X&&!P&&j()}}),Object.defineProperty(this,"color",{get:function(){return o},set:function(G){o=G;for(var y=0;y<I.labels.length;y++)I.labels[y].color=o;I.stage&&I.stage.update()}}),Object.defineProperty(I,"text",{get:function(){return t.text},set:function(G){t.text=G,q?_=e.copy(q):_=null,re()}}),R!==!1&&e.styleTransforms(this,k),this.clone=function(){return I.cloneProps(new e.LabelOnArc(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,this.group,L))}},e.extend(e.LabelOnArc,e.Container,"clone","zimContainer",!1),e.LabelLetters=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A){var R="label, align, valign, letterSpacing, letterSpacings, lineSpacing, lineSpacings, lineHeight, lineAlign, lineValign, cache, rtl, style, group, inherit",T;if(T=mt(e.LabelLetters,arguments,R,this))return T;qe("54.57"),this.group=P;var L=O===!1?{}:e.getStyle("LabelLetters",this.group,A);n(t)&&(t=L.label!=null?L.label:new e.Label("Label Letters")),n(r)&&(r=L.align!=null?L.align:"center"),n(i)&&(i=L.valign!=null?L.valign:"center"),n(o)&&(o=L.letterSpacing!=null?L.letterSpacing:5),n(l)&&(l=L.letterSpacings!=null?L.letterSpacings:null),n(p)&&(p=L.lineHeight!=null?L.lineHeight:null),n(f)&&(f=L.lineSpacing!=null?L.lineSpacing:5),n(h)&&(h=L.lineSpacings!=null?L.lineSpacings:null),n(C)&&(C=L.rtl!=null?L.rtl:!1),n(_)&&(_=L.lineAlign!=null?L.lineAlign:C?"right":"left"),n(b)&&(b=L.lineValign!=null?L.lineValign:"bottom"),n(w)&&(w=L.cache!=null?L.cache:!1),this.zimContainer_constructor(null,null,null,null,!1),this.type="LabelLetters";var S=this,E=S.letterData=[],k,X;t.type!="Label"?(X=q(t),E=X.data,t=new e.Label(X.text)):(X=q(t.text),E=X.data,t.text=X.text),S.text=X.original,S._color=t.color,le.DIR&&le.DIR=="rtl"||!le.DIR&&e.DIR=="rtl"?_=="start"?_="right":_=="end"&&(_="left"):_=="start"?_="left":_=="end"&&(_="right");function q(xe){var Be=[];function me(Fe){return Fe.split("").reverse().join("")}if(C){Xe=-1,xe=xe.replace(/[\u0591-\u07FF]+/ig,me),xe=xe.replace(/([^\u0591-\u07FF ])([\u0591-\u07FF])/ig,"$1-!!-$2"),xe=xe.replace(/([\u0591-\u07FF])([^\u0591-\u07FF ])/ig,"$1-!!-$2"),xe=xe.replace(/([^\u0591-\u07FF]) ([\u0591-\u07FF])/ig,"$1-!!- -!!-$2"),xe=xe.replace(/([\u0591-\u07FF]) ([^\u0591-\u07FF])/ig,"$1-!!- -!!-$2");var Oe=xe.split(/-!!-/g);e.loop(Oe,function(Fe,ge){Fe.match(/[\u0591-\u07FF]/i)&&(Oe[ge]=Fe.split(" ").reverse().join(" "))}),xe=Oe.join("")}xe=xe.replace(/\n|\r/g,"<br>"),xe=xe.replace(/<strong>|<strong \/>|<strong\/>/gi,"<b>"),xe=xe.replace(/<\/strong>/gi,"</b>"),xe=xe.replace(/<em>|<em \/>|<em\/>/gi,"<i>"),xe=xe.replace(/<\/em>/gi,"</i>"),xe=xe.replace(/\\n|\\r/g,"<br>"),xe=xe.replace(/<br>|<br \/>|<br\/>(<\/br>)?/gi,"<br>"),xe=xe.replace(/<b/gi,"<b"),xe=xe.replace(/<i/gi,"<i"),xe=xe.replace(/<u/gi,"<u"),xe=xe.replace(/<br/gi,"<br"),xe=xe.replace(/<a/gi,"<a"),xe=xe.replace(/<font/gi,"<font");var Ye=[/<(a|i|u|f|br|\/a|\/i|\/u|\/f|\/b)[^>]*>/g,/<(a|i|u|f|br|\/a|\/i|\/u|\/f|b)[^>]*>/g,/<(b|i|u|f|br|\/b|\/i|\/u|\/f|\/a)[^>]*>/g,/<(b|i|u|f|br|\/b|\/i|\/u|\/f|a)[^>]*>/g,/<(b|a|u|f|br|\/b|\/a|\/u|\/f|\/i)[^>]*>/g,/<(b|a|u|f|br|\/b|\/a|\/u|\/f|i)[^>]*>/g,/<(b|a|i|f|br|\/b|\/a|\/i|\/f|\/u)[^>]*>/g,/<(b|a|i|f|br|\/b|\/a|\/i|\/f|u)[^>]*>/g,/<(b|a|i|u|br|\/b|\/a|\/i|\/u|\/f)[^>]*>/g,/<(b|a|i|u|br|\/b|\/a|\/i|\/u|f)[^>]*>/g],de=["b","a","i","u","font"],ve;e.loop(de,function(Fe,ge){ve=xe.replace(Ye[ge*2],"");var Ve;Fe=="font"?Ve=ve.split("<font "):Fe=="a"?Ve=ve.split("<a "):Ve=ve.split("<"+Fe+">"),we(Ve,Fe,0),ve=xe.replace(Ye[ge*2+1],""),Ve=ve.split("</"+Fe+">"),we(Ve,Fe,1)}),ve=xe.replace(/<br>/gi,"@^#"),ve=ve.replace(/<(b|a|i|u|f|\/b|\/a|\/i|\/u|\/f)[^>]*>/g,"");var Me=ve.split("@^#");k=Me.join("\n"),ve=Me.join(""),we(Me,"br",0);function we(Fe,ge,Ve){if(Fe.length>1)if((ge=="font"||ge=="a")&&Ve==0){var He=Fe[0].length;e.loop(Fe,function(fe,Ge){if(Ge!=0){var Qe=Be[He];Qe||(Be[He]=[]),Qe=Be[He];var Ke=fe.split(">");Qe[Ve]?Qe[Ve].push(ge+" "+Ke[0]):Qe[Ve]=[ge+" "+Ke[0]],He+=Ke[1].length}})}else{Fe.pop();var Le=0;e.loop(Fe,function(fe){Le+=fe.length;var Ge=Be[Le];Ge||(Be[Le]=[]),Ge=Be[Le],Ge[Ve]?Ge[Ve].push(ge):Ge[Ve]=[ge]})}}return{text:ve,data:Be,original:k}}S.numLetters=t.text.length;var V=!n(l);l&&!Array.isArray(l)&&(l=null);var I;if(l)for(I=0;I<S.numLetters;I++)n(l[I])&&(l[I]=o);else for(l=[],I=0;I<S.numLetters;I++)l.push(o);if(S.letterSpacings=l,h&&!Array.isArray(h)&&(h=null),h)for(I=0;I<S.numLetters-1;I++)n(h[I])&&(h[I]=f);else for(h=[],I=0;I<S.numLetters-1;I++)h.push(f);S.lineSpacings=h,S.labels=[],S.lines=[[]];var te=[],B=[],Z=[0],U=0,ee=0,ae=0,re=0,he=0,j=E,G=!1,y=!1,g=!1,d=!1,D=!1,K=!1,m=!1,F=!1,Ce=!1,Y=!1,Q=!1,ce=!1;for(S.rolls=[[]],I=0;I<S.numLetters;I++){d=!1,j[I]&&(j[I][1]&&(j[I][1].indexOf("b")>=0&&(G=!1),j[I][1].indexOf("i")>=0&&(y=!1),j[I][1].indexOf("u")>=0&&(g=!1),e.loop(j[I][1],function(xe){if(xe.match(/^font/i)){D=!1,Q=!1,ce&&S.rolls.push([]),ce=!1,K=!1,F=!1,m=!1;return}if(xe.match(/^a/i)){Ce=!1,Y=!1;return}})),j[I][0]&&(j[I][0].indexOf("b")>=0&&(G=!0),j[I][0].indexOf("i")>=0&&(y=!0),j[I][0].indexOf("u")>=0&&(g=!0),d=0,e.loop(j[I][0],function(xe){xe=="br"&&d++}),e.loop(j[I][0],function(xe){var Be,me;if(xe.match(/^font/i)){Be=xe.match(/ color\s?=\s?(\S*)/i),Be&&(D=Be[1],me=e.colors.indexOf(D),me>=0&&(D=e.colorsHex[me]),D=D.replace(/'/g,"")),Be=xe.match(/size\s?=\s?(\S*)/i),Be&&(K=Be[1]),Be=xe.match(/backgroundColor\s?=\s?(\S*)/i),Be&&(Q=Be[1],me=e.colors.indexOf(Q),me>=0&&(Q=e.colorsHex[me]),Q=Q.replace(/'/g,"")),Be=xe.match(/rollBackgroundColor\s?=\s?(\S*)/i),Be&&(ce=Be[1],me=e.colors.indexOf(ce),me>=0&&(ce=e.colorsHex[me]),ce=ce.replace(/'/g,"")),Be=xe.match(/group\s?=\s?(\S*)/i),Be&&(m=Be[1]),Be=xe.match(/family\s?=\s?(.*)/i),Be&&(F=Be[1],F=F.split(/\ssize\s?=|\scolor\s?=|\sgroup\s?=/i)[0]);return}if(xe.match(/^a/i)){Be=xe.match(/href\s?=\s?(\S*)/i),Be&&(Ce=Be[1]),Be=xe.match(/target\s?=\s?(\S*)/i),Be&&(Y=Be[1]);return}})));var pe;m?pe=new e.Label({text:t.text[I],group:m}):(pe=t.clone(),pe.text=t.text[I]),S.labels.push(pe),G&&(pe.bold=!0),y&&(pe.italic=!0),D&&(pe.color=D),Q&&(pe.backgroundColor=Q);var J=V||n(pe.backgroundColor)?l[I]:-.5;ce&&(pe.rollIndex=S.rolls.length-1,pe.zrbc=ce,pe.zobc=pe.backgroundColor,S.rolls[pe.rollIndex].push(pe),pe.expand(0),pe.on("mouseover",ue),pe.on("mouseout",ye)),Ce&&(pe.expand(J,0),pe.zurl=Ce,pe.ztar=Y,pe.cur(),pe.on("click",function(xe){var Be=xe.currentTarget;ye(xe),Be.ztar||(Be.ztar="_self"),sr(Be.zurl,Be.ztar)})),F&&(pe.font=F),K&&(pe.size=K),d&&(U+=(n(p)?ae:p)+h[re],Z.push(U),B.push(n(p)?ae:p),te.push(ee),he=Math.max(he,ee)),d&&(d>1&&e.loop(d-1,function(){S.lines.push([]),U+=(n(p)?ae:p)+h[re],Z.push(U),B.push(n(p)?ae:p),te.push(0),re++}),ae=0,ee=0,S.lines.push([]),re++),ee+=pe.width+J,ae=Math.max(ae,pe.height),I==S.numLetters-1&&(te.push(ee),B.push(ae),he=Math.max(he,ee)),S.lines[re].push(pe),g&&(pe.underline=new e.Line(pe.width+J+1,1,pe.color).center(pe,this).mov(0,pe.height/2))}function ue(xe){var Be=xe.currentTarget,me=S.rolls[Be.rollIndex];e.loop(me,function(Oe){Oe.backgroundColor=Be.zrbc}),Be.stage&&Be.stage.update()}function ye(xe){var Be=xe.currentTarget,me=S.rolls[Be.rollIndex];e.loop(me,function(Oe){Oe.backgroundColor=Be.zobc}),Be.stage&&Be.stage.update()}for(var Xe=0,se=0;se<S.lines.length;se++){var Ae=S.lines[se];ee=te[se],ae=B[se],U=Z[se];var ie,_e;for(_=="left"?ie=0:_=="right"?ie=he-ee:ie=(he-ee)/2,_e=U,I=0;I<Ae.length;I++){Xe++,w&&pe.cache(),pe=Ae[I],pe.regX=r=="left"?0:r=="right"?pe.width:pe.width/2,pe.regY=i=="top"?0:i=="bottom"?pe.height:pe.height/2;var $=_e+(i=="top"?0:i=="bottom"?pe.height:pe.height/2);b=="center"||b=="middle"?$+=(B[se]-pe.height)/2:b=="bottom"&&($+=B[se]-pe.height),J=V||n(pe.backgroundColor)?l[Xe-1]:-.5,r=="left"?(pe.loc(ie,$,this),ie=pe.x+pe.width+J):r=="right"?(pe.loc(ie+pe.width,$,this),ie=pe.x+J):(pe.loc(ie+pe.width/2,$,this),ie=pe.x+pe.width/2+J)}}this.getBounds()||this.setBounds(0,0,0,0),this.regX=this.getBounds().x,this.regY=this.getBounds().y,Object.defineProperty(this,"color",{get:function(){return this._color},set:function(xe){this._color=xe;for(var Be=0;Be<S.numChildren;Be++)S.getChildAt(Be).color=this._color;S.stage&&S.stage.update()}}),this.dispose=function(){e.gD(this),e.loop(S.labels,function(xe){xe.removeFrom(),xe.dispose()}),S.removeFrom()},O!==!1&&e.styleTransforms(this,L),this.clone=function(){return S.cloneProps(new e.LabelLetters(t,r,i,o,l,f,h,p,_,b,w,C,O,this.group,A))}},e.extend(e.LabelLetters,e.Container,"clone","zimContainer",!1),e.Emoji=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T){var L="code, size, monochrome, italic, backgroundColor, backgroundBorderColor, backgroundBorderWidth, corner, backing, padding, paddingH, paddingV, shiftH, shiftV, style, group, inherit",S;if(S=mt(e.Emoji,arguments,L,this))return S;qe("54.58"),this.group=R;var E=A===!1?{}:e.getStyle("Emoji",this.group,T);n(t)&&(t=E.code!=null?E.code:"\u{1F642}"),n(r)&&(r=E.size!=null?E.size:30),n(i)&&(i=E.monochrome!=null?E.monochrome:!1),n(o)&&(o=E.italic!=null?E.italic:!1),(n(l)||l=="ignore")&&(l=E.backgroundColor!=null&&l!="ignore"?E.backgroundColor:null),n(f)&&(f=E.backgroundBorderColor!=null&&f!="ignore"?E.backgroundBorderColor:null),n(h)&&(h=E.backgroundBorderWidth!=null&&h!="ignore"?E.backgroundBorderWidth:null),(n(b)||b=="ignore")&&(b=E.padding!=null&&b!="ignore"?E.padding:10),n(w)&&(w=E.paddingH!=null?E.paddingH:b),n(C)&&(C=E.paddingV!=null?E.paddingV:b),n(O)&&(O=E.shiftH!=null?E.shiftH:0),n(P)&&(P=E.shiftV!=null?E.shiftV:0);var k=X(t,r);this.veeObj={code:k[0],size:k[1]};function X(){return arguments}t=e.Pick.choose(t),r=e.Pick.choose(r),t.substring(0,2)=="U+"&&(t=e.unicodeToUTF(t)),this.zimLabel_constructor(t,r,null,null,null,null,null,null,null,null,o,null,null,null,_,null,null,l,null,null,p,null,b,w,C,O,P),this.type="Emoji",this.code=t,this.size=r;var q=this,V=this.getBounds(),I=5,te=3;this.bounds=this.setBounds(V.x+te,V.y-I+1,V.width-te*2,V.height+I),i&&(this.saturation=-100);var B=i;Object.defineProperty(q,"monochrome",{get:function(){return B},set:function(Z){Z!=B&&(B=Z,Z&&(this.saturation=Z?-100:0))}}),this.cache=function(Z,U,ee,ae){return n(Z)?(U=this.getBounds(),this.zimLabel_cache(U.x-20,U.y-20,U.width+40,U.height+40)):this.zimLabel_cache(Z,U,ee,ae),q.z_bc=q.canvas=q.cacheCanvas,this},A!==!1&&e.styleTransforms(this,E),this.clone=function(Z){return q.cloneProps(new e.Emoji(Z||!e.isPick(k[0])?t:k[0],Z||!e.isPick(k[1])?q.size:k[1],i,o,l,f,h,p,_,b,w,C,O,P,A,q.group,T))}},e.extend(e.Emoji,e.Label,["clone","cache"],"zimLabel",!1),e.Button=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B,Z,U,ee,ae,re,he,j,G,y,g,d,D,K,m,F,Ce,Y,Q,ce,pe,J,ue,ye,Xe,se,Ae,ie,_e,$,xe,Be,me,Oe,Ye,de,ve,Me,we,Fe,ge,Ve){var He="width, height, label, backgroundColor, rollBackgroundColor, downBackgroundColor, color, rollColor, downColor, borderColor, borderWidth, rollBorderColor, downBorderColor, backing, rollBacking, downBacking, icon, rollIcon, downIcon, corner, dashed, shadowColor, shadowBlur, gradient, gloss, align, valign, indent, indentH, indentV, hitPadding, autoPadding, autoPaddingH, autoPaddingV, rollPersist, toggle, toggleBackgroundColor, rollToggleBackgroundColor, downToggleBackgroundColor, toggleColor, rollToggleColor, downToggleColor, toggleBacking, rollToggleBacking, downToggleBacking, toggleIcon, rollToggleIcon, downToggleIcon, toggleEvent, wait, waitTime, waitBackgroundColor, rollWaitBackgroundColor, downWaitBackgroundColor, waitColor, rollWaitColor, downWaitColor, waitBacking, rollWaitBacking, downWaitBacking, waitIcon, rollWaitIcon, downWaitIcon, waitModal, waitEnabled, style, group, inherit",Le;if(Le=mt(e.Button,arguments,He,this))return Le;qe("55"),this.group=ge;var fe=Fe===!1?{}:e.getStyle("Button",ge,Ve);n(t)&&(t=fe.width!=null?fe.width:200),n(r)&&(r=fe.height!=null?fe.height:60),n(le.M)&&(le.M=e.mobile());var Ge=h,Qe=p,Ke=_;n(h)&&(h=fe.color!=null?fe.color:e.white),n(p)&&(p=fe.rollColor!=null?fe.rollColor:e.white),n(re)&&(re=fe.autoPadding!=null?fe.autoPadding:20),n(he)&&(he=fe.autoPaddingH!=null?fe.autoPaddingH:re),n(j)&&(j=fe.autoPaddingV!=null?fe.autoPaddingV:re),n(te)&&(te=fe.align!=null?fe.align:"center"),n(B)&&(B=fe.valign!=null?fe.valign:"center"),n(i)&&(n(T)?i=fe.label!=null?fe.label:"PRESS":i=""),typeof i=="string"||typeof i=="number"?i=new e.Label({text:i,size:fe.size!=null?fe.size:36,font:fe.font!=null?fe.font:"arial",color:fe.color!=null&&Ge==null?fe.color:h,rollColor:fe.rollColor&&Qe==null!=null?fe.rollColor:p,align:te,valign:B,rollPersist:fe.rollPersist!=null?fe.rollPersist:!1,backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",shiftV:fe.shiftV!=null?fe.shiftV:0,shiftH:fe.shiftH!=null?fe.shiftH:0,style:!1,group:this.group}):(n(Ge)||(i.color=Ge),h=i.color,(n(i.rollColor)||!n(Qe))&&(i.rollColor=p),p=i.rollColor),n(_)&&(_=fe.downColor!=null?fe.downColor:p),t=="auto"&&(t=i.width+he*2),r=="auto"&&(r=i.height+j*2),this.zimContainer_constructor(t,r,null,null,!1),this.type="Button",n(o)&&(o=fe.backgroundColor!=null?fe.backgroundColor:e.purple),n(l)&&(l=fe.rollBackgroundColor!=null?fe.rollBackgroundColor:o.lighten(.2)),n(f)&&(f=fe.downBackgroundColor!=null?fe.downBackgroundColor:l);var st=yt(o,l,f,h,p,_);this.veeObj={backgroundColor:st[0],rollBackgroundColor:st[1],downBackgroundColor:st[2],color:st[3],rollColor:st[4],downColor:st[5]};function yt(){return arguments}o=dt(o),l=dt(l),f=dt(f),h=dt(h),p=dt(p),_=dt(_);var We=b,at=w;n(b)&&(b=fe.borderColor!=null?fe.borderColor:null),n(w)&&(w=fe.borderWidth!=null?fe.borderWidth:null),b<0||w<0?b=w=null:b!=null&&w==null&&(w=1),n(C)&&(C=fe.rollBorderColor!=null?fe.rollBorderColor:b),n(O)&&(O=fe.downBorderColor!=null?fe.downBorderColor:C),n(E)&&(E=fe.corner!=null?fe.corner:10),n(X)&&(X=fe.shadowColor!=null?fe.shadowColor:"rgba(0,0,0,.3)"),n(q)&&(q=fe.shadowBlur!=null?fe.shadowBlur:14),n(ae)&&(ae=fe.hitPadding!=null?fe.hitPadding:0),n(Z)&&(Z=fe.indent!=null?fe.indent:10),n(U)&&(U=fe.indentH!=null?fe.indentH:Z),n(ee)&&(ee=fe.indentV!=null?fe.indentV:Z),n(V)&&(V=fe.gradient!=null?fe.gradient:0),n(I)&&(I=fe.gloss!=null?fe.gloss:0);var ct=(!n(y)||!n(Ce)||!n(Y)||!n(Q)||!n(ce)||!n(pe)||!n(J))&&n(ye)&&n(Be)&&n(me);ct&&n(ue)&&(ue=le.M?"mousedown":"click"),n(G)&&(G=fe.rollPersist!=null?fe.rollPersist:!1),this.rollPersist=G,n(k)&&(k=fe.dashed!=null?fe.dashed:!1),!n(y)&&y.type=="Label"&&Ct&&ht("Button() - do not pass Label to toggle parameter - just pass a String"),n(g)&&(g=fe.toggleBackgroundColor!=null?fe.toggleBackgroundColor:o),n(d)&&(d=fe.rollToggleBackgroundColor!=null?fe.rollToggleBackgroundColor:l),n(D)&&(D=fe.downToggleBackgroundColor!=null?fe.downToggleBackgroundColor:d),n(K)&&(K=fe.toggleColor!=null?fe.toggleColor:i.color),n(m)&&(m=fe.rollToggleColor!=null?fe.rollToggleColor:i.rollColor),n(F)&&(F=fe.downToggleColor!=null?fe.downToggleColor:i.rollToggleColor),n(se)&&(se=fe.waitBackgroundColor!=null?fe.waitBackgroundColor:o),n(Ae)&&(Ae=fe.rollWaitBackgroundColor!=null?fe.rollWaitBackgroundColor:l),n(ie)&&(ie=fe.downWaitBackgroundColor!=null?fe.downWaitBackgroundColor:l),n(_e)&&(_e=fe.waitColor!=null?fe.waitColor:i.color),n($)&&($=fe.rollWaitColor!=null?fe.rollWaitColor:i.rollColor),n(xe)&&(xe=fe.downWaitColor!=null?fe.downWaitColor:$);var Pe=this;this.mouseChildren=!1,this.cur("pointer"),Pe.focus=!1,Pe.rolled=!1;var Ie=v(Xe);n(P)&&(P=fe.backing!=null?fe.backing.clone():null),n(P)?Pe.backing=new e.Rectangle(t,r,o,null,null,E,k,null,null,!1).centerReg(null,null,!1):Pe.backing=P,Pe.rollBacking=n(A)?fe.rollBacking!=null?fe.rollBacking.clone():null:A,Pe.downBacking=n(R)?fe.downBacking!=null?fe.downBacking.clone():null:R,Pe.waitBacking=n(Be)?fe.waitBacking!=null?fe.waitBacking.clone():null:Be,Pe.rollWaitBacking=n(me)?fe.rollWaitBacking!=null?fe.rollWaitBacking.clone():null:me,Pe.downWaitBacking=n(Oe)?fe.downWaitBacking!=null?fe.downWaitBacking.clone():null:Oe,Pe.toggleBacking=n(Ce)?fe.toggleBacking!=null?fe.toggleBacking.clone():null:Ce,Pe.rollToggleBacking=n(Y)?fe.rollToggleBacking!=null?fe.rollToggleBacking.clone():null:Y,Pe.downToggleBacking=n(Q)?fe.downToggleBacking!=null?fe.downToggleBacking.clone():null:Q;var be=["backing","rollBacking","downBacking","toggleBacking","rollToggleBacking","downToggleBacking","waitBacking","rollWaitBacking","downWaitBacking"],ze,it,je;for(je=0;je<be.length;je++)ze=be[je],it=Pe[ze],it&&(it.type=="Pattern"?it=tt(ze,it):X!=-1&&q>0&&(it.shadow=new $e.Shadow(X,3,3,q)),it.x=t/2,it.y=r/2);Pe.addChild(Pe.backing),w&&(Pe.border=new e.Rectangle(t,r,"rgba(0,0,0,0)",b,w,E,k,null,null,!1),Pe.addChild(Pe.border));function tt(kt,Nt){if(Pe[kt]=new e.Container(t,r,null,null,!1).centerReg(null,null,!1),X!=-1&&q>0){var Wt=new e.Rectangle(t-2,r-2,"#666",null,null,E,null,null,null,!1).center(Pe[kt]);Wt.shadow=new $e.Shadow(X,3,3,q)}var jt=Pe[kt].mask=new e.Rectangle(t,r,kt.indexOf("roll")>=0?l:o,null,null,E,null,null,null,!1).addTo(Pe[kt]);return Nt.centerReg(jt),Nt.setMask(jt.shape),Pe[kt].pattern=Nt,Pe[kt]}Pe.icon=n(T)?fe.icon!=null?fe.icon.clone():null:T,Pe.rollIcon=n(L)?fe.rollIcon!=null?fe.rollIcon.clone():null:L,Pe.downIcon=n(S)?fe.downIcon!=null?fe.downIcon.clone():null:S,Pe.waitIcon=n(Ye)?fe.waitIcon!=null?fe.waitIcon.clone():null:Ye,Pe.rollWaitIcon=n(de)?fe.rollWaitIcon!=null?fe.rollWaitIcon.clone():null:de,Pe.downWaitIcon=n(ve)?fe.downWaitIcon!=null?fe.downWaitIcon.clone():null:ve,Pe.toggleIcon=n(ce)?fe.toggleIcon!=null?fe.toggleIcon.clone():null:ce,Pe.rollToggleIcon=n(pe)?fe.rollToggleIcon!=null?fe.rollToggleIcon.clone():null:pe,Pe.downToggleIcon=n(J)?fe.downToggleIcon!=null?fe.downToggleIcon.clone():null:J;var Te=["icon","rollIcon","downIcon","toggleIcon","rollToggleIcon","downToggleIcon","waitIcon","rollWaitIcon","downWaitIcon"];for(je=0;je<Te.length;je++){var et=Te[je],Ue=Pe[et];Ue&&(Ue.x=t/2,Ue.y=r/2)}if(Pe.icon&&Pe.addChild(Pe.icon),Array.isArray(E)||(E=[E,E,E,E]),V>0){var Re=new $e.Shape;Re.graphics.lf(["rgba(255,255,255,"+V+")","rgba(0,0,0,"+V+")"],[0,1],0,0,0,r-w),Re.graphics.rc(w/2,w/2,t-w,r-w,E[0],E[1],E[2],E[3]),this.addChild(Re)}if(I>0){var Ze=new $e.Shape;Ze.graphics.f("rgba(255,255,255,"+I+")"),Ze.graphics.rc(w/2,w/2,t-w,(r-w)/2,E[0],E[1],0,0),Ze.graphics.f("rgba(0,0,0,"+I+")"),Ze.graphics.rc(w/2,r/2,t-w,(r-w)/2,0,0,E[2],E[3]),this.addChild(Ze)}var Je,nt;ae>0&&pt();function pt(){nt=new $e.Shape,nt.graphics.f("#000").r(-ae,-ae,t+ae*2,r+ae*2),Pe.hitArea=Je=nt}this.addChild(i),i.center(this),i.y+=1,this.label=i,e.pos(i,te=="left"||te=="right"?U:null,B=="top"||B=="bottom"?ee:null,te=="right",B=="bottom");var De=i.color;if(this.toggled=!1,ct){var lt=i.text,vt=i.color,rt=i.rollColor;this.on(ue,function(){Pe.toggled=!Pe.toggled,xt()})}function xt(){Pe.toggled?(n(y)||(Pe.label.text=y===!0?lt:y),n(K)||(Pe.label.colorOnly=De=K),n(m)||(Pe.label.rollColor=m),Pe.rolled?(Pe.rollToggleBacking?Lt("rollToggleBacking"):Pe.toggleBacking&&Lt("toggleBacking"),Pe.rollToggleIcon?Lt("rollToggleIcon"):Pe.toggleIcon&&Lt("toggleIcon"),n(P)&&n(Pe.rollToggleBacking)&&(Pe.backing.color=d)):(Pe.toggleBacking&&Lt("toggleBacking"),Pe.toggleIcon&&Lt("toggleIcon"),n(P)&&(Pe.backing.color=g))):(Pe.label.colorOnly=De=vt,Pe.label.rollColor=rt,Pe.rolled&&Pe.label.showRollColor(!0),Pe.label.text=lt,wt()),Pe.stage&&Pe.stage.update()}function wt(){Pe.pressed?(n(P)&&Pe.backing&&!Pe.downBacking&&(Pe.backing.color=f),Pe.downBacking?Lt("downBacking"):Pe.rollBacking?Lt("rollBacking"):Pe.backing&&Lt("backing"),Pe.downIcon?Lt("downIcon"):Pe.rollIcon?Lt("rollIcon"):Pe.icon?Lt("icon"):Lt("icon",null)):Pe.rolled?(n(P)&&Pe.backing&&!Pe.rollBacking&&(Pe.backing.color=l),Pe.rollBacking?Lt("rollBacking"):Pe.backing&&Lt("backing"),Pe.rollIcon?Lt("rollIcon"):Pe.icon?Lt("icon"):Lt("icon",null)):(n(P)&&Pe.backing&&(Pe.backing.color=o),Pe.backing&&Lt("backing"),Pe.icon,Lt("icon"))}this.toggle=function(kt){return ct?(n(kt)?Pe.toggled=!Pe.toggled:Pe.toggled=kt,xt(),Pe):(Ct&&ht("Button() - can't toggle with wait parameters provided"),Pe)};var _t=!1;Pe.waiting=!1;var ft=!1,Ot,Rt,St=Pe.label.color,Gt=Pe.label.rollColor,Yt,$t,sn=this.on("mousedown",function(){_t=!0,en()});function en(){(!n(ye)||!n(Be)||!n(me))&&!Pe.waiting&&(ft=!0,n(we)&&(we=!0),Me&&($t=Pe.stage.on("stagemousedown",function(kt){Pe.hitTestPoint(kt.stageX/e.scaX,kt.stageY/e.scaY)||Pe.clearWait()},null,!0)),setTimeout(function(){Pe.waiting=!0},50),Rt=i.text,n(_e)||(Pe.label.colorOnly=De=_e),n($)||(Pe.label.rollColor=$),Yt=Pe.enabled,!we&&Pe.enabled&&(Pe.enabled=!1),n(ye)||(Pe.label.text=ye),Pe.rolled?(n(P)&&!Pe.rollWaitBacking&&(Pe.backing.color=Ae),Pe.rollWaitBacking?Lt("rollWaitBacking"):Pe.waitBacking&&Lt("waitBacking"),Pe.rollWaitIcon?Lt("rollWaitIcon"):Pe.waitIcon&&Lt("waitIcon")):(n(P)&&!Pe.waitBacking&&(Pe.backing.color=se),Pe.waitBacking&&Lt("waitBacking"),Pe.waitIcon&&Lt("waitIcon")),n(Xe)&&(Xe=Ie=="s"?5:5e3),Ot&&Ot.clear(),Ot=e.timeout(Xe,function(){Pe.enabled||(Pe.enabled=Yt),Pe.clearWait(),Pe.dispatchEvent("waited")}),Pe.stage&&Pe.stage.update())}this.wait=en,this.clearWait=function(){return Ot&&($t&&Pe.stage.off("stagemousedown",$t),Ot.clear(),Pe.label.text=Rt,wt(),Pe.label.colorOnly=De=St,Pe.label.rollColor=Gt,setTimeout(function(){Pe.waiting=!1},55),ft=!1,Pe.stage&&Pe.stage.update()),Pe},this.removeWait=function(){return Pe.clearWait(),ye=null,Pe.waitBacking=null,Pe.rollWaitBacking=null,Pe.off("mousedown",sn),Pe};function Lt(kt,Nt){var Wt;if(kt.indexOf("con")>=0){for(Wt=0;Wt<Te.length;Wt++){var jt=Te[Wt],rn=Pe[jt];Pe.removeChild(rn)}Pe[kt]&&Pe.addChildAt(Pe[kt],1)}else{if(!Pe[kt]&&!Nt)return;for(Wt=0;Wt<be.length;Wt++){var Kt=be[Wt],ln=Pe[Kt];Pe.removeChild(ln)}Pe[kt]&&Pe.addChildAt(Pe[kt],0)}}var Zt=!1;this.on("mouseover",function(kt){Pe.stage&&Pe.stage.frame.leftMouseDown&&!bt||ot()});function ot(){Pe.rolled=!0,Zt=!0,ft?(Pe.pressed&&Pe.downWaitBacking?Lt("downWaitBacking"):Pe.pressed&&Pe.downBacking?Lt("downBacking"):Pe.rollWaitBacking?Lt("rollWaitBacking"):Pe.waitBacking?Lt("waitBacking"):Pe.rollBacking?Lt("rollBacking"):Lt("backing"),Pe.pressed&&Pe.downWaitIcon?Lt("downWaitIcon"):Pe.rollWaitIcon?Lt("rollWaitIcon"):Pe.waitIcon?Lt("waitIcon"):Pe.rollIcon?Lt("rollIcon"):Lt("icon",!0)):ct&&Pe.toggled?(Pe.pressed&&Pe.downToggleBacking?Lt("downToggleBacking"):Pe.pressed&&Pe.downBacking?Lt("downBacking"):Pe.rollToggleBacking?Lt("rollToggleBacking"):Pe.toggleBacking?Lt("toggleBacking"):Pe.rollBacking?Lt("rollBacking"):Lt("backing"),Pe.pressed&&Pe.downToggleIcon?Lt("downToggleIcon"):Pe.rollToggleIcon?Lt("rollToggleIcon"):Pe.toggleIcon?Lt("toggleIcon"):Pe.rollIcon?Lt("rollIcon"):Lt("icon",!0)):(Pe.pressed&&Pe.downBacking?Lt("downBacking"):Pe.rollBacking?Lt("rollBacking"):Lt("backing"),Pe.pressed&&Pe.downIcon?Lt("downIcon"):Pe.rollIcon?Lt("rollIcon"):Lt("icon",!0)),Pe.pressed?n(P)&&Pe.backing?Pe.backing.color=f:P&&!n(P.mask)&&Pe.backing&&(Pe.backing.mask.color=f):n(P)&&Pe.backing?Pe.backing.color=l:P&&!n(P.mask)&&Pe.backing&&(Pe.backing.mask.color=l),Pe.border&&(Pe.border.borderColor=Pe.pressed?O:C),Pe.pressed?Pe.label.colorOnly=_:Pe.label.showRollColor?Pe.label.showRollColor():Pe.label.colorOnly=De,Pe.stage&&Pe.stage.update()}var bt=!1;this.on("mousedown",function(){Pe.pressed=bt=!0,ot(),Pe.rolled}),this.on("pressup",function(){Pe.pressed=bt=_t=!1,Zt?ot():Pe.rollPersist&&It(),le.M&&Bt()}),this.on("pressmove",function(){var kt=Pe.stage?Pe.stage.frame:le.zdf,Nt=Pe.hitTestPoint(kt.mouseX,kt.mouseY);bt&&!Nt?(Bt(),bt=!1):!bt&&Nt&&(ot(),bt=!0)}),this.on("mouseout",Bt);function Bt(){Zt=!1,Pe.rollPersist&&_t||It()}function It(){Pe.rolled=!1,ft||Pe.waiting?(n(P)&&Pe.backing&&n(Pe.waitBacking)&&(Pe.backing.color=n(se)?o:se),Pe.waitBacking?Lt("waitBacking"):Pe.backing&&Lt("backing"),Pe.waitIcon?Lt("waitIcon"):Pe.icon?Lt("icon"):Lt("icon",null)):Pe.toggled&&ct?(n(P)&&Pe.backing&&n(Pe.toggleBacking)&&(Pe.backing.color=g),Pe.toggleBacking?Lt("toggleBacking"):Pe.backing&&Lt("backing"),Pe.toggleIcon?Lt("toggleIcon"):Pe.icon?Lt("icon"):Lt("icon",null)):(n(P)&&Pe.backing?Pe.backing.color=o:P&&!n(P.mask)&&Pe.backing&&(Pe.backing.mask.color=o),Pe.backing&&Lt("backing"),Pe.icon?Lt("icon"):Lt("icon",null)),Pe.border&&(Pe.border.borderColor=b),Pe.label.colorOnly=De,Pe.label.showRollColor&&Pe.label.showRollColor(!1),Pe.stage&&Pe.stage.update()}Pe.removeRoll=It,Pe.rollBacking&&Pe.rollBacking.removeFrom(),Object.defineProperty(Pe,"text",{get:function(){var kt=i.text==" "?"":i.text;return kt},set:function(kt){i.text=kt,lt&&(lt=kt),i.center(this),i.y+=1,e.pos(i,te=="left"||te=="right"?U:null,B=="top"||B=="bottom"?ee:null,te=="right",B=="bottom")}}),Object.defineProperty(Pe,"color",{get:function(){return h},set:function(kt){h=kt,vt&&(vt=h),Pe.label&&!n(Pe.label.color)&&(Pe.label.color=De=h),!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&Pe.stage&&Pe.stage.update()}}),Object.defineProperty(Pe,"rollColor",{get:function(){return p},set:function(kt){p=kt,rt&&(rt=p),Pe.label&&(Pe.label.rollColor=p)}}),Object.defineProperty(Pe,"downColor",{get:function(){return _},set:function(kt){_=kt,originalDownColor&&(originalDownColor=_),Pe.label&&(Pe.label.downColor=_)}}),Object.defineProperty(Pe,"backgroundColor",{get:function(){return o},set:function(kt){o=kt,Pe.backing.color?Pe.backing.color=o:Pe.backing.mask&&(Pe.backing.mask.color=o),!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&Pe.stage&&Pe.stage.update()}}),Object.defineProperty(Pe,"rollBackgroundColor",{get:function(){return l},set:function(kt){l=kt,Pe.rollBacking&&Pe.rollBacking.color?Pe.rollBacking.color=l:Pe.rollBacking&&Pe.rollBacking.mask&&(Pe.rollBacking.mask.color=l)}}),Object.defineProperty(Pe,"toggleBackgroundColor",{get:function(){return g},set:function(kt){g=kt,Pe.toggleBacking&&Pe.toggleBacking.color?Pe.toggleBacking.color=g:Pe.toggleBacking&&Pe.toggleBacking.mask&&(Pe.toggleBacking.mask.color=g)}}),Object.defineProperty(Pe,"rollToggleBackgroundColor",{get:function(){return d},set:function(kt){d=kt,Pe.rollToggleBacking&&Pe.rollToggleBacking.color?Pe.rollToggleBacking.color=d:Pe.rollToggleBacking&&Pe.rollToggleBacking.mask&&(Pe.rollToggleBacking.mask.color=d)}}),Object.defineProperty(Pe,"downBackgroundColor",{get:function(){return f},set:function(kt){f=kt,Pe.downBacking&&Pe.downBacking.color?Pe.downBacking.color=f:Pe.downBacking&&Pe.downBacking.mask&&(Pe.downBacking.mask.color=f)}}),Object.defineProperty(Pe,"borderColor",{get:function(){return b},set:function(kt){b=kt,Pe.rolled||(Pe.backing&&Pe.backing.borderColor&&(Pe.backing.borderColor=kt),Pe.border&&(Pe.border.borderColor=kt))}}),Object.defineProperty(Pe,"rollBorderColor",{get:function(){return C},set:function(kt){C=kt,Pe.rolled&&(Pe.backing&&Pe.backing.borderColor&&(Pe.backing.borderColor=kt),Pe.border&&(Pe.border.borderColor=kt))}}),Object.defineProperty(Pe,"hitPadding",{get:function(){return ae},set:function(kt){ae=kt,ae==0?Je&&(this.hitArea=null):pt()}}),this._enabled=!0,this.startMouseChildren=this.mouseChildren,Object.defineProperty(Pe,"enabled",{get:function(){return Pe._enabled},set:function(kt){Pe._enabled&&(Pe.startMouseChildren=Pe.mouseChildren),kt?(c(Pe,kt),Pe.mouseChildren=Pe.startMouseChildren):(It(),c(Pe,kt));var Nt=i.color;i.color=De=Nt,!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&Pe.stage&&Pe.stage.update()}}),this.setBacking=function(kt,Nt){Ut(kt,Nt)},this.setIcon=function(kt,Nt){Ut(kt,Nt)};function Ut(kt,Nt){return n(kt)||(Pe.contains(Pe[kt])&&(Pe.removeChild(Pe[kt]),Nt&&Pe.addChildAt(Nt,kt.indexOf("con")>=0?Pe.numChildren-1:0),Pe.stage&&Pe.stage.update()),Nt?(n(P)&&kt=="backing"&&(P=Nt),Nt.type=="Pattern"&&(Nt=tt(kt,Nt)),Pe[kt]=Nt,Pe[kt].x=t/2,Pe[kt].y=r/2):Pe[kt]=null,wt()),Pe}Fe!==!1&&e.styleTransforms(this,fe),this.clone=function(kt){var Nt=new e.Button(t,r,i.clone(),kt||!e.isPick(st[0])?o:st[0],kt||!e.isPick(st[1])?l:st[1],kt||!e.isPick(st[2])?f:st[2],kt||!e.isPick(st[3])?h:st[3],kt||!e.isPick(st[4])?p:st[4],kt||!e.isPick(st[5])?_:st[5],We,at,C,O,n(P)?null:Pe.backing.clone(),n(A)?null:Pe.rollBacking.clone(),n(R)?null:Pe.downBacking.clone(),n(T)?null:T.clone(),n(L)?null:L.clone(),n(S)?null:S.clone(),E,k,X,q,V,I,te,B,Z,U,ee,ae,re,he,j,G,y,g,d,D,K,m,F,n(Ce)?null:Ce.clone(),n(Y)?null:Y.clone(),n(Q)?null:Q.clone(),n(ce)?null:ce.clone(),n(pe)?null:pe.clone(),n(J)?null:J.clone(),ue,ye,Xe,se,Ae,ie,_e,$,xe,n(Be)?null:Be.clone(),n(me)?null:me.clone(),n(Oe)?null:Oe.clone(),n(Ye)?null:Ye.clone(),n(de)?null:de.clone(),n(ve)?null:ve.clone(),Me,we,Fe,this.group,Ve);return Pe.cloneProps(Nt)},this.doDispose=function(kt,Nt,Wt){return Pe.icon&&Pe.icon.dispose(),Pe.rollIcon&&Pe.rollIcon.dispose(),Pe.downIcon&&Pe.downIcon.dispose(),Pe.waitIcon&&Pe.waitIcon.dispose(),Pe.rollWaitIcon&&Pe.rollWaitIcon.dispose(),Pe.downWaitIcon&&Pe.downWaitIcon.dispose(),Pe.toggleIcon&&Pe.toggleIcon.dispose(),Pe.rollToggleIcon&&Pe.rollToggleIcon.dispose(),Pe.downToggleIcon&&Pe.downToggleIcon.dispose(),Pe.icon=Pe.rollIcon=Pe.downIcon=Pe.waitIcon=Pe.rollWaitIcon=Pe.downWaitIcon=Pe.toggleIcon=Pe.rollToggleIcon=Pe.downToggleIcon=null,Wt||this.zimContainer_dispose(!0),!0}},e.extend(e.Button,e.Container,["clone","dispose"],"zimContainer",!1),e.Button.prototype.dispose=function(t){return this.doDispose(null,null,t)},e.CheckBox=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R){var T="size, label, startChecked, color, backgroundColor, borderColor, borderWidth, corner, margin, indicatorType, indicatorColor, tap, rtl, style, group, inherit",L;if(L=mt(e.CheckBox,arguments,T,this))return L;qe("56"),this.zimContainer_constructor(null,null,null,null,!1),this.type="CheckBox",this.group=A;var S=P===!1?{}:e.getStyle(this.type,this.group,R);n(t)&&(t=S.size!=null?S.size:60),n(r)&&(r=S.label!=null?S.label:null),n(i)&&(i=S.startChecked!=null?S.startChecked:!1),n(o)&&(o=S.color!=null?S.color:e.darker),n(l)&&(l=S.backgroundColor!=null?S.backgroundColor:e.white.toAlpha(.8)),n(f)&&(f=S.borderColor!=null?S.borderColor:e.darker),n(h)&&(h=S.borderWidth!=null?S.borderWidth:t/10),f<0||h<0?f=h=null:f!=null&&h==null&&(h=t/10),n(p)&&(p=S.corner!=null?S.corner:0),n(_)&&(_=S.margin!=null?S.margin:t/5),b!="box"&&b!="square"&&b!="x"&&(b=S.indicatorType!=null?S.indicatorType:"check"),n(w)&&(w=S.indicatorColor!=null?S.indicatorColor:h>0?f:e.black),this.setBounds(-_,-_,t+_*2,t+_*2),n(C)&&(C=S.tap!=null?S.tap:!1),n(O)&&(O=S.rtl!=null?S.rtl:le.DIR=="rtl");var E=this;this.cur("pointer");var k=X(r,i);this.veeObj={label:k[0],startChecked:k[1]};function X(){return arguments}r=e.Pick.choose(r),i=e.Pick.choose(i);var q=i;(typeof r=="string"||typeof r=="number")&&(r=new e.Label({text:r,size:t*5/6,color:o,valign:"center",align:O?"right":"left",backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",style:P,group:this.group}));var V=this.box=new e.Rectangle(t,t,l,null,null,p),I=this.box2=new e.Rectangle(t*5/7,t*5/7,"rgba(0,0,0,0)",f,h,p);I.x=t/7,I.y=t/7,this.addChild(V,I);var te=t;r&&(r.center(E),this.label=r,O?(r.x=-_,this.setBounds(-r.width-_*2,-_,t+_*3+r.getBounds().width,Math.max(t+_*2,r.getBounds().height)),te=t+r.width+_,this.regX=t):(r.x=E.getBounds().width,this.setBounds(-_,-_,t+_*4+r.getBounds().width,Math.max(t+_*2,r.getBounds().height)),te=r.x+r.width));var B=new e.Shape({style:!1}),Z=B.graphics;Z.f("rgba(0,0,0,.01)").r(this.getBounds().x,this.getBounds().y,te+_*2,this.getBounds().height),this.hitArea=B;var U=new e.Shape({style:!1}),ee=U.graphics;b=="check"?ee.f(w).p("AnQAdICBiaIEEDZIF8nfICfB4In/KPg"):b=="box"||b=="square"?ee.f(w).dr(-35,-35,70,70):ee.f(w).p("AmJEVIEUkTIkXkWIB4h5IEWEYIETkTIB4B3IkTESIEQERIh4B4IkRkRIkSEVg");var ae=95;U.setBounds(-ae/2,-ae/2,ae,ae);var re=t/(ae+66);U.scaleX=U.scaleY=re,U.alpha=.9,U.x=t/2,U.y=t/2,q&&this.addChild(U),C?this.tap(he):this.on((Dt?e.ACTIONEVENT=="mousedown":le.ACTIONEVENT=="mousedown")?"mousedown":"click",he),Object.defineProperty(E,"checked",{get:function(){return q},set:function(j){E.setChecked(j)}}),this.toggle=function(j){n(j)&&(j=!q),E.setChecked(j)},Object.defineProperty(E,"toggled",{get:function(){return q},set:function(j){E.setChecked(j)}}),Object.defineProperty(E,"text",{get:function(){return r?r.text:null},set:function(j){r&&(r.text=j,!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&E.stage&&E.stage.update())}}),Object.defineProperty(U,"indicatorColor",{get:function(){return w},set:function(j){q&&E.removeChild(U),U=new $e.Shape,ee=U.graphics,w=j,ee.f(w).p("AnQAdICBiaIEEDZIF8nfICfB4In/KPg"),U.scaleX=U.scaleY=re,U.alpha=.9,U.x=t/2,U.y=t/2,q&&E.addChild(U),!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&E.stage&&E.stage.update()}}),Object.defineProperty(E,"indicator",{get:function(){return U},set:function(){ht("ZIM CheckBox - check is read only")}}),this._enabled=!0,Object.defineProperty(E,"enabled",{get:function(){return E._enabled},set:function(j){c(E,j)}});function he(){q=!q,E.setChecked(q),E.dispatchEvent("change")}this.setChecked=function(j){return n(j)&&(j=!0),q=j,q?E.addChild(U):E.removeChild(U),!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&E.stage&&E.stage.update(),E},P!==!1&&e.styleTransforms(this,S),this.clone=function(j){return E.cloneProps(new e.CheckBox(t,j||!e.isPick(k[0])?r?r.clone():null:k[0],j||!e.isPick(k[1])?i:k[1],o,l,f,h,p,_,b,w,C,O,P,this.group,R))}},e.extend(e.CheckBox,e.Container,"clone","zimContainer",!1),e.RadioButtons=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R){var T="size, buttons, vertical, color, backgroundColor, borderColor, borderWidth, spacing, margin, always, indicatorColor, selectedIndex, rtl, style, group, inherit",L;if(L=mt(e.RadioButtons,arguments,T,this))return L;qe("57"),this.zimContainer_constructor(null,null,null,null,!1),this.type="RadioButtons",this.group=A;var S=P===!1?{}:e.getStyle(this.type,this.group,R);n(t)&&(t=S.size!=null?S.size:60),t=Math.max(5,t),n(r)&&(r=S.buttons!=null?S.buttons:["A","B","C"]),n(i)&&(i=S.vertical!=null?S.vertical:!0),n(o)&&(o=S.color!=null?S.color:e.darker),n(l)&&(l=S.backgroundColor!=null?S.backgroundColor:"rgba(255,255,255,.8)"),n(f)&&(f=S.borderColor!=null?S.borderColor:e.darker),n(h)&&(h=S.borderWidth!=null?S.borderWidth:t/9),f<0||h<0?f=h=null:f!=null&&h==null&&(h=t/10),n(p)&&(p=i?S.spacing!=null?S.spacing:t*.2:S.spacing!=null?S.spacing:t),n(_)&&(_=S.margin!=null?S.margin:t/5),n(b)&&(b=S.always!=null?S.always:!1),n(w)&&(w=S.indicatorColor!=null?S.indicatorColor:h>0?f:e.black),n(O)&&(O=S.rtl!=null?S.rtl:le.DIR=="rtl");var E=this;this.cur("pointer"),this.labels=[],this.indicators=[];var k=0,X;if(typeof r=="string"){var q=r;r=[];for(var V=0;V<q.length;V++)r.push({label:q[V]})}var I=new e.Container({style:!1});this.addChild(I);function te(ae){var re=I.getChildIndex(ae.target);b&&E.selectedIndex==re||(E.setSelected(re),E.dispatchEvent("change"))}U();for(var B,Z=0;Z<I.numChildren;Z++)B=I.getChildAt(Z),B.on((Dt?e.ACTIONEVENT=="mousedown":le.ACTIONEVENT=="mousedown")?"mousedown":"click",te);function U(){var ae,re=!1,he;for(he=r.length-1;he>=0;he--)ae=r[he],ae.selected&&ae.selected===!0&&(re?ae.selected="false":(re=!0,E.id=ae.id));I.removeAllChildren(),E.buttons=[];var j,G=0;for(he=0;he<r.length;he++){if(ae=r[he],typeof ae=="string"||typeof ae=="number"){var y={selected:!1,label:new e.Label({text:ae,size:t*5/6,color:S.color!=null?S.color:o,valign:"center",backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",style:P,group:E.group})};ae=y}(ae.label&&typeof ae.label=="string"||typeof ae.label=="number")&&(ae.label=new e.Label({text:ae.label,size:S.size!=null?S.size:t*5/6,color:S.color!=null?S.color:o,valign:"center",style:P})),E.labels.push(ae.label),ae.index=he,r[he]=ae,j=ee(ae.selected,ae.label),j.type="RadioButton",j.obj=ae,ae.selected&&(X=j.obj),I.addChild(j),i?(j.y=G,G+=j.getBounds().height+p):(j.x=G,G+=j.getBounds().width+p)}}function ee(ae,re){var he=new e.Container({style:!1});E.buttons.push(he),he.mouseChildren=!1,he.setBounds(-_,-_,t+_*2,t+_*2);var j=new e.Shape({style:!1}),G=j.graphics;G.f(l).dc(t/2,t/2,t/1.85),G.s(f).ss(h).dc(t/2,t/2,t/2-t/2/5),he.addChild(j);var y=he.check=new e.Circle(t/5.2,w,null,null,null,null,null,null,!1);E.indicators.push(y),y.mouseEnabled=!1,y.alpha=.95,y.regX=y.regY=-t/2;var g=t;re&&(k==0&&(k=re.width),he.addChild(re),re.y=t/2,he.text=re.text,O?(re.x=-re.width-_,he.setBounds(-re.width-_,-_,t+_*2+re.getBounds().width,Math.max(t+_*2,re.getBounds().height)),g=re.width+_+t):(re.x=he.getBounds().width,he.setBounds(-_,-_,t+_*2+re.getBounds().width,Math.max(t+_*2,re.getBounds().height)),g=re.x+re.width)),ae&&(he.addChild(y),E.label=re,E.label&&(E.text=re.text));var d=new e.Shape({style:!1});return G=d.graphics,G.f("rgba(0,0,0,.01)").r(he.getBounds().x,he.getBounds().y,g+_*2,he.getBounds().height),he.hitArea=d,he}this.getBounds()||this.setBounds(0,0,t,t),O?(this.setBounds(-_*2-k,-_,this.getBounds().width+_*2,this.getBounds().height),this.regX=i?t+_:this.getBounds().width-k-_*3):this.setBounds(-_,-_,this.getBounds().width+_*2,this.getBounds().height),this.setSelected=function(ae){if(n(ae)&&(ae=-1),!(ae!=-1&&!I.getChildAt(ae))){for(var re,he=0;he<I.numChildren;he++)re=I.getChildAt(he),re.removeChild(re.check);if(ae>=0){re=I.getChildAt(ae);var j=-2;X&&(j=X.index),X=re.obj}return ae==-1||j==X.index?(X=null,E.id=null,E.label=null,E.text=""):(re.addChild(re.check),E.id=X.id,E.label=X.label,E.label&&(E.text=E.label.text)),!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&E.stage&&E.stage.update(),E}},Object.defineProperty(E,"selected",{get:function(){return X},set:function(){ht("ZIM RadioButton - selected is read only")}}),Object.defineProperty(E,"selectedIndex",{get:function(){return X?X.index:-1},set:function(ae){var re=ae;E.selectedIndex!=ae&&E.setSelected(re)}}),this._enabled=!0,Object.defineProperty(E,"enabled",{get:function(){return E._enabled},set:function(ae){c(E,ae)}}),n(C)&&(C=S.selectedIndex!=null?S.selectedIndex:0),E.selectedIndex=C,P!==!1&&e.styleTransforms(this,S),this.clone=function(){for(var ae=e.copy(r),re=0;re<ae.length;re++)ae[re].label=ae[re].label.clone();return E.cloneProps(new e.RadioButtons(t,ae,i,o,l,f,h,p,_,b,w,C,O,P,this.group,R))}},e.extend(e.RadioButtons,e.Container,"clone","zimContainer",!1),e.Toggle=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X){var q="width, height, label, startToggled, backgroundColor, margin, indicatorType, indicatorColor, tap, toggleBackgroundColor, color, borderColor, borderWidth, corner, indicatorCorner, shadowColor, shadowBlur, time, labelLeft, style, group, inherit",V;if(V=mt(e.Toggle,arguments,q,this))return V;qe("57.5"),this.group=k;var I=E===!1?{}:e.getStyle("Toggle",this.group,X);n(t)&&(t=I.width!=null?I.width:80),n(r)&&(r=I.height!=null?I.height:50),this.zimContainer_constructor(t,r,null,null,!1),this.type="Toggle",n(l)&&(l=I.backgroundColor!=null?I.backgroundColor:e.purple),n(f)&&(f=I.margin!=null?I.margin:10),n(h)&&(h=I.indicatorType!=null?I.indicatorType:"circle"),n(p)&&(p=I.indicatorColor!=null?I.indicatorColor:e.white),n(b)&&(b=I.toggleBackgroundColor!=null?I.toggleBackgroundColor:l.lighten(.3)),n(w)&&(w=I.color!=null?I.color:e.darker),n(C)&&(C=I.borderColor!=null?I.borderColor:null),n(O)&&(O=I.borderWidth!=null?I.borderWidth:null),C<0||O<0?C=O=null:C!=null&&O==null&&(O=1),n(P)&&(P=I.corner!=null?I.corner:h!="circle"?0:25),n(A)&&(A=I.indicatorCorner!=null?I.indicatorCorner:0),n(R)&&(R=I.shadowColor!=null?I.shadowColor:"rgba(0,0,0,.3)"),n(T)&&(T=I.shadowBlur!=null?I.shadowBlur:14),n(o)&&(o=I.startToggled!=null?I.startToggled:!1);var te=v(L);n(L)&&(L=I.time!=null?I.time:te=="s"?.1:100),n(i)&&(i=I.label!=null?I.label:null),n(S)&&(S=I.labelLeft!=null?I.labelLeft:null);var B=this;B.cur("pointer"),(typeof i=="string"||typeof i=="number")&&(i=this.label=new e.Label({text:i,size:I.size||r*5/6,color:w,valign:"center",backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",group:this.group})),(typeof S=="string"||typeof S=="number")&&(S=this.labelLeft=new e.Label({text:S,size:I.size||r*5/6,color:w,valign:"center",backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",group:this.group})),this.background=new e.Rectangle(t,r,l,C,O,P).addTo(this),h=="rectangle"||h=="square"?this.indicator=new e.Rectangle(r*.65,r*.65,p,null,null,A).center(this.background).pos(r*.2,null,o):this.indicator=new e.Circle(r*.35,p).center(this.background).pos(r*.175,null,o);var Z=o;B.background.color=Z?b:l,R!=-1&&T>0&&(this.background.shadow=new $e.Shadow(R,3,3,T)),i&&(this.addChild(i),i.x=t+2+f+O,i.y=r/2,this.label=i,this.setBounds(-f,-f,t+f*3+O+i.getBounds().width,Math.max(r+f*2,i.getBounds().height))),S&&(this.addChild(S),S.x=0,B.background.x+=S.width+3+f+O,B.label.x+=S.width+3+f+O,S.y=r/2,this.labelLeft=S,this.setBounds(-f,-f,B.getBounds().width+S.width+3+f+O,B.getBounds().height)),this.expand(e.mobile()?20:10),this.tap(function(ae){if(S){var re=B.localToGlobal(S.width+3+f+O+t/2,0);if(ae.stageX/e.scaX<re.x-t/2&&!Z||ae.stageX/e.scaX>=re.x+t/2&&Z)return}Z=!Z,ee(),B.dispatchEvent("change")},e.mobile()?20:10);var U=new e.Swipe(this,20,te=="s"?.2:200);U.on("swipe",function(ae){if(ae.swipeX!=0){{if(ae.swipeX==1&&Z)return;if(ae.swipeX==-1&&!Z)return}Z=!Z,ee(),B.dispatchEvent("change")}});function ee(ae){var re=B.indicator.x,he=L;if(ae===!0&&(he=0),h=="rectangle"||h=="square"?(B.indicator.pos(r*.2,null,Z),L>0&&B.indicator.animate({props:{x:re},from:!0,time:he})):(B.indicator.pos(r*.175,null,Z),L>0&&B.indicator.animate({props:{x:re},from:!0,time:he})),B.background.color=Z?b:l,B.text=Z?B.label?B.label.text:"on":B.labelLeft?B.labelLeft.text:"off",B.zimAccessibility){var j="Toggle set to "+(Z?B.label?B.label.text+".":"on.":B.labelLeft?B.labelLeft.text+".":"off.");setTimeout(function(){B.zimAccessibility.talk(j)},50)}}Object.defineProperty(B,"textLeft",{get:function(){return S?S.text:null},set:function(ae){S&&(S.text=ae,!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&B.stage&&B.stage.update())}}),B.toggle=function(ae,re){var he=Z;return n(ae)&&(ae=!0),Z=ae,he!=Z&&ee(re),B},B.text=Z?B.label?B.label.text:"on":B.labelLeft?B.labelLeft.text:"off",Object.defineProperty(B,"toggled",{get:function(){return Z},set:function(ae){B.toggle(ae)}}),this._enabled=!0,Object.defineProperty(B,"enabled",{get:function(){return B._enabled},set:function(ae){c(B,ae)}}),E!==!1&&e.styleTransforms(this,I),this.clone=function(){return B.cloneProps(new e.Toggle(t,r,i?i.clone():"",o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S?S.clone():"",E,this.group,X))}},e.extend(e.Toggle,e.Container,"clone","zimContainer",!1),e.Tip=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B,Z,U,ee,ae,re,he,j,G,y,g,d,D,K,m,F,Ce,Y,Q){var ce="text, tipAlign, tipValign, margin, marginH, marginV, outside, target, delay, time, mouseClose, size, font, color, rollColor, shadowColor, shadowBlur, align, valign, lineWidth, lineHeight, backing, outlineColor, outlineWidth, backgroundColor, backgroundBorderColor, backgroundBorderWidth, corner, backgroundDashed, padding, paddingH, paddingV, shiftH, shiftV, rollPersist, labelWidth, labelHeight, maxSize, bold, italic, variant, splitWords, style, group, inherit",pe;if(pe=mt(e.Tip,arguments,ce,this))return pe;qe("57.6"),this.group=Y;var J=Ce===!1?{}:e.getStyle("Tip",this.group,Q);n(t)&&(t=J.text!=null?J.text:"Here's a tip!"),n(o)&&(o=J.margin!=null?J.margin:40),n(l)&&(l=J.marginH!=null?J.marginH:o),n(f)&&(f=J.marginV!=null?J.marginV:o),n(r)&&(r=J.tipAlign!=null?J.tipAlign:"right"),n(i)&&(i=J.tipValign!=null?J.tipValign:"bottom"),n(h)&&(h=J.outside!=null?J.outside:!1),n(I)&&(I=J.backgroundColor!=null?J.backgroundColor:e.blue),n(P)&&(P=J.color!=null?J.color:e.white),n(Z)&&(Z=J.corner!=null?J.corner:25),n(U)&&(U=J.backgroundDashed!=null?J.backgroundDashed:null),n(ee)&&(ee=J.padding!=null?J.padding:10),n(ae)&&(ae=J.paddingH!=null?J.paddingH:ee),n(re)&&(re=J.paddingV!=null?J.paddingV:ee),(n(R)||R=="ignore")&&(R=J.shadowColor!=null&&R!="ignore"?J.shadowColor:"rgba(0,0,0,.3)"),(n(T)||T=="ignore")&&(T=J.shadowBlur!=null&&T!="ignore"?J.shadowBlur:1),n(_)&&(_=J.delay!=null?J.delay:0);var ue=v(b);n(b)&&(b=J.time!=null?J.time:ue=="s"?2:2e3),n(w)&&(w=J.mouseClose!=null?J.mouseClose:!0),this.zimLabel_constructor(t,C,O,P,A,null,null,L,S,D,K,m,E,k,X,q,V,I,te,B,Z,U,ee,ae,re,he,j,G,y,g,d,F,Ce,Y,e.copy(J)),this.type="Tip",h&&(l=-l,f=-f);var ye=this;ye.tipAlign=r,ye.tipValign=i,this.background.sha(R,3,5,T),this.show=function(Xe,se){var Ae=v(se);if(n(Xe)&&(Xe=_),n(se)&&(se=b),n(p))if(le.zdf)p=le.zdf.stage;else return ye;else if(p.getBounds){if(n(p.stage))return ht("zim display - Waiter(): The container must have a stage property"),ye}else return ht("zim Tip(): Please pass in a reference to a container with bounds set as parameter to Tip"),ye;Xe>0?ye.showID=e.timeout(Xe,ie):ie();function ie(){var _e;p.boundsToGlobal?_e=p.boundsToGlobal():_e=p.getBounds();var $=new e.Container(_e.x,_e.y,_e.width,_e.height);$.zimTemp=!0,$.loc(0,0,p.stage),ye.pos(l,f,ye.tipAlign,ye.tipValign,$),h&&(ye.tipAlign=="right"?ye.x+=ye.width:ye.tipAlign=="left"&&(ye.x-=ye.width),ye.tipValign=="bottom"?ye.y+=ye.height:ye.tipValign=="top"&&(ye.y-=ye.height)),ye.addTo($.stage),$.zimTemp&&$.removeFrom&&($.removeFrom(),$=null),$=ye.stage,ye.timeoutID&&ye.timeoutID.clear(),ye.timeoutID=e.timeout(se,function(){ye.hide(),$.stage.update()}),w&&(ye.upID&&$.stage.off("stagemouseup",ye.upID),ye.upID=$.stage.on("stagemouseup",function(){ye.hide(),$.stage&&$.stage.update()})),$.stage&&$.stage.update()}return ye},this.hide=function(){return this.removeFrom(),this.timeoutID&&this.timeoutID.clear(),this.upID&&p.stage&&p.stage.off("stagemouseup",this.upID),ye},this.clear=function(){ye.showID&&ye.showID.clear(),ye.hide()},this.dispose=function(Xe,se,Ae){ye.upID&&ye.stage&&ye.stage.off("stagemouseup",ye.upID),Ae||this.zimLabel_dispose(!0)},Ce!==!1&&e.styleTransforms(this,J),this.clone=function(){return ye.cloneProps(new e.Tip(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B,Z,U,ee,ae,re,he,j,G,y,g,d,F,Ce,this.group,Q))}},e.extend(e.Tip,e.Label,["dispose","clone"],"zimLabel",!1),e.Pane=function(K,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B,Z,U,ee){var ae="content, backgroundColor, color, width, height, draggable, resets, modal, corner, backdropColor, shadowColor, shadowBlur, center, displayClose, backdropClose, backing, fadeTime, container, titleBar, titleBarColor, titleBarBackgroundColor, titleBarHeight, close, closeColor, autoPadding, autoPaddingH, autoPaddingV, style, group, inherit";if(K&&!K.header&&!K.message&&!K.display&&!K.buttons){var re;if(re=mt(e.Pane,arguments,ae,this))return re}qe("58"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Pane";var he="zim display - Pane(): Please pass in a reference to a container with bounds set as first parameter";if(n(L))if(le.zdf)L=le.zdf.stage;else{ht(he);return}else if(L.getBounds){if(n(L.getStage)){ht("zim display - Pane(): The container must have a stage property");return}}else{ht(he);return}this.group=U;var j=Z===!1?{}:e.getStyle(this.type,this.group,ee);n(o)&&(o=j.width!=null?j.width:"auto"),n(l)&&(l=j.height!=null?j.height:"auto"),n(K)&&(K=j.content!=null?j.content:" "),(typeof K=="string"||typeof K=="number")&&(K=new e.Label({text:K,size:j.size!=null?j.size:40,align:j.align!=null?j.align:"center",valign:j.valign!=null?j.valign:"center",color:j.color!=null?j.color:i,backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",group:this.group}).noMouse());var G=this.content=K;n(r)&&(r=j.backgroundColor!=null?j.backgroundColor:e.white),n(f)&&(f=j.draggable!=null?j.draggable:!1),n(h)&&(h=j.resets!=null?j.resets:!0),n(p)&&(p=j.modal!=null?j.modal:!0),n(_)&&(_=j.corner!=null?j.corner:20),n(S)&&(S=j.titleBar!=null?j.titleBar:null),n(E)&&(E=j.titleBarColor!=null?j.titleBarColor:null),n(k)&&(k=j.titleBarBackgroundColor!=null?j.titleBarBackgroundColor:null),n(X)&&(X=j.titleBarHeight!=null?j.titleBarHeight:null),n(b)&&(b=j.backdropColor!=null?j.backdropColor:"rgba(0,0,0,.2)"),n(w)&&(w=j.shadowColor!=null?j.shadowColor:"rgba(0,0,0,.3)"),n(C)&&(C=j.shadowBlur!=null?j.shadowBlur:20),n(O)&&(O=j.center!=null?j.center:!0),n(P)&&(P=j.displayClose!=null?j.displayClose:!0),f&&(P=!1),n(A)&&(A=j.backdropClose!=null?j.backdropClose:!0),n(T)&&(T=j.fadeTime!=null?j.fadeTime:0),n(q)&&(q=j.close!=null?j.close:!1),n(V)&&(V=j.closeColor!=null?j.closeColor:e.grey),n(I)&&(I=j.autoPadding!=null?j.autoPadding:70),n(te)&&(te=j.autoPaddingH!=null?j.autoPaddingH:I),n(B)&&(B=j.autoPaddingV!=null?j.autoPaddingV:I);var y=this.backdrop=new e.Shape({style:!1}),g=y.graphics;g.f(b),g.drawRect(-5e3,-5e3,1e4,1e4);var d=this;if(this.add=function(ie,_e,$,xe){var Be="obj, index, center, replace",me;return(me=mt(d.add,arguments,Be,d))?me:(n($)&&($=!0),n(xe)&&(xe=!0),typeof ie=="string"&&(ie=new si(ie,null,null,i).noMouse()),xe&&d.contentContainer.removeAllChildren(),$?ie.center(d.contentContainer,_e):ie.addTo(d.contentContainer,_e),d)},G){var D=e.makeContent(G,o,e.dark),m=["header","message","text","display","buttons","config"];m.forEach(function(_e){D[_e]&&(d[_e]=D[_e])}),d.label=d.message,o=="auto"&&(o=D.width+te*2),l=="auto"&&(l=D.height+B*2)}var K=d.contentContainer=new e.Container(o,l);D&&d.add(D,null,!0),this.setBounds(-o/2,-l/2,o,l);var m=["header","message","text","display","buttons","config"];K&&m.forEach(function(ie){K[ie]&&(d[ie]=K[ie])}),d.label=d.message,d.container=L,y.on((Dt?e.ACTIONEVENT=="mousedown":le.ACTIONEVENT=="mousedown")?"mousedown":"click",A?Ce:function(ie){ie.stopImmediatePropagation()});var F=new e.Dictionary(!0);function Ce(ie){d.dispatchEvent("closing"),setTimeout(function(){ye(),d.dispatchEvent("close")},10),ie.stopImmediatePropagation()}y.on("mousedown",function(ie){ie.stopImmediatePropagation()}),this.addChild(y),p||y.noMouse();var Y;if(n(R))Y=this.backing=new e.Rectangle({width:o,height:l,color:r,corner:_,style:!1});else{if(R.type=="Pattern"){var Q=R;Y=new e.Rectangle(o,l,r,null,null,_,null,null,null,!1),Q.centerReg(Y),Q.setMask(Y.shape)}else Y=R;d.display=d.backing=Y}if(P&&(Y.cur("pointer"),Y.on((Dt?e.ACTIONEVENT=="mousedown":le.ACTIONEVENT=="mousedown")?"mousedown":"click",Ce)),w!=-1&&C>0&&(Y.shadow=new $e.Shadow(w,8,8,C)),Y.on("click",function(ie){ie.stopImmediatePropagation()}),this.resetX,this.resetY,f){Y.cur("pointer");var ce,pe;Y.on("mousedown",function(ie){isNaN(d.resetX)&&(d.resetX=d.x),isNaN(d.resetY)&&(d.resetY=d.y),ce=ie.stageX/e.scaX-d.x,pe=ie.stageY/e.scaY-d.y,Y.cur("pointer")}),Y.on("pressmove",function(ie){var _e=Ae(ie.stageX/e.scaX-ce,ie.stageY/e.scaY-pe);d.x=_e.x,d.y=_e.y;for(var $,xe=0;xe<d.numChildren;xe++)$=d.getChildAt(xe),($.type=="TextArea"||$.type=="Loader"||$.type=="Tag")&&$.resize();d.stage.update()}),this.on("pressup",function(){Y.cur("pointer"),d.stage&&d.stage.update()})}if(Y.centerReg(this),K&&K.center(this),!n(S)){typeof S=="string"&&(S=new e.Label(S,null,null,E));var J=d.titleBarLabel=S;n(X)&&(X=J.height*1.5),n(E)&&(E=e.black),n(k)&&(k="rgba(0,0,0,.2)"),d.titleBar=S=new e.Container(o,X,null,null,!1).centerReg(d).mov(0,-l/2+X/2),S.mouseEnabled=!1,S.mouseChildren=!1,d.titleBar.backing=new e.Rectangle(o,X,k,null,null,[_*.95,_*.95,0,0],null,null,null,!1).addTo(S),J.center(S).pos({x:Math.max(_/2,10),reg:!0})}q&&(q=d.close=new e.Shape(-40,-40,80,80,null,!1),q.graphics.f(V).p("AmJEVIEUkTIkXkWIB4h5IEWEYIETkTIB4B3IkTESIEQERIh4B4IkRkRIkSEVg"),S?q.addTo(d).scaleTo(S,null,50).mov(o/2-Math.max(_/2,10)-q.width/2,-l/2+X/2).expand(40):q.addTo(d).sca(.3).mov(o/2-q.width-3,-l/2+q.height).expand(40),q.cur("pointer"),q.expand(),q.on((Dt?e.ACTIONEVENT=="mousedown":le.ACTIONEVENT=="mousedown")?"mousedown":"click",Ce)),Object.defineProperty(d,"text",{get:function(){if(d.message){var ie=d.message.text==" "?"":d.message.text;return ie}else if(d.content.text){var ie=d.content.text==" "?"":d.content.text;return ie}},set:function(ie){d.message?d.message.text=ie:d.content.text&&(d.content.text=ie)}}),this._enabled=!0,Object.defineProperty(d,"enabled",{get:function(){return d._enabled},set:function(ie){c(d,ie)}}),this.hide=function(ie,_e){return n(ie)||(d.closeParams=ie),ye(),_e&&(d.dispatchEvent("close"),d.dispatchEvent("change")),d},this.on("removed",ue);function ue(){d.toggled=!1;var ie,_e;for(_e=0;_e<d.numChildren;_e++)if(ie=d.getChildAt(_e),ie.type=="TextArea"||ie.type=="Loader"||ie.type=="Tag"){var $={obj:ie,depth:d.getChildIndex(ie)};F.add(ie,$)}for(_e=d.numChildren-1;_e>=0;_e--)ie=d.getChildAt(_e),(ie.type=="TextArea"||ie.type=="Loader"||ie.type=="Tag")&&d.removeChild(ie);if(!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&d.container.stage.update(),h&&(isNaN(d.resetX)||(d.x=d.resetX),isNaN(d.resetY)||(d.y=d.resetY)),d.zimAccessibility){var xe=d.zimAccessibility;xe.resize(d),Xe?Xe.focus():d.zimTabTag.nextSibling.focus(),setTimeout(function(){xe.talk("Pane has been closed.")},50)}}function ye(){T>0?d.animate({obj:{alpha:0},time:T,call:function(){ie(),d.dispatchEvent("fadedout")}}):ie();function ie(){d.container.removeChild(d),d.closeCall&&d.closeCall(d.closeParams),!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&d.container.stage.update(),h&&(isNaN(d.resetX)||(d.x=d.resetX),isNaN(d.resetY)||(d.y=d.resetY))}}var Xe;this.show=function(ie,_e){return n(ie)||(d.closeCall=ie),n(_e)||(d.closeParams=_e),O&&isNaN(d.resetX)&&(d.x=d.container.getBounds().width/2,d.y=d.container.getBounds().height/2),d.container.addChild(d),T>0?(d.alpha=0,d.animate({props:{alpha:1},time:T,call:function(){d.dispatchEvent("fadedin")}})):setTimeout(function(){d.container.stage&&d.container.stage.update()},10),d},this.on("added",se);function se(){for(var ie=0;ie<F.length;ie++)d.addChildAt(F.values[ie].obj,F.values[ie].depth);if(d.zimAccessibility){var _e=d.zimAccessibility;setTimeout(function(){_e.activatedObject&&(Xe=_e.activatedObject.zimTabTag)},50),_e.resize(d),_e.tabIndex=d.zimTabIndex}d.toggled=!0}function Ae(ie,_e){return ie=Math.max(o/2,Math.min(d.container.getBounds().width-o/2,ie)),_e=Math.max(l/2,Math.min(d.container.getBounds().height-l/2,_e)),{x:ie,y:_e}}this.toggle=function(ie){return ie===!0?d.show():ie===!1||d.container.contains(d)?d.hide():d.show(),d},Z!==!1&&e.styleTransforms(this,j),this.clone=function(){var ie=d.contentContainer.x,_e=d.contentContainer.y,$=d.cloneProps(new e.Pane(e.copy(K),r,i,o,l,f,h,p,_,b,w,C,O,P,A,n(R)?null:R.clone(),T,d.container,S,E,k,X,q,V,I,te,B,Z,this.group,ee));return $.contentContainer.x=ie,$.contentContainer.y=_e,$}},e.extend(e.Pane,e.Container,"clone","zimContainer",!1),e.Panel=function(t,r,d,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B){var Z="width, height, content, titleBar, titleBarColor, titleBarBackgroundColor, titleBarHeight, backgroundColor, borderColor, borderWidth, corner, close, closeColor, next, nextColor, extraButton, collapse, collapseColor, collapsed, align, shadowColor, shadowBlur, draggable, boundary, style, group, inherit",U;if(U=mt(e.Panel,arguments,Z,this))return U;qe("57.7"),this.group=te;var ee=I===!1?{}:e.getStyle("Panel",this.group,B);n(t)&&(t=ee.width!=null?ee.width:250),n(r)&&(r=ee.height!=null?ee.height:300),this.zimContainer_constructor(t,r,null,null,!1),this.type="Panel",n(d)&&(d=ee.content!=null?ee.content:null);var ae=this.content=d;n(o)&&(o=ee.titleBar!=null?ee.titleBar:"PANEL"),n(l)&&(l=ee.titleBarColor!=null?ee.titleBarColor:e.white),n(f)&&(f=ee.titleBarBackgroundColor!=null?ee.titleBarBackgroundColor:e.grey),n(h)&&(h=ee.titleBarHeight!=null?ee.titleBarHeight:30),n(p)&&(p=ee.backgroundColor!=null?ee.backgroundColor:e.lighter),n(_)&&(_=ee.borderColor!=null?ee.borderColor:e.pewter),n(b)&&(b=ee.borderWidth!=null?ee.borderWidth:null),_<0||b<0?_=b=null:_!=null&&b==null&&(b=1),n(w)&&(w=ee.corner!=null?ee.corner:5),n(E)&&(E=ee.align!=null?ee.align:"left"),n(k)&&(k=ee.shadowColor!=null?ee.shadowColor:"rgba(0,0,0,.3)"),n(X)&&(X=ee.shadowBlur!=null?ee.shadowBlur:14),n(q)&&(q=ee.draggable!=null?ee.draggable:!1),n(V)&&(V=ee.boundary!=null?ee.boundary:null),n(C)&&(C=ee.close!=null?ee.close:!1),n(O)&&(O=ee.closeColor!=null?ee.closeColor:n(l)?e.grey:l),n(P)&&(P=ee.next!=null?ee.next:e.vee(o)),n(A)&&(A=ee.nextColor!=null?ee.nextColor:n(l)?e.grey:l),Array.isArray(w)||(w=[w,w,w,w]),n(T)&&(T=ee.collapse!=null?ee.collapse:!1),n(L)&&(L=ee.collapseColor!=null?ee.collapseColor:n(l)?e.grey:l),n(S)&&(S=ee.collapsed!=null?ee.collapsed:!1);var re=this,he=this.background=new e.Rectangle(t,r,p,_,b,w).addTo(this);k!=-1&&X>0&&(this.background.shadow=new $e.Shadow(k,3,3,X));var j=o,G=e.Pick.choose(j),y=e.Pick.choose(l),g=e.Pick.choose(f),d=re.contentContainer=new e.Container(t,r-h).addTo(re).mov(0,h);typeof G=="string"&&(G=new e.Label({text:G,color:y,size:ee.size!=null?ee.size:20,bold:ee.bold!=null?ee.bold:!1,backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",group:this.group}));var D=re.titleBarLabel=G;n(g)&&(g="rgba(0,0,0,.2)"),re.titleBar=o=new e.Container(t,h,null,null,!1).loc(0,0,re);var K=re.titleBar.backing=new e.Rectangle(t+b,h,g,null,null,[w[0]*.95,w[1]*.95,0,0],!0,null,null,!1).center(o);if(o&&Y(),re.label=G,re.text=G.text,C){var m=re.closeIcon=new e.Shape(-40,-40,80,80,null,!1);m.graphics.f(O).p("AmJEVIEUkTIkXkWIB4h5IEWEYIETkTIB4B3IkTESIEQERIh4B4IkRkRIkSEVg"),o?(m.centerReg(o).scaleTo(o,null,50),m.pos(Math.max(w[1]/2,15),null,!0)):m.addTo(re).sca(.3).mov(t/2-m.width-3,-r/2+C.height),m.expand(40),m.cur("pointer"),m.on((Dt?e.ACTIONEVENT=="mousedown":le.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){var J=re.stage;re.removeFrom(),re.dispatchEvent("close"),J.update()})}if(this.add=function(J,ue,ye,Xe){var se="obj, index, center, replace",Ae;return(Ae=mt(re.add,arguments,se,re))?Ae:(Xe&&re.contentContainer.removeAllChildren(),ye?J.center(re.contentContainer,ue):J.addTo(re.contentContainer,ue),re)},ae){var F=e.makeContent(ae,t),Ce=["header","message","text","display","buttons","config"];Ce.forEach(function(J){F[J]&&(re[J]=F[J])}),re.label=re.message,re.add(F,null,!0)}this.nextPanel=function(J,ue){var ye=n(J)||n(j.array)?e.Pick.choose(j):j.array[J],Xe=n(J)||n(l.array)?e.Pick.choose(l):l.array[J],se=n(J)||n(f.array)?e.Pick.choose(f):f.array[J],Ae=n(J)||n(p.array)?e.Pick.choose(p):p.array[J],ie=n(J)||n(_.array)?e.Pick.choose(_):_.array[J];typeof ye=="string"&&(ye=new e.Label({text:ye,color:Xe,size:ee.size!=null?ee.size:20,backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",group:this.group})),re.label=ye,re.text=ye.text,D.removeFrom(),D=re.titleBarLabel=ye,Y(),K.color=se,re.background.color=Ae,re.background.borderColor=ie,ue&&re.dispatchEvent("change"),!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&re.stage&&re.stage.update()};function Y(){E=="right"?D.center(o).pos(Math.max(w[0]/2,10),null,!0):E=="center"||E=="middle"?D.center(o):D.center(o).loc(Math.max(w[0]/2,10)),D.mov(0,2)}if(q&&(o.cur("pointer"),o.on("mousedown",function(){re.drag({rect:V,currentTarget:!0})}),o.on("pressup",function(){re.noDrag(!1)})),P>0){var Q=re.nextIcon=new e.Shape(-20,-20,40,40,null,!1);Q.graphics.f(l).p("AiJieIETCeIkTCfg"),Q.centerReg(o).scaleTo(o,null,70).alp(.8).hov(1).expand(),Q.pos(Math.max(w[1]/2,15),null,!0),m&&Q.mov(-m.width-8),Q.cur("pointer"),Q.on((Dt?e.ACTIONEVENT=="mousedown":le.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){re.nextPanel(),re.dispatchEvent("change")})}if(n(R)||(R=re.extraButton=new e.Button({label:"R",width:50,height:50,corner:5,group:"PanelExtra"}).scaleTo(o,null,70).centerReg(o).expand(),R.pos(Math.max(w[1]/2,15),null,!0),m&&R.mov(-m.width-8),Q&&R.mov(-Q.width-8)),T){pe=S,re.collapse=function(J){if(n(J)&&(J=!0),J==pe)return re;J?(ce.rot(180),he.visible=!1,d.visible=!1,pe=!0,re.dispatchEvent("collapse")):(ce.rot(0),he.visible=!0,d.visible=!0,pe=!1,re.dispatchEvent("expand")),re.stage&&re.stage.update()},re.collapseEvent=re.titleBar.on("dblclick",function(){re.collapsed=!re.collapsed}),n(L)&&(L=e.grey);var ce=re.collapseIcon=new e.Triangle(90,90,90,e.faint,L,16);ce.centerReg(re).scaleTo(o,null,41).pos({x:t-Math.max(w[1]/2,15)-ce.width/2-4,y:h/2,reg:!0}).expand(40),R&&ce.mov(-R.width-8),m&&ce.mov(-m.width-8),Q&&ce.mov(-Q.width-8),ce.cur("pointer"),ce.expand();var pe=!1;ce.on((Dt?e.ACTIONEVENT=="mousedown":le.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){pe?re.collapse(!1):re.collapse(!0)})}re.overlay=new e.Rectangle(t,r,null,null,null,w).alp(.3),Object.defineProperty(re,"panelHeight",{get:function(){return re.background.height},set:function(J){he.removeFrom(),he=this.background=new e.Rectangle(t,J,p,_,b,w).addTo(this).bot(),k!=-1&&X>0&&(this.background.shadow=new $e.Shadow(k,3,3,X)),re.setBounds(t,J),!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&re.stage&&re.stage.update()}}),Object.defineProperty(re,"collapsed",{get:function(){return pe},set:function(J){re.collapse&&re.collapse(J)}}),this._enabled=!0,Object.defineProperty(re,"enabled",{get:function(){return re._enabled},set:function(J){c(re,J),J?re.overlay.removeFrom():re.overlay.addTo(re),!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&re.stage&&re.stage.update()}}),S&&(S=!1,re.collapsed=!0),I!==!1&&e.styleTransforms(this,ee),this.clone=function(){return re.cloneProps(new e.Toggle(t,r,o?o.clone():"",l,f,h,p,_,b,w,C,O,P,A,R,T,L,re.collapsed,E,k,X,q,V,I,this.group,B))},this.doDispose=function(J,ue,ye){return T&&this.titleBar.off("dblclick",this.collapseEvent),ye||this.zimContainer_dispose(!0),!0}},e.extend(e.Panel,e.Container,["clone","dispose"],"zimContainer",!1),e.Panel.prototype.dispose=function(t){return this.doDispose(null,null,t)},e.Window=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B,Z,U,ee,ae,re,he,j,G,y,g,d,D,K,m,F,Ce,Y,Q,ce,pe,J,ue,ye){var Xe="width, height, content, backgroundColor, borderColor, borderWidth, padding, corner, swipe, scrollBarActive, scrollBarDrag, scrollBarColor, scrollBarAlpha, scrollBarFade, scrollBarH, scrollBarV, slide, slideFactor, slideSnap, slideSnapDamp, interactive, shadowColor, shadowBlur, paddingH, paddingV, scrollWheel, damp, titleBar, titleBarColor, titleBarBackgroundColor, titleBarHeight, draggable, boundary, onTop, close, closeColor, cancelCurrentDrag, fullSize, fullSizeColor, resizeHandle, collapse, collapseColor, collapsed, optimize, resizeBoundary, resizeVisible, continuous, style, group, inherit",se;if(se=mt(e.Window,arguments,Xe,this))return se;qe("58.1"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Window",this.group=ue;var Ae=J===!1?{}:e.getStyle(this.type,this.group,ye);n(t)&&(t=Ae.width!=null?Ae.width:300),n(r)&&(r=Ae.height!=null?Ae.height:200),n(o)&&(o=Ae.backgroundColor!=null?Ae.backgroundColor:e.dark);var ie=l,_e=f;n(l)&&(l=Ae.borderColor!=null?Ae.borderColor:e.silver),n(f)&&(f=Ae.borderWidth!=null?Ae.borderWidth:1),n(h)&&(h=Ae.padding!=null?Ae.padding:0),n(p)&&(p=Ae.corner!=null?Ae.corner:0),n(_)&&(_=Ae.swipe!=null?Ae.swipe:!0),n(b)&&(b=Ae.scrollBarActive!=null?Ae.scrollBarActive:!0),n(w)&&(w=Ae.scrollBarDrag!=null?Ae.scrollBarDrag:!1),n(C)&&(C=Ae.scrollBarColor!=null?Ae.scrollBarColor:l),n(O)&&(O=Ae.scrollBarAlpha!=null?Ae.scrollBarAlpha:.3),n(P)&&(P=Ae.scrollBarFade!=null?Ae.scrollBarFade:!0),n(A)&&(A=Ae.scrollBarH!=null?Ae.scrollBarH:!0),n(R)&&(R=Ae.scrollBarV!=null?Ae.scrollBarV:!0),w&&(P=Ae.scrollBarFade!=null?Ae.scrollBarFade:!1),n(T)&&(T=Ae.slide!=null?Ae.slide:!0),n(L)&&(L=Ae.slideFactor!=null?Ae.slideFactor:.9),n(S)&&(S=Ae.slideSnap!=null?Ae.slideSnap:"vertical"),n(k)&&(k=Ae.interactive!=null?Ae.interactive:!0),n(X)&&(X=Ae.shadowColor!=null?Ae.shadowColor:"rgba(0,0,0,.3)"),n(q)&&(q=Ae.shadowBlur!=null?Ae.shadowBlur:20),n(I)&&(I=Ae.paddingV!=null?Ae.paddingV:h),n(V)&&(V=Ae.paddingH!=null?Ae.paddingH:h),n(te)&&(te=Ae.scrollWheel!=null?Ae.scrollWheel:!0),n(B)&&(B=Ae.damp!=null?Ae.damp:null),n(Z)&&(Z=Ae.titleBar!=null?Ae.titleBar:null),n(U)&&(U=Ae.titleBarColor!=null?Ae.titleBarColor:null),n(ee)&&(ee=Ae.titleBarBackgroundColor!=null?Ae.titleBarBackgroundColor:null),n(ae)&&(ae=Ae.titleBarHeight!=null?Ae.titleBarHeight:null),n(re)&&(re=Ae.draggable!=null?Ae.draggable:null),n(he)&&(he=Ae.boundary!=null?Ae.boundary:null),n(j)&&(j=Ae.onTop!=null?Ae.onTop:null),n(G)&&(G=Ae.close!=null?Ae.close:null),n(y)&&(y=Ae.closeColor!=null?Ae.closeColor:null),n(g)&&(g=Ae.cancelCurrentDrag!=null?Ae.cancelCurrentDrag:!1),n(d)&&(d=Ae.fullSize!=null?Ae.fullSize:null),n(D)&&(D=Ae.fullSizeColor!=null?Ae.fullSizeColor:null),n(K)&&(K=Ae.resizeHandle!=null?Ae.resizeHandle:null),n(m)&&(m=Ae.collapse!=null?Ae.collapse:!1),n(F)&&(F=Ae.collapseColor!=null?Ae.collapseColor:null),n(Ce)&&(Ce=Ae.collapsed!=null?Ae.collapsed:!1),n(Y)&&(Y=Ae.optimize!=null?Ae.optimize:!0),n(Q)&&(Q=Ae.resizeBoundary!=null?Ae.resizeBoundary:null),n(ce)&&(ce=Ae.resizeVisible!=null?Ae.resizeVisible:!1),n(pe)&&(pe=Ae.continuous!=null?Ae.continuous:!1),pe!="horizontal"&&pe!="vertical"&&(pe=!1),this.continuous=pe,Z===!1&&(Z=null),n(Z)||(n(ae)&&(ae=30),r=r-ae);var $=this;$.optimize=Y,this.scrollX=this.scrollY=this.scrollXMax=this.scrollYMax=0;var xe=this.backing=new e.Shape({style:!1});this.addChild(xe);var Be=new $e.Shape;Be.type="WindowBacking";var me=Be.graphics;if(this.addChild(Be),i)var Oe=$.content=i;i=this.contentContainer=new e.Container({style:!1}),this.addChild(i),i.mask=Be;var Ye;if(!k)var de=new $e.Shape;if(f>0){var ve=new $e.Shape;this.addChild(ve)}var Me=Z?0:p,we=0;function Fe(){$.setBounds(0,0,t,r),xe.graphics.c().f(o).rc(0,0,t,r,Me,Me,p,p),X!=-1&&q>0&&(xe.shadow=new $e.Shadow(X,4,4,q)),f>0&&(p?ve.graphics.c().s(l).ss(f,"square","miter").rc(0,0,t,r,Me,Me,p,p):ve.graphics.c().s(l).ss(f,"square","miter").dr(0,0,t,r)),n(it)||(it.widthOnly=$.width+f,ze.widthOnly=$.width+f-1,$.setBounds(0,-ae,$.width,r+ae)),je&&(Z?(je.pos({x:t-Math.max(p/2,10)-je.width/2,y:ae/2,reg:!0}),ze.widthOnly=je.x-15,we=$.width-ze.width):je.pos(Math.max(p/2,10)/2,je.height/2,!0,!1,$)),Je&&(Je.pos({x:t-Math.max(p/2,10)-Je.width/2,y:ae/2,reg:!0}),je&&Je.mov(-je.width-10),Z&&(ze.widthOnly=Je.x-15),we=$.width-ze.width),De&&(De.pos({x:t-Math.max(p/2,10)-De.width/2,y:ae/2,reg:!0}),je&&De.mov(-je.width-10),Je&&De.mov(-Je.width-10),Z&&(ze.widthOnly=De.x-15),we=$.width-ze.width)}Fe();var ge=this.scrollBar={};if(ge.color=C,ge.size=6,ge.minSize=ge.size*2,ge.spacing=3.5+f/2,ge.margin=0,ge.corner=ge.size/2,ge.showTime=.5,ge.fadeTime=3,b){var Ve=ge.horizontal=new e.Shape({style:!1}),He=Ve.graphics;Ve.alpha=O,this.addChild(Ve),w&&Ve.drag({localBoundary:!0});var Le=ge.vertical=new e.Shape({style:!1}),fe=Le.graphics;Le.alpha=O,this.addChild(Le),w&&Le.drag({localBoundary:!0})}var Ge,Qe,Ke,st,yt,We,at,ct,Pe,Ie=!1;if(this.update=function(){b&&(He.clear(),fe.clear()),yt=b?ge.size+ge.spacing*2:0,We=i.getBounds()?i.getBounds().width:0,at=i.getBounds()?i.getBounds().height:0,Ke=A&&We>t-V&&(b||_===!0||_=="auto"||_=="horizontal"),st=R&&at>r-I&&(b||_===!0||_=="auto"||_=="vertical"),$.scrollXMax=We+V*2-t+(st?yt+ge.margin:0),$.scrollYMax=at+I*2-r+(Ke?yt+ge.margin:0),me.clear();var Pt=f/2,ut=f/2,At=t-(st&&b?ge.size+ge.spacing*2:0)-(st?0:f),Ht=r-(Ke&&b?ge.size+ge.spacing*2:0)-(Ke?0:f),Jt=p*(.1+p/100);me.f("rgba(0,0,0,0)").rc(Pt,ut,At,Ht,Ke&&b&&!Z?Jt:Me,st&&b&&!Z?Jt:Me,st&&b?Jt:Math.max(Jt,p-f/2),Ke&&b?Jt:Math.max(Jt,p-f/2)),Be.setBounds($.getBounds().x,$.getBounds().y,$.getBounds().width,$.getBounds().height),e.expand(Be,0),k||(de.graphics.c().f("red").dr(Pt,ut,At,Ht),i.hitArea=de);var zt=Math.max(p,Math.min(ge.corner,ge.spacing)),Qt=zt+f/2,Mt=zt+(st?yt:0)+f/2,Ft=zt+f/2,yn=zt+(Ke?yt:0)+f/2,gn,nn;Ke&&b&&(gn=Math.max(ge.minSize,(t-Qt-Mt)*(t-Qt-Mt)/(We+V+ge.margin)),He.f(ge.color).rr(0,0,gn,ge.size,ge.corner),Ve.x=Qt,Ve.y=r-ge.size-ge.spacing,Ge=new e.Proportion(-$.scrollXMax,0,Qt,t-gn-Mt,-1),w&&(Ve.setBounds(0,0,gn,ge.size),nn=new $e.Rectangle(Qt,Ve.y,t-gn-Qt-Mt,0),Ve.dragBoundary(nn),Ve.proportion=new e.Proportion(nn.x,nn.x+nn.width,0,-$.scrollXMax),Ve.off("pressmove",ct),ct=Ve.on("pressmove",function(){$.dispatchEvent("scrolling"),de&&(de.x=-i.x,de.y=-i.y),i.x=Ve.proportion.convert(Ve.x),St()}))),st&&b&&(gn=Math.max(ge.minSize,(r-Ft-yn)*(r-Ft-yn)/(at+I+ge.margin)),fe.f(ge.color).rr(0,0,ge.size,gn,ge.corner),Le.x=t-ge.size-ge.spacing,Le.y=Ft,Qe=new e.Proportion(-$.scrollYMax,0,Ft,r-gn-yn,-1),w&&(Le.setBounds(0,0,ge.size,gn),nn=new $e.Rectangle(Le.x,Ft,0,r-gn-Ft-yn),Le.dragBoundary(nn),Le.proportion=new e.Proportion(nn.y,nn.y+nn.height,0,-$.scrollYMax),Le.off("pressmove",Pe),Pe=Le.on("pressmove",function(){B&&(Ie=!0),$.dispatchEvent("scrolling"),de&&(de.x=-i.x,de.y=-i.y),B?Kt=Le.proportion.convert(Le.y):i.y=Le.proportion.convert(Le.y),St()}))),Gt(),clearTimeout($.d2Timeout),$.d2Timeout=setTimeout(function(){Ve&&Ve.proportion&&(i.x=Ve.proportion.convert(Ve.x)),Le&&Le.proportion&&(i.y=Le.proportion.convert(Le.y))},50),clearTimeout($.dTimeout),$.dTimeout=setTimeout(function(){ft()},300),ft(),St()},this.resize=function(Pt,ut){n(Pt)&&(Pt=t),n(ut)&&(ut=r);var At=Math.max(20,p*2);Z&&(At=Math.max(we,At)),Pt<At&&(Pt=At),ut<20&&(ut=20),t=Pt,r=ut,Fe();for(var Ht=0;Ht<i.numChildren;Ht++){var Jt=i.getChildAt(Ht);Jt.type=="Wrapper"&&xt(Jt)}return K&&rt(),$.update(),Kt=i.y,B&&tn.immediate(Kt),$.dispatchEvent("resize"),$},!n(Z)){n(re)&&(re=!0),typeof Z=="string"&&(Z=new e.Label({text:Z,color:U,size:Ae.size!=null?Ae.size:20,backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",group:this.group}));var be=$.titleBarLabel=Z;be.noMouse(),n(ee)&&(ee="rgba(0,0,0,.2)"),$.titleBar=Z=new e.Container(t,ae,null,null,!1).centerReg($).mov(0,-r/2-ae/2);var ze=new e.Rectangle(Z.width-1,Z.height,red).alp(0).addTo(Z);be.setMask(ze,!0);var it=$.titleBar.backing=new e.Rectangle(t+f,ae,ee,null,null,[p*.95,p*.95,0,0],!0,null,!1,!1).center(Z);be.center(Z).pos({x:Math.max(p/2,Math.max(10,h)),reg:!0}),$.regX=0,$.regY=-ae,$.setBounds(0,-ae,t,r+ae),re?(Z.cur("pointer"),Z.on("mousedown",function(){$.drag({rect:he,currentTarget:!0,onTop:j})}),Z.on("pressup",function(){$.noDrag(!1)})):Z.on("mousedown",function(){})}if(G){n(y)&&(y=e.grey);var je=$.closeIcon=new e.Shape(-40,-40,80,80,null,!1);je.graphics.f(y).p("AmJEVIEUkTIkXkWIB4h5IEWEYIETkTIB4B3IkTESIEQERIh4B4IkRkRIkSEVg"),Z?je.centerReg($).scaleTo(Z,null,50).pos({x:t-Math.max(p/2,10)-je.width/2,y:ae/2,reg:!0}).expand(40):je.sca(.3).pos(Math.max(p/2,10)/2,je.height/2,!0,!1,$).expand(40),je.cur("pointer"),je.expand(),je.on((Dt?e.ACTIONEVENT=="mousedown":le.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){var Pt=$.stage;$.removeFrom(),$.dispatchEvent("close"),Pt&&Pt.update()})}var tt,Te,et,Ue,Re,Ze;if(!n(Z)){if(d){$.fullSize=function(Pt){if(n(Pt)&&(Pt=!0),Pt==Te||!$.parent)return $;Pt?(et=$.width,Ue=$.height,Re=$.x,Ze=$.y,$.resize($.parent.width,$.parent.height),$.x=0,$.y=0,Te=!0,nt.alpha=1,Je.getChildAt(0).alpha=.01,$.dispatchEvent("fullsize")):($.resize(et,Ue-Z.height),$.x=Re,$.y=Ze,Te=!1,nt.alpha=0,Je.getChildAt(0).alpha=1,$.dispatchEvent("originalsize")),$.stage&&$.stage.update()},n(D)&&(D=e.grey);var Je=$.fullSizeIcon=new e.Rectangle(80,80,e.faint,D,16),nt=new e.Shape().s(D).ss(16).mt(-19.6,-20.6).lt(-19.6,-40).lt(40,-40).lt(40,20.7).lt(19.6,20.7).lt(19.6,40).lt(-40,40).lt(-40,-20.6).lt(-19.6,-20.6).lt(19.6,-20.6).lt(19.6,20.7).addTo(Je).mov(40,40).alp(0);Je.centerReg($).scaleTo(Z,null,42).pos({x:t-Math.max(p/2,10)-Je.width/2,y:ae/2,reg:!0}).expand(40),je&&Je.mov(-je.width-10),Je.cur("pointer"),Je.expand(),Te=!1,et=t,Ue=r,Re=$.x,Ze=$.y,Je.on((Dt?e.ACTIONEVENT=="mousedown":le.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){Te?$.fullSize(!1):$.fullSize(!0)})}var pt=e.copy($.getBounds(),!0);if(m){tt=Ce,$.collapse=function(Pt){if(n(Pt)&&(Pt=!0),Pt==tt)return $;Pt?(De.rot(180),$.backing.visible=!1,$.contentContainer.visible=!1,Be.visible=!1,Ve&&(Ve.visible=!1),Ve&&(Le.visible=!1),ve&&(ve.visible=!1),tt=!0,it.sha(X,5,5,q),K&&($.resizeHandle.visible=!1),$.setBounds(pt.x,pt.y,pt.width,Z.height),$.dispatchEvent("collapse")):(De.rot(0),$.backing.visible=!0,$.contentContainer.visible=!0,Be.visible=!0,Ve&&(Ve.visible=!0),Ve&&(Le.visible=!0),ve&&(ve.visible=!0),tt=!1,it.sha(null),K&&($.resizeHandle.visible=!0),$.setBounds(pt.x,pt.y,pt.width,pt.height),$.dispatchEvent("expand")),$.stage&&$.stage.update()},n(F)&&(F=e.grey);var De=$.collapseIcon=new e.Triangle(90,90,90,e.faint,F,16);De.centerReg($).scaleTo(Z,null,42).pos({x:t-Math.max(p/2,10)-De.width/2,y:ae/2,reg:!0}).expand(40),je&&De.mov(-je.width-10),Je&&De.mov(-Je.width-10),De.cur("pointer"),De.expand(),tt=!1,et=t,Ue=r,Re=$.x,Ze=$.y,De.on((Dt?e.ACTIONEVENT=="mousedown":le.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){tt?$.collapse(!1):$.collapse(!0)})}}if(K){var lt=new ii().loc(0,0,$).mov($.width,$.height-($.titleBar?$.titleBar.height:0)),vt=$.resizeHandle=new e.Rectangle(25,25,e.grey,e.white).alp(ce?.5:.01).centerReg().rot(45).loc(0,0,lt).drag({boundary:Q,localBoundary:!0});vt.on("mouseover",function(){vt.alp(.5),vt.stage&&vt.stage.update()}),vt.on("mousedown",function(){vt.pressing=!0}),vt.on("mouseout",function(){vt.pressing||(ce||vt.alp(.01),vt.stage&&vt.stage.update())}),vt.on("pressmove",function(){$.resize(Math.max(50,lt.x+vt.x),Math.max(50,lt.y+vt.y))}),vt.on("pressup",function(){vt.pressing=!1,ce||vt.alp(.01),rt(),vt.stage&&vt.stage.update()}),$.titleBar&&$.titleBar.on("pressup",rt)}function rt(Pt){$.resizeHandle.loc(0,0,lt).top().mov(-lt.x+$.width,-lt.y+$.height-($.titleBar?$.titleBar.height:0))}function xt(Pt){Pt.align=="right"?(Pt.x=V,Pt.resize($.width-(st?ge.size+ge.spacing*2:V)-V*2)):(Pt.align=="center"||Pt.align=="middle",Pt.resize($.width-(st?ge.size+ge.spacing*2:0)-V*2)),Pt.alpha=Pt.wrapperLastAlpha}if(Fe(),this.add=function(Pt,ut,At,Ht){var Jt="obj, index, center, replace",zt;if(zt=mt($.add,arguments,Jt,$))return zt;var Qt=Pt;if(!Qt.getBounds()){ht("Window.add() - please add content with bounds set");return}return xn(Qt),n(ut)&&(ut=i.numChildren),Ht&&(ut=0,$.removeAll()),At?(Qt.center($).addTo(i,ut).mov(0,ae?ae/2:0),i.height>$.height-(ae||0)&&Qt.loc(null,0),i.width>$.width&&Qt.loc(0)):Qt.addTo(i,ut),Qt.type=="Wrapper"&&(Le.alpha=0,A=!1,Qt.wrapperLastAlpha=Qt.alpha,Qt.alpha=0,this.added(function(){xt(Qt),$.resize(),Ve.alpha=1,Le.alpha=1})),Qt.x==0&&(Qt.x=V),Qt.y==0&&(Qt.y=I),$.update(),$},Oe){var wt=e.makeContent(Oe,t),_t=["header","message","text","display","buttons","config"];_t.forEach(function(Pt){wt[Pt]&&($[Pt]=wt[Pt])}),$.label=$.message,$.add(wt,0,!0)}this.remove=function(Pt){return i.removeChild(Pt),$.update(),$},this.removeAll=function(){return i.removeAllChildren(),$.update(),$};function ft(Pt){pe||(n(Ye)&&(Ye=$.stage||le.zdf.stage),n(Pt)&&(Pt=!0),Pt?e.dragBoundary(i,new $e.Rectangle(0,0,Ke?-$.scrollXMax:0,st?-$.scrollYMax:0)):e.dragBoundary(i,new $e.Rectangle(-1e3,-1e3,Ye.width+2e3,Ye.height+2e3)))}var Ot=!1;_&&i.on("mousedown",function(){Ot||e.Ticker.add(Rt,i.stage),Ot=!0,Ke&&b&&P&&e.animate(Ve,{alpha:O},ge.showTime),st&&b&&P&&e.animate(Le,{alpha:O},ge.showTime)});function Rt(){Kt=i.y,B&&tn.immediate(Kt),b?Gt():$.dispatchEvent("scrolling")}function St(){$.optimize&&(Ye=$.stage,i.loop(function(Pt){!Pt.hitTestBounds||!Pt.stage||(Pt.hitTestBounds($,300)?(Pt.visible=!0,Pt.loop&&Pt.loop(function(ut){ut.hitTestBounds&&(ut.hitTestBounds($,300)?ut.visible=!0:ut.visible=!1)})):Pt.visible=!1)}))}function Gt(){St(),$.dispatchEvent("scrolling"),de&&(de.x=-i.x,de.y=-i.y),Ke&&b&&(Ve.x=Ge.convert(i.x)),st&&b&&(Le.y=Qe.convert(i.y))}this.on("added",function(){Yt(50)},null,!0);function Yt(Pt){n(Pt)&&(Pt=100),xn($),_&&setTimeout(function(){i&&(e.drag({obj:i,currentTarget:!0,axis:pe,localBoundary:!0,slide:T,slideFactor:L,slideSnap:A&&(_===!0||_=="auto"||_=="horizontal")||R&&(_===!0||_=="auto"||_=="vertical")?S:!1}),i.removeAllEventListeners("slidestart"),i.on("slidestart",function(){$.dispatchEvent("slidestart")}),i.removeAllEventListeners("slidestop"),!b&&Y&&($.zDE&&i.off($.zDE),$.zDE=i.on("mousedown",()=>{$.zTI&&e.Ticker.remove(St)}),$.zME&&i.off($.zME),$.zME=i.on("pressmove",St),$.zSTA&&i.off($.zSTA),$.zSTA=i.on("slidestart",function(){$.zTI=e.Ticker.add(St)}),$.zSTO&&i.off($.zSTO),$.zSTO=i.on("slidestop",function(ut){$.zTI&&e.Ticker.remove($.zTI)})),i.on("slidestop",function(ut){T&&sn(ut),$.dispatchEvent("slidestop")}),i.getBounds()&&i.getBounds().width>0&&ft())},Pt)}this.cancelCurrentDrag=function(){$.contentContainer&&$.contentContainer.noDrag(!1),setTimeout(function(){i&&(e.drag({obj:i,currentTarget:!0,localBoundary:!0,slide:T,slideFactor:L,slideSnap:A&&(_===!0||_=="auto"||_=="horizontal")||R&&(_===!0||_=="auto"||_=="vertical")?S:!1}),i.getBounds()&&i.getBounds().width>0&&ft())},300)};var $t;this.added(function(Pt){Ye=Pt,$t=Ye.on("stagemousemove",function(ut){$.windowMouseX=ut.stageX/e.scaX,$.windowMouseY=ut.stageY/e.scaY})}),T?i.on("slidestop",sn):i.on("mousedown",function(){i.stage.on("stagemouseup",sn,null,!0)}),g&&($.blurEvent=function(){$.cancelCurrentDrag(),sn()},document.WW.addEventListener("blur",$.blurEvent));function sn(){e.Ticker.remove(Rt),Ot=!1,Ke&&P&&b&&e.animate(Ve,{alpha:0},ge.fadeTime),st&&P&&b&&e.animate(Le,{alpha:0},ge.fadeTime)}var en=!1,Lt,Zt=0,ot=0,bt=0,Bt=0,It=300,Ut=2;function kt(){Lt=Date.now(),e.Ticker.add(Wt,i.stage)}function Nt(){en||($.dispatchEvent("hoverout"),en=!0),e.Ticker.remove(Wt)}function Wt(){if(!i.stage){en||($.dispatchEvent("hoverout"),en=!0),e.Ticker.remove(Wt);return}Math.abs(Zt-$.windowMouseX)>Ut||Math.abs(ot-$.windowMouseY)>Ut?(en||($.dispatchEvent("hoverout"),en=!0),Lt=Date.now(),Zt=$.windowMouseX,ot=$.windowMouseY):Date.now()-Lt>It&&((Math.abs(bt-$.windowMouseX)>Ut||Math.abs(Bt-$.windowMouseY)>Ut)&&($.contentMouse=i.globalToLocal($.windowMouseX,$.windowMouseY),$.dispatchEvent("hoverover"),bt=$.windowMouseX,Bt=$.windowMouseY,en=!1),Lt=Date.now())}if(k){var jt,rn;i.on("mousedown",function(Pt){Ye=Pt.target.stage,jt=Pt.stageX/e.scaX,rn=Date.now()}),i.on("click",function(Pt){Date.now()-rn<600&&Math.abs(Pt.stageX/e.scaX-jt)<5&&($.contentMouse=i.globalToLocal(Pt.stageX/e.scaX,Pt.stageY/e.scaY),$.dispatchEvent("select"))}),i.on("mouseover",kt),i.on("mouseout",Nt)}var Kt=$.scrollY;$.scrollWindow=function(ut){if(st&&$.stage&&$.hitTestPoint($.windowMouseX,$.windowMouseY)&&$.contains($.stage.getObjectUnderPoint($.windowMouseX*e.scaX,$.windowMouseY*e.scaY))){n(ut)&&(ut=event);var At=ut.detail?ut.detail*-19:ut.wheelDelta;n(At)&&(At=ut.deltaY*-19),Kt+=At,Kt=Math.max(-$.scrollYMax,Math.min(0,Kt)),B||($.scrollY=Kt,i.stage.update()),Ie=!1}Y&&St()},te&&(le.addEventListener("mousewheel",$.scrollWindow),le.addEventListener("wheel",$.scrollWindow),le.addEventListener("DOMMouseScroll",$.scrollWindow));var ln=!1,tn;function xn(Pt){B&&!ln&&Pt.stage&&(ln=!0,tn=new e.Damp($.scrollY,B),$.dampTicker=e.Ticker.add(function(){if(!Ot){if($.scrollY!=null&&Kt!=null&&$.scrollY!=Kt&&Math.round($.scrollY)==Math.round(Kt)){Ie=!1;return}n(Kt)||(i.y=tn.convert(Kt)),Ie||Gt()}},Pt.stage))}this._enabled=!0,Object.defineProperty($,"enabled",{get:function(){return $._enabled},set:function(Pt){Pt?Yt():(clearTimeout($.dTimeout),e.noDrag(i)),c($,Pt)}}),this._scrollEnabled=!0,Object.defineProperty($,"scrollEnabled",{get:function(){return $._scrollEnabled},set:function(Pt){Pt?(Yt(),w&&(ct&&(Ve.mouseEnabled=!0),Pe&&(Le.mouseEnabled=!0)),le.addEventListener("mousewheel",$.scrollWindow),le.addEventListener("wheel",$.scrollWindow),le.addEventListener("DOMMouseScroll",$.scrollWindow)):(clearTimeout($.dTimeout),e.noDrag(i),w&&(ct&&(Ve.mouseEnabled=!1),Pe&&(Le.mouseEnabled=!1)),le.removeEventListener("mousewheel",$.scrollWindow),le.removeEventListener("wheel",$.scrollWindow),le.removeEventListener("DOMMouseScroll",$.scrollWindow)),$._scrollEnabled=Pt}}),Object.defineProperty($,"scrollX",{get:function(){return i.x},set:function(Pt){i.x=Pt,clearTimeout($.d2Timeout),i.zimDragImmediate&&i.zimDragImmediate(i.x,i.y),Gt()}}),Object.defineProperty($,"scrollY",{get:function(){return i.y},set:function(Pt){i.y=Pt,i.y=Kt=Pt,B&&tn.immediate(Kt),clearTimeout($.d2Timeout),i.zimDragImmediate&&i.zimDragImmediate(i.x,i.y),Gt()}}),Object.defineProperty($,"backgroundColor",{get:function(){return o},set:function(Pt){o=Pt,Fe()}}),Object.defineProperty($,"borderColor",{get:function(){return l},set:function(Pt){l=Pt,Fe()}}),Object.defineProperty($,"borderWidth",{get:function(){return f},set:function(Pt){f=Pt,Fe()}}),Object.defineProperty($,"fullSized",{get:function(){return Te},set:function(Pt){$.fullSize&&$.fullSize(Pt)}}),Object.defineProperty($,"collapsed",{get:function(){return tt},set:function(Pt){$.collapse&&$.collapse(Pt)}}),Ce&&(tt=!1,$.collapsed=!0),$.titleBar&&($.collapseEvent=$.titleBar.on("dblclick",function(){$.collapsed=!$.collapsed})),J!==!1&&e.styleTransforms(this,Ae),this.clone=function(Pt){n(Pt)&&(Pt=!0);var ut=$.cloneProps(new e.Window(t,r,null,o,ie,_e,h,p,_,b,w,ge.color,O,P,A,R,T,L,S,E,k,X,q,V,I,Z,U,ee,ae,re,he,j,G,y,g,d,D,K,m,F,Ce,Y,Q,ce,pe,J,ue,ye));return Pt&&($.contentContainer.cloneChildren(ut.contentContainer),ut.update()),ut},this.doDispose=function(Pt,ut,At){return te&&(le.removeEventListener("mousewheel",$.scrollWindow),le.removeEventListener("wheel",$.scrollWindow),le.removeEventListener("DOMMouseScroll",$.scrollWindow)),i&&($.zDE&&i.off($.zDE),$.zME&&i.off($.zME),$.zSTA&&i.off($.zSTA),$.zSTO&&i.off($.zSTO),$.zTI&&e.Ticker.remove($.zTI)),$.titleBar&&$.titleBar.removeAllEventListeners(),$t&&Ye&&Ye.off("stagemousemove",$t),$.resizeHandle&&$.resizeHandle.removeAllEventListeners(),$.blurEvent&&le.removeEventListener("blur",$.blurEvent),typeof Wt<"u"&&e.Ticker.remove(Wt),n(Rt)||e.Ticker.remove(Rt),At||this.zimContainer_dispose(!0),i=$.contentContainer=null,!0}},e.extend(e.Window,e.Container,["clone","dispose"],"zimContainer",!1),e.Window.prototype.dispose=function(t){return this.doDispose(null,null,t)},Pi=e.Window,e.Page=function(t,r,i,o,l,f,h,p,_,b,w){var C="width, height, color, color2, angle, pattern, scalePattern, cache, style, group, inherit",O;if(O=mt(e.Page,arguments,C,this))return O;qe("58.3"),this.group=b;var P=_===!1?{}:e.getStyle("Page",this.group,w);n(t)&&(t=P.width!=null?P.width:le.zdf.width),n(r)&&(r=P.height!=null?P.height:le.zdf.height),this.zimContainer_constructor(0,0,t,r,!1),this.type="Page";var A=this;n(l)&&(l=P.angle!=null?P.angle:90),n(i)&&(i=P.color!=null?P.color:e.light),n(o)&&(o=P.color2!=null?P.color2:null),n(f)&&(f=P.pattern!=null?P.pattern:null),n(h)&&(h=P.scalePattern!=null?P.scalePattern:"fill"),n(p)&&(p=P.cache!=null?P.cache:!1),n(o)||(i=new e.GradientColor([i,o],[0,1],l),o=null);var R=this.backing=new e.Rectangle({width:t,height:r,color:i,scaleDimensions:!1,style:!1}).addTo(this);n(p)&&(!n(o)||!n(f))&&(p=!0),p&&R.cache(),n(f)||(this.pattern=f.addTo(this),h&&f.scaleTo(this,100,100,h).center(this),p&&f.cache()),Object.defineProperty(A,"color",{get:function(){return i},set:function(T){n(T)&&(T=e.black),i=T,A.backing.color=T}}),_!==!1&&e.styleTransforms(this,P),this.clone=function(T){n(T)&&(T=!1),i.type&&(o=null);var L=A.cloneProps(new e.Page(t,r,i,o,vertical,f,h,p,_,b,w));return T&&A.cloneChildren(L),L}},e.extend(e.Page,e.Container,["clone"],"zimContainer",!1),e.Central=function(t,r,i,o,l){qe("58.4"),this.group=o;var f=i===!1?{}:e.getStyle("Central",this.group,l);n(t)&&(t=f.width!=null?f.width:1024),n(r)&&(r=f.height!=null?f.height:768),this.zimContainer_constructor(-t/2,-r/2,t,r);var h=this,p=zimDefaultFrame;h.resizeEvent=p.on("resize",function(){h.scale=p.height/r,h.parent&&h.centerReg(h.parent)}),h.added(function(){h.parent&&h.centerReg(h.parent)}),h.dispose=function(_,b,w){return p.off("resize",h.resizeEvent),h.zimContainer_dispose(_,b,w)},i!==!1&&e.styleTransforms(this,f)},e.extend(e.Central,e.Container,["dispose"],"zimContainer",!1),e.Layer=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B,Z,U,ee){var ae="width, height, titleBar, titleBarContainer, backgroundColor, rollBackgroundColor, selectedBackgroundColor, selectedRollBackgroundColor, color, rollColor, selectedColor, selectedRollColor, borderWidth, borderColor, dashed, transformObject, titleBarWidth, titleBarHeight, titleBarX, titleBarY, titleBarDraggable, close, closeColor, closeBackgroundColor, closeIndicatorColor, anchor, onTop, style, group, inherit",re;if(re=mt(e.Layer,arguments,ae,this))return re;qe("58.5"),this.group=U;var he=Z===!1?{}:e.getStyle("Layer",this.group,ee);n(t)&&(t=he.width!=null?he.width:500),n(r)&&(r=he.height!=null?he.height:500),this.zimContainer_constructor(0,0,t,r,!1),this.type="Layer";var j=this;j.distX=40,j.distY=0,n(i)&&(i=he.titleBar!=null?he.titleBar:"LAYER");var G=i,y=i,g=!0;n(l)&&(l=he.backgroundColor!=null?he.backgroundColor:e.lighter),n(f)&&(f=he.rollBackgroundColor!=null?he.rollBackgroundColor:e.white),n(h)&&(h=he.selectedBackgroundColor!=null?he.selectedBackgroundColor:e.granite),n(_)&&(_=he.color!=null?he.color:e.granite),n(b)&&(b=he.rollColor!=null?he.rollColor:e.granite),n(w)&&(w=he.selectedColor!=null?he.selectedColor:e.moon),n(O)&&(O=he.borderWidth!=null?he.borderWidth:1),n(P)&&(P=he.borderColor!=null?he.borderColor:l),(P<0||O<0)&&(P=O=null),n(A)&&(A=he.dashed!=null?he.dashed:!0),n(R)&&(R=he.titleBar!=null?he.titleBar:null),n(T)&&(T=he.titleBarWidth!=null?he.titleBarWidth:100);var d=T;if(n(L)&&(L=he.titleBarHeight!=null?he.titleBarHeight:40),n(S)&&(S=he.titleBarX!=null?he.titleBarX:null),n(E)&&(E=he.titleBarY!=null?he.titleBarY:null),n(k)&&(k=he.titleBarDraggable!=null?he.titleBarDraggable:!0),n(X)&&(X=he.close!=null?he.close:!0),n(q)&&(q=he.closeColor!=null?he.closeColor:h),n(V)&&(V=he.closeBackgroundColor!=null?he.closeBackgroundColor:h),n(I)&&(I=he.closeIndicatorColor!=null?he.closeIndicatorColor:w),n(te)&&(te=he.anchor!=null?he.anchor:!0),n(B)&&(B=he.onTop!=null?he.onTop:!0),k||(te=!1),j.anchor=te,X&&(T+=30),R=e.merge({borderColor:h},R,{onTop:B,events:!0,visible:!1,ghostColor:P,ghostWidth:O,ghostDashed:A,ghostHidden:!0}),n(o)&&(o=he.titleBarContainer!=null?he.titleBarContainer:null),n(o))if(le.zdf)o=le.zdf.stage;else{ht("zim Layer(): Please pass in a reference to a container with bounds set.");return}j.active=!1,j.turnOff=function(){j.active=!1,X&&(j.checkBox.visible=!1),j.transformControls.remove(),j.mouseChildren=!0,j.button.backgroundColor=l,j.button.rollBackgroundColor=f,j.button.color=_,j.button.rollColor=_,j.transformControls.allowToggleOff(),j.resizeChildren&&j.resizeChildren()},j.turnOn=function(){j.active=!0,X&&(j.checkBox.visible=!0,j.checkBox.checked=!0),j.button.backgroundColor=h,j.button.rollBackgroundColor=h,j.button.color=w,j.button.rollColor=w,j.mouseChildren=!1,j.transformControls.add(),j.transformControls.allowToggleOn()};var D;j.titleBarPos=function(F,Ce){if(j.titleBar)return j.titleBar.pos?(j.titleBar.pos(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9]),D.update()):(j.distX=F,j.distY=Ce),g=!1,j};var K=j.visible;j.visible=!1;var m=v();this.added(function(F){D=F,j.transform(R),O>=0&&j.transformControls.hideGhost(),setTimeout(function(){function Ce(){return j.localToLocal(0,0,o)}j.visible=K,O>=0&&setTimeout(function(){j.transformControls.showGhost(),j.stage&&j.stage.update()},200),D=F;var Y=j.titleBar=new e.Container(T,L).reg(0,L).loc(j,null,o).mov(j.distX,j.distY);k&&Y.drag({all:!0,boundary:new e.Boundary(0,L,o.width-T,o.height-L),localBoundary:!0}),(j.distX!=40||j.distY!=0)&&Y.pos(j.distX,j.distY),X&&(j.checkBox=new e.CheckBox({borderColor:q,backgroundColor:V,indicatorColor:I,size:20,startChecked:!0}).center(Y).pos(0,null,!0).change(function(){j.turnOff(),j.dispatchEvent("transformhide")}),j.checkBox.visible=!1),Y.mouseChildren=!0,Y.layer=j,j.resetTitleBar=function(){j.distX=40,j.distY=0,g=!0,j.move(!0),j.stage&&j.stage.update()},(typeof y=="string"||typeof y=="number")&&(y=new e.Label({text:y,color:_,rollColor:b,size:he.size!=null?he.size:18,group:this.group})),j.label=y,j.label.center(Y),j.button=new e.Button({shadowBlur:-1,width:d,height:L-1,label:j.label,color:_,rollColor:b,backgroundColor:l,rollBackgroundColor:f,corner:he.corner!=null?he.corner:0,inherit:e.copy(he)}).addTo(Y),j.button.on("mousedown",function(){o.loop(function(se){se&&se!=Y&&se.layer&&se.layer.turnOff&&se.layer.active&&se.layer.turnOff()}),j.active||(j.turnOn(),j.dispatchEvent("transformshow")),Y.top()}),j.button.on("pressmove",function(){Q()}),j.button.on("pressup",function(){Q(!0);var se=j.localToLocal(0,0,o);j.distX=Y.x-se.x,j.distY=Y.y-se.y,Y.top(),!pe()&&k&&(se=j.localToGlobal(0,0),j.button.hitTestPoint(se.x,se.y)&&j.resetTitleBar())});function Q(se){if(g&&k){var Ae=o.localToLocal(Y.x-j.distX,Y.y-j.distY,j.parent),ie=j.localToLocal(j.regX,j.regY,j.parent),_e=j.localToLocal(0,0,j.parent);j.x=Ae.x+(ie.x-_e.x),j.y=Ae.y+(ie.y-_e.y),j.transformControls.resize(se),ce(j),j.stage&&j.stage.update()}}function ce(se){se.loop(function(Ae){Ae.type=="Layer"&&(j.titleBarDraggable&&Ae.move(),Ae.transformControls.ghost&&Ae.transformControls.resize(),ce(Ae))})}j.button.on("dblclick",function(){k&&j.resetTitleBar()}),j.turnOff(),j.on("transformed",function(se){(se.transformType=="move"||se.transformType=="size"||se.transformType=="stretch"||se.transformType=="rotate")&&(k&&j.move(),ce(j))});function pe(){if(Y.x==0||Y.y==Y.height||Y.x==o.width-Y.width||Y.y==o.height)return!0}j.move=function(se){!se&&!g&&j.anchor&&pe()||(Y.loc(Ce()).mov(j.distX,j.distY),Y.x<0&&(g=!1,Y.x=0),Y.y<Y.height&&(g=!1,Y.y=Y.height),Y.x>o.width-Y.width&&(g=!1,Y.x=o.width-Y.width),Y.y>o.height&&(g=!1,Y.y=o.height),j.anchor||(g=!0))},j.on("transformhide",function(){j.turnOff(),o.loop(function(se){se&&se!=Y&&se.layer&&se.layer.turnOff&&se.layer.active&&se.layer.turnOff()})}),j.resizeChildren=function(se){j.transformControls.resize(se),j.loop(function(Ae){Ae.transformControls&&(Ae.transformControls.visible&&Ae.transformControls.hide(),Ae.type=="Layer"?Ae.resizeChildren():Ae.transformControls.resize())})},j.resize=function(se){return j.move(),j.resizeChildren(se),j},j.toggled=!1;function J(){j.toggled?(o.loop(function(se){se&&se!=Y&&se.layer&&se.layer.turnOff&&se.layer.active&&se.layer.turnOff()}),j.turnOn(),j.dispatchEvent("transformshow")):(Y.top(),j.turnOff(),o.loop(function(se){se&&se!=Y&&se.layer&&se.layer.turnOff&&se.layer.active&&se.layer.turnOff()}),j.dispatchEvent("transformhide")),j.stage&&j.stage.update()}if(j.toggle=function(se){return n(se)?j.toggled=!j.toggled:j.toggled=se,J(),j},Object.defineProperty(j,"titleBarDraggable",{get:function(){return k},set:function(se){k=se,k?Y.drag({all:!0,boundary:e.Boundary(0,40,o.width-T,o.height-L),localBoundary:!0}):Y.noDrag(!1)}}),j.stageUpEvent=D.on("stagemouseup",function(){j.transformControls.visible&&Y.top()}),!n(S)||!n(E)){g=!1;var ue=n(S)?Y.x:S,ye=n(E)?Y.y-L:E;j.titleBarStartX=S,j.titleBarStartY=E,j.titleBarPos(ue,ye);var Xe=j.parent.localToLocal(j.x,j.y,o);j.distX=Y.x-Xe.x,j.distY=Y.y-Xe.y}},50)},m=="s"?.05:50),Z!==!1&&e.styleTransforms(this,he),this.clone=function(){return j.cloneProps(new e.Layer(t,r,G,o,l,f,h,p,_,b,w,C,O,P,A,R,d,L,S,E,k,X,q,V,I,te,B,Z,this.group,ee))},this.dispose=function(F,Ce,Y){return j.stageUpEvent&&D.off("stagemouseup",j.stageUpEvent),o&&o.loop(function(Q){Q.layer=null}),j.transformControls.dispose(),j.transformControls=null,Y||this.zimContainer_dispose(!0),j.titleBar.layer=null,j.titleBar.dispose(),j.checkBox=j.button=null,i=j.titleBar=R=null,!0}},e.extend(e.Layer,e.Container,["clone","dispose"],"zimContainer",!1),e.Waiter=function(t,r,i,o,l,f,h,p,_,b,w){var C="container, speed, foregroundColor, backgroundColor, corner, shadowColor, shadowBlur, fadeTime, style, group, inherit",O;if(O=mt(e.Waiter,arguments,C,this))return O;qe("59"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Waiter",this.group=b;var P=_===!1?{}:e.getStyle(this.type,this.group,w),A=v(r);n(r)&&(r=P.speed!=null?P.speed:A=="s"?.6:600),n(i)&&(i=P.foregroundColor!=null?P.foregroundColor:e.white),n(o)&&(o=P.backgroundColor!=null?P.backgroundColor:"orange"),n(l)&&(l=P.corner!=null?P.corner:16),n(f)&&(f=P.shadowColor!=null?P.shadowColor:"rgba(0,0,0,.3)"),n(h)&&(h=P.shadowBlur!=null?P.shadowBlur:14),n(p)&&(p=P.fadeTime!=null?P.fadeTime:0);var R=40,T=3,L=R*.6/2,S=(R-L*2)/2,E=T*(L*2+S)+S;this.setBounds(-E/2,-R/2,E,R);var k=this,X,q=this.display=new e.Shape({style:!1});this.addChild(q),q.setBounds(0,0,E,R),q.regX=E/2,q.regY=R/2;var V=q.graphics;V.f(o);var I=l;Array.isArray(I)||(I=[l,l,l,l]),V.rc(0,0,E,R,I[0],I[1],I[2],I[3]),f!=-1&&h>0&&(q.shadow=new $e.Shadow(f,3,3,h)),q.on("click",function(ae){ae.stopImmediatePropagation()});var te=new e.Container({style:!1});this.addChild(te);for(var B,Z=0;Z<T;Z++)B=new $e.Shape,B.graphics.f(i).dc(0,0,L),B.x=(Z-(T-1)/2)*(L*2+S),te.addChild(B),B.cache(-L,-L,L*2,L*2),B.alpha=0;this.hide=function(){p>0?k.animate({obj:{alpha:0},time:p,call:ae}):ae();function ae(){if(k.parent&&k.parent.removeChild(k),X=k.stage,X&&X.update(),k.zimAccessibility){var re=k.zimAccessibility;re.resize(k),U?U.focus():k.zimTabTag.nextSibling.focus(),setTimeout(function(){re.talk("Waiter has finished.")},50)}}return k.toggled=!1,k};var U,ee=[];this.show=function(){var ae="zim display - Waiter(): Please pass in a reference to a container with bounds set as first parameter to Waiter";if(n(t))if(le.zdf)t=le.zdf.stage;else{ht(ae);return}else if(t.getBounds){if(n(t.stage)){ht("zim display - Waiter(): The container must have a stage property");return}}else{ht(ae);return}for(var re,he=0,j=r*(A=="s"?1e3:1),G=0;G<te.numChildren;G++)te&&ee.push(setTimeout(function(){re=te.getChildAt(he),$e.Tween.get(re,{loop:!0}).to({alpha:1},j/T/2).wait(j/T).to({alpha:0},j/T).wait(j-j/T-j/T/2),he++},G*j/T));if(k.ticker=$e.Ticker.on("tick",function(){t.stage.update()}),k.x=t.getBounds().width/2,k.y=t.getBounds().height/2,t.addChild(k),p>0&&(k.alpha=0,k.animate({alpha:1},p)),k.zimAccessibility){var y=k.zimAccessibility;setTimeout(function(){y.activatedObject&&(U=y.activatedObject.zimTabTag)},50),y.resize(k),y.talk(k.zimTabTag.getAttribute("aria-label"))}return k.toggled=!0,k},k.toggle=function(ae){return ae===!0?k.show():ae===!1||k.parent?k.hide():k.show(),k},_!==!1&&e.styleTransforms(this,P),this.clone=function(){return k.cloneProps(new e.Waiter(t,r,i,o,l,f,h,p,_,this.group,w))},this.dispose=function(ae,re,he){k.ticker&&$e.Ticker.off("tick",k.ticker),$e.Tween.removeTweens(k),k.removeFrom();for(var j=0;j<te.numChildren;j++){var G=te.getChildAt(j);clearInterval(ee[j]),$e.Tween.removeTweens(G)}return he||this.zimContainer_dispose(!0),!0}},e.extend(e.Waiter,e.Container,["clone","dispose"],"zimContainer",!1),e.ProgressBar=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X){var q="barType, foregroundColor, backgroundColor, borderColor, borderWidth, padding, label, color, labelPosition, percentage, corner, shadowColor, shadowBlur, backing, delay, fastClose, container, autoHide, width, style, group, inherit",V;if(V=mt(e.ProgressBar,arguments,q,this))return V;qe("59.5"),this.zimContainer_constructor(null,null,null,null,!1),this.type="ProgressBar",this.group=k;var I=E===!1?{}:e.getStyle(this.type,this.group,X);n(r)&&(r=I.foregroundColor!=null?I.foregroundColor:e.green),n(i)&&(i=I.backgroundColor!=null?I.backgroundColor:e.charcoal),n(o)&&(o=I.borderColor!=null?I.borderColor:i),n(l)&&(l=I.borderWidth!=null?I.borderWidth:null),n(_)&&(_=I.labelPosition!=null?I.labelPosition:"bottom"),n(t)&&(t=I.barType!=null?I.barType:"circle"),n(f)&&(f=I.padding!=null?I.padding:t=="circle"?2:-.5),n(w)&&(w=I.corner!=null?I.corner:15),n(C)&&(C=I.shadowColor!=null?I.shadowColor:"rgba(0,0,0,.3)"),n(O)&&(O=I.shadowBlur!=null?I.shadowBlur:14),n(P)&&(P=I.backing!=null?I.backing.clone():null),n(R)&&(R=I.fastClose!=null?I.fastClose:!0),o<0||l<0?o=l=null:o!=null&&l==null&&(t=="circle"?l=10:l=2);var te=v(A);n(A)&&(A=I.delay!=null?I.delay:te=="s"?.1:100),n(L)&&(L=I.autoHide!=null?I.autoHide:!0),n(h)&&(h=I.label!=null?I.label:null),n(p)&&(p=I.color!=null?I.color:r),n(S)&&(S=I.width!=null?I.width:t=="circle"?40:200),(typeof h=="string"||typeof h=="number")&&(h=new e.Label({text:h,color:p,backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",group:this.group})),!n(b)&&n(h)&&(h=new e.Label("")),this.label=h;var B=30,Z=this,U=0;Z.visible=!1,setTimeout(function(){Z.visible=!0,Z.stage&&Z.stage.update()},A);var ee;if(t=="circle")S=S/2,P=this.backing=new e.Circle(S,"rgba(0,0,0,0)",i,l,null,null,null,null,!1).addTo(Z),ee=this.bar=new e.Shape({style:!1}).addTo(Z).loc(P.x,P.y).rot(-90);else{if(C!=-1&&O>0){var ae=new e.Rectangle(S-2,B-2,i,null,null,w,null,null,null,!1).addTo(this);ae.shadow=new $e.Shadow(C,3,3,O)}P=G(P);var re=w;Array.isArray(re)||(re=[w,w,w,w]);var he=(f+l/2)*1.2;ee=this.bar=new e.Rectangle(S-(f+l/2)*1.8,B-(f+l/2)*1.8,r,null,null,[re[0]-he,re[1]-he,re[2]-he,re[3]-he],null,null,null,!1).center(this);var j=this.mask=new e.Rectangle(S-(f+l/2)*1.8,B-(f+l/2)*1.8,null,null,null,null,null,null,null,!1).center(this).alp(0).sca(0,1);ee.setMask(j)}function G(D){var K;if(Z.backing?(K=Z.getChildIndex(Z.backing),Z.removeChild(Z.backing)):K=Z.numChildren,Z.border&&Z.removeChild(Z.border),!n(D)&&D.type=="Pattern"){var m=D;D=Z.backing=new e.Rectangle(S,B,i,null,null,w,null,null,null,!1).addTo(Z,K),D.pattern=m,m.center(D),m.setMask(D.shape),l&&(Z.border=new e.Rectangle(S,B,"rgba(0,0,0,0)",o,l,w,null,null,null,!1).addTo(Z,K+1))}else D=Z.backing=n(D)?new e.Rectangle(S,B,i,o,l,w,null,null,null,!1).addTo(Z,K):P.addTo(Z,K);return D}Z.setBacking=function(D){G(D),Z.stage&&Z.stage.update()},P.on("click",function(D){D.stopImmediatePropagation()}),n(h)||(h.scaleX=h.scaleY=.8,h.startText=h.text,n(b)||(h.text=h.startText+"  0%"),h.center(Z),_=="above"?h.y-=60:h.y+=60,h.alpha=.8),this.hide=function(){var D=Z.stage;if(Z.parent&&Z.parent.removeChild(Z),Z.backing.type=="Pattern"&&Z.backing.pauseInterval&&Z.backing.pauseInterval(),D&&D.update(),Z.zimAccessibility){var K=Z.zimAccessibility;K.resize(Z),y?y.focus():Z.zimTabTag.nextSibling.focus(),setTimeout(function(){K.talk("Progress Bar has finished.")},50)}return Z.toggled=!1,Z};var y;this.show=function(){var D="zim display - ProgressBar(): Please pass in a reference to a container with bounds set as first parameter of the ProgressBar";if(n(T))if(le.zdf)T=le.zdf.stage;else{ht(D);return}else if(T.getBounds){if(n(T.stage)){ht("zim display - Waiter(): The container must have a stage property");return}}else{ht(D);return}if(Z.timeOut&&clearTimeout(Z.timeOut),g(0),Z.zimActiveLoader&&Z.zimActiveLoader.on("progress",function(m){U=m.progress*100,g(U)}),Z.center(T),Z.backing.type=="Pattern"&&Z.backing.pauseInterval&&Z.backing.pauseInterval(!1),Z.zimAccessibility){var K=Z.zimAccessibility;setTimeout(function(){K.activatedObject&&(y=K.activatedObject.zimTabTag)},50),K.resize(Z),K.talk(Z.zimTabTag.getAttribute("aria-label"))}return Z.toggled=!0,Z},Z.toggle=function(D){return D===!0?Z.show():D===!1||Z.parent?Z.hide():Z.show(),Z},Z.run=function(D,K){n(K)||(L=K),n(D)&&(D=te=="s"?3:3e3),a(D,te);var m=D*(te=="s"?1e3:1);Z.runInterval&&clearInterval(Z.runInterval),Z.percent=0;var F=Date.now();return Z.runInterval=setInterval(function(){Z.percent=(Date.now()-F)/m*100,Z.percent>=100&&(Z.percent=100,clearInterval(Z.runInterval))},30),Z},Z.dispatched=!1;function g(D){t=="circle"?ee.graphics.c().mt(0,0).s(r).ss(l-f*2+.5).a(0,0,S,0,360*D/100*Math.PI/180):(j.sca(D/100,1),ee.setMask(j)),n(b)||(h.text=h.startText+" "+Math.min(Math.round(D),100)+"%"),L&&R&&Math.round(D)>=100&&(Z.timeOut=setTimeout(function(){Z.hide()},200)),!Z.dispatched&&Math.round(D)>=100&&(Z.dispatchEvent("complete"),Z.dispatched=!0,setTimeout(function(){Z&&(Z.dispatched=!1)},100)),Z.stage&&Z.stage.update()}Object.defineProperty(Z,"percent",{get:function(){return U},set:function(D){U=D,g(D)}});var d=Z.getBounds();Z.setBounds(d.x-5,d.y-5,d.width+10,d.height+10),E!==!1&&e.styleTransforms(this,I),this.clone=function(){return Z.cloneProps(new e.ProgressBar(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,this.group,X))},this.dispose=function(D,K,m){return Z.backing.type=="Pattern"&&Z.backing.clearInterval&&Z.backing.clearInterval(),Z.runInterval&&clearInterval(Z.runInterval),m||this.zimContainer_dispose(!0),!0}},e.extend(e.ProgressBar,e.Container,["clone","dispose"],"zimContainer",!1),e.Indicator=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k){var X="width, height, num, foregroundColor, backgroundColor, borderColor, borderWidth, backdropColor, corner, indicatorType, fill, scale, lightScale, interactive, shadowColor, shadowBlur, selectedIndex, backgroundAlpha, style, group, inherit",q;if(q=mt(e.Indicator,arguments,X,this))return q;qe("60"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Indicator",this.group=E;var V=S===!1?{}:e.getStyle(this.type,this.group,k);n(t)&&(t=V.width!=null?V.width:300),n(r)&&(r=V.height!=null?V.height:50),n(i)&&(i=V.num!=null?V.num:6),n(b)&&(b=V.indicatorType!=null?V.indicatorType:"dot"),n(o)&&(o=V.foregroundColor!=null?V.foregroundColor:b=="star"?e.yellow:b=="heart"?e.red:e.orange),n(l)&&(l=V.backgroundColor!=null?V.backgroundColor:e.granite),l<0&&(l=V.backgroundColor!=null?V.backgroundColor:"rgba(0,0,0,.01)"),n(f)&&(f=V.borderColor!=null?V.borderColor:null),n(h)&&(h=V.borderWidth!=null?V.borderWidth:null),f<0||h<0?f=h=null:f!=null&&h==null&&(h=1),n(p)&&(p=V.backdropColor!=null?V.backdropColor:-1),n(_)&&(_=V.corner!=null?V.corner:0),n(w)&&(w=V.fill!=null?V.fill:!1),n(C)&&(C=V.scale!=null?V.scale:1),n(O)&&(O=V.lightScale!=null?V.lightScale:1),n(P)&&(P=V.interactive!=null?V.interactive:!1),n(A)&&(A=V.shadowColor!=null?V.shadowColor:"rgba(0,0,0,.3)"),n(R)&&(R=V.shadowBlur!=null?V.shadowBlur:5),n(L)&&(L=V.backgroundAlpha!=null?V.backgroundAlpha:.2);var I=(Dt?e.ACTIONEVENT=="mousedown":le.ACTIONEVENT=="mousedown")?"mousedown":"click",te=this;this.lights=[];var B;if(p!=-1){var Z=te.backdrop=new e.Rectangle(t,r,p,f,h,_,null,null,null,!1);this.addChild(Z)}var U=this.lightsContainer=new e.Container({style:!1});this.addChild(U);var ee,ae=r*.5,re=t/(i+1),he=new $e.Shape,j=!1;b=="square"||b=="box"||b.type=="Emoji"?he.graphics.f("black").dr(-re/2/O+ae/2,-r/2+ae/2,re/O,r):he.graphics.f("black").dr(-re/2/O,-r/2,re/O,r);for(var G=0;G<i;G++)b=="square"||b=="box"?(ee=new e.Rectangle(ae,ae,l,f,h,null,null,null,null,!1),ee.regX=ee.width/2,ee.regY=ee.height/2):b=="star"?ee=new e.Poly(ae*.6,5,.5,l,f,h,null,null,!1):b=="heart"?ee=new e.Blob({points:[[0,-40.7,0,0,-57.3,-76.6,41.8,-80.3,"mirror"],[100,0,0,0,23.7,-45.4,-23.7,45.4,"mirror"],[0,100,0,0,0,0,0,0,"mirror"],[-100,0,0,0,21.9,48.2,-21.9,-48.2,"mirror"]],color:l,interactive:!1}).transformPoints("scale",.15):b.type=="Emoji"?(j=!0,ee=b.clone().reg("center","center"),ee.myCache=!1):ee=new e.Circle(ae/2,l,f,h,null,null,null,null,!1),this.lights.push(ee),ee.znum=G,ee.scaleX=ee.scaleY=O,ee.hitArea=he,ee.x=re+re*G,ee.y=r/2,U.addChild(ee);U.setBounds(0,0,t,r),U.regX=U.x=t/2,U.regY=U.y=r/2,this.addChild(U),A!=-1&&R>0&&(U.shadow=new $e.Shadow(A,2,2,R)),P&&(U.cur("pointer"),te.lightsEvent=U.on(I,function(g){if(B==g.target.znum){if(B>0)return;if(B==0){B=-1,y(B),te.dispatchEvent("change");return}}B=g.target.znum,y(B),te.dispatchEvent("change")})),U.scaleX=U.scaleY=C;function y(g){g>=i&&(g=-1);for(var d,D=0;D<i;D++){w&&D<g?d=o:d=l,D==g&&(d=o);var K=U.getChildAt(D);j&&(K.alpha=d==o?1:L),K.color=d}te.zimAccessibility&&te.zimAccessibility.changeTitle(te),!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&te.stage&&te.stage.update()}Object.defineProperty(this,"selectedIndex",{get:function(){return B},set:function(g){B=Math.floor(g),B=e.constrain(B,-1,i-1),y(B)}}),Object.defineProperty(this,"num",{get:function(){return i},set:function(){Ct&&ht("Indicator() - num is read only")}}),this._enabled=!0,Object.defineProperty(te,"enabled",{get:function(){return te._enabled},set:function(g){c(te,g)}}),n(T)&&(T=V.selectedIndex!=null?V.selectedIndex:0),te.selectedIndex=T,S!==!1&&e.styleTransforms(this,V),this.dispose=function(g,d,D){D||(te.lightsEvent&&U.off(I,te.lightsEvent),this.zimContainer_dispose())},this.clone=function(){return te.cloneProps(new e.Indicator(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,this.group,k))}},e.extend(e.Indicator,e.Container,["clone","dispose"],"zimContainer",!1),e.TextInput=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B,Z,U,ee,ae,re,he,j,G,y,g,d,D,K,m){var F="width, height, placeholder, text, size, font, color, backgroundColor, borderColor, borderWidth, maxLength, password, selectionColor, selectionAlpha, cursorColor, cursorSpeed, shadowColor, shadowBlur, align, corner, padding, paddingH, paddingV, shiftH, shiftV, scrollBarActive, scrollBarDrag, scrollBarColor, scrollBarAlpha, scrollBarFade, scrollBarH, scrollBarV, readOnly, inputType, rtl, uppercase, placeholderInstant, keyboardShift, style, group, inherit",Ce;if(Ce=mt(e.TextInput,arguments,F,this))return Ce;qe("54.2"),this.group=K;var Y=D===!1?{}:e.getStyle("TextInput",this.group,m);n(l)&&(l=Y.size!=null?Y.size:36),(n(k)||k=="ignore")&&(k=Y.padding!=null&&k!="ignore"?Y.padding:5),n(X)&&(X=Y.paddingH!=null?Y.paddingH:k),n(q)&&(q=Y.paddingV!=null?Y.paddingV:k),n(t)&&(t=Y.width!=null?Y.width:300),n(r)&&(r=Y.height!=null?Y.height:l+q*2),n(i)&&(i=Y.placeholder!=null?Y.placeholder:null),n(o)&&(o=Y.text!=null?Y.text:""),n(f)&&(f=Y.font!=null?Y.font:"arial"),n(h)&&(h=Y.color!=null?Y.color:e.dark),n(p)&&(p=Y.backgroundColor!=null?Y.backgroundColor:e.lighter),n(_)&&(_=Y.borderColor!=null?Y.borderColor:null),n(b)&&(b=Y.borderWidth!=null?Y.borderWidth:null);var Q=ce(t,r,i,o,h,p,_);this.veeObj={width:Q[0],height:Q[1],placeholder:Q[2],text:Q[3],color:Q[4],backgroundColor:Q[5],borderColor:Q[6]};function ce(){return arguments}t=e.Pick.choose(t),r=e.Pick.choose(r),i=e.Pick.choose(i),o=e.Pick.choose(o),h=e.Pick.choose(h),p=e.Pick.choose(p),_=e.Pick.choose(_),n(O)&&(O=Y.selectionColor!=null?Y.selectionColor:h),n(P)&&(P=Y.selectionAlpha!=null?Y.selectionAlpha:.2),n(A)&&(A=Y.cursorColor!=null?Y.cursorColor:h),n(R)&&(R=Y.cursorSpeed!=null?Y.cursorSpeed:.5),n(T)&&(T=Y.shadowColor!=null?Y.shadowColor:"rgba(0,0,0,.3)"),n(L)&&(L=Y.shadowBlur!=null?Y.shadowBlur:20),n(S)&&(S=Y.align!=null?Y.align:"left"),n(E)&&(E=Y.corner!=null?Y.corner:0),n(V)&&(V=Y.shiftH!=null?Y.shiftH:0),n(C)&&(C=Y.password!=null?Y.password:!1),n(I)&&(I=Y.shiftV!=null?Y.shiftV:C?l*.25:0),n(w)&&(w=Y.maxLength!=null?Y.maxLength:S=="center"?Math.floor(t/l)*1.8:null),n(te)&&(te=Y.scrollBarActive!=null?Y.scrollBarActive:!1),n(B)&&(B=Y.scrollBarDrag!=null?Y.scrollBarDrag:!1),n(Z)&&(Z=Y.scrollBarColor!=null?Y.scrollBarColor:_),n(U)&&(U=Y.scrollBarAlpha!=null?Y.scrollBarAlpha:.3),n(ee)&&(ee=Y.scrollBarFade!=null?Y.scrollBarFade:!0),n(ae)&&(ae=Y.scrollBarH!=null?Y.scrollBarH:!0),n(re)&&(re=Y.scrollBarV!=null?Y.scrollBarV:!0),n(he)&&(he=Y.readOnly!=null?Y.readOnly:!1),n(j)&&(j=Y.inputType!=null?Y.inputType:"text"),B&&(ee=Y.scrollBarFade!=null?Y.scrollBarFade:!1),n(G)&&(G=Y.rtl!=null?Y.rtl:le.DIR=="rtl"||e.DIR=="rtl"?"rtl":null),n(y)&&(y=Y.uppercase!=null?Y.uppercase:null),n(d)&&(d=Y.keyboardShift!=null?Y.keyboardShift:null),y&&(o&&(o=o.toUpperCase()),i&&(i=i.toUpperCase())),n(g)&&(g=Y.placeholderInstant!=null?Y.placeholderInstant:!0);function pe(){return le.DIR&&le.DIR=="rtl"||!le.DIR&&e.DIR=="rtl"?S=="start"?S="right":S=="end"&&(S="left"):S=="start"?S="left":S=="end"&&(S="right"),S}S=pe(S),this.zimWindow_constructor(t,r,null,p,_,b,k,E,!1,te,B,Z,U,ee,ae,re,!1,null,null,!1,!0,T,L,X,q,!0,null,null,null,null,null,!1,null,null,null,null,null,null,null,null,null,null,null,null,D,K,e.copy(Y)),this.type="TextInput";var J=this;this.placeholderLabel=new e.Label({text:i||"",size:l,color:h,font:f,shiftH:V,shiftV:I,valign:"top"}).alp(.5),o==""&&this.add(this.placeholderLabel);var ue=new e.Rectangle({width:t-k*2,height:r-k*2,color:e.clear,style:!1}).center(this);this.cur("text");var ye=this.label=new e.TextInput.LabelInput(o,l,w,C,O,P,A,R,f,h,null,null,null,S,"top",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,V,I,null,null,null,null,j,G,y,g,D,K,m);this.add(ye),ye.setMask(ue),this.htmlTag=this.label.hiddenInput,this.selection=this.label.selection,this.blinker=this.label.blinker,S=="right"?(ye.x=t-X,this.placeholderLabel.x=t-this.placeholderLabel.width-X):S=="center"&&(ye.x=t/2,this.placeholderLabel.x=(t-this.placeholderLabel.width)/2),ye.ogx=ye.x,J.placeholderLabel.x=ye.x,J.placeholderLabel.align=S;var Xe=new e.Rectangle({width:k,height:r,color:e.clear,style:!1}).addTo(this).expand(0);Xe.on("mousedown",function(xe){ye.onMousedown(xe),xe.stopImmediatePropagation()}),Xe.on("pressmove",function(xe){ye.onPressmove(xe),xe.stopImmediatePropagation()}),Xe.on("dblclick",function(xe){ye.onDblclick(xe),xe.stopImmediatePropagation()});var se=new e.Rectangle({width:k,height:r,color:e.clear,style:!1}).pos(0,0,e.RIGHT,e.TOP,this).expand(0);se.on("mousedown",function(xe){ye.onMousedown(xe),xe.stopImmediatePropagation()}),se.on("pressmove",function(xe){ye.onPressmove(xe),xe.stopImmediatePropagation()}),se.on("dblclick",function(xe){ye.onDblclick(xe),xe.stopImmediatePropagation()});var Ae=ye.text;this.on("mousedown",function(xe){ye.onMousedown(xe),Ae=ye.text}),this.on("pressmove",function(xe){ye.onPressmove(xe),xe.stopImmediatePropagation()}),this.on("dblclick",function(xe){ye.onDblclick(xe),xe.stopImmediatePropagation()}),this.added(function(xe){xe.on("stagemousedown",function(Be){J.hitTestPoint(Be.stageX,Be.stageY)||(ye.focus=!1,ye.text!=Ae&&J.dispatchEvent("change"),Ae=ye.text)})});var ie=J.stage?stage.y:0;this.label.on("focus",function(){if(le.M&&d){J.re&&J.stage.frame.off("resize",J.re),J.re=J.stage.frame.on("resize",function(){J.stage&&xe>J.stage.height/4&&(J.stage.y=J.stage.scaleY*(J.stage.height/4-xe),J.stage.update())});var xe=J.label.localToGlobal(0,0).y;J.stage&&xe>J.stage.height/4&&(J.stage.y=J.stage.scaleY*(J.stage.height/4-xe),J.stage.update())}g&&J.placeholderLabel.parent&&(J.placeholderLabel.removeFrom(),J.stage&&J.stage.update()),J.dispatchEvent("focus")}),this.label.on("blur",function(){le.M&&d&&J.stage&&(J.re&&J.stage.frame.off("resize",J.re),J.stage.y=ie,J.stage.update()),g&&ye.text==""&&!J.placeholderLabel.parent&&(J.add(J.placeholderLabel),J.stage&&J.stage.update()),J.dispatchEvent("blur")});function _e(){ye.text!=""&&J.placeholderLabel.parent&&(J.placeholderLabel.removeFrom(),J.stage&&J.stage.update()),ye.text==""&&!J.placeholderLabel.parent&&(J.add(J.placeholderLabel),J.stage&&J.stage.update())}this.label.on("input",function(){_e(),J.dispatchEvent("input")}),this.label.on("keydown",function(xe){this.label.deleteKey=xe.detail==46,J.dispatchEvent("keydown")}),this.label.on("blinker",function(){var xe=J.localToGlobal(0,0).x,Be=xe+t-X-ye.blinker.width,me=ye.blinker,Oe=me.localToGlobal(0,0).x,Ye=ye.localToGlobal(0,0).x-1,de=ye.x+ye.blinker.x,ve=e.constrain(de,X,t-X-ye.blinker.width);if(de!=ve&&(ye.x-=de-ve),S=="left")ye.width<J.width?ye.x=ye.ogx:Be<Oe||ye.oldWidth==ye.width?ye.x-=de-ve:ye.oldWidth>ye.width&&this.label.deleteKey!=!0&&(ye.x+=Math.abs(me.oldX-Oe)+ye.blinker.width+X);else if(S=="right")ye.width<J.width?ye.x=ye.ogx:Be<Oe||ye.oldWidth==ye.width?ye.x-=de-ve:ye.oldWidth>ye.width&&this.label.deleteKey==!0&&Oe<Ye-J.width&&(ye.x-=Math.abs(me.oldX-Oe)+ye.blinker.width+X);else if(S=="center"){if(ye.width<J.width)ye.x=ye.ogx;else if(Be<Oe)ye.x-=de-ve;else if(ye.oldWidth==ye.width)ye.x-=de-ve;else if(ye.oldWidth>ye.width&&Be>Oe){var Me=xe+J.width*.5;this.label.deleteKey!=!0?ye.x+=ye.blinker.width+X:ye.x-=ye.blinker.width+X}}ye.oldWidth=ye.width,me.oldX=Oe,J.stage&&J.stage.update()}),Object.defineProperty(J,"text",{get:function(){return ye.hiddenInput.value},set:function(xe){Ae=xe,ye.setText(xe),_e(),!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&J.stage&&J.stage.update()}}),le.KEYFOCUS!=null&&(e.KEYFOCUS=le.KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return e.KEYFOCUS==J},set:function(){e.KEYFOCUS=J}}),e.KEYFOCUS||$(),this.on("mousedown",function(){$()});function $(){J.keyFocus=!0}Object.defineProperty(J,"readOnly",{get:function(){return he},set:function(xe){he=xe,J.htmlTag.setAttribute("readonly",he)}}),he&&(J.readOnly=!0),Object.defineProperty(J,"focus",{get:function(){return ye.focus},set:function(xe){ye.focus=xe}}),Object.defineProperty(J,"color",{get:function(){return ye.color},set:function(xe){ye.color=latestColor=xe,!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&J.stage&&J.stage.update()}}),Object.defineProperty(J,"size",{get:function(){return ye.size},set:function(xe){ye.size=xe,ye.hiddenInput.style.fontSize=xe+"px",!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&J.stage&&J.stage.update()}}),Object.defineProperty(J,"align",{get:function(){return ye.align},set:function(xe){ye.align=S=pe(xe),S=="right"?ye.x=t-ye.width:S=="center"?ye.x=t/2:ye.x=0,J.placeholderLabel.x=ye.x,J.placeholderLabel.align=S,!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&J.stage&&J.stage.update()}}),Object.defineProperty(J,"font",{get:function(){return ye.font},set:function(xe){ye.font=xe,!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&J.stage&&J.stage.update()}}),Object.defineProperty(J,"selectionAlpha",{get:function(){return ye.selectionAlpha},set:function(xe){ye.selectionAlpha=xe,ye.selection.alpha!=0&&(ye.selection.alpha=xe),!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&J.stage&&J.stage.update()}}),D!==!1&&e.styleTransforms(this,Y),this.clone=function(xe){return J.cloneProps(new e.TextInput(xe||!e.isPick(Q[0])?t:Q[0],xe||!e.isPick(Q[1])?r:Q[1],xe||!e.isPick(Q[2])?i:Q[2],xe||!e.isPick(Q[3])?o:Q[3],l,f,xe||!e.isPick(Q[4])?h:Q[4],xe||!e.isPick(Q[5])?p:Q[5],xe||!e.isPick(Q[6])?_:Q[6],b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B,Z,U,ee,ae,re,he,j,G,y,g,d,D,this.group,m))}},e.extend(e.TextInput,e.Window,"clone","zimWindow",!1),e.TextInput.LabelInput=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B,Z,U,ee,ae,re,he,j,G,y,g,d,D,K,m,F,Ce){this.zimLabel_constructor(t,r,_,b,null,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B,Z,U,ee,ae,re,he,null,G,y,null,g,m,F,Ce),this.type="LabelInput",n(b)&&(b=e.dark),n(l)&&(l=b),n(f)&&(f=.2),this.selectionAlpha=f,n(h)&&(h=b),n(p)&&(p=.5),this.hiddenInput=document.createElement("INPUT"),this.hiddenInput.setAttribute("id",e.makeID()),this.hiddenInput.value=t,d=="text"&&o&&(d="password"),this.hiddenInput.type=d,d=="number"&&(this.hiddenInput.pattern="[^(0-9).-+*/%$]*",this.hiddenInput.inputmode="numeric"),i>0&&(this.hiddenInput.maxLength=i),this.hiddenInput.autocapitalize="off",this.hiddenInput.autocorrect="off",this.hiddenInput.autocomplete="off",this.hiddenInput.spellcheck=!1,this.hiddenInput.style.position="absolute",this.hiddenInput.style.overflow="hidden",this.hiddenInput.style.touchAction="none",this.hiddenInput.style.left="-99999px",this.hiddenInput.style.top="-99999px",this.hiddenInput.style.zIndex=-999,this.hiddenInput.style.opacity=0,this.hiddenInput.style.width="1px",this.hiddenInput.style.height="1px",this.hiddenInput.style.fontSize="1px",this.onFocus=function(){this.stage&&(Q=this.stage.frame),Q.zil&&le.removeEventListener("keydown",Q.zil[0]),this.blinker.alp(1).replayTween(),this.selection.alp(.2),this.positionBlinkerAndSelection(),this.dispatchEvent("focus")},this.onBlur=function(){this.stage&&(Q=this.stage.frame),Q.zil&&le.addEventListener("keydown",Q.zil[0]),this.positionBlinkerAndSelection(),this.blinker.pauseAnimate(!0).alp(0),this.selection.alp(0),this.hiddenInput.type=d,this.dispatchEvent("blur")},this.onInput=function(){K&&(this.hiddenInput.value=this.hiddenInput.value.toUpperCase());var ce=this.hiddenInput.value;d=="number"&&(ce=ce.replace(/[^(0-9).\-+*/%$]*/g,""),this.hiddenInput.value=ce),this.text=this.hiddenInput.type=="password"?ce.replace(/./g,"*"):ce,this.measureText(),this.dispatchEvent("input")},this.onSelect=function(){this.positionBlinkerAndSelection(),this.focus&&this.blinker.replayTween()};var Y=this;this.onKeydown=function(ce){this.deleteKey=ce.code=="Backspace"||ce.code=="Delete",this.blinker.replayTween(),setTimeout(function(){let pe=new CustomEvent("keydown",{detail:ce.keyCode});Y.positionBlinkerAndSelection.call(Y),Y.dispatchEvent(pe)},10)},this.onMousedown=function(ce){var pe=this.text.length,J=this.eventPositionGlobalToLocal(ce);this.focus||(this.hiddenInput.focus(),(d=="number"||d=="email")&&(this.hiddenInput.type="text"));var ue=this.mapPointToIndex(J);D?this.hiddenInput.setSelectionRange(pe-ue,pe-ue):this.hiddenInput.setSelectionRange(ue,ue),this.positionBlinkerAndSelection()},this.onPressmove=function(ce){var pe=this.text.length;this.focus||this.hiddenInput.focus();var J=this.eventPositionGlobalToLocal(ce),ue;D?ue=pe-this.mapPointToIndex(J):ue=this.mapPointToIndex(J),this.hiddenInput.selectionStart===this.hiddenInput.selectionEnd?this.hiddenInput.selectionStart<=ue?this.hiddenInput.setSelectionRange(this.hiddenInput.selectionStart,ue,D?"backward":"forward"):this.hiddenInput.setSelectionRange(ue,this.hiddenInput.selectionEnd,D?"forward":"backward"):this.hiddenInput.selectionDirection===(D?"backward":"forward")?this.hiddenInput.setSelectionRange(this.hiddenInput.selectionStart,ue,D?"backward":"forward"):this.hiddenInput.setSelectionRange(ue,this.hiddenInput.selectionEnd,D?"forward":"backward"),this.positionBlinkerAndSelection()},this.onDblclick=function(){this.hiddenInput.select(),this.positionBlinkerAndSelection()},this.positionBlinkerAndSelection=function(){var ce=this.text.length;if(this.focus){var pe=this.backing||this.background?this.paddingH:0,J=this.backing||this.background?this.paddingV:0;if(this.hiddenInput.selectionStart!==this.hiddenInput.selectionEnd){var ue,ye;D?(ue=this.textWidthArray[ce-this.hiddenInput.selectionStart],ye=this.textWidthArray[ce-this.hiddenInput.selectionEnd],this.selection.widthOnly=ye-ue,this.selection.pos(ye+pe-1+re,J+he)):(ue=this.textWidthArray[this.hiddenInput.selectionStart],ye=this.textWidthArray[this.hiddenInput.selectionEnd],this.selection.widthOnly=ye-ue,this.selection.pos(ue+pe-1+re,J+he)),this.selection.heightOnly=this.textHeight,this.selection.alp(this.selectionAlpha)}else this.selection.alp(0);this.blinker.heightOnly=this.textHeight;var Xe=this.hiddenInput.selectionDirection==="backward"?this.hiddenInput.selectionStart:this.hiddenInput.selectionEnd;Xe||(Xe=0),D&&(Xe=ce-Xe),this.blinker.pos(this.textWidthArray[Xe]+pe-1+(P=="right"&&this.text==""?this.width:P=="center"&&this.text==""?this.width/2:0)+re,J+he),this.dispatchEvent("blinker")}this.stage&&this.stage.update()},this.eventPositionGlobalToLocal=function(ce){var pe=this.globalToLocal(ce.stageX/e.scaX,ce.stageY/e.scaY);return P=="right"?pe.x-=this.label.x-this.width:P=="center"?pe.x-=(this.label.x-this.width)/2:pe.x-=this.label.x,pe.y-=this.label.y,pe},this.mapPointToIndex=function(ce){for(var pe=this.textWidthArray.length-1,J=0;J<this.textWidthArray.length-1;J++){var ue=(this.textWidthArray[J]+this.textWidthArray[J+1])/2;if(ce.x<=ue){pe=J;break}}return pe},this.measureText=function(){var ce=this.label.clone(),pe=this.text;D&&(pe=pe.split("").reverse().join(""));for(var J=0;J<pe.length&&J<this.previousMeasuredText.length&&pe[J]===this.previousMeasuredText[J];)J++;for(this.textWidthArray=this.textWidthArray.slice(0,J+1),J++;J<=pe.length;J++)ce.text=pe.slice(0,J),this.textWidthArray.push(ce.getMeasuredWidth());this.previousMeasuredText=pe,this.textHeight=ce.getMeasuredLineHeight()},this.setText=function(ce){K&&(ce=ce.toUpperCase()),this.hiddenInput.value=ce,this.onInput()},Object.defineProperty(this,"focus",{get:function(){return document.activeElement===Y.hiddenInput},set:function(ce){ce===!0?Y.hiddenInput.focus():Y.hiddenInput.blur()}});var Q;this.added(function(ce){Q=ce.frame,Y.hiddenInput.addEventListener("focus",Y.onFocus.bind(Y)),Y.hiddenInput.addEventListener("blur",Y.onBlur.bind(Y))}),this.hiddenInput.addEventListener("input",this.onInput.bind(this)),this.hiddenInput.addEventListener("select",this.onSelect.bind(this)),this.hiddenInput.addEventListener("keydown",this.onKeydown.bind(this)),document.body.appendChild(this.hiddenInput),this.on("mousedown",this.onMousedown.bind(this)),this.on("pressmove",this.onPressmove.bind(this)),this.on("dblclick",this.onDblclick.bind(this)),this.cur("text"),this.blinker=new e.Rectangle({width:2,height:1,color:h,style:!1}).animate({obj:{alpha:0},wait:p,time:.1,rewind:!0,rewindWait:p,loop:!0,loopWait:p}).pauseAnimate(!0).alp(0).addTo(this),this.selection=new e.Rectangle({width:1,height:1,color:l,style:!1}).alp(0).addTo(this),this.textWidthArray=[0],this.previousMeasuredText="",this.textHeight=null,this.measureText()},e.extend(e.TextInput.LabelInput,e.Label,null,"zimLabel",!1),e.List=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B,Z,U,ee,ae,re,he,j,G,y,g,d,D,K,m,F,Ce,Y,Q,ce,pe,J,ue,ye,Xe,se,Ae,ie,_e,$,xe,Be,me,Oe,Ye,de,ve,Me,we,Fe,ge,Ve,He,Le,fe,Ge,Qe,Ke,st,yt,We,at,ct){var Pe="width, height, list, viewNum, vertical, currentSelected, align, valign, labelAlign, labelValign, labelIndent, labelIndentH, labelIndentV, indent, spacing, backgroundColor, rollBackgroundColor, downBackgroundColor, selectedBackgroundColor, selectedRollBackgroundColor, backdropColor, color, rollColor, downColor, selectedColor, selectedRollColor, borderColor, borderWidth, padding, corner, swipe, scrollBarActive, scrollBarDrag, scrollBarColor, scrollBarAlpha, scrollBarFade, scrollBarH, scrollBarV, scrollBarOverlay, slide, slideFactor, slideSnap, slideSnapDamp, shadowColor, shadowBlur, paddingH, paddingV, scrollWheel, damp, titleBar, titleBarColor, titleBarBackgroundColor, titleBarHeight, draggable, boundary, onTop, close, closeColor, collapse, collapseColor, collapsed, excludeCustomTap, organizer, checkBox, pulldown, clone, cancelCurrentDrag, selectedIndex, noScale, pulldownToggle, optimize, keyEnabled, resizeHandle, resizeBoundary, resizeVisible, continuous, style, group, inherit",Ie;if(Ie=mt(e.List,arguments,Pe,this))return Ie;qe("60.5"),this.group=at;var be=We===!1?{}:e.getStyle("List",this.group,ct);n(t)&&(t=be.width!=null?be.width:300);var ze=r;n(r)&&(r=be.height!=null?be.height:n(ve)?200:200+ve.height),n(i)&&(i=i=be.list!=null?be.list:["Option 1","Option 2","Option 3","Option 4","Option 5","Option 6","Option 7","Option 8","Option 9","Option 10"]),i.length==0&&(i=["%-&"]),this.originalList=i,n(o)&&(o=be.viewNum!=null?be.viewNum:5),n(l)&&(l=be.vertical!=null?be.vertical:!0),n(f)&&(f=be.currentSelected!=null?be.currentSelected:!0);var it=!n(h)||!n(_);n(Me)&&(Me=be.checkBox!=null?be.checkBox:!1),n(h)&&(h=be.align!=null?be.align:Me?"left":"center"),n(p)&&(p=be.valign!=null?be.valign:"center"),n(_)&&(_=be.labelAlign!=null?be.labelAlign:h),n(b)&&(b=be.labelValign!=null?be.labelValign:p),n(P)&&(P=be.indent!=null?be.indent:Me?0:10),n(w)&&(w=be.labelIndent!=null?be.labelIndent:P),n(C)&&(C=be.labelIndentH!=null?be.labelIndentH:w),n(O)&&(O=be.labelIndentV!=null?be.labelIndentV:w),n(A)&&(A=be.spacing!=null?be.spacing:2),n(k)&&(k=be.backdropColor!=null?be.backdropColor:e.dark),n(R)&&(R=be.backgroundColor!=null?be.backgroundColor:e.tin),n(T)&&(T=be.rollBackgroundColor!=null?be.rollBackgroundColor:e.grey),n(L)&&(L=be.downBackgroundColor!=null?be.downBackgroundColor:T),n(S)&&(S=be.selectedBackgroundColor!=null?be.selectedBackgroundColor:e.charcoal),n(E)&&(E=be.selectedRollBackgroundColor!=null?be.selectedRollBackgroundColor:e.grey),n(X)&&(X=be.color!=null?be.color:e.white),n(q)&&(q=be.rollColor!=null?be.rollColor:X),n(V)&&(V=be.downColor!=null?be.downColor:q),n(I)&&(I=be.selectedColor!=null?be.selectedColor:X),n(te)&&(te=be.selectedRollColor!=null?be.selectedRollColor:q),n(k)&&(k=be.backdropColor!=null?be.backdropColor:k);var je=B,tt=Z;n(B)&&(B=be.borderColor!=null?be.borderColor:e.silver),n(Z)&&(Z=be.borderWidth!=null?be.borderWidth:1),n(U)&&(U=be.padding!=null?be.padding:A),n(ee)&&(ee=be.corner!=null?be.corner:0),n(ae)&&(ae=be.swipe!=null?be.swipe:!0),n(re)&&(re=be.scrollBarActive!=null?be.scrollBarActive:!0),n(he)&&(he=be.scrollBarDrag!=null?be.scrollBarDrag:!0),n(j)&&(j=be.scrollBarColor!=null?be.scrollBarColor:B),n(G)&&(G=be.scrollBarAlpha!=null?be.scrollBarAlpha:.3),n(y)&&(y=be.scrollBarFade!=null?be.scrollBarFade:!0),n(g)&&(g=be.scrollBarH!=null?be.scrollBarH:!l),n(d)&&(d=be.scrollBarV!=null?be.scrollBarV:l),he&&(y=be.scrollBarFade!=null?be.scrollBarFade:!1),n(D)&&(D=be.scrollBarOverlay!=null?be.scrollBarOverlay:!0),n(K)&&(K=be.slide!=null?be.slide:!0),n(m)&&(m=be.slideFactor!=null?be.slideFactor:.95),n(F)&&(F=be.slideSnap!=null?be.slideSnap:l?"vertical":"horizontal"),n(Y)&&(Y=be.shadowColor!=null?be.shadowColor:"rgba(0,0,0,.3)"),n(Q)&&(Q=be.shadowBlur!=null?be.shadowBlur:20),n(pe)&&(pe=be.paddingV!=null?be.paddingV:U),n(ce)&&(ce=be.paddingH!=null?be.paddingH:U),n(J)&&(J=be.scrollWheel!=null?be.scrollWheel:!0),n(ye)&&(ye=be.titleBar!=null?be.titleBar:null),n(Xe)&&(Xe=be.titleBarColor!=null?be.titleBarColor:null),n(se)&&(se=be.titleBarBackgroundColor!=null?be.titleBarBackgroundColor:null),n(Ae)&&(Ae=be.titleBarHeight!=null?be.titleBarHeight:35),n(ie)&&(ie=be.draggable!=null?be.draggable:null),n(_e)&&(_e=be.boundary!=null?be.boundary:null),n($)&&($=be.onTop!=null?be.onTop:null),n(xe)&&(xe=be.close!=null?be.close:null),n(Be)&&(Be=be.closeColor!=null?be.closeColor:null),n(me)&&(me=be.collapse!=null?be.collapse:null),n(Oe)&&(Oe=be.collapseColor!=null?be.collapseColor:null),n(de)&&(de=be.excludeCustomTap!=null?be.excludeCustomTap:!1),n(Me)&&(Me=be.checkBox!=null?be.checkBox:!1),n(we)&&(we=be.pulldown!=null?be.pulldown:!1),n(Le)&&(Le=be.pulldownToggle!=null?be.pulldownToggle:!1),n(He)&&(He=be.noScale!=null?be.noScale:!1),n(Fe)&&(Fe=be.clone!=null?be.clone:!1),n(fe)&&(fe=be.optimize!=null?be.optimize:!0),n(Ge)&&(Ge=be.keyEnabled!=null?be.keyEnabled:null),n(Qe)&&(Qe=be.resizeHandle!=null?be.resizeHandle:null),n(Ke)&&(Ke=be.resizeBoundary!=null?be.resizeBoundary:null),n(st)&&(st=be.resizeVisible!=null?be.resizeVisible:!1),n(yt)&&(yt=be.continuous!=null?be.continuous:!1),ye===!1&&(ye=null),this.vertical=l;var Te=this,et=r;le.DIR&&le.DIR=="rtl"||!le.DIR&&e.DIR=="rtl"?h=="start"?h="right":h=="end"&&(h="left"):h=="start"?h="left":h=="end"&&(h="right");var Ue;yt?(Te.continuous=!0,Ue=e.copy(i),e.loop(i.length,function(ot){i[ot].clone?Ue.push(i[ot].clone()):Ue.push(i[ot])})):Ue=i,Me&&e.loop(Ue,function(ot,bt){Ue[bt]!="%-&"&&(Ue[bt]=e.List.checkItem(ot,null,t,"left",10,10,A,X,q,I,te,R,T,S,E))});var Re=v(),Ze;if(Ue.constructor=={}.constructor){var Je=n(Ue.shade)?n(be.shade)?.2:be.shade:Ue.shade,nt=n(Ue.dim)?n(be.dim)?.1:be.dim:Ue.dim,pt=n(Ue.shift)?n(be.shift)?15:be.shift:Ue.shift,De=n(Ue.bloom)?n(be.bloom)?!1:be.bloom:Ue.bloom,lt=n(Ue.whither)?n(be.whither)?!1:be.whither:Ue.whither,vt=n(Ue.open)?n(be.open)?!1:be.open:Ue.open,rt=n(Ue.expander)?n(be.expander)?"plus":be.expander:Ue.expander;rt=rt.toLowerCase(),rt=="arrows"&&(rt="arrow"),rt!="none"&&rt!="arrow"&&(rt="plus"),De===!0&&(De=Re=="s"?.01:10),lt===!0&&(lt=Re=="s"?.01:10),a(De),a(lt),pt===!0&&(pt=15),Je===!0&&(Je=.2),nt===!0&&(nt=.1);var xt=n(Ue.subStyles)?n(be.subStyles)?{}:be.subStyles:Ue.subStyles;n(Ue.menu)||(Ue=Ue.menu),Ze=Te.tree=new e.Hierarchy(Ue),Ue=Ze.getLinearList(),it||(h=_="left")}we&&(o=n(Ze)?Ue.length:Ze.length,n(ze)&&(r=o*t/620*100+(o+1)*A+(n(ye)?0:Ae)),Z=0,S=R,k=e.clear,ae=!1);var wt=0,_t=0;e.loop(Ue,function(ot){ot.type=="ListItem"&&(ot.width=t-A*2),He&&(ot.width&&(wt+=ot.width),ot.height&&(_t+=ot.height))}),wt&&(wt+=A*(Ue.length-1)),_t&&(_t+=A*(Ue.length-1)),this.align=h,this.valign=p,this.indent=P,n(ve)||(r=r-ve.height,ve.list=Te,Te.organizer=ve,ve.setButtons(),Ae+=ve.height),yt&&(re=!1),this.zimWindow_constructor(t,r,null,k,B,Z,U,ee,ae,re,he,j,G,y,g,d,K,m,F,Ce,!0,Y,Q,ce,pe,J,ue,ye,Xe,se,Ae,ie,_e,$,xe,Be,ge,!1,null,Qe,me,Oe,Ye,fe,Ke,st,yt?l?"vertical":"horizontal":null,We,at,e.copy(be)),this.type="List",n(ye)||(this.titleBarLabel.pos(null,Ae-30,null,!0),n(Ae)&&(Ae=30),r=r-Ae),n(ve)||ve.addTo(Te).loc(0,-ve.height),wt&&He?(Te.itemWidth=l?t-(re?D?0:6:0):wt/Ue.length,Te.itemHeight=l?_t/Ue.length:r-(re?D?0:6:0)):(Te.itemWidth=l?t-(re?D?0:6:0):t/o,Te.itemHeight=l?r/o:r-(re?D?0:6:0));var ft,Ot=e.copy(be);delete Ot.borderWidth,delete Ot.borderColor;function Rt(ot){ft=Te.tabs=new e.Tabs({width:l?Te.itemWidth:Te.itemWidth*Ue.length,height:l?Te.itemHeight*Ue.length:Te.itemHeight,tabs:ot,spacing:A,vertical:l,backgroundColor:R,rollBackgroundColor:T,downBackgroundColor:L,selectedBackgroundColor:S,selectedRollBackgroundColor:E,color:X,rollColor:q,downColor:V,selectedColor:I,selectedRollColor:te,backdropColor:k,currentEnabled:!0,currentSelected:f,align:h,valign:p,labelAlign:_,labelValign:b,labelIndent:w,labelIndentH:C,labelIndentV:O,indent:P,useTap:!0,excludeCustomTap:de,keyWrap:!1,keyEnabled:Ge,style:We,group:at,inherit:Ot}).siz(l?t-ce*2:null,l?null:r-pe*2).mov(l?0:ce,l?pe:0),Te.add(ft),e.loop(ft.labels,function(bt){bt&&(bt.backgroundColor=e.clear)})}Rt(e.copy(Ue,Fe)),yt&&Te.on("scrolling",function(){var ot=Te.tabs.localToLocal(0,0,Te);l&&(ot.y>=-Te.tabs.buttons[0].height&&(Te.tabs.y-=Te.tabs.height/2+A/2),ot.y-Te.tabs.buttons[Te.tabs.buttons.length-1].height<=r-Te.tabs.height&&(Te.tabs.y+=Te.tabs.height/2+A/2))});function St(ot,bt,Bt){ot.listZID=bt,ot.label&&(Je&&new e.Rectangle(pt*(Bt.level+1),ot.height).alp(Je).pos(0,0,Te.align=="right",!1,ot),nt&&new e.Rectangle(ot.width,ot.height).alp((Bt.level+1)*nt).addTo(ot).bot().ord(1),pt&&Te.align!="center"&&(ot.label.x+=(Te.align=="right"?-1:1)*pt*(Bt.level+1)));var It=Ze.getData(bt);It.obj=ot,It.list&&!e.isEmpty(It.list)&&(ot.expander=new e.Label({size:rt=="arrow"?22:36,text:It.open?rt=="arrow"?"\u25B2":"-":rt=="arrow"?"\u25BC":"+",align:"center",color:e.convertColor(X,"rgba",.6)}).center(ot).alp(rt=="none"?0:.7).pos(15,null,Te.align!="right").mov(0,It.open?-3:0))}function Gt(){if(!(!Te.selected||!Te.selected.expander)){var ot=Ze.getData(Te.selected.listZID),bt;if(ot.open){Te.selected.expander&&(Te.selected.expander.text=rt=="arrow"?"\u25BC":"+",Te.selected.expander.mov(0,3)),ot.open=!1;var Bt=Ze.getNextSibling(Te.selected.listZID),It;n(Bt)?It=Te.items.length-1:It=e.loop(Te.items,function(jt,rn){if(jt.listZID==Bt)return rn-1}),lt?(bt=0,Te.enabled=!1,e.interval(lt,function(jt){Te.removeAt(1,Te.selectedIndex+It-Te.selectedIndex-bt),bt++,jt.total==jt.count+1&&(Te.enabled=!0,Te.dispatchEvent("collapsed"))},It-Te.selectedIndex,!0)):(Te.removeAt(It-Te.selectedIndex,Te.selectedIndex+1),Te.dispatchEvent("collapsed"))}else{ot.open=!0,Te.selected.expander&&(Te.selected.expander.text=rt=="arrow"?"\u25B2":"-",Te.selected.expander.mov(0,-3));var Ut=Ze.getLinearList(ot.list),kt=Ze.getLinearIDs(ot.list),Nt;if(ot.opened)Array.isArray(Ut)&&(De?(bt=0,Te.enabled=!1,e.interval(De,function(jt){Te.addAt(Ut[bt],Te.selectedIndex+1+bt),Nt=new $e.Event("bloom"),Nt.item=Ut[bt],Te.dispatchEvent(Nt),jt.total==jt.count+1&&(Te.enabled=!0,Nt=new $e.Event("expanded"),Nt.items=Ut,Te.dispatchEvent(Nt)),bt++},Ut.length,!0)):(Te.addAt(Ut,Te.selectedIndex+1),Nt=new $e.Event("expanded"),Nt.items=Ut,Te.dispatchEvent(Nt)));else{ot.opened=!0;var Wt=xt[ot.level];n(Wt)&&(Wt={}),Array.isArray(Ut)&&(De?(bt=0,Te.enabled=!1,e.interval(De,function(jt){Te.addAt(Ut[bt],Te.selectedIndex+1+bt,{backgroundColor:Wt.backgroundColor,color:Wt.color,rollBackgroundColor:Wt.rollBackgroundColor,rollColor:Wt.rollColor,selectedBackgroundColor:Wt.selectedBackgroundColor,selectedColor:Wt.selectedColor,selectedRollBackgroundColor:Wt.selectedRollBackgroundColor,selectedRollColor:Wt.selectedRollColor});var rn=kt[bt],Kt=Te.items[Te.selectedIndex+1+bt];Wt.borderColor&&(Kt.borderColor=Wt.borderColor),St(Kt,rn,ot),Kt.label&&(Kt.label.backgroundColor=e.clear),Nt=new $e.Event("bloom"),Nt.item=Kt,Te.dispatchEvent(Nt),jt.total==jt.count+1&&(Te.enabled=!0,Nt=new $e.Event("expanded"),Nt.items=Ut,Te.dispatchEvent(Nt)),bt++,Te.stage&&Te.stage.update()},Ut.length,!0)):(Te.addAt(Ut,Te.selectedIndex+1,{backgroundColor:Wt.backgroundColor,color:Wt.color,rollBackgroundColor:Wt.rollBackgroundColor,rollColor:Wt.rollColor,selectedBackgroundColor:Wt.selectedBackgroundColor,selectedColor:Wt.selectedColor,selectedRollBackgroundColor:Wt.selectedRollBackgroundColor,selectedRollColor:Wt.selectedRollColor}),e.loop(kt,function(jt,rn){var Kt=Te.items[Te.selectedIndex+1+rn];St(Kt,jt,ot),Kt.label&&(Kt.label.backgroundColor=e.clear)}),Nt=new $e.Event("expanded"),Nt.items=Ut,Te.dispatchEvent(Nt)))}}}}Te.expandList=function(ot){return Te.selectedIndex=ot,Te.selected&&Gt(),Te.selected};var Yt;if(Ze){Le&&Te.added(function(ot){Yt=ot,Te.stageToggleEvent=Yt.on("stagemousedown",function(){var bt=Yt.getObjectUnderPoint(Yt.frame.mouseX,Yt.frame.mouseY);if(!(bt&&Te.contains(bt))&&!(!Te.enabled||!Te.selected)){var Bt=Ze.getData(Te.selected.listZID);Bt.open&&Gt()}})});var $t=Ze.getLinearIDs();e.loop($t,function(ot,bt){Te.tabs.buttons[bt].listZID=ot}),e.loop(Te.tabs.buttons,function(ot){var bt=Ze.getData(ot.listZID);e.isEmpty(bt.list)||(ot.expander=new e.Label({size:rt=="arrow"?22:36,text:rt=="arrow"?"\u25BC":"+",align:"center",color:e.convertColor(X,"rgba",.6)}).center(ot).alp(rt=="none"?0:.7).pos(15,null,Te.align!="right"))});var sn=vt;Te.toggle=function(ot){if(n(ot))ot=!sn;else if(ot==sn)return;Te.selectedIndex=0,sn=ot,Gt()},Object.defineProperty(Te,"toggled",{get:function(){return sn},set:function(ot){sn!=ot&&Te.toggle()}}),Te.tap(Gt)}var en;ft.tap(function(ot){ot.target.selectedIndex!=Te.selectedIndex&&(Te.selectedIndex=ft.selectedIndex,Te.dispatchEvent("change"),Le&&(Te.selectedIndex=0),ot.preventDefault())}),ft.on("keychange",function(ot){if(ot.target.selectedIndex!=Te.selectedIndex){Te.selectedIndex=ft.selectedIndex;var bt;setTimeout(function(){l?(bt=Te.selected.y+Te.scrollY,(bt<0||bt>Te.height-Te.selected.height)&&Te.animateTo(Te.selectedIndex,Re=="ms"?100:.1)):(bt=Te.selected.x+Te.scrollX,(bt<0||bt>Te.width-Te.selected.width)&&Te.animateTo(Te.selectedIndex,Re=="ms"?100:.1))},100),Te.dispatchEvent("change")}}),this.getItemIndex=function(ot){return Te.items.indexOf(ot)},this.animateTo=function(ot,bt){n(ot)&&(ot=0),n(bt)&&(bt=.05);var Bt=v(bt);Te.selectedIndex=ot;var It=Lt(ot),Ut;return l?(Ut=Math.abs(Te.scrollY-It)/Te.itemHeight,Te.animate({scrollY:It},Ut*bt/(Bt=="s"?1:1e3))):(Ut=Math.abs(Te.scrollX-It)/Te.itemWidth,Te.animate({scrollX:It},Ut*bt/(Bt=="s"?1:1e3))),Te},this.addAt=function(ot,bt,Bt,It){if(n(ot))return Te;if(Te.tabs.loop(function(kt){kt.visible=!0}),ot.type=="ListItem"?ot.width=t-A*2:Array.isArray(ot)&&e.loop(ot,function(kt){kt.type=="ListItem"&&(kt.width=t-A*2)}),It)if(Array.isArray(ot)){var Ut=[];e.loop(ot,function(kt){kt.clone?Ut.push(ot.clone()):Ut.push(e.copy(ot,It))}),Te.tabs.addAt(Ut,bt,Bt)}else ot.clone?Te.tabs.addAt(ot.clone(),bt,Bt):Te.tabs.addAt(e.copy(ot,It),bt,Bt);else Me&&(Array.isArray(ot)||(ot=[ot]),e.loop(ot,function(kt,Nt){typeof kt=="string"&&(ot[Nt]=e.List.checkItem(kt,null,t,"left",10,10,A,X,q,I,te,R,T,S,E))})),Te.tabs.addAt(ot,bt,Bt);return Te.update(),Te},this.removeAt=function(ot,bt){yt&&Te.tabs.removeAt(ot,bt+i.length),Te.tabs.removeAt(ot,bt),Te.tabs.loop(function(It){It.visible=!0}),en=Te.tabs.selectedIndex;var Bt=ft.getBounds();return ft.setBounds(0,0,Bt.width,Bt.height),Bt.height<r&&(Te.scrollY=0),Te.update(),Te},Ue[0]=="%-&"&&Ue.length==1&&Te.removeAt(1,0),this.clear=function(){return Te.tabs.removeAt(Te.length,0),Te.contentContainer.x=0,Te.contentContainer.y=0,Te.update(),Te},this.setCheck=function(ot,bt){n(ot)&&(ot=0),n(bt)&&(bt=!0),Te.items[ot].checkBox.checked=bt,Te.items[ot].content.zimOut()},this.getCheck=function(ot){return n(ot)&&(ot=0),Te.items[ot].checkBox.checked},this.setChecks=function(ot){return e.loop(Te.items,function(bt){bt.checkBox.checked=ot,bt.content.zimOut()}),Te},Object.defineProperty(Te,"items",{get:function(){return Te.tabs.buttons},set:function(){Ct&&ht("List() - items is read only - use addAt() and removeAt() to change")}}),Object.defineProperty(Te,"list",{get:function(){return Te.tabs.buttons},set:function(){Ct&&ht("List() - list is read only - use addAt() and removeAt() to change")}}),Object.defineProperty(Te,"length",{get:function(){return Te.tabs.buttons.length},set:function(){Ct&&ht("List() - length is read only")}}),Object.defineProperty(Te,"selectedIndex",{get:function(){return yt?(en+i.length)%i.length:en},set:function(ot){ft.selectedIndex=ot,Te.label=ft.label,Te.selected=ft.selected,en=ot,!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&Te.stage&&Te.stage.update()}}),f&&(Te.selectedIndex=0),Object.defineProperty(Te,"selectedIndexPlusPosition",{get:function(){return yt?(en+i.length)%i.length:en},set:function(ot){Te.selectedIndex=ot,en=ot,l?Te.scrollY=Lt(ot)-2:Te.scrollX=Lt(ot),!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&Te.stage&&Te.stage.update()}});function Lt(ot){if(l){var bt=-(Te.itemHeight+A)*ot+r/2-Te.itemHeight/2;return(Te.itemHeight+A)*Te.length<r&&(bt=0),bt>0&&(bt=0),(Te.itemHeight+A)*Te.length>r&&bt<-Te.tabs.height+r-pe*2&&(bt=-Te.tabs.height+r-pe*2),bt}else{var Bt=-(Te.itemWidth+A)*ot+t/2-Te.itemWidth/2;return(Te.itemWidth+A)*Te.length<t&&(Bt=0),Bt>0&&(Bt=0),(Te.itemWidth+A)*Te.length>t&&Bt<-Te.tabs.width+t-ce*2&&(Bt=-Te.tabs.width+t-ce*2),Bt}}Object.defineProperty(Te,"text",{get:function(){return Te.label?Te.label.text:null},set:function(ot){Te.label&&(Te.label.text=ot)}}),Object.defineProperty(Te,"bloom",{get:function(){return De},set:function(ot){De=ot}}),Object.defineProperty(Te,"currentValue",{get:function(){return Te.label?Te.label.text:null},set:function(ot){var bt=e.loop(Te.list,function(Bt,It){var Ut;Bt.label&&(Ut=Bt.label.text),Bt.type=="Label"&&(Ut=Bt.text);var kt=new RegExp(ot,"i");if(Ut&&Ut.match(kt))return It});bt!==!0&&(Te.selectedIndexPlusPosition=bt)}}),Object.defineProperty(Te,"itemDown",{get:function(){return Te.tabs.buttonDown},set:function(){}}),Object.defineProperty(Te,"itemsText",{get:function(){for(var ot=[],bt=0;bt<Te.tabs.buttons.length;bt++){var Bt=Te.tabs.buttons[bt].label;Bt&&!n(Bt.text)?ot.push(Bt.text):ot.push(null)}return ot},set:function(){Ct&&ht("List() - itemsText is read only")}}),f&&(Te.selectedIndex=0),Object.defineProperty(Te,"checkBoxes",{get:function(){for(var ot=[],bt=0;bt<Te.tabs.buttons.length;bt++){var Bt=Te.tabs.buttons[bt].checkBox;ot.push(Bt)}return ot},set:function(){Ct&&ht("List() - checkBoxes is read only")}}),Object.defineProperty(Te,"accordionIndex",{get:function(){var ot=Te.selected.listZID;return ot?Number(ot.split("id")[1]):null},set:function(){Ct&&ht("List() - accordionIndex is read only")}}),this.last=function(){return this.selectedIndexPlusPosition=this.length-1,this},this.first=function(){return this.selectedIndexPlusPosition=0,this},this.openAtLevel=function(ot){if(!n(ot)){var bt=[];e.loop(ot,function(It){bt.push(It)});var Bt=Te.bloom;Te.bloom=!1,e.interval(.01,function(It){var Ut=Te.items[It.count];Ut?bt.indexOf(Te.tree.getData(Ut.listZID).level)!=-1&&Te.expandList(It.count):(It.clear(),Te.bloom=Bt)},null,!0,!1,"s")}};var Zt;this.openAtNum=function(ot){if(!n(ot)){if(!Zt){let jt=function(rn,Kt){for(bt in rn)Zt[bt]=Kt,jt(rn[bt].list,bt)};var bt;Zt={},jt(Te.tree.data);var Bt={};for(var It in Zt){Bt[It]||(Bt[It]=[]);for(var Ut=Zt[It];Ut;)Bt[It].unshift(Ut),Ut=Zt[Ut];Bt[It].push(It)}}var kt="id"+ot,Nt=Bt[kt],Wt=Te.bloom;Te.bloom=!1,Bi(.01,function(jt){var rn=Te.items[jt.count];rn?Nt.indexOf(rn.listZID)!=-1&&Te.expandList(jt.count):(jt.clear(),Te.bloom=Wt)},null,!0,!1,"s")}},vt&&Gt&&Te.openAtLevel(1e4),n(Ve)&&(Ve=be.selectedIndex!=null?be.selectedIndex:0),Te.selectedIndex=Ve,We!==!1&&e.styleTransforms(this,be),this.clone=function(){return Te.cloneProps(new e.List(t,et,e.copy(Te.originalList,!0),o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,je,tt,U,e.copy(ee),ae,re,he,j,G,y,g,d,D,K,m,F,Ce,Y,Q,ce,pe,J,ue,ye,Xe,se,Ae,ie,_e,$,xe,Be,me,Oe,Ye,de,ve,Me,we,Fe,ge,Ve,He,Le,fe,Ge,Qe,Ke,st,yt,We,this.group,ct))},this.dispose=function(ot,bt,Bt){return Bt||(Te.stageToggleEvent&&Yt.off("stagemousedown",Te.stageToggleEvent),Te.organizer&&Te.organizer.dispose(),this.zimWindow_dispose()),!0}},e.extend(e.List,e.Window,["clone","dispose"],"zimWindow",!1),e.List.makeBase=function(t,r,i,o){n(o)&&(o=e.dark),t.backing=new e.Rectangle(t.width,t.height,o).center(t),r.type=="Label"?t.label=r:t.label=new e.Label(r,null,null,e.white),t.text=t.label.text,t.label.center(t).loc(i)},e.List.slider=function(t,r,i,o,l,f,h,p,_,b,w,C,O){var P="label, min, max, val, call, step, obj, property, paddingLeft, paddingRight, factor, offset, backgroundColor",A;if(A=mt(e.List.slider,arguments,P))return A;var R=new e.Container(620,100);return R.type="ListItem",R.listItem="Slider",n(_)&&(_=20),n(b)&&(b=30),n(w)&&(w=1),n(C)&&(C=0),e.List.makeBase(R,t,_,O),R.slider=new e.Slider({inside:!0,barWidth:40,barLength:150,barColor:e.blue,min:r,max:i,step:f}).sca(1.5).center(R).mov(20).change(function(){R.stepper.currentValue=C+Math.round(R.slider.currentValue*w*1e3)/1e3,h&&p&&(h[p]=R.slider.currentValue),l&&typeof l=="function"&&l(R.slider.currentValue,R.parent),R.slider.stage&&R.slider.stage.update()}),n(o)||(R.slider.currentValue=o),R.stepper=new e.Stepper({corner:0,arrows:!1,stepperType:"number",min:C+r*w,max:C+i*w,step:f}).center(R).pos(b,null,!0).change(function(){}),n(o)||(R.stepper.currentValue=C+o*w),R},e.List.checkBox=function(t,r,i,o,l,f,h,p){var _="label, checked, call, obj, property, paddingLeft, paddingRight, backgroundColor",b;if(b=mt(e.List.checkBox,arguments,_))return b;var w=new e.Container(620,100);return w.type="ListItem",w.listItem="CheckBox",n(f)&&(f=20),n(h)&&(h=30),e.List.makeBase(w,t,f,p),w.checkBox=new e.CheckBox({startChecked:r,label:""}).sca(1.2).center(w).pos(256+h,null,!0).change(function(){o&&l&&(o[l]=w.checkBox.checked),i&&typeof i=="function"&&i(w.checkBox.checked,w.parent),w.checkBox.stage&&w.checkBox.stage.update()}),w},e.List.colorPicker=function(t,r,i,o,l,f,h,p,_){var b="label, color, picker, call, obj, property, paddingLeft, paddingRight, backgroundColor",w;if(w=mt(e.List.colorPicker,arguments,b))return w;var C=new e.Container(620,100);return C.type="ListItem",C.listItem="ColorPicker",n(h)&&(h=20),n(p)&&(p=30),e.List.makeBase(C,t,h,_),n(r)&&(r=e.pink),C.colorPicker=i||new e.ColorPicker({alphaPicker:!1,selectedColor:r}),C.swatch=new e.Rectangle(132,66,r,e.lighter,5).center(C).pos(270,null,!0).cur(),C.swatch.on("mousedown",function(){C.colorPicker.selectedColor=C.swatch.color,C.colorPicker.show()}),C.colorLabel=new e.Label(C.swatch.color.toUpperCase(),40,null,e.light).center(C).pos(p,null,!0),C.colorPicker.on("close",function(){var O=C.colorPicker.stage;C.colorPicker.hide(),O&&O.update()}),C.colorPicker.on("change",function(){var O=C.colorPicker.stage;C.swatch.color=C.colorPicker.selectedColor,C.colorLabel.text=C.swatch.color.toUpperCase(),C.colorPicker.hide(),l&&f&&(l[f]=C.colorPicker.selectedColor),o&&typeof o=="function"&&o(C.colorPicker.selectedColor,C.parent),O&&O.update()}),C},e.List.checkItem=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T){var L="label, size, width, align, paddingH, paddingV, spacing, color, rollColor, selectedColor, selectedRollColor, backgroundColor, rollBackgroundColor, selectedBackgroundColor, selectedRollBackgroundColor, group, inherit",S;if(S=mt(e.List.checkItem,arguments,L))return S;var E=e.getStyle("CheckBox",R,T);n(r)&&(r=E.size!=null?E.size:20);var k=e.getStyle("List",R,T);n(i)&&(i=300),n(l)&&(l=10),n(f)&&(f=10),n(o)&&(o=k.align!=null?k.align:"center"),n(h)&&(h=k.spacing!=null?k.spacing:2),n(C)&&(C=k.backgroundColor!=null?k.backgroundColor:e.tin),n(O)&&(O=k.rollBackgroundColor!=null?k.rollBackgroundColor:e.grey),n(P)&&(P=k.selectedBackgroundColor!=null?k.selectedBackgroundColor:e.charcoal),n(A)&&(A=k.selectedRollBackgroundColor!=null?k.selectedRollBackgroundColor:e.grey),n(p)&&(p=k.color!=null?k.color:e.white),n(_)&&(_=k.rollColor!=null?k.rollColor:p),n(b)&&(b=k.selectedColor!=null?k.selectedColor:p),n(w)&&(w=k.selectedRollColor!=null?k.selectedRollColor:_);var X=new e.Container;return X.type="CheckItem",X.checkBox=new e.CheckBox({size:r,label:t,color:p,tap:!0}),X.backing=new e.Rectangle(i-h*2,X.checkBox.height+f*2,C).addTo(X),X.checkBox.center(X),o!="center"&&o!="middle"&&X.checkBox.pos(l,null,o=="right"),X.backing.tap(function(){X.checkBox.toggle(),X.zimOut()}),X.checkBox.change(function(){X.zimOut()}),X.zimOver=function(){X.backing.color=X.checkBox.checked?A:O,X.checkBox.label.color=X.checkBox.checked?w:_,X.stage&&X.stage.update()},X.zimOut=function(){X.backing.color=X.checkBox.checked?P:C,X.checkBox.label.color=X.checkBox.checked?b:p,X.stage&&X.stage.update()},X.backing.on("mouseover",X.zimOver),X.checkBox.on("mouseover",X.zimOver),X.backing.on("mouseout",X.zimOut),X.checkBox.on("mouseout",X.zimOut),X},e.Stepper=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B,Z,U,ee,ae,re,he,j,G,y,g,d,D){var K="list, width, backgroundColor, borderColor, borderWidth, label, color, vertical, arrows, corner, shadowColor, shadowBlur, continuous, display, press, hold, holdDelay, holdSpeed, draggable, dragSensitivity, dragRange, stepperType, min, max, step, step2, arrows2, arrows2Scale, keyEnabled, keyArrows, rightForward, downForward, selectedIndex, currentValue, arrowColor, arrowScale, style, group, inherit",m;if(m=mt(e.Stepper,arguments,K,this))return m;qe("61"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Stepper",this.group=d;var F=g===!1?{}:e.getStyle(this.type,this.group,D);n(t)&&(t=F.list!=null?F.list:[]),n(r)&&(r=F.width!=null?F.width:100),n(i)&&(i=F.backgroundColor!=null?F.backgroundColor:e.white),n(o)&&(o=F.borderColor!=null?F.borderColor:null),n(l)&&(l=F.borderWidth!=null?F.borderWidth:null),o<0||l<0?o=l=null:o!=null&&l==null&&(l=1),n(h)&&(h=F.color!=null?F.color:e.grey),n(f)&&(f=F.label!=null?F.label:""),(typeof f=="string"||typeof f=="number")&&(f=new e.Label({text:f,size:F.size!=null?F.size*2:40,color:h,align:F.align!=null?F.align:"center",valign:F.valign!=null?F.valign:"center",backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",group:this.group}).loc(0,0)),n(p)&&(p=F.vertical!=null?F.vertical:!1),n(_)&&(_=F.arrows!=null?F.arrows:!0),n(b)&&(b=F.corner!=null?F.corner:16),n(w)&&(w=F.shadowColor!=null?F.shadowColor:"rgba(0,0,0,.3)"),n(C)&&(C=F.shadowBlur!=null?F.shadowBlur:14),n(O)&&(O=F.continuous!=null?F.continuous:!1),n(P)&&(P=F.display!=null?F.display:!0),n(A)&&(A=F.press!=null?F.press:!0),n(R)&&(R=F.hold!=null?F.hold:!0);var Ce=v(T);n(T)&&(T=F.holdDelay!=null?F.holdDelay:Ce=="s"?.4:400),n(L)&&(L=F.holdSpeed!=null?F.holdSpeed:Ce=="s"?.2:200),a(L,Ce),n(S)&&(S=F.draggable!=null?F.draggable:!0),(n(E)||E<=0)&&(E=F.dragSensitivity!=null?F.dragSensitivity:.1),n(k)&&(k=F.dragRange!=null?F.dragRange:200),n(X)&&(X=F.stepperType!=null?F.stepperType:t.length>0?"list":"number"),n(q)&&(q=F.min!=null?F.min:0),n(V)&&(V=F.max!=null?F.max:10),n(I)&&(I=F.step!=null?F.step:1),n(te)&&(te=F.step2!=null?F.step2:I),n(B)&&te!=I&&X=="number"&&(B=F.arrows2!=null?F.arrows2:!0),n(Z)&&(Z=F.arrows2Scale!=null?F.arrows2Scale:.5),n(U)&&(U=F.keyEnabled!=null?F.keyEnabled:!0),n(ee)&&(ee=F.keyArrows!=null?F.keyArrows:!0),n(ae)&&(ae=F.rightForward!=null?F.rightForward:!0),n(re)&&(re=F.downForward!=null?F.downForward:X!="number"),n(G)&&(G=F.arrowColor!=null?F.arrowColor:i),n(y)&&(y=F.arrowScale!=null?F.arrowScale:1);var Y=this,Q,ce=60,pe=ce/4;i=dt(i);var J=I,ue,ye=1,Xe;if(X=="number"){if(q=Number(q),V=Number(V),isNaN(q)&&(q=0),isNaN(V)&&(V=100),V<q){ye=-1;var se=V;V=q,q=se,ue=V}else ue=q;this.min=q,this.max=V,0>q&&0<V&&(ue=0),I=Math.abs(I),Xe=Math.max(_e(I),_e(te))}else if(X=="letter"){t="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),typeof q!="string"&&(q="A"),typeof V!="string"&&(V="Z"),q=q.substr(0,1).toUpperCase(),V=V.substr(0,1).toUpperCase();var Ae=t.indexOf(q);Ae<0&&(q="A",Ae=0);var ie=t.indexOf(V);ie<0&&(V="Z",ie=t.length),ie<Ae&&(t.reverse(),Ae=t.length-1-Ae,ie=t.length-1-ie),t=t.splice(Ae,ie-Ae+1)}else X="list";function _e(je){var tt=String(je).split(".")[1];return tt?tt=tt.length:tt=0,tt}var $,xe=0,Be=0;S&&this.on("mousedown",function(je){Y.zimAccessibility&&Y.zimAccessibility.aria||(this.stage.mouseMoveOutside=!0,xe=je.rawX/e.scaX,Be=je.rawY/e.scaY,$=this.stage.on("stagemousemove",function(tt){xe=tt.rawX/e.scaX,Be=tt.rawY/e.scaY}))},null,!0),this.label=f,f.mouseChildren=!1,f.mouseEnabled=!1;var me,Oe,Ye,de,ve,Me,we,Fe,ge,Ve,He,Le,fe;if(_&&(Ye=this.containerPrev=new e.Container({style:!1}),this.addChild(Ye),de=this.arrowPrev=new e.Triangle(ce,ce*.8,ce*.8,G,null,null,null,null,null,null,null,!1).sca(y),w!=-1&&C>0&&(Ye.shadow=new $e.Shadow(w,3,3,C)),Ye.addChild(de),Ye.expand(),Ye.cur("pointer"),Ye.on("mousedown",function(je){if(!(Y.zimAccessibility&&Y.zimAccessibility.aria)){J=I;var tt=p?re?1:-1:ae?-1:1;yt(tt),Ke(tt,null,null,je.stageX/e.scaX,je.stageY/e.scaY)}}),R&&Ye.on("pressup",st),p?(Ye.rotation=180,Ye.x=r/2,P?Ye.y=Ye.height+pe+ce+Ye.height/2+pe:Ye.y=Ye.height*2):(Ye.rotation=-90,Ye.x=Ye.height/2,Ye.y=ce/2)),P){var Ge=this.textBox=new e.Rectangle(r,ce,i,o,l,b,null,null,null,!1);Ge.cur("pointer"),this.addChild(Ge),w!=-1&&C>0&&(Ge.shadow=new $e.Shadow(w,3,3,C)),_&&(p?_&&(Ge.y=de.height+pe):_&&(Ge.x=de.height+pe)),this.addChild(f),t.length>0&&(Q=0,f.text=t[Q]),f.center(Y);var Qe;Ge.on("mousedown",function(je){Y.zimAccessibility&&Y.zimAccessibility.aria||(Qe=Y.currentValue,A&&yt(1),Ke(1,!0,null,je.stageX/e.scaX,je.stageY/e.scaY))}),Ge.on("pressup",function(){Y.zimAccessibility&&Y.zimAccessibility.aria})}else t.length>0&&(Q=0);_&&(ve=this.containerNext=new e.Container({style:!1}),this.addChild(ve),Me=this.arrowNext=new e.Triangle(ce,ce*.8,ce*.8,G,null,null,null,null,null,null,null,!1).sca(y),w!=-1&&C>0&&(ve.shadow=new $e.Shadow(w,3,3,C)),ve.addChild(Me),ve.expand(),ve.cur("pointer"),ve.on("mousedown",function(je){if(!(Y.zimAccessibility&&Y.zimAccessibility.aria)){J=I;var tt=p?re?-1:1:ae?1:-1;yt(tt),Ke(tt,null,null,je.stageX/e.scaX,je.stageY/e.scaY)}}),R&&ve.on("pressup",st),p?(ve.rotation=0,ve.x=r/2,ve.y=ve.getBounds().height/2):(ve.rotation=90,P?ve.x=Ge.x+Ge.getBounds().width+ve.getBounds().height/2+pe:ve.x=Ye.x+Ye.getBounds().width,ve.y=ce/2));function Ke(je,tt,Te,et,Ue){if(R){He=et,Le=Ue,He==0&&(He=1),Le==0&&(Le=1),S||(E=1);var Re=L*(Ce=="s"?1e3:1),Ze=T*(Ce=="s"?1e3:1),Je=Re;fe=new e.Proportion(0,k,Re,Re*E),me=setTimeout(function(){function nt(){Oe=setTimeout(function(){var pt=je;if(S){var De=Math.abs(xe-He),lt=Math.abs(Be-Le);p?(!tt&&!Te&&(De=0),Te&&(lt=0)):(!tt&&!Te&&(lt=0),Te&&(De=0)),(De>=10||lt>=10)&&(De>lt?(J=p?te:I,pt=xe-He>0?1:-1,ae||pt*-1,Je=fe.convert(Math.abs(He-xe))):(J=p?I:te,pt=Be-Le>0?1:-1,(X=="number"||!re)&&(pt*=-1),Je=fe.convert(Math.abs(Le-Be))))}yt(pt),nt()},Je)}nt()},Ze)}}R&&P&&Ge.on("pressup",st);function st(){Y.zimAccessibility&&Y.zimAccessibility.aria||(clearTimeout(me),clearTimeout(Oe))}B&&(we=this.prev2=new e.Container({style:!1}),Fe=this.arrowPrev2=new e.Triangle(ce,ce*.8,ce*.8,"rgba(0,0,0,.2)",G,2,null,null,null,null,null,!1),we.addChild(Fe),we.expand(),we.cur("pointer"),we.sca(Z),we.alpha=.5,we.on("mousedown",function(je){if(!(Y.zimAccessibility&&Y.zimAccessibility.aria)){J=te;var tt=p?ae?-1:1:re?1:-1;yt(tt),Ke(tt,null,!0,je.stageX/e.scaX,je.stageY/e.scaY)}}),R&&we.on("pressup",st),ge=this.next2=new e.Container({style:!1}),Ve=this.arrowNext2=new e.Triangle(ce,ce*.8,ce*.8,"rgba(0,0,0,.2)",G,2,null,null,null,null,null,!1),ge.addChild(Ve),ge.expand(),ge.cur("pointer"),ge.sca(Z),ge.alpha=.5,ge.on("mousedown",function(je){if(!(Y.zimAccessibility&&Y.zimAccessibility.aria)){J=te;var tt=p?ae?1:-1:re?-1:1;yt(tt),Ke(tt,null,!0,je.stageX/e.scaX,je.stageY/e.scaY)}}),R&&ge.on("pressup",st),p?(we.y=this.height/2,we.x=-we.width/2-pe*Math.max(.2,Math.min(1,Z)),we.rotation=270,ge.y=this.height/2,ge.x=this.width+ge.width/2+pe*Math.max(.2,Math.min(1,Z)),ge.rotation=90):(ge.x=this.width/2,ge.y=-ge.height/2-pe*Math.max(.2,Math.min(1,Z)),ge.rotation=0,we.x=this.width/2,we.y=this.height+we.height/2+pe*Math.max(.2,Math.min(1,Z)),we.rotation=180),this.addChild(we,ge)),Object.defineProperty(this,"stepperArray",{get:function(){if(X=="number"){t=[];for(var je=Y.min;je<=Y.max;je+=Math.min(I,te))t.push(Number(e.decimals(je,Xe,null,!1)));t.push(V)}return t},set:function(je){t=je;var tt=Y.selectedIndex;Y.selectedIndex=tt}}),Object.defineProperty(this,"min",{get:function(){return q},set:function(je){if(X=="number"){Y.currentValue<je&&(Y.currentValue=je),q=je;var tt=Y.selectedIndex;Y.selectedIndex=tt}else q=je}}),Object.defineProperty(this,"max",{get:function(){return V},set:function(je){if(X=="number"){Y.currentValue>je&&(Y.currentValue=je),V=je;var tt=Y.selectedIndex;Y.selectedIndex=tt}else V=je}}),ct(X=="number"?ue:t[Q],X=="number"?ue:Q);function yt(je){var tt;if(X=="number"){ue=Number(ue);var Te=ue;ue+=Number(J*je*ye),ue=e.decimals(ue,Xe),O?ue>Y.max?ue=Y.min:ue<Y.min&&(ue=Y.max):(ue>Y.max?(ue=I==1?Y.max:Te,P&&Ge.cur("default")):P&&Ge.cur("pointer"),ue<Y.min&&(ue=I==1?Y.min:Te))}else{if(tt=Q+je,O)tt>t.length-1&&(tt=0),tt<0&&(tt=t.length-1);else{if(tt>t.length-1){P&&Ge.cur("default");return}else P&&Ge.cur("pointer");if(tt<0)return}Q=tt}ct(X=="number"?ue:t[Q],X=="number"?ue:Q),Y.currentValue!=Qe&&Y.dispatchEvent("change"),Qe=Y.currentValue}Object.defineProperty(this,"selectedIndex",{get:function(){return X=="number"?Y.stepperArray.indexOf(Y.currentValue):Q},set:function(je){n(je)||(X=="number"?(Q=Math.min(Y.stepperArray.length-1,Math.max(0,je)),ue=Y.stepperArray[Q],ct(ue,ue)):(je=Math.min(t.length-1,Math.max(0,je)),Q=je,ct(t[Q],Q)))}}),Object.defineProperty(this,"currentValue",{get:function(){return X=="number"?Number(ue):t[Q]},set:function(je){if(!n(je))if(X=="number"){if(je=Number(je),Y.max>Y.min){if(je>Y.max||je<Y.min)return}else if(je<Y.max||je>Y.min)return;var tt=Y.stepperArray.indexOf(je);if(tt<0)return;Q=tt,ue=Number(Y.stepperArray[Q]),ct(ue,ue)}else{if(t.indexOf(je)>-1)je=t.indexOf(je);else return;if(je==Y.selectedIndex)return;Q=je,ct(t[Q],Q)}}}),Object.defineProperty(this,"currentValueEvent",{get:function(){return Y.currentValue},set:function(je){String(je)!=String(Y.currentValue)&&(Y.currentValue=je,Y.dispatchEvent("change"))}}),Object.defineProperty(this,"continuous",{get:function(){return O},set:function(je){O=je,X=="number"?ct(ue,ue):ct(t[Y.selectedIndex],Y.selectedIndex)}}),this._enabled=!0,Object.defineProperty(Y,"enabled",{get:function(){return Y._enabled},set:function(je){c(Y,je),je?(X=="number"?ct(ue,ue):ct(t[Y.selectedIndex],Y.selectedIndex),le.addEventListener("keydown",Y.keyDownEvent)):(Pe(),Ie(),le.removeEventListener("keydown",Y.keyDownEvent),P&&(f.mouseChildren=!1),P&&(f.mouseEnabled=!1)),ve&&!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&ve.stage?ve.stage.update():f&&!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&f.stage&&f.stage.update()}}),le.KEYFOCUS!=null&&(e.KEYFOCUS=le.KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return e.KEYFOCUS==Y},set:function(){e.KEYFOCUS=Y}}),e.KEYFOCUS||We(),this.on("mousedown",function(){We()});function We(){Y.keyFocus=!0;var je=document.activeElement;je&&je.blur()}function at(){Ye.alpha=1,de.color=G,Ye.cur("pointer"),ve.alpha=1,Me.color=G,ve.cur("pointer"),O||(X=="number"?(Q==Y.min&&(ye>0?Pe():Ie()),Q==Y.max&&(ye>0?Ie():Pe())):(Q==0&&(p?Ie():Pe()),Q==t.length-1&&(p?Pe():Ie())))}function ct(je,tt){Q=tt,P&&(X=="number"&&je!=0&&Xe>0&&(je=e.decimals(je,Xe,!0)),f.text=je,f.center(Y)),_&&at(),ve&&!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&ve.stage?ve.stage.update():f&&!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&f.stage&&f.stage.update(),Y.zimAccessibility&&Y.zimAccessibility.changeTitle(Y,null,!0)}function Pe(){_&&(Ye.alpha=.8,de.color=e.fog,Ye.cur("default"))}function Ie(){_&&(ve.alpha=.8,Me.color=e.fog,ve.cur("default"))}var be,ze=!0,it="";this.on("mousedown",function(){ze=!0,it="",!(Y.zimAccessibility&&Y.zimAccessibility.aria)&&(Y.focus=!0,be=!1)}),this.keyDownEvent=function(je){if(Y.stage&&(Y.zimAccessibility&&Y.focus||!Y.zimAccessibility&&Y.keyFocus)){je||(je=event);var tt=je.keyCode;if(ee&&tt>=37&&tt<=40){var Te=re?40:38,et=ae?39:37,Ue=re?38:40,Re=ae?37:39;tt==Te||tt==et?(p&&tt==Te||!p&&tt==et?J=I:J=te,yt(1)):(tt==Ue||tt==Re)&&(p&&tt==Ue||!p&&tt==Re?J=I:J=te,yt(-1))}if(U)if(X=="number"){var Ze=null,Je=null;if(tt==8){var nt=String(it).split("");nt.pop(),Ze=nt.pop(),it=nt.join("")}if(!je.shiftKey&&tt>=48&&tt<=57?Ze=tt-48:tt>=96&&tt<=105?Ze=tt-96:tt==190?(it=String(it)+".",Je=!0):tt==173||tt==189?(Y.currentValue=Y.currentValue*-1,Y.currentValue!=Qe&&Y.dispatchEvent("change"),Qe=Y.currentValue,be=!be):tt==46&&(ze=!0,it=""),n(Ze)&&n(Je)){ze=!0,it="";return}if(n(Ze)||(ze?(ze=!1,it=Ze):it=Ze=+(it+""+Ze),Ze<q||Ze>V))return;Y.currentValue=Ze,Y.currentValue!=Qe&&Y.dispatchEvent("change"),Qe=Y.currentValue}else ze=!0,it="",Y.currentValue=String.fromCharCode(je.keyCode),Y.currentValue!=Qe&&Y.dispatchEvent("change"),Qe=Y.currentValue}},le.addEventListener("keydown",this.keyDownEvent),this.next=function(){yt(1)},this.prev=function(){yt(-1)},n(he)&&(he=F.selectedIndex!=null?F.selectedIndex:0),Y.selectedIndex=he,n(j)&&(j=F.currentValue!=null?F.currentValue:null),n(j)||(Y.currentValue=j),g!==!1&&e.styleTransforms(this,F),this.clone=function(){return Y.cloneProps(new e.Stepper(t,r,i,o,l,f.clone(),h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B,Z,U,ee,ae,re,he,j,G,y,g,this.group,D))},this.dispose=function(je,tt,Te){return le.removeEventListener("keydown",Y.keyDownEvent),Y.removeAllEventListeners(),Y.stage&&Y.stage.off($),Te||this.zimContainer_dispose(!0),Ye=this.containerPrev=de=this.arrowPrev=null,ve=this.containerNext=Me=this.arrowNext=null,Ge=this.textBox=f=this.label=null,!0}},e["zut"]=function(t){if(!n(t)&&t["key"])e.async("https://zimjs.com/gamdata.php?id="+t["key"]+"&player="+t["player"]+"&score="+t["score"]+"&reverse="+t["info"]["reverse"]+"&total="+t["info"]["total"]+"&allowZero="+t["info"]["allowZero"],t["info"]["type"]);else return!0},e.extend(e.Stepper,e.Container,["clone","dispose"],"zimContainer",!1),e.Slider=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B,Z,U,ee,ae,re,he,j,G,y,g){var d="min, max, step, button, barLength, barWidth, barColor, vertical, useTicks, tickColor, tickStep, semiTicks, tickScale, semiTickScale, accentSize, accentOffset, accentColor, accentBackgroundColor, accentDifference, sound, inside, keyArrows, keyArrowsStep, keyArrowsH, keyArrowsV, damp, currentValue, expand, expandVertical, expandBar, expandBarVertical, useLabels, labelMargin, labelColor, style, group, inherit",D;if(D=mt(e.Slider,arguments,d,this))return D;qe("62"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Slider",this.group=y;var K=G===!1?{}:e.getStyle(this.type,this.group,g);if(n(t)&&(t=K.min!=null?K.min:0),n(r)&&(r=K.max!=null?K.max:10),r-t==0){ht("ZIM Slider range must not be 0");return}n(E)&&(E=K.sound!=null?K.sound:!1),n(i)&&(i=K.step!=null?K.step:0),n(o)&&(o=K.button!=null?K.button:E?"aztec":null),o&&o.type=="Button"&&(o=o.clone()),n(l)&&(l=K.barLength!=null?K.barLength:300),n(f)&&(f=K.barWidth!=null?K.barWidth:3),n(h)&&(h=K.barColor!=null?K.barColor:E?e.lighter:e.granite),n(p)&&(p=K.vertical!=null?K.vertical:!!E),n(_)&&(_=K.useTicks!=null?K.useTicks:!!E),n(w)&&(w=K.tickStep!=null?K.tickStep:i||(_||E?(r-t)/40:0)),n(C)&&(C=K.semiTicks!=null?K.semiTicks:w?3:0),n(b)&&(b=K.tickColor!=null?K.tickColor:E?e.tin:h),n(O)&&(O=K.tickScale!=null?K.tickScale:E?1.25:1),n(P)&&(P=K.semiTickScale!=null?K.semiTickScale:1),n(A)&&(A=K.accentSize!=null?K.accentSize:E?10:0),n(R)&&(R=K.accentOffset!=null?K.accentOffset:E?-(A+f)/2:0),n(T)&&(T=K.accentColor!=null?K.accentColor:e.pink),n(L)&&(L=K.accentBackgroundColor!=null?K.accentBackgroundColor:E?e.blue:e.clear),n(S)&&(S=K.accentDifference!=null?K.accentDifference:-.5),n(k)&&(k=K.inside!=null?K.inside:!1),n(X)&&(X=K.keyArrows!=null?K.keyArrows:!0),n(V)&&(V=K.keyArrowsH!=null?K.keyArrowsH:!0),n(I)&&(I=K.keyArrowsV!=null?K.keyArrowsV:!0),n(q)&&(q=K.keyArrowsStep!=null?K.keyArrowsStep:(r-t)/100),n(te)&&(te=K.damp!=null?K.damp:!1),n(B)&&(B=K.currentValue!=null?K.currentValue:!1),n(Z)&&(Z=K.expand!=null?K.expand:e.mobile()?10:null),n(U)&&(U=K.expandVertical!=null?K.expandVertical:Z),n(ee)&&(ee=K.expandBar!=null?K.expandBar:null),n(ae)&&(ae=K.expandBarVertical!=null?K.expandBarVertical:Z),n(re)&&(re=K.useLabels!=null?K.useLabels:!1),n(he)&&(he=K.labelMargin!=null?K.labelMargin:20),n(j)&&(j=K.labelColor!=null?K.labelColor:e.dark);var m,F=this,Ce=Y(t,r,i,B);this.veeObj={min:Ce[0],max:Ce[1],step:Ce[2],currentValue:Ce[3]};function Y(){return arguments}t=e.Pick.choose(t),r=e.Pick.choose(r),i=e.Pick.choose(i);var Q=i;B=e.Pick.choose(B);var ce;A&&(F.accentBacking=new e.Rectangle(l-.25,A+S,L).addTo(this).rot(p?90:0).mov(p?-R-f/2+S/2:.25,p?0:R+f/2-S/2),ce=F.accent=new e.Rectangle(l,A,T).sca(0,1).rot(p?-90:0).mov(p?-R-A-f/2:0,p?l:R+f/2).addTo(this));function pe(){ce.sca((F.currentValue-F.min)/Math.abs(F.max-F.min),1)}var J=!(!n(K.backing)&&K.backing.type!="Pattern");function ue(Je,nt,pt){var De=new e.Shape(nt,pt);return De.f(Je).s(K.borderColor!=null?K.borderColor:e.tin).ss(K.borderWidth!=null?K.borderWidth:3).mt(2,0).lt(nt+2,pt*.2).lt(nt+2,pt*.8).lt(2,pt).cp().centerReg({add:!1}),De}if(n(o)||typeof o=="string"){var ye=30,Xe=40;p&&(ye=50,Xe=40);var se;if(o=="pill"||o=="aztec"||o=="circle"||o=="grip"){if(o=="pill")se={width:p?40:18,height:p?18:40,borderColor:e.tin,borderWidth:3,corner:8};else if(o=="aztec"){ye=K.width!=null?K.width:Math.max(ye,Xe)*.9,Xe=K.height!=null?K.height:Math.min(ye,Xe)*.6;var Ae=ue(K.backgroundColor!=null?K.backgroundColor:e.lighter,ye,Xe).rot(p?0:-90),ie=ue(K.rollBackgroundColor!=null?K.rollBackgroundColor:e.white,ye,Xe).rot(p?0:-90);se={width:ye,height:Xe,backing:Ae,rollBacking:ie},K.borderWidth=0,K.borderColor=0}else o=="circle"&&(ye=K.width!=null?K.width:30,Xe=K.height!=null?K.height:30,se={width:ye,height:ye,corner:K.corner!=null?K.corner:ye/2});F.buttonType=o}var _e=K.borderColor!=null?K.borderColor:se?se.borderColor:J?e.granite:null;if(o=new e.Button({width:K.width!=null?K.width:se?se.width:ye,height:K.height!=null?K.height:se?se.height:Xe,label:"",backgroundColor:K.backgroundColor!=null?K.backgroundColor:e.white,rollBackgroundColor:K.rollBackgroundColor!=null?K.rollBackgroundColor:n(K.backgroundColor)||K.backgroundColor==e.white?e.moon:K.backgroundColor.lighten(.2),borderColor:_e,rollBorderColor:K.rollBorderColor!=null?K.rollBorderColor:_e,borderWidth:K.borderWidth!=null?K.borderWidth:se?se.borderWidth:J?1:null,corner:K.corner!=null?K.corner:se?se.corner:0,backing:K.backing!=null?K.backing.clone():se?se.backing:null,rollBacking:K.rollBacking!=null?K.rollBacking.clone():se?se.rollBacking:null,shadowColor:K.shadowColor!=null?K.shadowColor:null,shadowBlur:K.shadowBlur!=null?K.shadowBlur:null,hitPadding:30,style:!1}),F.buttonType=="circle")o.scaleY=Xe/ye,p||o.rot(-90);else if(F.buttonType=="grip"){var $=[1,1,1],xe=.4;e.loop($,function(Je,nt,pt){p?new e.Line(o.width*.62,Je,o.borderColor?o.borderColor:e.grey).pos(0,o.height*xe/2+(nt+1)*(o.height*(1-xe))/(pt+1),e.CENTER,e.TOP,o):new e.Line(o.height*.62,Je,o.borderColor?o.borderColor:e.grey).rot(90).pos(o.width*xe/2+(nt+1)*(o.width*(1-xe))/(pt+1),0,e.LEFT,e.CENTER,o)})}}o.rollPersist=!0,(!n(Z)||!n(U))&&o.expand(Z,U);var Be,me;p?(Be=o.width,k?(me=l,this.setBounds(0,0,Be,me)):(me=l+o.height,this.setBounds(-o.width/2,-o.height/2,Be,me))):(me=Math.max(o.height,f),k?(Be=l,this.setBounds(0,0,Be,me)):(Be=l+o.width,this.setBounds(-o.width/2,-o.height/2,Be,me)));var Oe=t,Ye=0;this.button=o,this.cur("pointer");var de,ve,Me,we,Fe;if(_){we=this.ticks=new e.Shape({style:!1}),this.addChild(we),Fe=we.graphics,Fe.ss(1).s(b);var ge=Math.round((r-t)/(w||i)),Ve=(r-t)/ge;w?(Ve!=w&&Ct&&ht("Slider() - non-divisible step ("+w+") adjusted to "+Ve),w=Ve):(Ve!=i&&Ct&&ht("Slider() - non-divisible step ("+i+") adjusted to "+Ve),i=Ve);var He;k?He=(l-(p?o.height:o.width))/Math.abs(ge):He=l/Math.abs(ge)}var Le,fe,Ge,Qe,Ke,st,yt;if(p){if(Le=k?o.height/2:0,de=this.bar=new e.Rectangle(f,l,h,null,null,null,null,null,null,!1),ee?de.expand(ee,ae):de.expand(20,0),de.centerReg(this),o.centerReg(this),Me=de.getBounds(),ve=new $e.Rectangle(de.x,Me.y+Le,0,Me.height-Le*2),_){for(re&&(fe=F.labels=new e.Container().addTo(F)),Ge=0;Ge<=Math.abs(ge);Ge++)Qe=Ge%(C+1)==0,Ke=Qe?25*O:15*P,st=Le+He*Ge,Fe.mt(0,st).lt(Ke,st),re&&(C&&Qe||!C)&&(yt=Math.max(e.countDecimals(Q),e.countDecimals(t),e.countDecimals(r)),new e.Label({text:e.decimals(r-(r-t)/Math.abs(ge)*Ge,yt+1),size:K.size?K.size:10,color:j,align:"left",valign:"center"}).centerReg({add:!1}).reg(0).loc(Ke+he+2,st-1,fe));we.x=de.x+15}}else if(Le=k?o.width/2:0,de=this.bar=new e.Rectangle(l,f,h,null,null,null,null,null,null,!1),ee?de.expand(ee,ae):de.expand(0,20),de.centerReg(this),o.centerReg(this),Me=de.getBounds(),ve=new $e.Rectangle(Me.x+Le,de.y,Me.width-Le*2,0),_){for(re&&(fe=F.labels=new e.Container().addTo(F)),Ge=0;Ge<=Math.abs(ge);Ge++)Qe=Ge%(C+1)==0,Ke=Le+He*Ge,st=-(Qe?25*O:15*P),Fe.mt(Ke,0).lt(Ke,st),re&&(C&&Qe||!C)&&(yt=Math.max(e.countDecimals(Q),e.countDecimals(t),e.countDecimals(r)),new e.Label({text:e.decimals(t+(r-t)/Math.abs(ge)*Ge,yt+1),size:K.size?K.size:10,color:j,align:"center",valign:"center"}).centerReg({add:!1}).loc(Ke,st-he,fe));we.y=de.y-10}o.x=ve.x,o.y=ve.y;function We(Je){return i==0?Je:Math.round(Je/i)*i}var at,ct;o.on("mousedown",function(Je){m=Je.target.stage,F.focus=!0;var nt=F.globalToLocal(Je.stageX/e.scaX,Je.stageY/e.scaY);at=nt.x-o.x,ct=nt.y-o.y,m&&(m.mouseMoveOutside=!0)}),o.on("pressmove",function(Je){Pe(Je)});function Pe(Je){var nt=F.globalToLocal(Je.stageX/e.scaX,Je.stageY/e.scaY),pt=ze(nt.x-at,nt.y-ct,ve);p?(o.x=pt.x,Oe=We((pt.y-ve.y)/ve.height*(t-r)),o.y=ve.y+Oe*ve.height/(t-r),Oe+=r,o.y!=Ye&&F.dispatchEvent("change"),Ye=o.y):(Oe=We((pt.x-ve.x)/ve.width*(r-t)),o.x=ve.x+Oe*ve.width/(r-t),Oe+=t,o.y=pt.y,o.x!=Ye&&F.dispatchEvent("change"),Ye=o.x),ce&&pe(),be(),!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&F.stage&&F.stage.update()}function Ie(Je){return Je>0?1:-1}function be(){F.zimAccessibility&&F.zimAccessibility.changeTitle(F,null,!0)}function ze(Je,nt,pt){return Je=Math.max(pt.x,Math.min(pt.x+pt.width,Je)),nt=Math.max(pt.y,Math.min(pt.y+pt.height,nt)),{x:Je,y:nt}}de.on("mousedown",function(Je){m=Je.target.stage,at=0,ct=0,!(F.zimAccessibility&&F.zimAccessibility.aria)&&Pe(Je)});var it,je;te&&(it=t,je=new e.Damp(it,te),F.ticker=e.Ticker.add(function(){it=je.convert(Oe)})),Object.defineProperty(this,"currentValue",{get:function(){return te?it:Oe},set:function(Je){n(Je)||(t<r?(Je<t&&(Je=t),Je>r&&(Je=r)):(Je>t&&(Je=t),Je<r&&(Je=r)),Oe=Je=We(Je),je&&je.immediate(Oe),p?(o.y=(Je-r)/(t-r)*ve.height+Le,Ye=o.y):(o.x=(Je-t)/(r-t)*ve.width+Le,Ye=o.x),ce&&pe(),be(),!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&F.stage&&F.stage.update())}}),Object.defineProperty(this,"currentValueEvent",{get:function(){return te?it:Oe},set:function(Je){Je!=F.currentValue&&(F.currentValue=Je,F.dispatchEvent("change"))}}),Object.defineProperty(this,"min",{get:function(){return t},set:function(){Ct&&ht("Slider() - min is read only")}}),Object.defineProperty(this,"max",{get:function(){return r},set:function(){Ct&&ht("Slider() - max is read only")}}),Object.defineProperty(this,"step",{get:function(){return i},set:function(){Ct&&ht("Slider() - step is read only")}}),Object.defineProperty(this,"keyArrowsH",{get:function(){return V},set:function(Je){V=Je}}),Object.defineProperty(this,"keyArrowsV",{get:function(){return I},set:function(Je){I=Je}}),le.KEYFOCUS!=null&&(e.KEYFOCUS=le.KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return e.KEYFOCUS==F},set:function(){e.KEYFOCUS=F}}),X&&!e.KEYFOCUS&&tt(),this.on("mousedown",function(){X&&tt()});function tt(){F.keyFocus=!0;var Je=document.activeElement;Je&&Je.blur()}var Te=!1,et=!1,Ue=!1,Re=!1;this.keyDownEvent=function(Je){F.stage&&(F.zimAccessibility&&F.focus||!F.zimAccessibility&&F.keyFocus)&&(Je.keyCode==37&&V?Te=!0:Je.keyCode==40&&I?et=!0:Je.keyCode==39&&V?Ue=!0:Je.keyCode==38&&I&&(Re=!0),F.keyInterval==null&&(Te||et||Ue||Re)&&(Ze(),F.keyTimeout=setTimeout(function(){F.keyInterval==null&&(Te||et||Ue||Re)&&(F.keyInterval=setInterval(Ze,40))},140)))};function Ze(){(Te||et)&&(i>0?F.currentValueEvent-=i*Ie(r-t):F.currentValueEvent-=q*Ie(r-t)),(Ue||Re)&&(i>0?F.currentValueEvent+=i*Ie(r-t):F.currentValueEvent+=q*Ie(r-t))}le.addEventListener("keydown",this.keyDownEvent),F.keyUpEvent=function(Je){Je.keyCode==37?Te=!1:Je.keyCode==40?et=!1:Je.keyCode==39?Ue=!1:Je.keyCode==38&&(Re=!1),F.keyInterval!=null&&!Te&&!et&&!Ue&&!Re&&(clearInterval(F.keyInterval),F.keyInterval=null)},le.addEventListener("keyup",this.keyUpEvent),this._enabled=!0,Object.defineProperty(F,"enabled",{get:function(){return F._enabled},set:function(Je){c(F,Je),Je?(le.addEventListener("keydown",F.keyDownEvent),le.addEventListener("keyup",F.keyUpEvent)):(le.removeEventListener("keydown",F.keyDownEvent),le.removeEventListener("keyup",F.keyUpEvent))}}),n(B)||(F.currentValue=B),e.setSwipe(this,!1),G!==!1&&e.styleTransforms(this,K),this.clone=function(Je){return F.cloneProps(new e.Slider(Je||!e.isPick(Ce[0])?F.min:Ce[0],Je||!e.isPick(Ce[1])?F.max:Ce[1],Je||!e.isPick(Ce[2])?F.step:Ce[2],o.clone(),l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,Je||!e.isPick(Ce[3])?F.currentValue:Ce[3],Z,U,ee,ae,re,he,j,G,this.group,g))},this.dispose=function(Je,nt,pt){return le.removeEventListener("keydown",F.keyDownEvent),le.removeEventListener("keyup",F.keyUpEvent),pt||this.zimContainer_dispose(!0),!0}},e.extend(e.Slider,e.Container,["clone","dispose"],"zimContainer",!1),e.Selector=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E){var k="tile, borderColor, borderWidth, backgroundColor, corner, dashed, paddingH, paddingV, speed, diagonal, dim, multi, keyArrows, behind, resizeScale, selectedIndex, liveIndex, style, group, inherit",X;if(X=mt(e.Selector,arguments,k,this))return X;qe("62.5"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Selector",this.group=S;var q=L===!1?{}:e.getStyle(this.type,this.group,E),V=v();n(t)&&(t=q.tile!=null?q.tile:new e.Tile(new e.Circle(20,e.red),4,4,10,10)),n(r)&&(r=q.borderColor!=null?q.borderColor:e.white),n(i)&&(i=q.borderWidth!=null?q.borderWidth:2),n(o)&&(o=q.backgroundColor!=null?q.backgroundColor:"rgba(0,0,0,.1)"),n(l)&&(l=q.corner!=null?q.corner:10),n(f)&&(f=q.dashed!=null?q.dashed:!1),n(h)&&(h=q.padding!=null?q.padding:t.spacingH/2),n(p)&&(p=q.paddingV!=null?q.paddingV:t.spacingV/2),n(_)&&(_=q.speed!=null?q.speed:2),n(b)&&(b=q.diagonal!=null?q.diagonal:!1),n(w)&&(w=q.dim!=null?q.dim:!1),n(C)&&(C=q.multi!=null?q.multi:!1),C&&(_=0),n(O)&&(O=q.keyArrows!=null?q.keyArrows:!0),n(P)&&(P=q.behind!=null?q.behind:!1),n(A)&&(A=q.resizeScale!=null?q.resizeScale:!1),n(R)&&(R=q.selectedIndex!=null?q.selectedIndex:null),n(T)&&(T=q.liveIndex!=null?q.liveIndex:!1),this.liveIndex=T;var I=[],te=[];e.loop(t.items.length,function(){I.push(dt(r)),te.push(dt(o))});var B=this;if(!(n(R)&&C)){var Z=R,U=n(R)||R<0?0:R,ee=t.getChildAt(U);B.currentItem=t.getChildAt(U),R=Z,n(R)&&(R=q.selectedIndex!=null?q.selectedIndex:0)}var ae,re,he;ae=ee||t.getChildAt(0),ae&&(re=ae.width+h*2,he=ae.height+p*2),B.tile=t.addTo(B).cur();var j;if(C){var G=this.selectors=[];e.loop(10,function(){j=new e.Rectangle(re,he,e.faint,e.faint,i,l,f,{ignoreScale:!A}).centerReg(B,P?0:1),j.visible=!1,G.push(j),j.mouseEnabled=!1}),this.selector=j}else j=this.selector=new e.Rectangle(re,he,e.faint,e.faint,i,l,f,{ignoreScale:!A}).centerReg(B),j.loc(t.width/2,ae.y+p,B,P?0:1),j.visible=!1;R<0||n(ee)||(j.loc(ae.x+h,ae.y+p,B,P?0:1),j.color=te[R],j.borderColor=I[R],j.visible=!0),t.mov(h,p),this.setBounds(t.width+h*2,t.height+p*2);var y={};this.tileDown=t.on("mousedown",function(D){var K=j;if(!(C&&(K=G.shift(),n(K)))){K.visible=!0;for(var m=D.target,F=0;m.parent!=t&&F<10;)m=m.parent,F++;if(m.parent==t&&g(m,null,K),C){var Ce="id"+Math.abs(D.pointerID+1);y[Ce]={index:R,item:ee,selector:K}}}}),C&&(this.tileMove=t.on("pressmove",function(D){var K="id"+Math.abs(D.pointerID+1),m=y[K];if(!n(m)){var F=t.itemUnderPoint(D.stageX/e.scaX,D.stageY/e.scaY);if(m.item!=F){if(B.upItem=m.item,B.upIndex=m.index,B.downItem=m.item=F,B.downIndex=m.index=F?F.tileNum:null,B.dispatchEvent("change"),n(F))m.selector.visible=!1;else{var Ce=t.localToLocal(F.x,F.y,B);m.selector.loc(Ce.x,Ce.y).siz(F.width+h*2,F.height+p*2),m.selector.color=te[m.index],m.selector.borderColor=I[m.index],m.selector.visible=!0}B.stage.update()}}}),this.tileUp=t.on("pressup",function(D){var K="id"+Math.abs(D.pointerID+1),m=y[K];n(m)||(B.downIndex=B.downItem=null,B.upIndex=m.index,B.upItem=m.item,G.push(m.selector),m.selector.visible=!1,B.dispatchEvent("change"),B.stage&&!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&B.stage.update(),delete y[K])})),B.noAnimate=!1;function g(D,K,m,F){n(m)&&(m=j),ee=D,R=D.tileNum,m.color=te[R],m.borderColor=I[R],C&&(B.upItem=B.upIndex=null,B.downItem=ee,B.downIndex=R),B.animating=!0;var Ce=t.localToLocal(D.x,D.y,B),Y=Math.abs(Ce.x-j.x),Q=Math.abs(Ce.y-j.y),ce=B.noAnimate||K?0:_;if(B.noAnimate=!1,ce==0)m.loc(Ce.x,Ce.y).siz(D.width+h*2,D.height+p*2),B.animating=!1,B.dispatchEvent("change");else{if(b||(Y+Q)*ce<=0?m.animate({x:Ce.x,y:Ce.y},(Q+Y)*ce):(m.stopAnimate(),Y>=Q?m.animate([{props:{x:Ce.x},time:Math.max(V=="s"?.1:100,Y*ce/(V=="s"?1e3:1))},{props:{y:Ce.y},time:Math.max(V=="s"?.1:100,Q*ce/(V=="s"?1e3:1))}]):m.animate([{props:{y:Ce.y},time:Math.max(V=="s"?.1:100,Q*ce/(V=="s"?1e3:1))},{props:{x:Ce.x},time:Math.max(V=="s"?.1:100,Y*ce/(V=="s"?1e3:1))}])),m.animate({props:{widthOnly:D.width+h*2,heightOnly:D.height+p*2},time:Math.max(V=="s"?.2:200,(Q+Y)*ce/(V=="s"?1e3:1)),events:B.liveIndex,call:function(){B.animating=!1,F?B.dispatchEvent("changeset"):B.dispatchEvent("change")}}),B.liveIndex){var pe=null;m.on("animation",function(){var ue=m.parent.localToGlobal(m.x,m.y),ye=t.itemUnderPoint(ue.x,ue.y);ye.tileNum!=pe&&(R=ye.tileNum,F?B.dispatchEvent("changeset"):B.dispatchEvent("change"),pe=ye.tileNum)})}if(w){if(w===!0)var J=.7;else J=e.constrain(w,0,1);t.animate({props:{alpha:J},rewind:!0,time:(Q+Y)*_*.7/(V=="s"?1e3:1)})}}t.stage&&t.stage.update()}O&&B.added(function(){B.keyEvent=B.stage.frame.on("keydown",function(D){if(B.stage&&B.enabled&&!B.animating&&(B.zimAccessibility&&B.focus||!B.zimAccessibility&&B.keyFocus)){var K=e.loop(t.items2D,function(Y,Q){var ce=e.loop(Y,function(pe,J){if(pe==ee)return[J,Q]});if(Array.isArray(ce))return ce});K===!0&&(K=[0,0]);var m=t.items2D[K[1]].length,F=t.items2D.length,Ce;D.keyCode=="39"?(Ce=(K[0]+1)%m,g(t.items2D[K[1]][Ce],Ce<K[0])):D.keyCode=="37"?(Ce=(K[0]-1+m)%m,g(t.items2D[K[1]][Ce],Ce>K[0])):D.keyCode=="38"?(Ce=(K[1]-1+F)%F,g(t.items2D[Ce][K[0]],Ce>K[1])):D.keyCode=="40"&&(Ce=(K[1]+1)%F,g(t.items2D[Ce][K[0]],Ce<K[1]))}})}),Object.defineProperty(this,"selectedIndex",{get:function(){return R},set:function(D){n(D)&&(B.currentItem=null),B.currentItem=t.items[Math.round(D)]}}),Object.defineProperty(this,"text",{get:function(){return ee.text},set:function(){Ct&&ht("Selector() - text is read only")}}),Object.defineProperty(this,"currentItem",{get:function(){return ee},set:function(D){if(n(D)){ee=null,R=null,j.visible=!1,B.selectedCol=null,B.selectedRow=null;return}j.visible=!0,B.lastItem=ee,B.lastIndex=R,B.lastCol=B.selectedCol,B.lastRow=B.selectedRow,B.selectedCol=D.tileCol,B.selectedRow=D.tileRow,R=D.tileNum,ee=D,g(ee,null,null,!0)}}),this._enabled=!0,Object.defineProperty(B,"enabled",{get:function(){return B._enabled},set:function(D){D?B.mouse():B.noMouse(),B._enabled=D}}),le.KEYFOCUS!=null&&(e.KEYFOCUS=le.KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return e.KEYFOCUS==B},set:function(){e.KEYFOCUS=B}}),e.KEYFOCUS||d(),this.on("mousedown",function(){d()});function d(){B.keyFocus=!0;var D=document.activeElement;D&&D.blur()}L!==!1&&e.styleTransforms(this,q),this.clone=function(D){if(D)for(var K=[],m=0;m<B.tile.items.length;m++)K.push(B.tile.items[m].clone(!0));return B.cloneProps(new e.Selector(D?e.series(K):t.clone?t.clone():t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,this.style,this.group))},this.dispose=function(D,K,m){B.keyEvent&&B.stage&&B.stage.frame.off("keydown",B.keyEvent),t.off(B.tileDown),t.dispose(),C&&(t.off(B.tileMove),t.off(B.tileUp)),m||this.zimContainer_dispose(!0)}},e.extend(e.Selector,e.Container,["clone","dispose"],"zimContainer",!1),e.Dial=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B,Z,U,ee,ae,re,he,j,G,y,g,d,D,K,m,F){var Ce="min, max, step, width, backgroundColor, indicatorColor, indicatorScale, indicatorType, useTicks, innerTicks, tickColor, tickStep, semiTicks, tickScale, semiTickScale, innerCircle, innerScale, innerColor, inner2Color, accentSize, accentOffset, accentColor, accentBackgroundColor, accentDifference, sound, linear, gap, limit, keyArrows, keyArrowsStep, keyArrowsH, keyArrowsV, continuous, continuousMin, continuousMax, damp, currentValue, useLabels, labelMargin, style, group, inherit",Y;if(Y=mt(e.Dial,arguments,Ce,this))return Y;qe("63"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Dial",this.group=m;var Q=K===!1?{}:e.getStyle(this.type,this.group,F);if(n(t)&&(t=Q.min!=null?Q.min:0),n(r)&&(r=Q.max!=null?Q.max:10),r-t==0){ht("ZIM Dial range must not be 0");return}n(I)&&(I=Q.sound!=null?Q.sound:!1),n(i)&&(i=Q.step!=null?Q.step:I?0:1),n(o)&&(o=Q.width!=null?Q.width:100),n(l)&&(l=Q.backgroundColor!=null?Q.backgroundColor:e.granite),n(f)&&(f=Q.indicatorColor!=null?Q.indicatorColor:I?e.white:e.licorice),n(h)&&(h=Q.indicatorScale!=null?Q.indicatorScale:1),n(p)&&(p=Q.indicatorType!=null?Q.indicatorType:I?"aztec":"arrow"),n(_)&&(_=Q.useTicks!=null?Q.useTicks:i!=0),n(b)&&(b=Q.innerTicks!=null?Q.innerTicks:!1),n(C)&&(C=Q.tickStep!=null?Q.tickStep:i||(_?.25:0)),n(O)&&(O=Q.semiTicks!=null?Q.semiTicks:I?3:0),n(w)&&(w=Q.tickColor!=null?Q.tickColor:I?e.tin:l),n(P)&&(P=Q.tickScale!=null?Q.tickScale:I?1.25:1),n(A)&&(A=Q.semiTickScale!=null?Q.semiTickScale:1.25),n(R)&&(R=Q.innerCircle!=null?Q.innerCircle:!0),n(L)&&(L=Q.innerColor!=null?Q.innerColor:I?e.pink:"rgba(0,0,0,.2)"),n(S)&&(S=Q.inner2Color!=null?Q.inner2Color:I?e.light:"rgba(0,0,0,.1)"),n(T)&&(T=Q.innerScale!=null?Q.innerScale:I?.4:.5),n(E)&&(E=Q.accentSize!=null?Q.accentSize:I?o/2*.15:0),n(k)&&(k=Q.accentOffset!=null?Q.accentOffset:o/2*.45),n(V)&&(V=Q.accentDifference!=null?Q.accentDifference:-.25),n(X)&&(X=Q.accentColor!=null?Q.accentColor:e.pink),n(q)&&(q=Q.accentBackgroundColor!=null?Q.accentBackgroundColor:I?e.blue:e.clear),n(B)&&(B=Q.gap!=null?Q.gap:I?.25:0),n(te)&&(te=Q.linear!=null?Q.linear:I),B&&(te=!0,he=!1),n(Z)&&(Z=Q.limit!=null?Q.limit:!0),n(U)&&(U=Q.keyArrows!=null?Q.keyArrows:!0),n(ee)&&(ee=Q.keyArrowsStep!=null?Q.keyArrowsStep:(r-t)/100),n(ae)&&(ae=Q.keyArrowsH!=null?Q.keyArrowsH:!0),n(re)&&(re=Q.keyArrowsV!=null?Q.keyArrowsV:!0),n(he)&&(he=Q.continuous!=null?Q.continuous:!1),he&&(Z=Q.limit!=null?Q.limit:!1),n(y)&&(y=Q.damp!=null?Q.damp:!1),n(g)&&(g=Q.currentValue!=null?Q.currentValue:!1),n(d)&&(d=Q.useLabels!=null?Q.useLabels:!1),n(D)&&(D=Q.labelMargin!=null?Q.labelMargin:10),Z==!1&&(y=null);var ce=this;this.cur("pointer");var pe=J(t,r,i,g);this.veeObj={min:pe[0],max:pe[1],step:pe[2],currentValue:pe[3]};function J(){return arguments}t=e.Pick.choose(t),r=e.Pick.choose(r),i=e.Pick.choose(i);var ue=i;g=e.Pick.choose(g);var ye=o/2,Xe=o,se=t,Ae=0,ie;if(E){var _e=o/2+k+E/2,$=360*B/2;ce.accentBacking=new e.Shape(-ye,-ye,ye*2,ye*2).addTo(this).s(q).ss(E+V).a(0,0,_e,($-90)*e.RAD,(360-$-90)*e.RAD),ie=ce.accent=new e.Shape(-ye,-ye,ye*2,ye*2).addTo(this)}function xe(){ie.c().s(X).ss(E),te?ie.a(0,0,_e,($-90)*e.RAD,(He.rotation-$*2)*e.RAD):ie.a(0,0,_e,($-90)*e.RAD,(He.rotation-90)*e.RAD)}var Be=this.backing=new e.Circle(ye,l,null,null,null,null,null,null,!1);if(E?Be.center(this):this.addChild(Be),R){var me=this.inner=new e.Circle(ye*T,L,null,null,null,null,null,null,!1);this.addChild(me);var Oe=this.inner2=new e.Circle(ye*(T-.1),S,null,null,null,null,null,null,!1);this.addChild(Oe)}I&&(ce.rotation=180);var Ye=Math.abs(r-t)/(C||i)+(B?1:0),de=i?Math.abs(r-t)/i:0;if(_){var ve=this.ticks=new e.Container({style:!1});if(this.addChild(ve),d)var Me=ce.labels=new e.Container(o*2,Xe*2).centerReg(ce);for(var we=0;we<Ye;we++){var Fe=we%(O+1)==0,ge=new e.Rectangle(1,ye*(Fe?.2*P:.1*A),w,null,null,null,null,null,null,!1);if(ge.regY=ye+(b?T-.05:ge.height+ye*.1),ge.regX=.5,ge.rotation=(360-360*B)/(Ye-(B?1:0))*we+360*B/2,ve.addChild(ge),d&&(O&&Fe||!O)){var Ve=Math.max(e.countDecimals(ue),e.countDecimals(t),e.countDecimals(r));new e.Label({text:e.decimals(t+(r-t)/Math.abs(de)*we,Ve+1),size:Q.size?Q.size:10,align:"center",valign:"center"}).centerReg({add:!1}).loc(0,-D-1,ge).addTo(Me)}}ce.expand(ge.height)}this.setBounds(-ye,-ye,o,o);var He,Le;if(p=="dot"||p=="circle")He=this.indicator=new e.Container({style:!1}),Le=this.indicatorShape=new e.Circle(ye*.19,f,null,null,null,null,null,null,!1),He.addChild(Le),e.sca(He,h),He.regY=ye-He.getBounds().width*h/2-ye*.07;else if(p=="line"||p=="rectangle")He=this.indicator=new e.Container({style:!1}),Le=this.indicatorShape=new e.Rectangle(ye*.1,ye*.3,f,null,null,null,null,null,null,null,null,!1),He.addChild(Le),e.sca(He,h),He.regY=ye-He.getBounds().width*h/2-ye*.07,He.regX=ye*.05;else if(p=="aztec"){He=this.indicator=new e.Container({style:!1});var fe=ye*.05,Ge=ye*.1,Qe=ye*.42;Le=this.indicatorShape=new e.Shape(-Ge,0,Ge*2,Qe).f(f).mt(-fe,0).lt(fe,0).lt(Ge,Qe).lt(-Ge,Qe).cp(),He.addChild(Le),e.sca(He,h),He.regY=ye-He.getBounds().width*h/2-ye*.04}else He=this.indicator=new e.Container({style:!1}),Le=this.indicatorShape=new e.Triangle(ye*.4,ye*.4,ye*.4,f,null,null,null,null,null,null,null,!1),He.addChild(Le),e.sca(He,h),He.regY=ye-He.getBounds().height*h*(b?.85:.75),b&&(Le.rotation=180);He.regY/=h,this.addChild(He);function Ke(rt){return i==0?rt:Math.round(rt/i)*i}var st,yt,We,at,ct=0;if(he)var Pe=0,Ie=0,be=0,ze=!1,it=!1,je=!0;if(te)this.on("mousedown",function(rt){if(!(ce.zimAccessibility&&ce.zimAccessibility.aria)){var xt=st=He.rotation,wt=ce.parent.globalToLocal(rt.stageX/e.scaX,rt.stageY/e.scaY);We=ce.on("pressmove",function(_t){var ft=ce.parent.globalToLocal(_t.rawX/e.scaX,_t.rawY/e.scaY);He.rotation=xt=st+(wt.y-ft.y)*100/(this.width||1),Z&&(xt>360-360*B/2||xt<0+360*B/2)&&(xt=e.constrain(xt,360*B/2,360-360*B/2),wt=ce.parent.globalToLocal(_t.rawX/e.scaX,_t.rawY/e.scaY),st=xt),Ue(xt)}),at=this.on("pressup",function(){ce.off("pressmove",We),ce.off("pressup",at)})}});else{var tt=!0;this.on("mousedown",function(rt){if(!(ce.zimAccessibility&&ce.zimAccessibility.aria)){st=He.rotation;var xt=ce.parent.globalToLocal(rt.stageX/e.scaX,rt.stageY/e.scaY),wt=xt.x-ce.x,_t=ce.y-xt.y;yt=Math.atan2(wt,_t)*180/Math.PI;var ft=new Date().getTime();We=ce.on("pressmove",function(Ot){if(ze){var Rt=ce.parent.globalToLocal(Ot.rawX/e.scaX,Ot.rawY/e.scaY),St=Rt.x-ce.x,Gt=ce.y-Rt.y;yt=Math.atan2(St,Gt)*180/Math.PI,st=He.rotation}Rt=ce.parent.globalToLocal(Ot.rawX/e.scaX,Ot.rawY/e.scaY),St=Rt.x-ce.x,Gt=ce.y-Rt.y;var Yt=Math.atan2(St,Gt)*180/Math.PI,$t=st+Yt-yt;$t=($t+360*1e4)%360,Z&&tt&&($t-ct>180&&ce.currentValue!=r?$t=0:$t-ct<-180&&($t=359)),tt=!0,Ue($t),ct=$t}),at=this.on("pressup",function(Ot){ce.currentValue!=ce.min&&ce.currentValue!=ce.max&&(tt=!1);var Rt=new Date().getTime()-ft;if(Rt<200){xt=ce.parent.globalToLocal(Ot.rawX/e.scaX,Ot.rawY/e.scaY),wt=xt.x-ce.x,_t=ce.y-xt.y;var St=Math.atan2(wt,_t)*180/Math.PI-ce.rotation;Ue(St)}st=He.rotation,ce.off("pressmove",We),ce.off("pressup",at)})}})}function Te(rt){return rt>0?1:-1}function et(){ce.zimAccessibility&&ce.zimAccessibility.changeTitle(ce,null,!0)}function Ue(rt){if(he){it&&(Pe=rt,it=!1),rt>Pe+180?be-=360:rt<Pe-180&&(be+=360),Ie=be+rt,je=!1;var xt=ce.currentValue;return ce.currentValue=Ke(Ie*(r-t)/360),xt!=ce.currentValue&&ce.dispatchEvent("change"),Pe=rt,je=!0,ie&&xe(),!0}var wt;rt<0&&(rt+=360),rt=rt%360,i!=0?(rt=Math.min(rt,360),wt=Ke((rt-360*B/2)/(360-360*B)*(r-t)),He.rotation=360*B/2+wt*(360-360*B)/(r-t)):(He.rotation=rt,wt=(rt-360*B/2)/(360-360*B)*(r-t)),wt!=Ae&&(Ae=wt,se=wt+t,ie&&xe(),ce.dispatchEvent("change"),!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&ce.stage&&ce.stage.update()),et()}var Re,Ze;y&&(Re=t,Ze=new e.Damp(Re,y),ce.ticker=e.Ticker.add(function(){Re=Ze.convert(se)})),Object.defineProperty(this,"currentValue",{get:function(){return y?Re:se},set:function(rt){n(rt)||(he?(ze=!1,!n(j)&&!n(G)?j<G?(rt<j&&(rt=j,ze=!0),rt>G&&(rt=G,ze=!0)):(rt>j&&(rt=j,ze=!0),rt<G&&(rt=G,ze=!0)):n(j)?n(G)||rt>G&&(rt=G,ze=!0):rt<j&&(rt=j,ze=!0),je&&(it=!0,be=Math.floor(rt/(r-t))*360)):t<r?(rt<t&&(rt=Z?t:r),rt>r&&(rt=Z?r:t)):(rt>t&&(rt=Z?t:r),rt<r&&(rt=Z?r:t)),se=rt,rt=Ke(rt),y&&y.immediate(se),He.rotation=B*360/2+(rt-t)*(360-B*360)/(r-t),He.rotation=(He.rotation+360*1e4)%360,Ae=rt-t,ct=He.rotation,ie&&xe(),et(),!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&ce.stage&&ce.stage.update())}}),Object.defineProperty(this,"currentValueEvent",{get:function(){return y?Re:se},set:function(rt){rt!=ce.currentValue&&(ce.currentValue=rt,ce.dispatchEvent("change"))}}),Object.defineProperty(this,"min",{get:function(){return t},set:function(rt){he?t=rt:Ct&&ht("Dial() - min is read only")}}),Object.defineProperty(this,"max",{get:function(){return r},set:function(rt){he?r=rt:Ct&&ht("Dial() - max is read only")}}),Object.defineProperty(this,"continuous",{get:function(){return he},set:function(){Ct&&ht("Dial() - continuous is read only")}}),Object.defineProperty(this,"continuousMin",{get:function(){return j},set:function(rt){j=rt,ce.currentValue<j&&(ce.currentValue=j)}}),Object.defineProperty(this,"continuousMax",{get:function(){return G},set:function(rt){G=rt,ce.currentValue>G&&(ce.currentValue=G)}}),Object.defineProperty(this,"step",{get:function(){return i},set:function(){Ct&&ht("Dial() - step is read only")}}),Object.defineProperty(this,"keyArrowsH",{get:function(){return ae},set:function(rt){ae=rt}}),Object.defineProperty(this,"keyArrowsV",{get:function(){return re},set:function(rt){re=rt}}),le.KEYFOCUS!=null&&(e.KEYFOCUS=le.KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return e.KEYFOCUS==ce},set:function(){e.KEYFOCUS=ce}}),U&&!e.KEYFOCUS&&Je(),this.on("mousedown",function(){U&&Je()});function Je(){ce.keyFocus=!0;var rt=document.activeElement;rt&&rt.blur()}var nt=!1,pt=!1,De=!1,lt=!1;this.keyDownEvent=function(rt){ce.stage&&(ce.zimAccessibility&&ce.focus||!ce.zimAccessibility&&ce.keyFocus)&&(rt.keyCode==37&&ae?nt=!0:rt.keyCode==40&&re?pt=!0:rt.keyCode==39&&ae?De=!0:rt.keyCode==38&&re&&(lt=!0),ce.keyInterval==null&&(nt||pt||De||lt)&&(vt(),ce.keyTimeout=setTimeout(function(){ce.keyInterval==null&&(nt||pt||De||lt)&&(ce.keyInterval=setInterval(vt,40))},140)))};function vt(){(nt||pt)&&(i>0?ce.currentValueEvent-=i*Te(r-t):ce.currentValueEvent-=ee*Te(r-t)),(De||lt)&&(i>0?ce.currentValueEvent+=i*Te(r-t):ce.currentValueEvent+=ee*Te(r-t))}le.addEventListener("keydown",this.keyDownEvent),ce.keyUpEvent=function(rt){rt.keyCode==37?nt=!1:rt.keyCode==40?pt=!1:rt.keyCode==39?De=!1:rt.keyCode==38&&(lt=!1),ce.keyInterval!=null&&!nt&&!pt&&!De&&!lt&&(clearInterval(ce.keyInterval),ce.keyInterval=null)},le.addEventListener("keyup",this.keyUpEvent),this._enabled=!0,Object.defineProperty(ce,"enabled",{get:function(){return ce._enabled},set:function(rt){rt?(le.addEventListener("keydown",ce.keyDownEvent),le.addEventListener("keyup",ce.keyUpEvent)):(le.removeEventListener("keydown",ce.keyDownEvent),le.removeEventListener("keyup",ce.keyUpEvent)),ce._enabled=rt}}),n(g)&&(g=Q.currentValue!=null?Q.currentValue:t),ce.currentValue=g,K!==!1&&e.styleTransforms(this,Q),this.clone=function(rt){return ce.cloneProps(new e.Dial(rt||!e.isPick(pe[0])?ce.min:pe[0],rt||!e.isPick(pe[1])?ce.max:pe[1],rt||!e.isPick(pe[2])?ce.step:pe[2],o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B,Z,U,ee,ae,re,he,j,G,y,rt||!e.isPick(pe[3])?ce.currentValue:pe[3],d,D,K,this.group,F))},this.dispose=function(rt,xt,wt){return le.removeEventListener("keydown",ce.keyDownEvent),le.removeEventListener("keyup",ce.keyUpEvent),wt||this.zimContainer_dispose(!0),!0}},e.extend(e.Dial,e.Container,["clone","dispose"],"zimContainer",!1),e.Tabs=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B,Z,U,ee,ae,re,he,j,G,y,g,d,D,K,m,F,Ce,Y,Q,ce,pe,J,ue){var ye="width, height, tabs, backgroundColor, rollBackgroundColor, downBackgroundColor, selectedBackgroundColor, selectedRollBackgroundColor, color, rollColor, downColor, selectedColor, selectedRollColor, vertical, spacing, currentEnabled, currentSelected, corner, base, keyEnabled, gradient, gloss, backing, rollBacking, wait, waitTime, waitBackgroundColor, rollWaitBackgroundColor, waitColor, rollWaitColor, waitModal, waitEnabled, backdropColor, align, valign, labelAlign, labelValign, labelIndent, labelIndentH, labelIndentV, indent, useTap, excludeCustomTap, selectedIndex, styleLabels, keyWrap, style, group, inherit",Xe;if(Xe=mt(e.Tabs,arguments,ye,this))return Xe;qe("65");var se=pe===!1?{}:e.getStyle("Tabs",J,ue);n(P)&&(P=se.vertical!=null?se.vertical:!1),n(t)&&(t=se.width!=null?se.width:null);var Ae=!n(t);if(n(t)&&(t=P?60:240),n(r)&&(r=se.height!=null?se.height:P?240:60),this.zimContainer_constructor(null,null,null,null,!0),this.type="Tabs",this.group=J,(n(i)||i.length<=0)&&(i=se.tabs!=null?se.tabs:[1,2,3,4]),n(o)&&(o=se.backgroundColor!=null?se.backgroundColor:e.tin),n(l)&&(l=se.rollBackgroundColor!=null?se.rollBackgroundColor:e.grey),n(f)&&(f=se.downBackgroundColor!=null?se.downBackgroundColor:l),n(h)&&(h=se.selectedBackgroundColor!=null?se.selectedBackgroundColor:e.dark),n(p)&&(p=se.selectedRollBackgroundColor!=null?se.selectedRollBackgroundColor:l),n(_)&&(_=se.color!=null?se.color:e.white),n(b)&&(b=se.rollColor!=null?se.rollColor:_),n(w)&&(w=se.downColor!=null?se.downColor:b),n(C)&&(C=se.selectedColor!=null?se.selectedColor:_),n(O)&&(O=se.selectedRollColor!=null?se.selectedRollColor:b),n(q)&&(q=se.backing!=null?se.backing.clone():null),n(V)&&(V=se.rollBacking!=null?se.rollBacking.clone():null),n(j)&&(j=se.align!=null?se.align:"center"),n(G)&&(G=se.valign!=null?se.valign:"center"),n(y)&&(y=se.labelAlign!=null?se.labelAlign:j),n(g)&&(g=se.labelValign!=null?se.labelValign:G),n(m)&&(m=se.indent!=null?se.indent:10),n(d)&&(d=se.labelIndent!=null?se.labelIndent:m),n(D)&&(D=se.labelIndentH!=null?se.labelIndentH:d),n(K)&&(K=se.labelIndentV!=null?se.labelIndentV:d),n(R)&&(R=se.currentEnabled!=null?se.currentEnabled:!1),n(T)&&(T=se.currentSelected!=null?se.currentSelected:!0),T||(R=!0),n(A)&&(A=se.spacing!=null?se.spacing:1),n(L)&&(L=se.corner!=null?se.corner:0),n(k)&&(k=se.gradient!=null?se.gradient:null),n(X)&&(X=se.gloss!=null?se.gloss:null),n(S)&&(S=se.base!=null?se.base:L==0&&!Array.isArray(L)?"none":P?"left":"bottom"),n(E)&&(E=se.keyEnabled!=null?se.keyEnabled:!0),n(F)&&(F=se.useTap!=null?se.useTap:!1),n(Ce)&&(Ce=se.excludeCustomTap!=null?se.excludeCustomTap:!1),n(he)&&(he=se.backdropColor!=null?se.backdropColor:null),n(Q)&&(Q=se.styleLabels!=null?se.styleLabels:!1),n(ce)&&(ce=se.keyWrap!=null?se.keyWrap:!0),S!="none"&&L!=0&&!Array.isArray(L))switch(S){case"bottom":L=[L,L,0,0];break;case"left":L=[0,L,L,0];break;case"top":L=[0,0,L,L];break;case"right":L=[L,0,0,L];break}else Array.isArray(L)||(L=[L,L,L,L]);var ie=this;this.keyEnabled=E;var _e=0,$=[],xe=[],Be,me,Oe=i.length,Ye=(t-A*(Oe-1))/Oe,de=(r-A*(Oe-1)-2)/Oe;if(!n(he)){var ve=this.backdrop=new e.Rectangle(t,r,he,null,null,null,null,null,null,!1);this.addChild(ve)}var Me=!1,we;function Fe(Ie){for(var be=0;be<Ie.length;be++){var ze=Ie[be];if(ze.constructor==={}.constructor){we&&we!="TabObject"&&(Me=!0),we="TabObject",ze.type="TabObject";continue}typeof ze=="string"||typeof ze=="number"||ze.type=="Label"?(Ie[be]={type:"TabObject",label:String(ze!=null)||ze.type=="Label"?ze:"1"},we&&we!="TabObject"&&(Me=!0),we="TabObject"):(we&&we=="TabObject"&&(Me=!0),we="Other")}}Fe(i);for(var ge=0,Ve,He=0,Le=0;Le<i.length;Le++)me=i[Le],P?Ae&&(me.width=me.width?me.width:t):(n(me.width)&&He++,ge+=n(me.width)?Ye:me.width);if(!P){if(ge>t-A*(Oe-1))for(Le=0;Le<i.length;Le++)me=i[Le],me.width=(t-A*(Oe-1))/ge*(n(me.width)?Ye:me.width);else if(Math.round(ge)<Math.round(t-A*(Oe-1))&&He>0)for(Ve=(Oe*Ye-(ge-He*Ye))/He,Le=0;Le<i.length;Le++)me=i[Le],me.width=n(me.width)?Ve:me.width}function fe(Ie,be){for(Le=0;Le<Ie.length;Le++)me=Ie[Le],me!=""&&me.type=="TabObject"&&(n(me.label)&&(me.label=" "),(typeof me.label=="string"||typeof me.label=="number")&&(me.label=new e.Label({text:me.label,size:se.size!=null?se.size:P?de/2:r/2,font:se.font!=null?se.font:null,style:Q,valign:g,inherit:be})))}fe(i,Q?se:null);var Ge=0;for(Le=0;Le<i.length;Le++)me=i[Le],!me.width&&P&&me.label.width>Ge&&(Ge=me.label.width);var Qe=0;function Ke(Ie,be){var ze=[],it=[];for(Le=0;Le<Ie.length;Le++){if(me=Ie[Le],me.type=="TabObject"){var je={color:n(me.color)?e.Pick.choose(_):me.color,rollColor:n(me.rollColor)?e.Pick.choose(b):me.rollColor,downColor:n(me.downColor)?e.Pick.choose(w):me.downColor,selectedColor:n(me.selectedColor)?e.Pick.choose(C):me.selectedColor,selectedRollColor:n(me.selectedRollColor)?e.Pick.choose(O):me.selectedRollColor,backgroundColor:n(me.backgroundColor)?e.Pick.choose(o):me.backgroundColor,rollBackgroundColor:n(me.rollBackgroundColor)?e.Pick.choose(l):me.rollBackgroundColor,downBackgroundColor:n(me.downBackgroundColor)?e.Pick.choose(f):me.downBackgroundColor,selectedBackgroundColor:n(me.selectedBackgroundColor)?e.Pick.choose(h):me.selectedBackgroundColor,selectedRollBackgroundColor:n(me.selectedRollBackgroundColor)?e.Pick.choose(p):me.selectedRollBackgroundColor,wait:n(me.wait)?e.Pick.choose(I):me.wait};if(be)for(var tt in be)n(be[tt])||(je[tt]=be[tt]);Be=new e.Button({width:P?n(me.width)?Ae?t:Ge+de/2+L[0]/2:me.width:n(me.width)?Ye:me.width,height:P?de:r,label:me.label,borderColor:se.borderColor!=null?se.borderColor:null,borderWidth:se.borderWidth!=null?se.borderWidth:null,backgroundColor:je.backgroundColor,rollBackgroundColor:je.rollBackgroundColor,downBackgroundColor:je.downBackgroundColor,downColor:je.downColor,corner:L,shadowColor:-1,gradient:k,gloss:X,backing:q?q.clone():null,rollBacking:V?V.clone():null,wait:je.wait,waitTime:n(me.waitTime)?te:me.waitTime,waitBackgroundColor:n(me.waitBackgroundColor)?B:me.waitBackgroundColor,rollWaitBackgroundColor:n(me.rollWaitBackgroundColor)?Z:me.rollWaitBackgroundColor,waitColor:n(me.waitColor)?U:me.waitColor,rollWaitColor:n(me.rollWaitBackgroundColor)?ee:me.rollWaitColor,waitModal:n(me.waitModal)?ae:me.waitModal,waitEnabled:n(me.waitEnabled)?re:me.waitEnabled,align:y,valign:g,indentH:D,indentV:K,inherit:e.copy(se)}),Be.tabInfo=je,Be.color=Be.tabInfo.color,Be.rollColor=Be.tabInfo.rollColor,Be.type="TabsButton",Be.content=me,Be.listIndentReady=!0}else{if(me.listIndentReady)Be=me;else{Be=new e.Container,Be.type=me.type,Be.content=me;for(var Te=["text","backing","label","slider","stepper","checkBox","colorPicker","swatch","colorLabel"],et=0;et<Te.length;et++)me[Te[et]]&&(Be[Te[et]]=me[Te[et]])}me.checkBox&&(Be.checkBox=me.checkBox),n(Be.tabInfo)&&(Be.tabInfo={}),Ce&&(Be.excludeTap=!0),Be.tabInfo.color=n(me.color)?_:me.color,Be.tabInfo.backgroundColor=n(me.backgroundColor)?o:me.backgroundColor,me.listIndentReady||(new e.Rectangle(Math.max(me.width,P?Ae?t:Ge+de/2+L[0]/2:me.width),Math.max(me.height,P?de:r),e.clear).addTo(Be).expand(0).cur(),me.center(Be).cur(),j=="center"||j=="middle"||me.pos(0,null,j=="right"),G=="center"||G=="middle"||me.pos(null,0,null,G=="bottom"),Be.listIndentReady=!0)}Be.width>Qe&&(Qe=Be.width),F?Be.tap(function(Ue){We(Ue.currentTarget.znum),ie.dispatchEvent("change"),!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&ie.stage&&ie.stage.update()}):Be.zimTabEvent=Be.on((Dt?e.ACTIONEVENT=="mousedown":le.ACTIONEVENT=="mousedown")?"mousedown":"click",function(Ue){We(Ue.currentTarget.znum),ie.dispatchEvent("change"),!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&ie.stage&&ie.stage.update()}),Be.on("mousedown",function(Ue){ie.buttonDown=Ue.currentTarget}),Be.on("pressup",function(Ue){ie.buttonDown=null;var Re=Ue.currentTarget.znum;F||e.ACTIONEVENT=="click"?setTimeout(function(){at(Re)},50):at(Re)}),it.push(me.label),ze.push(Be),Be.index=Le}return[ze,it]}var st=Ke(i);xe=st[0],$=st[1];function yt(){var Ie=0,be=0,ze;for(Le=0;Le<xe.length;Le++)ze=xe[Le],ze.znum=Le,ze.selectedIndex=Le,ze.selectedIndex==_e&&T&&(ze.backgroundColor=h,ze.rollBackgroundColor=p,ze.color=C),$[Le]&&($[Le].znum=Le),ie.addChild(ze),(!P||Ae)&&(ze.x=(t-ze.width)/2,ze.y=(r-ze.height)/2),P?(ze.y=be,be=ze.y+ze.height+A,j=="left"?ze.x=(ze.type=="TabsButton"||ze.type=="ListItem"?0:m)+(ze.regX-(ze.getBounds()?ze.getBounds().x:0))*ze.scaleX:j=="right"&&(ze.x=(Ae?t:Qe)-ze.width-(ze.type=="TabsButton"||ze.type=="ListItem"?0:m))):(ze.x=Ie,Ie=ze.x+ze.width+A,G=="top"?ze.y=(ze.type=="TabsButton"&&!Me?0:m)+(ze.regY-(ze.getBounds()?ze.getBounds().y:0))*ze.scaleY:G=="bottom"&&(ze.y=r-ze.height-(ze.type=="TabsButton"&&!Me?0:m))),Le==_e&&!R?ze.enabled=!1:ze.enabled=!0;n(he)||ie.removeChild(ve),ie._bounds=null;var it=ie.getBounds(),je=0,tt=0;if(!it&&$e.EaselJS.version[0]!=0?ie.setBounds():it&&(je=P&&it.width!=0&&Ae?t:it.width,tt=P&&it.height!=0?it.height:r,ie.setBounds(je,tt)),n(he)||(ve.widthOnly=je,ve.heightOnly=tt,ie.addChildAt(ve,0)),P&&!Ae)for(Le=0;Le<=xe.length;Le++)(j=="center"||j=="middle")&&(ze.x=(je-ze.width)/2)}yt();function We(Ie,be){if(Ie!=_e){var ze=xe[_e];if(ze&&T&&(ze.tabInfo&&n(ze.tabInfo.wait)&&(ze.tabInfo.backgroundColor&&(ze.backgroundColor=ze.tabInfo.backgroundColor),ze.tabInfo.rollBackgroundColor&&(ze.rollBackgroundColor=ze.tabInfo.rollBackgroundColor),ze.tabInfo.color&&ze.label&&(ze.color=ze.tabInfo.color),ze.tabInfo.rollColor&&ze.label&&(ze.rollColor=ze.tabInfo.rollColor)),R||(ze.enabled=!0)),_e=Ie,ze=xe[_e],ze){var it=ze.tabInfo;it&&n(ze.tabInfo.wait)&&T&&(it.selectedBackgroundColor&&(ze.backgroundColor=!n(it.downBackgroundColor)&&!be?it.downBackgroundColor:it.selectedBackgroundColor),it.selectedRollBackgroundColor&&(ze.rollBackgroundColor=it.selectedRollBackgroundColor),it.selectedColor&&ze.label&&(ze.color=!n(it.downColor)&&!be?it.downColor:it.selectedColor),it.selectedRollColor&&ze.label&&(ze.rollColor=it.selectedRollColor)),be&&!R&&(ze.enabled=!1)}}}function at(Ie){var be=xe[Ie];if(be&&T){var ze=be.tabInfo;ze&&n(ze.wait)&&(ze.selectedBackgroundColor&&(be.backgroundColor=ie.selected==be?ze.selectedBackgroundColor:ze.backgroundColor),ze.selectedColor&&be.label&&(be.color=ie.selected==be?ze.selectedColor:ze.color)),R||(be.enabled=!1)}}this.addAt=function(Ie,be,ze){n(be)&&(be=xe.length),be=e.constrain(be,0,xe.length),Array.isArray(Ie)||(Ie=[Ie]),Fe(Ie),fe(Ie,ze);var it=Ke(Ie,ze),je=it[0],tt=it[1];be<=_e&&(_e+=je.length);var Te=[be,0].concat(je);return Array.prototype.splice.apply(xe,Te),Te=[be,0].concat(tt),Array.prototype.splice.apply($,Te),yt(),ie},this.removeAt=function(Ie,be){if(xe.length==0)return ie;for(n(Ie)&&(Ie=1),n(be)&&(be=xe.length-Ie),be=e.constrain(be,0,xe.length-Ie),_e>=be&&_e<=be+Ie&&(_e=-1),_e>be+Ie&&(_e-=Ie),Le=be;Le<be+Ie;Le++)xe[Le].tabInfo&&(xe[Le].tabInfo.backgroundColor&&(xe[Le].backgroundColor=xe[Le].tabInfo.backgroundColor),xe[Le].tabInfo.color&&xe[Le].label&&(xe[Le].color=xe[Le].tabInfo.color)),F?xe[Le].noTap():xe[Le].off((Dt?e.ACTIONEVENT=="mousedown":le.ACTIONEVENT=="mousedown")?"mousedown":"click",xe[Le].zimTabEvent),xe[Le].removeFrom();return xe.splice(be,Ie),$.splice(be,Ie),yt(),ie},ie.keyEvent=function(Ie){if(!(!ie.keyEnabled||!ie.keyFocus||ie.zimAccessibility)&&Ie.keyCode==9){var be=_e;Ie.shiftKey?We(--be<0?ce?i.length-1:0:be):We(++be>i.length-1?ce?0:i.length-1:be),ie.dispatchEvent("change"),ie.dispatchEvent("keychange"),!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&ie.stage&&ie.stage.update(),Ie.preventDefault()}},le.addEventListener("keydown",ie.keyEvent),Object.defineProperty(this,"selected",{get:function(){return xe[_e]},set:function(){Ct&&ht("Tabs() - selected is read only - try selectedIndex")}}),Object.defineProperty(this,"selectedIndex",{get:function(){return _e},set:function(Ie){We(Ie,!0),!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&ie.stage&&ie.stage.update()}}),this.last=function(){return this.selectedIndex=this.buttons.length-1,this},this.first=function(){return this.selectedIndex=0,this},Object.defineProperty(this,"tabs",{get:function(){return _e},set:function(Ie){We(Math.min(Math.max(Ie,0),i.length-1)),!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&ie.stage&&ie.stage.update()}}),Object.defineProperty(this,"color",{get:function(){return ie.buttons[0].tabItems?ie.buttons[0].tabItems.color:_},set:function(Ie){if(_=Ie,ie.buttons[0].tabInfo){for(var be=0;be<ie.buttons.length;be++)ie.buttons[be].tabInfo&&(ie.buttons[be].tabInfo.color=Ie),(be!=_e||!T)&&(ie.buttons[be].color=_);!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&ie.stage&&ie.stage.update()}}}),Object.defineProperty(this,"rollColor",{get:function(){return ie.buttons[0].tabItems?ie.buttons[0].tabItems.rollColor:b},set:function(Ie){if(b=Ie,ie.buttons[0].tabInfo){for(var be=0;be<ie.buttons.length;be++)ie.buttons[be].tabInfo&&(ie.buttons[be].tabInfo.rollColor=Ie),ie.buttons[be].rollColor=b,be!=_e&&ie.buttons[be].rolled&&(ie.buttons[be].color=b);!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&ie.stage&&ie.stage.update()}}}),Object.defineProperty(this,"selectedColor",{get:function(){return ie.buttons[0].tabItems?ie.buttons[0].tabItems.selectedColor:C},set:function(Ie){if(C=Ie,ie.buttons[0].tabInfo){for(var be=0;be<ie.buttons.length;be++)ie.buttons[be].tabInfo&&(ie.buttons[be].tabInfo.selectedColor=Ie),be==_e&&T&&(ie.buttons[be].color=C);!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&ie.stage&&ie.stage.update()}}}),Object.defineProperty(this,"selectedRollColor",{get:function(){return ie.buttons[0].tabItems?ie.buttons[0].tabItems.selectedRollColor:O},set:function(Ie){if(O=Ie,ie.buttons[0].tabInfo){for(var be=0;be<ie.buttons.length;be++)ie.buttons[be].tabInfo&&(ie.buttons[be].tabInfo.selectedRollColor=Ie),be==_e&&T&&ie.buttons[be].rolled&&(ie.buttons[be].color=O);!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&ie.stage&&ie.stage.update()}}}),Object.defineProperty(this,"backgroundColor",{get:function(){return ie.buttons[0].tabItems?ie.buttons[0].tabItems.backgroundColor:o},set:function(Ie){if(o=Ie,ie.buttons[0].tabInfo){for(var be=0;be<ie.buttons.length;be++)ie.buttons[be].tabInfo&&(ie.buttons[be].tabInfo.backgroundColor=Ie),(be!=_e||!T)&&(ie.buttons[be].backgroundColor=o);!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&ie.stage&&ie.stage.update()}}}),Object.defineProperty(this,"rollBackgroundColor",{get:function(){return ie.buttons[0].tabItems?ie.buttons[0].tabItems.rollBackgroundColor:l},set:function(Ie){if(l=Ie,ie.buttons[0].tabInfo){for(var be=0;be<ie.buttons.length;be++)ie.buttons[be].tabInfo&&(ie.buttons[be].tabInfo.rollBackgroundColor=Ie),ie.buttons[be].rollBackgroundColor=l,be!=_e&&ie.buttons[be].rolled&&(ie.buttons[be].backgroundColor=l);!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&ie.stage&&ie.stage.update()}}}),Object.defineProperty(this,"selectedBackgroundColor",{get:function(){return ie.buttons[0].tabItems?ie.buttons[0].tabItems.selectedBackgroundColor:h},set:function(Ie){if(h=Ie,ie.buttons[0].tabInfo){for(var be=0;be<ie.buttons.length;be++)ie.buttons[be].tabInfo&&(ie.buttons[be].tabInfo.selectedBackgroundColor=Ie),be==_e&&T&&(ie.buttons[be].backgroundColor=h);!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&ie.stage&&ie.stage.update()}}}),Object.defineProperty(this,"selectedRollBackgroundColor",{get:function(){return ie.buttons[0].tabItems?ie.buttons[0].tabItems.selectedRollBackgroundColor:p},set:function(Ie){if(p=Ie,ie.buttons[0].tabInfo){for(var be=0;be<ie.buttons.length;be++)ie.buttons[be].tabInfo&&(ie.buttons[be].tabInfo.selectedRollBackgroundColor=Ie),be==_e&&T&&ie.buttons[be].rolled&&(ie.buttons[be].backgroundColor=p);!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&ie.stage&&ie.stage.update()}}}),Object.defineProperty(this,"label",{get:function(){return $[_e]},set:function(){Ct&&ht("Tabs() - selected is read only - try selectedIndex")}}),Object.defineProperty(this,"text",{get:function(){return $[_e]!=null?$[_e].text:void 0},set:function(){Ct&&ht("Tabs() - selected is read only - try selectedIndex")}}),Object.defineProperty(this,"buttons",{get:function(){return xe},set:function(){Ct&&ht("Tabs() - buttons is read only")}}),Object.defineProperty(this,"labels",{get:function(){return $},set:function(){Ct&&ht("Tabs() - labels is read only")}}),this._enabled=!0,Object.defineProperty(ie,"enabled",{get:function(){return ie._enabled},set:function(Ie){c(ie,Ie)}}),le.KEYFOCUS!=null&&(e.KEYFOCUS=le.KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return e.KEYFOCUS==ie},set:function(){e.KEYFOCUS=ie}}),E&&e.KEYFOCUS&&ct(),this.on("mousedown",function(){E&&ct()});function ct(){ie.keyFocus=!0;var Ie=document.activeElement;Ie&&Ie.blur()}var Pe=ie.getBounds();n(Pe)||Pe.width==0?ie.setBounds(0,0,t,r):ie.width=t,n(Y)&&(Y=se.selectedIndex!=null?se.selectedIndex:0),ie.selectedIndex=Y,pe!==!1&&e.styleTransforms(this,se),this.clone=function(){for(var Ie=e.copy(i,!0),be=0;be<Ie.length;be++)Ie[be].label=Ie[be].label.clone();return ie.cloneProps(new e.Tabs(t,r,Ie,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B,Z,U,ee,ae,re,he,j,G,y,g,d,D,K,m,F,Ce,Y,Q,ce,pe,this.group,ue))},this.doDispose=function(Ie,be,ze){ie.keyEvent&&le.removeEventListener("keydown",ie.keyEvent),e.loop(ie.buttons,function(it){it.dispose()}),ie.keyEvent=null,ze||this.zimContainer_dispose(!0),T=me=i=$=Be=xe=st=null}},e.extend(e.Tabs,e.Container,["clone","dispose"],"zimContainer",!1),e.Tabs.prototype.dispose=function(t){return this.doDispose(null,null,t)},e.Pad=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B,Z,U,ee,ae,re,he,j,G){var y="width, cols, rows, keys, backgroundColor, rollBackgroundColor, downBackgroundColor, selectedBackgroundColor, selectedRollBackgroundColor, color, rollColor, downColor, selectedColor, selectedRollColor, spacing, currentEnabled, currentSelected, corner, labelColor, gradient, gloss, backing, rollBacking, wait, waitTime, waitBackgroundColor, rollWaitBackgroundColor, waitColor, rollWaitColor, waitModal, waitEnabled, selectedIndex, style, group, inherit",g;if(g=mt(e.Pad,arguments,y,this))return g;qe("66"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Pad",this.group=j;var d=he===!1?{}:e.getStyle(this.type,this.group,G);n(t)&&(t=d.width!=null?d.width:150),n(r)&&(r=d.cols!=null?d.cols:3),n(i)&&(i=d.rows!=null?d.rows:r);var D;if(n(o))if(d.keys!=null)o=d.keys;else for(o=[],D=1;D<=i*r;D++)o.push(D);n(R)&&(R=d.currentEnabled!=null?d.currentEnabled:!0),n(A)&&(A=d.spacing!=null?d.spacing:1);var K=this,m;this.cols=r,this.rows=i;var F=t/r-A,Ce=[],Y=0,Q;for(this.labels=[],this.buttons=[],D=0;D<i;D++){for(var ce=[],pe=0;pe<r;pe++)ce.push(o[Y]!=null?o[Y]:""),Y++;var J=d.corner!=null?d.corner:L;J&&!Array.isArray(J)&&(J=[J,J,J,J]),Q=Ce[D]=new e.Tabs({width:t,height:F,tabs:ce,backgroundColor:d.backgroundColor!=null?d.backgroundColor:l,rollBackgroundColor:d.rollBackgroundColor!=null?d.rollBackgroundColor:f,downBackgroundColor:d.downBackgroundColor!=null?d.downBackgroundColor:h,selectedBackgroundColor:d.selectedBackgroundColor!=null?d.selectedBackgroundColor:p,color:d.color!=null?d.color:b,rollColor:d.rollColor!=null?d.rollColor:w,downColor:d.downColor!=null?d.downColor:C,selectedColor:d.selectedColor!=null?d.selectedColor:O,spacing:d.spacing!=null?d.spacing:A,currentEnabled:d.currentEnabled!=null?d.currentEnabled:R,currentSelected:d.currentSelected!=null?d.currentSelected:T,corner:J,backing:d.backing!=null?d.backing.clone():X,rollBacking:d.rollBacking!=null?d.rollBacking.clone():q,base:null,keyEnabled:!1,gradient:d.gradient!=null?d.gradient:E,gloss:d.gloss!=null?d.gloss:k,wait:d.wait!=null?d.wait:V,waitTime:d.waitTime!=null?d.waitTime:I,waitBackgroundColor:d.waitBackgroundColor!=null?d.waitBackgroundColor:te,rollWaitBackgroundColor:d.rollWaitBackgroundColor!=null?d.rollWaitBackgroundColor:B,waitColor:d.waitColor!=null?d.waitColor:Z,rollWaitColor:d.rollWaitColor!=null?d.rollWaitColor:U,waitModal:d.waitModal!=null?d.waitModal:ee,waitEnabled:d.waitEnabled!=null?d.waitEnabled:ae,group:j,style:!1}),this.labels=this.labels.concat(Q.labels),this.buttons=this.buttons.concat(Q.buttons),this.addChild(Q),Q.selectedIndex=-1,Q.y=(F+A)*D,Q.znum=D,Q.on("change",ue)}this.tabs=Ce;function ue(ye){var Xe=ye.target;K.selected=Xe.selected,K.text=Xe.text,K.label=Xe.label;for(var se=Xe.selectedIndex,Ae=0;Ae<Ce.length;Ae++)Xe!=Ce[Ae]&&(Ce[Ae].selectedIndex=-1);m=Xe.znum*r+se,K.dispatchEvent("change"),!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&K.stage&&K.stage.update()}Object.defineProperty(this,"selectedIndex",{get:function(){return m},set:function(ye){m=ye;for(var Xe=0;Xe<Ce.length;Xe++)Ce[Xe].selectedIndex=-1;var se=Math.floor(m/r);se>=0&&se<K.tabs.length&&(K.tabs[se].selectedIndex=m%r)}}),this._enabled=!0,Object.defineProperty(K,"enabled",{get:function(){return K._enabled},set:function(ye){c(K,ye)}}),n(re)&&(re=d.selectedIndex!=null?d.selectedIndex:0),K.selectedIndex=re,he!==!1&&e.styleTransforms(this,d),this.clone=function(){return K.cloneProps(new e.Pad(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B,Z,U,ee,ae,re,he,this.group,G))},this.dispose=function(ye,Xe,se){e.loop(Ce,function(Ae){Ae.dispose()}),this.labels=this.buttons=this.tabs=null,Q=Ce=K.rowTabs=null,se||this.zimContainer_dispose(!0)}},e.extend(e.Pad,e.Container,["clone","dispose"],"zimContainer",!1),e.NumPad=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q){var V="advanced, titleBar, titleBarColor, titleBarBackgroundColor, titleBarHeight, backgroundColor, borderColor, borderWidth, corner, numberCorner, close, closeColor, collapse, collapseColor, collapsed, align, shadowColor, shadowBlur, draggable, boundary, style, group, inherit",I;if(I=mt(e.NumPad,arguments,V,this))return I;qe("57.7"),this.group=X;var te=k===!1?{}:e.getStyle("NumPad",this.group,q);n(t)&&(t=te.advanced!=null?te.advanced:!1);var B=400,Z=t?620:530;n(r)&&(r=te.titleBar!=null?te.titleBar:"NUMPAD"),n(i)&&(i=te.titleBarColor!=null?te.titleBarColor:e.white),n(o)&&(o=te.titleBarBackgroundColor!=null?te.titleBarBackgroundColor:e.grey),n(l)&&(l=te.titleBarHeight!=null?te.titleBarHeight:40),n(f)&&(f=te.backgroundColor!=null?te.backgroundColor:e.darker),n(h)&&(h=te.borderColor!=null?te.borderColor:e.pewter),n(p)&&(p=te.borderWidth!=null?te.borderWidth:null),h<0||p<0?h=p=null:h!=null&&p==null&&(p=1),n(_)&&(_=te.corner!=null?te.corner:15),n(b)&&(b=te.numberCorner!=null?te.numberCorner:30),n(R)&&(R=te.align!=null?te.align:"left"),n(T)&&(T=te.shadowColor!=null?te.shadowColor:"rgba(0,0,0,.3)"),n(L)&&(L=te.shadowBlur!=null?te.shadowBlur:14),n(S)&&(S=te.draggable!=null?te.draggable:!0),n(E)&&(E=te.boundary!=null?te.boundary:null),n(w)&&(w=te.close!=null?te.close:!0),n(C)&&(C=te.closeColor!=null?te.closeColor:n(i)?e.grey:i),Array.isArray(_)||(_=[_,_,_,_]),n(O)&&(O=te.collapse!=null?te.collapse:!0),n(P)&&(P=te.collapseColor!=null?te.collapseColor:n(i)?e.grey:i),n(A)&&(A=te.collapsed!=null?te.collapsed:!1),this.zimPanel_constructor(B,Z,null,r,i,o,l,f,h,p,_,w,C,null,null,null,O,P,A,R,T,L,S,E,k,X,q),this.type="NumPad";var U=this;function ee(re,he){return n(he)&&(he=mist),{label:re,backgroundColor:he,rollBackgroundColor:white,color:darker,rollColor:darker}}var ae=[ee("C",e.red.darken(.1)),ee(new e.Label({text:"\u2423",size:90,shiftV:-24}),e.yellow.darken(.1)),ee(new e.Label({text:"/",size:48,bold:!0,shiftV:3})),ee(new e.Label({text:"*",size:65,shiftV:18})),1,2,3,ee(new e.Label({text:"-",size:60,shiftV:-3})),4,5,6,ee(new e.Label({text:"+",size:55,shiftV:3})),7,8,9,ee(new e.Label({text:"\u232B",size:M=="ios"?60:35}),e.red.darken(.1)),ee(new e.Label({text:",",size:70,shiftV:-3})),ee(new si({text:".",size:70,shiftV:-3})),0,ee(new e.Label({text:"\u23CE",size:M=="ios"?40:50,shiftV:5}),e.green.darken(.1))];t&&(ae.splice(2,0,ee("%",yellow.darken(.1))),ae.splice(4,0,ee(new e.Label({text:"^",size:47,shiftV:10}),yellow.darken(.1))),ae.splice(4,0,ee(")",yellow.darken(.1))),ae.splice(4,0,ee("(",yellow.darken(.1)))),U.pad=new e.Pad({width:380,cols:4,rows:t?6:5,keys:ae,spacing:6,currentSelected:!1,backgroundColor:e.grey,rollBackgroundColor:e.tin,selectedBackgroundColor:e.grey,downBackgroundColor:e.green,corner:b}),U.pad.on("mousedown",function(){U.pad.text=="C"?U.key="clear":U.pad.text=="\u2423"?U.key="space":U.pad.text=="\u232B"?U.key="backspace":U.pad.text=="\u23CE"?U.key="enter":U.key=U.pad.text,U.dispatchEvent("pressed")}),U.add(U.pad,null,!0),k!==!1&&e.styleTransforms(this,te),this.clone=function(){return U.cloneProps(new e.NumPad(t,r?r.clone():"",i,o,l,f,h,p,_,b,w,C,O,P,U.collapsed,R,T,L,S,E,k,this.group,q))}},e.extend(e.NumPad,e.Panel,["clone"],"zimPanel",!1),e.DPad=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T){var L="axis, width, backgroundColor, borderWidth, borderColor, indicatorColor, indicatorPressColor, indicatorScale, indicatorRadius, innerCircle, innerScale, activeRadius, clamp, logo, style, group, inherit",S;if(S=mt(e.DPad,arguments,L,this))return S;qe("66.2"),this.zimContainer_constructor(null,null,null,null,!1),this.type="DPad",this.group=R;var E=A===!1?{}:e.getStyle(this.type,this.group,T);n(t)&&(t=E.axis!=null?E.axis:"all"),n(r)&&(r=E.width!=null?E.width:100),n(i)&&(i=E.backgroundColor!=null?E.backgroundColor:e.granite),n(l)&&(l=E.borderColor!=null?E.borderColor:null),n(o)&&(o=E.borderWidth!=null?E.borderWidth:null),l<0||o<0?l=o=null:l!=null&&o==null&&(o=1),n(f)&&(f=E.indicatorColor!=null?E.indicatorColor:e.moon),n(h)&&(h=E.indicatorPressColor!=null?E.indicatorPressColor:e.lighter),n(p)&&(p=E.indicatorScale!=null?E.indicatorScale:1),n(_)&&(_=E.indicatorRadius!=null?E.indicatorRadius:null),n(b)&&(b=E.innerCircle!=null?E.innerCircle:!0),n(w)&&(w=E.innerScale!=null?E.innerScale:.5),n(C)&&(C=E.activeRadius!=null?E.activeRadius:r),n(O)&&(O=E.clamp!=null?E.clamp:!0),n(P)&&(P=E.logo!=null?E.logo:!1);var k=this;this.axis=t,this.outer=new e.Circle(r/2,i,l,o).addTo(this);var X=this.inner=new e.Circle(r*w/2,"rgba(0,0,0,.2)").center(this);P&&(this.logo=new e.Label({text:"D",bold:!0}).center(X).mov(1,2).alp(.3));var q=new e.Container().addTo(this),V=(r-o)*.2*p,I=8;t=="vertical"?I=2:t=="horizontal"?(I=2,q.rotation=90):t=="both"&&(I=4),e.loop(I,function(re,he){new e.Triangle(V,V,V,f).addTo(q).reg(null,n(_)?(r-o)*.475:_).rot(re*360/he)});var te=0,B=0,Z;k.dirX=0,k.dirY=0;var U,ee=!0;this.on("mousedown",function(re){U=re,q.loop(function(he){he.color=h}),ee?k.ticker=e.Ticker.add(function(){ae()}):e.Ticker.add(k.ticker)}),this.on("pressmove",function(re){U=re}),this.on("pressup",function(){e.Ticker.remove(k.ticker),k.dirX=k.dirY=0,q.loop(function(re){re.color=f}),k.stage&&k.stage.update()});function ae(){var re=U;te=re.stageX/e.scaX,B=re.stageY/e.scaY,Z=k.globalToLocal(te,B),re=new $e.Event("change"),re.dirX=((Z.x+C)/(C*2)-.5)*2,re.dirY=((Z.y+C)/(C*2)-.5)*2,O&&(re.dirX=e.constrain(re.dirX,-1,1),re.dirY=e.constrain(re.dirY,-1,1)),k.dirX=re.dirX,k.dirY=re.dirY,k.dispatchEvent(re)}this._enabled=!0,Object.defineProperty(k,"enabled",{get:function(){return k._enabled},set:function(re){c(k,re)}}),A!==!1&&e.styleTransforms(this,E),this.clone=function(){return k.cloneProps(new e.DPad(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,this.group,T))},this.dispose=function(re,he,j){return this.ticker&&e.Ticker.remove(this.ticker),j||this.zimContainer_dispose(!0),!0}},e.extend(e.DPad,e.Container,["clone","dispose"],"zimContainer",!1),e.Radial=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B,Z,U,ee,ae,re,he,j,G,y,g,d){var D="labels, size, font, height, coreRadius, coreColor, startAngle, totalAngle, angles, flip, shiftRadial, icons, rollIcons, rotateIcons, iconsShiftRadial, backgroundColor, rollBackgroundColor, selectedBackgroundColor, selectedRollBackgroundColor, backdropColor, color, rollColor, selectedColor, selectedRollColor, borderColor, borderWidth, gradient, gap, gapAsAngle, spacing, spacingInner, spacingOuter, currentEnabled, currentSelected, selectedIndex, style, group, inherit",K;if(K=mt(e.Radial,arguments,D,this))return K;qe("66.4"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Radial",this.group=g;var m=y===!1?{}:e.getStyle(this.type,this.group,d);n(t)&&(t=m.labels!=null?m.labels:["A","B","C","D","E"]),n(r)&&(r=m.size!=null?m.size:30),n(i)&&(i=m.font!=null?m.font:"verdana"),n(h)&&(h=m.startAngle!=null?m.startAngle:null),n(p)&&(p=m.totalAngle!=null?m.totalAngle:360),n(_)&&(_=m.angles!=null?m.angles:null),n(b)&&(b=m.flip!=null?m.flip:!0),n(w)&&(w=m.shiftRadial!=null?m.shiftRadial:0),n(C)&&(C=m.icons!=null?m.icons:null),n(O)&&(O=m.rollIcons!=null?m.rollIcons:null),n(P)&&(P=m.rotateIcons!=null?m.rotateIcons:!1),n(A)&&(A=m.iconsShiftRadial!=null?m.iconsShiftRadial:0),n(o)&&(o=m.height!=null?m.height:60),n(l)&&(l=m.coreRadius!=null?m.coreRadius:100),n(f)&&(f=m.coreColor!=null?m.coreColor:e.dark),n(E)&&(E=m.backdropColor!=null?m.backdropColor:e.clear),n(R)&&(R=m.backgroundColor!=null?m.backgroundColor:e.granite),n(T)&&(T=m.rollBackgroundColor!=null?m.rollBackgroundColor:e.tin),n(L)&&(L=m.selectedBackgroundColor!=null?m.selectedBackgroundColor:e.charcoal),n(S)&&(S=m.selectedRollBackgroundColor!=null?m.selectedRollBackgroundColor:L),n(k)&&(k=m.color!=null?m.color:e.white),n(X)&&(X=m.rollColor!=null?m.rollColor:k),n(q)&&(q=m.selectedColor!=null?m.selectedColor:k),n(V)&&(V=m.selectedRollColor!=null?m.selectedRollColor:X),n(I)&&(I=m.borderColor!=null?m.borderColor:e.dark),n(te)&&(te=m.borderWidth!=null?m.borderWidth:2),n(U)&&(U=m.gapAsAngle!=null?m.gapAsAngle:!1),n(Z)&&(Z=m.gap!=null?m.gap:U?3:6),n(B)&&(B=m.gradient!=null?m.gradient:null),B===!0&&(B=.1),n(ee)&&(ee=m.spacing!=null?m.spacing:6),n(ae)&&(ae=m.spacingInner!=null?m.spacingInner:ee),n(re)&&(re=m.spacingOuter!=null?m.spacingOuter:ee),n(he)&&(he=m.currentEnabled!=null?m.currentEnabled:!1),n(j)&&(j=m.currentSelected!=null?m.currentSelected:!0);var F=this,Ce=this.innerRadius=l+ae,Y=this.outerRadius=Ce+o;this.setBounds(-Y,-Y,Y*2,Y*2);var Q=this.backdrop=new e.Circle(Y+re,E).center(this);if(l>0&&(this.core=new e.Circle(l,f).center(this)),_&&_.length<t.length-1)return Ct&&ht("Radial() - not enough angles provided"),this;if(t&&t.length>0||C&&C.length>0){var ce;if(t&&t.length>0&&(ce=t.length),C&&C.length>0&&(ce>0?ce=Math.min(C.length,ce):ce=C.length),O&&O.length<ce)for(var pe=0;pe<ce-O.length;pe++)O.push(new e.Circle(1,e.clear));var J=Q.width,ue=this.buttons=new e.Container(-J/2,-J/2,J,J).centerReg(this),ye=Z;U||(Z=Z/Y*180/Math.PI,ye=ye/Ce*180/Math.PI);for(var Xe=(p-Z*ce+(p==360?0:Z))/ce,se=h||0,Ae=0;Ae<ce;Ae++){_&&(Xe=_[Ae]);var ie=new e.Shape(-J/2,-J/2,J,J).centerReg(ue);ie.num=Ae,ie.zimSelected=!1,ie.angle=Xe;var _e=ie.graphics;ie.backgroundColor=e.Pick.choose(R),ie.rollBackgroundColor=e.Pick.choose(T),ie.selectedBackgroundColor=e.Pick.choose(L),ie.selectedRollBackgroundColor=e.Pick.choose(S),ie.color=e.Pick.choose(k),ie.rollColor=e.Pick.choose(X),ie.selectedColor=e.Pick.choose(q),ie.selectedRollColor=e.Pick.choose(V),ie.colorCommand=_e.f(ie.backgroundColor).command,(n(te)||te>0)&&(!n(I)||!n(te))&&(n(I)&&(I=e.black),ie.borderColorCommand=_e.s(I).command,ie.borderWidthCommand=_e.ss(te).command);var $=(se-90-Xe/2)*Math.PI/180,xe=(se-90+Xe/2)*Math.PI/180,Be=(se-90+(Xe+Z-ye)/2)*Math.PI/180,me=(se-90-(Xe+Z-ye)/2)*Math.PI/180;if(_e.arc(0,0,Y,$,xe,!1),_e.arc(0,0,Ce,Be,me,!0).cp(),B&&(_e.s().ss().rf(["rgba(0,0,0,"+B+")","rgba(255,255,255,"+B+")"],[0,1],0,0,Ce,0,0,Y),_e.arc(0,0,Y,$,xe,!1),_e.arc(0,0,Ce,Be,me,!0).cp()),ie.cur("pointer"),ie.zimOverEvent=ie.on("mouseover",function(Fe){var ge=Fe.target;ge.colorCommand.style=ge==F.selected&&j?ge.selectedRollBackgroundColor:ge.rollBackgroundColor,ge.label&&(ge.label.color=ge==F.selected&&j?ge.selectedRollColor:ge.rollColor),O&&(ge.holder.removeAllChildren(),O[ge.num].loc(1,0,ge.holder)),F.stage&&F.stage.update()}),ie.zimOutEvent=ie.on("mouseout",function(Fe){var ge=Fe.target;ge.colorCommand.style=ge==F.selected&&j?ge.selectedBackgroundColor:ge.backgroundColor,ge.label&&(ge.label.color=ge==F.selected&&j?ge.selectedColor:ge.color),O&&(ge.holder.removeAllChildren(),C&&C[ge.num].loc(1,0,ge.holder)),F.stage&&F.stage.update()}),ie.zimDownEvent=ie.on((Dt?e.ACTIONEVENT=="mousedown":le.ACTIONEVENT=="mousedown")?"mousedown":"click",function(Fe){var ge=Fe.target,Ve=ge!==F.selected;F.lastSelected=F.selected,we=ge.num,j?Ve?(F.selected&&(F.selected.colorCommand.style=F.selected.backgroundColor,F.selected.label&&(F.selected.label.color=F.selected.color)),F.selected=ge,F.label=ge.label,F.label&&(F.text=F.label.text),F.icon=ge.icon,ge.colorCommand.style=ge.selectedRollBackgroundColor,ge.label&&(ge.label.color=ge.selectedRollColor)):he||(we=-1,F.selected=null,F.label=null,F.text=null,F.icon=null,ge.colorCommand.style=ge.rollBackgroundColor,ge.label&&(ge.label.color=ge.rollColor)):(F.selected=ge,F.label=ge.label,F.label&&(F.text=F.label.text),F.icon=ge.icon),F.dispatchEvent("change"),!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&F.stage&&F.stage.update()}),C&&C.length>0){var Oe=Ce+o/2+A,Ye=ie.holder=new e.Container(3,Oe).addTo(this).reg(1,Oe).rot(se);Ye.mouseChildren=!1,Ye.mouseEnabled=!1,ie.icon=C[Ae],C[Ae].loc(1,0,Ye),P||(C[Ae].rotation=-se)}if(t&&t.length>0){var de;if(t[Ae].type!="LabelOnArc"){var ve=t[Ae].type=="Label"?t[Ae]:new e.Label({text:t[Ae],size:r,font:i,color:k,style:y,inherit:d});de=new e.LabelOnArc({label:ve,color:k,size:r,spacing:-5,flip:b&&se>90&&se<270,radius:Ce+(o-ve.height)/2+2+w,style:y,inherit:d})}else de=t[Ae];t[Ae]=de,ie.label=de,de.center(this).rot(se),de.mouseChildren=!1,de.mouseEnabled=!1}if(Ae!=t.length-1){var Me=_?_[Ae+1]:Xe;se+=(Xe+Me)/2+Z}}n(h)||(F.rotation+=F.buttons.getChildAt(0).angle/2)}var we=null;Object.defineProperty(this,"selectedIndex",{get:function(){return we},set:function(Fe){var ge;F.buttons&&(ge=F.buttons.getChildAt(Fe)),ge!==F.selected&&(F.selected&&(F.selected.colorCommand.style=F.selected.backgroundColor,F.selected.label&&(F.selected.label.color=F.selected.color)),F.selected=ge,ge&&(j&&(ge.colorCommand.style=ge.selectedRollBackgroundColor),ge.label&&(j&&(ge.label.color=ge.selectedColor),F.text=ge.label.text))),!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&F.stage&&F.stage.update()}}),n(G)&&(G=m.selectedIndex!=null?m.selectedIndex:0),F.selectedIndex=G,y!==!1&&e.styleTransforms(this,m),this.clone=function(){return F.cloneProps(new e.Radial(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B,Z,U,ee,ae,re,he,j,G,y,this.group,d))}},e.extend(e.Radial,e.Container,"clone","zimContainer",!1),e.RadialMenu=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B,Z,U,ee,ae,re,he,j,G,y,g,d){var D="menu, size, font, height, coreRadius, coreColor, title, titleIcon, startAngle, totalAngle, flip, shiftRadial, rotateIcons, iconsShiftRadial, backgroundColor, rollBackgroundColor, selectedBackgroundColor, selectedRollBackgroundColor, backdropColor, color, rollColor, selectedColor, selectedRollColor, borderColor, borderWidth, gradient, gap, gapAsAngle, spacing, spacingInner, spacingOuter, currentEnabled, currentSelected, open, under, style, group, inherit",K=D.split(", "),m=!1;if(t&&t.constructor==={}.constructor){for(var F in t)if(K.indexOf(F)>=0){m=!0;break}}if(t&&m){var Ce;if(Ce=mt(e.RadialMenu,arguments,D,this))return Ce}qe("66.6"),this.zimContainer_constructor(null,null,null,null,!1),this.type="RadialMenu",this.group=g;var Y=y===!1?{}:e.getStyle(this.type,this.group,d);n(t)&&(t=Y.menu!=null?Y.menu:{A:{A1:["AA1","AA2","AA3","AA4"],A2:[],A3:[]},B:["B1","B2","B3","B4","B5","B6"],C:[]}),n(r)&&(r=Y.size!=null?Y.size:30),n(i)&&(i=Y.font!=null?Y.font:"verdana"),n(_)&&(_=Y.startAngle!=null?Y.startAngle:null),n(b)&&(b=Y.totalAngle!=null?Y.totalAngle:360),n(w)&&(w=Y.flip!=null?Y.flip:!0),n(O)&&(O=Y.rotateIcons!=null?Y.rotateIcons:!1),n(C)&&(C=Y.shiftRadial!=null?Y.shiftRadial:0),n(P)&&(P=Y.iconsShiftRadial!=null?Y.iconsShiftRadial:0),n(o)&&(o=Y.height!=null?Y.height:60),n(l)&&(l=Y.coreRadius!=null?Y.coreRadius:100),n(f)&&(f=Y.coreColor!=null?Y.coreColor:e.dark),n(h)&&(h=Y.title!=null?Y.title:"MENU"),n(p)&&(p=Y.titleIcon!=null?Y.titleIcon:null),n(S)&&(S=Y.backdropColor!=null?Y.backdropColor:e.clear),n(A)&&(A=Y.backgroundColor!=null?Y.backgroundColor:e.granite),n(R)&&(R=Y.rollBackgroundColor!=null?Y.rollBackgroundColor:e.tin),n(T)&&(T=Y.selectedBackgroundColor!=null?Y.selectedBackgroundColor:e.charcoal),n(L)&&(L=Y.selectedRollBackgroundColor!=null?Y.selectedRollBackgroundColor:T),n(E)&&(E=Y.color!=null?Y.color:e.white),n(k)&&(k=Y.rollColor!=null?Y.rollColor:E),n(X)&&(X=Y.selectedColor!=null?Y.selectedColor:E),n(q)&&(q=Y.selectedRollColor!=null?Y.selectedRollColor:k),n(V)&&(V=Y.borderColor!=null?Y.borderColor:e.dark),n(I)&&(I=Y.borderWidth!=null?Y.borderWidth:2),n(Z)&&(Z=Y.gapAsAngle!=null?Y.gapAsAngle:!1),n(B)&&(B=Y.gap!=null?Y.gap:Z?3:6),n(U)&&(U=Y.spacing!=null?Y.spacing:6),n(te)&&(te=Y.gradient!=null?Y.gradient:null),te===!0&&(te=.1),n(ee)&&(ee=Y.spacingInner!=null?Y.spacingInner:U),n(ae)&&(ae=Y.spacingOuter!=null?Y.spacingOuter:U),n(re)&&(re=Y.currentEnabled!=null?Y.currentEnabled:!1),n(he)&&(he=Y.currentSelected!=null?Y.currentSelected:!0),n(j)&&(j=Y.open!=null?Y.open:!1),n(G)&&(G=Y.under!=null?Y.under:!0);var Q=this,ce=(Dt?e.ACTIONEVENT=="mousedown":le.ACTIONEVENT=="mousedown")?"mousedown":"click",pe=null,J=this.core=new e.Circle({radius:l,color:f,style:y,inherit:d}).addTo(this);p&&(this.titleIcon=p.center(J)),h&&(this.title=new e.Label({text:h,size:r,font:i,color:E,style:y,inherit:d}).center(J)),J.cur("pointer"),J.on(ce,function(){Q.leafNode=!1,se.length==0?Ae():(e.loop(se,function(_e){_e.selectedIndex=-1,_e.removeFrom(),se=[]}),Q.outerLevel=0,Q.selected=Q.outerMenu=Q.selectedMenu=Q.text=null),(re||Q.selected!=pe)&&Q.dispatchEvent("change"),pe=Q.selected,Q.stage&&Q.stage.update()}),this.closeRings=function(_e){n(_e)&&(_e=Q.outerLevel);var $=Q.outerLevel-_e;e.loop(se,function(xe,Be){Be>$-1&&(xe.removeFrom(),xe.selectedIndex=-1,se.pop())},!0),Q.outerLevel=$,Q.outerMenu=se[se.length-1],Q.outerMenu&&(Q.outerMenu.selectedIndex=-1),Q.selected=Q.selectedMenu=Q.text=null,se[se.length-2]?(Q.selectedMenu=se[se.length-2],Q.selectedIndex=Q.selectedMenu.selectedIndex):Q.selectedIndex=-1,Q.selected!=pe&&Q.dispatchEvent("change"),pe=Q.selected,Q.stage&&Q.stage.update()};var ue={},ye,Xe;Q.outerLevel=0,t.constructor=={}.constructor&&(t={core:t},ye=Q.tree=new e.Hierarchy(t),Xe=ye.getLinearIDs()),Q.lastRadial=null;var se=this.radials=[];j&&Ae();function Ae(_e){var $,xe;_e?$=_e.ringLevel:($=0,xe=l),e.loop(se,function(Oe,Ye){Ye>$-1&&(Oe.removeFrom(),Oe.selectedIndex=-1,se.pop())},!0);var Be;if(_e&&(Be=_e.selected),Be){var me=Be.id;xe=_e.outerRadius,ie(me,$+1,xe)}else _e||ie("id0",$+1,xe);Q.selected=Be,Q.selected?(Q.selectedMenu=se[Q.selected.menu.ringLevel-1],Q.selectedIndex=Q.selected.num,Q.selected.label?Q.text=Q.selected.label.text:Q.text=null):re&&_e?(Q.selectedIndex=_e.selectedIndex,Q.label=_e.label,Q.text=_e.text,Q.icon=_e.icon,Q.selectedMenu=_e):(Q.text=null,Q.selectedIndex=-1,Q.selectedMenu=null),Q.stage&&Q.stage.update()}function ie(_e,$,xe){$&&(Q.outerLevel=$);var Be;if(!ue[_e]){var me=ye.getData(_e),Oe=me.list;if(Oe&&!e.isEmpty(Oe)){var Ye={labels:ye.getLinearList(Oe),coreRadius:xe,size:r,font:i,startAngle:_,totalAngle:b,flip:w,rotateIcons:O,shiftRadial:C,iconsShiftRadial:P,height:o,coreColor:e.clear,backdropColor:S,backgroundColor:A,rollBackgroundColor:R,selectedBackgroundColor:T,selectedRollBackgroundColor:L,color:E,rollColor:k,selectedColor:X,selectedRollColor:q,borderColor:V,borderWidth:I,gapAsAngle:Z,gap:B,gradient:te,spacingInner:ee,spacingOuter:ae,currentSelected:he,currentEnabled:re,style:y,inherit:d};me.styles&&(Ye=e.merge(Ye,me.styles)),Be=ue[_e]=new e.Radial(Ye),Xe=ye.getLinearIDs(Oe),Be.buttons.loop(function(de,ve){de.menu=Be,de.id=Xe[ve]}),Be.ringLevel=Q.outerLevel,Be.selectedIndex=-1,Be.on("change",function(de){Q.leafNode=!1,Ae(de.target),(re||Q.selected!=pe)&&Q.dispatchEvent("change"),pe=Q.selected})}}ue[_e]?(se.push(ue[_e]),ue[_e].center(Q),G&&ue[_e].bot()):(Q.leafNode=!0,Q.outerLevel-=1),Q.outerMenu=Be}y!==!1&&e.styleTransforms(this,Y),this.clone=function(){return Q.cloneProps(new e.RadialMenu(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B,Z,U,ee,ae,re,he,j,G,y,this.group,d))}},e.extend(e.RadialMenu,e.Container,"clone","zimContainer",!1),e.ColorPicker=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B,Z,U){var ee="width, colors, cols, spacing, greyPicker, alphaPicker, startBackgroundColor, draggable, shadowColor, shadowBlur, buttonBar, circles, indicator, backgroundColor, keyArrows, container, selectedIndex, selectedColor, dropperTarget, spectrumCollapse, spectrumMode, spectrumClose, spectrumOk, spectrumTitle, tolerancePicker, collapsed, style, group, inherit",ae;if(ae=mt(e.ColorPicker,arguments,ee,this))return ae;qe("67"),this.zimContainer_constructor(null,null,null,null,!1),this.type="ColorPicker",this.group=Z;var re=B===!1?{}:e.getStyle(this.type,this.group,U),he;n(t)&&(t=re.width!=null?re.width:500),n(r)&&(r=re.colors!=null?re.colors:"spectrum"),r=="legacy"&&(he=!0),n(i)&&(i=re.cols!=null?re.cols:10),n(o)&&(o=re.spacing!=null?re.spacing:2);var j=!he&&r.length>0&&r.length<=i;r=="spectrum"&&(i=10,o=2,j=!1),n(f)&&(f=re.alphaPicker!=null?re.alphaPicker:!j),n(I)&&(I=re.tolerancePicker!=null?re.tolerancePicker:!1),I&&(f=!1),n(l)&&(l=re.greyPicker!=null?re.greyPicker:!j),n(_)&&(_=re.shadowColor!=null?re.shadowColor:"rgba(0,0,0,.3)"),n(b)&&(b=re.shadowBlur!=null?re.shadowBlur:14),n(w)&&(w=re.buttonBar!=null?re.buttonBar:!j),n(p)&&(w||r=="spectrum"?p=re.draggable!=null?re.draggable:!0:p=re.draggable!=null?re.draggable:!1),n(C)&&(C=re.circles!=null?re.circles:!1),n(O)&&(O=re.indicator!=null?re.indicator:!1,w||(O=re.indicator!=null?re.indicator:!0)),n(P)&&(P=re.backgroundColor!=null?re.backgroundColor:e.black),n(h)&&(h=re.startBackgroundColor!=null?re.startBackgroundColor:null),n(A)&&(A=re.keyArrows!=null?re.keyArrows:!0),n(S)&&(S=re.dropperTarget!=null?re.dropperTarget:!1),n(E)&&(E=re.spectrumCollapse!=null?re.spectrumCollapse:!0),n(k)&&(k=re.spectrumMode!=null?re.spectrumMode:!0),n(X)&&(X=re.spectrumClose!=null?re.spectrumClose:!0),n(q)&&(q=re.spectrumOk!=null?re.spectrumOk:!0),n(V)&&(V=re.spectrumTitle!=null?re.spectrumTitle:null),n(te)&&(te=re.collapsed!=null?re.collapsed:!1);var G=this;if(n(R))if(le.zdf)R=le.zdf.stage;else return;else if(R.getBounds){if(n(R.getStage))return}else return;G.container=R;var y="#e472c4",g="#50c4b7",d=1,D=1,K=new e.Shape;this.addChild(K),K.x+=o,K.y+=o,he=!1;var m,F,Ce=[],Y,Q,ce,pe,J,ue=r=="spectrum";if(n(r)||r=="legacy"||r=="spectrum"){he=!0;var ye=6,Xe=ye*ye*ye;ye=Math.ceil(Math.pow(Xe,1/2)),F=(t-o)/18-o,J=Math.floor(Math.pow(ye*ye,1/3)),m=[];for(var se=0;se<6;se++)for(var Ae=0;Ae<6;Ae++)for(var ie=0;ie<6;ie++)m.push("#"+Oe(se*3)+Oe(Ae*3)+Oe(ie*3));for(r=[],se=0;se<m.length;se++)Y=Math.floor(se/6),Q=se%6,Y>=6*3?J=1:J=0,ce=Y-J*6*3,pe=Q+J*6,r[pe*18+ce]=m[se];i=18,Ce=[g,y]}else F=(t-o)/i-o;var _e=Math.ceil(r.length/i),$=1,xe=String(r[r.length-1]);if(!n(h)){var Be=h.match(/rgba\((.*)\)/);Be&&(Y=Be[1].split(","),$=Y.pop(),h="rgb("+Y.join(",")+")"),xe=String(h)}var me;he&&(me=g);function Oe(Mt){return Mt=Math.floor(Mt).toString(16),Mt+""+Mt}J=0;var Ye=K.graphics,de,ve,Me=re.borderColor!=null?re.borderColor:null,we=re.borderWidth!=null?re.borderWidth:null;!n(Me)&&n(we)&&(we=1),we&&n(Me)&&(Me=e.dark),we&&Ye.s(Me).ss(we);var Fe=r.length;for(ue&&(Fe=56),se=0;se<Fe;se++)Y=se%i,Q=Math.floor(se/i),de=Y*(F+o),ve=Q*(F+o),C?Ye.f(r[se]).dc(de+F/2,ve+F/2,F/2):Ye.f(r[se]).r(de,ve,F,F);var ge=ve+F+o;G.colors=r;var Ve=ge;if(l){for(se=0;se<16;se++)Ce.push("#"+Oe(se)+Oe(se)+Oe(se));for(se=0;se<Ce.length;se++)Y=Math.floor(se/i),Q=se%i,de=Q*(F+o),ve=Y*(F+o)+ge,C?Ye.f(Ce[se]).dc(de+F/2,ve+F/2,F/2):Ye.f(Ce[se]).r(de,ve,F,F);ge=ve+F+o;var He=i,Le=Math.ceil(Ce.length/i)}G.greys=Ce,O&&!ue&&(O=this.indicator=C?new e.Circle(F/2*.5,null,null,null,null,null,null,null,!1):new e.Rectangle(F*.5,F*.5,null,null,null,null,null,null,null,!1),O.alpha=.5,O.centerReg(),this.addChild(O),O.mouseEnabled=!1,fe(r.indexOf(xe)));function fe(Mt){if(n(Mt)||Mt<0){O.visible=!1;return}else O.visible=!0;xe=="#000"||xe=="#000000"||xe=="black"?(O.color="#222",O.alpha=1):(O.color="black",O.alpha=.5),O.x=K.x+Mt%i*(F+o)+F/2,O.y=K.x+Math.floor(Mt/i)*(F+o)+F/2}var Ge=10,Qe=ge;if(f||I){var Ke=new e.Container({style:!1});Ke.setBounds(0,0,600,70),this.addChild(Ke),Ke.x=0,Ke.y=ge;var st=this.alphaBacking=new e.Rectangle(600-Ge*2,50,e.licorice,null,null,0,null,null,null,!1);Ke.addChild(st),e.centerReg(st,Ke);var yt=this.alphaBut=new e.Button({width:20,height:30,backgroundColor:"darkorange",rollBackgroundColor:"orange",label:"",corner:0,hitPadding:20,style:!1}),We=this.alphaSlider=new e.Slider({min:0,max:1,step:I?0:.05,button:yt,barLength:I?500*.55:600*.55,barWidth:2,barColor:e.silver,vertical:!1,useTicks:!1,inside:!1,style:!1});We.currentValue=n($)?1:$,I&&(We.currentValue=.1),Ke.addChild(We),We.x=40,We.y=Ke.height/2;var at=this.alphaText=new e.Label({text:I?"Tolerance: 0.1":"Alpha: "+e.decimals($),size:30,color:"orange",backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",backgroundColor:"ignore",rollColor:"orange",group:this.group});Ke.addChild(at),at.x=We.x+We.bar.width+40,at.y=Ke.height/2-at.height/2,Ke.scaleX=Ke.scaleY=t/600,We.on("change",function(){at.text=I?"Tolerance: "+Qt(We.currentValue):"Alpha: "+Qt(We.currentValue),f&&je&&(je.alpha=D=We.currentValue),G.dispatchEvent("change"),G.stage&&G.stage.update()}),ge+=Ke.height-Ge,I&&(G.toleranceBacking=G.alphaBacking,G.toleranceBut=G.alphaBut,G.toleranceSlider=G.alphaSlider,G.alphaBacking=G.alphaBut=G.alphaSlider=null)}if(w){var ct=new e.Container({style:!1});ct.setBounds(0,0,600,100),this.addChild(ct),ct.x=0,ct.y=ge+Ge;var Pe=this.swatchText=new e.TextInput({align:"left",selectionAlpha:.5,text:xe.toUpperCase(),width:140,size:30,color:"orange",shadowColor:"ignore",shadowBlur:"ignore",backgroundColor:"ignore",group:this.group});if(Pe.on("input",function(){(Pe.text.length==4||Pe.text.length==7)&&(je.color=Pe.text,xe=je.color,G.dispatchEvent("change"))}),ct.addChild(Pe),e.centerReg(Pe),Pe.x=200/2-10,Pe.y=50-2,p){var Ie=this.grip=new e.Shape({style:!1});Ie.cur("pointer"),ct.addChild(Ie),Ie.graphics.f("rgba(256,256,256,.25)").r(0,0,5,20).r(10,0,5,20).r(20,0,5,20).r(30,0,5,20),Ie.x=70,Ie.y=65,Pe.y=50-10,Ie.mouseEnabled=!1}var be=this.closeBut=new e.Button({width:90,height:90,label:"X",backgroundColor:e.licorice,rollBackgroundColor:e.charcoal,corner:0,style:!1});ct.addChild(be),be.x=600-be.width-Ge,be.y=0,be.on((Dt?e.ACTIONEVENT=="mousedown":le.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){G.hide(),G.dispatchEvent("close")});var ze=this.okBut=new e.Button({width:150,height:90,label:"OK",backgroundColor:e.licorice,rollBackgroundColor:e.charcoal,corner:0,style:!1});ct.addChild(ze),ze.x=be.x-ze.width-Ge,ze.y=0,ze.on((Dt?e.ACTIONEVENT=="mousedown":le.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){bt(),G.dispatchEvent("ok")});var it=this.swatchBacking=new e.Shape({style:!1});ct.addChild(it),Ye=it.graphics,Ye.f(e.black).r(.5,.5,50,89).f(e.granite).r(50,.5,50,89).f(e.white).r(100,.5,49.5,89),it.x=ze.x-150-Ge,it.y=0;var je=this.swatch=new e.Rectangle(150,90,xe,null,null,null,null,null,null,!1);ct.addChild(je),je.x=it.x,je.y=0,je.on((Dt?e.ACTIONEVENT=="mousedown":le.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){G.dispatchEvent("swatch")}),je.cur("pointer"),je.alpha=D=$,ct.scaleX=ct.scaleY=t/600,ge+=ct.height}else K.cur("pointer");!f&&!w&&(ge-=Ge-o);var tt=ge+Ge;this.setBounds(0,0,t,tt);var Te=this.background=new e.Rectangle(t,tt,P,null,null,null,null,null,null,!1);this.addChildAt(Te,0),_!=-1&&b>0&&(Te.shadow=new $e.Shadow(_,8,8,b));var ut=le.zdf,et,Ue=!1;if(this.dropperTarget=S,ue){r="spectrum";var Re=30,Ze=20,Je=Qe-Re+1,nt=Je-Ze+1,pt=G.bar=new e.Rectangle(G.width,Re+1,e.black).addTo(G);V&&(G.title=new e.Label(V,18,null,e.light).pos(12,1,LEFT,CENTER,G.bar).noMouse()),p&&pt.cur();var De=new e.Container(G.width,Je).loc(0,Re,G),lt=new e.Rectangle(G.width,nt,new e.GradientColor(["rgb(255 0 0)","rgb(255 255 0)","rgb(0 255 0)","rgb(0 255 255)","rgb(0 0 255)","rgb(255 0 255)","rgb(255 0 0)"],[0,1/6,2/6,3/6,4/6,5/6,6/6],0,0,500,0)).addTo(De).mov(0,Ze-1);new e.Rectangle(G.width,nt/2,new e.GradientColor(["rgba(255,255,255,1)","rgba(255,255,255,0)"],[0,1],0,0,0,nt/2)).loc(lt,null,De),new e.Rectangle(G.width,nt/2+.5,new e.GradientColor(["rgba(0,0,0,1)","rgba(0,0,00,0)"],[1,0],0,0,0,nt/2+.5)).loc(lt,null,De).mov(0,nt/2),new e.Rectangle(G.width,20,new e.GradientColor(["black","white"],[.1,.9],0,0,G.width,0)).addTo(De);var vt=G.gradient=new e.Bitmap(De).loc(De,null,G).cur("none"),rt=G.pixels=new e.Pixel(De,.5).loc(De,null,G).vis(!1).cur("none");De.dispose();var xt;!w&&X&&(xt=G.closeIcon=new e.Shape(-40,-40,80,80,null,!1),xt.graphics.f(e.light).p("AmJEVIEUkTIkXkWIB4h5IEWEYIETkTIB4B3IkTESIEQERIh4B4IkRkRIkSEVg"),xt.sca(.25).expand(10,10,10,1).pos(7,0,e.RIGHT,e.CENTER,pt).cur().addTo(G),xt.on((Dt?e.ACTIONEVENT=="mousedown":le.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){G.hide(),G.dispatchEvent("close")}));var wt=G.collapseIcon=new e.Triangle(20,20,20,e.faint,e.light,2).expand(10,10,10,1).pos(40+(xt?30:0),0,e.RIGHT,e.CENTER,pt).cur().addTo(G);wt.on("mousedown",function(){G.collapse(wt.rotation==0)});var _t=new e.Rectangle(20,20,e.white).reg("center");new e.Tile(new e.Rectangle(10,10,e.series(e.silver,e.white,e.white,e.silver)),2,2,0,0).addTo(_t),_t.mouseChildren=!1;var ft=G.modeIcon=new e.Button({width:20,height:20,shadowColor:-1,label:"",backing:_t,toggleEvent:"mousedown",toggleBacking:new e.Rectangle(20,20,new e.GradientColor([e.white,e.grey],[0,1],0,0,20,20)).reg("center")}).pos(8+(xt?30:0),5,e.RIGHT,e.TOP,G).expand(10,10,10,1);ft.on("mousedown",function(){rt.vis(ft.toggled),G.spectrumToggled=!ft.toggled,ut.stage.update()}),k||(ft.removeFrom(),wt.mov(28)),E||wt.removeFrom(),q||G.okBut&&G.okBut.removeFrom(),!X&&be&&be.removeFrom();var Ot=new e.Rectangle(G.width,G.height-Je-Re,e.faint).pos(0,0,e.LEFT,e.BOTTOM,G).noMouse(),Rt=this.dropper=new e.Circle(10,e.clear,e.white,8);new e.Circle(5,e.clear,e.black,2).center(Rt),new e.Circle(7,e.clear,e.white,2).center(Rt),Rt.noMouse()}this.updateDropperTarget=function(){Rt.vis(!1),Lt(),Rt.vis(!0).top()},this.spectrumToggled=ue,this.toggleSpectrum=function(Mt){Mt!=G.spectrumToggled&&(n(Mt)&&(Mt=!G.spectrumToggled),G.spectrumToggled=Mt,ft.toggle(!Mt),rt.vis(!Mt),G.updateDropperTarget())};var St=!1;function Gt(){ut.stage.mouseInBounds?Rt.alp(1):Rt.alp(0),Rt.loc(ut.mouseX,ut.mouseY,ut.stage),St=G.spectrumToggled?vt.hitTestReg(Rt):rt.hitTestReg(Rt);var Mt;G.dropperTarget?Mt=Rt.x>=et.x&&Rt.x<=et.x+et.width&&Rt.y>=et.y&&Rt.y<=et.y+et.height:Mt=!1;var Ft;if(G.dropperTarget?Ft=(St||Mt)&&!Ot.hitTestReg(Rt)&&!pt.hitTestReg(Rt):Ft=St,!Ue&&Ft)Yt(Mt);else if(Ue&&!Ft){$t(),ut.stage.update();return}if(Ft){var yn;if(St)yn=G.spectrumToggled?vt:rt;else if(G.dropperTarget)yn=et;else return;var gn=yn.globalToLocal(ut.mouseX,ut.mouseY),nn=yn.getColorAt(gn.x,gn.y,!0),kn="rgba("+nn[0]+","+nn[1]+","+nn[2]+","+nn[3]+")";nn[3]<.05&&(kn=ut.color),Rt.borderColor=kn,ut.stage.update()}}function Yt(Mt){Ue=!0,Mt&&Lt(),Rt.vis(!0).top()}function $t(){Ue=!1,et.dispose(),Rt.vis(!1)}this.collapsed=!1,this.collapse=function(Mt){n(Mt)&&(Mt=!0),Mt!=G.collapsed&&(G.collapsed=Mt,Mt?(ft.enabled=!1,wt.rot(180),G.background.vis(!1),vt.vis(!1),Ot.vis(!1),K.visible=!1,rt&&rt.vis(!1),Ke&&Ke.vis(!1),w&&ct.vis(!1),Ue=!1,en(),Zt(),G.dispatchEvent("collapsed")):(ft.enabled=!0,wt.rot(0),G.background.vis(!0),vt.vis(!0),Ot.vis(!0),K.visible=!0,G.spectrumToggled||rt.vis(!0),Ke&&Ke.vis(!0),w&&ct.vis(!0),Ue=!0,sn(),Lt(),pt.hitTestReg(Rt)&&Zt(),G.dispatchEvent("expanded")),ut.stage.update())},ue&&E&&(G.collapseEvent=pt.on("dblclick",function(){G.collapsed?G.collapse(!1):G.collapse(!0)})),ue&&te&&E&&(G.vis(!1),setTimeout(function(){G.collapse(!0),G.vis(!0),G.stage&&G.stage.update()},50));function sn(){en(),G.dropperDown=ut.stage.on("stagemousedown",Gt),G.dropperMove=ut.stage.on("stagemousemove",Gt),G.dropperUp=ut.stage.on("stagemouseup",function(){Gt(),je&&ue&&St&&je.color!=Rt.borderColor&&ot()})}function en(){G.dropperDown&&ut.stage.off("stagemousedown",G.dropperDown),G.dropperMove&&ut.stage.off("stagemousemove",G.dropperMove),G.dropperUp&&ut.stage.off("stagemouseup",G.dropperUp)}function Lt(){et&&et.dispose&&et.dispose();var Mt=new e.Rectangle(ut.width,ut.height,ut.color).addTo(ut.stage,0),Ft;G.dropperTarget&&G.dropperTarget.getBounds&&G.dropperTarget.type&&!G.dropperTarget.type.includes("Stage")?Ft=G.dropperTarget.boundsToGlobal():Ft=ut.stage.getBounds(),et=new e.Bitmap(ut.stage,Ft.width,Ft.height,Ft.x,Ft.y).loc(Ft).cur("none"),Mt.dispose(),et.on("mousedown",ot)}function Zt(){et&&et.dispose&&et.dispose(),Rt.vis(!1)}function ot(){Rt.vis(!1),G.currentValue=e.convertColor(Rt.borderColor,"hex"),G.dispatchEvent("change"),Ue&&(S?(Lt(),Rt.vis(!0).top(),setTimeout(function(){G.updateDropperTarget(),ut.stage.update()},50)):(Rt.vis(!0).top(),ut.stage.update()))}function bt(){if(he&&l){g=y,y=me;var Mt=[g,y];for(se=0;se<2;se++){var Ft=K.graphics;Y=Math.floor(se/i),Q=se%i,de=Q*(F+o),ve=Y*(F+o)+Ve,Ce[se]=Mt[se],Ft.f(Te.color).r(de-1,ve-1,F+2,F+2).f(Mt[se]).r(de,ve,F,F)}}me=xe,d=D,G.dispatchEvent("change"),!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&G.stage&&G.stage.update()}if(p){var Bt,It;Te.on("mousedown",Ut),Te.on("pressmove",kt),Te.on("pressup",Nt),ue&&(pt.on("mousedown",Ut),pt.on("pressmove",kt),pt.on("pressup",Nt))}function Ut(Mt){Bt=Mt.stageX/e.scaX-G.x,It=Mt.stageY/e.scaY-G.y}function kt(Mt){G.x=Mt.stageX/e.scaX-Bt,G.y=Mt.stageY/e.scaY-It,G.stage&&G.stage.update()}function Nt(){G.stage&&G.stage.update()}var Wt=i*(F+o),jt=_e*(F+o);if(l)var rn=He*(F+o),Kt=Le*(F+o);K.on((Dt?e.ACTIONEVENT=="mousedown":le.ACTIONEVENT=="mousedown")?"mousedown":"click",function(Mt){var Ft=e.hitTestGrid(K,Wt,jt,i,_e,Mt.stageX,Mt.stageY,0,0,o,o);n(Ft)||(xe=r[Ft],w&&(je.color=xe,Pe.text=String(r[Ft]).toUpperCase()),bt()),l&&(Ft=null,Ft=e.hitTestGrid(K,rn,Kt,He,Le,Mt.stageX,Mt.stageY,0,jt,o,o),n(Ft)||(xe=Ce[Ft],w&&(je.color=xe,Pe.text=Ce[Ft].toUpperCase()),bt())),O&&fe(r.indexOf(xe)),w?G.stage&&G.stage.update():O&&G.stage&&G.stage.update(),tn()}),Object.defineProperty(this,"selectedColor",{get:function(){return xe},set:function(Mt){Mt=Mt.toLowerCase(),me=xe=Mt,w&&(je.color=xe,Pe.text=xe,G.stage&&G.stage.update()),O&&!ue&&fe(r.indexOf(xe)),tn()}}),Object.defineProperty(this,"currentValue",{get:function(){return xe},set:function(Mt){G.selectedColor=Mt}}),Object.defineProperty(this,"currentValueEvent",{get:function(){return xe},set:function(Mt){Mt!=G.selectedColor&&(G.selectedColor=Mt,G.dispatchEvent("change"))}}),Object.defineProperty(this,"selectedIndex",{get:function(){return ue?null:r.indexOf(xe)},set:function(Mt){ue||(me=xe=r[Mt],w&&(je.color=xe,Pe.text=xe,G.stage&&G.stage.update()),O&&fe(r.indexOf(xe)),tn())}}),Object.defineProperty(this,"selectedAlpha",{get:function(){return f?Qt(We.currentValue):1},set:function(Mt){f&&(d=We.currentValue=Mt,je&&(je.alpha=d),at&&(at.text="Alpha: "+Qt(We.currentValue)),G.stage&&G.stage.update())}}),Object.defineProperty(this,"selectedTolerance",{get:function(){return I?Qt(We.currentValue):1},set:function(Mt){I&&(We.currentValue=Mt,G.stage&&G.stage.update())}}),Object.defineProperty(this,"colors",{get:function(){return ue?"spectrum":l?r.concat(Ce):r},set:function(){Ct&&ht("ColorPicker() colors is read only - make a new ColorPicker to change")}}),le.KEYFOCUS!=null&&(e.KEYFOCUS=le.KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return e.KEYFOCUS==G},set:function(){Dt?e.KEYFOCUS=G:le.KEYFOCUS=G}}),A&&e.KEYFOCUS&&ln(),this.on("mousedown",function(){A&&ln()});function ln(){G.keyFocus=!0;var Mt=document.activeElement;Mt&&Mt.blur()}function tn(){G.zimAccessibility&&G.zimAccessibility.changeTitle(G,null,!0)}this.keyDownEvent=function(Mt){if(G.stage&&!ue&&(G.zimAccessibility&&G.focus||!G.zimAccessibility&&G.keyFocus)){var Ft=G.selectedIndex;Mt.keyCode==37||Mt.keyCode==40?(Ft--,xn(Ft)):(Mt.keyCode==38||Mt.keyCode==39)&&(Ft++,xn(Ft))}};function xn(Mt){Mt<0&&(Mt=G.colors.length-1),Mt>G.colors.length-1&&(Mt=0),G.selectedIndex=Mt,G.dispatchEvent("change"),G.stage&&G.stage.update()}le.addEventListener("keydown",this.keyDownEvent);var Pt,ut;this.hide=function(){return Pt=G.stage,G.removeFrom(),Pt&&Pt.update(),G},this.on("removed",At);function At(){if(ue&&(Ue=!1,en(),Zt()),G.toggled=!1,G.zimAccessibility){var Mt=G.zimAccessibility;Mt.resize(G),Ht?Ht.focus():G.zimTabTag.nextSibling.focus(),setTimeout(function(){Mt.talk("ColorPicker has been closed.")},50)}Pt&&Pt.update()}var Ht,Jt=!1;this.show=function(){return G.center(G.container),G};function zt(){if(G.stage&&(Pt=G.stage,ut=Pt.frame),G.zimAccessibility){var Mt=G.zimAccessibility;setTimeout(function(){Mt.activatedObject&&(Ht=Mt.activatedObject.zimTabTag)},50),Mt.resize(G),Mt.tabIndex=G.zimTabIndex}G.toggled=!0,setTimeout(function(){ue&&(Ue=!0,Lt(),sn(),Yt(),Gt()),G.stage&&G.stage.update()},20)}this.on("added",zt),this.toggle=function(Mt){return Mt===!0?G.show():Mt===!1||G.container.contains(G)?G.hide():G.show(),G};function Qt(Mt){return Math.round(Mt*Math.pow(10,2))/Math.pow(10,2)}n(T)&&(T=re.selectedIndex!=null?re.selectedIndex:0),G.selectedIndex=T,n(L)&&(L=re.selectedColor!=null?re.selectedColor:null),L!=null?G.selectedColor=L:ue&&(G.selectedColor="#888888"),B!==!1&&e.styleTransforms(this,re),this.clone=function(){return G.cloneProps(new e.ColorPicker(t,he?null:r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B,this.group,U))},this.dispose=function(Mt,Ft,yn){return le.removeEventListener("keydown",G.keyDownEvent),ue&&(en(),G.gradient.cur("default"),G.pixels.cur("default"),S&&S.cur("default"),et.cur("default"),Ue=!1,Zt()),We&&We.dispose(),Rt&&Rt.dispose(),G.dropperDown&&ut.stage.off("stagemousedown",G.dropperDown),G.dropperMove&&ut.stage.off("stagemousemove",G.dropperMove),G.dropperUp&&ut.stage.off("stagemouseup",G.dropperUp),yn||this.zimContainer_dispose(!0),!0}},e.extend(e.ColorPicker,e.Container,["clone","dispose"],"zimContainer",!1),e.EmojiPicker=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S){var E="width, height, emojis, monochrome, backgroundColor, titleBar, titleBarColor, titleBarBackgroundColor, titleBarHeight, cache, size, collapse, collapseColor, collapsed, colSize, rowSize, style, group, inherit",k;if(k=mt(e.EmojiPicker,arguments,E,this))return k;qe("67.05"),this.group=L;var X=T===!1?{}:e.getStyle("EmojiPicker",this.group,S);n(t)&&(t=X.width!=null?X.width:400),n(r)&&(r=X.height!=null?X.height:600),n(o)&&(o=X.monochrome!=null?X.monochrome:!1),n(l)&&(l=X.backgroundColor!=null?X.backgroundColor:e.lighter),n(f)&&(f=X.titleBar!=null?X.titleBar:"Emojis"),n(h)&&(h=X.titleBarColor!=null?X.titleBarColor:null),n(p)&&(p=X.titleBarBackgroundColor!=null?X.titleBarBackgroundColor:e.silver.toAlpha(.8)),n(_)&&(_=X.titleBarHeight!=null?X.titleBarHeight:40),n(b)&&(b=X.cache!=null?X.cache:!!e.mobile()),n(w)&&(w=X.size!=null?X.size:30),n(A)&&(A=X.colSize!=null?X.colSize:w+15),n(R)&&(R=X.rowSize!=null?X.rowSize:w+14),n(C)&&(C=X.collapse!=null?X.collapse:!1),n(O)&&(O=X.collapseColor!=null?X.collapseColor:n(h)?e.grey:h),n(P)&&(P=X.collapsed!=null?X.collapsed:!1),this.zimWindow_constructor(t,r,null,l,null,X.borderWidth!=null?X.borderWidth:2,X.padding!=null?X.padding:10,X.corner!=null?X.corner:10,null,X.scrollBarActive!=null?X.scrollBarActive:!0,X.scrollBarDrag!=null?X.scrollBarDrag:!0,null,null,null,!1,null,null,null,null,null,!0,null,null,null,null,null,null,f,h,p,_,X.draggable!=null?X.draggable:!0,null,null,X.close!=null?X.close:!0,null,null,X.fullSize!=null?X.fullSize:!1,null,X.resizeHandle!=null?X.resizeHandle:!1,C,O,P,null,null,T,L,e.copy(X)),this.type="EmojiPicker";var q=this;this.emojiData=n(i)?["\u{1F4A5}","\u{1F335}","\u{1F382}","\u{1F370}","\u{1F429}","\u{1F525}","\u{1F32B}","\u{1F30A}","\u{1F34F}","\u{1F34E}","\u{1F34B}","\u{1F34C}","\u{1F347}","\u{1F351}","\u{1F345}","\u{1F346}","\u{1F9C0}","\u{1F355}","\u{1F36C}","\u{1F36D}","\u{1F369}","\u{1F37A}","\u{1F37B}","\u{1F378}","\u{1F37E}","\u2615\uFE0F","\u{1F4A9}","\u{1F47B}","\u{1F916}","\u{1F4A4}","\u{1F440}","\u{1F483}","\u{1F483}\u{1F3FB}","\u{1F483}\u{1F3FC}","\u{1F483}\u{1F3FD}","\u{1F483}\u{1F3FE}","\u{1F483}\u{1F3FF}","\u{1F454}","\u{1F457}","\u{1F459}","\u{1F458}","\u{1F460}","\u{1F452}","\u{1F3A9}","\u{1F431}","\u{1F43B}","\u{1F436}","\u{1F43C}","\u{1F42F}","\u{1F981}","\u{1F42E}","\u{1F437}","\u{1F419}","\u{1F435}","\u{1F412}","\u{1F414}","\u{1F426}","\u{1F434}","\u{1F984}","\u{1F41D}","\u{1F422}","\u{1F420}","\u{1F410}","\u{1F54A}","\u{1F415}","\u{1F408}","\u{1F409}","\u{1F432}","\u{1F384}","\u{1F340}","\u{1F33B}","\u{1F339}","\u{1F490}","\u{1F344}","\u2600\uFE0F","\u{1F327}","\u26BD\uFE0F","\u{1F3C0}","\u{1F3C8}","\u26BE\uFE0F","\u{1F3BE}","\u{1F3D2}","\u26F7","\u{1F3C4}","\u{1F3CA}","\u{1F6B4}","\u{1F3AD}","\u{1F3A8}","\u{1F3B7}","\u{1F3BA}","\u{1F3B8}","\u{1F3BB}","\u{1F3B0}","\u{1F3B3}","\u{1F697}","\u{1F695}","\u{1F68C}","\u{1F68E}","\u{1F691}","\u{1F692}","\u{1F69C}","\u{1F682}","\u2708\uFE0F","\u26F5\uFE0F","\u{1F6F0}","\u{1F301}","\u{1F30B}","\u{1F3DE}","\u{1F305}","\u{1F386}","\u{1F308}","\u{1F3E0}","\u{1F3E5}","\u{1F3EB}","\u231A\uFE0F","\u{1F4F1}","\u{1F5A5}","\u{1F4BE}","\u{1F4FC}","\u{1F3A5}","\u260E\uFE0F","\u{1F4FA}","\u{1F4FB}","\u{1F4E1}","\u{1F56F}","\u{1F4B0}","\u{1F48E}","\u{1F6AC}","\u26B0","\u{1F52E}","\u{1F488}","\u{1F6BD}","\u{1F511}","\u{1F6CF}","\u{1F389}","\u{1F38A}","\u2764\uFE0F","\u{1F921}","\u{1F600}","\u{1F62C}","\u{1F601}","\u{1F602}","\u{1F603}","\u{1F604}","\u{1F605}","\u{1F606}","\u{1F607}","\u{1F609}","\u{1F60A}","\u{1F642}","\u{1F643}","\u263A\uFE0F","\u{1F60B}","\u{1F60C}","\u{1F60D}","\u{1F618}","\u{1F617}","\u{1F619}","\u{1F61A}","\u{1F61C}","\u{1F61D}","\u{1F61B}","\u{1F911}","\u{1F913}","\u{1F60E}","\u{1F917}","\u{1F60F}","\u{1F636}","\u{1F610}","\u{1F611}","\u{1F612}","\u{1F644}","\u{1F914}","\u{1F633}","\u{1F61F}","\u{1F620}","\u{1F614}","\u{1F615}","\u{1F641}","\u2639\uFE0F","\u{1F623}","\u{1F62B}","\u{1F629}","\u{1F631}","\u{1F628}","\u{1F630}","\u{1F62F}","\u{1F626}","\u{1F622}","\u{1F62A}","\u{1F613}","\u{1F62D}","\u{1F635}","\u{1F632}","\u{1F910}","\u{1F637}","\u{1F912}","\u{1F915}","\u{1F634}","\u{1F480}","\u2620\uFE0F","\u{1F47D}","\u{1F63A}","\u{1F638}","\u{1F639}","\u{1F63B}","\u{1F63C}","\u{1F63D}","\u{1F640}","\u{1F63F}","\u{1F63E}","\u{1F444}","\u{1F48B}","\u{1F445}","\u{1F5E3}","\u{1F464}","\u{1F465}","\u{1F456}","\u{1F463}","\u{1F461}","\u{1F462}","\u{1F45E}","\u{1F45F}","\u{1F393}","\u{1F451}","\u{1F45C}","\u{1F45B}","\u{1F4BC}","\u{1F453}","\u{1F576}","\u{1F48D}","\u{1F302}","\u2744\uFE0F","\u{1F32A}","\u26A1\uFE0F","\u{1F951}","\u{1F98B}","\u{1F648}","\u{1F649}","\u{1F64A}","\u{1F427}","\u{1F577}","\u{1F982}","\u{1F980}","\u{1F40D}","\u{1F41B}","\u{1F40C}","\u{1F41E}","\u{1F41C}","\u{1F41F}","\u{1F421}","\u{1F42C}","\u{1F433}","\u{1F40B}","\u{1F40A}","\u{1F406}","\u{1F332}","\u{1F333}","\u{1F334}","\u{1F331}","\u{1F33F}","\u{1F343}","\u{1F342}","\u{1F341}","\u{1F33A}","\u{1F33C}","\u{1F338}","\u{1F330}","\u{1F383}","\u{1F41A}","\u{1F578}","\u{1F30E}","\u{1F30D}","\u{1F30F}","\u{1F315}","\u{1F316}","\u{1F317}","\u{1F318}","\u{1F311}","\u{1F312}","\u{1F313}","\u{1F314}","\u{1F31A}","\u{1F31D}","\u{1F31B}","\u{1F31C}","\u{1F31E}","\u{1F319}","\u2B50\uFE0F","\u{1F31F}","\u{1F4AB}","\u2728","\u2604\uFE0F","\u{1F354}","\u{1F373}","\u{1F35F}","\u{1F32D}","\u{1F35D}","\u{1F32E}","\u{1F32F}","\u{1F363}","\u{1F368}","\u{1F366}","\u{1F377}","\u{1F379}","\u{1F3C6}","\u{1F3AA}","\u{1F3B9}","\u{1F680}","\u26F2\uFE0F","\u{1F3A2}","\u26F0","\u{1F3D4}","\u{1F5FB}","\u{1F4AF}","\u{1F3B5}","\u{1F3B6}","\u{1F4AC}","\u{1F4AD}","\u{1F5EF}","\u{1F0CF}","\u{1F3F3}\uFE0F\u200D\u{1F308}","\u{1F953}","\u{1F943}","\u{1F3A4}","\u{1F6A8}","\u{1F3CD}","\u{1F3D5}","\u26FA\uFE0F","\u{1F3DC}","\u{1F3D6}","\u{1F3DD}","\u{1F307}","\u{1F306}","\u{1F3D9}","\u{1F303}","\u{1F3D8}","\u{1F3E1}","\u{1F3E2}","\u{1F528}","\u2699","\u{1F52B}","\u{1F4A3}","\u{1F52A}","\u{1F48A}","\u{1F573}","\u{1F489}","\u{1F6C1}","\u26F1","\u{1F381}","\u{1F388}","\u{1F380}","\u{1F4C5}","\u{1F5F3}","\u{1F4DA}","\u270F\uFE0F","\u26AA\uFE0F","\u26AB\uFE0F","\u2B1B\uFE0F","\u2B1C\uFE0F","\u{1F5BC}","\u{1F3DA}","\u{1F3ED}","\u{1F532}","\u{1F533}","\u{1F3B1}","\u{1F53A}","\u{1F53B}","\u{1F4A6}","\u26F3\uFE0F","\u{1F3DF}","\u{1F4A1}","\u{1F52D}","\u{1F52C}","\u{1F570}","\u{1F42A}","\u{1F42B}","\u{1F418}","\u{1F438}","\u{1F430}","\u{1F42D}","\u{1F6AA}","\u{1F6CD}","\u{1F441}","\u{1F353}","\u{1F352}","\u{1F336}","\u{1F33D}","\u{1F360}","\u{1F36F}","\u{1F35E}","\u{1F36B}","\u{1F37F}","\u{1F36A}","\u{1F34A}","\u{1F3F9}","\u{1F46F}","\u{1F46F}\u200D\u2642\uFE0F","\u{1F5D1}"]:i;var V=[];e.loop(this.emojiData,function(I){var te=new e.Emoji(I,w,o);V.push(te)}),this.wrapper=new e.Wrapper({items:V,width:t,alignInner:e.CENTER,valignInner:e.CENTER,wrapperType:"column",colSize:A,rowSize:R}).cur(),this.backdrop=new e.Rectangle(this.wrapper.width,this.wrapper.height,e.faint),e.timeout(.2,function(){q.scrollBar&&q.scrollBar.vertical&&q.scrollBar.vertical.getBounds()&&q.scrollBar.vertical.expand(),q.backdrop.heightOnly=q.wrapper.height,b&&q.wrapper.cache()}),this.add(this.backdrop),this.add(this.wrapper),this.wrapper.tap(function(I){q.currentEmoji=I.target,q.dispatchEvent("change")}),T!==!1&&e.styleTransforms(this,X),this.clone=function(){return q.cloneProps(new e.EmojiPicker(t,r,T,this.group,S))},this.dispose=function(){return!0}},e.extend(e.EmojiPicker,e.Window,["clone","dispose"],"zimWindow",!1),e.TextEditor=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B,Z,U,ee,ae,re,he,j,G){var y="width, color, backgroundColor, fieldColor, fieldHeight, textSize, sizeList, optionList, colorList, fontList, live, button, titleBar, titleBarColor, titleBarBackgroundColor, titleBarHeight, wrap, limit, scroll, placeholder, password, borderColor, borderWidth, margin, corner, shadowColor, shadowBlur, draggable, boundary, frame, fontListHeight, fontListViewNum, style, group, inherit",g;if(g=mt(e.TextEditor,arguments,y,this))return g;qe("67.1"),this.group=j;var d=he===!1?{}:e.getStyle("TextEditor",this.group,G);if(n(t)&&(t=d.width!=null?d.width:400),n(i)&&(i=d.backgroundColor!=null?d.backgroundColor:e.lighter),n(O)&&(O=d.titleBar!=null?d.titleBar:"Text Editor"),n(Z)&&(Z=d.draggable!=null?d.draggable:!0),n(R)&&(R=d.titleBarHeight!=null?d.titleBarHeight:30),n(o)&&(o=d.fieldColor!=null?d.fieldColor:i.darken(.05)),n(w)&&(w=d.live!=null?d.live:!0),n(T)&&(T=d.wrap!=null?d.wrap:!0),n(S)&&(S=d.scroll!=null?d.scroll:!0),n(V)&&(V=d.margin!=null?d.margin:10),n(L)&&(L=d.limit!=null?d.limit:null),n(O)&&(O=d.titleBar!=null?d.titleBar:null),n(h)&&(h=d.sizeList!=null?d.sizeList:null),n(_)&&(_=d.colorList!=null?d.colorList:null),n(p)&&(p=d.optionList!=null?d.optionList:null),n(b)&&(b=d.fontList!=null?d.fontList:null),n(o)&&(o=d.fieldColor!=null?d.fieldColor:null),n(l)&&(l=d.fieldHeight!=null?d.fieldHeight:null),n(f)&&(f=d.textSize!=null?d.textSize:null),n(ae)&&(ae=d.fontListHeight!=null?d.fontListHeight:100),n(re)&&(re=d.fontListViewNum!=null?d.fontListViewNum:3),typeof ee>"u")if(le.zdf)var ee=le.zdf;else{Ct&&ht("zim.TextEditor - please provide a reference to zim Frame");return}this.zimPanel_constructor(t,300,null,O,P,A,R,i,X,q,I,!0,null,null,null,null,null,null,null,null,te,B,Z,U,he,j,G);var D=this;n(C)&&(C=new e.Button({width:50,height:50,label:"",icon:new e.Shape().sca(.4).f("white").p("AikFsQg5jmhphxIA1gXQBeBGA3CwQC8mRCpjOIBfAoQkPFGiSFpg"),color:e.white,corner:10,backgroundColor:e.green.darken(.2),borderColor:e.white,borderWidth:2,rollBackgroundColor:e.green,shadowBlur:3}).pos(V,R+V*2,e.RIGHT,e.TOP,D)),D.button=C,C.on((Dt?e.ACTIONEVENT=="mousedown":le.ACTIONEVENT=="mousedown")?"mousedown":"click",K),n(l)&&(l=d.fieldHeight!=null?d.fieldHeight:C.height+V*2);function K(){w||(F.text=m.text),D.hide(),D.dispatchEvent("set")}var m=D.textArea=new e.TextArea({color:r,backgroundColor:o,width:t-C.width-V*3,height:n(l)?C.height+V*2:l,expand:10,password:k,placeholder:E,frame:ee}).loc(V,R+V+(l&&l<C.height+V*2?(C.height-l)/2+V:0),null,null,!1);T||(m.tag.style.whiteSpace="nowrap"),L&&m.tag.setAttribute("maxLength",L),S&&(m.tag.style.overflowY="auto");var F=new e.Label;D.on("pressmove",function(){m.resize()}),D.on("close",function(){D.inputEvent&&m.off("input",D.inputEvent),m.removeFrom()}),D.panelHeight=R+V+Math.max(l,C.height+V*2)+V;var Ce=e.mobile(),Y=Ce?35:30;if(h||p||_){new e.Rectangle(t,Y+V,"rgba(0,0,0,.05)").loc(0,D.panelHeight,D);var Q=[];if(_){var ce=Array.isArray(_),pe=D.colorPicker=new e.ColorPicker({colors:ce?_:null,cols:ce?Math.min(_.length,12):null,alphaPicker:!1,greyPicker:!ce,container:ee.stage});pe.on("close",Ae),pe.on("change",function(){F.color=r.color=pe.selectedColor,D.dispatchEvent("update"),Ae()}),D.closeColorPicker=function(){Ae()},r=D.swatch=new e.Rectangle(Y,Y,F.color,e.dark,1).cur(),r.on("mousedown",function(){D.dispatchEvent("color"),m.tag.style.display="none",pe.selectedColor=r.color,pe.show(),D.stage&&D.stage.update()}),Q.push(r)}if(p){p===!0&&(p=["bold","italic","align"]),n(le.STYLE)&&(le.STYLE={}),n(le.STYLE.group)&&(le.STYLE.group={}),le.STYLE.group.zimEditor={width:Y,height:Y,corner:0,borderColor:e.tin,shadowBlur:-1,backgroundColor:e.light,rollBackgroundColor:e.light,toggleBackgroundColor:e.green,toggleColor:e.grey};var J,ue,ye;e.loop(p,function(Be){if(Be.toLowerCase()=="bold")J=D.bold=new e.Button({label:new e.Label({text:"B",color:e.grey,size:16,bold:!0}),toggle:"B",group:"zimEditor"}),J.on("click",function(){F.bold=J.toggled,D.dispatchEvent("update"),D.stage&&D.stage.update()}),Q.push(J),F.bold&&J.toggle();else if(Be.toLowerCase()=="italic")ue=D.italic=new e.Button({label:new e.Label({text:"I",color:e.grey,size:16,bold:!0,italic:!0}),toggle:"I",group:"zimEditor"}),ue.on("click",function(){F.italic=ue.toggled,D.dispatchEvent("update"),D.stage&&D.stage.update()}),Q.push(ue),F.italic&&ue.toggle();else if(Be.toLowerCase()=="align"){var me=new e.Tile(new e.Rectangle(Y-10,Y-10,e.grey).centerReg(),3,1,10,10),Oe=Ce?["\u21DA","\u21D4","\u21DB"]:["\u21D0","\u21D4","\u21D2"];e.loop(3,function(de){var ve=me.getChildAt(de);new e.Label(Oe[de],Y*2/3,null,e.white).center(ve).expand(10)});var Ye=0;F.align=="right"?Ye=2:(F.align=="center"||F.align=="middle")&&(Ye=1),ye=D.align=new e.Selector({tile:me,corner:0,borderWidth:1,borderColor:e.grey,backgroundColor:e.clear,selectedIndex:Ye}),ye.on("change",function(){ye.selectedIndex==0?F.align="left":ye.selectedIndex==1&&(F.align="center"),ye.selectedIndex==2&&(F.align="right"),D.dispatchEvent("update"),D.stage&&D.stage.update()}),Q.push(ye)}}),delete le.STYLE.group.zimEditor}if(h){var Xe=D.sizePicker=new e.Stepper({list:h===!0?null:h,stepperType:h===!0?null:"list",min:h===!0?5:null,max:h===!0?500:null,width:150,shadowBlur:-1,borderColor:e.dark,borderWidth:2,corner:0,backgroundColor:e.green,downForward:!1}).siz(null,Y);Xe.arrowPrev.expand(0),Xe.textBox.color=e.lighter,Xe.on("change",function(){F.size=Xe.currentValue,D.dispatchEvent("update"),D.stage&&D.stage.update()}),Xe.currentValue=F.size,Q.push(Xe)}var se=new e.Tile(Q,Q.length,1,10,10,!0).loc(V,D.panelHeight+V/2,D);D.panelHeight=D.panelHeight+V+se.height+V}function Ae(){m.tag.style.display="block",pe.hide(),D.stage&&D.stage.update()}var ie;if(b){Array.isArray(b)?ie=b:(ie=["Arial","Courier New","Georgia","Helvetica","Palatino","Tahoma","Verdana"],Ce||(ie=ie.concat(["Comic Sans MS","Impact"])),ie.sort());var _e=D.fonts=new e.List({width:t-V*2,height:ae,viewNum:re,backgroundColor:e.moon,color:e.grey,rollColor:e.dark,rollBackgroundColor:e.green.lighten(.5),selectedBackgroundColor:e.mist,selectedRollBackgroundColor:e.green.lighten(.6),selectedColor:e.dark,backdropColor:e.light,scrollBarColor:e.dark,shadowBlur:-1,list:ie}).center(D).loc(null,D.panelHeight);_e.on("change",function(){F.font=_e.currentValue,D.dispatchEvent("update"),D.stage&&D.stage.update()}),D.panelHeight=D.panelHeight+V+_e.height+V}D.show=function(Be,me,Oe,Ye){if(D.parent)return Be==D.label||(D.label=Be),D;F=Be,m.addTo(D);var de;if(F&&F.stage)de=F.stage;else if(Ye)de=Ye.stage;else if(le.zdf)de=le.zdf.stage;else return D;return!n(me)||!n(Oe)?D.loc(me,Oe):F&&F.y>de.height/2?D.loc(de.width/2-t/2,F.y-D.panelHeight-de.height*.05,de):F&&F.y<=de.height/2?D.loc(de.width/2-t/2,F.y+F.height+de.height*.05,de):D.center(de),D.y<20&&(D.y=20),D.y+D.height>D.stage.height&&(D.y=D.stage.height-D.height-20),$(),D.stage.update(),D};function $(){F&&(m.text=F.text),r&&(r.color=F.color),J&&J.toggle(F.bold==!0),ue&&ue.toggle(F.italic==!0),ye&&(ye.noAnimate=!0,F.align=="center"?ye.selectedIndex=1:F.align=="right"?ye.selectedIndex=2:ye.selectedIndex=0),Xe&&(Xe.currentValue=F.size),_e&&(_e.currentValue=F.font),D.inputEvent&&m.off("input",D.inputEvent),D.inputEvent=m.on("input",function(){w&&F&&(F.text=m.text),D.dispatchEvent("input"),D.dispatchEvent("update"),D.stage&&D.stage.update()})}D.hide=function(){if(_&&pe.hide(),m&&m.removeFrom(),!n(D.stage)){var Be=D.stage;return D.removeFrom(),Be.update(),D}},le.KEYFOCUS!=null&&(e.KEYFOCUS=le.KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return e.KEYFOCUS==D},set:function(){e.KEYFOCUS=D}}),e.KEYFOCUS||xe(),this.on("mousedown",function(){xe()});function xe(){D.keyFocus=!0}Object.defineProperty(D,"label",{get:function(){return F},set:function(Be){F=Be,$()}}),he!==!1&&e.styleTransforms(this,d),this.clone=function(){return D.cloneProps(new e.TextEditor(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B,Z,U,ee,ae,re,he,this.group,G))},this.dispose=function(Be,me,Oe){return D.inputEvent&&m.off("input",D.inputEvent),pe&&pe.dispose(),r&&r.dispose(),_e&&_e.dispose(),C&&C.dispose(),m&&m.dispose(),ye&&ye.dispose(),J&&J.dispose(),ue&&ue.dispose(),Xe&&Xe.dispose(),Oe||this.zimPanel_dispose(),D.stage&&D.stage.update(),D.textArea=D.color=D.colorPicker=D.font=D.button=D.selector=D.bold=D.italic=D.size=null,!0}},e.extend(e.TextEditor,e.Panel,["clone","dispose"],"zimPanel",!1),e.Keyboard=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B,Z,U,ee,ae,re,he){var j="labels, backgroundColor, color, shiftBackgroundColor, shiftHoldBackgroundColor, placeBackgroundColor, placeColor, cursorColor, shadeAlpha, borderColor, borderWidth, margin, corner, draggable, placeClose, shadowColor, shadowBlur, container, data, place, placeShiftH, placeShiftV, special, rtl, hardKeyboard, layout, numPadScale, numPadDraggable, numPadOnly, numPadAdvanced, style, group, inherit",G;if(G=mt(e.Keyboard,arguments,j,this))return G;qe("67.2"),this.zimContainer_constructor(1e3,400,null,null,!1),this.type="Keyboard",this.group=re;var y=ae===!1?{}:e.getStyle(this.type,this.group,he);n(t)&&(t=y.labels!=null?y.labels:[]),Array.isArray(t)||(t=[t]),n(r)&&(r=y.backgroundColor!=null?y.backgroundColor:e.dark),n(i)&&(i=y.color!=null?y.color:e.white),n(o)&&(o=y.shiftBackgroundColor!=null?y.shiftBackgroundColor:"orange"),n(l)&&(l=y.shiftHoldBackgroundColor!=null?y.shiftHoldBackgroundColor:"red"),n(f)&&(f=y.placeBackgroundColor!=null?y.placeBackgroundColor:e.blue),n(h)&&(h=y.placeColor!=null?y.placeColor:i),n(p)&&(p=y.cursorColor!=null?y.cursorColor:e.blue),n(_)&&(_=y.shadeAlpha!=null?y.shadeAlpha:.2),n(b)&&(b=y.borderColor!=null?y.borderColor:"rgba(0,0,0,.1)"),n(w)&&(w=y.borderWidth!=null?y.borderWidth:null),b<0||w<0?b=w=null:b!=null&&w==null&&(w=1),n(C)&&(C=y.margin!=null?y.margin:5),n(O)&&(O=y.corner!=null?y.corner:30),n(P)&&(P=y.draggable!=null?y.draggable:!1),n(A)&&(A=y.placeClose!=null?y.placeClose:!0),n(R)&&(R=y.shadowColor!=null?y.shadowColor:"rgba(0,0,0,.2)"),n(T)&&(T=y.shadowBlur!=null?y.shadowBlur:14),n(S)&&(S=y.data!=null?y.data:[[["q","w","e","r","t","y","u","i","o","p"],["a","s","d","f","g","h","j","k","l"],["shift","z","x","c","v","b","n","m","backspace"],["?123","@"]],[["1","2","3","4","5","6","7","8","9","0"],["!","@","#","$","/","^","&","*","(",")"],["1/2","-","'",'"',":",";",",","?","backspace"],["ABC","@"]],[["+","x","%","=","<",">","{","}","[","]"],["\u20AC","\xA3","\xA5","$","\uFFE6","~","`","\xA4","\u2661","\u2606"],["2/2","_","\\","|","\u300A","\u300B","\xA1","\xBF","backspace"],["ABC","@"]]]),S[3]||(S[3]={e:["\u0117","\u0113","\u0119","\xEA","\xE9","\xEB","\xE8"],u:["\u016B","\xFB","\xFA","\xFC","\xF9"],i:["\u012B","\u012F","\xEC","\xED","\xEF","\xEE"],o:["\u014D","\u0153","\xF8","\xF5","\xF4","\xF3","\xF6","\xF2"],a:["\u0101","\xE3","\xE5","\xE2","\xE1","\xE4","\xE0","\xE6"],n:["\xF1","\u0144"]});var g=this;n(E)&&(E=y.place!=null?y.place:!0),n(k)&&(k=y.placeShiftH!=null?y.placeShiftH:0),n(X)&&(X=y.placeShiftV!=null?y.placeShiftV:0),n(V)&&(V=y.rtl!=null?y.rtl:!1),n(I)&&(I=y.hardKeyboard!=null?y.hardKeyboard:!0),n(B)&&(B=y.numPadScale!=null?y.numPadScale:.8),n(U)&&(U=y.numPadOnly!=null?y.numPadOnly:!1),n(Z)&&(Z=y.numPadDraggable!=null?y.numPadDraggable:!0),n(ee)&&(ee=y.numPadAdvanced!=null?y.numPadAdvanced:!1),n(te)&&(te=y.layout!=null?y.layout:"qwerty"),te=te.toLowerCase(),te!="qwerty"&&(te=="arabic"?S=[[["\u0636","\u0635","\u062B","\u0642","\u0641","\u063A","\u0639","\u0647","\u062E","\u062D","\u062C"],["\u0634","\u0633","\u064A","\u0628","\u0644","\u0627","\u062A","\u0646","\u0645","\u0643","\u0637"],["\u0630","\u0621","\u0624","\u0631","\u0649","\u0629","\u0648","\u0632","\u0638","\u062F","back"],["?123","\u0640"]],[["1","2","3","4","5","6","7","8","9","0","*"],["!","@","#","$","/","^","&","*","(",")","*"],["1/2","-","'",'"',":",";",",","?","*","backspace"],["ABC","*"]],[["+","x","%","=","<",">","{","}","[","]","*"],["\u20AC","\xA3","\xA5","$","\uFFE6","~","`","\xA4","\u2661","\u2606","*"],["2/2","_","\\","|","\u300A","\u300B","\xA1","\xBF","*","backspace"],["ABC","*"]],{\u0627:["\u0623","\u0625","\u0622","\u0621"],\u0649:["\u0626"],\u0621:["\u0626","\u0624"],\u0648:["\u0624"],\u0640:["\u064D","\u064B","\u064C","\u0652","\u064F","\u0650","\u064E","\u0651"],"*":["\u064D","\u064B","\u064C","\u0652","\u064F","\u0650","\u064E","\u0651"],n:["\xF1","\u0144"]}]:te=="hebrew"?S=[[["\u05E7","\u05E8","\u05D0","\u05D8","\u05D5","\u05DF","\u05DD","\u05E4","backspace"],["\u05E9","\u05D3","\u05D2","\u05DB","\u05E2","\u05D9","\u05D7","\u05DC","\u05DA","\u05E3"],["\u05D6","\u05E1","\u05D1","\u05E0","\u05D4","\u05DE","\u05E6","\u05EA","\u05E5"],["?123","@"]],[["1","2","3","4","5","6","7","8","9","0"],["!","@","#","$","/","^","&","*","(",")"],["1/2","-","'",'"',":",";",",","?","backspace"],["ABC","@"]],[["+","x","%","=","<",">","{","}","[","]"],["\u20AC","\xA3","\xA5","$","\uFFE6","~","`","\xA4","\u2661","\u2606"],["2/2","_","\\","|","\u300A","\u300B","\xA1","\xBF","backspace"],["ABC","@"]],{e:["\u0117","\u0113","\u0119","\xEA","\xE9","\xEB","\xE8"],u:["\u016B","\xFB","\xFA","\xFC","\xF9"],i:["\u012B","\u012F","\xEC","\xED","\xEF","\xEE"],o:["\u014D","\u0153","\xF8","\xF5","\xF4","\xF3","\xF6","\xF2"],a:["\u0101","\xE3","\xE5","\xE2","\xE1","\xE4","\xE0","\xE6"],n:["\xF1","\u0144"]}]:te=="azerty"?S=[[["a","z","e","r","t","y","u","i","o","p"],["q","s","d","f","g","h","j","k","l","m"],["shift","w","x","c","v","b","n","\xB4","backspace"],["?123","@"]],[["1","2","3","4","5","6","7","8","9","0"],["!","@","#","$","/","^","&","*","(",")"],["1/2","-","'",'"',":",";",",","?","backspace"],["ABC","@"]],[["+","x","%","=","<",">","{","}","[","]"],["\u20AC","\xA3","\xA5","$","\uFFE6","~","`","\xA4","\u2661","\u2606"],["2/2","_","\\","|","\u300A","\u300B","\xA1","\xBF","backspace"],["ABC","@"]],{e:["\u0117","\u0113","\u0119","\xEA","\xE9","\xEB","\xE8"],u:["\u016B","\xFB","\xFA","\xFC","\xF9"],i:["\u012B","\u012F","\xEC","\xED","\xEF","\xEE"],o:["\u014D","\u0153","\xF8","\xF5","\xF4","\xF3","\xF6","\xF2"],a:["\u0101","\xE3","\xE5","\xE2","\xE1","\xE4","\xE0","\xE6"],n:["\xF1","\u0144"]}]:te=="turkish"&&(S=[[["q","w","e","r","t","y","u","\u0131","o","p","\u011F","\xFC"],["a","s","d","f","g","h","j","k","l","\u015F","i"],["shift","z","x","c","v","b","n","m","\xF6","\xE7","backspace"],["?123","*"]],[["1","2","3","4","5","6","7","8","9","0","*"],["!","@","#","$","/","^","&","*","(",")","*"],["1/2","-","'",'"',":",";",",","?","*","backspace"],["ABC","*"]],[["+","x","%","=","<",">","{","}","[","]","*"],["\u20AC","\xA3","\xA5","$","\uFFE6","~","`","\xA4","\u2661","\u2606","*"],["2/2","_","\\","|","\u300A","\u300B","\xA1","\xBF","*","backspace"],["ABC","*"]],{e:["\u0117","\u0113","\u0119","\xEA","\xE9","\xEB","\xE8"],u:["\u016B","\xFB","\xFA","\xFC","\xF9"],i:["\u012B","\u012F","\xEC","\xED","\xEF","\xEE"],o:["\u014D","\u0153","\xF8","\xF5","\xF4","\xF3","\xF6","\xF2"],a:["\u0101","\xE3","\xE5","\xE2","\xE1","\xE4","\xE0","\xE6"],n:["\xF1","\u0144"]},{\u0131:"I",i:"\u0130"},{I:"\u0131",\u0130:"i"}])),g.data=S;var d="zim display - Keyboard(): Please pass in a reference to a container with bounds set";if(n(L))if(le.zdf)L=le.zdf.stage;else{ht(d);return}else if(L.getBounds){if(n(L.stage)){ht("zim display - Keyboard(): The container must have a stage property");return}}else{ht(d);return}R!=-1&&T>0&&(g.shadow=new $e.Shadow(R,3,3,T));var D=le.zdf?le.zdf.stage:null;g.labels=t;var K,m=10;e.loop(S[0],function(Re){Re.length>m&&(m=Re.length)});var F=m,Ce=["/","",",",".","numpad","away"];n(q)||Ce.splice(1,0,q);var Y=e.copy(S[0]);Y[3]=Y[3].concat(Ce);var Q=e.copy(S[1]);Q[3]=Q[3].concat(Ce);var ce=e.copy(S[2]);ce[3]=ce[3].concat(Ce);var pe=[],J=(1e3-(F-1)*5)/F,ue={def:"default",shift:"shift",number1:"number1",number2:"number2"},ye=ue.def,Xe,se,Ae,ie=!1,_e,$,xe=0,Be,me=[],Oe,Ye,de,ve,Me,we,Fe,ge;Qe(),fe(ye),P&&Ke(),this.on("mousedown",Ve);function Ve(Re){D=g.stage,se&&g.removeChild(se),Be&&me.indexOf(Re.target)<0&&Pe(),n(Re.target.na)||(P&&Re.target===Fe?(g.tickerMouseEvent=D.on("stagemousemove",function(Ze){g.mouseYAmount=Ze.stageY}),e.Ticker.add(yt),g.on("pressup",We),ge=Re.stageY-g.localToGlobal(0,0).y):!n(q)&&Re.target.na===q?g.dispatchEvent("special"):Re.target.na==="shift"?Le():Re.target.toggle==="?123"?(g.removeChild(Xe),fe(ue.number1)):Re.target.toggle==="ABC"?(g.removeChild(Xe),ye=ue.def,fe(),ie&&Le(!0)):Re.target.toggle==="1/2"?(g.removeChild(Xe),fe(ue.number2)):Re.target.toggle==="2/2"?(g.removeChild(Xe),fe(ue.number1)):Re.target.na==="numpad"?st(Re.target):Re.target.na==="away"?(g.hideKeyboard(),g.dispatchEvent("close")):S[3]&&S[3][Re.target.na]?Ge(Re.target.na):Re.target.na==="return"?Ie("\n"):Re.target.na==="backspace"||Re.target.na==="back"?it():Re.target.na===""?Ie(" "):Ie(Re.target.na),D.update())}g.addChar=function(Re){!n(Re)&&Re.match(/^.$/)&&Ie(Re)},g.removeChar=function(){it(!0)},g.clearText=function(){$.text="",it(!0),ze(),g.selectedIndex=0},g.setText=function(Re){$.text=Re,ze(),g.selectedIndex=Re.length};var He;function Le(Re){var Ze=!1,Je,nt;if(ye===ue.def){for(_e.color=Re?l:o,Je=0;Je<pe.length-6-(n(q)?0:1);Je++)nt=pe[Je],nt.label.text.length>0&&(nt.na.length===1?(S[4]&&S[4][nt.label.text]?nt.label.text=S[4][nt.label.text]:nt.label.text=nt.label.text.toUpperCase(),nt.label.centerReg(nt).mov(0,6)):nt.label.centerReg(nt));Re||(Ze=!0,setTimeout(pt,500),He=g.on("pressup",De)),ye=ue.shift}else{for(_e.color=r,ie=!1,Je=0;Je<pe.length-6;Je++)nt=pe[Je],nt.label.text.length>0&&(nt.na.length===1?(S[5]&&S[5][nt.label.text]?nt.label.text=S[5][nt.label.text]:nt.label.text=nt.label.text.toLowerCase(),nt.label.centerReg(nt).mov(0,3)):nt.label.centerReg(nt));ye=ue.def}Xe.updateCache(),g.stage&&g.stage.update();function pt(){Ze&&(ie=!0,_e.color=l,Xe.updateCache(),g.stage&&g.stage.update())}function De(){g.off("pressup",He),Ze=!1}}function fe(Re){var Ze,Je,nt,pt=0,De=0,lt,vt,rt=!1,xt,wt,_t=!1;n(Re)&&(Re=ue.def),Re===ue.def?Ze=Y:Re===ue.number1?Ze=Q:Re===ue.number2&&(Ze=ce),g.keys=Xe=new e.Container(1e3,430,null,null,!1).addTo(g).vis(!U);for(var ft=0;ft<Ze.length;ft++){(ft<=1||Re==ue.def&&ft==2&&Ze[2][0]!="shift")&&(pt=(J/2+2.5)*(F-Ze[ft].length));for(var Ot=0;Ot<Ze[ft].length;Ot++){if(rt=!1,xt=null,_t=!1,Ze[ft][Ot]=="backspace"?(vt=!0,xt=Ye,_t=!0):Ze[ft][Ot]=="back"?(vt=!1,xt=Ye,_t=!0):Ze[ft][Ot]=="shift"?(vt=!0,xt=Oe):(ft==3||Re!=ue.def&&ft==2)&&Ot==0?(vt=!0,_t=!0):Ze[ft][Ot]==""?(vt=!1,rt=!0):Ze[ft][Ot]=="numpad"?(xt=ve,vt=!1,_t=!0):Ze[ft][Ot]=="away"?(xt=de,vt=!0,_t=!0):vt=!1,vt?lt=J*1.5+2.5:rt?(lt=(J+5)*((n(q)?3:2)+F-10+1-S[0][3].length)-5,S[0][3].indexOf("backspace")!=-1&&(lt-=J/2)):lt=J,nt=new e.Rectangle(lt,J,r,b,w,O,null,null,null,!1).cur().addTo(Xe),_t&&nt.addChild(new e.Rectangle(lt,J,"black",null,null,O,null,null,null,!1).alp(_)),xt?nt.label=Je=new e.Label({text:"",backgroundColor:"ignore",font:y.font!=null?y.font:null,style:!1}):nt.label=Je=new e.Label({lineWidth:10,lineHeight:25,font:y.font!=null?y.font:null,text:Ze[ft][Ot],color:i,align:"center",style:!1}),xt){var Rt=xt.clone(),St;Ze[ft][Ot]=="numpad"?(St=60,we=nt):St=70,Rt.scaleTo(nt,St,St),Rt.centerReg(nt)}wt?(wt=!1,pt+=67.33):(Je.centerReg(nt).mov(0,isNaN(Je.text)?3:7),nt.x=pt,nt.y=De,nt.na=Ze[ft][Ot],ft==2&&Ot==0&&Re==ue.number1&&(nt.toggle="1/2"),ft==2&&Ot==0&&Re==ue.number2&&(nt.toggle="2/2"),ft==3&&Ot==0&&Re==ue.def&&(nt.toggle="?123"),ft==3&&Ot==0&&Re!=ue.def&&(nt.toggle="ABC"),nt.toggle&&Je.mov(0,3),pe.push(nt),nt.na=="shift"&&(_e=nt),pt=nt.x+nt.width+5)}De+=J+5,pt=0}Xe.cache(w?-w:0,w?-w:0,w?Xe.width+w*2:Xe.width,w?Xe.height+w*2:Xe.height)}function Ge(Re){var Ze=S[3][Re],Je=!1,nt=!1,pt;pt=e.timeout(500,vt,null,"ms");var De=g.on("pressup",lt);function lt(){Je=!0,g.off("pressup",De),nt||Ie(Re)}function vt(){var rt,xt,wt,_t=0,ft;if(pt.clear(),!Je){nt=!0,se=new e.Container(1e3,J,null,null,!1).addTo(g,0),se.y=-J-5;for(var Ot=0;Ot<Ze.length;Ot++)ye===ue.shift?ft=Ze[Ot].toUpperCase():ft=Ze[Ot],rt=new e.Label({lineWidth:10,lineHeight:25,text:ft,font:y.font!=null?y.font:null,color:i,align:"center",style:!1}),xt=new e.Rectangle(J,J,r,b,w,O,null,null,null,!1).addTo(se),wt=new e.Rectangle(J,J,"white",null,null,O,null,null,null,!1).alp(.2),xt.addChild(wt),rt.center(xt),xt.na=Ze[Ot],xt.x=_t,_t+=J+5;g.stage&&g.stage.update()}}}function Qe(){Oe=new e.Shape({style:!1}),Oe.graphics.f(i).p("AhIFoIAAjYIixAAID5n3ID6H3IixAAIAADYgAjHBxICeAAIAADYIBTAAIAAjYICeAAIjImSg"),Oe.setBounds(-51/2,-72/2,51,72),Ye=new e.Container({style:!1});var Re=new e.Shape({style:!1});Re.graphics.f(i).p("ACgC+IigigIifCgQgGAGgJAAQgJAAgGgGQgGgGgBgJQABgJAGgGICgigIigifQgGgGgBgJQABgJAGgGQAGgGAJAAQAIAAAHAGICfCgICgigQAGgGAJAAQAJAAAGAGQAGAGABAJQgBAJgGAGIigCfICgCgQAGAGABAJQgBAJgGAGQgGAGgJAAQgJAAgGgGg"),Re.setTransform(82.6,32),Re.addTo(Ye);var Ze=new e.Shape({style:!1});Ze.graphics.f(i).s().p("AkhFAQgcAAgUgUIkHj6QgVgUAAgeQAAgdAVgVIEHj6QAUgTAcAAINKAAQAdAAAUAUQAUAUAAAdIAAH1QAAAdgUATQgUAVgdAAgAk0kOIkGD8QgIAHAAALQAAALAIAIIEGD7QAIAHALAAINKAAQALAAAIgIQAHgHAAgLIAAn1QAAgLgHgIQgIgIgLAAItKAAQgLAAgIAHg"),Ze.setTransform(62.2,32),Ze.addTo(Ye),Ye.setBounds(0,0,125,64),de=new e.Container({style:!1}),de.setBounds(0,0,147,86);for(var Je=[{p:"Ai+heIF9AAIi/C9g",transform:[73.4,76]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[128.4,43.2]},{p:"AnNAzIAAhlIObAAIAABlg",transform:[73,43.2]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[18.8,43.2]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[128.2,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[114.5,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[100.8,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[87.1,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[73.4,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[59.7,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[46,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[32.3,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[18.6,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[128,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[114.3,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[100.6,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[86.9,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[73.2,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[59.5,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[45.8,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[32.1,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[18.4,15.8]},{p:"AphEnQgzAAgkgkQglglAAgzIAAlVQAAgzAlglQAkgkAzAAITDAAQAzAAAkAkQAlAlAAAzIAAFVQAAAzglAlQgkAkgzAAgAqjjtQgcAcAAAnIAAFVQAAAnAcAbQAbAcAnAAITDAAQAnAAAcgcQAbgbAAgnIAAlVQAAgngbgcQgcgcgnAAIzDAAQgnAAgbAcg",transform:[73.4,29.5]}],nt,pt=0;pt<Je.length;pt++)nt=new e.Shape({style:!1}),nt.graphics.f(i).s().p(Je[pt].p),nt.setTransform(Je[pt].transform[0],Je[pt].transform[1]),nt.addTo(de);ve=new e.Container({style:!1}),ve.setBounds(0,0,62,86),Me=new e.Container({style:!1}),Me.setBounds(0,0,62,86);for(var De=[{p:"Ai+heIF9AAIi/C9g",transform:[33,76,1,1,180]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[46,43.2]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[32.3,43.2]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[18.8,43.2]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[46,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[32.3,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[18.6,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[45.8,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[32.1,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[18.4,15.8]}],pt=0;pt<De.length;pt++){var lt=new e.Shape({style:!1});lt.graphics.f(i).s().p(De[pt].p),lt.setTransform(De[pt].transform[0],De[pt].transform[1],De[pt].transform[2],De[pt].transform[3],De[pt].transform[4]),lt.addTo(ve);var vt=new e.Shape({style:!1});vt.graphics.f(i).s().p(De[pt].p),vt.setTransform(De[pt].transform[0],De[pt].transform[1]),vt.addTo(Me)}lt.graphics.ef().s(white).ss(3).rr(-16,-14,60,55,10),vt.graphics.ef().s(white).ss(3).rr(-16,-14,60,55,10)}function Ke(){Fe=new e.Rectangle(J*1.5+2.5+2.5,J,r,b,w,O,null,null,null,!1).addTo(g,0).cur();for(var Re,Ze=0;Ze<4;Ze++)Re=new e.Rectangle(Fe.width*.4,4,i,null,null,null,null,null,null,!1).centerReg(Fe).alp(.2),Re.y-=-22+Ze*15;Fe.x=8.5*J+40,Fe.y=-J-5,Fe.na="drag"}function st(Re){g.numPad||(g.numPad=new e.NumPad({advanced:ee,draggable:Z}).sca(B),Z||U?g.numPad.center({add:!1}):g.numPad.pos({x:0,y:8,horizontal:"center",vertical:"bottom",add:!1}),g.numPad.on("pressed",function(){g.numPad.key=="enter"?g.dispatchEvent("enter"):g.numPad.key=="backspace"?g.removeChar():g.numPad.key=="clear"?g.clearText():g.numPad.key=="space"?Ie(" "):Ie(g.numPad.key)}),g.numPad.on("close",function(){we.removeChildAt(2),ve.clone().scaleTo(we,60,60).centerReg(we,2),Xe.updateCache(),(!g.keys.parent||!g.keys.visible)&&Ae&&(Ae.visible=!1,g.toggled=!1,Pe())})),we.removeChildAt(2),g.numPad.parent||Re===!1?(g.numPad.removeFrom(),ve.clone().scaleTo(we,60,60).centerReg(we,2)):(!g.numPad.parent||Re===!0)&&(g.numPad.addTo(),Me.clone().scaleTo(we,60,60).centerReg(we,2)),Xe.updateCache(),g.stage&&g.stage.update()}function yt(){g.mouseYAmount&&(g.y=g.parent.globalToLocal(0,g.mouseYAmount-ge).y)}function We(){D.off("pressmousemove",g.tickerMouseEvent),e.Ticker.remove(yt)}g.setBounds(1e3,400-(F-10)*26);function at(){if(!(!$||!Ae)){for(var Re=$.label.x+$.label.getBounds().x,Ze=0;Ze<xe;Ze++)Re+=$.widthArray[Ze]?$.widthArray[Ze]:0;Ae.heightOnly=$.getBounds().height*($.backing&&n($.padding)?.9:1)-($.paddingV&&$.background?$.paddingV*2:0),Ae.center($),Ae.x=Re}}function ct(){if(Be||!$)return g;var Re=A?["<",">","x"]:["<",">"],Ze,Je,nt;me=[],nt=$.localToLocal(0,0,g),Be=g.place=new e.Container({style:!1}).addTo(g).cur();for(var pt=0;pt<Re.length;pt++)Ze=new e.Rectangle(J,J,f,b,w,O,null,null,null,!1),Re[pt]=="x"&&new e.Rectangle(J,J,"black",null,null,O,null,null,null,!1).alp(_).addTo(Ze),Je=new e.Label({lineWidth:10,text:Re[pt],backing:Ze,font:y.font!=null?y.font:null,color:h,align:"center",valign:"center",style:!1}),Je.pos(0,0,e.LEFT,e.TOP,Be).cache(),Je.x=Je.x+pt*(J+5),me.push(Je);nt=$.localToLocal(0,0,g),Be.x=nt.x+k,Be.y=nt.y+$.height+15+X,Be.on("click",De);function De(lt){me.indexOf(lt.target)==0?xe>0&&xe--:me.indexOf(lt.target)==1?xe<$.text.length&&xe++:Pe(),at()}g.stage&&g.stage.update()}function Pe(){if(!Be)return g;Be.dispose(),Be=null}function Ie(Re){if($){var Ze,Je;if(Re==="del")$&&($.text=[$.text.slice(0,xe-1),$.text.slice(xe)].join("")),xe--,ze();else{ye===ue.shift&&(Re=Re.toUpperCase());var nt=$.text;Ze=$.clone().removeFrom(),Ze.text=Re,Je=Ze.label.getMeasuredWidth(),$.widthArray?$.widthArray.splice(xe,0,Je):$.widthArray=[$.breedte],xe<$.text.length?$.text=[$.text.slice(0,xe),Re,$.text.slice(xe)].join(""):$.text+=Re,$&&$.label.getBounds().width<K?(xe++,at()):$.text=nt}ye===ue.shift&&!ie&&(g.removeChild(Xe),fe(),ye=ue.def),at();var pt=new $e.Event("keydown");pt.letter=Re,g.dispatchEvent(pt),g.stage&&g.stage.update()}}function be(Re){if(g.stage){var Ze,Je=0,nt=!1;$=Re.target,$.widthArrayCheck||ze(),K=$.label.lineWidth?$.label.lineWidth:1e4,Ze=$.globalToLocal(Re.stageX/e.scaX,Re.stageY/e.scaY),Ze.x-=$.label.x,Ze.y-=$.label.y;for(var pt=0;pt<$.widthArray.length;pt++)if(Je+=$.widthArray[pt],Ze.x<Je-$.widthArray[pt]/2+$.label.getBounds().x){xe=pt,nt=!0;break}nt||(xe=$.text.length),at(),E&&!Be&&$.text.length>0&&ct(),Be&&$&&($.text.length>0?(Ze=$.localToLocal(0,0,g),Be.x=Ze.x+k,Be.y=Ze.y+$.height+15+X):Pe())}}function ze(){if($){var Re=new e.Label("");$.widthArray=[];for(var Ze=0;Ze<$.text.length;Ze++)Re=$.clone().removeFrom(),Re.text=$.text[Ze],$.widthArray.push(Re.label.getMeasuredWidth());Re.text=$.text,$.widthArrayCheck=!0,at()}}function it(Re){var Ze=!0,Je;function nt(){(!$||$.text.length<1||g.currentIndex==0)&&(Ze=!1),Ze&&(pt(),Je&&(Je=e.timeout(200,nt,null,"ms"))),$&&$.text.length<1&&De()}function pt(){$&&$.text.length>0?(g.selectedIndex>0&&Ie("del"),Re?De():g.on("pressup",De)):Ie("del")}function De(){Ze=!1,Je&&Je.clear(),g.off("pressup",De)}pt(),Je=e.timeout(300,nt,null,"ms"),g.stage&&g.stage.update()}function je(){for(var Re=0;Re<t.length;Re++)t[Re].clickEvent=t[Re].on("click",be)}je();function tt(){if(t.length>1)for(var Re=0;Re<t.length;Re++)t[Re].off("click",t[Re].clickEvent)}function Te(){if(!Ae&&($=t[0],K=$&&$.label.lineWidth?$.label.lineWidth:1e4,$)){Ae=new e.Rectangle(3,$.height-($.paddingV&&$.background?$.paddingV*2:0),p,null,null,null,null,null,null,!1).center($),Ae.x=0,Ae.visible=!1,Ae.animate({obj:{alpha:0},rewind:!0,loop:!0,loopWait:750,time:250,id:"knipperTekst",timeUnit:"ms"});for(var Re=0;Re<t.length;Re++)t[Re].widthArray=[0];ze()}}Te();function et(){e.stopAnimate("knipperTekst"),$&&$.removeChild(Ae),Ae=null,$=null}Object.defineProperty(this,"selectedLabel",{get:function(){return $},set:function(Re){var Ze={target:Re};be(Ze),g.hidePlace()}}),Object.defineProperty(this,"selectedIndex",{get:function(){return xe},set:function(Re){xe=Re,at()}}),this.show=function(Re,Ze){if(g.addTo(L),!n(Re)){var Je={target:t[Re]};be(Je)}return Ae&&(Ae.visible=!0),g.toggled=!0,U?st():(!U||Ze)&&(g.keys.vis(!0),Ue.vis(!0)),g.numPad&&g.numPad.parent&&g.numPad.top(),g},this.hide=function(){return g.removeFrom(L),st(!1),Ae&&(Ae.visible=!1),D.update(),g.toggled=!1,g},this.showNumPad=function(){st(!0),g.toggled=!0,Ae&&(Ae.visible=!0)},this.hideNumPad=function(){st(!1),(!g.keys.parent||!g.keys.visible)&&Ae&&(Ae.visible=!1,g.toggled=!1,Pe())},this.showKeyboard=function(){g.show(null,!0)},this.hideKeyboard=function(){!g.numPad||!g.numPad.parent?g.hide():(g.keys.vis(!1),Ue.vis(!1))},this.toggle=function(Re){return Re===!0?g.show():Re===!1||g.parent?g.hide():g.show(),g},this.showPlace=function(){return ct(),g},this.hidePlace=function(){return Pe(),g},this.addLabels=function(Re){Array.isArray(Re)||(Re=[Re]);for(var Ze=Re.length-1;Ze>=0;Ze--){var Je=t.indexOf(Re[Ze]);Je>=0||Re[Ze].type!="Label"?Re.splice(Ze,1):Re[Ze].widthArray=[0]}return tt(),t=t.concat(Re),je(),Te(),Ae&&(Ae.visible=!0),g},this.removeLabels=function(Re){Array.isArray(Re)||(Re=[Re]),tt();for(var Ze=0;Ze<Re.length;Ze++){var Je=t.indexOf(Re[Ze]);Je>=0&&t.splice(Je,1)}return je(),t.length==0?$&&et():$&&t.indexOf($)==-1&&(et(),Te()),g};var Ue=new e.Rectangle(this.width,this.height,e.clear,null,null,null,null,null,null,!1).addTo(this).expand().bot();Ue.on("mousedown",function(){}),Ue.on("click",function(){}),U&&Ue.vis(!1),this.resize=function(){if(g.scaleTo(D,100-C*2/D.width*100,50-C*2/D.height*100),g.y=D.height-g.height-C,g.x=D.width/2-g.width/2,$&&Be){var Re=$.localToLocal(0,0,g);Be.x=Re.x,Be.y=Re.y+$.height+15}return g.stage&&g.stage.update(),g},this.resize(),g.selectedLabel&&(g.selectedIndex=g.selectedLabel.text.length),I&&(this.keydownEvent=function(Re){if(g.stage){var Ze=g;n(Ze)||(Re.keyCode==35&&(Ze.selectedIndex=Ze.selectedLabel.text.length),Re.keyCode==36&&(Ze.selectedIndex=0),Re.keyCode==37&&(Ze.selectedIndex=Ze.selectedIndex-1),Re.keyCode==39&&(Ze.selectedIndex=Ze.selectedIndex+1),Re.keyCode==46&&Ze.selectedIndex<Ze.selectedLabel.text.length&&(Ze.selectedIndex=Ze.selectedIndex+1,Ze.removeChar()),Re.keyCode==8&&(Re.preventDefault(),Ze.removeChar()),Ze.addChar(Re.key),g.stage&&g.stage.update())}},le.addEventListener("keydown",this.keydownEvent)),ae!==!1&&e.styleTransforms(this,y),this.clone=function(){var Re=new e.Keyboard(t,r,i,o,l,f,p,_,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B,Z,U,ee,ae,this.group,he);return g.cloneProps(Re)},this.dispose=function(Re,Ze,Je){Ue.removeAllEventListeners(),Ue=null,g.keydownEvent&&le.removeEventListener("keydown",g.keydownEvent);for(var nt=0;nt<g.labels.length;nt++)g.labels[nt].removeAllEventListeners();return g.numPad&&g.numPad.dispose(),Ae&&Ae.dispose(),g.labels=$=null,D&&D.off("pressmousemove",g.tickerMouseEvent),Je||g.zimContainer_dispose(!0),!0}},e.extend(e.Keyboard,e.Container,["clone","dispose"],"zimContainer",!1),e.Organizer=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B){var Z="width, list, useAdd, useRemove, usePosition, autoAdd, autoRemove, autoPosition, addForward, removeForward, backgroundColor, rollBackgroundColor, selectedBackgroundColor, selectedRollBackgroundColor, color, rollColor, selectedColor, selectedRollColor, spacing, corner, keyEnabled, gradient, gloss, backdropColor, style, group, inherit",U;if(U=mt(e.Organizer,arguments,Z,this))return U;qe("67.3"),this.group=te;var ee=I===!1?{}:e.getStyle("Organizer",this.group,B);if(n(t)&&(t=ee.width!=null?ee.width:r&&r.vertical?r.width:300),n(i)&&(i=ee.useAdd!=null?ee.useAdd:!0),n(o)&&(o=ee.useRemove!=null?ee.useRemove:!0),n(l)&&(l=ee.usePosition!=null?ee.usePosition:!0),n(f)&&(f=ee.autoAdd!=null?ee.autoAdd:i),n(h)&&(h=ee.autoRemove!=null?ee.autoRemove:o),n(p)&&(p=ee.autoPosition!=null?ee.autoPosition:l),n(_)&&(_=ee.addForward!=null?ee.addForward:!0),n(b)&&(b=ee.removeForward!=null?ee.removeForward:!0),n(w)&&(w=ee.backgroundColor!=null?ee.backgroundColor:e.tin),n(C)&&(C=ee.rollBackgroundColor!=null?ee.rollBackgroundColor:e.grey),n(O)&&(O=ee.selectedBackgroundColor!=null?ee.selectedBackgroundColor:e.dark),n(A)&&(A=ee.color!=null?ee.color:e.white),n(R)&&(R=ee.rollColor!=null?ee.rollColor:A),n(T)&&(T=ee.selectedColor!=null?ee.selectedColor:A),n(L)&&(L=ee.selectedRollColor!=null?ee.selectedRollColor:A),n(S)&&(S=ee.spacing!=null?ee.spacing:1),n(E)&&(E=ee.corner!=null?ee.corner:0),n(X)&&(X=ee.gradient!=null?ee.gradient:.2),n(q)&&(q=ee.gloss!=null?ee.gloss:null),n(V)&&(V=ee.backdropColor!=null?ee.backdropColor:null),Array.isArray(E)||(E=[E,E,E,E]),!(!i&&!l&&!o)){var ae=(i?1:0)+(l?4:0)+(o?1:0),re=(t+S)/ae,he={width:re,height:re,label:"",shadowColor:-1,gradient:X,corner:E,backgroundColor:w,rollBackgroundColor:C},j=[],G=new e.Shape;if(G.graphics.f(A).p("AAAA4Ih6B8Ig5g4IB8h8Ih7h6IA4g5IB6B8IB7h8IA5A5Ih8B6IB8B7Ig5A5g"),i&&j.push(new e.Button({icon:G.sca(.55).rot(-45).reg(1),inherit:he})),l){var y=new e.Shape;y.graphics.f(A).p("AiJieIETCeIkTCfg"),j.push(new e.Button({icon:y.sca(.6).rot(r&&!r.vertical?180:-90).reg(-2),inherit:he})),j.push(new e.Button({icon:y.clone().sca(.6).rot(r&&!r.vertical?0:90).reg(-2),inherit:he}));var g=new e.Shape;g.graphics.f(A).p("AiFCLIAAkVIBXAAIAAEVgAgiAAICoiHIAAEQg"),j.push(new e.Button({icon:g.sca(.62).rot(r&&!r.vertical?0:90).reg(0),inherit:he})),j.push(new e.Button({icon:g.clone().sca(.62).rot(r&&!r.vertical?180:-90).reg(0),inherit:he}))}o&&j.push(new e.Button({icon:G.clone().rot(0).sca(.55),inherit:he})),j.length==0&&(j=[""]),this.zimTabs_constructor(t,re,j,w,C,null,O,P,A,R,null,T,L,!1,S,!0,!1,E,null,!0,X,q,null,null,null,null,null,null,null,null,null,null,V);var d=this;d.list=r,d.type="Organizer",d.setButtons=function(){if(l){var m=i?1:0;j[m+0]&&(j[m+0].icon.rotation=d.list&&!d.list.vertical?180:-90),j[m+1]&&(j[m+1].icon.rotation=d.list&&!d.list.vertical?0:90),j[m+2]&&(j[m+2].icon.rotation=d.list&&!d.list.vertical?0:90),j[m+3]&&(j[m+3].icon.rotation=d.list&&!d.list.vertical?180:-90)}};var D=!1,K=r;d.change(function(m){(!D&&d.list||d.list&&d.list!=K)&&(d.list!=K&&K&&K.noChange(),d.list.change(function(){d.orgItem=d.list.selected,d.orgIndex=d.list.selectedIndex}),D=!0,K=d.list);var F=m.target.selectedIndex;i||F++,!l&&(!i||F>0)&&(F=5);var Ce=n(d.list.selectedIndex)||d.list.selectedIndex<0;Ce&&(d.currentValue=null),d.lastIndex=d.list.selectedIndex;var Y;switch(F){case 0:f&&(Y=Math.max(0,d.list.selectedIndex),d.add(Y)),d.orgType="add";break;case 1:if(Ce)break;p&&(Y=d.list.selectedIndex,d.up(Y)),d.orgType="up";break;case 2:if(Ce)break;p&&(Y=d.list.selectedIndex,d.down(Y)),d.orgType="down";break;case 3:if(Ce)break;p&&(Y=d.list.selectedIndex,d.toTop(Y)),d.orgType="top";break;case 4:if(Ce)break;p&&(Y=d.list.selectedIndex,d.toBottom(Y)),d.orgType="bottom";break;case 5:if(Ce)break;h&&(Y=d.list.selectedIndex,d.remove(Y)),d.orgType="remove";break}}),this.add=function(m,F,Ce){return n(m)&&(m=d.lastIndex),n(F)&&(F=""),_?m=Math.min(d.list.length,Math.max(0,d.list.selectedIndex)+1):m=Math.max(0,d.list.selectedIndex),d.list.addAt(F,m,Ce),d.list.selectedIndexPlusPosition=m,d.orgItem=d.list.selected,d.orgIndex=d.list.selectedIndex,d},this.up=function(m){n(m)&&(m=d.lastIndex);var F=d.list.items[m];return n(F)||(d.list.removeAt(1,m),d.list.addAt(F,m-1),d.list.selectedIndexPlusPosition=Math.max(0,m-1),d.orgItem=d.list.selected,d.orgIndex=d.list.selectedIndex),d},this.down=function(m){n(m)&&(m=d.lastIndex);var F=d.list.items[m];return n(F)||(d.list.removeAt(1,m),d.list.addAt(F,m+1),d.list.selectedIndexPlusPosition=Math.min(d.list.length-1,m+1),d.orgItem=d.list.selected,d.orgIndex=d.list.selectedIndex),d},this.toTop=function(m){n(m)&&(m=d.lastIndex);var F=d.list.items[m];return n(F)||(d.list.removeAt(1,m),d.list.addAt(F,0),d.list.first(),d.orgItem=d.list.selected,d.orgIndex=d.list.selectedIndex),d},this.toBottom=function(m){n(m)&&(m=d.lastIndex);var F=d.list.items[m];if(!n(F))return d.list.removeAt(1,m),d.list.addAt(F,d.list.length),d.list.last(),d.orgItem=d.list.selected,d.orgIndex=d.list.selectedIndex,d},this.remove=function(m){if(n(m))if(d.list.selectedIndex>=0)m=d.list.selectedIndex;else return d;var F=m==d.list.selectedIndex;return d.removedItem=d.list.items[m],d.list.removeAt(1,m),F?b||(m=Math.max(0,m-1)):m=d.list.selectedIndex,d.list.selectedIndexPlusPosition=Math.min(d.list.length-1,m),d.orgItem=d.list.selected,d.orgIndex=d.list.selectedIndex,d},I!==!1&&e.styleTransforms(this,ee),this.clone=function(){return d.cloneProps(new e.Organizer(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,d.group,B))},this.dispose=function(m,F,Ce){return j=null,Ce||d.zimTabs_dispose(!0),!0}}},e.extend(e.Organizer,e.Tabs,["clone","dispose"],"zimTabs",!1),e.Connectors=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B,Z,U,ee,ae,re,he,j,G,y,g){var d="width, height, points, node, line, linear, linearWrap, linearOrder, num, snapH, snapV, dropType, dropArray, continuous, startIndex, duplicateLine, deleteNode, dblclick, fullMove, min, max, boundary, expand, nodeRollColor, nodeRollBorderColor, nodeSelectedColor, nodeSelectedBorderColor, baseColor, baseBorderColor, baseRollover, rootLock, grandChildren, dblclickTime, steps, style, group, inherit",D;if(D=mt(e.Connectors,arguments,d,this))return D;qe("67.39"),this.group=y;var K=G===!1?{}:e.getStyle("Connectors",this.group,g);n(t)&&(t=K.width!=null?K.width:null),n(r)&&(r=K.height!=null?K.height:null),this.zimContainer_constructor(null,null,null,null,!1),this.type="Connectors",n(i)&&(i=K.points!=null?K.points:[[0,0],[100,0],[100,100],[0,100]]),n(o)&&(o=K.node!=null?K.node:new e.Circle(10,e.grey,e.grey)),o.removeFrom(),o.color==e.clear&&!o.hitArea&&o.expand(0),n(l)&&(l=K.line!=null?K.line:new e.Line({length:10,thickness:3,color:e.tin,strokeObj:{caps:"round"}})),n(_)&&(_=K.num!=null?K.num:10),n(f)&&(f=K.linear!=null?K.linear:!1),n(h)&&(h=K.linearWrap!=null?K.linearWrap:!0),n(V)&&(V=K.nodeRollColor!=null?K.nodeRollColor:o.color.match("rgb")?o.color:o.color.lighten(.2)),n(I)&&(I=K.nodeRollBorderColor!=null?K.nodeRollBorderColor:o.borderColor),n(te)&&(te=K.nodeSelectedColor!=null?K.nodeSelectedColor:e.white),n(B)&&(B=K.nodeSelectedBorderColor!=null?K.nodeSelectedBorderColor:o.borderColor),n(Z)&&(Z=K.baseColor!=null?K.baseColor:o.color),n(U)&&(U=K.baseBorderColor!=null?K.baseBorderColor:o.borderColor),n(ee)&&(ee=K.baseRollover!=null?K.baseRollover:!1),n(E)&&(E=K.min!=null?K.min:o.radius?o.radius*2:Math.min(o.width,o.height)),n(k)&&(k=K.max!=null?K.max:null),n(q)&&(q=K.expand!=null?K.expand:e.mobile()?10:0),n(C)&&(C=K.dropType!=null?K.dropType:"any"),n(O)&&(O=K.dropArray!=null?K.dropArray:null),n(P)&&(P=K.continuous!=null?K.continuous:!1),n(A)&&(A=K.startIndex!=null?K.startIndex:null),n(R)&&(R=K.duplicateLine!=null?K.duplicateLine:!0),n(T)&&(T=K.deleteNode!=null?K.deleteNode:!0),n(L)&&(L=K.dblclick!=null?K.dblclick:!0),n(S)&&(S=K.fullMove!=null?K.fullMove:!0),n(he)&&(he=K.dblclickTime!=null?K.dblclickTime:.5);var m=v(he);if(he*=m=="s"?1e3:1,n(b)&&(b=K.snapH!=null?K.snapH:null),n(w)&&(w=K.snapV!=null?K.snapV:null),n(ae)&&(ae=K.rootLock!=null?K.rootLock:!1),n(re)&&(re=K.grandChildren!=null?K.grandChildren:!0),n(j)&&(j=K.steps!=null?K.steps:null),f&&i.length<=1){Ct&&ht("Connector() - linear needs more than one point");return}var F=this,Ce=0;F.node=o,F.line=l;var Y=[],Q=o.color,ce=o.borderColor,pe=F.lines=new e.Container(t,r).addTo(F),J=F.nodes=new e.Container(t,r).addTo(F);if(i.type=="Blob"||i.type=="Squiggle"){var ue=[];e.loop(i.points,function(We){ue.push([We[0],We[1]])}),i=ue}F.points=i,this.addNode=function(We,at,ct){if(!f)return ye(We,at,ct)};function ye(We,at,ct,Pe){if(We.addChild){C="on",ae=!0,re=!1,ct=We,ct.connectorMoveEvent||(F.bases||(F.bases=[]),F.bases.push(ct),ct.connectorMoveEvent=ct.on("pressmove",function(){ct.positionConnectors(ct,!0,!0)}),ct.connectorUpEvent=ct.on("pressup",function(){ct.positionConnectors(ct,!0,!0)}),ee&&(ct.connectorOverEvent=ct.on("mouseover",function(){Fe(ct)}),ct.connectorOutEvent=ct.on("mouseout",function(){ge(ct)})),ct.positionConnectors=function(it,je,tt){e.loop(it.connectors,function(Te){var et=it.parent.localToLocal(it.x-it.baseStart.x+Te.nodeStart.x,it.y-it.baseStart.y+Te.nodeStart.y,Te.parent);Te.x=et.x,Te.y=et.y,Ke(Te,je,tt)}),it.stage&&it.stage.update()},ct.setConnectorColors=function(it,je,tt,Te){return n(it)||(ct.connectorColor=it),n(je)||(ct.connectorBorderColor=je),n(tt)||(ct.connectorRollColor=tt),n(Te)||(ct.connectorRollBorderColor=Te),e.loop(ct.connectors,function(et){n(it)||(et.color=it),n(je)||(et.borderColor=je)}),ct},ct.setConnectorColors(Z,U,V,I));var Ie=ct.getBounds();l.endHead,Array.isArray(at)||(at=[at,at]);var be=[];return at.length==2&&(at=[at[0],at[1],at[0],at[1]]),(l.lineOrientation==e.HORIZONTAL||l.lineOrientation=="auto")&&e.loop([at[0],at[1]],function(it,je){if(it==-1||it==-2){var tt=ct.localToLocal(je==0?Ie.x:Ie.x+Ie.width,Ie.y,F);be.push([tt.x,tt.y,e.HORIZONTAL])}if(it==-1||it==-3){var Te=ct.localToLocal(je==0?Ie.x:Ie.x+Ie.width,Ie.y+Ie.height,F);be.push([Te.x,Te.y,e.HORIZONTAL])}it>0&&e.loop(it,function(et,Ue){var Re=ct.localToLocal(je==0?Ie.x:Ie.x+Ie.width,Ie.y+Ie.height*(et+1)/(Ue+1),F);be.push([Re.x,Re.y,e.HORIZONTAL])})}),(l.lineOrientation==e.VERTICAL||l.lineOrientation=="auto")&&e.loop([at[2],at[3]],function(it,je){if(it==-1||it==-2){var tt=ct.localToLocal(Ie.x,je==0?Ie.y:Ie.y+Ie.height,F);be.push([tt.x,tt.y,e.VERTICAL])}if(it==-1||it==-3){var Te=ct.localToLocal(Ie.x+Ie.width,je==0?Ie.y:Ie.y+Ie.height,F);be.push([Te.x,Te.y,e.VERTICAL])}it>0&&e.loop(it,function(et,Ue){var Re=ct.localToLocal(Ie.x+Ie.width*(et+1)/(Ue+1),je==0?Ie.y:Ie.y+Ie.height,F);be.push([Re.x,Re.y,e.VERTICAL])})}),ct.connectors=[],ct.baseStart=new e.Point(ct.x,ct.y),e.loop(be,function(it){var je=ye(it[0],it[1],ct,it[2]);Ve(ct,je)}),setTimeout(function(){ct.positionConnectors(ct,!0,!0)},50),F}var ze=o.clone().loc(We,at,J).drag({boundary:X}).expand(q);return ze.orientation=Pe,ze.nodeColor=ze.color,ze.on("mouseover",Ae),ze.on("mouseout",ie),ze.on("mousedown",Oe),ze.on("pressmove",Ye),ze.on("pressup",de),T&&ze.hold(se),ze.nodeNum=Ce++,ze.creations=[],ze}function Xe(){e.loop(i,function(We,at){var ct=ye(We[0],We[1]);ct.dropIndex=at,O&&(ct.dropArray=O[at])}),f&&J.loop(function(We,at,ct){at==0?(h?We.before=J.getChildAt(ct-1):We.before=null,We.after=J.getChildAt(at+1)):at==ct-1?(h?We.after=J.getChildAt(0):We.after=null,We.before=J.getChildAt(at-1)):(We.before=J.getChildAt(at-1),We.after=J.getChildAt(at+1)),p&&at>0&&We.noMouse()})}Xe(),F.setAvailableIndexes=function(We){return Array.isArray(We)||(We=[We]),F.nodes.loop(function(at,ct){We.indexOf(ct)==-1?at.noMouse():at.mouse()}),F},n(A)||F.setAvailableIndexes(A),F.keyEvent=function(We){T&&We.keyCode==46&&(e.loop(_e,function(at){at&&at.parent&&st(at)}),F.stage&&F.stage.update())},le.addEventListener("keydown",F.keyEvent);function se(We){var at=We.target.stage,ct=We.target;F.bases||ae&&!ct.creator.creator||(ct.adding?st(ct.creator):st(ct),F.stage&&F.stage.update())}function Ae(We){var at=We.target;at.selected||(at.color=at.base?at.base.connectorRollColor:V,at.borderColor=at.base?at.base.connectorRollBorderColor:I,F.stage&&F.stage.update())}function ie(We){var at=We.target;at.selected||(at.color=at.base?at.base.connectorColor:at.nodeColor,at.borderColor=at.base?at.base.connectorBorderColor:ce,F.stage&&F.stage.update())}var _e=[],$,xe=0,Be,me;function Oe(We,at,ct,Pe){var Ie=We.target;if(!n(Ie)&&(ct&&(Ie.selected=!0,_e=[],F.selectNode(Ie,!Pe)),me=Ie.nodeNum,!f&&(!ae||Ie.creator)&&L&&!at&&(xe==0&&(Be=setTimeout(function(){if(xe=0,_e){var je=F.stage?F.stage.frame:le.zdf,tt=J.loop(function(Te){if(Te.hitTestPoint(je.mouseX,je.mouseY)&&Te.selected)return!1});tt&&Qe()}},he)),xe++),Ie.startX=Ie.x,Ie.startY=Ie.y,!f&&_e.length>0&&e.loop(_e,function(je){je.startX=je.x,je.startY=je.y}),!(Ie.creations.length>=_||Ie.selected||Ie.creator&&!re))){Ie.adding=!0;var be=ye(Ie.x,Ie.y).bot();be.creations=Ie.creations,be.creatorLine=Ie.creatorLine,be.creator=Ie.creator,be.orientation=Ie.orientation,be.startX=Ie.startX,be.startY=Ie.startY,be.dropIndex=Ie.dropIndex,be.dropArray=Ie.dropArray,be.lineArray=Ie.lineArray,be.color=be.nodeColor=Ie.nodeColor;var ze=be.nodeNum;if(be.nodeNum=Ie.nodeNum,Ie.nodeNum=ze,Ie.base&&(be.base=Ie.base,be.baseStart=Ie.baseStart,be.nodeStart=Ie.nodeStart,be.connectors=Ie.connectors,Ie.base=Ie.baseStart=Ie.nodeStart=Ie.connectors=null,be.base.connectors&&be.base.connectors.splice(be.base.connectors.indexOf(Ie),1,be),be.color=be.base.connectorColor,be.borderColor=be.base.connectorBorderColor),be.before=Ie.before,be.after=Ie.after,be.before&&(be.before.after=be),be.after&&(be.after.before=be),be.creator){var it=be.creator.creations.indexOf(Ie);it!=-1&&be.creator.creations.splice(it,1,be)}e.loop(be.creations,function(je){je.creator=be}),Ie.creator=be,Ie.creatorLine=l.clone().setPoints(Ie.x,Ie.y,Ie.x,Ie.y).addTo(pe).alp(0),Ie.creatorLine.lineOrientation=Ie.orientation,Ie.creatorLine.node=Ie,Ie.creatorLine.creatorNode=be,Ie.creations=[],Ie.veeObj&&!n(Ie.veeObj.color)?Ie.color=e.Pick.choose(Ie.veeObj.color):Ie.color=be.color,Ie.nodeColor=Ie.color,be.creations.push(Ie),F.latestNode=Ie}}function Ye(We,at,ct,Pe){var Ie=We.target;Ie.creatorLine&&Ie.creatorLine.alp(1),!f&&_e.length>0&&_e.indexOf(Ie)==-1&&Qe(),Ke(Ie,!1,!0),F.bases&&e.loop(F.bases,function(be){Ie.creator&&Ie.creator.base==be||(!be.connectorsOn&&Ie.hitTestBounds(be)&&Fe(be),be.connectorsOn&&!Ie.hitTestBounds(be)&&ge(be))}),F.stage&&F.stage.update()}function de(We,at,ct,Pe){var Ie=We.target;F.bases&&e.loop(F.bases,function(nt){nt!=Ie.base&&nt.connectorsOn&&ge(nt)});var be=!1;if(!f&&xe>1&&!at){clearTimeout(Be);var ze=Ie.adding?Ie.creator:Ie;if(Ie.adding&&st(ze.creations[ze.creations.length-1],!0),!ze.selected){var it=F.stage?F.stage.frame:le.zdf;fe(ze,!it.ctrlKey)}xe=0,be=!0}if(!f&&!F.base&&(b&&(Ie.x=Math.round(Ie.x/b)*b),w&&(Ie.y=Math.round(Ie.y/w)*w)),E&&e.dist(Ie.x,Ie.y,Ie.startX,Ie.startY)<E||k&&e.dist(Ie.x,Ie.y,Ie.startX,Ie.startY)>k){Ie.adding?st(Ie,!0):(Ie.loc(Ie.startX,Ie.startY),be||Ke(Ie)),F.stage&&F.stage.update(),F.lastNode=null,F.targetNode=null,F.dispatchEvent("noconnection");return}var je=!1,tt=!1;if(f){var Te=Ie.creator;if(F.connectionStart=Te,F.connectionEnd=Ie,Te.before&&Ie.hitTestCircle(Te.before)&&!p)Ie.loc(Te.before).removeFrom(),Te.before.after=null,Te.before.before||Te.before.noMouse(),Te.before=null,Te.after||Te.noMouse(),tt=!0,je=Ge();else if(Te.after&&Ie.hitTestCircle(Te.after))Ie.loc(Te.after).removeFrom(),Te.after.before=null,Te.after.after||Te.after.noMouse(),p&&Te.after.mouse(),Te.after=null,Te.before||Te.noMouse(),p&&Te.noMouse(),tt=!0,je=Ge();else if(!Te||Ie.creations.length>0)Ie.loc(Ie.startX,Ie.startY).bot();else{st(Ie,!0),F.stage&&F.stage.update(),F.lastNode=null,F.targetNode=null,F.dispatchEvent("noconnection");return}}else if(C=="off"){var et=J.loop(function(nt){if(Ie!=nt&&Ie.hitTestCircles(nt)){Ie.adding?st(Ie,!0):(Ie.loc(Ie.startX,Ie.startY),Ke(Ie)),ae&&Le(Ie),!S&&Ie.creator&&_>0&&Ie.creator.creations.length>=_&&Ie.creator.noMouse(),F.targetNode=nt,P&&F.nodes.loop(function(pt){pt!=F.latestNode&&pt.noMouse()}),P&&F.nodes.loop(function(pt){pt!=F.latestNode&&pt.noMouse()}),ve(),F.dispatchEvent("connection"),F.stage&&F.stage.update();return}});if(!et){we(Ie);return}}else if(C=="on"||C=="single"){var Ue=0,Re,Ze=J.loop(function(nt){if(Ie!=nt&&Ie.hitTestCircles(nt)){if(Re=nt,F.bases&&(Ie.orientation!=nt.orientation||Ie.creator&&Ie.creator.base&&Ie.creator.base==nt.base)||Ie.dropArray&&Ie.dropArray.indexOf(nt.dropIndex)==-1||!R&&Ie.lineArray&&Ie.lineArray.indexOf(nt.dropIndex)!=-1)return;if(C=="on")return!1;Ue++,Ue+=nt.creations.length}});if(Ze&&!(C=="single"&&Ue==1)){we(Ie);return}else{if(Ie.loc(Re),Ie.creator&&Ie.orientation==e.VERTICAL&&Math.round(Ie.y)==Math.round(Ie.creator.startY)||Ie.creator&&Ie.orientation==e.HORIZONTAL&&Math.round(Ie.x)==Math.round(Ie.creator.startX))return;F.targetNode=Re;var Je=Ie.dropIndex;Ie.dropIndex=Re.dropIndex,Ie.dropArray=e.copy(Re.dropArray),Re.lineArray?Re.lineArray.push(Je):Re.lineArray=[Je],Ie.lineArray=e.copy(Re.lineArray),Ie.creator&&(Ie.creator.lineArray||(Ie.creator.lineArray=[]),Ie.creator.lineArray.push(Ie.dropIndex)),Re.base&&Re.base.connectors&&Ve(Re.base,Ie),tt=!0}}else Ie.selected||(tt=!0);!S&&Ie.creator&&_>0&&Ie.creator.creations.length>=_&&Ie.creator.noMouse(),Ie.adding=!1,Ke(Ie,!0,!0),e.loop(_e,function(nt){if(_e.indexOf(nt.creator)==-1){var pt=e.loop(nt.creations,function(De){if(_e.indexOf(De)>=0)return!1});ve(nt.nodeNum,null,e.decimals(nt.x,2),e.decimals(nt.y,2),pt||pt===void 0?1:0)}nt.startX=nt.x,nt.startY=nt.y}),Ie.startX=Ie.x,Ie.startY=Ie.y,ae&&Le(Ie),tt?(P&&F.nodes.loop(function(nt){nt!=F.latestNode&&nt.noMouse()}),ve(),F.dispatchEvent("connection"),e.arraysEqual(Ie.dropArray,Ie.lineArray,!1)&&F.dispatchEvent("blocked")):F.dispatchEvent("noconnection"),je&&F.dispatchEvent("complete"),F.stage&&F.stage.update()}function ve(We,at,ct,Pe,Ie){at?Y.push([We,null,null,1]):n(ct)?Y.push([me,e.decimals(F.latestNode.x,2),e.decimals(F.latestNode.y,2)]):Y.push([We,null,null,null,ct,Pe,Ie])}F.makeConnection=function(We,at,ct,Pe,Ie){var be=F.stage?F.stage.frame:le.zdf;return Pe?(be.ctrlKey=Ie==1,Oe({target:We},!0,!0,Ie),We.loc(at,ct),Ye({target:We},!0,!0,Ie),de({target:We},!0,!0,Ie)):(Oe({target:We},!0,!1,null),F.latestNode.loc(at,ct),Ye({target:F.latestNode},!0,!1,null),de({target:F.latestNode},!0,!1,null)),be.ctrlKey=!1,F.latestNode};function Me(We){var at=F.nodes.loop(function(ct){if(ct.nodeNum==We)return ct});if(at.type)return at}F.setSteps=function(We){return e.loop(We,function(at){var ct=Me(at[0]);ct&&(at[3]?ct&&st(ct):n(at[4])?F.makeConnection(ct,at[1],at[2]):(F.makeConnection(ct,at[4],at[5],!0,at[6]),Qe()))}),F},F.applySteps=F.setSteps,F.getSteps=function(We){return We&&(F.stage||(F.stage=zdf.stage),F.pane||(F.pane=new e.Pane({displayClose:!1,container:F.stage,width:Math.min(500,F.stage.width-20),height:Math.min(500,F.stage.height-20),draggable:!0}),F.textArea=new e.TextArea(Math.min(400,F.stage.width-70),Math.min(400,F.stage.height-70)).centerReg(F.pane)),F.pane.show(),F.textArea.text=JSON.stringify(Y)),Y},Object.defineProperty(this,"steps",{get:function(){return Y},set:function(We){F.setSteps(We)}});function we(We){We.adding||!re?st(We,!0):(We.loc(We.startX,We.startY),Ke(We)),ae&&Le(We),We.base&&We.base.connectors&&He(We.base,We),F.lastNode=null,F.targetNode=null,F.dispatchEvent("noconnection"),F.stage&&F.stage.update()}function Fe(We){e.loop(We.connectors,function(at){at.color=We.connectorRollColor,at.borderColor=We.connectorRollBorderColor}),We.connectorsOn=!0,We.stage&&We.stage.update()}function ge(We){e.loop(We.connectors,function(at){at.color=We.connectorColor,at.borderColor=We.connectorBorderColor}),We.connectorsOn=!1,We.stage&&We.stage.update()}function Ve(We,at){We.connectors.push(at),at.nodeStart=at.parent.localToLocal(at.x,at.y,We.parent),at.nodeStart.x-=We.x-We.baseStart.x,at.nodeStart.y-=We.y-We.baseStart.y,at.base=We}function He(We,at){We.connectors.splice(We.connectors.indexOf(at),1),at.nodeStart=null,at.base=null}function Le(We){if(We.creator){if(We.creator.creator){Le(We.creator);return}We.creator&&We.creator.creations.length>=_?We.creator.noMouse():We.creator.mouse()}}function fe(We,at){at&&e.loop(We.creations,function(ct){fe(ct,at)}),We.selected=!0,We.color=We.base?We.base.connectorColor:te,We.borderColor=We.base?We.base.connectorBorderColor:B,_e.push(We),We.top(),$||($=F.stage.on("stagemousedown",function(){var ct=F.stage?F.stage.frame:le.zdf,Pe=J.loop(function(Ie){if(Ie.hitTestPoint(ct.mouseX,ct.mouseY))return!1});Pe&&Qe()}))}this.selectNode=function(We,at){fe(We,at)};function Ge(){var We=J.loop(function(at){if(at.before||at.after)return!1});if(We)return J.loop(function(at){at.noMouse()}),!0}function Qe(){e.loop(_e,function(We){We.selected=!1,We.color=We.base?We.base.connectorColor:We.nodeColor,We.borderColor=We.base?We.base.connectorBorderColor:ce}),_e=[],F.stage.off("stagemousedown",$),$=null,F.stage&&F.stage.update()}function Ke(We,at,ct){var Pe=_e.length>0?_e:[We];e.loop(Pe,function(Ie){Ie!=We&&Ie.loc(Ie.startX+We.x-We.startX,Ie.startY+We.y-We.startY),Ie.creator&&Ie.creatorLine.setPoints(Ie.x,Ie.y,Ie.creator.x,Ie.creator.y,at,ct),e.loop(Ie.creations,function(be){be.creatorLine.setPoints(be.x,be.y,be.creator.x,be.creator.y,at,ct)})})}function st(We,at){if(e.loop(We.creations,function(Pe){st(Pe)},!0),We.creatorLine){We.creatorLine.removeFrom();var ct=We.creator.creations.indexOf(We);ct!=-1&&We.creator.creations.splice(ct,1),!We.creator.mouseEnabled&&!(ae&&!We.creator.creator)&&We.creator.mouse()}return We.removeFrom(),We.removeAllEventListeners(),at?Ce--:ve(We.nodeNum,1),We=null,F}this.removeNode=function(We){st(We)},this.removeConnectors=function(){e.loop(J,function(We){st(We)},!0),Xe(),F.stage&&F.stage.update()},this.removeBase=function(We){e.loop(We.connectors,function(at){st(at)}),yt(We)},this.addBase=function(We,at){ye(We,at)};function yt(We){We.off("pressmove",We.connectorMoveEvent),We.off("pressup",We.connectorUpEvent),We.connectorOverEvent&&We.off("mouseover",We.connectorOverEvent),We.connectorOutEvent&&We.off("mouseout",We.connectorOutEvent),We.connectors=null,We.baseStart=null,We.positionConnectors=We.setConnectorColors=null,We.connectorColor=We.connectorBorderColor=We.connectorRollColor=We.connectorRollBorderColor=null,F.bases.splice(F.bases.indexOf(We),1),F.stage&&F.stage.update()}j&&F.added(function(){F.setSteps(j),F.stage.update()}),Object.defineProperty(this,"selectedList",{get:function(){return _e},set:function(){Ct&&ht("Selectors() - selectedList is read only")}}),this.dispose=function(We,at,ct){return F.nodes.loop(function(Pe){Pe.removeFrom(),Pe.removeAllEventListeners(),Pe=null},!0),F.lines.loop(function(Pe){Pe.removeFrom(),Pe=null},!0),le.removeEventListener("keydown",F.keyEvent),F.keyEvent=null,F.bases&&e.loop(F.bases,function(Pe){yt(Pe)}),ct||(F.zimContainer_dispose(!0),F.stage&&F.stage.update()),!0},G!==!1&&e.styleTransforms(this,K),this.clone=function(){return F.cloneProps(new e.Connectors(t,r,i,o,l,f,h,p,_,b,w,C,e.copy(O),P,A,R,T,L,S,E,k,X,q,V,I,te,B,Z,U,ee,ae,re,he,j,G,F.group,g))}},e.extend(e.Connectors,e.Container,["clone","dispose"],"zimContainer",!1),e.Marquee=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T){var L="width, height, items, time, transition, speed, direction, marginLeft, marginRight, marqueeType, borderColor, borderWidth, refresh, mix, style, group, inherit",S;if(S=mt(e.Marquee,arguments,L,this))return S;qe("67.4"),this.group=R;var E=A===!1?{}:e.getStyle("Marquee",this.group,T),k=this;n(t)&&(t=E.width!=null?E.width:300),n(r)&&(r=E.height!=null?E.height:100);var X=v(o);n(o)&&(o=E.time!=null?E.time:X=="s"?5:5e3),n(l)&&(l=E.transition!=null?E.transition:"slide"),n(w)&&(w=E.borderColor!=null?E.borderColor:e.dark),n(C)&&(C=E.borderWidth!=null?E.borderWidth:1),w<0||C<0?w=C=null:w!=null&&C==null&&(C=1),n(p)&&(p=E.marginLeft!=null?E.marginLeft:25),n(_)&&(_=E.marginRight!=null?E.marginRight:25),n(f)&&(f=E.speed!=null?E.speed:X=="s"?.5:500),a(f,X),n(h)&&(h=E.direction!=null?E.direction:"right"),n(O)&&(O=E.refresh!=null?E.refresh:X=="s"?30*60:30*60*1e3),n(P)&&(P=E.mix!=null?E.mix:!0),this.zimContainer_constructor(t+p+_,r,null,null,!1),this.type="Marquee",this.speed=f;var q=new e.Rectangle(t-1,r-1,e.clear).addTo(k).mov(p+.5,.5),V=this.content=new e.Container(t,r).loc(p,0,k).setMask(q),I=this.pages=new e.Pages(null,l,f,null,V).addTo(V),te=!1;this.add=function(m,F,Ce,Y,Q){n(Q)&&(Q=!0),m.scaleTo(V,100,100),F&&m.cur().on("click",function(){sr(F,Ce)}),I.addPage(m),Q&&I.center(),m.marqueeViews=0,m.marquee=k,te||B(),Y||G(),K&&K.top()},this.remove=function(m){if(k.selected==m){if(k.pages.pages.length==1)return;var F=k.selectedIndex+1;F==k.pages.pages.length&&(F=0),k.pages.go(F,null,null,0),setTimeout(function(){k.pages.removePage(m),m.dispose&&m.dispose(),G()},20)}else k.pages.removePage(m),m.dispose&&m.dispose(),G()};function B(){te=!0,k.selectedIndex=0,k.selected=I.pages[k.selectedIndex].page,k.lastSelected=null,k.selected.marqueeOn&&k.selected.marqueeOn(),k.interval=e.interval(o,function(){k.go()})}if(!n(i)&&!Array.isArray(i)&&(i=[i]),i&&i.length>0&&(P&&e.shuffle(i),e.loop(i,function(m){k.add(m,null,null,!0)})),O>0)var Z=e.timeout(O*(X=="s"?1e3:1),function(){location.reload()},null,"ms");k.go=function(m){if(k.selected.marqueeViews+=1,k.selected.marqueeOff&&k.selected.marqueeOff(),m)k.selected=m,e.loop(I.pages,function(Ce,Y){if(Ce.page==m){k.selectedIndex=Y;return}}),k.interval.interval=k.selected.marqueeTime?k.selected.marqueeTime:o,k.interval.pause(he.toggled,null,!0);else{var F=k.selectedIndex+1;k.selectedIndex=F%I.pages.length,k.selected=I.pages[k.selectedIndex].page,k.interval.time=k.selected.marqueeTime?k.selected.marqueeTime:o}k.dispatchEvent("page"),k.selected.marqueeOn&&k.selected.marqueeOn(),I.go(k.selected,h,l,f)},I.on("pagetransitioned",function(){k.dispatchEvent("pagetransitioned"),k.indicator&&(k.indicator.selectedIndex=k.selectedIndex)});var U=!1,ee=k.left=new e.Container(p-4,r-4),ae=new e.Shape().sca(.6);ae.graphics.f(e.light).mt(0,0).p("AAhCLIAAkVIBXAAIAAEVgAh3CLIAAkVIBXAAIAAEVg");var re=new e.Shape().sca(.6).reg(-2,0);re.graphics.f(e.light).mt(0,0).p("AiJieIETCeIkTCfg");var he=k.button=new e.Button({label:"",icon:ae,toggleIcon:re,width:45,height:45,corner:0,shadowBlur:0}).scaleTo(ee,100).pos(0,0,!1,!0,ee);he.on("click",function(){k.interval&&k.interval.pause(he.toggled),U=he.toggled,k.stage.update()});var j;function G(){if(!(n(p)||p==0)){var m=4*p/25;ee.pos(p-ee.width-m,m/2,!1,!0,k),k.indicator&&(k.indicator.dispose(),k.indicator.removeFrom()),j||(j=new e.Proportion(8,16,ee.width+m,ee.width/2+m,-1)),k.indicator=new e.Indicator({width:(I.pages.length<=2?I.pages.length:I.pages.length-1)*(ee.width-3),height:j.convert(I.pages.length),num:I.pages.length,shadowBlur:-1,interactive:!0,scale:1.2,indicatorType:b}),k.indicator.fit(0,0,r-he.height,he.width),k.indicator.rot(h=="down"?-90:90).center(ee).pos(null,ee.width-m/2,null,!0),k.indicator.selectedIndex=k.selectedIndex,k.indicator.on("change",function(){k.go(I.pages[k.indicator.selectedIndex].page)})}}if(G(),!n(_)&&_>0&&le.zdf&&le.zdf){var y=4*_/25,g=k.right=new e.Container(45,270),d=k.icon=le.zdf.makeIcon(e.grey,e.lighter,e.silver).sca(.5).pos(0,0,!0,!0,g).mov(0,0).cur();d.on("mouseover",function(){D.animate({props:{scaleX:1},time:500,ease:"backOut",override:!0,timeUnit:"ms"}),d.stage.update()}),d.on("mouseout",function(){D.animate({props:{scaleX:0},time:300,ease:"backIn",override:!0,timeUnit:"ms"}),d.stage.update()}),d.on("mousedown",function(){sr("https://zimjs.com/marquee","_blank")});var D=k.label=new e.Label({text:"MARQUEE",color:e.dark,backgroundColor:e.lighter,shiftV:1,paddingV:5}).rot(-90).pos(0,13,!0,!1,g).reg(-10).sca(0,1).mov(0);g.fit(0,0,_-y,r-y),g.pos(_-g.width-y,y/2,!0,!0,k)}if(k.stage&&k.stage.update(),this.pause=function(m,F){n(m)&&(m=!0),m!=U&&(U=m,k.interval.pause(m,F),k.button.toggle(m))},Object.defineProperty(this,"paused",{get:function(){return U},set:function(){Ct&&ht("Marquee() - paused is read only - use pause()")}}),Object.defineProperty(this,"time",{get:function(){return o},set:function(m){o=m,k.interval.time=o}}),this.load=function(m,F){var Ce=[];P&&e.shuffle(m),e.loop(m,function(Q){Array.isArray(Q)?Ce.push(Q[0]):Ce.push(Q)});var Y=k.stage?k.stage.frame:le.zdf;return k.marqueeLoader=Y.loadAssets(Ce,F),k.loadEvent=k.marqueeLoader.on("assetload",function(Q){var ce=m[Q.asset.id],pe,J;Array.isArray(ce)?(pe=ce[0],J=ce[1]):(pe=ce,J="_self"),k.add(Q.asset,pe,J),G()}),k},!n(w)){var K=new e.Rectangle(t-1,r-1,e.clear,w,C).loc(q,null,k);K.mouseEnabled=!1}A!==!1&&e.styleTransforms(this,E),this.clone=function(){return k.cloneProps(new e.Marquee(t,r,i,o,l,f,h,b,w,C,O,P,A,this.group,T))},this.dispose=function(m,F,Ce){return Z&&Z.clear(),k.interval&&k.interval.clear(),k.loadEvent&&k.marqueeLoader.off("assetload",k.loadEvent),I.dispose(),I=null,Ce||this.zimContainer_dispose(!0),!0}},e.extend(e.Marquee,e.Container,["clone","dispose"],"zimContainer"),e.Carousel=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k){var X="items, viewNum, time, spacing, backgroundColor, backing, padding, paddingH, paddingV, arrowLeft, arrowRight, arrowGap, valign, ease, swipe, remember, selectedIndex, continuous, style, group, inherit",q;if(q=mt(e.Carousel,arguments,X,this))return q;qe("67.45"),this.group=E;var V=S===!1?{}:e.getStyle("Carousel",this.group,k),I=this;this.zimContainer_constructor(),n(t)&&(t=V.items!=null?V.items:[new On({color:red}),new On({color:orange}),new On({color:yellow}),new On({color:green}),new On({color:blue}),new On({color:purple}),new On({color:pink})]),n(l)&&(l=V.backgroundColor!=null?V.backgroundColor:e.clear),n(f)&&(f=V.backing!=null?V.backing:null),n(O)&&(O=V.valign!=null?V.valign:"center"),n(r)&&(r=V.viewNum!=null?V.viewNum:3),n(o)&&(o=V.spacing!=null?V.spacing:20),n(h)&&(h=V.padding!=null?V.padding:0),n(p)&&(p=V.paddingH!=null?V.paddingH:h),n(_)&&(_=V.paddingV!=null?V.paddingV:h),n(b)&&(b=V.arrowLeft!=null?V.arrowLeft:new e.Arrow().rot(180)),n(w)&&(w=V.arrowRight!=null?V.arrowRight:new e.Arrow),n(C)&&(C=V.arrowGap!=null?V.arrowGap:20);var te=v(i);n(i)&&(i=V.time!=null?V.time:te=="s"?.2:200),n(P)&&(P=V.ease!=null?V.ease:"quadInOut"),n(A)&&(A=V.swipe!=null?V.swipe:!0),n(R)&&(R=V.remember!=null?V.remember:"zimCarousel"),n(T)&&(T=V.selectedIndex!=null?V.selectedIndex:0),n(L)&&(L=V.continuous!=null?V.continuous:!0),R&&localStorage&&!n(localStorage[R])&&(localStorage[R]=="NaN"&&(localStorage[R]=0),T=Number(localStorage[R])),I.items=t,I.viewNum=r,I.spacing=o,I.arrowLeft=b,I.arrowRight=w,I.arrowLeft.oW=b.width,I.arrowRight.oW=w.width,f&&(I.backing=f);var B={};e.loop(t,function(d,D){typeof d=="string"&&(d=t[D]=new e.Pic(d)),d.reg(CENTER,CENTER);var K=B["width"+d.width];K?B["width"+d.width]+=1:B["width"+d.width]=1});var Z=0,U=0;e.loop(B,function(d,D){D>Z&&(Z=D,U=Number(d.substring(5)))});var ee=0;e.loop(t,function(d){d.width=U,d.height>ee&&(ee=d.height)});var ae;L?(I.continuous=!0,ae=e.copy(t),e.loop(t.length,function(d){ae.push(t[d].clone())})):ae=t,I.itemWidth=U,I.itemHeight=ee;var re=b.width+C+p,he;function j(){var d=r*(U+o)-o,D=ee;he=d+p*2+C*2+b.width+w.width,I.setBounds(0,0,he,D+_*2),I.tile=new e.Tile({obj:ae,cols:ae.length,spacingH:o,rows:1,unique:!0,align:"center",valign:O}).center(I).loc(re),I.background=new On(d+p*2,D+_*2,l).center(I,0),I.tile.setMask(I.background)}function G(){b.pos(0,0,"left","center",I),w.pos(0,0,"right","center",I),b.on("mousedown",function(){I.cycleInterval&&(I.cycleClear(),I.dispatchEvent("cyclecleared")),I.goLeft()}),w.on("mousedown",function(){I.cycleInterval&&(I.cycleClear(),I.dispatchEvent("cyclecleared")),I.goRight()}),g()}function y(){if(I.swipe){var d=I.swipeObj=new e.Swipe(I.tile);d.on("swipe",function(D){D.swipeX!=0&&I.cycleInterval&&(I.cycleClear(),I.dispatchEvent("cyclecleared")),D.swipeX==1?I.goLeft():D.swipeX==-1&&I.goRight()})}}function g(){localStorage&&R&&(localStorage[R]=I.selectedIndex),b.activate(!0),w.activate(!0),!L&&(I.tile.x+I.tile.width<=he-w.oW-p-C&&w.activate(!1),I.tile.x>=re&&b.activate(!1))}I.goLeft=function(d){return n(d)&&(d=i),L&&I.tile.x>=-U&&(I.tile.x-=I.tile.width/2+o/2),I.tile.x<re&&(I.disableArrows(),T--,I.tile.animate({props:{x:I.tile.x+U+o},time:d,ease:P,call:function(){g(),I.enableArrows(),I.dispatchEvent("transitioned")}})),I},I.goRight=function(d){return n(d)&&(d=i),L&&I.tile.x-U<=he-I.tile.width&&(I.tile.x+=I.tile.width/2+o/2),I.tile.x+I.tile.width>he-w.oW-p-C&&(I.disableArrows(),T++,I.tile.animate({props:{x:I.tile.x-U-o},time:d,ease:P,call:function(){g(),I.enableArrows(),I.dispatchEvent("transitioned")}})),I},I.cycleClear=function(){return I.cycleInterval.clear(),I.cycleInterval=null,I},I.cycle=function(d,D,K,m,F,Ce){var Y="cycleTime, transitionTime, repeat, repeatNum, recycle, rtl",Q;if(Q=mt(I.cycle,arguments,Y))return Q;n(d)&&(d=V.cycleTime!=null?V.cycleTime:te=="s"?5:5e3),n(D)&&(D=V.transitionTime!=null?V.transitionTime:te=="s"?1:1e3),n(K)&&(K=!0),n(m)&&(m=0),n(F)&&(F=d*2),n(Ce)&&(Ce=le.DIR&&le.DIR=="rtl"||!le.DIR&&e.DIR=="rtl");let ce=Ce?-1:1;return I.cycleInterval&&I.cycleInterval.clear(),F&&F!=-1&&(I.recycleEvent&&I.off("cyclecleared",I.recycleEvent),I.recycleWait&&I.recycleWait.clear(),I.recycleEvent=I.on("cyclecleared",function(){I.recycleWait&&I.recycleWait.clear(),I.recycleWait=ri(F,function(){I.cycle(d,D,K,m,F,Ce)})})),L?(I.repeatTotal=0,I.cycleInterval=e.interval(d*2,function(pe){if(I.selectedIndex==0)if(!K&&Ce)I.cycleInterval.clear();else{if(Ce&&pe.count!=1&&(I.repeatTotal+=1),Ce&&m!=0&&I.repeatTotal>=m){I.cycleInterval.clear(),I.dispatchEvent("repeatdone");return}ce==1?I.goRight(D):I.goLeft(D)}else if(I.selectedIndex==t.length-r){if(!Ce&&pe.count!=1&&(I.repeatTotal+=1),!Ce&&m!=0&&I.repeatTotal>=m){I.cycleInterval.clear(),I.dispatchEvent("repeatdone");return}I.repeatTotal>=1&&I.dispatchEvent("repeated"),!Ce&&!K?I.cycleInterval.clear():ce==1?I.goRight(D):I.goLeft(D)}else ce==1?I.goRight(D):I.goLeft(D)})):(I.repeatTotal=.5,I.cycleInterval=e.interval(d*2,function(pe){if(I.selectedIndex==0){if(pe.count!=1&&(I.repeatTotal+=.5),m!=0&&I.repeatTotal>m){I.cycleInterval.clear(),I.dispatchEvent("bouncedone");return}I.repeatTotal>=1&&I.dispatchEvent("bounced"),ce=1,I.goRight(D)}else if(I.selectedIndex==t.length-r){if(pe.count!=1&&(I.repeatTotal+=.5),m!=0&&I.repeatTotal>m){I.cycleInterval.clear(),I.dispatchEvent("bouncedone");return}I.repeatTotal>=1&&I.dispatchEvent("bounced"),ce=-1,I.goLeft(D)}else Yr(),ce==1?I.goRight(D):I.goLeft(D)})),I},I.enableArrows=function(){return I.swipeObj&&(I.swipeObj.active=!0),b.mouse(),w.mouse(),I},I.disableArrows=function(){return I.swipeObj&&(I.swipeObj.active=!1),b.noMouse(),w.noMouse(),I},Object.defineProperty(I,"selectedIndex",{get:function(){return(T+t.length)%t.length},set:function(d){T=e.constrain(d,0,t.length-r),I.tile.x=re-T*(U+o),g()}}),Object.defineProperty(I,"swipe",{get:function(){return A},set:function(d){A=d,A&&!I.swipeObj&&y(),I.swipeObj.active=A}}),j(),G(),y(),f&&f.center(I,1),T&&(I.selectedIndex=T),this.dispose=function(d,D,K){return I.swipeObj&&I.swipeObj.dispose(),I.recycleEvent&&I.off("cyclecleared",I.recycleEvent),I.cycleWait&&I.cycleWait.clear(),I.cycleInterval&&I.cycleInterval.clear(),I.swipeObj=I.recycleEvent=I.cycleWait=null,K||this.zimContainer_dispose(),!0},S!==!1&&e.styleTransforms(this,V),this.clone=function(){return I.cloneProps(new e.Carousel(e.copy(t),r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,this.group))}},e.extend(e.Carousel,e.Container,["clone","dispose"],"zimContainer",!1),e.Loader=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B,Z,U,ee,ae,re,he,j,G){var y="width, height, label, type, backgroundColor, rollBackgroundColor, color, rollColor, borderColor, rollBorderColor, borderWidth, corner, shadowColor, shadowBlur, hitPadding, gradient, gloss, dashed, backing, rollBacking, rollPersist, icon, rollIcon, toggle, toggleBacking, rollToggleBacking, toggleIcon, rollToggleIcon, toggleEvent, frame, multiple, accept, style, group, inherit",g;if(g=mt(e.Loader,arguments,y,this))return g;qe("67.5"),this.group=j;var d=he===!1?{}:e.getStyle("Loader",this.group,G);if(n(t)&&(t=d.width!=null?d.width:250),n(r)&&(r=d.height!=null?d.height:70),n(o)&&(o=d.type!=null?d.type:"image"),o=o.toLowerCase(),n(l)&&(l=d.backgroundColor!=null?d.backgroundColor:"rgba(0,0,0,.05)"),n(f)&&(f=d.rollBackgroundColor!=null?d.rollBackgroundColor:"rgba(0,0,0,.1)"),n(h)&&(h=d.color!=null?d.color:"rgba(0,0,0,.5)"),n(p)&&(p=d.rollColor!=null?d.rollColor:h),n(_)&&(_=d.borderColor!=null?d.borderColor:"rgba(0,0,0,.3)"),n(w)&&(w=d.borderWidth!=null?d.borderWidth:1),n(L)&&(L=d.dashed!=null?d.dashed:!0),n(C)&&(C=d.corner!=null?d.corner:0),n(ae)&&(ae=d.multiple!=null?d.multiple:!0),n(i)&&(i=d.label!=null?d.label:new e.Label({text:"UPLOAD PIC",color:h,rollColor:p,valign:"center",align:"center",backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",backgroundColor:"ignore",group:this.group})),typeof ee>"u")if(le.zdf)var ee=le.zdf;else{Ct&&ht("zim.Loader - please provide a reference to zim Frame");return}this.zimButton_constructor(t,r,i,l,f,null,h,p,null,_,w,b,null,S,E,null,X,q,null,C,L,O,P,R,T,null,null,null,null,null,A,null,null,null,k,V,null,null,null,null,null,null,I,te,null,B,Z,null,U,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,!1),this.type="Loader";var D=this,K=ee.stage;i=D.label;var m=D.tag=document.createElement("input");ee.tag?ee.tag.appendChild(m):document.body.appendChild(m),m.setAttribute("type","file"),m.setAttribute("aria-hidden",!0),ae&&m.setAttribute("multiple","multiple"),re&&m.setAttribute("accept",re),m.hidden=!0,m.zimDisplay=m.style.display||"inline-block",m.style.cssText="border:thin solid grey; z-index:2; width:"+t+"px; height:"+r+"px; overflow:hidden; outline:none;position:absolute; left:0px; top:0px; display:none; cursor:pointer; opacity: 0; filter: alpha(opacity=0);",this.addEventListener("mousedown",function(){m.click()}),m.addEventListener("change",Q);var F=new $e.DOMElement(m);K.addChild(F),F.alpha=0;var Ce=ee.retina&&le.devicePixelRatio||1;this.resize=function(J,ue){if(!D.stage){m.setAttribute("aria-hidden",!0),m.hidden=!0,m.style.display="none";return}m.setAttribute("aria-hidden",!1),m.hidden=!1,m.style.display=m.zimDisplay,n(J)&&(J=!0),D.time1&&clearTimeout(D.time1),ue||(D.time1=setTimeout(function(){D.resize(null,!0)},40));var ye=D.getConcatenatedMatrix().decompose(),Xe=D.localToGlobal(0,0);if(ee.retina){var se=e.browserZoom();ee.tag?(F.x=Xe.x/Ce/se,F.y=Xe.y/Ce/se):(F.x=ee.x/K.scaleX+Xe.x/Ce/se,F.y=ee.y/K.scaleY+Xe.y/Ce/se),e.sca(F,ye.scaleX/Ce/K.scaleX/se,ye.scaleY/Ce/K.scaleY/se)}else F.x=ee.x+Xe.x*ee.scale,F.y=ee.y+Xe.y*ee.scale,e.sca(F,ee.scale*ye.scaleX,ee.scale*ye.scaleY);return K.update(),D},this.resize(),D.on("added",function(){m.style.display="block",m.hidden=!1,m.style.display="block",D.resize()}),D.added(Y);function Y(){D.resize(),D.time2=setTimeout(function(){m.style.display="block",m.hidden=!1,m.style.display="block"},50),D.on("added",Y,null,!0)}D.on("removed",function(){D.time1&&clearTimeout(D.time1),D.time2&&clearTimeout(D.time2),m&&(m.style.display="none",m.hidden=!0,m.style.display="none")});function Q(J){var ue;if(J.dataTransfer&&J.dataTransfer.files&&J.dataTransfer.files.length>0?ue=J.dataTransfer.files:ue=J.target.files,o=="text"||o=="json"){var ye=[],Xe;if(o.toLowerCase()=="json")var se=[],Ae}else if(o=="other")var ie=[],_e;else var $=[],xe;for(var Be=0;Be<ue.length;Be++)(function(me){var Oe=new FileReader;Oe.onload=function(Ye){if(o=="text"||o=="json"){var de=Ye.target.result;if(ye.push(de),o=="json"){var ve=JSON.parse(de);se.push(ve)}if(ye.length==1&&(Xe=de,o=="json"&&(Ae=ve)),ye.length==ue.length){var Me=new $e.Event("loaded");Me.texts=ye,Me.text=Xe,Me.lastText=de,Me.total=ye.length,o=="json"&&(Me.jsons=se,Me.json=Ae,Me.lastJSON=ve),D.dispatchEvent(Me),m.value=""}}else if(o=="other"){var we=Ye.target.result;if(ie.push(we),ie.length==1&&(_e=we),ie.length==ue.length){var Me=new $e.Event("loaded");Me.others=ie,Me.other=_e,Me.lastOther=we,Me.total=ie.length,D.dispatchEvent(Me),m.value=""}}else{var Fe=new Image;Fe.onload=function(){var ge=new e.Bitmap(Fe);if($.push(ge),$.length==1&&(xe=ge),$.length==ue.length){var Ve=new $e.Event("loaded");Ve.bitmaps=$,Ve.bitmap=xe,Ve.lastBitmap=ge,Ve.total=$.length,D.dispatchEvent(Ve),m.value=""}},Fe.src=Ye.target.result}},o=="text"||o=="json"?Oe.readAsText(me):Oe.readAsDataURL(me)})(ue[Be])}var ce=new XMLHttpRequest;if(ce.upload){var pe=function(J){m.removeEventListener("change",Q),Q(J),setInterval(function(){m.addEventListener("change",Q)},100)};m.addEventListener("drop",pe)}this.save=function(J,ue,ye,Xe,se,Ae,ie,_e,$,xe,Be){var me="content, filename, x, y, width, height, cached, cachedBounds, type, data, quality",Oe;if(Oe=mt(D.save,arguments,me))return Oe;if(n(J)&&(J=ee.stage),n($)&&($="png"),n(ue))ue="saved_"+String(e.makeID("numbers",5))+"."+$;else{var Ye=ue.split(".");if(Ye.length==1)ue+="."+$;else{var de=["png","jpg","jpeg"],ve=de.indexOf(Ye[Ye.length-1].toLowerCase());ve==-1?ue+="."+$:$=de[ve]}}if(n(ye)&&(ye=0),n(Xe)&&(Xe=0),n(se)&&(se=J.getBounds&&J.getBounds()?J.getBounds().width:ee.width),n(Ae)&&(Ae=J.getBounds&&J.getBounds()?J.getBounds().height:ee.height),J.cache(ye,Xe,se,Ae),xe){var Me=J.cacheCanvas.toDataURL("image/"+$,Be);return ie?_e&&J.cache(_e.x,_e.y,_e.width,_e.height):J.uncache(),Me}var we=/Edge\/(\d)+/.test(navigator.userAgent);if(we){var Fe=le.open();Fe.document.write("<html><head><title>saved</title></head><body style='margin:0px;padding:0px;overflow:hidden'><img src="+J.cacheCanvas.toDataURL("image/"+$)+"></body></html>"),Fe.document.close()}else{$=="jpg"&&($="jpeg");var ge=document.createElement("a");ge.setAttribute("download",ue),ge.setAttribute("href",J.cacheCanvas.toDataURL("image/"+$,Be)),document.body.appendChild(ge),ge.click(),document.body.removeChild(ge)}return ie?_e&&J.cache(_e.x,_e.y,_e.width,_e.height):J.uncache(),D},he!==!1&&e.styleTransforms(this,d),this.clone=function(){var J=new e.Loader(t,r,n(i)?null:i.clone(),l,f,h,p,_,w,C,O,P,A,R,T,n(S)?null:S.clone(),n(E)?null:E.clone(),k,n(X)?null:X.clone(),n(q)?null:q.clone(),V,n(I)?null:I.clone(),n(te)?null:te.clone(),n(B)?null:B.clone(),n(Z)?null:Z.clone(),U,ee,he,this.group);return D.cloneProps(J)},Object.defineProperty(this,"frame",{get:function(){return ee},set:function(J){J!=ee&&(ee.off("update",D.updateEvent),ee.off("resize",D.resizeEvent),ee=J,D.resizeEvent=ee.on("resize",D.resize),D.updateEvent=ee.on("update",D.resize),D.resize())}}),this.resizeEvent=ee.on("resize",D.resize),this.updateEvent=ee.on("update",D.resize),this.dispose=function(J,ue,ye){var Xe;return D.stage&&(Xe=D.stage),ee.off("update",D.updateEvent),ee.off("resize",D.resizeEvent),Q&&m.removeEventListener("change",Q),pe&&m.removeEventListener("drop",pe),m&&m.parentNode&&m.parentNode.removeChild(m),m=null,ye||(this.zimButton_dispose(),Xe&&Xe.update()),!0}},e.extend(e.Loader,e.Button,["clone","dispose"],"zimButton",!1),e.TextArea=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B){var Z="width, height, placeholder, text, size, padding, color, backgroundColor, borderColor, borderWidth, corner, shadowColor, shadowBlur, dashed, id, readOnly, spellCheck, password, inputType, wrap, maxLength, frame, expand, keyboardShift, style, group, inherit",U;if(U=mt(e.TextArea,arguments,Z,this))return U;qe("67.6"),this.group=te;var ee=I===!1?{}:e.getStyle("TextArea",this.group,B);if(n(t)&&(t=ee.width!=null?ee.width:250),n(r)&&(r=ee.height!=null?ee.height:70),n(i)&&(i=ee.placeholder!=null?ee.placeholder:null),n(o)&&(o=ee.text!=null?ee.text:null),n(l)&&(l=ee.size!=null?ee.size:20),n(f)&&(f=ee.padding!=null?ee.padding:5),n(h)&&(h=ee.color!=null?ee.color:e.granite),n(p)&&(p=ee.backgroundColor!=null?ee.backgroundColor:"rgba(256,256,256,.1)"),n(_)&&(_=ee.borderColor!=null?ee.borderColor:"rgba(0,0,0,.1)"),n(b)&&(b=ee.borderWidth!=null?ee.borderWidth:null),_<0||b<0?_=b=null:_!=null&&b==null&&(b=1),n(w)&&(w=ee.corner!=null?ee.corner:0),!n(O)&&n(C)&&(C=ee.shadowColor!=null?ee.shadowColor:"rgba(0,0,0,.3)"),!n(C)&&n(O)&&(O=ee.shadowBlur!=null?ee.shadowBlur:10),n(L)&&(L=ee.password!=null?ee.password:!1),n(S)&&(S=ee.inputType!=null?ee.inputType:!1),n(E)&&(E=ee.wrap!=null?ee.wrap:!0),n(k)&&(k=ee.maxLength!=null?ee.maxLength:null),n(T)&&(T=ee.spellCheck!=null?ee.spellCheck:!0),n(R)&&(R=ee.readOnly!=null?ee.readOnly:!1),n(V)&&(V=ee.keyboardShift!=null?ee.keyboardShift:!1),this.maxLength=k,n(q)&&(q=ee.expand!=null?ee.expand:20),q===!0&&(q=20),typeof X>"u")if(le.zdf)var X=le.zdf;else{Ct&&ht("zim.TextArea - please provide a reference to zim Frame");return}this.zimContainer_constructor(t,r,null,null,!1),this.type="TextArea";var ae=this,re=X.stage,he=this.background=new e.Rectangle(t,r,p,_,b,w,P,null,null,!1).expand(q);C!=-1&&O>0&&(he.shadow=new $e.Shadow(C,3,3,O)),ae.addChild(he);var j=ae.tag=S||L?document.createElement("input"):document.createElement("textarea");X.tag?X.tag.appendChild(j):document.body.appendChild(j),n(A)||(j.setAttribute("id",A),j.setAttribute("name",A)),L?j.setAttribute("type","password"):S&&j.setAttribute("type",S),j.readOnly=R,j.spellcheck=T,i&&j.setAttribute("placeholder",i),o&&(j.value=o),j.zimDisplay=j.style.display||"inline-block",j.style.cssText="background-color:rgba(0,0,0,.01); color:"+h+"; resize:none; z-index:3; width:"+(t-f*2)+"px; height:"+(r-f*2)+"px; overflow:hidden; outline:none;font-size:"+l+"px; font-family:"+(ee.font!=null?ee.font:"arial")+"; border:none; position:absolute; left:0px; top:0px; display:none;",ae.taInput=function(){!n(ae.maxLength)&&ae.text.length>ae.maxLength&&(ae.text=ae.text.substring(0,ae.maxLength)),ae.dispatchEvent("input")};var G=ae.y;ae.taFocus=function(){if(le.M&&V){ae.re&&ae.stage.frame.off("resize",ae.re),ae.re=ae.stage.frame.on("resize",function(){ae.stage&&D>ae.stage.height/4&&(ae.stage.y=ae.stage.scaleY*(ae.stage.height/4-D),ae.stage.update())});var D=ae.localToGlobal(0,0).y;ae.stage&&D>ae.stage.height/4&&(ae.stage.y=ae.stage.scaleY*(ae.stage.height/4-D),ae.stage.update())}ae.stage&&(X=ae.stage.frame),X.zil&&le.removeEventListener("keydown",X.zil[0]),ae.dispatchEvent("focus")},ae.taBlur=function(){le.M&&V&&ae.stage&&(ae.re&&ae.stage.frame.off("resize",ae.re),ae.stage.y=G,ae.stage.update()),ae.stage&&(X=ae.stage.frame),X.zil&&le.addEventListener("keydown",X.zil[0]),ae.dispatchEvent("blur")},j.addEventListener("change",ae.taChange),j.addEventListener("input",ae.taInput),j.addEventListener("focus",ae.taFocus),j.addEventListener("blur",ae.taBlur);var y=new $e.DOMElement(j);y.alpha=0,this.on("mousedown",function(){setTimeout(function(){j.focus()},100)}),this.setFocus=function(D){return n(D)&&(D=!0),D?j.focus():j.blur(),ae};var g=X.retina&&le.devicePixelRatio||1;this.resize=function(D,K){n(D)&&(D=!0),ae.time1&&clearTimeout(ae.time1),K||(ae.time1=setTimeout(function(){ae.resize(null,!0)},40));var m=ae.getConcatenatedMatrix().decompose(),F=ae.localToGlobal(f,f);if(X.retina){var Ce=e.browserZoom();X.tag?(y.x=F.x/g/Ce,y.y=F.y/g/Ce):(y.x=X.x/re.scaleX+F.x/g/Ce,y.y=X.y/re.scaleY+F.y/g/Ce),e.sca(y,m.scaleX/g/re.scaleX/Ce,m.scaleY/g/re.scaleY/Ce)}else X.tag?(y.x=F.x*X.scale,y.y=F.y*X.scale):(y.x=X.x+F.x*X.scale,y.y=X.y+F.y*X.scale),e.sca(y,X.scale*m.scaleX,X.scale*m.scaleY);return y.alpha=ae.alpha,ae.parent&&(y.alpha*=ae.parent.alpha),D&&ae.stage&&re.update(),ae},this.resize(),ae.added(d);function d(){re.addChild(y),ae.time2=setTimeout(function(){j.style.display=j.zimDisplay},50),ae.resize(),ae.on("added",d,null,!0),ae.FOEvent=re.on("stagemousedown",function(){ae.focus=!1})}ae.on("removed",function(){ae.time1&&clearTimeout(ae.time1),ae.time2&&clearTimeout(ae.time2),re.removeChild(y),ae.FOEvent&&re.off("stagemousedown",ae.FOEvent),j&&(j.style.display="none")}),Object.defineProperty(this,"currentValue",{get:function(){return j.value},set:function(D){j.value=D}}),Object.defineProperty(this,"text",{get:function(){return j.value},set:function(D){j.value=D}}),Object.defineProperty(this,"focus",{get:function(){return document.activeElement==j},set:function(D){ae.setFocus(D)}}),Object.defineProperty(this,"readOnly",{get:function(){return j.readOnly},set:function(D){j.readOnly=D}}),le.KEYFOCUS!=null&&(e.KEYFOCUS=le.KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return e.KEYFOCUS==ae},set:function(){e.KEYFOCUS=ae}}),e.KEYFOCUS||(ae.keyFocus=!0),ae.taMousedown=function(){ae.keyFocus=!0},j.addEventListener("mousedown",ae.taMousedown),E||(j.style.whiteSpace="pre"),I!==!1&&e.styleTransforms(this,ee),this.clone=function(){var D=new e.TextArea(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,this.group,B);return ae.cloneProps(D)},Object.defineProperty(this,"frame",{get:function(){return X},set:function(D){D!=X&&(X.off("update",ae.updateEvent),X.off("resize",ae.resizeEvent),X=D,ae.resizeEvent=X.on("resize",ae.resize),ae.updateEvent=X.on("update",ae.resize),g=X.retina&&le.devicePixelRatio||1,re=X.stage,ae.resize())}}),this.resizeEvent=X.on("resize",ae.resize),this.updateEvent=X.on("update",ae.resize),this.dispose=function(D,K,m){var F;return ae.stage&&(F=ae.stage),X.off("update",ae.updateEvent),X.off("resize",ae.resizeEvent),F&&ae.FOEvent&&F.off("stagemousedown",ae.FOEvent),j&&j.parentNode&&j.parentNode.removeChild(j),j.removeEventListener("change",ae.taChange),j.removeEventListener("input",ae.taInput),j.removeEventListener("focus",ae.taFocus),j.removeEventListener("blur",ae.taBlur),j.removeEventListener("mousedown",ae.taMousedown),j=null,m||(this.zimContainer_dispose(!0),F&&F.update()),ae.background=null,!0}},e.extend(e.TextArea,e.Container,["clone","dispose"],"zimContainer",!1),e.Tag=function(t,r,i,o,l,f,h,p,_,b,w,C){var O="width, height, id, frame, backgroundColor, padding, paddingH, paddingV, expand, style, group, inherit",P;if(P=mt(e.Tag,arguments,O,this))return P;qe("67.7"),this.group=w;var A=b===!1?{}:e.getStyle("Tag",this.group,C);if(n(t)&&(t=A.width!=null?A.width:250),n(r)&&(r=A.height!=null?A.height:70),n(i)&&(i=A.id!=null?A.id:"zimTag_"+e.rand(1e4)),typeof o>"u")if(le.zdf)var o=le.zdf;else{Ct&&ht("zim.Tag - please provide a reference to zim Frame");return}n(l)&&(l=A.backgroundColor!=null?A.backgroundColor:"rgba(0,0,0,0)"),n(f)&&(f=A.padding!=null?A.padding:10),n(h)&&(h=A.paddingH!=null?A.paddingH:f),n(p)&&(p=A.paddingV!=null?A.paddingV:f),n(_)&&(_=A.expand!=null?A.expand:20),_===!0&&(_=20),this.zimContainer_constructor(t,r,null,null,!1),this.type="Tag",this.tagID=i,this.id=i;var R=this,T=o.stage;R.background=new e.Rectangle(t+h,r+p,l).center(this).expand(_||0);var L=R.tag=document.createElement("div");o.tag?o.tag.appendChild(L):document.body.appendChild(L),L.setAttribute("id",i),L.setAttribute("name",i),L.zimDisplay=L.style.display||"inline-block",L.style.cssText="resize:none; z-index:3; width:"+t+"px; height:"+r+"px; overflow:hidden; outline:none;position:absolute; left:0px; top:0px; display:none;";var S=new $e.DOMElement(L);S.alpha=0;var E=o.retina&&le.devicePixelRatio||1;this.resize=function(X,q){n(X)&&(X=!0),R.time1&&clearTimeout(R.time1),q||(R.time1=setTimeout(function(){R.resize(null,!0)},40));var V=R.getConcatenatedMatrix().decompose(),I=R.localToGlobal(0,0);if(o.retina){var te=e.browserZoom();o.tag?(S.x=I.x/E/te,S.y=I.y/E/te):(S.x=o.x/T.scaleX+I.x/E/te,S.y=o.y/T.scaleY+I.y/E/te),e.sca(S,V.scaleX/E/T.scaleX/te,V.scaleY/E/T.scaleY/te)}else S.x=o.x+I.x*o.scale,S.y=o.y+I.y*o.scale,e.sca(S,o.scale*V.scaleX,o.scale*V.scaleY);return S.alpha=R.alpha,R.parent&&(S.alpha*=R.parent.alpha),X&&R.stage&&T.update(),R},this.resize(),R.added(k);function k(){T.addChild(S),R.time2=setTimeout(function(){L.style.display=L.zimDisplay},50),R.resize(),R.on("added",k,null,!0)}R.on("removed",function(){R.time1&&clearTimeout(R.time1),R.time2&&clearTimeout(R.time2),T.removeChild(S),L&&(L.style.display="none")}),this.add=function(X){return L.innerHTML+=X,R},Object.defineProperty(this,"innerHTML",{get:function(){return L.innerHTML},set:function(X){L.innerHTML=X}}),Object.defineProperty(this,"style",{get:function(){return L.style},set:function(X){L.style=X}}),b!==!1&&e.styleTransforms(this,A),this.clone=function(){var X=new e.Tag(t,r,i,o,l,f,h,p,_,b,this.group,C);return R.cloneProps(X)},Object.defineProperty(this,"frame",{get:function(){return o},set:function(X){X!=o&&(o.off("update",R.updateEvent),o.off("resize",R.resizeEvent),o=X,R.resizeEvent=o.on("resize",R.resize),R.updateEvent=o.on("update",R.resize),R.resize())}}),this.resizeEvent=o.on("resize",R.resize),this.updateEvent=o.on("update",R.resize),this.dispose=function(X,q,V){var I;return R.stage&&(I=R.stage),o.off("update",R.updateEvent),o.off("resize",R.resizeEvent),L&&L.parentNode&&L.parentNode.removeChild(L),L=null,V||(this.zimContainer_dispose(!0),I&&I.update()),!0}},e.extend(e.Tag,e.Container,["clone","dispose"],"zimContainer",!1);function c(t,r){r?(t.mouseChildren=!0,t.mouseEnabled=!0,t._enabled=!0):(t.mouseChildren=!1,t.mouseEnabled=!1,t._enabled=!1)}if(e.addTo=function(t,r,i,o){var l="obj, container, index, localToLocal",f;if(f=mt(e.addTo,arguments,l))return f;if(qe("47.5"),n(t)){ht("zim methods - addTo(): please provide object");return}if(n(r))if(le.zdf)r=le.zdf.stage;else{ht("zim methods - addTo(): please provide container");return}if(n(o)&&(o=!0),t.parent||(o=!1),o)var h=t.parent.localToLocal(t.x,t.y,r);return n(i)||isNaN(i)?r.addChild(t):r.addChildAt(t,i),o&&(t.x=h.x,t.y=h.y),t},e.removeFrom=function(t,r){if(qe("47.6"),n(t)){ht("zim methods - removeFrom(): please provide object");return}return t.removePhysics&&t.removePhysics(),n(r)?t.parent&&t.parent.removeChild(t):r.removeChild(t),t},e.added=function(t,r,i,o){if(qe("47.7"),!(n(t)||n(r)||typeof r!="function")){var l=v(i);if(n(i)&&(i=l=="s"?.1:100),t.stage){r(t.stage,t);return}var f=i*(l=="s"?1e3:1),h;o&&(a(o),h=o*(l=="s"?1e3:1));var p=Date.now(),_=0,b=setInterval(function(){if(_>5){clearInterval(b);return}_++,t.stage&&(r(t.stage,t),clearInterval(b),clearInterval(w))},10),w=setInterval(function(){h>0&&p-Date.now()>h&&clearInterval(w),t.stage&&(r(t.stage,t),clearInterval(w))},f);return w}},e.centerReg=function(t,r,i,o){var l="obj, container, index, add",f;if(f=mt(e.centerReg,arguments,l))return f;if(t.type=="AC"&&le.zdf)return le.zdf.ac("centerReg",arguments),t.addTo(r,i);if(qe("48"),n(t)||!t.getBounds||!t.getBounds())return ht("zim methods - centerReg(): please provide object with bounds set"),t;n(o)&&(o=!0),n(r)&&t.parent&&o&&(r=t.parent,n(i)&&(i=t.parent.getChildIndex(t)),t.parent.removeChild(t)),!n(r)&&r==t.parent&&(n(i)&&(i=t.parent.getChildIndex(t)),t.parent.removeChild(t));var h=t.getBounds();return t.regX=h.x+h.width/2,t.regY=h.y+h.height/2,o?e.center(t,r,i):t},e.center=function(t,r,i,o){var l="obj, container, index, add",f;if(f=mt(e.center,arguments,l))return f;if(t.type=="AC"&&le.zdf)return le.zdf.ac("center",arguments),t.addTo(r,i);if(e.centerCheck||(qe("48.1"),e.centerCheck=!0),n(t)||!t.getBounds)return ht("zim.center(): please provide object with bounds"),t;if(n(r)&&(t.parent?r=t.parent:le.zdf&&(r=le.zdf.stage)),n(r)||!r.getBounds)return ht("zim.center(): please provide container with bounds"),t;var h=t.getBounds(),p=r.getBounds();n(o)&&(o=!0);var _=!1;if(n(p)&&(r.setBounds(0,0),p=r.getBounds(),_=!0),o&&r.addChild&&(n(i)||typeof i=="number"&&isNaN(i)?(!t.parent||t.parent!=r)&&r.addChild(t):r.addChildAt(t,i)),n(h))return t.x=p.x+p.width/2,t.y=p.y+p.height/2,t;var b=!1,w=!1;r.scaleX==0&&(b=!0,r.scaleX=1e-5),r.scaleY==0&&(w=!0,r.scaleY=1e-5);var C=t.localToLocal(t.regX,t.regY,r),O=e.boundsToGlobal(t),P=e.boundsToGlobal(r,O,!0);if(b&&(r.scaleX=0),w&&(r.scaleY=0),t.x=p.x+p.width/2-P.width/2+(C.x-P.x),t.y=p.y+p.height/2-P.height/2+(C.y-P.y),!o&&r.getStage&&r.stage&&t.parent){var A=r.localToLocal(t.x,t.y,t.parent);t.x=A.x,t.y=A.y}return _&&r.setBounds(null),t},e.place=function(t,r){if(qe("49"),n(t))return;n(r)&&(r="obj"),e.lastPlace=t;function i(){ht(r+".x = "+Math.round(t.x)+"; "+r+".y = "+Math.round(t.y)+";"),ht(r+".loc("+Math.round(t.x)+", "+Math.round(t.y)+");")}e.drag({obj:t,currentTarget:!0,dragCursor:"crosshair"}),t.on("mousedown",function(){e.lastPlace=t});var o=le.zdf;return o&&o.on("keydown",function(l){if(t==e.lastPlace){var f=l.keyCode;if(f>=37&&f<=40){var h=l.shiftKey?10:1;t.mov(f==37?-1*h:f==39?1*h:0,f==38?-1*h:f==40?1*h:0),i(),t.stage&&t.stage.update()}}}),ht("place "+r+" - to get new position",t),t.on("click",i),t},e.placeReg=function(t,r){if(qe("49.5"),n(t))return;var i=t.stage;if(n(i))return ht("zim.placeReg() - add object to stage before calling placeReg()"),t;n(r)&&(r="obj");function o(){var h=t.globalToLocal(f.x,f.y);ht(r+".regX = "+Math.round(h.x)+"; "+r+".regY = "+Math.round(h.y)+";"),ht(r+".reg("+Math.round(h.x)+", "+Math.round(h.y)+");")}var l=t.parent.localToGlobal(t.x,t.y),f=new e.Shape(-25,-25,50,50,null,!1).addTo(i).pos({x:l.x,y:l.y,reg:!0});return f.graphics.s("white").mt(-25,0).lt(25,0).mt(0,-25).lt(0,20),f.compositeOperation="difference",f.expand(0),e.drag({obj:f}),ht("place cursor to get new registration point location"),i.on("stagemouseup",o),t},e.pos=function(t,r,i,o,l,f,h,p,_,b,w){var C="obj, x, y, horizontal, vertical, container, index, add, reg, regX, regY",O;if(O=mt(e.pos,arguments,C))return O;if(t.type=="AC"&&le.zdf)return le.zdf.ac("pos",arguments),t.addTo(f,h);qe("41.5"),le.DIR&&le.DIR=="rtl"||!le.DIR&&e.DIR=="rtl"?o=="start"?o="right":o=="end"&&(o="left"):o=="start"?o="left":o=="end"&&(o="right");var P=!1;o=="right"&&(P=!0);var A=!1;l=="bottom"&&(A=!0);var R=e.POSREG;if(le.POSREG!=null&&(R=le.POSREG),n(_)&&(_=R),n(t))return;n(_)&&n(b)&&(b=!1),n(_)&&n(w)&&(w=!1),!n(_)&&n(b)&&(b=_),!n(_)&&n(w)&&(w=_),n(p)&&(p=!0),!n(f)&&!f.addChild&&(f=null),!t.getBounds&&!t.getBounds()&&(b=w=!1),t.zimPos={x:r,y:i,h:o,v:l,i:h},n(f)&&(t.parent?f=t.parent:le.zdf&&(f=le.zdf.stage)),!t.parent&&n(r)&&(r=0),!t.parent&&n(i)&&(i=0);var T=!1;t.getBounds()||(t.setBounds(0,0),T=!0);var L=!1;f&&!f.getBounds()&&(f.setBounds(0,0),L=!0);function S(){n(h)||typeof h=="number"&&isNaN(h)?f.contains(t)||f.addChild(t):f.addChildAt(t,h)}if(!n(f)&&f.addChild&&p){var E=f.getBounds().clone();S();var k=f.getBounds();(E.width!=k.width||E.height!=k.height||E.x!=k.x||E.y!=k.y)&&(t.removeFrom(),f.setBounds(E.x,E.y,E.width,E.height),L=!0,S())}if(!b&&!w&&(o=="center"||o=="middle")&&(l=="center"||l=="middle"))return t.center({container:f}),t.mov(r,i),T&&t.setBounds(null),L&&f.setBounds(null),t;if(o=="center"||o=="middle"){if(b)t.x=f.width/2;else{var X=t.y;t.center(),t.y=X}t.mov(r),r=null,o=null}else o===!0&&(P=!0);if(l=="center"||l=="middle"){if(w)t.y=f.height/2;else{var q=t.x;t.center(),t.x=q}t.mov(0,i),i=null,l=null}else l===!0&&(A=!0);function V(){var ee=t.getBounds(),ae=ee.x,re=ee.y,he=ee.width,j=ee.height,G=t._props.matrix;G=t.getMatrix(G),(ae||re)&&G.appendTransform(0,0,1,1,0,0,0,-ae,-re);var y=he*G.a,g=he*G.b,d=j*G.c,D=j*G.d,K=G.tx,m=G.ty,F=K,Ce=K,Y=m,Q=m;return(ae=y+K)<F?F=ae:ae>Ce&&(Ce=ae),(ae=y+d+K)<F?F=ae:ae>Ce&&(Ce=ae),(ae=d+K)<F?F=ae:ae>Ce&&(Ce=ae),(re=g+m)<Y?Y=re:re>Q&&(Q=re),(re=g+D+m)<Y?Y=re:re>Q&&(Q=re),(re=D+m)<Y?Y=re:re>Q&&(Q=re),{x:F,y:Y,width:Ce-F,height:Q-Y}}if(t.parent&&t.parent.getBounds){if(f=t.parent,n(r)&&P==!0&&(r=0),n(i)&&A==!0&&(i=0),n(r)||(t.x=r),n(i)||(t.y=i),n(r)&&n(i)&&!P&&!A)return T&&t.setBounds(null),L&&f.setBounds(null),t;var I=0,te=0;if(t.getBounds()){var B=V();if(!n(r)){var Z;P?Z=new e.Point(B.x+B.width,B.y+B.height):Z=new e.Point(B.x,B.y),I=Z.x-r}n(i)||(A?Z=new e.Point(B.x+B.width,B.y+B.height):Z=new e.Point(B.x,B.y),te=Z.y-i);var U=f.getBounds();n(r)||(P?b?t.x=U.width+U.x-r:t.x=U.width+U.x-r-I:(b?t.x=r:t.x=r-I,t.x+=U.x)),n(i)||(A?w?t.y=U.height+U.y-i:t.y=U.height+U.y-i-te:(w?t.y=i:t.y=i-te,t.y+=U.y))}}return T&&t.setBounds(null),L&&f.setBounds(null),p||t.removeFrom(),t},e.loc=function(t,r,i,o,l,f,h,p){var _="obj, target, y, container, index, add, localToLocal, x",b;if(b=mt(e.loc,arguments,_))return b;if(t.type=="AC"&&le.zdf)return le.zdf.ac("loc",arguments),t.addTo(o,l);if(qe("41.55"),!n(t)){if(typeof r=="number"&&(p=r,r=null),n(r)||(Array.isArray(r)?(p=r[0],i=r[1]):(n(r.x)||(p=r.x),n(r.y)||(i=r.y))),n(p)&&n(r)&&(p=t.x),n(i)&&n(r)&&(i=t.y),n(f)&&(f=!0),n(o)&&(t.parent?o=t.parent:le.zdf&&(o=le.zdf.stage)),f&&o&&(!t.parent||o!=t.parent?n(l)||isNaN(l)?o.addChild(t):o.addChildAt(t,l):n(l)||o.addChildAt(t,l)),n(h)&&(h=!0),r&&r.parent&&t.parent&&h){var w=r.parent.localToLocal(p,i,t.parent);p=w.x,i=w.y}return t.x=p,t.y=i,t}},e.mov=function(t,r,i){var o="obj, x, y",l;if(l=mt(e.mov,arguments,o))return l;if(t.type=="AC"&&le.zdf)return le.zdf.ac("mov",arguments),t;if(qe("41.6"),!n(t))return n(r)||(t.x+=r),n(i)||(t.y+=i),t},e.sca=function(t,r,i){return t.type=="AC"&&le.zdf?(le.zdf.ac("sca",arguments),t):(qe("41.97"),n(t)||n(t.scaleX)||(n(r)&&(r=t.scaleX),n(i)&&(i=r),t.scaleX=r,t.scaleY=i),t)},e.alp=function(t,r){if(qe("41.7"),!n(t))return n(r)||(t.alpha=t.hovOriginal=r,t.tag&&t.tag.style&&(t.type!="Loader"&&(t.tag.style.opacity=r),r==0?t.tag.style.display=t.tag.zimDisplay="none":t.tag.style.display=t.tag.zimDisplay="inline-block")),t},e.vis=function(t,r){if(qe("41.71"),!n(t))return t.visible=r,t.tag&&t.tag.style&&(r?t.tag.style.display=t.tag.zimDisplay="inline-block":t.tag.style.display=t.tag.zimDisplay="none"),t},e.ble=function(t,r){if(qe("41.72"),!n(t))return n(r)&&(r="difference"),t.compositeOperation=r,(t.type=="Blob"||t.type=="Squiggle")&&t.update(),t},e.dye=function(t,r){if(qe("41.73"),!n(t))return t.hasOwnProperty("backgroundColor")?t.backgroundColor=r:t.hasOwnProperty("color")&&(t.color=r),t},e.hov=function(t,r,i){if(qe("41.75"),!n(t))return n(r)&&(r=1),n(i)&&(i=typeof r=="number"?"alpha":"color"),t.hovMouseover&&(t.off("mouseover",t.hovMouseover),t.off("mouseout",t.hovMouseout)),r==-1?(t.cur("default"),n(t.hovOld)||(t[t.hovType]=t.hovOld),t.hovOld=null,t.stage&&t.stage.update(),t):(t.cur(),t.hovOld=t[i],t.hovNew=r,t.hovType=i,t.hovMouseover=t.on("mouseover",function(){t[i]=t.hovNew,t.stage&&t.stage.update()}),t.hovMouseout=t.on("mouseout",function(){t[i]=t.hovOld,t.stage&&t.stage.update()}),t)},e.rot=function(t,r,i,o){if(qe("41.8"),!n(t)){if(t.type=="AC"&&le.zdf)return le.zdf.ac("rot",arguments),t;if(!n(r))if(t.parent&&(!n(i)||!n(o))){n(i)&&(i=t.x),n(o)&&(o=t.y);var l=t.parent.localToLocal(i,o,t),f=new e.Point(t.x,t.y);t.reg(l.x,l.y),t.rotation=r,t.x=i,t.y=o;var h=t.parent.localToLocal(f.x,f.y,t);t.reg(h.x,h.y),t.x=f.x,t.y=f.y}else t.rotation=r;return t}},e.siz=function(t,r,i,o){if(qe("41.85"),!n(t))return t.type=="AC"&&le.zdf?(le.zdf.ac("siz",arguments),t):(n(o)&&(o=!1),!n(r)&&!n(i)?(t.widthOnly=r,t.heightOnly=i):n(r)?n(i)||(o?t.heightOnly=i:t.height=i):o?t.widthOnly=r:t.width=r,t)},e.ske=function(t,r,i){if(qe("41.9"),!n(t))return t.type=="AC"&&le.zdf?(le.zdf.ac("ske",arguments),t):(n(r)||(t.skewX=r),n(i)||(t.skewY=i),t)},e.reg=function(t,r,i,o){if(qe("41.95"),!n(t)){if(t.type=="AC"&&le.zdf)return le.zdf.ac("reg",arguments),t;var l=t.regX,f=t.regY,h=r,p=le.DIR||e.DIR||"ltr",_;if(r=="default"&&(r=null),typeof r=="string"&&(_=t.getBounds(),_?(r=="start"&&(r=p=="ltr"?"left":"right"),r=="end"&&(r=p=="ltr"?"right":"left"),r=="left"?r=_.x:r=="right"?r=_.x+_.width:(r=="center"||r=="middle")&&(r=_.x+_.width/2)):r=null),typeof i=="string"?(_||(_=t.getBounds()),_?i=="top"?i=_.y:i=="bottom"?i=_.y+_.height:(i=="center"||i=="middle")&&(i=_.y+_.height/2):i=null):n(i)&&(h=="center"||h=="middle")&&(_||(_=t.getBounds()),_?i=_.y+_.height/2:i=null),i=="default"&&(i=null),n(r)||(t.regX=r),n(i)||(t.regY=i),o&&t.parent){var b=t.localToLocal(l,f,t.parent);t.x-=b.x-t.x,t.y-=b.y-t.y}return t}},e.top=function(t){return qe("41.62"),n(t)||!t.parent||t.parent.setChildIndex(t,t.parent.numChildren-1),t},e.bot=function(t){return qe("41.63"),n(t)||!t.parent||t.parent.setChildIndex(t,0),t},e.ord=function(t,r){if(qe("41.64"),!(n(t)||!t.parent))return n(r)&&(r=0),t.parent.setChildIndex(t,e.constrain(t.parent.getChildIndex(t)+r,0,t.parent.numChildren-1)),t},e.cur=function(t,r){if(qe("41.1"),n(t))return ht("zim methods - cur(): please provide object"),t;n(r)&&(r="pointer");var i=le.zdf;return t.stage&&(i=t.stage.frame),i.cursors&&i.cursors[r]?(t.cursor="none",t._cursor=r,i.cursorList.add(t,r),t):(i.cursorList&&i.cursorList.add(t,!0),t.cursor=r,t)},e.sha=function(t,r,i,o,l){return qe("41.2"),n(t)?(ht("zim methods - sha(): please provide object"),t):(n(r)&&(r="rgba(0,0,0,.3)"),r.blur?(t.shadow=r,t):(n(i)&&(i=t.width?t.width*.08:5),n(o)&&(o=t.height?t.height*.08:5),n(l)&&(l=t.width?t.width*.16:10),r==-1?t.shadow=null:t.shadow=new $e.Shadow(r,i,o,l),t))},e.dep=function(t,r){if(qe("41.65"),!n(t))return n(r)&&(r=0),t.depth=r,t},e.nam=function(t,r){if(qe("41.67"),!(n(t)||n(r)))return t.name=r,e.zimObjectIDs[r]=t,t},e.movement=function(t,r,i){qe("47.75");var o=t.stage||le.zdf.stage;function l(){o=t.stage,t.zimMovementStage=o,t.zimMovementEvent&&o.off("stagemousemove",t.zimMovementEvent),t.zimMovementEvent=o.on("stagemousemove",function(f){r(f)}),t.on("mouseout",function(){t.zimMovementEvent&&o.off("stagemousemove",t.zimMovementEvent)},null,!0)}return e.mobile()?(t.zimMovementEvent&&o.off("pressmove",t.zimMovementEvent),t.zimMovementEvent=t.on("pressmove",function(f){r(f)})):(t.zimMouseoverEvent&&t.off("mouseover",t.zimMouseoverEvent),t.zimMouseoverEvent=t.on("mouseover",l),i&&l()),t},e.noMovement=function(t){if(qe("47.9"),!n(t))return t.zimMouseoverEvent&&t.off("mouseover",t.zimMouseoverEvent),t.zimMovementEvent&&t.zimMovementStage&&t.zimMovementStage.off("stagemousemove",t.zimMovementEvent),t},e.tap=function(t,r,i,o,l,f,h,p,_,b){var w="obj, call, distance, time, once, dbl, dblTime, call2, call3, call4",C;if(C=mt(e.tap,arguments,w))return C;if(qe("47.8"),!(n(t)||n(r)||typeof r!="function")){n(i)&&(i=f?10:5);var O=v(o);n(o)&&(o=O=="s"?8:8e3),n(l)&&(l=!1),n(f)&&(f=!1),n(h)&&(b?h=O=="s"?.5:500:h=O=="s"?1:1e3),t.cur("pointer");var P=!1,A=!1,R;return f?t.zimDblClickDownEvent=t.on("mousedown",function(T){if(R=!1,P){P=!1;return}if(P=!0,T.currentTarget.type=="List"){if(T.target.type=="WindowBacking")return;var L=T.currentTarget.globalToLocal(T.stageX/e.scaX,T.stageY/e.scaY);if(L.y<=0)return}var S=T.stageX/e.scaX,E=T.stageY/e.scaY,k=Date.now(),X,q;A=!0,t.zimDoubleTimeout&&clearTimeout(t.zimDoubleTimeout),t.zimDoubleTimeout=setTimeout(function(){if(A=!1,P=!1,t.zimDblClickUpEvent&&t.off("pressup",t.zimDblClickUpEvent),R&&b)if(Math.abs(S+E-X/e.scaX-q/e.scaY)<i){if(t.excludeTap)return;b(T)}else p&&p(T)},O=="s"?h*1e3:h),t.zimDblClickUpEvent=t.on("pressup",function(V){if(X=V.stageX,q=V.stageY,R=!0,P){_&&_(V);return}else if(!A)return;if(Math.abs(S+E-V.stageX/e.scaX-V.stageY/e.scaY)<i&&Date.now()-k<(O=="s"?o*1e3:o)){if(t.excludeTap)return;clearTimeout(t.zimDoubleTimeout),r(V)}else p&&p(V);V.remove()})},null,l):t.zimClickDownEvent=t.on("mousedown",function(T){if(T.currentTarget.type=="List"){if(T.target.type=="WindowBacking")return;var L=T.currentTarget.globalToLocal(T.stageX/e.scaX,T.stageY/e.scaY);if(L.y<=0)return}var S=T.stageX/e.scaX,E=T.stageY/e.scaY,k=Date.now();t.zimClickUpEvent=t.on("pressup",function(X){if(Math.abs(S+E-X.stageX/e.scaX-X.stageY/e.scaY)<i&&Date.now()-k<(O=="s"?o*1e3:o)){if(t.excludeTap)return;r(X)}else p&&p(X);X.remove()})},null,l),t}},e.noTap=function(t){if(qe("47.9"),!n(t))return t.cursor&&t.cur("default"),t.zimClickDownEvent&&t.off("mousedown",t.zimClickDownEvent),t.zimClickUpEvent&&t.off("pressup",t.zimClickUpEvent),t.zimDoubleTimeout&&clearInterval(t.zimDoubleTimeout),t},e.hold=function(t,r,i,o,l){if(qe("47.87"),!(n(t)||n(r)||typeof r!="function")){n(i)&&(i=5);var f=v(o);n(o)&&(o=f=="s"?1.5:1500),n(l)&&(l=!1),t.cur("pointer");var h;return t.zimClickHoldDownEvent=t.on("mousedown",function(p){if(h||(h=p.target.stage),!!h){if(n(h.frame)&&(h.frame=le.zdf),(n(h.frame)||!h.frame.mousemoveEvent)&&(n(h.frame)&&(h.frame={}),h.frame.mouseX=p.stageX/e.scaX,h.frame.mouseY=p.stageY/e.scaY,h.frame.mouseholdEvent&&h.off("stagemousemove",h.frame.mouseholdEvent),h.frame.mouseholdEvent=h.on("stagemousemove",function(O){h.frame.mouseX=O.stageX/e.scaX,h.frame.mouseY=O.stageY/e.scaY})),p.currentTarget.type=="List"){if(p.target.type=="WindowBacking")return;var _=p.currentTarget.globalToLocal(p.stageX/e.scaX,p.stageY/e.scaY);if(_.y<=0)return}var b=p.stageX/e.scaX,w=p.stageY/e.scaY;clearInterval(t.zimHoldInterval);var C=0;t.zimHoldInterval=setInterval(function(){if(C<10)Math.abs(b+w-h.frame.mouseX-h.frame.mouseY)>i&&clearInterval(t.zimHoldInterval);else{if(Math.abs(b+w-h.frame.mouseX-h.frame.mouseY)<i){if(t.excludeHold)return;r(p)}clearInterval(t.zimHoldInterval)}C++},o/10*(f=="s"?1e3:1)),t.zimClickHoldUpEvent=t.on("pressup",function(){clearInterval(t.zimHoldInterval),h&&h.frame.mouseholdEvent&&h.off("stagemousemove",h.frame.mouseholdEvent)},null,!0)}},null,l),t}},e.noHold=function(t){if(qe("47.88"),!n(t))return t.cursor&&t.cur("default"),t.off("mousedown",t.zimClickHoldDownEvent),t.off("pressup",t.zimClickHoldUpEvent),t.stage&&t.stage.frame.mouseEvent&&t.stage.off("stagemousemove",t.stage.frame.mouseEvent),clearInterval(t.zimHoldTimeout),t},e.change=function(t,r,i){if(qe("47.85"),!(n(t)||n(r)||typeof r!="function"))return n(i)&&(i=!1),t.zimChangeEvent=t.on("change",function(o){r(o)},null,i),t},e.noChange=function(t){if(qe("47.95"),!n(t))return t.off("mousedown",t.zimChangeEvent),t},e.drag=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X){var q="obj, boundary, axis, overCursor, dragCursor, all, swipe, localBoundary, onTop, surround, slide, slideFactor, slideSnap, slideSnapDamp, reg, removeTweens, startBounds, rect, currentTarget, offStage, immediateBoundary, singleTouch",V;if(V=mt(e.drag,arguments,q))return V;if(qe("31"),n(t)||!t.on)return;var I=e.DRAGALL;if(le.DRAGALL!=null&&(I=le.DRAGALL),n(f)&&n(S)&&(f=I),n(f)&&n(S)?S=!1:n(f)?n(S)&&(S=!1):S=f,(t.type=="Tag"||t.type=="TextArea"||t.type=="Loader")&&(S=!0),r&&r.getBounds&&(t.type=="Container"||t.type=="Tile")&&t.mouseChildren==!0&&!f){var te=Array.prototype.slice.call(arguments);return te[4]=!0,setTimeout(function(){t.loop(function(Le){te[0]=Le,e.drag.apply(null,te)})},k?0:50),t}(n(i)||i=="all"||i!="horizontal"&&i!="vertical")&&(i="both"),t.zimDown&&t.noDrag(),t.cur(n(o)?"pointer":o),n(h)&&(h=!1),n(p)&&(p=!1),n(_)&&(_=!0),n(b)&&(b=!1),n(w)&&(w=!1),n(C)&&(C=.9),n(O)&&(O=!0);var B=["horizontal","vertical","auto"];if(O!==!0&&B.indexOf(O)<0&&(O=!1),O=="auto"&&(O=!0),n(P)&&(P=.1),n(A)&&(A=!1),n(R)&&(R=!0),n(T)&&(T=!0),n(r)&&!n(L)&&(r=L),n(X)&&(X=!1),t.dragPaused=!1,w)var Z,U,ee,ae,re,he,j,G,y,g,d,D,K,m,F,Ce,Y,Q,ce=le.M?20:10,pe,J,ue,ye,Xe=!1,se=!1,Ae=50;else t.zimDragTicker=function(){};t._draggable=!0,e.setSwipe(t,h),t.zimBoundary=r,t.zimlocalBoundary=p,t.circleBounds=r&&r.type=="Circle"?r.radius:!1,t.downCheck=!1;var ie=!1,_e,$,xe,Be,me;t.zimAdded=t.on("added",Oe,null,!0),t.zimRemoved=t.on("removed",Ye,null,!0),t.parent&&Oe();function Oe(){if(t.off("added",t.zimAdded),r=t.zimBoundary,r&&r.getBounds&&r.type!="Blob"){if(t.zimlocalBoundary=!1,r.type!="Stage"&&r.type!="StageGL"?r=r.boundsToGlobal():r=new e.Boundary(0,0,r.width,r.height),!b){var Le=t.boundsToGlobal();me=t.localToGlobal(t.regX,t.regY);var fe=new e.Point(me.x-Le.x,me.y-Le.y),Ge=t.borderWidth?t.borderWidth:0;r.x+=fe.x+Ge/2,r.y+=fe.y+Ge/2,r.width-=Le.width+Ge,r.height-=Le.height+Ge}t.zimBoundary=r}_e=0,$=0,t.zimBoundary&&t.zimBoundary.type!="Blob"&&(p?(xe=e.boundsToGlobal(t.parent,t.zimBoundary),b&&(Be=t.zimBoundary)):(xe=t.zimBoundary,b&&(Be=e.boundsToGlobal(t.parent,t.zimBoundary,!0)))),xe&&T&&(me=t.parent.localToGlobal(t.x,t.y),we(t,me.x,me.y)),w&&setTimeout(function(){w&&O&&(Z=new e.Damp(null,P),U=new e.Damp(null,P)),t.zimDragImmediate=function(Qe,Ke){d=Qe,D=Ke,pe=J=0,ue=ye=0,G=K=y=m=g=F=0,w&&O&&(n(Qe)||Z.immediate(Qe),n(Ke)||U.immediate(Ke))},ee=3,ae=0,re=[],he=[],j=[],G=t.x,y=t.y,d=t.x,D=t.y,K=t.x,m=t.y,F=Date.now(),Ce=-1e4,Y=-1e4,t.zimDragMoving=!0,He()},50),n(t.zimMaskDynamic)||t.zimMaskApply()}function Ye(){t.zimDragTicker&&e.Ticker.remove(t.zimDragTicker)}var de,ve;t.pointers={};var Me=!1;t.zimDown=t.on("mousedown",function(Le){if(!(!t.stage||t.dragPaused)&&!(X&&Me)){Me=!0,ve=t.stage,t.zmu||(t.zmu=ve.frame.on("mouseupplus",function(st){t.downCheck&&(w||(t.downCheck=!1),Fe(st,!0))})),t.dragMouseX=Math.round(Le.stageX/e.scaX)+ve.x,t.dragMouseY=Math.round(Le.stageY/e.scaY)+ve.y;var fe="id"+Math.abs(Le.pointerID+1);if(t.pointers[fe]=!0,de=S?Le.currentTarget:Le.target,t.zimBoundary&&!de.getBounds()){ht("zim.drag() - drag object needs bounds set");return}if(t.downCheck=!0,t.stage.mouseMoveOutside=!0,e.Ticker.has(t.zimDragTicker)||e.Ticker.add(t.zimDragTicker,t.stage),R&&t.zimTweens)for(var Ge in t.zimTweens){var Qe=t.zimTweens[Ge];Qe.zimObj&&(Qe.zimObj.x!=null||Qe.zimObj.y!=null)&&t.stopAnimate(Ge)}if(de.parent){if(_){var Ke=de.parent.numChildren-1;de.parent.getChildAt(Ke).type=="Keyboard"&&Ke--,de.parent.setChildIndex(de,Ke),de.ZIMoutlineShape&&de.outline()}de.parent==t.stage?me=new e.Point(Le.stageX/e.scaX,Le.stageY/e.scaY):me=de.parent.globalToLocal(Le.stageX/e.scaX,Le.stageY/e.scaY),A&&(de.x=me.x,de.y=me.y),_e=me.x-de.x,$=me.y-de.y,xe=null,t.zimBoundary&&(p?(xe=e.boundsToGlobal(de.parent,t.zimBoundary),b&&(Be=t.zimBoundary)):(xe=t.zimBoundary,b&&(Be=e.boundsToGlobal(de.parent,t.zimBoundary,!0)))),t.cur(n(l)?"pointer":l),w&&(t.slideStartX=t.x,t.slideStartY=t.y,Q=t.zimDragMoving,ae=0,re=[me.x],he=[me.y],j=[Date.now()],Ce=-1e4,Y=-1e4,t.zimDragMoving=!0),t.type=="Pen"&&(t.zimDragCheck=!0,ie=!1)}}},!0),t.zimMove=t.on("pressmove",function(Le){if(!(X&&!t.pointers["id"+Math.abs(Le.pointerID+1)])&&!(!t.downCheck||t.dragPaused)){var fe=(E?Le.rawX:Le.stageX)/e.scaX+ve.x,Ge=(E?Le.rawY:Le.stageY)/e.scaY+ve.y;t.dragMouseX=Math.round(fe),t.dragMouseY=Math.round(Ge),we(de,fe,Ge),de.ZIMoutlineShape&&de.outline(),t.type=="Pen"&&!ie&&t.drawing?ie=!0:(t.type=="Tag"||t.type=="TextArea"||t.type=="Loader")&&t.resize()}},!0);function we(Le,fe,Ge){if(n(Le)&&(Le=de||t),!!Le.parent){if(n(fe)||n(Ge)){var Qe=Le.parent.localToGlobal(Le.x,Le.y);_e=$=0,t.zimBoundary&&(p?(xe=e.boundsToGlobal(Le.parent,t.zimBoundary),b&&(Be=Le.zimBoundary)):(xe=t.zimBoundary,b&&(Be=e.boundsToGlobal(Le.parent,t.zimBoundary,!0)))),fe=Qe.x,Ge=Qe.y,w&&(d=Le.x,D=Le.y,de=Le)}var Ke;ve&&ve.type?Ke=Le.parent.globalToLocal(fe,Ge):Ke=Le.parent.globalToLocal(fe*e.scaX,Ge*e.scaY);var st=i=="both"||i=="horizontal",yt=i=="both"||i=="vertical",We;w&&O?O=="vertical"?(We=ge(Le,Ke.x-_e,Ke.y-$),st&&(Le.x=We.x),yt&&(Le.y=Ke.y-$)):O=="horizontal"?(We=ge(Le,Ke.x-_e,Ke.y-$),st&&(Le.x=Ke.x-_e),yt&&(Le.y=We.y)):(st&&(Le.x=Ke.x-_e),yt&&(Le.y=Ke.y-$)):(We=ge(Le,Ke.x-_e,Ke.y-$),st&&(Le.x=We.x),yt&&(Le.y=We.y)),w&&!Q&&(Le.slideStartX!=Le.x||Le.slideStartY!=Le.y)&&(Q=!0)}}t.zimPosition=we,t.zimUp=t.on("pressup",function(Le){Fe(Le)},!0);function Fe(Le,fe){if(!(X&&!fe&&!t.pointers["id"+Math.abs(Le.pointerID+1)])){Me=!1;var Ge="id"+Math.abs((n(Le.pointerID)?0:Le.pointerID)+1);if(delete t.pointers[Ge],!(!t.downCheck||t.dragPaused)){if(t.cur(n(o)?"pointer":o),w){if(de.dispatchEvent("slidestart"),de.parent){var Qe=E?Le.rawX:Le.stageX,Ke=E?Le.rawY:Le.stageY;me=de.parent.globalToLocal(Qe/e.scaX,Ke/e.scaY)}else me=new e.Point(0,0);G=me.x,y=me.y,g=Date.now(),isNaN(G)&&(G=-1e3),isNaN(y)&&(y=-1e3),ue=G-K,ye=y-m;var st=g-F;pe=e.constrain(ue*ce/st,-Ae,Ae),J=e.constrain(ye*ce/st,-Ae,Ae),Xe=!1,se=!1,t.downCheck=!1,d=de.x,D=de.y,fe&&(K=G=0,m=y=0,F=g=0)}else{t.downCheck=!1;var yt=0;for(var We in t.pointers)yt++;yt==0&&e.Ticker.remove(t.zimDragTicker),t.type=="Pen"&&(t.zimDragCheck=!1,ie&&t.drawing&&t.stopCheck())}t.stage&&t.stage.update()}}}function ge(Le,fe,Ge){if(!Le.parent)return{x:fe,y:Ge};if(xe)if(b){var Qe=Le.getBounds().width,Ke=Le.getBounds().height,st=Le.getBounds().x,yt=Le.getBounds().y;Qe<Be.width?fe=Be.x+(Be.width-Qe)/2+(Le.regX-st):(fe-(Le.regX-st)>Be.x&&(fe=Be.x+(Le.regX-st)),fe-(Le.regX-st)+Qe<Be.x+Be.width&&(fe=Be.x+Be.width+(Le.regX-st)-Qe)),Le.height<Be.height?Ge=Be.y+(Be.height-Ke)/2+(Le.regY-yt):(Ge-(Le.regY-yt)>Be.y&&(Ge=Be.y+(Le.regY-yt)),Ge-(Le.regY-yt)+Ke<Be.y+Be.height&&(Ge=Be.y+Be.height+(Le.regY-yt)-Ke))}else{if(xe.type=="Blob")return xe.shape.hitTestPoint(fe,Ge)?{x:fe,y:Ge}:{x:t.x,y:t.y};if(me=Le.parent.localToGlobal(fe,Ge),t.circleBounds){var We=xe.x+xe.width/2,at=xe.y+xe.height/2,ct=t.circleBounds;if(e.dist(We,at,me.x,me.y)<=ct)fe=me.x,Ge=me.y;else{var Pe=e.angle(We,at,me.x,me.y)*RAD;fe=We+ct*Math.cos(Pe),Ge=at+ct*Math.sin(Pe)}}else fe=Math.max(xe.x,Math.min(xe.x+xe.width,me.x)),Ge=Math.max(xe.y,Math.min(xe.y+xe.height,me.y));me=Le.parent.globalToLocal(fe,Ge),fe=me.x,Ge=me.y}return{x:fe,y:Ge}}function Ve(Le,fe,Ge,Qe,Ke){Math.abs(Le.x-Ce)<.1&&Math.abs(Le.y-Y)<.1?(t.zimDragMoving=!1,Le.x=Qe,Le.y=Ke,Le.slideStartX=null,Le.slideStartY=null,Q&&(Le.dispatchEvent("slidestop"),e.Ticker.remove(t.zimDragTicker)),t.type=="Pen"&&(t.zimDragCheck=!1,ie&&t.drawing&&t.stopCheck())):(Ce=fe,Y=Ge)}function He(){t.zimDragTicker=function(){if(!n(t.slideStartX))if(de||(de=t),t.downCheck){var Le;de.parent?Le=de.parent.globalToLocal(t.dragMouseX,t.dragMouseY):Le=new e.Point(0,0),ae++,re.push(Le.x),he.push(Le.y),j.push(Date.now()),ae>=ee?(K=re.shift(),m=he.shift(),F=j.shift()):(K=re[0],m=he[0],F=j[0])}else{if(!t.zimDragMoving)return;ue=pe,ye=J;var fe,Ge;i==BOTH?(fe=de.x+ue,Ge=de.y+ye):i==HORIZONTAL?(fe=de.x+ue,Ge=de.y):i==VERTICAL&&(fe=de.x,Ge=de.y+ye),pe=ue*C,J=ye*C;var Qe;xe&&(Qe=ge(de,fe,Ge),(O===!0||O=="horizontal")&&(Math.round(fe)!=Math.round(Qe.x)&&(Xe||(Z.immediate(fe),Xe=!0),pe=0,fe=Z.convert(Qe.x)),O=="horizontal"&&(Ge=Qe.y)),(O===!0||O=="vertical")&&(Math.round(Ge)!=Math.round(Qe.y)&&(se||(se=!0,U.immediate(Ge),J=0),Ge=U.convert(Qe.y)),O=="vertical"&&(fe=Qe.x)),O||(fe=Qe.x,Ge=Qe.y)),de.x=fe,de.y=Ge,Ve(de,de.x,de.y,fe,Ge)}}}return t},e.noDrag=function(t,r){if(qe("32"),n(t)||!t.on)return;if(n(r)&&(r=!0),r&&t.numChildren&&t.numChildren>1)for(var i=0;i<t.numChildren;i++){var o=t.getChildAt(i);l(o)}l(t);function l(f){f.cur&&f.cur("default"),f._draggable=!1,e.setSwipe(f,!0),f.off("added",f.zimAdded),f.off("removed",f.zimRemoved),f.off("mousedown",f.zimDown),f.off("pressmove",f.zimMove),f.off("pressup",f.zimUp),f.zmu&&(f.stage?f.stage.frame.off("mouseupplus",f.zmu):le.zdf.off("mouseupplus",f.zmu)),e.Ticker&&(f.zimDragSlide&&e.Ticker.remove(f.zimDragSlide),f.zimDragTicker&&e.Ticker.remove(f.zimDragTicker)),f.zimDragMoving=f.zimAdded=f.zimRemoved=f.zimDown=f.zimMove=f.zimUp=f.zimBoundary=f.zimDragSlide=null,f.slideStartX=f.slideStartY=f.zimDragImmediate=null,f.dragMouseX=f.zimPosition=f.dragMouseY=f.zimDown=f.zimUp=null,f.zimDragTicker=f.zimDragSlide=null}return t},e.dragBoundary=function(t,r){if(qe("33"),!(n(t)||!t.on))return t.zimBoundary=r,t.zimDragMoving=!0,t.zimPosition&&t.zimPosition(),t},e.dragRect=e.dragBoundary,e.mouse=function(t){return qe("33.1"),t.zimLastMouse&&(t.mouseChildren=t.zimLastMouse),t.mouseEnabled=!0,t.zimLastMouseEnabled=!0,t},e.noMouse=function(t){return qe("33.15"),t.zimLastMouse=t.mouseChildren,t.mouseChildren=!1,t.mouseEnabled=!1,t.zimLastMouseEnabled=!1,t},e.wire=function(t,r,i,o,l,f,h,p){var _="source, target, prop, twoWay, setSource, filter, call, input",b;if(b=mt(e.wire,arguments,_))return b;if(qe("33.2"),n(e.Ticker)&&Ct)return ht("wire() - requires ZIM Frame"),t;if(n(r)&&Ct)return ht("wire() - requires a target"),t;var w=e.DEFAULTWIRE;return le.DEFAULTWIRE!=null&&(w=le.DEFAULTWIRE),n(p)&&(w&&w!="currentValue"&&w!="selectedIndex"||w&&Object.prototype.hasOwnProperty.call(t,w)?p=w:Object.prototype.hasOwnProperty.call(t,"currentValue")?p="currentValue":Object.prototype.hasOwnProperty.call(t,"selectedIndex")?p="selectedIndex":p=i),n(i)&&(i=p),t.addChild&&(t.zimWire=!0),r.addChild&&(r.zimWired=!0),e.Ticker.addWire(t,[r,i,o,l,f,h,p]),t},e.noWire=function(t,r,i,o){var l="source, target, prop, input",f;return(f=mt(e.noWire,arguments,l))?f:(qe("33.25"),n(e.Ticker)&&Ct?(ht("noWire() - requires ZIM Frame"),t):(e.Ticker.removeWire(t,r,i,o),t))},e.wired=function(t,r,i,o,l,f,h,p){var _="target, source, prop, twoWay, setSource, filter, call, input",b;return(b=mt(e.wired,arguments,_))?b:(qe("33.3"),n(e.Ticker)&&Ct?(ht("wired() - requires ZIM Frame"),t):(e.wire(r,t,i,o,l,f,h,p),t))},e.noWired=function(t,r,i,o){var l="target, source, prop, input",f;return(f=mt(e.noWire,arguments,l))?f:(qe("33.35"),n(e.Ticker)&&Ct?(ht("noWired() - requires ZIM Frame"),t):(e.Ticker.removeWire(r,t,i,o),t))},typeof x>"u")var x;if(e.bind=function(t,r,i,o,l,f){var h="obj, id, props, extra, filter, bindObj",p;if(p=mt(e.bind,arguments,h))return p;if(qe("33.17"),!x)return Ct&&ht("bind() - needs a Bind() object created first"),t;if(n(r))return Ct&&ht("bind() - needs a unique id"),t;var _=f||x;return _.add(r,t,i,o,l),t},e.noBind=function(t,r,i,o,l){var f="obj, props, removeConnectionData, call, bindObj",h;if(h=mt(e.noBind,arguments,f))return h;if(qe("33.18"),!x)return t;var p=l||x;return p.remove(t,r,i,o),t},e.transform=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B,Z,U,ee){var ae="obj, move, stretchX, stretchY, scale, rotate, allowToggle, visible, onTop, showStretch, showRotate, showScale, showReg, showBorder, borderColor, borderWidth, dashed, customCursors, handleSize, regSize, snapDistance, snapRotation, cache, events, ghostColor, ghostWidth, ghostDashed, ghostHidden, frame, container",re;if(re=mt(e.transform,arguments,ae))return re;if(t.type=="AC"&&le.zdf)return le.zdf.ac("transform",arguments),t;if(qe("33.5"),n(t)||!t.getBounds)return ht("zim methods - transform(): please provide object with bounds set"),t;if(!t.getBounds())return ht("zim methods - transform(): please setBounds() on object"),t;if(!t.parent)return ht("zim methods - transform(): object should be on stage first"),t;n(r)&&(r=!0),n(i)&&(i=!0),n(o)&&(o=!0),t.width==0&&(i=!1),t.height==0&&(o=!1),n(l)&&(l=!0),n(f)&&(f=!0),n(h)&&(h=!0),n(p)&&(p=!0),n(_)&&(_=!0),n(b)&&(b=!!he),n(w)&&(w=!!he),n(C)&&(C=!0),n(O)&&(O=!0),n(P)&&(P=!0),n(A)&&(A="brown"),n(R)&&(R=1),n(I)&&(I=null),n(te)&&(te=null),I<0||te<0?I=te=null:I!=null&&te==null&&(te=1),n(B)&&(B=!0),n(Z)&&(Z=!1),n(U)&&(U=le.zdf);var he=le.M;n(L)&&(L=!he),n(S)&&(S=he?20:10),n(E)&&(E=16),n(k)&&(k=10),n(X)&&(X=5),n(q)&&(q=!0),n(V)&&(V=!1),(t.type=="Tag"||t.type=="TextArea"||t.type=="Loader")&&(V=!0),t.mouseChildren=!1;var j=t.getConcatenatedMatrix().decompose(),G=t.stage?t.stage:U.stage;n(ee)&&(ee=G),n(U.eventRemove)&&(G.enableMouseOver(),U.ctrlKey=!1,U.shiftKey=!1,le.addEventListener("keydown",function(ut){U.altKey=ut.altKey,U.ctrlKey=ut.ctrlKey}),le.addEventListener("keyup",function(ut){U.altKey=ut.altKey,U.ctrlKey=ut.ctrlKey}));var y=t.getBounds(),g=new e.Shape({style:!1}),d=new e.Shape({style:!1}),D=new e.Shape({style:!1});d.mouseEnabled=!1,D.controlType="reg";var K=t.parent,m=g.graphics,F=d.graphics,Ce=D.graphics,Y,Q,ce,pe,J,ue,ye,Xe,se,Ae=new e.Container({style:!1});Ae.type="TransformControls";var ie=new e.Container({style:!1}),_e=new e.Container({style:!1}),$=new e.Container({style:!1}),xe=new e.Container({style:!1}),Be,me,Oe,Ye,de;n(t.zimMaskDynamic)||t.zimMaskApply();function ve(ut,At){ut==At&&new e.Triangle(16,12,12,"white",null,null,0).addTo(ut).mov(0,-13.5),new e.Triangle(16,12,12,"white",null,null,0).addTo(ut).mov(13.5).rot(90),ut==At&&new e.Triangle(16,12,12,"white",null,null,0).addTo(ut).mov(0,13.5).rot(180),new e.Triangle(16,12,12,"white",null,null,0).addTo(ut).mov(-13.5).rot(-90),ut==At&&new e.Triangle(10,7,7,"black",null,null,0).addTo(ut).mov(0,-13),new e.Triangle(10,7,7,"black",null,null,0).addTo(ut).mov(13).rot(90),ut==At&&new e.Triangle(10,7,7,"black",null,null,0).addTo(ut).mov(0,13).rot(180),new e.Triangle(10,7,7,"black",null,null,0).addTo(ut).mov(-13).rot(-90),q&&ut.cache(-20,-20,40,40)}if(L){var Me=new e.Container({style:!1}),we=new e.Container({style:!1});ve(Me,Me),ve(we,Me);var Fe={"nw-resize":45,"ne-resize":-45,"n-resize":90,"e-resize":0}}function ge(){var ut=t;for(Be=0,me=1,Oe=1,Ye=0,de=0;ut.parent;)Be+=ut.rotation,me*=ut.scaleX,Oe*=ut.scaleY,Ye+=ut.skewX,de+=ut.skewY,ut=ut.parent}ge();var Ve=Be,He=["nw-resize","ne-resize","nw-resize","ne-resize"],Le=[2,3,0,1],fe,Ge;for(Ge=0;Ge<4;Ge++)C?(fe=new e.Rectangle(S,S,e.pink,e.grey,2,null,null,null,null,!1),fe.centerReg(ie),q&&fe.cache(-1,-1,S+2,S+2)):(fe=new e.Rectangle(S,S,"rgba(0,0,0,0)","rgba(0,0,0,0)",2,null,null,null,null,!1),fe.centerReg(ie),fe.expand(0)),fe.rotation=Be,ye=L?"none":He[Ge],fe.drag({overCursor:ye,dragCursor:ye,onTop:!1}),fe.controlType="corner",fe.cu=He[Ge];for(Ge=0;Ge<Le.length;Ge++)ie.getChildAt(Ge).op=ie.getChildAt(Le[Ge]);var Qe=["n-resize","e-resize","n-resize","e-resize"];for(Le=[1,1,0,0],Ge=0;Ge<4;Ge++){var Ke=Ge%2==0?t.width/2:S,st=Ge%2==0?S:t.height/2;b?(fe=new e.Rectangle(S,S,e.fog,e.dark,2,null,null,null,null,!1),fe.centerReg(Ge%2==0?$:_e),q&&fe.cache(-1,-1,S+2,S+2)):(fe=new e.Rectangle(Ke,st,"rgba(0,0,0,0)",null,null,null,null,null,null,!1),fe.centerReg(Ge%2==0?$:_e),fe.expand(0)),fe.rotation=Be,ye=L?"none":Qe[Ge],fe.drag({overCursor:ye,dragCursor:ye,onTop:!1}),fe.controlType="side",fe.cu=Qe[Ge]}for(Ge=0;Ge<Le.length;Ge++){var yt=Ge%2==0?$:_e;yt.getChildAt(Math.floor(Ge/2)).op=yt.getChildAt(Le[Ge])}var We=["ne-resize","nw-resize","ne-resize","nw-resize"];for(Ge=0;Ge<4;Ge++)w?(fe=new e.Circle(S,e.pink,null,null,null,null,null,null,!1),fe.addTo(xe),q&&fe.cache(-S,-S,S*2,S*2)):(fe=new e.Circle(S,"rgba(0,0,0,0)",null,null,null,null,null,null,!1),fe.addTo(xe),fe.expand(0)),ye=L?"none":We[Ge],fe.drag({overCursor:ye,dragCursor:ye,onTop:!1}),fe.controlType="rotate",fe.cu=We[Ge];var at=1.8;xe.alpha=.5,ct();function ct(){var ut=S*at*e.sign(me),At=S*at*e.sign(Oe);xe.getChildAt(0).reg(ut,At),xe.getChildAt(1).reg(-ut,At),xe.getChildAt(2).reg(-ut,-At),xe.getChildAt(3).reg(ut,-At),G.update()}function Pe(){m.c(),F.c(),Ce.c(),Y=t.localToLocal(y.x,y.y,ee),Q=t.localToLocal(y.x+y.width,y.y,ee),ce=t.localToLocal(y.x+y.width,y.y+y.height,ee),pe=t.localToLocal(y.x,y.y+y.height,ee);var ut=t.localToLocal(y.x+y.width/2,y.y,ee),At=t.localToLocal(y.x+y.width,y.y+y.height/2,ee),Ht=t.localToLocal(y.x+y.width/2,y.y+y.height,ee),Jt=t.localToLocal(y.x,y.y+y.height/2,ee);J=t.localToLocal(t.regX,t.regY,ee),ue=t.localToLocal(y.x+y.width/2,y.y+y.height/2,ee),se=[Y,Q,ce,pe],Xe=[ut,At,Ht,Jt],P&&(m.s(A),T&&m.sd([10,5],0),m.ss(R).mt(Y.x,Y.y).lt(Q.x,Q.y).lt(ce.x,ce.y).lt(pe.x,pe.y).lt(Y.x,Y.y).cp()),n(I)||(F.s(I),B&&F.sd([10,5],0),F.ss(te).mt(Y.x,Y.y).lt(Q.x,Q.y).lt(ce.x,ce.y).lt(pe.x,pe.y).lt(Y.x,Y.y).cp()),g.setBounds(Y.x,Y.y,Q.x-Y.x,pe.y-Y.y),O&&(Ce.s("#eee").ss(R).f("rgba(0,0,0,.1)").dc(0,0,E),Ce.s("#222").ss(R).dc(0,0,E*.3)),ge();for(var zt=Math.min(50,Math.abs(Ye))*e.sign(Ye),Qt=Math.min(50,Math.abs(de))*e.sign(de),Mt=Be*e.sign(me*Oe)*e.sign(t.scaleX*t.scaleY),Ft=0;Ft<se.length;Ft++){var yn=se[Ft];ie.getChildAt(Ft).loc(yn.x,yn.y).ske(zt,Qt).rot(Mt),xe.getChildAt(Ft).loc(yn.x,yn.y).rot(Mt);var gn=Xe[Ft],nn=Ft%2==0?$:_e;nn.getChildAt(Math.floor(Ft/2)).loc(gn.x,gn.y).ske(zt,Qt).rot(Mt),b||nn.getChildAt(Math.floor(Ft/2)).sca(Ft%2==0?me/2:1,Ft%2==0?1:Oe/2)}D.x=J.x,D.y=J.y}Pe();var Ie=new e.Shape(1e3,1e3,null,null,null,!1);function be(){Ie.x=0,Ie.y=0,Ie.graphics.c().f("rgba(0,0,0,.01)").mt(Y.x,Y.y).lt(Q.x,Q.y).lt(ce.x,ce.y).lt(pe.x,pe.y).lt(Y.x,Y.y).cp(),Ie.reg(J.x,J.y),Ie.x=J.x,Ie.y=J.y}be(),Ae.on("dblclick",function(ut){U.ctrlKey&&t.transformControls.visible&&(t.scaleX=1,t.scaleY=1,t.rotation=0,Pe(),be(),G.update()),Lt(ut,!0)});var ze=Ae.on("mousedown",je),it=t.on("mousedown",je);function je(ut){var At=G.getObjectUnderPoint(ut.stageX,ut.stageY,1);he||At&&(t.contains&&t.contains(At)||!t.contains&&t==At)?t.transformControls.visible||(L?(Nt=!1,Ie.mouseEnabled=!1):U.canvas.style.cursor="move",t.transformControls.show(),t.dispatchEvent("transformshow")):t.transformControls.visible&&(!At||!Ae.contains(At))&&(t.transformControls.hide(),t.dispatchEvent("transformhide"))}var tt=G.on("stagemousedown",function(ut){var At=G.getObjectUnderPoint(ut.stageX,ut.stageY,1),Ht=At&&At.parent&&At.parent.layer&&At.parent.layer==t;t.transformControls.visible&&(!At||!Ae.contains(At)&&!Ht)&&(t.dispatchEvent("transformhide"),t.transformControls.hide())});h||(Ae.off("mousedown",ze),t.off("mousedown",it),G.off("stagemousedown",tt));var Te,et,Ue,Re,Ze,Je,nt,pt,De,lt,vt,rt,xt,wt=!1,_t=!1,ft,Ot,Rt=t.cursor,St,Gt=new e.Circle(30,"rgba(0,0,0,0)",null,null,null,null,null,null,!1).expand(20);if(L){Gt.mouseEnabled=!1,Gt.mouseChildren=!1,Gt.addChild(we),ie.on("mouseover",ot),ie.on("mouseout",bt),_e.on("mouseover",ot),_e.on("mouseout",bt),$.on("mouseover",ot),$.on("mouseout",bt),xe.on("mouseover",ot),xe.on("mouseout",bt);var Yt=new e.Circle(30,"rgba(0,0,0,0)",null,null,null,null,null,null,!1).expand(20);Yt.cursor="none"}ie.on("mousedown",$t),ie.on("pressmove",sn),ie.on("pressup",Lt),_e.on("mousedown",$t),_e.on("pressmove",sn),_e.on("pressup",Lt),$.on("mousedown",$t),$.on("pressmove",sn),$.on("pressup",Lt),xe.on("mousedown",$t),xe.on("pressmove",en),xe.on("pressup",Lt);function $t(ut){_t=!0,_&&Bt(),ft&&G.off("stagemousemove",ft),Te=ut.target.x,et=ut.target.y,lt=t.x,vt=t.y,Ue=t.scaleX,Re=t.scaleY;var At=ee.globalToLocal(ut.stageX/e.scaX,ut.stageY/e.scaY);if(ut.target.controlType=="rotate"){wt=!0,Ze=t.rotation;var Ht=At.x,Jt=At.y,zt=K.localToLocal(lt,vt,ee);rt=zt.x,xt=zt.y,Je=Math.atan2(Jt-xt,Ht-rt)*180/Math.PI}U.ctrlKey||ut.target.controlType=="rotate"?(nt=Math.abs(Te-t.x),pt=Math.abs(et-t.y)):(nt=Math.abs(Te-ut.target.op.x),pt=Math.abs(et-ut.target.op.y)),ut.target.controlType!="rotate"&&(De=ut.target.op.parent.localToLocal(ut.target.op.x,ut.target.op.y,t.parent)),Gt.stage?ee.setChildIndex(Gt,ee.getChildIndex(Ae)):Gt.addTo(ee,ee.getChildIndex(Ae)+1),Gt.x=At.x,Gt.y=At.y,Gt.cursor=L?"none":ut.target.cu,L&&(t.getConcatenatedMatrix().decompose(j),j.rotation||(j.rotation=0),we.rotation=j.rotation*e.sign(me*Oe)*e.sign(t.scaleX*t.scaleY)+Fe[ut.target.cu]+Ve,ut.target.controlType!="side"&&me*Oe<0&&(we.rotation+=90),Yt.addTo(ee,1).pos({x:At.x,y:At.y,reg:!0})),Ie.visible=!1,t.cursor="none"}function sn(ut){var At=1;U.ctrlKey&&ut.target.controlType=="corner"?At=nt>pt?(ut.target.x-lt)/(Te-lt):(ut.target.y-vt)/(et-vt):nt>pt?Te-ut.target.op.x&&(At=(ut.target.x-ut.target.op.x)/(Te-ut.target.op.x)):et-ut.target.op.y&&(At=(ut.target.y-ut.target.op.y)/(et-ut.target.op.y)),ut.target.controlType=="corner"?(t.scaleX=At*Ue,t.scaleY=At*Re):(t.scaleX=ut.target.cu=="e-resize"?At*Ue:Ue,t.scaleY=ut.target.cu=="n-resize"?At*Re:Re),Pe();var Ht=ee.globalToLocal(ut.stageX/e.scaX,ut.stageY/e.scaY);if(Gt.x=Ht.x,Gt.y=Ht.y,L&&(Yt.x=Ht.x,Yt.y=Ht.y),!U.ctrlKey||ut.target.controlType=="side"){var Jt=ut.target.op.parent.localToLocal(ut.target.op.x,ut.target.op.y,t.parent);t.x-=(Jt.x-De.x)*e.sign(me)*e.sign(t.scaleX),t.y-=(Jt.y-De.y)*e.sign(Oe)*e.sign(t.scaleY)}if(Pe(),t.transformControls.events){var zt=ut.target.controlType;Zt(ut,zt)}}function en(ut){var At=ee.globalToLocal(ut.stageX/e.scaX,ut.stageY/e.scaY),Ht=Math.atan2(At.y-xt,At.x-rt)*180/Math.PI;if(U.shiftKey?t.rot(Math.round((Ze+(Ht-Je)*e.sign(me)*e.sign(t.scaleX))/45)*45):t.rot(Ze+(Ht-Je)*e.sign(me)*e.sign(t.scaleX)),Pe(),Gt.x=At.x,Gt.y=At.y,L&&(t.getConcatenatedMatrix().decompose(j),j.rotation||(j.rotation=0),we.rotation=j.rotation*e.sign(me*Oe)*e.sign(t.scaleX*t.scaleY)+Fe[ut.target.cu]+Ve,ut.target.controlType!="side"&&me*Oe<0&&(we.rotation+=90),Yt.x=At.x,Yt.y=At.y),Pe(),t.transformControls.events){var Jt=ut.target.controlType;Zt(ut,Jt,null,!1)}}function Lt(ut,At){ct();var Ht=ut?ut.target.controlType:"move";At&&(Ht="reset"),L&&Yt.removeFrom(),Zt(ut,Ht,!0),G.update()}function Zt(ut,At,Ht,Jt){Jt==null&&(Jt=!0);var zt=!1;St=null;var Qt=ee.globalToLocal(ut.stageX/e.scaX,ut.stageY/e.scaY);At=="move"?((t.x!=ln.x||t.y!=ln.y)&&(St=new $e.Event("transformed"),St.transformType="move"),Jt&&(zt=Ie.hitTestPoint(Qt.x,Qt.y))):At=="corner"?((t.scaleX!=ln.scaleX||t.scaleY!=ln.scaleY)&&(St=new $e.Event("transformed"),St.transformType="size"),Jt&&(zt=ie.hitTestPoint(Qt.x,Qt.y))):At=="side"?((t.scaleX!=ln.scaleX||t.scaleY!=ln.scaleY)&&(St=new $e.Event("transformed"),St.transformType="stretch"),Jt&&(zt=_e.hitTestPoint(Qt.x,Qt.y)||$.hitTestPoint(Qt.x,Qt.y))):At=="rotate"?(t.rotation!=ln.rotation&&(St=new $e.Event("transformed"),St.transformType="rotate"),Jt&&(zt=xe.hitTestPoint(Qt.x,Qt.y))):At=="reg"?(t.regX!=ln.regX||t.regY!=ln.regY)&&(St=new $e.Event("transformed"),St.transformType="reg"):At=="reset"?(St=new $e.Event("transformed"),St.transformType="reset"):(St=new $e.Event("transformed"),St.transformType="unknown"),Jt&&!zt&&(Gt.removeFrom(),U.canvas.style.cursor="default",t.cursor=Rt),St&&(St.pressup=Ht,(t.type=="Tag"||t.type=="TextArea"||t.type=="Loader")&&t.resize(),t.dispatchEvent(St))}function ot(ut){if(!_t){Gt.stage?ee.setChildIndex(Gt,ee.getChildIndex(Ae)):Gt.addTo(ee,ee.getChildIndex(Ae)+1),Yt.addTo(ee,1);var At=ee.globalToLocal(ut.stageX/e.scaX,ut.stageY/e.scaY);Gt.x=At.x,Gt.y=At.y,Yt.x=At.x,Yt.y=At.y,t.getConcatenatedMatrix().decompose(j),j.rotation||(j.rotation=0),we.rotation=j.rotation*e.sign(me*Oe)*e.sign(t.scaleX*t.scaleY)+Fe[ut.target.cu]+Ve,ut.target.controlType!="side"&&me*Oe<0&&(we.rotation+=90),G.update(),ft&&G.off("stagemousemove",ft),ft=G.on("stagemousemove",function(Ht){var Jt=ee.globalToLocal(Ht.stageX/e.scaX,Ht.stageY/e.scaY);Gt.x=Jt.x,Gt.y=Jt.y,G.update()})}}function bt(){G.off("stagemousemove",ft),!_t&&(t.cursor=Rt,Gt.removeFrom(),Yt.removeFrom(),G.update())}function Bt(){if(_){var ut=K.numChildren-1;K.getChildAt(ut).type=="Keyboard"&&ut--,K.setChildIndex(t,ut),It()}}function It(){if(K==ee)Ae.removeFrom(),ee.addChildAt(Ae,ee.getChildIndex(t)+1);else{for(var ut=K;ut.parent&&ut.parent!=ee;)ut=ut.parent;t.stage&&(Ae.parent==ee&&ee.removeChild(Ae),ee.addChildAt(Ae,ee.getChildIndex(ut)+1))}}var Ut,kt;D.drag(),D.on("mousedown",Bt),D.on("pressup",function(ut){if(!U.ctrlKey){for(var At=0;At<se.length;At++)if(e.dist(D.x,D.y,se[At].x,se[At].y)<k){D.x=se[At].x,D.y=se[At].y;break}e.dist(D.x,D.y,ue.x,ue.y)<k&&(D.x=ue.x,D.y=ue.y)}var Ht=t.rotation;Ut=ee.localToLocal(D.x,D.y,t),K==G?kt=new e.Point(D.x,D.y):kt=ee.localToLocal(D.x,D.y,K),t.reg(Ut.x,Ut.y),t.rotation=0,t.x=t.x+kt.x-t.x,t.y=t.y+kt.y-t.y,t.rotation=Ht,Pe(),be(),Lt(ut),G.update()});var Nt=!0;ye=L?"none":"move",Ie.drag({overCursor:ye,dragCursor:ye,onTop:!1}),Ie.controlType="move",L&&(Ie.on("mouseover",jt),Ie.on("mouseout",Wt));function Wt(){G.off("stagemousemove",Ot),!_t&&(Me.removeFrom(Ae),G.update())}function jt(ut){if(!(_t||!L||!Nt)){var At=ee.globalToLocal(ut.stageX/e.scaX,ut.stageY/e.scaY);Me.addTo(Ae).pos({x:At.x,y:At.y,reg:!0}),G.update(),Ot&&G.off("stagemousemove",Ot),Ot=G.on("stagemousemove",function(Ht){var Jt=ee.globalToLocal(Ht.stageX/e.scaX,Ht.stageY/e.scaY);Me.x=Jt.x,Me.y=Jt.y,G.update()})}}Ie.on("mousedown",Bt),Ie.on("pressmove",function(ut){if(t.transformControls.visible){var At;if(K==G?At=new e.Point(Ie.x,Ie.y):At=ee.localToLocal(Ie.x,Ie.y,K),t.x=At.x,t.y=At.y,Pe(),t.transformControls.events){var Ht="move";Zt(ut,Ht)}}}),Ie.on("pressup",function(ut){t.transformControls.visible&&Lt(ut)});var rn=G.on("stagemouseup",function(){_t=!1,Ie.mouseEnabled=!0,Nt||(St=new $e.Event("transformed"),t.x!=ln.x||t.y!=ln.y?St.transformType="move":St.transformType="select",St.pressup=!0,t.dispatchEvent(St)),Nt=!0,Ie.visible=!0,wt&&!U.ctrlKey&&X>1&&(t.rotation=Math.round(t.rotation/X)*X,Pe()),be(),Ie.mouseEnabled=!0,wt=!1,G.update()});function Kt(){ln={x:t.x,y:t.y,rotation:t.rotation,regX:t.regX,regY:t.regY,scaleX:t.scaleX,scaleY:t.scaleY}}var ln;Kt();var tn=t.on("mousedown",Kt);Ae.on("mousedown",Kt),Ae.addChild(g),r&&Ae.addChild(Ie),l&&Ae.addChild(ie),i&&Ae.addChild(_e),o&&Ae.addChild($),f&&Ae.addChild(xe),Ae.addChild(D);var xn;r&&(t.drag({overCursor:"pointer",dragCursor:"pointer",onTop:!1,removeTweens:!1}),xn=t.on("pressmove",function(ut){if(Pe(),be(),ct(),t.transformControls.events){var At="move";Zt(ut,At)}}));var Pt=h;return t.transformControls={visible:p,events:V,ghost:!n(I),ghostEnabled:!n(I),show:function(){return _&&Bt(),It(),t.toggled=!0,t.transformControls.visible=!0,d.parent&&d.removeFrom(),G.update(),t},hide:function(){if(t.transformControls.ghost)var ut=ee.getChildIndex(Ae);return ee.removeChild(Ae),t.transformControls.ghost&&t.transformControls.ghostEnabled&&ee.addChildAt(d,ut),t.toggled=!1,t.transformControls.visible=!1,L&&(ft&&G.off("stagemousemove",ft),Ot&&G.off("stagemousemove",Ot),_t=!1,Gt.removeFrom(),Yt.removeFrom()),r||t.cur(Rt),G.update(),t},remove:function(ut){ut||t.transformControls.hide(),h=!1,r&&(t.noDrag(),t.off("pressmove",xn))},add:function(ut){ut||t.transformControls.show(),h=Pt,r&&(t.drag({overCursor:"pointer",dragCursor:"pointer",onTop:!1,removeTweens:!1}),xn=t.on("pressmove",xn))},allowToggleOn:function(){h=Pt=!0,ze=Ae.on("mousedown",ze),it=t.on("mousedown",it),tt=G.on("stagemousedown",tt)},allowToggleOff:function(){h=Pt=!1,Ae.off("mousedown",ze),t.off("mousedown",it),G.off("stagemousedown",tt)},disable:function(){Ae.mouseChildren=!1,Ae.mouseEnabled=!1,r&&(t.noDrag(),t.off("pressmove",xn))},enable:function(){Ae.mouseChildren=!0,Ae.mouseEnabled=!0,r&&(t.drag({overCursor:"pointer",dragCursor:"pointer",onTop:!1,removeTweens:!1}),xn=t.on("pressmove",xn))},recordData:function(ut){var At={type:t.type,index:K.getChildIndex(t),x:t.x,y:t.y,scaleX:t.scaleX,scaleY:t.scaleY,rotation:t.rotation,skewX:t.skewX,skewY:t.skewY,regX:t.regX,regY:t.regY,controls:t.transformControls.visible};return ut?JSON.stringify(At):At},setData:function(ut,At){if(!n(ut)){At&&(ut=JSON.parse(ut)),delete ut.controls;var Ht=ut.index;n(Ht)&&(Ht=0),delete ut.index;for(var Jt in ut)t[Jt]=ut[Jt];return setTimeout(function(){Pe(),be(),ct(),K.setChildIndex(t,Ht),t.transformControls.visible&&t.type!="Layer"?t.transformControls.show():t.transformControls.hide(),t.transformControls.ghost&&!t.transformControls.ghostEnabled&&!t.transformControls.visible&&ee.addChild(d)},90),t}},hideGhost:function(){t.transformControls.ghost=!1,d.removeFrom()},showGhost:function(){if(t.transformControls.ghost=!0,t.transformControls.ghostEnabled&&!t.transformControls.visible){for(var ut=K;ut.parent&&ut.parent!=ee;)ut=ut.parent;d.stage?ee.setChildIndex(d,ee.getChildIndex(ut)+1):ee.addChildAt(d,ee.getChildIndex(ut)+1)}},addGhost:function(){te>0?(t.transformControls.ghostEnabled=!0,t.transformControls.showGhost()):Ct&&ht("transform() - ghostWidth must be > 0 when making transform")},removeGhost:function(){t.transformControls.ghostEnabled=!1,t.transformControls.hideGhost()},resize:function(ut){if(K=t.parent,Pe(),be(),ct(),p&&t.transformControls.show(),ut){var At=new $e.Event("transformed");At.pressup=!0,At.transformType="resize",t.dispatchEvent(At)}return t},dispose:function(){t.transformControls.hide(),h=!1,r&&(t.noDrag(),t.off("pressmove",xn)),t.transformControls.hideGhost(),Ie.removeAllEventListeners(),xe.removeAllEventListeners(),D.removeAllEventListeners(),_e.removeAllEventListeners(),$.removeAllEventListeners(),ie.removeAllEventListeners(),Ae.removeAllEventListeners(),it&&t.off("mousedown",it),ze&&t.off("mousedown",ze),tt&&G.off("stagemousedown",tt),ft&&G.off("stagemousemove",ft),Ot&&G.off("stagemousemove",Ot),rn&&G.off("stagemouseup",rn),tn&&t.off("mousedown",tn),xn&&t.off("pressmove",xn),Ae=Gt=Yt=null,t.transformControls=null},controls:Ae,scaleControls:ie,stretchXControls:_e,stretchYControls:$,rotateControls:xe},t.toggle=function(ut){return ut===!0?t.transformControls.show():ut===!1||t.transformControls.visible?t.transformControls.hide():t.transformControls.show(),t},t.transformControls.ghost&&(t.transformControls.toggleGhost=function(ut){return ut===!0?t.transformControls.showGhost():ut===!1||t.transformControls.visible?t.transformControls.hideGhost():t.transformControls.showGhost(),t}),p?t.transformControls.show():!Z&&t.transformControls.ghost&&t.transformControls.showGhost(),t},e.gesture=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R){var T="obj, move, scale, rotate, boundary, minScale, maxScale, snapRotate, localBoundary, slide, slideFactor, regControl, onTop, surround, circularBounds, rect",L;if(L=mt(e.gesture,arguments,T))return L;if(qe("34.5"),n(t)||!t.on)return;n(r)&&(r=!0),n(i)&&(i=!0),n(o)&&(o=!0),n(_)&&(_=!1),n(p)&&(p=1),n(b)&&(b=!1),n(w)&&(w=5),n(C)&&(C=!1),n(O)&&(O=!0),n(P)&&(P=!1),P&&o&&(P=R=null,Ct&&ht("gesture() - does not support surround when rotate is true")),n(A)&&(A=!1),n(l)&&!n(R)&&(l=R);var S,E,k,X,q=v();if(n(t.zimMaskDynamic)||t.zimMaskApply(),!t.zimTouch){var V=new e.Damp(t.scaleX,.05),I=new e.Damp(t.scaleY,.05),te=t.scaleX/t.scaleY;if(t.zimTouch={move:r,scale:i,rotate:o,pointers:{},checkBounds:function(d,D){if(t.zimTouch.boundary){var K=t.zimTouch.boundary,m=t.parent.localToLocal(d,D,t.parent);P?(d=Math.min(K.x,Math.max(K.x+K.width,m.x)),D=Math.min(K.y,Math.max(K.y+K.height,m.y))):(d=Math.max(K.x,Math.min(K.x+K.width,m.x)),D=Math.max(K.y,Math.min(K.y+K.height,m.y))),m=t.parent.globalToLocal(d,D),d=m.x,D=m.y}return{x:d,y:D}}},l){t.zimTouch.boundary=l,_&&(t.zimTouch.boundary=e.boundsToGlobal(t.parent,l)),t.zimTouch.boundaryStartX=t.zimTouch.boundary.x,t.zimTouch.boundaryStartY=t.zimTouch.boundary.y,t.zimTouch.boundaryStartW=t.zimTouch.boundary.width,t.zimTouch.boundaryStartH=t.zimTouch.boundary.height;var B=t.zimTouch.checkBounds(t.x,t.y);t.x=B.x,t.y=B.y}b&&(k=10,X=5,E=0,S=[],t.zimTouch.slideInterval=e.interval(k/(q=="s"?1e3:1),function(){S[E++%X]=[t.x,t.y]}),t.zimTouch.slideInterval.pause(),t.animate({x:t.x,y:t.y},10/(q=="s"?1e3:1),"quadOut"));var Z,U,ee,ae,re,he,j,G;t.zimTouch.mousedown=t.on("mousedown",function(d){if(n(G)?G=1:G++,O){var D=t.parent.numChildren-1;t.parent.getChildAt(D).type=="Keyboard"&&D--,t.parent.setChildIndex(t,D),t.ZIMoutlineShape&&t.outline()}C||(j=null,U=t.scaleX,ee=t.scaleY,ae=t.rotation,re=t.regX,he=t.regY,t.reg(0,0),Z=t.getMatrix(),t.regX=re,t.regY=he);var K="id"+Math.abs(d.pointerID+1),m=t.parent.globalToLocal(d.stageX/e.scaX,d.stageY/e.scaY);t.zimTouch.pointers[K]={startX:m.x,startY:m.y,x:m.x,y:m.y},(t.zimTouch.move||t.zimTouch.rotate)&&(t.zimTouch.total=0,e.loop(t.zimTouch.pointers,function(){t.zimTouch.total++})),b&&t.zimTouch.total==1&&t.zimTouch.slideInterval.pause(!1),y()}),t.zimTouch.pressmove=t.on("pressmove",function(d){var D="id"+Math.abs(d.pointerID+1),K=t.parent.globalToLocal(d.stageX/e.scaX,d.stageY/e.scaY);t.zimTouch.pointers[D]&&(t.zimTouch.pointers[D].x=K.x,t.zimTouch.pointers[D].y=K.y);var m=0,F=0,Ce=0,Y=0,Q=0,ce=0;if(e.loop(t.zimTouch.pointers,function(ve,Me){m+=Me.x-Me.startX,F+=Me.y-Me.startY,Ce+=Me.x,Y+=Me.y}),t.zimTouch.total!=0){Q=m/t.zimTouch.total,ce=F/t.zimTouch.total,m=t.zimTouch.startX+Q,F=t.zimTouch.startY+ce,Ce=Ce/t.zimTouch.total,Y=Y/t.zimTouch.total;var pe={x:t.x,y:t.y,scaleX:t.scaleX,scaleY:t.scaleY,rotation:t.rotation};if(t.zimTouch.move){var J=t.zimTouch.checkBounds(m,F);pe.x=J.x,pe.y=J.y}if(t.zimTouch.pair.length==2){var ue=t.zimTouch.pair[0],ye=t.zimTouch.pair[1];if(t.zimTouch.scale){var Xe=Math.sqrt(Math.pow(ye.startX-ue.startX,2)+Math.pow(ye.startY-ue.startY,2)),se=Math.sqrt(Math.pow(ye.x-ue.x,2)+Math.pow(ye.y-ue.y,2)),Ae=t.zimTouch.startSX+(se/Xe-1),ie=t.zimTouch.startSY+(se/Xe-1);pe.scaleX=Ae,pe.scaleY=ie,pe.scaleX=V.convert(Ae),pe.scaleY=I.convert(ie);var _e=!n(f)&&Math.min(Ae,ie)<f,$=!n(h)&&Math.max(Ae,ie)>h;(_e||$)&&(_e?te>1?(pe.scaleY=f,pe.scaleX=f*te):(pe.scaleX=f,pe.scaleY=f/te):$&&(te>1?(pe.scaleX=h,pe.scaleY=h/te):(pe.scaleY=h,pe.scaleX=h*te)),V.immediate(pe.scaleX),I.immediate(pe.scaleY))}if(t.zimTouch.rotate){var xe=Math.atan2(ue.startY-ye.startY,ue.startX-ye.startX)*(180/Math.PI),Be=Math.atan2(ue.y-ye.y,ue.x-ye.x)*(180/Math.PI),me=Be-xe;pe.rotation=t.zimTouch.startR+me}if(C)t.scaleX=pe.scaleX,t.scaleY=pe.scaleY,t.rotation=pe.rotation,t.zimTouch.move&&(t.x=pe.x,t.y=pe.y);else{t.reg(0,0);var Oe=t.parent.localToGlobal(Ce,Y);Ce=Oe.x,Y=Oe.y;var Ye=n(j)?t.globalToLocal(Ce,Y):t.globalToLocal(j.x,j.y),de=Z.clone().translate(Ye.x,Ye.y).rotate(pe.rotation-ae).scale(pe.scaleX/U,pe.scaleY/ee).translate(-Ye.x,-Ye.y);de.decompose(t),t.zimTouch.move&&(t.x+=Q,t.y+=ce),j=t.localToGlobal(Ye.x,Ye.y),t.reg(re,he)}t.zimTouch.scale&&t.dispatchEvent("scale"),t.zimTouch.rotate&&t.dispatchEvent("rotate"),t.zimTouch.move&&t.dispatchEvent("move")}else t.x=pe.x,t.y=pe.y,t.zimTouch.move&&t.dispatchEvent("move");(t.type=="Tag"||t.type=="TextArea"||t.type=="Loader")&&t.resize(),t.ZIMoutlineShape&&t.outline(),t.getStage&&t.stage&&t.stage.update()}}),t.on("mousedown",function(){var d=1;t.stage.on("stagemousedown",function(){d++}),t.stage.on("stagemouseup",function(){d--,d==0&&setTimeout(function(){t.zimTouch&&(t.zimTouch.total=0),t.zimTouch&&(t.zimTouch.pointers={}),G=null},50)})},null,!0),t.zimTouch.pressup=t.on("pressup",function(d){var D="id"+Math.abs(d.pointerID+1);if(delete t.zimTouch.pointers[D],(t.zimTouch.move||t.zimTouch.rotate)&&t.zimTouch.total--,o&&!n(p)&&t.zimTouch.total==0&&(p>0?t.rotation=Math.round(t.rotation/p)*p:p==0&&(t.rotation=Math.round(t.rotation))),b&&t.zimTouch.total==0&&G==1){t.zimTouch.slideInterval.pause();var K=S[(E+1)%S.length],m=S[E%S.length],F=t.x+(K[0]-m[0])*w,Ce=t.y+(K[1]-m[1])*w,Y=t.zimTouch.checkBounds(F,Ce),Q=X*k*w*Math.min((t.x-Y.x)/(t.x-F)||1,(t.y-Y.y)/(t.y-Ce)||1);t.animate({x:Y.x,y:Y.y},Q/(q=="s"?1e3:1),"quadOut",function(){t.dispatchEvent("slidestop")})}t.zimTouch.total==0&&(G=null),t.getStage&&t.stage&&t.stage.update(),y()}),l&&(g(),t.on("move",g))}function y(){t.zimTouch.pair=[],e.loop(t.zimTouch.pointers,function(d,D,K){D.startX=D.x,D.startY=D.y,K<=1&&t.zimTouch.pair.push(D)}),t.zimTouch.startX=t.x,t.zimTouch.startY=t.y,t.zimTouch.startSX=t.scaleX,t.zimTouch.startSY=t.scaleY,t.zimTouch.startR=t.rotation}function g(){var d=t.localToGlobal(t.regX,t.regY),D;if(A){var K=t.parent.localToGlobal(t.x-t.width/2,t.y-t.height/2),m=t.parent.localToGlobal(t.x+t.width/2,t.y+t.height/2);D={x:K.x,y:K.y,width:m.x-K.x,height:m.y-K.y}}else D=t.boundsToGlobal();var F={x:t.zimTouch.boundaryStartX+d.x-D.x,y:t.zimTouch.boundaryStartY+d.y-D.y,width:t.zimTouch.boundaryStartW-D.width,height:t.zimTouch.boundaryStartH-D.height};t.gestureBoundary(F,!1)}return t},e.noGesture=function(t,r,i,o){var l="obj, move, scale, rotate",f;if(f=mt(e.noGesture,arguments,l))return f;if(qe("34.6"),!(n(t)||!t.on||!t.zimTouch))return n(r)&&(r=!0),n(i)&&(i=!0),n(o)&&(o=!0),t.zimTouch.move=!r,t.zimTouch.scale=!i,t.zimTouch.rotate=!o,!t.zimTouch.move&&!t.zimTouch.scale&&!t.zimTouch.rotate&&(t.off("mousedown",t.zimTouch.mousedown),t.off("pressmove",t.zimTouch.pressmove),t.off("pressup",t.zimTouch.pressup),delete t.zimTouch),t},e.gestureBoundary=function(t,r,i){if(qe("34.7"),!(n(t)||!t.on)&&!(n(r)||!t.zimTouch)){t.zimTouch.localBoundary&&t.parent?t.zimTouch.boundary=e.boundsToGlobal(t.parent,r):t.zimTouch.boundary=r,n(i)&&(i=!0),i&&(t.zimTouch.boundaryStartX=r.x,t.zimTouch.boundaryStartY=r.y,t.zimTouch.boundaryStartW=r.width,t.zimTouch.boundaryStartH=r.height);var o=t.zimTouch.checkBounds(t.x,t.y);return t.x=o.x,t.y=o.y,t}},e.effect=function(t,r,i,o,l,f){if(qe("33.16"),n(r))return t;n(t.effects)&&(t.effects={}),Array.isArray(r)||(r=[r]);for(var h=0,p=0;p<r.length;p++){var _=r[p];_.type||(_ instanceof $e.BlurFilter?_.type="BlurEffect":_ instanceof $e.ColorFilter?_.type="ColorEffect":_ instanceof $e.AlphaMaskFilter?_.type="AlphaEffect":_ instanceof $e.ColorMatrixFilter?_.type="MultiEffect":n(_.type)&&(_.type="custom"+h++));var b=_.type.replace(/effect/i,"");t.effects[b.toLowerCase()]=_}t.filters=[];for(var w in t.effects)t.filters.push(t.effects[w]);return t.cache(i,o,l,f),t},e.updateEffects=function(t,r){return qe("33.163"),t.updateCache&&(r?t.cache():t.updateCache()),t},e.noEffect=function(t,r,i){if(qe("33.165"),n(i)&&(i=!1),n(r)){var o;t.effects.multi&&(o=t.effects.multi),t.effects={},o&&(t.effects.multi=o)}else{t.effects||(t.effects={}),Array.isArray(r)||(r=[r]);for(var l=0;l<r.length;l++){var f=r[l].replace(/effect/i,"");delete t.effects[f.toLowerCase()]}}t.filters=[];for(var h in t.effects)t.filters.push(t.effects[h]);return i||t.filters.length>0?t.updateCache&&t.updateCache():t.uncache&&t.uncache(),t},e.addPhysics=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P){var A="obj, dynamic, contract, shape, friction, linear, angular, density, bounciness, maskBits, categoryBits, physics, restitution, sensor",R;if(R=mt(e.addPhysics,arguments,A))return R;if(qe("34.8"),n(C)){if(typeof zimPhysics>"u")return Ct&&ht("ZIM Physics module must be imported"),t;n(le.zimDefaultPhysics)&&(le.zimDefaultPhysics=new e.Physics),C=le.zimDefaultPhysics}t.physics=C;var T="rectangle";return t.type=="Circle"||t.type=="Dial"?T="circle":t.type=="Triangle"?T="triangle":t.type=="Blob"&&(T="poly"),n(o)&&(o=T),n(_)&&(_=O),ke(t,r,i,o,l,f,h,p,_,b,w,P),t},e.removePhysics=function(t){return qe("34.85"),n(t.physics)||(t==t.physics.followObj&&t.physics.follow(null),t.follow=t.noFollow=t.control=t.noControl=t.sleep=t.wake=null,t.impulse=t.force=t.spin=t.torque=null,t.physics.remove(t.body),t.physics=null),t},e.hitTestPoint=function(t,r,i,o){if(e.zimhtp||(qe("35"),e.zimhtp=!0),!t.stage||n(r)||n(i))return!1;if(!(n(t)||!t.globalToLocal)){if(n(o)&&(o=!0),o){var l=t.getBounds();if(l){var f=t.globalToLocal(r,i);if(f.x>l.x+l.width||f.x<l.x||f.y>l.y+l.height||f.y<l.y)return!1}}var h={x:r,y:i};return t.image||t.spriteSheet||t.type=="Shape"?h=t.globalToLocal(h.x,h.y):h=t.globalToLocal(h.x*e.scaX,h.y*e.scaY),t.hitTest(h.x,h.y)}},e.hitTestReg=function(t,r,i){if(e.zimhtr||(qe("36"),e.zimhtr=!0),!t.stage||!r.stage)return!1;if(!(n(t)||n(r)||!t.localToLocal||!r.localToLocal)){n(i)&&(i=!0);var o=r.localToGlobal(r.regX,r.regY),l=t.getBounds();if(i&&l){var f=t.globalToLocal(o.x,o.y);if(f.x>l.x+l.width||f.x<l.x||f.y>l.y+l.height||f.y<l.y)return!1}return t.image||t.spriteSheet||t.type=="Shape"?o=t.globalToLocal(o.x,o.y):o=t.globalToLocal(o.x*e.scaX,o.y*e.scaY),t.hitTest(o.x,o.y)}},e.hitTestRect=function(t,r,i,o,l){if(e.zimhtr||(qe("37"),e.zimhtr=!0),!t.stage||!r.stage)return!1;if(n(t)||n(r)||!t.hitTest||!r.getBounds)return;n(i)&&(i=0),n(o)&&(o=!0);var f=r.getBounds();if(!f){Ct&&ht("hitTestRect():\n please setBounds() on param b object");return}if(o){var h=t.getBounds();if(h&&!e.hitTestBounds(t,r))return!1}function p(A){if(t.image||t.spriteSheet||t.type=="Shape"?A=t.globalToLocal(A.x,A.y):A=t.globalToLocal(A.x*e.scaX,A.y*e.scaY),t.hitTest(A.x,A.y))return!0}var _=f.x+f.width/2,b=f.y+f.height/2,w=r.localToGlobal(_,b),C,O;if(l){if(!p(w))return!1;for(var P=0;P<=i;P++)if(C=f.width*(P+1)/(i+1),O=f.height*(P+1)/(i+1),w=r.localToGlobal(f.x+C,f.y),!p(w)||(w=r.localToGlobal(f.x+f.width,f.y+O),!p(w))||(w=r.localToGlobal(f.x+f.width-C,f.y+f.height),!p(w))||(w=r.localToGlobal(f.x,f.y+f.height-O),!p(w)))return!1;return!0}else{if(p(w))return!0;for(var P=0;P<=i;P++)if(C=f.width*(P+1)/(i+1),O=f.height*(P+1)/(i+1),w=r.localToGlobal(f.x+C,f.y),p(w)||(w=r.localToGlobal(f.x+f.width,f.y+O),p(w))||(w=r.localToGlobal(f.x+f.width-C,f.y+f.height),p(w))||(w=r.localToGlobal(f.x,f.y+f.height-O),p(w)))return!0}},e.hitTestCircle=function(t,r,i,o,l){if(e.zimhtc||(qe("38"),e.zimhtr=!0),qe("38"),!t.stage||!r.stage||n(t)||n(r)||!t.hitTest||!r.getBounds)return;n(i)&&(i=8),n(o)&&(o=!0);var f=r.getBounds();if(!f){Ct&&ht("hitTestCircle():\n please setBounds() on param b object");return}var h=t.getBounds();if(o&&h&&!e.hitTestBounds(t,r))return!1;function p(T){if(t.image||t.spriteSheet||t.type=="Shape"?T=t.globalToLocal(T.x,T.y):T=t.globalToLocal(T.x*e.scaX,T.y*e.scaY),t.hitTest(T.x,T.y))return!0}var _=f.x+f.width/2,b=f.y+f.height/2,w=r.localToGlobal(_,b),C=(f.width+f.height)/2/2,O,P,A;if(l){if(!p(w))return!1;for(var R=0;R<i;R++)if(O=R/i*2*Math.PI,P=_+C*Math.cos(O),A=b+C*Math.sin(O),w=r.localToGlobal(P,A),!p(w))return!1;return!0}else{if(p(w))return!0;for(var R=0;R<i;R++)if(O=R/i*2*Math.PI,P=_+C*Math.cos(O),A=b+C*Math.sin(O),w=r.localToGlobal(P,A),p(w))return!0}return!1},e.hitTestCircleRect=function(t,r,i){if(e.zimhtcr||(qe("38.2"),e.zimhtcr=!0),!(!t.stage||!r.stage)){var o=t.stage;if(!(n(t)||n(r)||!t.getBounds||!r.getBounds)){var l=t.getBounds(),f=r.getBounds();if(!l||!f){Ct&&ht("hitTestCircleRect():\n please setBounds() on both objects");return}n(i)&&(i=0);var h=(t.radius?t.radius:(l.width+l.height)/2)+i,p=t.getConcatenatedMatrix().decompose().scaleX;h*=p/o.scaleX;var _=r.boundsToGlobal(),b=t.localToGlobal(0,0),w=b.x,C=b.y,O=_.x,P=_.y,A=_.x+_.width,R=_.y+_.height,T=w<O?O:w>A?A:w,L=C<P?P:C>R?R:C,S=T-w,E=L-C;return S*S+E*E<=h*h}}},e.hitTestCircles=function(t,r,i){if(e.zimhtcs||(qe("38.5"),e.zimhtcs=!0),!(!t.stage||!r.stage)){var o=t.stage;if(!(n(t)||n(r)||!t.hitTest||!t.getBounds||!r.getBounds)){var l=t.getBounds(),f=r.getBounds();if(!l||!f){Ct&&ht("hitTestCircles():\n please setBounds() on both objects");return}n(i)&&(i=0);var h=t.localToGlobal(l.x+l.width/2,l.y+l.height/2),p=r.localToGlobal(f.x+f.width/2,f.y+f.height/2),_=t.getConcatenatedMatrix(),b=r.getConcatenatedMatrix(),w=Math.sqrt(_.a/o.scaleX*_.a/o.scaleX+_.c/o.scaleX*_.c/o.scaleX),C=Math.sqrt(_.b/o.scaleY*_.b/o.scaleY+_.d/o.scaleY*_.d/o.scaleY),O=Math.sqrt(b.a/o.scaleX*b.a/o.scaleX+b.c/o.scaleX*b.c/o.scaleX),P=Math.sqrt(b.b/o.scaleY*b.b/o.scaleY+b.d/o.scaleY*b.d/o.scaleY),A=Math.sqrt(Math.abs(Math.pow(h.x-p.x,2)+Math.pow(h.y-p.y,2)));return l.width*Math.max(w,C)/2+f.width*Math.max(O,P)/2>=A-i}}},e.hitTestBounds=function(t,r,i,o){if(e.zimhtb||(qe("39"),e.zimhtb=!0),!(!t.stage||!r.stage)&&!(n(t)||n(r)||!t.getBounds||!r.getBounds)){var l=!1;o&&o.graphics&&(l=!0);var f=t.getBounds(),h=r.getBounds();if(!f||!h){Ct&&ht("hitTestBounds():\n please setBounds() on both objects");return}n(i)&&(i=0);var p=e.boundsToGlobal(t),_=e.boundsToGlobal(r);if(l){var b=o.graphics;b.c(),b.ss(1).s("blue"),b.r(p.x,p.y,p.width,p.height),b.s("green"),b.r(_.x,_.y,_.width,_.height),o.stage.update()}return e.rectIntersect(p,_,i)}},e.hitTestPath=function(t,r,i,o,l,f){if(e.zimhtpa||(qe("37.5"),e.zimhtpa=!0),!t.stage||!r.stage||n(t)||n(r)||!t.hitTest||r.type!="Squiggle"&&r.type!="Blob")return;var h=t.getBounds();n(i)&&(i=2),n(o)&&(o=!1),n(l)&&(l=!1),n(f)&&(f=!1);var p=[],_;function b(A){var R;if(t.image||t.spriteSheet||t.type=="Shape"?R=t.globalToLocal(A.x,A.y):R=t.globalToLocal(A.x*e.scaX,A.y*e.scaY),t.hitTest(R.x,R.y))if(l)p.push({x:Math.round(A.x),y:Math.round(A.y)});else if(f)_=C/w.length*100;else return!0}var w=r.interpolate(i,null,!0,null,!0),C,O;if(o)for(r.hitPathPoints?r.hitPathPoints.removeAllChildren():r.hitPathPoints=new e.Container().addTo(),r.hitPathPoints.top(),C=0;C<w.length;C++)O=w[C],O=r.localToGlobal(O.x,O.y),new e.Circle(3).loc(O.x,O.y,r.hitPathPoints);if(h){var P=e.boundsAroundPoints(w);if(!e.rectIntersect(t.boundsToGlobal(h),r.boundsToGlobal(P)))return!1}for(C=0;C<w.length;C++){if(O=w[C],O=r.localToGlobal(O.x,O.y),b(O))return!0;if(_!=null)return _}return p.length>0?p:!1},e.hitTestGrid=function(t,r,i,o,l,f,h,p,_,b,w,C,O){if(e.zimhtg||(qe("41"),e.zimhtg=!0),!t.stage)return!1;if(!n(t)&&!C){var P=t.globalToLocal(f,h);f=P.x,h=P.y}n(p)&&(p=0),n(_)&&(_=0),n(b)&&(b=0),n(w)&&(w=0),r+=b,i+=w;var A=r/o,R=i/l,T=Math.min(o-1,Math.max(0,Math.floor((f-p+b/2)/A))),L=Math.min(l-1,Math.max(0,Math.floor((h-_+w/2)/R)));if(!(O!="open"&&(f-p>A*(T+1)-b||f-p<A*T||h-_>R*(L+1)-w||h-_<R*L))){var S=L*o+T;if(n(O)||O=="index")return S;if(O=="col")return T;if(O=="row")return L;if(O=="array"||O=="open")return[S,T,L]}},e.animate=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B,Z,U,ee,ae,re,he,j,G,y,g,d,D,K,m,F,Ce,Y,Q,ce,pe,J,ue,ye,Xe,se,Ae,ie,_e,$,xe,Be){var me="target, props, time, ease, call, params, wait, waitedCall, waitedParams, loop, loopCount, loopWait, loopCall, loopParams, loopWaitCall, loopWaitParams, loopPick, rewind, rewindWait, rewindCall, rewindParams, rewindWaitCall, rewindWaitParams, rewindTime, rewindEase, startCall, startParams, animateCall, animateParams, sequence, sequenceCall, sequenceParams, sequenceReverse, ticker, cjsProps, css, protect, override, from, set, id, events, sequenceTarget, dynamic, drag, clamp, startPaused, clean, obj, seriesWait, sequenceWait, rate, pauseOnBlur, easeAmount, easeFrequency, timeUnit, timeCheck, noAnimateCall";if(t&&(t.props||t.obj)){var Oe;if(Oe=mt(e.animate,arguments,me))return Oe}if(t.type=="AC"&&le.zdf)return le.zdf.ac("animate",arguments),t;if(e.animateCheck||(qe("45"),e.animateCheck=!0),!t)return;var Ye=e.ANIMATE;if(le.ANIMATE!=null&&(Ye=le.ANIMATE),!Ye)return n(Be)&&(Be=!0),l&&Be&&typeof l=="function"&&l(n(f)?t:f),t;n(xe)&&(xe=!0);var de=v(null,$,null,null,n(xe)?!1:!xe);(w||O||C)&&(b=!0),(V||E||V||I||S)&&(L=!0);var ve,Me,we,Fe=arguments,ge=Array.prototype.slice.call(arguments);if(n(r)&&!n(ue)&&(r=ue),ue=r,n(ue))return Ct&&ht("animate() - need props"),t;if(t.type=="BeadsContainer"&&n(ee)&&(ee=0),t.type=="Tone"&&(Ae=!1),Ae===!1?e.pauseAnimateOnBlur=!1:(Ae||n(Ae)&&e.pauseAnimateOnBlur!==!1)&&(n(e.blurCheck)&&e.setBlurDetect(),e.pauseAnimateOnBlur=!0),!(!n(ee)&&t.addChild)){i=e.Pick.choose(i),o=e.Pick.choose(o),h=e.Pick.choose(h),w=e.Pick.choose(w),C=e.Pick.choose(C),L=e.Pick.choose(L),S=e.Pick.choose(S),n(V)?V=i:V=e.Pick.choose(V),he=e.Pick.choose(he),D=e.Pick.choose(D),K=e.Pick.choose(K);var Ve=["loopCount","loopWait","rewind","rewindWait"];for(Me in G)Ve.indexOf(Me)>=0&&(G[Me]=e.Pick.choose(G[Me]))}var He={override:!n(t)&&!n(t.zimX)&&!n(ue.x)||!n(t)&&!n(t.zimY)&&!n(ue.y)};n(b)||(He.loop=b),n(w)||(He.count=w),n(C)||(He.loopWait=C),n(O)||(He.loopCall=O),n(R)||(He.loopWaitParams=R),n(A)||(He.loopWaitCall=A),n(P)||(He.loopParams=P),n(T)||(He.loopPick=T),n(L)||(He.rewind=L),n(S)||(He.rewindWait=S),n(E)||(He.rewindCall=E),n(k)||(He.rewindParams=k),n(X)||(He.rewindWaitCall=X),n(q)||(He.rewindWaitParams=q),n(te)||(He.startCall=te),n(B)||(He.startParams=B),n(Z)||(He.animateCall=Z),n(U)||(He.animateParams=U),n(r)||(He=e.merge(He,G)),G=He,e.loop(ue,function(Ne,gt){if(typeof Ne=="string"){var Tt=Ne.split(".");if(Tt.length>1&&Ne.substr(0,1)!="."&&(ue["."+Ne]=gt,delete ue[Ne],Ne="."+Ne),Tt.length>1&&typeof gt=="string"){var Et=gt.substr(0,1);Et!="+"&&Et!="-"&&(ue[Ne]="+"+gt)}}});function Le(Ne,gt){if(gt.substr(0,1)=="."){for(var Tt=gt.split("."),Et=Ne,Xt=1;Xt<Tt.length;Xt++)Et=Et[Tt[Xt]];return Et}else return gt=="transform"&&Ne.style?Ne.style.transform:Ne[gt]}function fe(Ne,gt,Tt){if(gt.substr(0,1)=="."){for(var Et=gt.split("."),Xt=Ne,Vt=1;Vt<Et.length-1;Vt++)Xt=Xt[Et[Vt]];Xt[Et[Et.length-1]]=Tt}else Ne[gt]=Tt}if(t.zimTweenOriginals={},!n(ee)&&t.addChild){var Ge=[];for(ve=0;ve<t.numChildren;ve++)Ge.push(t.getChildAt(ve));Ce=t,t=Ge}var Qe=["extra","zoom","speed","layer","fade"],Ke={zoom:t.type=="Pen"?"size":"scale",speed:"percentSpeed",layer:"layer",fade:"alpha"};if(t instanceof Array){for(he&&t.reverse(),ve=0;ve<t.length;ve++){var st=t[ve];if(D){var yt;st.zimObj={};for(Me in ue){if(Qe.indexOf(Me)>=0?yt=ue[Me]:yt=e.Pick.choose(ue[Me]),st.zimObj[Me]=st[Me],typeof yt=="string"&&Me!="transform"){var We;st.zimLastObj&&!n(st.zimLastObj[Me])?We=st.zimLastObj[Me]:We=st[Me],yt=We+Number(yt.replace(/\s/g,""))}st.zimLastObj&&(st.zimLastObj[Me]=L?st.zimTweenOriginals[Me]:ue[Me]),st[Me]=yt}}else{st.zimObj={};for(Me in ue)Qe.indexOf(Me)>=0,st.zimObj[Me]=ue[Me]}var at=ve*ee;ve==0&&ee!=0&&(at=de=="s"?.02:20),e.animate(st,st.zimObj,i,o,ve==t.length-1?l:null,ve==t.length-1?f:null,h,p,_,null,null,null,null,null,null,null,T,null,null,null,null,null,null,V,I,te,B,Z,U,null,ae,re,null,j,e.copy(G),y,g,d,null,K,m,F,Ce,Y,Q,ce,pe,J,ue,ye,at,se,Ae,ie,_e,$,xe,Be)}return Ce}var ct=i,Pe=V;n(ct)&&(ct=de=="s"?1:1e3),n(V)&&(V=Pe=ct),n(o)&&(o="quadInOut"),n(h)&&(h=0),n(S)&&(S=0),n(G)&&(G={override:!n(t.zimX)&&!n(ue.x)||!n(t.zimY)&&!n(ue.y)}),n(f)&&(f=t),n(j)&&(j=!0),n(y)&&(y=!1),n(g)&&(g=!1),n(D)&&(D=!1),n(K)&&(K={}),K.scale&&(K.scaleX=K.scaleY=K.scale,delete K.scale),n(d)||(G.override=d),n(Q)&&(Q=!1),n(pe)&&(pe=!!Q),n(Y)&&(Y=!1),n(ce)&&(ce=!0),n(J)&&(J=!0),n(se)&&(se=1),t.futureRate=se;var Ie,be,ze;if(ue instanceof Array){if(we=1,ue.length==0)return this;var it,je;return et(),en(),tt(),t}function tt(){t.zimLastObj&&e.loop(t.zimLastObj,function(bn){n(t.zimTweenOriginals[bn])||(t[bn]=t.zimTweenOriginals[bn],t.zimLastObj[bn]=t.zimTweenOriginals[bn])});for(var Ne,gt=h,Tt=0,Et,Xt,Vt=0;Vt<ue.length;Vt++)if(Ne=ue[Vt],!n(Ne.target)){n(Ne.time)&&(Ne.time=ct),gt+=Ne.wait?Ne.wait:0,Et=Ne.time,Xt=n(Ne.rewindTime)?Et:Ne.rewindTime,Ne.rewind&&(Et=Et+Xt+(Ne.rewindWait?Ne.rewindWait:0)),Ne.loop&&(Et*=Ne.loopCount,Et+=(Ne.loopCount-1)*(Ne.loopWait?Ne.loopWait:0)),n(Ne.params)&&(Ne.params=Ne.target),je=Ne.target,gt<0&&(Tt+=gt,gt=0);var vn={target:Ne.target,obj:e.copy(Ne.obj),seriesWait:Tt,wait:gt,waitedCall:Ne.waitedCall,waitedParams:Ne.waitedParams,time:Ne.time,ease:Ne.ease,from:Ne.from,rewind:Ne.rewind,call:Ne.call,params:Ne.params,loop:Ne.loop,loopCount:Ne.loopCount,loopWait:Ne.loopWait,loopCall:Ne.loopCall,loopParams:Ne.loopParams,loopWaitCall:Ne.loopWaitCall,loopWaitParams:Ne.loopWaitParams,loopPick:Ne.loopPick,rewindWait:Ne.rewindWait,rewindCall:Ne.rewindCall,rewindParams:Ne.rewindParams,rewindWaitCall:Ne.rewindWaitCall,rewindWaitParams:Ne.rewindWaitParams,rewindTime:Ne.rewindTime,rewindEase:Ne.rewindEase,startCall:Ne.startCall,startParams:Ne.startParams,animateCall:Ne.animateCall,animateParams:Ne.animateParams,set:e.copy(Ne.masterSet),events:F,rate:t.futureRate,pauseOnBlur:Ne.pauseOnBlur,easeAmount:Ne.easeAmount,easeFrequency:Ne.easeFrequency,override:!1,id:m};Vt==ue.length-1&&Te(vn),e.animate(vn),Tt+=gt+Et,gt=0}}function Te(Ne){var gt=Ne.call,Tt=Ne.params;G.loop&&(!G.count||we<G.count)?Ne.call=function(){gt&&typeof gt=="function"&&gt(Tt),G.loopCall&&typeof G.loopCall=="function"&&G.loopCall(G.loopParams),G.loopWait?(n(t.zimTweens)&&(t.zimTweens={}),Ie=t.zimTweens[m]=t.zimTween=$e.Tween.get(t,{override:G.override}).wait(G.loopWait,!0).call(Et),Ie.timeScale=t.futureRate):Et();function Et(){for(var Xt=0;Xt<it.objects.length;Xt++)it.objects[Xt].set&&it.objects[Xt].set(it.values[Xt]);G.loopWaitCall&&typeof G.loopWaitCall=="function"&&G.loopWaitCall(G.loopWaitParams),tt()}}:Ne.call=function(){gt&&typeof gt=="function"&&gt(Tt),n(f)&&(f=je),l&&typeof l=="function"&&l(f),t.zimLastObj=null},we++}function et(){t&&!t.seriesTweens&&(t.seriesTweens=[],t.seriesCalls=[],t.seriesParams=[]);for(var Ne,gt=0;gt<ue.length;gt++)Ne=ue[gt],Ne.target?(Ne.target.seriesTweens||(Ne.target.seriesTweens=[]),Ne.target.seriesCalls||(Ne.target.seriesCalls=[]),Ne.target.seriesParams||(Ne.target.seriesParams=[]),Ne.target.seriesTweens.push(Ne.props),Ne.target.seriesCalls.push(Ne.call),Ne.target.seriesParams.push(Ne.params)):(t.seriesTweens.push(Ne.props),t.seriesCalls.push(Ne.call),t.seriesParams.push(Ne.params));t.seriesCalls.push(l),t.seriesParams.push(f),Ne=ue[0];var Tt;for(t?Tt=t:Tt=Ne.target,Tt.zimSeriesOriginals={},gt=ue.length-1;gt>=0;gt--)Ne=ue[gt],n(Ne.props)&&!n(Ne.obj)&&(Ne.props=Ne.obj),Ne.obj=Ne.props,e.loop(Ne.obj,function(fr){fr=="path"?Tt.zimSeriesOriginals[fr]=ue[fr]:Tt.zimSeriesOriginals[fr]=Le(Tt,fr)});var Et=new e.Dictionary;for(it=new e.Dictionary,gt=0;gt<ue.length;gt++)if(Ne=ue[gt],t||(t=Ne.target),n(Ne.target)&&(Ne.target=t),n(Ne.ease)&&(Ne.ease=o),!n(Ne.target)){if(gt==0&&(Ne.target.zimSeriesArgs=Fe),n(Ne.props)&&!n(Ne.obj)&&(Ne.props=Ne.obj),Ne.obj=Ne.props,Ne.loop&&(n(Ne.loopCount)||Ne.loopCount<=0)&&(Ne.loopCount=0,ue.splice(gt+1,ue.length)),n(Ne.obj.scale)||(Ne.obj.scaleX=Ne.obj.scaleY=Ne.obj.scale,delete Ne.obj.scale),Ne.from){var Xt=Et.at(Ne.target);if(Xt){if(Ne.set){var Vt=e.copy(Ne.obj),vn=e.merge(Xt,Ne.set);Ne.obj=jt(Ne.target,Ne.obj,vn),Ne.set=e.merge(Ne.set,Vt)}else Ne.set=e.copy(Ne.obj),Ne.obj=jt(Ne.target,Ne.obj,Xt);Ne.from=!1}else Et.add(Ne.target,jt(Ne.target,Ne.obj,Ne.set))}var bn={};for(var Gn in Ne.obj)bn[Gn]=Ne.set&&Ne.set[Gn]?Ne.set[Gn]:Ne.target[Gn];n(it.at(Ne.target))&&it.add(Ne.target,{});var ir=e.merge(it.at(Ne.target),bn);it.remove(Ne.target),it.add(Ne.target,ir),Ne.masterSet=e.copy(Ne.set)}n(t.zimTweens)&&(t.zimTweens={})}if(ue&&(ue.x&&(t.zimX=!0),ue.y&&(t.zimY=!0)),!n(ue.shape)&&ue.shape.type==t.type&&(t.type=="Blob"||t.type=="Squiggle")){var Ue=t.pointObjects,Re=ue.shape.pointObjects;if(Ue.length!=Re.length)Ct&&ht("animate() - shapes must be of same number of points"),delete ue.shape;else{delete ue.shape;var Ze=n(ue.blobShift)?0:ue.blobShift;delete ue.blobShift;var Je=!0;for(ve=0;ve<Ue.length;ve++){var nt=Ue[ve],pt=Re[(Ue.length*2e4+ve+Ze)%Ue.length];for(Xn=0;Xn<4;Xn++)if(Xn!=1){var De=nt[Xn],lt=e.copy(ge);lt[0]=De,lt[1]={x:pt[Xn].x,y:pt[Xn].y,rotation:pt[Xn].rotation},Je&&(lt[37]=!0,De.animateEvent&&De.off("animation",De.animateEvent),De.animateEvent=De.on("animation",function(){t.update()})),Je=!1,e.animate.apply(e.animate,lt)}}if(e.isEmpty(ue))return t}}if(n(t))return;t.tweenStates||(t.tweenStates={all:!0});var vt=!1;if(ue.note){if(Array.isArray(ue.note))e.loop(ue.note,function(Ne,gt){typeof Ne=="string"&&(ue.note[gt]=e.Synth.note(Ne))});else if(ue.note.min)ue.note.min=e.Synth.note(ue.note.min),ue.note.max=e.Synth.note(ue.note.max);else if(ue.note.array)e.loop(ue.note.array,function(Ne,gt){typeof Ne=="string"&&(ue.note.array[gt]=e.Synth.note(Ne))});else if(typeof ue.note=="function"){if(Ct)return ht("animate() - use frequency in ZIM VEE functions not note"),t}else ue.note=e.Synth.note(ue.note);ue.frequency=ue.note,delete ue.note}function rt(Ne,gt){return!!Object.getOwnPropertyDescriptor(Ne,gt).get}(t.type=="Sprite"||!Object.prototype.hasOwnProperty.call(t,"paused"))&&(Object.defineProperty(t,"paused",{get:function(){return t.animatePaused},set:function(Ne){t.animatePaused=Ne}}),t.type!=null&&(t.paused=!0),t.animating=!1),t.endTween=function(Ne,gt){if(t.stopAnimate(gt),Ne!="all"&&Ne!="main"&&Ne!="none"&&(Ne="all"),!t.seriesTweens)e.loop(t.zimLastObj,function(Et){typeof t.zimLastObj[Et]=="string"&&Et!="transform"&&(t.zimLastObj[Et]=t[Et]+Number(t.zimLastObj[Et].replace(/\s/g,""))),fe(t,Et,t.zimLastObj[Et])}),Ne!="none"&&l&&l(f);else{if(e.loop(t.seriesTweens,function(Et,Xt){e.loop(Et,function(Vt){typeof Et[Vt]=="string"&&Vt!="transform"&&(Et[Vt]=t[Vt]+Number(Et[Vt].replace(/\s/g,""))),fe(t,Vt,Et[Vt])}),Ne=="all"&&t.seriesCalls[Xt]&&t.seriesCalls[Xt](t.seriesParams[Xt])}),Ne!="none"){var Tt=t.seriesCalls[t.seriesCalls.length-1];Tt&&Tt(t.seriesParams[t.seriesParams.length-1])}t.seriesTweens=null,t.seriesCalls=null,t.seriesParams=null}return t.stage&&t.stage.update(),t};var xt=!1;if(e.loop(ue,function(Ne,gt){Ne=="path"?t.zimTweenOriginals[Ne]=ue[Ne]:t.zimTweenOriginals[Ne]=Le(t,Ne),Ne.match("hue")?(ue.hueBatch=gt,delete ue.hue,xt=!0):Ne.match("saturation")?(ue.saturationBatch=gt,delete ue.saturation,xt=!0):Ne.match("brightness")?(ue.brightnessBatch=gt,delete ue.brightness,xt=!0):Ne.match("contrast")?(ue.contrastBatch=gt,delete ue.contrast,xt=!0):Ne.match(/^.effects/)&&(xt=!0)}),t.resetTween=function(Ne){n(Ne)&&(Ne=!0),t.pauseAnimate(),t.percent=null,t.startPercent=null;var gt=t.zimSeriesOriginals?t.zimSeriesOriginals:t.zimTweenOriginals;return e.loop(gt,function(Tt){if(Tt=="path"){t.percentComplete=0,t.zimPath=gt[Tt];var Et;t.zimStartPercent,Et=t.zimPath.getCurvePoint(t.zimStartPercent/100),t.loc(Et.x,Et.y)}else fe(t,Tt,gt[Tt])}),t.zimLastObj=null,t.stage&&t.stage.update(),t.stopAnimate(),t.zimPath&&(ge[1].path=t.zimPath),n(t.zimStartRotation)||(t.rotation=t.zimStartRotation),t.zimStartRotation=null,n(t.zimStartScaleX)||(t.scaleX=t.zimStartScaleX),t.zimStartScaleX=null,n(t.zimStartScaleY)||(t.scaleY=t.zimStartScaleY),t.zimStartScaleY=null,e.animate.apply(null,t.zimSeriesArgs?t.zimSeriesArgs:ge),t.pauseAnimate(Ne),t},t.replayTween=function(){return t.resetTween(!1),t},ue.path||Y){var wt;t.requestedPercentComplete?wt=t.requestedPercentComplete:t.percentComplete&&!rt(t,"percentComplete")&&(wt=t.percentComplete),t.requestedPercentComplete=null,n(wt)&&(wt=0),t.pathRatio=0,t.zimStartRotation=t.rotation,t.percent=null,t.parent&&t.parent.type=="BeadsContainer"||(t.startPercent=null)}y&&(j=!1),n(t.zimTweens)&&(t.zimTweens={});var _t;if(y||(t.stage?_t=t.stage:le.zdf?_t=le.zdf.stage:y=!0),t.setColorRange&&!n(ue.color)){var ft=ue.color;delete ue.color,ue.colorRange=1,t.setColorRange(t.color,ft),t.colorRange=0}else if(ue.color&&(t.material||t.isMaterial)){if(t.isMaterial)return ht("ZIM animate - please animate the color on the mesh not the material"),t;var Ot=t;Ot.cT&&e.Ticker.remove(Ot.cT),t={val:0,zimTweens:{},ticker:Ot.cT};var Rt=Ot.material.color.getHexString(),St=ue.color;if(ue={val:1},Ot.cT=e.Ticker.add(function(){var Ne=e.colorRange("#"+Rt,St,t.val);Ot.material.color.set(Ne)}),l){var Gt=l;l=function(){Ot.cT==t.ticker&&(Gt(callParams||Ot),e.Ticker.remove(Ot.cT),Ot.cT=null,t=null)}}else l=function(){Ot.cT==t.ticker&&(e.Ticker.remove(Ot.cT),Ot.cT=null,t=null)}}var Yt={};for(ve in ue)Qe.indexOf(ve)>=0||(Yt[ve]=e.copy(ue[ve]),ue[ve]=e.Pick.choose(ue[ve]));n(ue.scale)||(ue.scaleX=ue.scaleY=e.Pick.choose(ue.scale),delete ue.scale);for(var $t in ue){if(!t.zimBusy)break;t.zimBusy[$t]&&delete ue[$t]}if(e.isEmpty(ue))return;t.type!="Sprite"&&(t.type!=null&&(t.paused=!1),t.animating=!0);function sn(){t.zimMouseEnabledCheck||(t.zimMouseEnabledCheck=!0,t.zimLastMouseEnabled=t.mouseEnabled),t.mouseEnabled=!1,setTimeout(function(){t.zimBusy||(t.zimBusy={});for(var Ne in ue)t.zimBusy[Ne]=!0;t.zimMouseEnabledCheck=null,t.mouseEnabled=t.zimLastMouseEnabled},70)}(g||G.loop||G.rewind)&&sn(),en();function en(){n(m)?m=e.makeID(null,10):(m=String(m),ze=m),n(t.zimIdSets)&&(t.zimIdSets={}),n(t.zimIdSets[m])?t.zimTweens&&!n(t.zimTweens[m])&&(be=m,m=e.makeID(null,10),t.zimIdSets[be]=[be],t.zimTweens[be].zimIdSet=be,t.zimIdSets[be].push(m)):(be=m,m=e.makeID(null,10),t.zimIdSets[be].push(m))}Qe.shift();for(ve in K)K[ve]=e.Pick.choose(K[ve]);for(ve in G)ve=="waitedCall"||ve=="waitedParams"||ve=="loopCall"||ve=="rewindCall"||ve=="loopWaitCall"||ve=="rewindWaitCall"||ve=="startCall"||ve=="animateCall"||(G[ve]=e.Pick.choose(G[ve]));Lt();function Lt(){ot(),bt(),t.seriesTweens&&(t.seriesTweens[0]=ue),D&&!vt&&(ue=jt(t,ue,K,!0))}function Zt(){ot(),D&&!vt&&(ue=jt(t,ue,K,!0))}function ot(){var Ne;t.zimLastObj||(t.zimLastObj={});for(ve in ue){if(typeof ue[ve]=="string"&&ve!="transform"){if(ve.substring&&ve.substring(0,1)=="."){if(ue[ve].substr(0,1)=="+"||ue[ve].substr(0,1)=="-")continue}else if(ue[ve].substr(0,1)=="+")continue;if(ue[ve].substr(0,3)=="rgb")continue;t.zimLastObj&&!n(t.zimLastObj[ve])?Ne=t.zimLastObj[ve]:Ne=t[ve],ue[ve]=Ne+Number(ue[ve].replace(/\s/g,""))}t.zimLastObj[ve]=L?t.zimTweenOriginals[ve]:ue[ve]}}function bt(){var Ne;for(ve in K){if(typeof K[ve]=="string"&&ve!="transform"){if(ve.substring&&ve.substring(0,1)=="."){if(K[ve].substr(0,1)=="+"||K[ve].substr(0,1)=="-")continue}else if(K[ve].substr(0,1)=="+")continue;if(K[ve].substr(0,3)=="rgb")continue;t.zimLastObj&&!n(t.zimLastObj[ve])?Ne=t.zimLastObj[ve]:Ne=t[ve],K[ve]=Ne+Number(K[ve].replace(/\s/g,""))}t.zimLastObj[ve]=L?t.zimTweenOriginals[ve]:ue[ve]}}t.getBounds&&n(t.percentCompleteCheck)&&(t.percentCompleteCheck=!0,t._percentComplete=0,Object.defineProperty(t,"percentComplete",{get:function(){if(t.paused)return t._percentComplete;if(t.tweenStartTime&&t.tweenEndTime){var Ne=Date.now(),gt;return G.loop&&Ne>t.tweenEndTime?gt=(Ne-t.tweenStartTime)%(t.tweenEndTime-t.tweenStartTime):gt=Ne-t.tweenStartTime,Math.max(0,Math.min(100,gt/(t.tweenEndTime-t.tweenStartTime)*100))}else return 0},set:function(Ne){this.zimTween?(un=!0,Bt(Ne,!0)):this.requestedPercentComplete=Ne,t._percentComplete=Ne}}),Object.defineProperty(t,"percentCompleteNoAngle",{get:function(){if(t.tweenStartTime&&t.tweenEndTime){var Ne=Date.now(),gt;return G.loop&&Ne>t.tweenEndTime?gt=(Ne-t.tweenStartTime)%(t.tweenEndTime-t.tweenStartTime):gt=Ne-t.tweenStartTime,Math.max(0,Math.min(100,gt/(t.tweenEndTime-t.tweenStartTime)*100))}else return 0},set:function(Ne){this.zimTween?Bt(Ne,!1):this.requestedPercentComplete=Ne,t._percentComplete=Ne}})),Object.defineProperty(t,"rate",{get:function(){return t.futureRate},set:function(Ne){t.futureRate=Ne,e.loop(t.zimTweens,function(gt,Tt){Tt.timeScale=Ne})},configurable:!0});function Bt(Ne,gt){t.zimTween.startPaused=!1,Y?n(t.zimTween.currentTime)||(t.zimTween.currentTime=t.zimTween.currentTime-t.zimTween.position+Ne*t.zimTween.duration/100):t.zimTweens?e.loop(t.zimTweens,function(Tt,Et,Xt){var Vt=t.tweenStartTime+(t.tweenEndTime-t.tweenStartTime)*Ne/100,vn;Et.zimLoop&&Vt<=Et.startTime?vn=0:Et.zimLoop&&Vt>Et.startTime+Et.duration?vn=(Vt-Et.startTime)%Et.duration:vn=Vt-Et.startTime,Et.percentComplete=Math.max(0,Math.min(100,vn/Et.duration*100))}):t.zimTween.setPosition(Math.round(Ne*t.zimTween.duration/100)),gt&&It&&ue.orient!==!1&&It.getCurvePoint&&(t.rotation=It.getCurvePoint(t.pathRatio,null,null,!0).angle+(En||0)),un&&typeof At<"u"&&(At=Ne),t.handlePath&&t.handlePath()}var It,Ut,kt,Nt;if(!n(ue.path)&&ue.path.segmentPoints){n(ue.orient)&&(ue.orient=!0),ue.orient&&n(ue.flip)&&(ue.flip=!0),t.type=="Pen"&&(t.infinite=!0),t.zimOnPath=!0,n(t.pathRatio)&&(t.pathRatio=0),ue.orient&&(ue.orient=ue.path,ue.startOrient=ue.rotation),It=ue.path,Q?(delete ue.path,delete ue.percent,(Ct&&t.startPercent&&t.startPercent>0||t.percent&&t.percent!=100)&&ht("ZIM.animate() - startPercent and percent currently not supported with drag on path"),Ut=It.getCurvePoint(t.pathRatio,Pt,Nt),Ut&&(kt=t.parent.globalToLocal(Ut.x,Ut.y),t.x=kt.x,t.y=kt.y)):(n(t.startPercent)&&(t.startPercent=e.Pick.choose(n(ue.startPercent)?0:ue.startPercent)),n(t.percent)&&(t.percent=e.Pick.choose(n(ue.percent)?100:ue.percent)),delete ue.path,delete ue.percent);var Wt=!It.lockControls;delete ue.path,ue.pathRatio=1}function jt(Ne,gt,Tt,Et){vt=!0,It&&(!n(Ne.percentComplete)||Tt&&!n(Tt.percentComplete))&&(Tt||(Tt={}),n(Tt.pathRatio)&&(Tt.pathRatio=n(Tt.percentComplete)?Ne.percentComplete/100:Tt.percentComplete/100));var Xt={};for(ve in gt)Tt&&!n(Tt[ve])?Xt[ve]=Tt[ve]:Xt[ve]=Ne[ve],Et&&(Ne[ve]=gt[ve]);return Xt}var rn=!0,Kt=!1,ln=!0,tn=!0;n(ue.redirect)||(tn=ue.redirect,delete ue.redirect);function xn(Ne){var gt=It.globalToLocal(Ne.rawX/e.scaX,Ne.rawY/e.scaY),Tt=nn;It.type=="Blob"&&(An[0]<An[4]?zt=!0:An[0]>An[4]&&(zt=!1),Tt<10&&!zt?(kn=nn=Tt=Ft-5,Jn.immediate(kn/Ft*100),An=[Ft-1,Ft-2,Ft,Ft-3,Ft-4]):Tt>Ft-10&&zt&&(kn=nn=Tt=5,Jn.immediate(kn/Ft*100),An=[0,0,0,0,0]));var Et={x:gt.x,y:gt.y,r:Tt};gn.sort(function(Xt,Vt){var vn={x:Xt.x,y:Xt.y,r:Xt.r*Ft},bn={x:Vt.x,y:Vt.y,r:Vt.r*Ft},Gn=Math.sqrt(Math.pow(Et.x-vn.x,2)+Math.pow(Et.y-vn.y,2)+Math.pow(Et.r-vn.r,2)),ir=Math.sqrt(Math.pow(Et.x-bn.x,2)+Math.pow(Et.y-bn.y,2)+Math.pow(Et.r-bn.r,2));return Gn-ir}),kn=gn[0].r*Ft,At=kn/Ft*100,At=e.constrain(At,0,99.95),L&&(At/=2,Ie.position>Ie.duration/2&&(At=100-At))}if(It){var Pt;Wt||(Nt=e.copy(It.segmentPoints),Pt=e.copy(It.segmentRatios)),t.currentPercent=t.startPercent+t.percent*t.pathRatio;var ut=(1e6+t.currentPercent)%100/100;if(Ut=It.getCurvePoint(ut,Pt,Nt),t.parent&&Ut&&(kt=t.parent.globalToLocal(Ut.x,Ut.y),t.x=kt.x,t.y=kt.y),Q){o="linear",t.cur("pointer");var At=t.percentComplete,Ht=!1,Jt=!0,zt=!0,Qt=At,Mt=10;Nt=e.copy(It.segmentPoints);var Ft=0;e.loop(Nt,function(Ne){Ft+=e.distanceAlongCurve(Ne)});var yn=Math.round(Ft/Nt.length/Mt),gn=It.interpolate(yn,null,!0,null,!0),nn=(At||0)/100*Ft,kn=nn;It.zimAnimateChanged=!1,t.zimAnimatePathChange=It.on("change",function(){It.zimAnimateChanged=!0}),t.zimAnimatePathDown=It.on("mousedown",function(){Ht=!0,t.paused==!0&&(Kt=!0)}),t.zimAnimatePathUp=It.on("pressup",function(){Kt=!1}),t.zimAnimateDragDown=t.on("mousedown",function(Ne){_t=Ne.target.stage,t.amu||(t.amu=_t.frame.on("mouseupplus",function(){Kt=!1})),_t.mouseMoveOutside=!0,rn=!1,ln=!0,setTimeout(function(){rn=!0},50),Kt=!0,It.zimAnimateChanged&&(Nt=e.copy(It.segmentPoints),Ft=0,e.loop(Nt,function(Tt){Ft+=e.distanceAlongCurve(Tt)}),yn=Math.round(Ft/Nt.length/Mt),gn=It.interpolate(yn,null,!0,null,!0)),It.zimAnimateChanged=!1,At=t.percentComplete,Jn.immediate(At);var gt=At;L&&(Ie.position>Ie.duration/2?gt=(100-At)*2:gt=At*2),nn=(gt||0)/100*Ft,kn=nn});var ar=!1;t.zimAnimateDragPress=t.on("pressmove",function(Ne){ar=!0,xn(Ne)}),t.animateReturn=function(){if(!L){Ct&&ht("animate() - animateReturn() needs rewind set to true");return}Jt=!1,zt=!1,t.percentComplete<50&&(t.percentComplete=100-t.percentComplete),t.pauseAnimate(!1)},t.zimAnimateDragUp=t.on("pressup",function(){t.paused==!1&&(Kt=!1),rn=!1,setTimeout(function(){rn=!0},50),An[0]<An[4]?zt=!0:An[0]>An[4]&&(zt=!1),!t.paused&&L&&tn&&zt!=Jt&&(t.percentComplete=100-t.percentComplete,Jt=zt)});var Jn=new e.Damp(At,.15),tr=0,pr=0,An=[0,0,0,0,0],un=!1;t.zimDragAnimateTicker=e.Ticker.add(function(){var Ne;Q&&(++pr%20&&(An.push(kn),An.shift()),nn=kn,Ht&&(At=t.percentComplete),Kt||ln&&t.paused==!0?(Ht||un||It.type=="Blob"&&Math.abs(tr-At)>(L?45:90)?(Ht=!1,Ne=At,Jn.immediate(Ne),un=!1):Ne=Jn.convert(At),Math.abs(tr-Ne)>.1?(t.percentCompleteNoAngle=Ne,tr=Ne):(t.percentCompleteNoAngle=Ne,ln=!1,ar=!1)):ln=!1)},_t)}}var an;if(ue.orient){if(ue.orient===!0){var or=t.parent.localToGlobal(n(ue.x)?t.x:ue.x,n(ue.y)?t.y:ue.y);ue.orient={x:or.x,y:or.y}}an=ue.orient,delete ue.orient;var En=t.rotation;if(t.rotation=It.getPointAngle(0)+En,an!=It){var on;an.parent?on=an.parent.localToLocal(an.x,an.y,t.parent):on=t.parent.globalToLocal(an.x,an.y),t.rotation=e.angle(t.x,t.y,on.x,on.y)+En}}var nr=t.scaleX,qn=t.scaleY,Bn=ue.flip!=null?ue.flip:!1,Un=ue.flipVertical!=null?ue.flipVertical:!1,Nn=t.x,Sn=t.y,In=0;G.loop&&(n(G.count)||(In=G.count,delete G.count,we=1));var qt=0;G.loopWait&&(qt=G.loopWait,C=G.loopWait,delete G.loopWait);var cn;G.loopCall&&(cn=G.loopCall,delete G.loopCall);var fn=t;G.loopParams&&(fn=G.loopParams,delete G.loopParams),le.TIMECHECK&&xe&&(ct&&a(ct,de),Pe&&a(Pe,de),h&&a(h,de),Vn&&a(Vn,de),qt&&a(qt,de),C&&a(C,de),G.rewindWait&&a(G.rewindWait,de),ye&&a(ye,de),Xe&&a(Xe,de)),de=="s"&&(ct&&(ct*=1e3),Pe&&(Pe*=1e3),h&&(h*=1e3),Vn&&(Vn*=1e3),qt&&(qt*=1e3),C&&(C*=1e3),G.rewindWait&&(G.rewindWait*=1e3),ye&&(ye*=1e3),Xe&&(Xe*=1e3));var wn=ct;G.rewind&&(wn+=Pe),t.zimTweenArgs={time:wn,wait:h,wait2:Vn,wait3:qt,loopWait:C,rewindWait:G.rewindWait,seriesWait:ye,sequenceWait:Xe};function Ln(){if(qt>0&&(t.waiting=!1),!!G.loop){if(ae&&typeof ae=="function"){var Ne=n(re)?t:re;ae(Ne)}if(cn&&typeof cn=="function"&&cn(fn||t),T){var gt=e.Pick.choose(t.futureRate);n(t.futureRate)||(Ie.timeScale=gt);var Tt;if(n(Yt.scale)||(Tt=e.Pick.choose(Yt.scale)),!D&&Ie.step&&Ie.step.prev&&Ie.step.prev.props){for(var Et in Ie.step.prev.props)if(!(Qe.indexOf(Et)>=0)){var Xt=e.Pick.choose(Yt[Et]);if(typeof Xt=="string"&&Et!="transform"&&Xt.substr(0,1)!="+"&&Xt.substr(0,1)!="-"){var Vt;t.zimLastObj&&!n(t.zimLastObj[Et])?Vt=t.zimLastObj[Et]:Vt=t[Et],Xt=Vt+Number(Xt.replace(/\s/g,""))}t.zimLastObj[Et]=L?t.zimTweenOriginals[Et]:Xt,L?(n(Yt[Et])||(Ie.step.prev.props[Et]=Xt),Et=="scaleX"&&!n(Tt)&&(Ie.step.prev.props.scaleX=Tt),Et=="scaleY"&&!n(Tt)&&(Ie.step.prev.props.scaleY=Tt)):(n(Yt[Et])||(Ie.step.props[Et]=Xt),Et=="scaleX"&&!n(Tt)&&(Ie.step.props.scaleX=Tt),Et=="scaleY"&&!n(Tt)&&(Ie.step.props.scaleY=Tt))}}}}}var Tn;G.loopWaitCall&&(Tn=G.loopWaitCall,delete G.loopWaitCall);var $n=t;G.loopWaitParams&&($n=G.loopWaitParams,delete G.loopWaitParams);function Yn(){Tn&&typeof Tn=="function"&&Tn($n||t)}var Fn;G.startCall&&(Fn=G.startCall,delete G.startCall);var gr;G.startParams&&(gr=G.startParams,delete G.startParams);function vr(Ne){Ne.startCalled||(Ne.startCalled=!0,Fn&&typeof Fn=="function"&&Fn(gr||t))}function Qn(Ne){t.latestTween=Ne,t.waiting?Ne.startTime=Date.now():Ne.startTime=yr,Ne.zimLoop=b,t.animating||t.pauseAnimate(!0),n(Ne.percentComplete)&&Object.defineProperty(Ne,"percentComplete",{get:function(){return this.position/this.duration*100},set:function(gt){this.setPosition(gt*this.duration/100)}})}var lr=Date.now();t.tweenStartTime||(t.tweenStartTime=lr),t.tweenEndTime||(t.tweenEndTime=lr);var yr=lr+(h||0)+(ye||0),mr=yr+(wn||0);mr>t.tweenEndTime&&(t.tweenEndTime=mr);var xr=["ballisticIn","ballisticOut","ballisticInOut","snapIn","snapOut","snapInOut","slowmoIn","slowmoOut","slowmoInOut"];xr.indexOf(o)!=-1&&(o=wr(o));function wr(Ne){var gt=[.4,.75,.9,.95],Tt=[.99,-.69,.53,.014],Et=[1.18,.69,1,.96];return Ne=="ballisticIn"?Ne=dt(e.zimEase(gt)):Ne=="ballisticOut"?Ne=dt(e.zimEase(gt).reverse()):Ne=="ballisticInOut"?Ne=dt(e.zimEase(gt,null,!0)):Ne=="snapIn"?Ne=dt(e.zimEase(Tt)):Ne=="snapOut"?Ne=dt(e.zimEase(Tt).reverse()):Ne=="snapInOut"?Ne=dt(e.zimEase(Tt,null,!0)):Ne=="slowmoIn"?Ne=dt(e.zimEase(Et)):Ne=="slowmoOut"?Ne=dt(e.zimEase(Et).reverse()):Ne=="slowmoInOut"&&(Ne=dt(e.zimEase(Et,null,!0))),Ne}var mn,jn,zn;if(G.rewind&&(o&&(o instanceof Function?mn=dt(o.reverse()):(mn=o,mn.indexOf("InOut")==-1&&(mn.indexOf("Out")!=-1?mn=mn.replace("Out","In"):mn.indexOf("In")!=-1&&(mn=mn.replace("In","Out"))))),I&&(mn=I,xr.indexOf(mn)!=-1&&(mn=wr(mn)))),o instanceof Function)jn=o;else{var Cn="get"+o.charAt(0).toUpperCase()+o.slice(1),Mn=dt(ie),Pn=dt(_e);(!n(Mn)||!n(Pn))&&$e.Ease[Cn]?(!n(Pn)&&n(Mn)&&(Mn=1),!n(Mn)&&n(Pn)&&(Pn=.3*1.5),jn=$e.Ease[Cn](Mn,Pn)):jn=$e.Ease[o]}mn&&(mn instanceof Function?zn=mn:(Cn="get"+mn.charAt(0).toUpperCase()+mn.slice(1),Mn=dt(ie),Pn=dt(_e),(!n(Mn)||!n(Pn))&&$e.Ease[Cn]?(!n(Pn)&&n(Mn)&&(Mn=1),!n(Mn)&&n(Pn)&&(Pn=.3*1.5),zn=$e.Ease[Cn](Mn,Pn)):zn=$e.Ease[mn]));function ci(){Vn>0&&(t.waiting=!1),_r&&typeof _r=="function"&&_r(Mr)}function hi(){Vn>0&&(t.waiting=!0),Tr&&typeof Tr=="function"&&Tr(Or)}function Gr(Ne){Zt(),h>0?(t.waiting=!0,Ie=t.zimTweens[m]=t.zimTween=$e.Tween.get(t,{override:G.override}).wait(h,!0).call(function(){t.waiting=!1,h=0,Sr(Ie),p&&typeof p=="function"&&p(n(_)?t:_)}),Ie.timeScale=t.futureRate,Ne&&Cr(Ne,Ie),Qn(Ie)):Sr(Ne)}function Sr(Ne){var gt=Hr();t.set&&!D&&t.set(K),Ie=t.zimTweens[m]=t.zimTween=$e.Tween.get(t,G).call(vr).to(ue,ct,jn).call(hi).wait(Vn,!0).call(ci).to(gt,Pe,zn).call(Vr).wait(qt,!0).call(Ln),Ie.timeScale=t.futureRate,Ne&&Cr(Ne,Ie),Dr(),Qn(Ie)}function Ur(Ne){Zt(),h>0?(t.waiting=!0,Ie=t.zimTweens[m]=t.zimTween=$e.Tween.get(t,{override:G.override}).wait(h,!0).call(function(){h=0,t.waiting=!1,Ir(Ie),p&&typeof p=="function"&&p(n(_)?t:_)}),Ie.timeScale=t.futureRate,Ne&&Cr(Ne,Ie),Qn(Ie)):Ir(Ne)}function Ir(Ne){t.set&&!D&&t.set(K),Ie=t.zimTweens[m]=t.zimTween=$e.Tween.get(t,G).call(vr).to(ue,ct,jn).call(Vr).wait(qt,!0).call(Ln),Ie.timeScale=t.futureRate,Ne&&Cr(Ne,Ie),Dr(),Qn(Ie)}if(G.rewind){var Vn=0;delete G.rewind,L=!0,S=G.rewindWait,G.rewindWait&&(Vn=G.rewindWait,delete G.rewindWait);var _r;if(G.rewindCall){_r=G.rewindCall;var Mr=G.rewindParams;n(Mr)&&(Mr=t),delete G.rewindCall,delete G.rewindParams}var Tr;if(G.rewindWaitCall){Tr=G.rewindWaitCall;var Or=G.rewindWaitParams;n(Or)&&(Or=t),delete G.rewindWaitCall,delete G.rewindWaitParams}ye>0||Xe>0||h>0?ye>0||Xe>0?(t.waiting=!0,Ie=t.zimTweens[m]=t.zimTween=$e.Tween.get(t,{override:G.override}).wait(ye>0?ye:0,!0).wait(Xe>0?Xe:0,!0).call(function(Ne){Ne.waiting=!1,Xe=ye=0,Gr(Ie)}),Ie.timeScale=t.futureRate,Qn(Ie)):Gr():(Zt(),Sr())}else ye>0||Xe>0||h>0?ye>0||Xe>0?(t.waiting=!0,Ie=t.zimTweens[m]=t.zimTween=$e.Tween.get(t,{override:G.override}).wait(ye>0?ye:0,!0).wait(Xe>0?Xe:0,!0).call(function(){Xe=ye=0,t.waiting=!1,Ur(Ie)}),Ie.timeScale=t.futureRate,Qn(Ie)):Ur():(Zt(),Ir());function Cr(Ne,gt){gt.zimIdSet=Ne.zimIdSet,gt.zimObj=Ne.zimObj,gt.zimTicker=Ne.zimTicker,gt.zimExtraTickers=Ne.zimExtraTickers,gt.requestID=Ne.requestID}Ie.startPaused=pe,Ie.rewinding=!1,n(se)||(Ie.timeScale=e.Pick.choose(se)),G.animateCall&&(Z=G.animateCall,delete G.animateCall),G.animateParams&&(U=G.animateParams,delete G.animateParams);var ur;!y&&j&&(wt&&(t.pathRatio=t.percentComplete&&Math.round(t.percentComplete)!=100?t.percentComplete/100:0,t.percentCompleteNoAngle=Math.round(wt)!=100?wt:0),F&&!n(Ce)&&Ce.dispatchEvent?ur=e.Ticker.add(function(){xt&&t.updateEffects(),(It||an||Bn||Un)&&rr(),Ce.dispatchEvent("animation")},_t):F&&t.dispatchEvent?ur=e.Ticker.add(function(){xt&&t.updateEffects(),(It||an||Bn||Un)&&rr(),t.dispatchEvent("animation")},_t):Z&&typeof Z=="function"?ur=e.Ticker.add(function(){xt&&t.updateEffects(),(It||an||Bn||Un)&&rr(),Z(U||t)},_t):ur=e.Ticker.add(function(){xt&&t.updateEffects(),(It||an||Bn||Un)&&rr()},_t));function di(Ne){if(Array.isArray(Ne)){for(var gt=0,Tt=0,Et=Ne.length;Tt<Et;Tt++)gt+=Ne[Tt];return gt}}var Lr=[1,1,1],rr=function(){if(!(!t.parent||Ie.passive||Ie.startPaused)){if(Q&&L&&(Qt<50&&t.percentComplete>50||Qt>50&&t.percentComplete<50)&&(Jt=t.percentComplete<50),Qt=t.percentComplete,It){if(Wt&&(Nt=It.segmentPoints,Pt=It.segmentRatios),Q)var Ne=It.getCurvePoint(t.pathRatio,Pt,Nt);else{t.currentPercent=t.startPercent+t.percent*t.pathRatio;var gt=(1e6+t.currentPercent)%100/100;t.pathRatio==1&&(gt+=t.percent>0?1:0),Ne=It.getCurvePoint(gt,Pt,Nt)}if(Ne){var Tt=t.parent.globalToLocal(Ne.x,Ne.y);t.x=Tt.x,t.y=Tt.y}}var Et=Math.abs(Nn-t.x),Xt=Math.abs(Sn-t.y),Vt=En==90||En==270||En==-90;Bn&&rn&&(Nn>t.x&&Et>.01&&e.sign(Vt?t.scaleY:t.scaleX)==e.sign(nr)||Nn<t.x&&Et>.01&&e.sign(Vt?t.scaleY:t.scaleX)!=e.sign(nr)||t.percentComplete<99&&t.percentComplete>1&&Et<.01&&Xt>.01&&e.sign(Vt?t.scaleY:t.scaleX)!=e.sign(nr))&&(Vt?t.scaleY*=-1:t.scaleX*=-1),Un&&rn&&(Sn>t.y&&Xt>.01&&e.sign(Vt?t.scaleX:t.scaleY)==e.sign(qn)||Sn<t.y&&Xt>.01&&e.sign(Vt?t.scaleX:t.scaleY)!=e.sign(qn)||t.percentComplete<99&&t.percentComplete>1&&Xt<.01&&Et>.01&&e.sign(Vt?t.scaleX:t.scaleY)!=e.sign(qn))&&(Vt?t.scaleX*=-1:t.scaleY*=-1);var vn;if(an&&Et>.05||an&&Xt>.05){if(It==an)vn=e.angle(Nn,Sn,t.x,t.y)+En;else{var bn;an.parent?bn=an.parent.localToLocal(an.x,an.y,t.parent):bn=t.parent.globalToLocal(an.x,an.y),vn=e.angle(t.x,t.y,bn.x,bn.y)+En}if(vn!=0&&(!t.paused||ar)){Bn&&Nn-t.x>.01&&(vn+=180);var Gn=vn;t.rotation=Math.round(Gn==En?t.rotation:Gn),L&&t.percentComplete>50&&!Bn&&(t.rotation+=180)}}if(Q){var ir=t.x-Nn+t.y-Sn;Math.abs(ir)>2&&(Lr.push(e.sign(ir)),Lr.shift(),Ie.forward=di(Lr))}Nn=t.x,Sn=t.y}};(It||an||Bn||Un)&&(t.handlePath=rr),n(t.zimMaskDynamic)||t.zimMaskApply();function Vr(){if(t.seriesTweens&&t.seriesTweens.shift(),t.seriesCalls&&t.seriesCalls.shift(),t.seriesParams&&t.seriesParams.shift(),t.paused&&t.type!="Sprite"){l&&typeof l=="function"&&l(f);return}if(G.loop)if(In>0)if(we<In){qt>0&&(t.waiting=!0),Yn(),we++;return}else L?t.set&&t.set(Hr()):t.set&&t.set(ue);else{qt>0&&(t.waiting=!0),Yn();return}if(J?Rr(m):t.pauseAnimate(!0,m),!G.loop&&ae&&typeof ae=="function"){var Ne=n(re)?t:re;ae(Ne)}l&&typeof l=="function"&&l(f)}function Hr(){var Ne={};for(var gt in ue)if(y&&t.style)!n(K[gt])&&!D?Ne[gt]=K[gt]:gt=="transform"?Ne[gt]=t.style[gt]:Ne[gt]=Zn(t.style[gt]);else if(!n(K[gt])&&!D)Ne[gt]=K[gt];else if(gt.substr(0,1)=="."){for(var Tt=gt.split("."),Et=t,Xt=1;Xt<Tt.length;Xt++)Et=Et[Tt[Xt]];Ne[gt]=Et}else Ne[gt]=t[gt];return Ne}function pi(Ne){if(t.zimBusy){for(var gt in Ne)delete t.zimBusy[gt];e.isEmpty(t.zimBusy)&&(t.zimBusy=null)}}var gi=!1;Dr();function Dr(){Ie.zimObj=ue,Ie.zimTicker=ur,Ie.zimPaused=gi,be&&(Ie.zimIdSet=be),ze&&(n(e.idSets)&&(e.idSets={}),n(e.idSets[ze])?e.idSets[ze]=[t]:e.idSets[ze].indexOf(t)<0&&e.idSets[ze].push(t)),e.animatedObjects||(e.animatedObjects=new e.Dictionary(!0)),e.animatedObjects.add(t,!0)}function Rr(Ne){if(t.tweenStates&&t.tweenStates[Ne]&&delete t.tweenStates[Ne],!(n(t.zimTweens)||n(t.zimTweens[Ne]))){t.zimX=null,t.zimY=null,pi(t.zimTweens[Ne].zimObj),t.zimTweens[Ne].paused=!0,Wr(Ne);var gt=t.zimTweens[Ne].zimIdSet;if(!n(gt)&&t.zimIdSets){var Tt=t.zimIdSets[gt];Tt&&Tt.splice(Tt.indexOf(Ne),1),Tt&&Tt.length==0&&(delete t.zimIdSets[gt],e.isEmpty(t.zimIdSets)&&delete t.zimIdSets)}if(t.type=="Pen"&&t.zimOnPath&&(t.stop(),t.zimOnPath=!1),delete t.zimTweens[Ne],t.zimLastObj=null,e.isEmpty(t.zimTweens)&&t.stopAnimate(null,null,null,!1,!0),!(t.zimTweens&&t.zimTweens[Ne]||t.zimIdSets&&t.zimIdSets[gt||Ne])){if(e.idSets&&e.idSets[gt||Ne]){e.idSets[gt||Ne];var Et=e.idSets[gt||Ne].indexOf(t);Et>=0&&e.idSets[gt||Ne].splice(Et,1),e.idSets[gt||Ne].length<=0&&(delete e.idSets[gt||Ne],e.isEmpty(e.idSets)&&delete e.idSets)}}}}function Wr(Ne){-function(){var gt=t.zimTweens[Ne].zimTicker;if(t.zimTweens[Ne].extraTickers)for(var Tt=0;Tt<t.zimTweens[Ne].extraTickers.length;Tt++)e.Ticker.remove(t.zimTweens[Ne].extraTickers[Tt]);t.zimTweens[Ne].requestID&&cancelAnimationFrame(t.zimTweens[Ne].requestID),gt&&setTimeout(function(){gt&&e.Ticker.remove(gt),gt=null},200)}()}function Ar(Ne,gt){var Tt=t.zimTweens[Ne];Tt.paused=gt,gt!=Tt.zimPaused&&(Tt.zimPaused=gt,gt?Tt.zimTicker&&(Tt.zimAnimateTimeout=setTimeout(function(){e.Ticker.remove(Tt.zimTicker)},200)):(Tt.startPaused=!1,clearTimeout(Tt.zimAnimateTimeout),Tt.zimTicker&&(Tt.zimTicker=e.Ticker.add(Tt.zimTicker,_t))))}function qr(Ne){for(var gt=[],Tt=0;Tt<Ne.length;Tt++)t.zimIdSets&&!n(t.zimIdSets[Ne[Tt]])?gt=gt.concat(t.zimIdSets[Ne[Tt]]):gt.push(Ne[Tt]);return gt}(!t.stopAnimate||!t.stopAnimate.real)&&(t.stopAnimate=function(Ne,gt,Tt,Et,Xt){var Vt;if(t.dynamicAnimation=null,Xt&&Q){t.pauseAnimate();return}if(n(Ne)&&(t.tweenStates={}),gt)return t.endTween(null,Ne),t;if(n(Et)&&(Et=!0),t.pan==null&&(t.type!=null&&(t.paused=!0),t.animating=!1),t.type=="Pen"&&t.zimOnPath&&(t.stop(),t.zimOnPath=!1),n(Tt)&&(Tt=!0),Et&&Q&&(It&&It.off("change",t.zimAnimatePathChange),t.off("mousedown",t.zimAnimateDragDown),t.off("pressmove",t.zimAnimateDragPress),t.off("pressup",t.zimAnimateDragUp),t.amu&&_t.frame.off("mouseupplus",t.amu),e.Ticker.remove(t.zimDragAnimateTicker)),n(Ne)){if(!Tt)return t;t.zimBusy=null,$e.Tween.removeTweens(t);for(Vt in t.zimTweens)Wr(Vt);t.zimTweens=null,t.zimIdSets=null,t.zimTween=null,e.idSets&&e.idSets[be||Vt]&&(delete e.idSets[be||Vt],e.isEmpty(e.idSets)&&delete e.idSets),e.animatedObjects.remove(t)}else{Array.isArray(Ne)||(Ne=[Ne]);var vn=qr(Ne);for(Vt in t.zimTweens)t.zimTweens[Vt].requestID&&cancelAnimationFrame(t.zimTweens[Vt].requestID),Tt&&vn.indexOf(Vt)>=0&&Rr(Vt,Et),!Tt&&vn.indexOf(Vt)<0&&Rr(Vt,Et)}return t},t.stopAnimate.real=!0,t.pauseAnimate=function(Ne,gt,Tt,Et){var Xt;if(gt=="pauseOnBlur"?gt=null:n(gt)&&(t.tweenStates={all:Ne===!1}),t.type=="Pen"&&(Ne===!1?t.zimOnPath&&(t.infinite=!0):t.stop()),Kr&&!Et){if(n(gt))for(Xt in t.zimTweens)Ar(Xt,Ne);else t.pause(Ne,gt);return t}if(n(Ne)&&(Ne=!0),Kt=!1,t.type!=null&&(t.paused=Ne),t.animating=!Ne,n(Tt)&&(Tt=!0),n(gt)&&!Tt)return t;if(n(gt))for(Xt in t.zimTweens)Ar(Xt,Ne);else{Array.isArray(gt)||(gt=[gt]);var Vt=qr(gt);for(Xt in t.zimTweens)Tt&&Vt.indexOf(Xt)>=0&&(Ar(Xt,Ne),t.tweenStates[Xt]=!Ne),!Tt&&Vt.indexOf(Xt)<0&&(Ar(Xt,Ne),t.tweenStates[Xt]=!Ne)}return t.type=="Sprite"&&(t.running||t.stop()),t}),pe&&t.pauseAnimate(!0,m,null,!0);var Dn;for(ue.extra&&(Dn=ue.extra,delete ue.extra,Array.isArray(Dn)||(Dn=[Dn])),ve=0;ve<Qe.length;ve++){var Er=Qe[ve];ue[Er]&&(n(Dn)&&(Dn=[]),vi(Er,ue[Er]),delete ue[Er])}function vi(Ne,gt){gt===!0?Dn.push({outputProp:Ke[Ne]}):Array.isArray(gt)?Dn.push({outputProp:Ke[Ne],outputMin:gt[0],outputMax:gt[1],inputMin:gt[2],inputMax:gt[3]}):Dn.push({outputProp:Ke[Ne],outputMax:gt})}if(Dn){t.zimStartScaleX=t.scaleX,t.zimStartScaleY=t.scaleY,Ie.extraTickers=[];var Qr;for(ve=0;ve<Dn.length;ve++){var hn=Dn[ve];n(hn.inputObj)&&(hn.inputObj=t),n(hn.inputProp)&&(hn.inputProp="y"),n(hn.inputMin)&&(hn.inputMin=0),n(hn.inputMax)&&(hn.inputMax=hn.inputProp=="x"?_t.width:_t.height),n(hn.outputObj)&&(hn.outputObj=t),n(hn.outputProp)&&(hn.outputProp="scale"),n(hn.outputMin)&&(hn.outputMin=0),n(hn.outputMax)&&(hn.outputMax=hn.outputMin+1),n(hn.constrain)&&(hn.constrain=!0);for(var Xn in hn)ue[Xn]=e.Pick.choose(ue[Xn]);hn.outputProp=="percentSpeed"&&(Y=!0),Qr=new e.Proportion(hn.inputMin,hn.inputMax,hn.outputMin,hn.outputMax,hn.factor,hn.outputRound);var Zr=function(){var Ne=hn,gt=Qr;return function(){var Tt,Et=Ne.outputObj,Xt=Ne.inputObj[Ne.inputProp];if((Ne.inputProp=="x"||Ne.inputProp=="y")&&Ne.inputObj.parent){var Vt=Ne.inputObj.parent.localToGlobal(Xt,Xt);Xt=Vt[Ne.inputProp]}if(Ne.constrain?Tt=e.constrain(gt.convert(Xt),Ne.outputMin,Ne.outputMax):Tt=gt.convert(Xt),Number.isNaN(Tt)&&(Tt=Ne.outputMin!=null?Ne.outputMin:0),Ne.outputProp=="scale")Et.scaleX=e.sign(Et.scaleX)*Tt,Et.scaleY=e.sign(Et.scaleY)*Tt;else if(Ne.outputProp=="scaleX")Et.scaleX=e.sign(Et.scaleX)*Tt;else if(Ne.outputProp=="scaleY")Et.scaleY=e.sign(Et.scaleY)*Tt;else if(Ne.outputProp=="layer"){if(!Et.parent)return;var vn=e.constrain(Math.round(Tt),0,Et.parent.numChildren-1);vn!=Et.parent.getChildIndex(Et)&&Et.parent.setChildIndex(Et,vn)}else Ne.outputProp=="percentSpeed"?Et[Ne.outputProp]=Tt*100:Et[Ne.outputProp]=Tt}}();Zr(),Ie.extraTickers.push(e.Ticker.add(Zr,_t))}}var Kr;function Jr(){if(Ie.requestID=requestAnimationFrame(Jr),!(!Y||Ie.startPaused&&t.percentSpeed==0)){Ie.startPaused=!1,Ie!=$r&&($r=Ie,Ie.currentTime=0,t.pauseAnimate(!0,m,null,!0),t.type!=null&&(t.paused=!1),t.animating=!0,Br=!Xe&&!ye&&!h&&!In&&G.loop),Br&&(Ie.currentTime+=1e4*Nr,Ie.setPosition(Ie.currentTime,!0),Br=!1);var Ne=Ie.currentTime+yi*t.percentSpeed/100;Fr&&h==0&&(Ne=e.constrain(Ne,0,Fr)),Ie.currentTime=Ne,Ie.setPosition(Ie.currentTime),(It||an||Bn||Un)&&rr(),_t.update()}}if(Y&&(t.dynamicAnimation=!0),Y||t.zimAnimateDragDown){if(Y){Kr=!0,t.pauseAnimate(!0,m,null,!0),t.type!=null&&(t.paused=!1),t.animating=!0,Ie.currentTime=0;var $r=Ie;n(t.percentSpeed)&&(t.percentSpeed=Ie.startPaused?0:100);var yi=1e3/60;Ie.currentTime=0;var Br=!Xe&&!ye&&!h&&!In&&G.loop;ce&&G.loop&&!In&&(ce=!1);var Nr=i+(L?V||i:0)+(S||0)+(C||0);Nr*=de=="s"?1e3:1;var jr=1;G.loop&&In&&(jr=In);var Fr;ce&&(Fr=Nr*jr),Jr()}var br;t.pause=function(Ne,gt){if(n(Ne)&&(Ne=!0),n(gt)&&(gt=0),Ne){if(t.zimAnimateDragDown&&(Q=!1,t.cur("default"),It&&It.off("change",t.zimAnimatePathChange),t.off("mousedown",t.zimAnimateDragDown),t.off("pressmove",t.zimAnimateDragPress),t.off("pressup",t.zimAnimateDragUp),!Y))return;br=t.percentSpeed,gt>0?e.animate({target:t,props:{percentSpeed:0},override:!1,ticker:!1,time:gt,call:function(){t.percentSpeed=0,t.type!=null&&(t.paused=!0),t.animating=!1,Y=!1,t.dispatchEvent("pause")}}):(Ie.startPaused=!1,t.percentSpeed=0,t.type!=null&&(t.paused=!0),t.animating=!1,Y=!1,setTimeout(function(){t.dispatchEvent("pause")},10))}else{if(t.zimAnimateDragDown&&(Q=!0,t.cur("pointer"),It&&(t.zimAnimatePathChange=It.on("change",t.zimAnimatePathChange)),t.zimAnimateDragDown=t.on("mousedown",t.zimAnimateDragDown),t.zimAnimateDragPress=t.on("pressmove",t.zimAnimateDragPress),t.zimAnimateDragUp=t.on("pressup",t.zimAnimateDragUp),!Y&&pe!=!1))return;Kt=!1,Ie.currentTime=Ie.position,gt>0?e.animate({target:t,props:{percentSpeed:br},override:!1,ticker:!1,time:gt,call:function(){t.percentSpeed=br,t.paused=!1,t.animating=!0,Y=!0}}):(t.percentSpeed=br,t.type!=null&&(t.paused=!1),t.animating=!0,Y=!0)}return t}}return t},e.stopAnimate=function(t,r){qe("45.12");var i;if(n(t)){if(e.animatedObjects)for(i=e.animatedObjects.length-1;i>=0;i--)e.animatedObjects.objects[i].stopAnimate(null,r);return}if(Array.isArray(t)||(t=[t]),!!e.idSets)for(var o=0;o<t.length;o++){var l=t[o];if(e.idSets[l]){var f=e.idSets[l].length-1;for(i=f;i>=0;i--)e.idSets[l][i].stopAnimate(l,r)}}},e.stopZimAnimate=function(t){qe("45.1"),e.stopAnimate(t)},e.pauseAnimate=function(t,r){qe("45.22"),n(t)&&(t=!0);var i;if(n(r)||r=="pauseOnBlur"){if(e.animatedObjects)for(i=e.animatedObjects.length-1;i>=0;i--)e.animatedObjects.objects[i].pauseAnimate(t,r);return}if(Array.isArray(r)||(r=[r]),!!e.idSets)for(var o=0;o<r.length;o++){var l=r[o];if(e.idSets[l])for(i=e.idSets[l].length-1;i>=0;i--)e.idSets[l][i].pauseAnimate(t,l)}},e.pauseZimAnimate=function(t,r){qe("45.2"),e.pauseAnimate(t,r)},e.wiggle=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R){var T="target, property, baseAmount, minAmount, maxAmount, minTime, maxTime, totalTime, type, ease, integer, id, startType, ticker, wait, pauseOnBlur",L;if(L=mt(e.wiggle,arguments,T))return L;if(qe("45.25"),n(t)||n(i)||n(o))return t;n(l)&&(l=o);var S=v(f,null,40);n(f)&&(f=S=="s"?1:1e3),n(h)&&(h=f),a(h,S,40),n(b)&&(b="quadInOut"),n(w)&&(w=!1),n(C)&&(C=e.makeID()),n(_)&&(_="both"),n(O)&&(O="both"),n(P)&&(P=!0),n(A)&&(A=0),a(p,S,40),n(p)||(t.wiggleTimeout=setTimeout(function(){t.stopAnimate(C),t.dispatchEvent("wigglestop")},p*(S=="s"?1e3:1)));var E=0,k;function X(){var q=e.rand(e.Pick.choose(f),e.Pick.choose(h),!1),V={},I={},te;I[r]=e.Pick.choose(i),_=="negative"||E==0&&O=="negative"?te=-e.rand(e.Pick.choose(o),e.Pick.choose(l),w):_=="positive"||E==0&&O=="positive"?te=e.rand(e.Pick.choose(o),e.Pick.choose(l),w):E==0?te=e.rand(e.Pick.choose(o),e.Pick.choose(l),w,!0):te=e.rand(e.Pick.choose(o),e.Pick.choose(l),w)*e.sign(k)*-1,V[r]=e.Pick.choose(i)+te,E==0&&(q=q/2),k=te,E++;var B=t.futureRate;_=="negative"||_=="positive"?e.animate({target:t,obj:V,set:I,ease:b,time:q*2,wait:dt(A),rewind:!0,override:!1,call:X,id:C,ticker:!!t.stage,timeCheck:!1,pauseOnBlur:R}):e.animate({target:t,obj:V,ease:b,time:q,wait:dt(A),override:!1,call:X,id:C,ticker:!!t.stage,timeCheck:!1,pauseOnBlur:R}),B&&(t.futureRate=B)}return t.addTo&&!t.stage?t.added(X):X(),t},e.loop=function(t,r,i,o,l,f,h,p){var _="obj, call, reverse, interval, step, start, end, immediate",b;if(b=mt(e.loop,arguments,_))return b;if(e.zimLoopCheck||qe("45.3"),e.zimLoopCheck=!0,n(t)||n(r))return;n(i)&&(i=!1),n(o)&&(o=0),(n(l)||l<=0)&&(l=1),n(p)&&(p=!0),t.constructor===Number&&(t=Number(t)),t.constructor===String&&(t=String(t));var w=typeof t=="number"?"number":t.constructor===Array?"array":t.constructor==={}.constructor?"object":t instanceof NodeList?"nodelist":typeof t=="string"?"string":t instanceof HTMLCollection?"htmlcollection":t.type&&t.type=="Dictionary"?"Dictionary":"invalid";if(w=="container"&&!t.addChild)return;var C,O,P,A;if(w=="number"||w=="string"||w=="array"||w=="nodelist"||w=="htmlcollection"||w=="Dictionary"){if(w=="Dictionary"){var R=e.copy(t.values);t=e.copy(t.objects)}if(C=w=="number"?t:t.length,P=L(C-1),P==0)return;if(i)if(o===0){for(O=f;O>=h;O-=l)if(w=="number"?A=r(O,P,f,h,t):w=="array"||w=="string"?A=r(t[O],O,P,f,h,t):w=="Dictionary"?A=r(t[O],R[O],O,P,f,h,t):A=r(t.item(O),O,P,f,h,t),typeof A<"u"&&A!="next")return A}else e.interval(o,function(S){if(O=S.count,p||O--,l&&(O*=l),O=f-O,w=="number"?A=r(O,P,f,h,t):w=="array"||w=="string"?A=r(t[O],O,P,f,h,t):w=="Dictionary"?A=r(t[O],R[O],O,P,f,h,t):A=r(t.item(O),O,P,f,h,t),A=="next")S.next();else if(typeof A<"u")return S.clear(),A},P,p);else if(o===0){for(O=f;O<=h;O+=l)if(w=="number"?A=r(O,P,f,h,t):w=="array"||w=="string"?A=r(t[O],O,P,f,h,t):w=="Dictionary"?A=r(t[O],R[O],O,P,f,h,t):A=r(t.item(O),O,P,f,h,t),typeof A<"u"&&A!="next")return A}else e.interval(o,function(S){if(O=S.count,p||O--,l&&(O*=l),w=="number"?A=r(O,P,f,h,t,S):w=="array"||w=="string"?A=r(t[O],O,P,f,h,t,S):w=="Dictionary"?A=r(t[O],R[O],O,P,f,h,t):A=r(t.item(O),O,P,f,h,t,S),A=="next")S.next();else if(typeof A<"u")return S.clear(),A},P,p);return!0}else if(w=="object"){C=0;var T=[];for(O in t)C++,T.push(O);if(P=L(C-1),P==0)return;if(i)if(o===0){for(O=f;O>=h;O-=l)if(A=r(T[O],t[T[O]],O,P,f,h,t),typeof A<"u"&&A!="next")return A}else e.interval(o,function(S){if(O=S.count,p||O--,l&&(O*=l),O=f-O,A=r(T[O],t[T[O]],O,P,f,h,t),A=="next")S.next();else if(typeof A<"u")return S.clear(),A},P,p);else if(o===0){for(O=f;O<=h;O+=l)if(A=r(T[O],t[T[O]],O,P,f,h,t),typeof A<"u"&&A!="next")return A}else e.interval(o,function(S){if(O=S.count,p||O--,l&&(O*=l),A=r(T[O],t[T[O]],O,P,f,h,t),A=="next")S.next();else if(typeof A<"u")return S.clear(),A},P,p);return!0}else{if(P=L(t.numChildren-1),P==0)return;if(i)if(o===0){for(O=f;O>=h;O-=l)if(A=r(t.getChildAt(O),O,P,f,h,t),typeof A<"u"&&A!="next")return A}else e.interval(o,function(S){if(O=S.count,p||O--,l&&(O*=l),O=f-O,A=r(t.getChildAt(O),O,P,f,h,t),A=="next")S.next();else if(typeof A<"u")return S.clear(),A},P,p);else if(o===0){for(O=f;O<=h;O+=l)if(A=r(t.getChildAt(O),O,P,f,h,t),typeof A<"u"&&A!="next")return A}else e.interval(o,function(S){if(O=S.count,p||O--,l&&(O*=l),A=r(t.getChildAt(O),O,P,f,h,t),A=="next")S.next();else if(typeof A<"u")return S.clear(),A},P,p);return!0}function L(S){return n(f)&&(f=i?S:0),n(h)&&(h=i?0:S),i&&h>f||!i&&f>h||(f<0&&h)<0||f>S&&h>S?0:(f=Math.max(0,Math.min(f,S)),h=Math.max(0,Math.min(h,S)),Math.floor((i?f-h:h-f)/l)+1)}},e.scaleTo=function(t,r,i,o,l,f,h){var p="obj, boundObj, percentX, percentY, type, boundsOnly, simple",_;if(_=mt(e.scaleTo,arguments,p))return _;if(t.type=="AC"&&le.zdf)return le.zdf.ac("scaleTo",arguments),t;if(qe("43"),n(r)&&(r=le.zdf&&le.zdf.stage?le.zdf.stage:null),n(t)||!t.getBounds||!t.getBounds())return Hn("zim methods - scaleTo(): please provide an object (with setBounds) to scale"),t;if(n(r)||!r.getBounds||!r.getBounds())return Hn("zim methods - scaleTo(): please provide a boundObject (with setBounds) to scale to"),t;n(i)&&(i=-1),n(o)&&(o=-1),i==-1&&o==-1&&(i=o=100,n(l)&&(l="fill")),n(l)&&(l="fit"),l=="smallest"?l="fit":l=="biggest"||l=="outside"||l=="largest"?l="fill":(l=="both"||l=="stretch")&&(l="full"),n(f)&&(f=!1),n(h)&&(h=!1);var b=r.getBounds().width*i/100*(f?1:r.scaleX),w=r.getBounds().height*o/100*(f?1:r.scaleY);(r.type=="Stage"||r.type=="StageGL")&&(b=r.width*i/100,w=r.height*o/100);var C,O;if(h)C=t.getBounds().height,O=t.getBounds().width;else{var P=e.boundsToGlobal(t);C=P.height/t.scaleX,O=P.width/t.scaleY,(isNaN(C)||isNaN(O)||C>5e3)&&(C=t.getBounds().height,O=t.getBounds().width)}if((i==-1||o==-1)&&l!="full")return i==-1?e.sca(t,w/C):e.sca(t,b/O),t;var A;return l=="full"?(t.scaleX=i!=-1?b/O:t.scaleX,t.scaleY=o!=-1?w/C:t.scaleY,t):(l=="fill"?A=Math.max(b/O,w/C):A=Math.min(b/O,w/C),e.sca(t,A),t)},e.fit=function(t,r,i,o,l,f){var h="obj, left, top, width, height, type",p;if(p=mt(e.fit,arguments,h))return p;if(t.type=="AC"&&le.zdf)return le.zdf.ac("fit",arguments),t;if(qe("46"),!(n(t)||!t.getBounds)){if(!t.getBounds()){ht("zim methods - fit(): please setBounds() on object");return}if(n(r)){if(!t.stage){ht("zim methods - fit(): please add boundary dimensions or add obj to stage first");return}if(!t.stage.getBounds()){ht("zim methods - fit(): please add boundary dimensions or add obj with bounds to stage first");return}var _=t.stage.getBounds().width,b=t.stage.getBounds().height;r=0,i=0,o=_,l=b}f===!0?f="fit":f===!1&&(f="fill"),n(f)&&(f="fit"),t.scaleX=t.scaleY=1;var w=o,C=l,O=t.getBounds().width,P=t.getBounds().height,A,R,T,L,S;return f=="full"?(t.scaleX=T=w/O,t.scaleY=L=C/P,A=w,R=C):(f=="fit"?w/C>=O/P?S=C/P:S=w/O:f=="fill"&&(w/C>=O/P?S=w/O:S=C/P),T=L=S),t.scaleX=T,t.scaleY=L,A=O*T,R=P*L,t.x=(t.regX-t.getBounds().x)*T+r+(w-A)/2,t.y=(t.regY-t.getBounds().y)*L+i+(C-R)/2,{x:t.x,y:t.y,width:A,height:R,scale:S,scaleX:T,scaleY:L,bX:r,bY:i,bWidth:o,bHeight:l}}},e.boundsCheck=!1,e.boundsToGlobal=function(t,r,i,o,l){if(e.boundsCheck||(qe("40"),e.boundsCheck=!0),!(n(t)||!t.getBounds)){if(n(i)&&(i=!1),l&&!t.getBounds&&!t.getBounds())return t;var f=t.getBounds();if(!f&&n(r)){ht("zim methods - boundsToGlobal():\n please setBounds() on object (or a rectangle)");return}r&&(f=r);var h,p,_,b;l&&l.type&&!(l.type=="Stage"||l.type=="StageGL")?(h=t.localToLocal(f.x,f.y,l),p=t.localToLocal(f.x+f.width,f.y,l),_=t.localToLocal(f.x+f.width,f.y+f.height,l),b=t.localToLocal(f.x,f.y+f.height,l)):i?(h=t.globalToLocal(f.x,f.y),p=t.globalToLocal(f.x+f.width,f.y),_=t.globalToLocal(f.x+f.width,f.y+f.height),b=t.globalToLocal(f.x,f.y+f.height)):(h=t.localToGlobal(f.x,f.y),p=t.localToGlobal(f.x+f.width,f.y),_=t.localToGlobal(f.x+f.width,f.y+f.height),b=t.localToGlobal(f.x,f.y+f.height));var w=Math.min(h.x,p.x,_.x,b.x),C=Math.min(h.y,p.y,_.y,b.y),O=Math.max(h.x,p.x,_.x,b.x),P=Math.max(h.y,p.y,_.y,b.y);return new $e.Rectangle(w,C,O-w,P-C)}},e.resetBounds=function(t,r,i,o,l,f){var h="obj, a, b, c, d, margin",p;if(p=mt(e.resetBounds,arguments,h))return p;qe("40.5");var _,b,w,C;return n(o)?(_=0,b=r,w=0,C=i):(_=r,b=o,w=i,C=l),n(C)&&(C=b),n(r)?t.setBounds(null):t.setBounds(_,w,b,C),f&&(i=t.getBounds(),i&&t.setBounds(i.x-f,i.y-f,i.width+f*2,i.height+f*2)),t},e.copyMatrix=function(t,r){return qe("45.5"),t.x=r.x,t.y=r.y,t.scaleX=r.scaleX,t.scaleY=r.scaleY,t.regX=r.regX,t.regY=r.regY,t.rotation=r.rotation,t.skewX=r.skewX,t.skewY=r.skewY,t},e.duplicate=function(t,r){qe("45.6");var i=t.clone(r);for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)&&i[o]==null){if(o=="parent"||o=="zimTouch")continue;i[o]=t[o]}return i},e.expand=function(t,r,i,o,l){var f="obj, padding, paddingV, paddingRight, paddingBottom",h;if(h=mt(e.expand,arguments,f))return h;if(qe("50"),n(t)||!t.getBounds||!t.getBounds())return ht("zim methods - expand(): please provide object with bounds set"),t;n(r)&&(r=20),n(i)&&(i=r);var p,_;!n(o)||!n(l)?(n(o)&&(o=r),n(l)&&(l=i),p=r,_=i):(p=o=r,_=l=i);var b=t.getBounds(),w=new e.Shape({style:!1});return w.graphics.f("rgba(0,0,0,.01)").r(b.x-p,b.y-_,b.width+p+o,b.height+_+l),t.hitArea=w,t},e.setSwipe=function(t,r){if(qe("34"),n(t)||!t.on)return;t.zimNoSwipe=r?null:!0,t instanceof $e.Container&&i(t);function i(o){for(var l=o.numChildren,f,h=0;h<l;h++)f=o.getChildAt(h),f.zimNoSwipe=t.zimNoSwipe,f instanceof $e.Container&&i(f)}return t},e.setMask=function(t,r,i){if(qe("50.1"),n(t)&&ht("zim methods - setMask(): please provide obj"),n(r))return l(),t;var o=t.stage||(le.zdf?le.zdf.stage:null);function l(){t.zimMask&&t.zimMask.parent&&t.zimMask.parent.removeChild(t.zimMask),t.zimMask=null,t.zimMaskTicker&&e.Ticker.remove(t.zimMaskTicker),t.mask=null}t.zimMaskOriginal&&t.zimMaskOriginal!=r&&l(),n(i)&&(i=r.type=="Blob"||!n(r.zimDown)||!n(r.transformControls)||!n(r.zimTouch)||!n(r.zimTweens),r.zimMaskDynamic=i),t.zimMaskOriginal=r;var f;function h(){if(i&&(!o||!r.stage))return t;if(f&&f.dispose&&f.dispose(),f=null,t.zimMask=r.zimMask=f=r.shape.clone(),e.copyMatrix(f,r),r.addChildAt(f,0),f.alpha=0,!t.parent){t.mask=f;return}var p=r.getConcatenatedMatrix().decompose(),_=t.parent.getConcatenatedMatrix().decompose();f.scaleX=p.scaleX/_.scaleX,f.scaleY=p.scaleY/_.scaleY,f.rotation=(p.rotation?p.rotation:0)-(_.rotation?_.rotation:0);var b=r.localToLocal(r.shape.x+r.regX,r.shape.y+r.regY,t.parent);f.x=b.x,f.y=b.y,t.mask=f}return r.zimMaskApply=function(){t.zimMaskTicker&&e.Ticker.remove(t.zimMaskTicker),t.zimMaskTicker=e.Ticker.add(h)},r&&r.shape?(h(),i&&r.zimMaskApply()):(f=r,t.mask=f),t},e.outline=function(t,r,i,o){var l="obj, color, size, boundsOnly",f;if(f=mt(e.outline,arguments,l))return f;if(t.type=="AC"&&le.zdf)return le.zdf.ac("outline",arguments),t;if(qe("47"),t.type&&t.type=="zimOultineShape")return Ct&&ht("zim.outline() - warning, you are trying to outline an outline - do not outline in a loop"),t;if(n(t)||!t.getBounds)return ht("zim methods - outline(): please provide object with bounds set"),t;if(!t.getBounds())return ht("zim methods - outline(): please setBounds() on object"),t;if(!t.parent)return ht("zim methods - outline(): object should be on stage first"),t;if(n(r)&&(r="brown"),n(i)&&(i=2),i<=0){t.ZIMoutlineShape&&t.ZIMoutlineShape.parent.removeChild(t.ZIMoutlineShape),t.ZIMoutlineShapeC&&t.ZIMoutlineShapeC.parent.removeChild(t.ZIMoutlineShapeC),t.ZIMoutlineShape=t.ZIMoutlineShapeC=null;return}var h=t.getBounds(),p=t.ZIMoutlineShape=t.ZIMoutlineShape?t.ZIMoutlineShape:new e.Shape;p.type="zimOutlineShape";var _=t.ZIMoutlineShapeC=t.ZIMoutlineShapeC?t.ZIMoutlineShapeC:new e.Shape;_.type="zimOutlineShape";var b=t.parent;t.outlineToggled=!0,t.outlineToggle=function(k){return k===!0?(t.ZIMoutlineShape.visible=!0,t.ZIMoutlineShapeC.visible=!0):k===!1?(t.ZIMoutlineShape.visible=!1,t.ZIMoutlineShapeC.visible=!1):(t.ZIMoutlineShape.visible=!t.ZIMoutlineShape.visible,t.ZIMoutlineShapeC.visible=!t.ZIMoutlineShapeC.visible),t.outlineToggled=t.ZIMoutlineShape.visible,t};var w=t.localToLocal(h.x,h.y,b),C=t.localToLocal(h.x+h.width,h.y,b),O=t.localToLocal(h.x+h.width,h.y+h.height,b),P=t.localToLocal(h.x,h.y+h.height,b),A=t.localToLocal(0,0,b),R=p.graphics.c(),T=_.graphics.c();if(R.s(r).ss(i).mt(w.x,w.y).lt(C.x,C.y).lt(O.x,O.y).lt(P.x,P.y).lt(w.x,w.y).cp(),!o){var L=10,S=L+1;T.s("white").ss(i+2),T.mt(-S,0).lt(S,0),T.mt(0,-S).lt(0,S),T.s(r).ss(i),T.mt(-L,0).lt(L,0),T.mt(0,-L).lt(0,L),T.cp(),_.x=A.x,_.y=A.y,_.rotation=t.rotation,R.s("white").ss(i+2).dc(t.x,t.y,L+6),R.s(r).ss(i).dc(t.x,t.y,L+6)}t.parent.removeChild(p),t.parent.removeChild(_);var E=t.parent.getChildIndex(t);return t.parent.addChildAt(_,E+1),t.parent.addChildAt(p,E+1),p.mouseEnabled=!1,_.mouseEnabled=!1,t},e.blendmodes=function(t,r,i){qe("47.05"),n(r)&&(r=1);var o=["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"];i===!1&&o.push("source-over","source-in","source-out","source-atop","destination-over","destination-in","destination-out","destination-atop","copy","xor");var l=0,f=e.interval(r,function(){var h=o[l%o.length];l++,t.ble(h),Yr(h),t.stage&&t.stage.update()});return t.on("mousedown",function(){f.pause(!f.paused)}),t},e.STYLE=null,e.ignore="ignore",e.getStyle=function(t,r,i,o){e.STYLECHECK||(qe("50.34"),e.STYLECHECK=!0);var l=["tap","change","hold","noTap","noChange","noHold","pos","addTo","center","centerReg","reg","mov","move","drag","transform","gesture","mouse","expand","outline","bounds","animate","wiggle","cache"],f=le.STYLE||e.STYLE,h=f,p,_=!1;n(o)||(t=null,r=o,_=!0),f&&f.type&&typeof f.type=="string"&&(f.ttype=f.type,delete f.type);for(var b in f)p=f[b],b.match(/^[(A-Z)]/)?(f.type||(f.type={}),f.type[b]?f.type[b]=e.merge(f.type[b],p):f.type[b]=p,delete f[b]):p.constructor==={}.constructor&&b!="group"&&b!="type"&&!e.isPick(p)&&l.indexOf(b)==-1&&(f.group||(f.group={}),f.group[b]?f.group[b]=e.merge(f.group[b],p):f.group[b]=p,delete f[b]);n(h)?h={}:h=e.copy(h);var w;if(n(i))i={};else for(w=0;w<l.length;w++)delete i[l[w]];var C=i,O=h.type;if(O&&delete h.type,!n(r)&&!n(h.group)){var P=r.split(","),A={};for(w=0;w<P.length;w++){var R=P[w].trim();n(h.group[R])||(A=e.merge(A,h.group[R]))}delete h.group}_?!n(r)&&!n(A)&&(h=A):(!n(t)&&!n(O)&&!n(O[t])&&(h=e.merge(h,O[t])),!n(r)&&!n(A)&&(h=e.merge(h,A)));for(var T in h){if(C[T]){delete h[T];continue}if(p=l.indexOf(T)==-1&&!h.delayPick?e.Pick.choose(h[T]):h[T],p=="ignore"){delete h[T];continue}else p&&p.constructor==={}.constructor&&(p=e.copy(p,!0,!1));var L;for(var S in h)(L=S.match(/^(.+)gColor$/))&&(h[L[1]+"ackgroundColor"]=h[S],delete h[S]);h[T]=p}return h=e.merge(h,C),h.ttype&&!h.type&&(h.type=h.ttype,delete h.ttype),h.style===!1?{}:h},e.styleTransforms=function(t,r){var i=["visible","x","y","scale","scaleX","scaleY","rotation","alpha","skewX","skewY","blendMode"],o;if(r){for(r.add&&t.addTo(),r.addTo&&t.addTo(r.addTo===!0?null:r.addTo),o=0;o<i.length;o++)r[i[o]]!=null&&(t[i[o]]=e.Pick.choose(r[i[o]]));if((r.regX!=null||r.regY!=null)&&t.reg(n(r.regX)?DEFAULT:r.regX,n(r.regY)?DEFAULT:r.regY),r.bounds&&r.bounds.constructor==={}.constructor&&t.setBounds(r.bounds.x?r.bounds.x:0,r.bounds.y?r.bounds.y:0,r.bounds.width?r.bounds.width:100,r.bounds.height?r.bounds.height:100),r.center&&t.center(r.center===!0?null:r.center),r.centerReg&&t.centerReg(r.centerReg===!0?null:r.centerReg),r.reg!=null&&(r.reg.constructor==={}.constructor?t.reg(e.Pick.choose(r.reg.x),e.Pick.choose(r.reg.y),r.reg.still):t.reg(r.reg)),r.x!=null&&(r.loc?r.loc.x==null&&(r.loc.x=r.x):r.loc={x:r.x}),r.y!=null&&(r.loc?r.loc.y==null&&(r.loc.y=r.y):r.loc={y:r.y}),r.loc&&(r.loc.constructor==={}.constructor?t.loc(e.Pick.choose(r.loc.x),e.Pick.choose(r.loc.y)):t.loc(e.Pick.choose(r.loc))),r.pos)if(r.pos.constructor==={}.constructor)t.pos(e.Pick.choose(r.pos.x),e.Pick.choose(r.pos.y),e.Pick.choose(r.pos.horizontal),e.Pick.choose(r.pos.vertical),e.Pick.choose(r.pos.container),e.Pick.choose(r.pos.index),r.pos.add,e.Pick.choose(r.pos.reg),e.Pick.choose(r.pos.regX),e.Pick.choose(r.pos.regY));else{var l=e.Pick.choose(r.pos);(l=="left"||l=="top")&&t.pos(),l=="right"&&t.pos({horizontal:"right"}),l=="bottom"&&t.pos({vertical:"bottom"}),(l=="rightbottom"||l=="bottomright")&&t.pos({horizontal:"right",vertical:"bottom"}),l=="center"&&t.center()}if((r.mov||r.move)&&(r.move&&(r.mov=r.move),r.mov.constructor==={}.constructor?t.mov(e.Pick.choose(r.mov.x),e.Pick.choose(r.mov.y)):t.mov(e.Pick.choose(r.mov))),r.outline&&setTimeout(function(){t.outline(r.outline.constructor==={}.constructor?r.outline:null),t.stage&&t.stage.update()},20),r.drag&&t.drag(r.drag.constructor==={}.constructor?r.drag:{currentTarget:!0}),r.gesture&&t.gesture(r.gesture.constructor==={}.constructor?r.gesture:null),r.mouse===!1&&t.noMouse(),r.transform&&setTimeout(function(){t.transform(r.transform.constructor==={}.constructor?r.transform:null)},20),r.animate)for(Array.isArray(r.animate)||(r.animate=[r.animate]),o=0;o<r.animate.length;o++)-function(){var h=r.animate[o];h.constructor==={}.constructor&&setTimeout(function(){t.animate(h)},20)}();if(r.wiggle)for(Array.isArray(r.wiggle)||(r.wiggle=[r.wiggle]),o=0;o<r.wiggle.length;o++)-function(){var h=r.wiggle[o];h.constructor==={}.constructor&&setTimeout(function(){t.wiggle(h)},20)}();r.expand&&t.expand(r.expand===!0?null:r.expand),r.cache&&(r.cache.constructor==={}.constructor?r.cache.x?t.cache(e.Pick.choose(r.cache.x),e.Pick.choose(r.cache.y),e.Pick.choose(r.cache.x),e.Pick.choose(r.cache.y)):t.cache(e.Pick.choose(r.cache.width),e.Pick.choose(r.cache.height)):t.cache()),r.tap&&t.tap&&t.tap(r.tap),r.change&&t.change&&t.change(r.change),r.hold&&t.hold&&t.hold(r.hold),r.noChange&&t.noChange&&t.noChange(),r.noTap&&t.noTap&&t.noTap(),r.noHold&&t.noHold&&t.noHold();var f=le.STYLE||e.STYLE;f&&(f.once===!0||f.once==t.type)&&(le.STYLE?le.STYLE={}:e.STYLE={})}},e.Style={remembered:{},clear:function(){return le.STYLE&&(le.STYLE={}),e.STYLE&&(e.STYLE={}),e.Style},clearTypes:function(){var t=le.STYLE||e.STYLE;return delete t.types,e.Style},clearGroups:function(){var t=le.STYLE||e.STYLE;return delete t.groups,e.Style},remember:function(t){n(t)&&(t="default");var r=le.STYLE||e.STYLE;return r||(Dt?r=e.STYLE={}:r=le.STYLE={}),e.Style.remembered[t]=e.copy(r,!0),e.Style},clearRemembered:function(t){return n(t)?e.Style.remembered={}:delete e.Style.remembered[t],e.Style},recall:function(t){return n(t)&&(t="default"),le.STYLE?le.STYLE=e.Style.remembered[t]:e.STYLE=e.Style.remembered[t],e.Style},add:function(t){var r=le.STYLE||e.STYLE;return r||(Dt?r=e.STYLE={}:r=le.STYLE={}),le.STYLE?le.STYLE=e.merge(r,t):e.STYLE=e.merge(r,t),e.Style},addType:function(t,r){var i=le.STYLE||e.STYLE;return i||(Dt?i=e.STYLE={}:i=le.STYLE={}),i.type||(i.type={}),i.type[t]=r,e.Style},addGroup:function(t,r){var i=le.STYLE||e.STYLE;return i||(Dt?i=e.STYLE={}:i=le.STYLE={}),i.group||(i.group={}),i.group[t]=r,e.Style},remove:function(t){var r=le.STYLE||e.STYLE;return r||(Dt?r=e.STYLE={}:r=le.STYLE={}),delete r[t],e.Style},removeType:function(t){var r=le.STYLE||e.STYLE;return r||(Dt?r=e.STYLE={}:r=le.STYLE={}),r.type&&delete r.type[t],e.Style},removeGroup:function(t){var r=le.STYLE||e.STYLE;return r||(Dt?r=e.STYLE={}:r=le.STYLE={}),r.group&&delete r.group[t],e.Style}},e.PATH=null,e.TIME="seconds",e.TIMECHECK=!1,e.DIR="ltr",e.SEEDRAND=null,e.SEEDRANDCOUNT=0,e.ANIMATE=!0,e.OPTIMIZE=!1,e.ACTIONEVENT="mousedown",e.DEFAULTWIRE="currentValue",e.KEYFOCUS=null,e.POSREG=!1,e.DRAGALL=!1,e.MOBILE="default",e.Ticker={stages:null,myUpdate:null,alwaysList:new e.Dictionary,list:new e.Dictionary,wire:new e.Dictionary,setFPS:function(t,r){n(t)&&n(r)?(t=60,r=60):n(t)?t=60:n(r)&&(r=t),e.Ticker.framerate=$e.Ticker.framerate=e.mobile()?t:r},setTimingMode:function(t){$e.Ticker.timingMode=$e.Ticker.RAF,t=="synched"&&($e.Ticker.timingMode=$e.Ticker.RAF_SYNCHED),t=="timeout"&&($e.Ticker.timingMode=$e.Ticker.TIMEOUT)},add:function(t,r){qe("30");var i=e.Ticker;if(i.has(t,r))return t;if((n(r)||!r.update)&&(r=le.zdf.stage),n(t)||typeof t!="function"){ht("zim.Ticker.add() - only add functions");return}return i.list.at(r)?i.list.at(r).push(t):i.list.add(r,[t]),i.ticker||(i.ticker=$e.Ticker.on("tick",i.call)),i.framerate||i.setFPS(),t},addWire:function(t,r){if(qe("30"),n(r[0]))return t;var i=e.Ticker;i.wire.add(t,r);var o=r[0][r[1]];return r[4]&&(o=r[4](o,"from")),r[3]&&(t[r[6]]=r[7]=o),i.ticker||(i.ticker=$e.Ticker.on("tick",i.call)),i.framerate||i.setFPS(),t},rawID:{},raw:function(t){qe("30");var r=e.makeID("letters",7);return-function i(o){t(o),e.Ticker.rawID[r]=requestAnimationFrame(i)}(),r},removeRaw:function(t){cancelAnimationFrame(e.Ticker.rawID[t]),delete e.Ticker.rawID[t]},call:function(t){var r=e.Ticker,i,o,l,f=[];for(l=0;l<r.list.length;l++){i=r.list.objects[l],o=r.list.values[l];for(var h=0;h<o.length;h++)o[h](t);var p=!1;(r.alwaysList.at(i)||o.length>0&&(n(r.update)&&!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)||r.update))&&(p=!0),p&&f.indexOf(i)<0&&f.push(i)}for(l=r.wire.length-1;l>=0;l--){var _=r.wire.objects[l],b=r.wire.values[l];if(b){var w=_[b[6]];w!=b[7]&&(b[4]&&(w=b[4](w,"to",b[7])),b[0][b[1]]=b[7]=w,b[5]&&b[5](w),i=b[0].stage,i&&f.indexOf(i)<0&&f.push(i)),b[2]&&b[0]&&(w=b[0][b[1]],b[7]!=w&&(b[4]&&(w=b[4](w,"from",b[7])),_[b[6]]=b[7]=w,b[5]&&b[5](w),i=_.stage,i&&f.indexOf(i)<0&&f.push(i)))}}if(r.list.length==0)for(l=0;l<r.alwaysList.length;l++)i=r.alwaysList.objects[l],f.indexOf(i)<0&&f.push(i);var C=f.length;for(l=0;l<C;l++)f[l].update()},always:function(t){qe("30");var r=e.Ticker;r.framerate||r.setFPS(),(n(t)||!t.update)&&(t=le.zdf.stage),r.alwaysList.add(t,!0),r.ticker||(r.ticker=$e.Ticker.on("tick",r.call))},alwaysOff:function(t){var r=e.Ticker;(n(t)||!t.update)&&(t=le.zdf.stage),r.alwaysList.remove(t)},remove:function(t){var r=e.Ticker;if(n(t)||typeof t!="function"){ht("zim.Ticker - only remove functions");return}for(var i=0;i<r.list.length;i++){var o=r.list.values[i].indexOf(t);o>-1&&r.list.values[i].splice(o,1)}r.alwaysList.length>0||r.list.length>0||r.wire.length>0||($e.Ticker.off("tick",r.ticker),r.ticker=null)},removeAll:function(t){for(var r=e.Ticker,i,o=0;o<r.list.length;o++)i=r.list.objects[o],(n(t)||t===i)&&(r.list.values[o]=[]);r.alwaysList.length>0||r.list.length>0||r.wire.length>0||($e.Ticker.off("tick",r.ticker),r.ticker=null)},removeWire:function(t,r,i,o){var l=e.Ticker;if(n(t)&&n(r)&&n(i)&&n(o))l.wire.clear();else for(var f=l.wire.length-1;f>=0;f--){var h=l.wire.objects[f],p=l.wire.values[f];p&&(t&&h!=t||r&&p[0]!=r||i&&p[1]!=i||o&&p[6]!=o||(l.wire.objects.splice(f,1),l.wire.values.splice(f,1)))}l.alwaysList.length>0||l.list.length>0||l.wire.length>0||($e.Ticker.off("tick",l.ticker),l.ticker=null)},isUpdating:function(t){n(t)&&(t=le.zdf.stage);var r=!1,i=e.Ticker;return(i.alwaysList.at(t)||i.list&&i.list.values.at(t)&&i.list.values.at(t).length>0&&(n(i.update)&&!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)||i.update))&&(r=!0),r},has:function(t,r){return(n(r)||!r.update)&&(r=le.zdf.stage),e.Ticker.list&&e.Ticker.list.at(r)&&e.Ticker.list.at(r).indexOf(t)>=0},getFPS:function(){return $e.Ticker.getMeasuredFPS()},dispose:function(t){for(var r=e.Ticker,i=0,o,l=r.list.length-1;l>=0;l--)o=r.list.objects[l],n(t)||t===o?(r.list.remove(t),r.alwaysList.remove(t)):i+=r.list.values[l].length;if(!(r.alwaysList.length>0))return i==0&&($e.Ticker.off("tick",r.ticker),r.ticker=null),!0}},e.Ticker.setFPS(),Object.defineProperty(e.Ticker,"update",{get:function(){return e.Ticker.myUpdate},set:function(t){var r=e.Ticker;typeof t!="boolean"&&(t=null),r.myUpdate=t,r.myUpdate===!1&&(cancelAnimationFrame(r.ticker),r.alwaysList=new e.Dictionary)}}),e.Pages=function(t,r,i,o,l,f,h,p,_){var b="pages, transition, speed, transitionTable, holder, arrowDisableColor, style, group, inherit",w;if(w=mt(e.Pages,arguments,b,this))return w;qe("71"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Pages",this.group=p;var C=h===!1?{}:e.getStyle(this.type,this.group,_),O=v(i);if(n(t)&&(t=C.pages!=null?C.pages:[]),this.pages=t,n(r)&&(r=C.transition!=null?C.transition:"none"),n(i)&&(i=C.speed!=null?C.speed:O=="s"?.2:200),n(o)&&(o=C.transitionTable!=null?C.transitionTable:[]),this.transitionTable=o,n(f)&&(f=C.arrowDisableColor!=null?C.arrowDisableColor:e.grey),this.arrowDisableColor=f,n(l)&&(l=C.holder!=null?C.holder:null),n(l)&&le.zdf&&(l=le.zdf.stage),!l.getBounds||!l.getBounds()){ht("zim controls - Pages():\nholder object must have bounds set");return}this.speed=i,this.active=!0;var P=this;P.transitioning=!1;var A=l.getBounds().width,R=l.getBounds().height,T,L;(r!="none"||o!=[])&&S();function S(){T=new $e.Shape,T.graphics.f("black").r(0,0,A,R+1),L=new $e.Shape,L.graphics.f("white").r(0,0,A,R+1)}var E=["left","right","up","down"],k,X,q=!0,V;for(V=0;V<t.length;V++)k=t[V],k.constructor!={}.constructor&&(k=t[V]={page:t[V]}),k.swipe&&(q=!1);for(V=0;V<t.length;V++){if(k=t[V],k.constructor!=={}.constructor&&(k=t[V]={page:t[V]}),q){var I=t[V-1],te=t[V+1];k.swipe=[I?I.page:null,te?te.page:null]}ae(k.page,k.swipe)}var B=this.page=t[0]?t[0].page:null;n(this.page)||(this.index=0),this.addChild(B),re(B),this.swipe=new e.Swipe(l);var Z,U=!1,ee=this.swipe.on("swipe",function(G){if(P.active){var y=G.currentTarget.direction;if(y!="none"){var g="";y=="left"?g="right":y=="right"?g="left":y=="up"?g="down":y=="down"&&(g="up"),y=g;var d=E.indexOf(y);X=B.zimSwipeArray[d],Z=[X,y,null,null,!0],P.page=B,P.nextPage=X,P.direction=y,P.dispatchEvent("swipe"),setTimeout(function(){U||P.go(X,y,null,null,!0)},50)}}});function ae(G,y){n(G)||(G.zimHTMLList=new e.Dictionary,he(G),G.zimSwipeArray=y||[],G.zimOriginalAlpha=G.alpha,G.parent&&G.parent.removeChild(k.page))}function re(G){if(!n(G))for(G.removedHTML=!1,V=0;V<G.zimHTMLList.length;V++)G.addChildAt(G.zimHTMLList.values[V].obj,G.zimHTMLList.values[V].depth)}function he(G){if(!G.removedHTML){G.removedHTML=!0,G.zimHTMLList.clear();var y,g;for(g=0;g<G.numChildren;g++)if(y=G.getChildAt(g),y.type=="TextArea"||y.type=="Loader"||y.type=="Tag"){var d={obj:y,depth:G.getChildIndex(y)};G.zimHTMLList.add(y,d)}for(g=G.numChildren-1;g>=0;g--)y=G.getChildAt(g),(y.type=="TextArea"||y.type=="Loader"||y.type=="Tag")&&G.removeChild(y)}}this.addPage=function(G,y){ae(G,y),P.pages.push({page:G}),B?G.parent&&G.parent.removeChild(G):(B=P.page=G,P.addChild(B))},this.removePage=function(G){he(G),P.currentPage==G&&(P.removeChild(G),l.stage&&l.stage.update()),e.loop(P.pages,function(y,g){(y.page==G||y==G)&&P.pages.splice(g,1)},!0),G.zimSwipeArray=null},this.setSwipeArray=function(G,y){n(y)&&(y=[]);var g={page:G,swipe:y};g.page.zimSwipeArray=g.swipe?g.swipe:[]},this.pause=function(){U=!0},this.unpause=function(){U&&P.go(Z[0],Z[1],Z[2],Z[3],Z[4])};var j=!0;this.go=function(G,y,g,d,D){if(typeof G=="number"){var K=P.pages[G];if(n(K))return;G=K.page}setTimeout(function(){U=!1},200);for(var m=[{x:A},{x:-A},{y:R},{y:-R}],F=[{x:0},{x:0},{y:0},{y:0}],Ce=[{x:A/2,alpha:0},{x:-A/2,alpha:0},{y:R/2,alpha:0},{y:-R/2,alpha:0}],Y=r,Q=P.speed,ce=0;ce<P.transitionTable.length;ce++)if(P.transitionTable[ce][0]==B&&P.transitionTable[ce][1]==G){Y=P.transitionTable[ce][2],n(P.transitionTable[ce][3])||(Q=P.transitionTable[ce][3]);break}n(g)&&(g=Y),n(d)&&(d=Q),P.speed=d;function pe(Ye){Ye[0].uncache(),Ye[1].uncache(),P.transitioning=!1,P.dispatchEvent("pagetransitioned"),P.removeChild(P.lastPage),g=="fan"&&(y=="right"||y=="down"?(P.lastPage.rotation=0,P.lastPage.regY=0,P.lastPage.mov(0,-P.lastPage.height)):(P.page.rotation=0,P.page.regY=0,P.page.mov(0,-P.lastPage.height))),P.removeChild(T),P.removeChild(L),re(B),j=!0}function J(Ye){P.removeChild(P.lastPage),e.animate(Ye.shift(),{alpha:0},P.speed/2,null,pe,Ye)}if(P.direction=y,G==""||G==null)P.page=B,P.dispatchEvent("nothing");else if(typeof G=="string")P.page=B,P.dispatchEvent(G);else{if(G==B)return;n(y)&&(y="right");var ue=E.indexOf(y);if(!j)return;j=!1,G.x=0,G.y=0,G.alpha=G.zimOriginalAlpha;var ye,Xe=["pixelDark","pixelLight","pixelZIM","bubbleDark","bubbleLight","bubbleZIM","lineDark","lineLight","lineZIM"];if(Xe.indexOf(g)>=0){var se=g;ye=!0,g="slide"}var Ae=["explodeDark","explodeLight","explodeZIM"];if(Ae.indexOf(g)>=0){var ie=g;ye=!0,g="fade"}if(g.type=="Emitter"&&(ye=g,g.horizontal||g.vertical?g="slide":g="fade"),P.transitioning=!0,g=="slide"?(G.x=-(m[ue].x|0),G.y=-(m[ue].y|0),G.cache(0,0,(A+1)/G.scaleX,(R+1)/G.scaleY),B.cache(0,0,(A+1)/B.scaleX,(R+1)/B.scaleY),P.addChild(G),P.addChild(B),e.animate(B,m[ue],P.speed,null,pe,[B,G]),e.animate(G,F[ue],P.speed)):g=="reveal"?(G.cache(0,0,(A+1)/G.scaleX,(R+1)/G.scaleY),B.cache(0,0,(A+1)/B.scaleX,(R+1)/B.scaleY),P.addChild(G),P.addChild(B),e.animate(B,Ce[ue],P.speed,null,pe,[B,G])):g=="fade"?(G.cache(0,0,(A+1)/G.scaleX,(R+1)/G.scaleY),B.cache(0,0,(A+1)/B.scaleX,(R+1)/B.scaleY),G.alpha=1,P.addChild(G),P.addChild(B),e.animate(B,{alpha:0},P.speed,null,pe,[B,G])):g=="black"?(G.cache(0,0,(A+1)/G.scaleX,(R+1)/G.scaleY),B.cache(0,0,(A+1)/B.scaleX,(R+1)/B.scaleY),G.alpha=1,P.addChild(G),P.addChild(B),T.alpha=0,P.addChild(T),e.animate(T,{alpha:1},P.speed/2,null,J,[T,B,G])):g=="clear"?(G.cache(0,0,(A+1)/G.scaleX,(R+1)/G.scaleY),B.cache(0,0,(A+1)/B.scaleX,(R+1)/B.scaleY),G.alpha=0,P.addChild(G),P.addChild(B),e.animate(B,{alpha:0},P.speed/2),e.animate(G,{alpha:1},P.speed/2,null,pe,[B,G],P.speed/2)):g=="white"?(G.cache(0,0,(A+1)/G.scaleX,(R+1)/G.scaleY),B.cache(0,0,(A+1)/B.scaleX,(R+1)/B.scaleY),G.alpha=1,P.addChild(G),P.addChild(B),L.alpha=0,P.addChild(L),e.animate(L,{alpha:1},P.speed/2,null,J,[L,B,G])):g=="fan"?(G.cache(0,0,(A+1)/G.scaleX,(R+1)/G.scaleY),B.cache(0,0,(A+1)/B.scaleX,(R+1)/B.scaleY),G.alpha=1,y=="right"||y=="down"?(P.addChild(G),P.addChild(B),B.regY=B.height,B.mov(0,B.height),e.animate(B,{rotation:-90},P.speed,null,pe,[B,G])):(P.addChild(B),P.addChild(G),G.regY=B.height,G.mov(0,B.height),G.rotation=-90,e.animate(G,{rotation:0},P.speed,null,pe,[B,G]))):(P.transitioning=!1,P.addChild(G),P.removeChild(B),j=!0),ye){var _e=ue<2,$,xe;if(se||g=="slide"){se?(se=="lineDark"||se=="lineLight"?$=new e.Rectangle(_e?30:A+5,_e?R+5:30,se=="lineDark"?e.dark:e.white).alp(.2):se=="lineZIM"?$=new e.Rectangle(_e?50:A+5,_e?R+5:50,[e.green,e.yellow,e.orange,e.pink,e.blue]).alp(.5):se=="pixelDark"||se=="pixelLight"?$=new e.Rectangle(40,40,e.clear,se=="pixelDark"?e.dark:e.white,2).alp(.7):se=="pixelZIM"?$=new e.Rectangle(40,40,[e.green,e.yellow,e.orange,e.pink,e.blue]).alp(.7):se=="bubbleDark"||se=="bubbleLight"?$=new e.Circle(30,e.clear,se=="bubbleDark"?e.dark:e.white,2).alp(.7):se=="bubbleZIM"&&($=new e.Circle(30,[e.green,e.yellow,e.orange,e.pink,e.blue]).alp(.7)),$.centerReg({add:!1}),se=="lineDark"||se=="lineLight"||se=="lineZIM"?xe=new e.Emitter({obj:$,life:.5,decayTime:.5,shrink:!1,force:0,gravity:0,width:0,startPaused:!0}):xe=new e.Emitter({obj:$,num:6,life:.5,decayTime:.5,width:_e?0:A,height:_e?R:0,vertical:_e,horizontal:!_e,startPaused:!0})):xe=ye;var Be=[{x:0,y:R/2},{x:A,y:R/2},{x:A/2,y:0},{x:A/2,y:R}],me=[{x:A,y:R/2},{x:0,y:R/2},{x:A/2,y:R},{x:A/2,y:0}];xe.centerReg(l).spurt(null,P.speed),xe.x=Be[ue].x,xe.y=Be[ue].y,e.animate(xe,me[ue],P.speed,null,function(){se&&xe.dispose()})}else(ie||g=="fade")&&(ie?(ie=="explodeDark"||ie=="explodeLight"?$=new e.Circle(150,ie=="explodeDark"?e.dark:e.white).alp(.5):ie=="explodeZIM"&&($=new e.Circle(130,[e.green,e.yellow,e.orange,e.pink,e.blue]).alp(.7)),xe=new e.Emitter({obj:$,num:5,gravity:0,force:{min:20,max:40},life:.5,shrink:!1,decayTime:.5,startPaused:!0})):xe=ye,xe.centerReg(l).spurt(null,P.speed*.35),xe.on("fizzed",function(){ie&&xe.dispose()}));l&&l.type!="Stage"&&l.type!="StageGL"&&xe.particles&&l.shape&&xe.particles.setMask(l.shape)}for(l&&l.shape&&xe&&xe.particles&&xe.particles.setMask(l.shape),he(B),P.lastPage=B,P.page=G,P.index=-1,ce=0;ce<P.pages.length;ce++){var Oe=P.pages[ce].page;Oe==P.page&&(P.index=ce)}g=="none"&&re(G),n(D)&&(D=!1),P.fromSwipe=D,P.dispatchEvent("page"),B=G,P.setArrows(t.index),l.stage&&l.stage.update()}},l&&l.shape&&(l.mouseChildren=!0,l.mouseEnabled=!0,P.setMask(l.shape)),this.resize=function(){A=l.getBounds().width,R=l.getBounds().height,(r!="none"||o!=[])&&S()},this.puff=function(G){for(var y=0;y<t.length;y++)P.addChild(t[y].page);P.addChild(B),G>0&&setTimeout(function(){P.settle()},G*(O=="s"?1e3:1))},this.settle=function(){P.removeAllChildren(),P.addChild(B),P.dispatchEvent("puffed")},this.disable=function(){P.active=!1},this.enable=function(){P.active=!0},this.arrows={},this.setArrows=function(){if(!e.isEmpty(P.arrows)){var G=P.pages[P.index];if(!(!G||!G.swipe)){var y=G.swipe,g=[e.LEFT,e.RIGHT,e.DOWN,e.UP];e.loop(g,function(d,D){y[D]?e.loop(P.arrows[d],function(K){if(K.setDisabled===!0){K.activate(!1,P.arrowDisableColor),K.setDisabled=null;return}K.enabled||K.activate(!0,K.arrowBackgroundColor)}):e.loop(P.arrows[d],function(K){if(K.setDisabled===!1){K.activate(!0,K.arrowBackgroundColor),K.setDisabled=null;return}K.enabled&&K.activate(!1,P.arrowDisableColor)})}),P.stage&&P.stage.update()}}},P.added(function(G){if(G.frame&&G.frame.scaling=="full"){if(!e.globalManager){var y=e.globalManager=new e.Manager;y.frame=G.frame,y.event=G.frame.on("resize",function(){y.resize()})}e.globalManager.add(P)}}),h!==!1&&e.styleTransforms(this,C),this.dispose=function(G,y,g){if(e.globalManager){var d=e.globalManager;d.remove(P),e.globalManager.items.length==0&&(d.frame.off("resize",d.event),d.dispose(),e.globalManager=null)}return P.swipe.off("swipe",ee),P.swipe.dispose(),g||this.zimContainer_dispose(!0),!0}},e.extend(e.Pages,e.Container,["clone","dispose"],"zimContainer",!1),e.Arrow=function(t,r,i,o,l,f,h,p,_,b,w){var C="backgroundColor, rollBackgroundColor, pages, direction, type, newPage, trans, speed, style, group, inherit",O;if(O=mt(e.Arrow,arguments,C,this))return O;qe("71.2"),this.group=b;var P=_===!1?{}:e.getStyle("Arrow",this.group,w);n(o)&&(o=P.direction!=null?P.direction:"right"),n(t)&&(t=P.backgroundColor!=null?P.backgroundColor:e.blue),this.arrowBackgroundColor=t,n(r)&&(r=P.rollBackgroundColor!=null?P.rollBackgroundColor:e.blue.lighten(.2)),this.arrowRollBackgroundColor=r,n(l)&&(l=P.type!=null?P.type:"triangle"),n(f)&&(f=P.newPage!=null?P.newPage:null),n(h)&&(h=P.trans!=null?P.trans:null),n(p)&&(p=P.speed!=null?P.speed:null);var A,R,T,L,S;l=="triangle"?(A=new e.Triangle(45,45,45,t,null,null,null,null,-7).rot(90),R=new e.Triangle(45,45,45,r,null,null,null,null,-7).rot(90)):l=="thick"?(A=new e.Shape,T=A.graphics.f(t).command,S="AhFBdIiWAAIAAi4ICWAAIAAh7IEhDWIkhDXg",A.p(S).reg(-4),R=new e.Shape,L=R.graphics.f(r).command,R.p(S).reg(-4)):l=="thin"?(A=new e.Shape,T=A.graphics.f(t).command,S="AhBCIIBZhbIjWAAIAAhVIDaAAIhdhfIA9g+IDDDFIAAAAIAAAAIjDDGg",A.p(S).reg(-4),R=new e.Shape,L=R.graphics.f(r).command,R.p(S).reg(-4)):l=="angle"&&(A=new e.Shape,T=A.graphics.f(t).command,S="AiNC5IC4i5Ii4i5IAxgxIDqDqIjqDrg",A.p(S).reg(-3),R=new e.Shape,L=R.graphics.f(r).command,R.p(S).reg(-3)),this.zimButton_constructor(50,50,"",e.clear,e.clear,null,null,null,null,null,null,null,null,null,null,null,A,R),this.type="Arrow";var E=this;if(this.activate=function(V,I){return n(V)&&(V=!0),n(I)&&(I=e.grey),I===!1||(V?(E.enabled=!0,I!==!1&&(l=="triangle"?(E.icon.color=E.arrowBackgroundColor,E.rollIcon.color=E.arrowRollBackgroundColor):(T.style=E.arrowBackgroundColor,L.style=E.arrowRollBackgroundColor))):(E.enabled=!1,I!==!1&&(l=="triangle"?(E.icon.color=I,E.rollIcon.color=I):(T.style=I,L.style=I)))),E},n(i)||i.type!="Pages")return;var k=(Dt?e.ACTIONEVENT=="mousedown":le.ACTIONEVENT=="mousedown")?"mousedown":"click";n(i.arrows)&&(i.arrows={}),n(i.arrows[o])&&(i.arrows[o]=[]),i.arrows[o].push(this);var X=q();X||this.activate(!1,i.arrowDisableColor);function q(){var V=i.pages[i.index];if(!(!V||!V.page||!V.page.zimSwipeArray)){var I=V.page.zimSwipeArray;if(o=="left")return I[0];if(o=="right")return I[1];if(o=="up")return I[2];if(o=="down")return I[3]}}this.expand(),this.on(k,function(){if(!i.transitioning){var V=q();V&&i.go(V,o,h,p)}}),_!==!1&&e.styleTransforms(this,P),this.clone=function(){return E.cloneProps(new e.Arrow(t,r,i,o,l,f,h,p,_,this.group,w))}},e.extend(e.Arrow,e.Button,"clone","zimButton",!1),e.HotSpots=function(t,r,i){var o="spots, local, mouseDowns",l;if(l=mt(e.HotSpots,arguments,o,this))return l;qe("72"),this.zimContainer_constructor(null,null,null,null,!1),this.type="HotSpots",n(r)&&(r=!0),n(i)&&(i=!1);var f=(Dt?e.ACTIONEVENT=="mousedown":le.ACTIONEVENT=="mousedown")?"mousedown":"click",h=this,p,_,b=h.hotSpots=[];n(t)&&(t=[]);for(var w=0;w<t.length;w++)C(t[w]);function C(P){var A=null;if(!Array.isArray(P.rect)){if(A=P.rect,!A){ht("zim controls - HotSpots(): HotSpot "+P.page+" "+P.rect+" button does not exist");return}P.rect=[A.x,A.y,A.width||1,A.height||1]}_=new e.HotSpot(P.page,P.rect[0],P.rect[1],P.rect[2],P.rect[3],P.call,P.callOver,P.callOut,r,P.talk),_.zimHSpage=P.page,_.button=A,b.push(_),_.on(f,O),A&&n(P.callOver)&&n(P.callOut)&&(_.spot.mouseEnabled=!1,_.spot.mouseChildren=!1,A.zimHScall=P.call,A.zimHSEvent=A.on(f,O,!0),i||(A.zimHSMDEvent=A.on("mousedown",function(R){R.stopImmediatePropagation()})),A.cur("pointer"))}function O(P){P.stopImmediatePropagation&&P.stopImmediatePropagation(),le.event&&(le.event.cancelBubble=!0),typeof P.currentTarget.zimHScall=="function"&&P.currentTarget.zimHScall(P)}this.add=this.addHotSpot=function(P,A,R,T,L,S){p={page:P,rect:A,call:R,callOver:T,callOut:L,talk:S},t.push(p),C(p)},this.show=function(){for(var P=0;P<b.length;P++)_=b[P],_.button||(_.spot.alpha=.2)},this.hide=function(){for(var P=0;P<b.length;P++)_=b[P],_.spot.alpha=0},this.remove=this.removeHotSpots=function(P,A){for(var R=t.length-1;R>=0;R--)p=t[R],_=b[R],A&&!Array.isArray(A)&&(A=[A.x,A.y,A.getBounds().width,A.getBounds().height]),(n(P)&&n(A)||n(A)&&P==p.page||n(P)&&e.arraysEqual(A,p.rect)||P==p.page&&e.arraysEqual(A,p.rect))&&(t.splice(R,1),_.button&&(_.button.off(f,_.button.zimHSEvent),_.button.zimHSEvent=null,i||(_.button.off("mousedown",_.button.zimHSMDEvent),_.button.zimHSMDEvent=null)),_.off(f,O),_.dispose(),b.splice(R,1))},this.dispose=function(){for(var P=0;P<b.length;P++)_=b[P],_.button&&(_.button.off(f,_.button.zimHSEvent),_.button.zimHSCall=null,_.button.zimHSEvent=null,i||(_.button.off("mousedown",_.button.zimHSMDEvent),_.button.zimHSMDEvent=null)),_.off(f,O),_.dispose();return!0}},e.extend(e.HotSpots,e.Container,"dispose","zimContainer",!1),e.HotSpot=function(t,r,i,o,l,f,h,p,_,b){var w="obj, x, y, width, height, call, callOver, callOut, local, talk",C;if(C=mt(e.HotSpot,arguments,w,this))return C;if(qe("73"),this.zimContainer_constructor(null,null,null,null,!1),this.type="HotSpot",n(t)||!t.addChild){ht("zim controls - HotSpot():\nPlease pass in container object for obj");return}if(!(t instanceof $e.Container)){ht("zim controls - HotSpot():\nObjects passed in should be Containers");return}if(n(r)||n(i)||n(o)||n(l)){ht("zim controls - HotSpot():\nPlease pass in x, y, width, height");return}n(_)&&(_=!0);var O=(Dt?e.ACTIONEVENT=="mousedown":le.ACTIONEVENT=="mousedown")?"mousedown":"click",P=o,A=l,R,T,L;if(_)R=new e.Point(r,i),T=o,L=l;else{R=t.globalToLocal(r,i);var S=t.globalToLocal(r+P,i+A);T=S.x-R.x,L=S.y-R.y}var E=new e.Shape(o,l);if(E.talk=n(b)?"HotSpot":b,E.alpha=0,E.graphics.f("black").dr(0,0,T,L),E.x=R.x,E.y=R.y,E.cur("pointer"),E.expand(0),this.spot=E,typeof f=="function")var k=E.on(O,function(V){f(V)});if(typeof h=="function")var X=E.on("mouseover",function(V){h(V)});if(typeof p=="function")var q=E.on("mouseout",function(V){p(V)});t.addChild(E),this.show=function(){E.alpha=.5,t.stage&&t.stage.update()},this.hide=function(){E.alpha=0,t.stage&&t.stage.update()},this.dispose=function(){return k&&E.off(O,X),X&&E.off("mouseover",X),q&&E.off("mouseout",q),t.removeChild(E),E=null,!0}},e.extend(e.HotSpot,e.Container,"dispose","zimContainer",!1),e.Guide=function(t,r,i,o,l,f,h,p){var _="obj, vertical, pixels, hideKey, pixelKey, style, group, inherit",b;if(b=mt(e.Guide,arguments,_,this))return b;qe("76"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Guide",this.group=h;var w=f===!1?{}:e.getStyle(this.type,this.group,p);if(n(t)&&(le.zdf?t=le.zdf.stage:t="stage"),n(r)&&(r=w.vertical!=null?w.vertical:!0),t!="stage"&&(!t.addChild||!t.getBounds||!t.getBounds())){Hn("zim controls - Guide(): Please provide container with bounds for the obj (setBounds())");return}n(i)&&(i=w.pixels!=null?w.pixels:!(zdf&&zdf.scaling=="full")),n(o)&&(o=w.hideKey!=null?w.hideKey:"G"),n(l)&&(l=w.pixelKey!=null?w.pixelKey:"P");var C=this,O,P=80,A=26,R=P/6+P/2,T=A*2,L,S,E;r?(E=k("#00c5af","white","white"),E.shape.regX=P+P/6,E.shape.regY=A/2,E.label.x=-P/2-P/6):(E=k("#d61fa0","white","white"),E.shape.regX=P/2,E.shape.regY=A+A/4,E.label.y=-A*3/4);function k(j,G,y){var g=new e.Container({style:!1});return g.shape=new e.Shape,g.shape.graphics.s(G).ss(1).f(j).r(0,0,P,A),g.shape.alpha=.9,g.addChild(g.shape),g.label=new $e.Text("10","16px arial",y),g.label.textAlign="center",g.label.textBaseline="middle",g.addChild(g.label),g.mouseChildren=!1,g.mouseEnabled=!1,g}var X;t!="stage"&&t.addChild(C);var q=e.added(C,U),V=!1,I,te,B,Z;function U(){if(t=="stage"?(X=C.stage,t=X):X=t.stage,X.frame&&X.frame.scaling=="full"){if(!e.globalManager){var j=e.globalManager=new e.Manager;j.frame=X.frame,j.event=X.frame.on("resize",function(){j.resize()})}e.globalManager.add(C)}t.addChild(C),I=t.getBounds().width,te=t.getBounds().height,r?(E.y=te/2,E.label.text="x:"+(C.pixels?Math.round(I*70/100):"70%")):(E.x=I/2,E.label.text="y:"+(C.pixels?Math.round(te*70/100):"70%")),B=new e.Shape,C.addChild(B),r?B.x=I*.7:B.y=te*.7,V||(t.addChild(C),re()),X.off("stagemousemove",O),O=X.on("stagemousemove",ae),X.update()}var ee={x:0,y:0};function ae(j){var G,y;j?(G=t.globalToLocal(j.rawX/e.scaX,j.rawY/e.scaY),ee=G):G={x:ee.x,y:ee.y},i?r?(y=Math.round(Math.abs(G.x-B.x)),E.label.text="x:"+Math.max(0,Math.min(y,Math.round(I))),E.y=Math.max(T,Math.min(G.y,S))):(y=Math.round(Math.abs(G.y-B.y)),E.label.text="y:"+Math.max(0,Math.min(y,Math.round(te))),E.x=Math.max(R,Math.min(G.x,L))):r?(y=Math.round(Math.abs(G.x-B.x)/I*100),E.label.text="x:"+Math.max(0,Math.min(y,100))+"%",E.y=Math.max(T,Math.min(G.y,S))):(y=Math.round(Math.abs(G.y-B.y)/te*100),E.label.text="y:"+Math.max(0,Math.min(y,100))+"%",E.x=Math.max(R,Math.min(G.x,L))),X&&X.update()}function re(){V=!0,I=t.getBounds().width,te=t.getBounds().height;var j;r?(j="ew-resize",Z=new $e.Rectangle(0,0,I,0)):(j="ns-resize",Z=new $e.Rectangle(0,0,0,te)),e.noDrag(B),setTimeout(function(){e.drag(B,Z,null,j,j,null,null,!0)},500),X.mouseMoveOutside=!0,X.enableMouseOver(10),L=I-P*2/3,S=te-A-A,B.uncache();var G=B.graphics;r?(G.c().s("rgba(0,255,255,.1)").ss(20).mt(0,0).lt(0,te),G.f().s("white").ss(2).mt(0,0).lt(0,te),G.s("#00c5af").sd([20,20]).mt(0,0).lt(0,te).sd(),B.cache(-10,0,20,te)):(G.c().s("rgba(255,0,255,.1)").ss(20).mt(0,0).lt(I,0),G.f().s("white").ss(2).mt(0,0).lt(I,0),G.s("#d61fa0").sd([20,20]).mt(0,0).lt(I,0).sd(),B.cache(0,-10,I,20)),r?E.x=I:E.y=te,C.addChild(E)}Object.defineProperty(this,"pixels",{get:function(){return i},set:function(j){i=j,C.resize()}}),le.addEventListener("keydown",he);function he(j){j||(j=event),X&&(String.fromCharCode(j.keyCode)==o.toUpperCase()&&C.toggle(),String.fromCharCode(j.keyCode)==l.toUpperCase()&&(C.pixels=!C.pixels))}this.toggled=!0,this.toggle=function(j){return j===!0?C.visible=C.toggled=!0:j===!1?C.visible=C.toggled=!1:(C.visible=!C.visible,C.toggled=C.visible),X&&(X.off("stagemousemove",O),C.visible&&(O=X.on("stagemousemove",ae,C)),X.update()),C},this.resize=function(){return C?(X&&(re(),ae()),!0):!1},f!==!1&&e.styleTransforms(this,w),this.dispose=function(){if(!C)return!1;if(e.globalManager){var j=e.globalManager;j.remove(C),e.globalManager.items.length==0&&(j.frame.off("resize",j.event),j.dispose(),e.globalManager=null)}return e.noDrag(B),clearInterval(q),C.removeAllChildren(),le.removeEventListener("keydown",he),C.parent&&C.parent.removeChild(C),C=null,!0}},e.extend(e.Guide,e.Container,"clone","zimContainer",!1),e.Grid=function(t,r,i,o,l,f,h,p,_,b,w){var C="obj, color, pixels, hideKey, pixelKey, allowToggle, cache, numbers, style, group, inherit",O;if(O=mt(e.Grid,arguments,C,this))return O;qe("78"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Grid",this.group=b;var P=_===!1?{}:e.getStyle(this.type,this.group,w);if(n(t)&&(le.zdf?t=le.zdf.stage:t="stage"),n(r)&&(r=P.color!=null?P.color:e.black),t!="stage"&&(!t.addChild||!t.getBounds||!t.getBounds())){Hn("zim controls - Grid(): Please provide container with bounds for the obj (setBounds())");return}n(i)&&(i=P.pixels!=null?P.pixels:!(zdf&&zdf.scaling=="full")),n(o)&&(o=P.hideKey!=null?P.hideKey:"G"),n(l)&&(l=P.pixelKey!=null?P.pixelKey:"P"),n(f)&&(f=P.allowToggle!=null?P.allowToggle:!0),n(h)&&(h=P.cache!=null?P.cache:!0),n(p)&&(p=P.numbers!=null?P.numbers:!0);var A=this,R=10,T;this.mouseChildren=!1,this.mouseEnabled=!1;var L=80,S=26,E=A.numbersX=X("#dddddd",r,"#333333");E.shape.regX=L/2,E.shape.regY=-S/4,E.label.y=S*3/4;var k=A.numbersY=X("#dddddd",r,"#333333");k.shape.regX=-L/6,k.shape.regY=S/2,k.label.x=L/2+L/6,p||(E.visible=!1,k.visible=!1);function X(d,D,K){var m=new e.Container({style:!1});return m.shape=new $e.Shape,m.shape.graphics.s(D).ss(1).f(d).r(0,0,L,S),m.shape.alpha=.9,m.addChild(m.shape),m.label=new $e.Text("10","16px arial",K),m.label.textAlign="center",m.label.textBaseline="middle",m.addChild(m.label),m.mouseChildren=!1,m.mouseEnabled=!1,m}var q=L/6+L/2,V=S*2,I,te;E.x=q,k.y=V,E.label.text="x:0",k.label.text="y:0";var B;t!="stage"&&t.addChild(A);var Z=e.added(A,ee),U=!1;function ee(){if(t=="stage"?(B=A.stage,t=B):B=t.stage,B.frame&&B.frame.scaling=="full"){if(!e.globalManager){var d=e.globalManager=new e.Manager;d.frame=B.frame,d.event=B.frame.on("resize",function(){d.resize()})}e.globalManager.add(A)}U||(y(),t.addChild(A)),B.off("stagemousemove",T),T=B.on("stagemousemove",re),B.update()}var ae={x:0,y:0};function re(d){var D;d?(D=t.globalToLocal(d.rawX/e.scaX,d.rawY/e.scaY),ae=D):D={x:ae.x,y:ae.y},i?(E.label.text="x:"+Math.max(0,Math.min(Math.round(D.x),Math.round(he))),E.x=Math.max(q,Math.min(D.x,I)),k.label.text="y:"+Math.max(0,Math.min(Math.round(D.y),Math.round(j))),k.y=Math.max(V,Math.min(D.y,te))):(E.label.text="x:"+Math.max(0,Math.min(Math.round(D.x/he*100),100))+"%",E.x=Math.max(q,Math.min(D.x,I)),k.label.text="y:"+Math.max(0,Math.min(Math.round(D.y/j*100),100))+"%",k.y=Math.max(V,Math.min(D.y,te))),B&&B.update()}var he,j,G;function y(){U=!0,t&&t.getBounds&&(he=t.getBounds().width,j=t.getBounds().height),B&&(B.mouseMoveOutside=!0,B.enableMouseOver(10)),I=he-L*2/3,te=j-S-S,G=A.grid=new e.Container({style:!1}),A.addChild(G);var d=new $e.Shape;G.addChild(d);var D=d.graphics;D.s(r).ss(1);var K=new $e.Shape;G.addChild(K);var m;if(i){for(m=0;m<he/R;m++)D.mt(m*R,0).lt(m*R,j);for(m=0;m<j/R;m++)D.mt(0,m*R).lt(he,m*R);for(d.alpha=.3,D=K.graphics,D.s(r).ss(1),m=0;m<he/(R*10);m++)D.mt(m*(R*10),0).lt(m*(R*10),j);for(m=0;m<j/(R*10);m++)D.mt(0,m*(R*10)).lt(he,m*(R*10))}else{for(m=1;m<20+1;m++)D.mt(m*he/20,0).lt(m*he/20,j);for(m=1;m<20;m++)D.mt(0,m*j/20).lt(he,m*j/20);for(d.alpha=.3,D=K.graphics,D.s(r).ss(1),m=1;m<10;m++)D.mt(m*he/10,0).lt(m*he/10,j);for(m=1;m<10;m++)D.mt(0,m*j/10).lt(he,m*j/10)}var F=80;D.s("#FFFFFF").ss(8),D.mt(he/2,j/2-F/2).lt(he/2,j/2+F/2),D.mt(he/2-F/2,j/2).lt(he/2+F/2,j/2),D.s("#000000").ss(4),D.mt(he/2,j/2-F/2).lt(he/2,j/2+F/2),D.mt(he/2-F/2,j/2).lt(he/2+F/2,j/2),D.s(r).ss(h?3:2),D.dr(0,0,he,j),K.alpha=.5,h&&G.cache(0,0,he,j),A.addChild(E),A.addChild(k),B&&B.update()}Object.defineProperty(this,"pixels",{get:function(){return i},set:function(d){i=d,A.resize()}}),le.addEventListener("keydown",g);function g(d){d||(d=event),!(!B||!f)&&(String.fromCharCode(d.keyCode)==o.toUpperCase()&&A.toggle(),String.fromCharCode(d.keyCode)==l.toUpperCase()&&(A.removeChild(G),G=null,A.pixels=!A.pixels))}this.toggled=!0,this.toggle=function(d){return d===!0?A.visible=A.toggled=!0:d===!1?A.visible=A.toggled=!1:(A.visible=!A.visible,A.toggled=A.visible),B.off("stagemousemove",T),A.visible&&(T=B.on("stagemousemove",re,A)),B&&B.update(),A},this.resize=function(){return A?(A.removeChild(G),G=null,B&&(y(),re(),setTimeout(function(){A&&A.removeChild(G),G=null,y()},200)),!0):!1},_!==!1&&e.styleTransforms(this,P),this.dispose=function(){if(e.globalManager){var d=e.globalManager;d.remove(A),e.globalManager.items.length==0&&(d.frame.off("resize",d.event),d.dispose(),e.globalManager=null)}return clearInterval(Z),A.removeAllChildren(),le.removeEventListener("keydown",g),A.parent&&A.parent.removeChild(A),A=null,!0}},e.extend(e.Grid,e.Container,"clone","zimContainer",!1),e.Wrapper=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V){var I="items, width, spacingH, spacingV, wrapperType, align, valign, alignInner, valignInner, flip, reverse, bottomFull, colSize, rowSize, height, minSpreadNum, minStretchNum, percentVoidH, offsetVoidH, percentVoidV, offsetVoidV, style, group, inherit",te=null;if(te=mt(e.Wrapper,arguments,I,this))return te;qe("78.5"),this.group=q;var B=X===!1?{}:e.getStyle("Wrapper",this.group,V);n(r)&&(r=B.width!=null?B.width:300),n(A)&&(A=B.height!=null?B.height:null),n(i)&&(i=B.spacingH!=null?B.spacingH:null),n(o)&&(o=B.spacingV!=null?B.spacingV:null),n(l)&&(l=B.wrapperType!=null?B.wrapperType:"spacing"),n(f)&&(f=B.align!=null?B.align:"left"),n(h)&&(h=B.valign!=null?B.valign:"top"),n(p)&&(p=B.alignInner!=null?B.alignInner:"left"),n(_)&&(_=B.valignInner!=null?B.valignInner:"bottom"),n(b)&&(b=B.flip!=null?B.flip:!1),n(w)&&(w=B.reverse!=null?B.reverse:!1),n(C)&&(C=B.bottomFull!=null?B.bottomFull:!1),n(O)&&(O=B.colSize!=null?B.colSize:100),n(P)&&(P=B.rowSize!=null?B.rowSize:null),n(i)&&(i=0),n(o)&&(o=0),n(R)&&(R=B.minSpreadNum!=null?B.minSpreadNum:2),n(T)&&(T=B.minStretchNum!=null?B.minStretchNum:3),n(L)&&(L=B.percentVoidH!=null?B.percentVoidH:0),n(S)&&(S=B.offsetVoidH!=null?B.offsetVoidH:0),n(E)&&(E=B.percentVoidV!=null?B.percentVoidV:0),n(k)&&(k=B.offsetVoidV!=null?B.offsetVoidV:0);var Z=200,U=0,ee=0,ae=0,re=r;this.items=[];var he,j;l=="spread"?he=!0:l=="stretch"&&(j=!0),this.zimContainer_constructor(r,Z),this.type="Wrapper",f=="middle"&&(f="center"),h=="middle"&&(h="center"),p=="middle"&&(p="center"),_=="middle"&&(_="center");var G=this;this.add=function(g){return this.addAt(g,this.numChildren-1),G},this.addAt=function(g,d){return n(g)||((n(d)||d<0)&&(d=0),Array.isArray(g)||(g=[g]),e.loop(g,function(D,K){G.addChildAt(D,d+K)}),G.resize()),G},this.remove=function(g){return Array.isArray(g)||(g=[g]),e.loop(g,function(d){d&&d.removeFrom&&d.removeFrom()},!0),G.resize(),G},this.convert=function(g,d){var D=[];return g.loop(function(K){D.push(K),d&&K.cache()}),G.add(D),g.removeFrom(),G},this.resize=function(g,d){if(!G.preventResize){n(g)||(r=g),n(d)||(A=d),this.items2D=[],this.items=[],U=0,ee=0,ae=0,n(L)&&(L=0),n(S)&&(S=0);var D=e.Pick.choose(L),K=e.Pick.choose(S);re=r*(100-D)/100,this.setBounds(re,Z);var m=0,F=0,Ce=0;G.cols=0,G.rows=0;var Y=[],Q=[0],ce=null,pe=0,J=null,ue=e.Pick.choose(O);l!="column"&&(ue=null);var ye=e.Pick.choose(P),Xe=0,se,Ae;e.loop(this,function(Ye,de){C||b?Ye.pos(m+(Ye.marginRight?Ye.marginRight:0),F+(Ye.marginTop?Ye.marginTop:0),e.RIGHT,b?e.TOP:e.BOTTOM):Ye.pos(m+(Ye.marginLeft?Ye.marginLeft:0),F+(Ye.marginTop?Ye.marginTop:0)),Xe++,J=Ye.boundsToGlobal();var ve=G.globalToLocal(J.x,J.y),Me=G.globalToLocal(J.x+J.width,J.y+J.height);if(C||b?se=G.globalToLocal(J.x,J.y):se=G.globalToLocal(J.x+J.width,J.y+J.height),Ye.wrapHeight=Me.y-ve.y,Ye.wrapWidth=Me.x-ve.x,D){var we=G.globalToLocal(J.x+Ye.wrapWidth/2,J.y+Ye.wrapHeight/2);Ye.centerX=we.x,Ye.centerY=we.y,we=null}ue?Ae=ue*Xe:C||b?Ae=re-se.x+(Ye.marginLeft?Ye.marginLeft:0)+i:Ae=se.x+(Ye.marginRight?Ye.marginRight:0)+i,Math.round(Ae)-i>re&&(y(Y,ce,Ce,pe,ue,D,K,!1),pe=0,G.cols==0&&(G.cols=de),m=0,F+=Ce+(ye?0:e.Pick.choose(o)),Ce=0,ye=e.Pick.choose(P),D=e.Pick.choose(L),K=e.Pick.choose(S),Xe=0,G.items2D.push(e.copy(Y)),G.rows++,Q.push(F),Y=[],C||b?Ye.pos(m+(Ye.marginRight?Ye.marginRight:0),F+(Ye.marginTop?Ye.marginTop:0),e.RIGHT,b?e.TOP:e.BOTTOM):Ye.pos(m+(Ye.marginLeft?Ye.marginLeft:0),F+(Ye.marginTop?Ye.marginTop:0)),D&&(J=Ye.boundsToGlobal(),we=G.globalToLocal(J.x+Ye.wrapWidth/2,J.y+Ye.wrapHeight/2),Ye.centerX=we.x,Ye.centerY=we.y,we=null),Xe++,ue?Ae=0:(Ae=(Ye.marginLeft?Ye.marginLeft:0)+Ye.wrapWidth+(Ye.marginRight?Ye.marginRight:0)+e.Pick.choose(i),C||b?se.x=re-((Ye.marginRight?Ye.marginRight:0)+Ye.wrapWidth):se.x=(Ye.marginLeft?Ye.marginLeft:0)+Ye.wrapWidth)),Y.push(Ye),pe+=Ye.wrapWidth,m=Ae,ye?Ce=ye:Ce=Math.max(Ce,Ye.wrapHeight+(Ye.marginTop?Ye.marginTop:0)+(Ye.marginBottom?Ye.marginBottom:0)),ce=new e.Point(se.x,F+Ce)},w&&C?!1:w||C),G.numChildren>0&&(G.cols==0&&(G.cols=G.numChildren),G.items2D.push(e.copy(Y)),Q.push(F),y(Y,ce,Ce,pe,ue,D,K,!0),G.rows+=1);var ie=e.Pick.choose(h),_e;n(ie)&&(ie="top"),C&&(_e=F+Ce-Z,e.loop(this,function(Ye){Ye.mov(0,_e)}),G.items2D.reverse(),e.loop(G.items2D,function(Ye){Ye.reverse()}));var $=e.Pick.choose(E),xe=e.Pick.choose(k);if(!n($)){n(xe)&&(xe=0);var Be=F+Ce,me=Be*$/100,Oe=Be/2+xe/100*Be;e.loop(Q,function(Ye,de){if(Ye>=Oe)return e.loop(G.items2D,function(ve){e.loop(ve,function(Me){Me.mov(0,me)})},null,1,de),"break"})}return n(A)||(h=="bottom"?(_e=A-(F+Ce),e.loop(this,function(Ye){Ye.mov(0,_e)})):(h=="center"||h=="middle")&&(_e=(A-(F+Ce))/2,e.loop(this,function(Ye){Ye.mov(0,_e)}))),G.setBounds(null),J=G.getBounds(),J&&G.setBounds(0,J.y,r,J.height),e.loop(G.items2D,function(Ye){e.loop(Ye,function(de){G.items.push(de)})}),this.stage&&this.stage.update(),G}};function y(g,d,D,K,m,F,Ce,Y){var Q=e.Pick.choose(f),ce=e.Pick.choose(he),pe=e.Pick.choose(j),J=e.Pick.choose(b),ue=e.Pick.choose(p),ye=e.Pick.choose(_);n(Q)&&(Q="left"),n(ye)&&(ye="top"),n(ue)&&(ue="left"),J&&g.reverse();var Xe=((100-F)/100/2+Ce/100)*r,se=r*F/100,Ae=0,ie=!1,_e,$;if(m){(C||b)&&g.reverse();var xe=re%m,Be=re/2+Ce/100*re,me=0,Oe=0,Ye=Math.floor(re/m);G.rows!=0&&Y&&(ie=!0),e.loop(g,function(Fe,ge){Ae=0,ue=="right"?Oe=m*ge+me+m-Fe.wrapWidth:ue=="center"||ue=="middle"?Oe=m*ge+me+(m-Fe.wrapWidth)/2:Oe=m*ge+me,_e=Fe.x,Fe.pos(Oe),$=Fe.x-_e,Fe.centerX+=$,Fe.marginLeft&&(Ae+=Fe.marginLeft),Fe.marginRight&&(Ae-=Fe.marginRight);var Ve;Q=="center"||Q=="middle"?(Ve=Math.floor(re/m)-g.length,Ae+=(xe+(Ve?Ve*m:0))/2):Q=="right"&&(Ve=Math.floor(re/m)-g.length,Ae+=xe+(Ve?Ve*m:0)),Fe.mov(Ae),Fe.centerX+=Ae}),Q=="center"&&ie&&(g.length+Ye)%2!=0&&(Ae=(Be<=re/2?-1:1)*m/2,e.loop(g,function(Fe){Fe.mov(Ae),Fe.centerX+=Ae}))}else if(ce||pe){var de,ve;ce?de=g.length?(re-K)/(g.length+1):0:pe&&(de=g.length-1>0?(re-K)/(g.length-1):0),g.length<T&&G.rows!=0&&Y&&(de=ae,ie=!0),ae=de;var Me=0;if((C||b)&&g.reverse(),e.loop(g,function(Fe,ge){Ae=0,_e=Fe.x,Fe.pos(de*(ge+(ce?1:0))+Me),$=Fe.x-_e,Fe.centerX+=$,ie||(Fe.marginLeft&&(Ae+=Fe.marginLeft),Fe.marginRight&&(Ae-=Fe.marginRight),Fe.mov(Ae),Fe.centerX+=Ae),Me+=Fe.wrapWidth}),ie){Ae=0;var we=ce?de:0;$=0,e.loop(g,function(Fe){if(Q=="right")_e=Fe.x,Fe.pos(we,null,e.RIGHT),$=Fe.x-_e,we+=Fe.wrapWidth+de;else if(Q=="center"){var ge=(re-(Me+(g.length-1)*de))/2-(ce?de:0);_e=Fe.x,Fe.pos(we+ge,null,e.RIGHT),$=Fe.x-_e,we+=Fe.wrapWidth+de}Fe.marginLeft&&(Ae+=Fe.marginLeft),Fe.marginRight&&(Ae-=Fe.marginRight),Fe.mov(Ae),Fe.centerX+=$+Ae},!0)}}else Q=="center"?e.loop(g,function(Fe){Ae=((C||b?0:r)-d.x)/2,(ce||pe)&&(Fe.marginLeft&&(Ae+=Fe.marginLeft),Fe.marginRight&&(Ae-=Fe.marginRight)),Fe.mov(Ae),Fe.centerX+=Ae}):(C||b)&&Q=="left"?(ve=g[g.length-1].marginLeft,e.loop(g,function(Fe){Ae=-d.x+(ve||0),ce&&(Ae+=ee),Fe.mov(Ae),Fe.centerX+=Ae})):!(C||b)&&Q=="right"?(ve=g[g.length-1].marginRight,e.loop(g,function(Fe){Ae=r-d.x-(ve||0),ce&&(Ae-=ee),Fe.mov(Ae),Fe.centerX+=Ae})):ce&&ce&&e.loop(g,function(Fe){Ae=ee*(Q=="right"?-1:1),Fe.mov(Ae),Fe.centerX+=Ae});F&&(Xe=(1/2+Ce/100)*re,se=r*F/100,e.loop(g,function(Fe){m||pe||ce?Q=="right"?Fe.centerX>re-Xe&&Fe.mov(se):Q=="center"?Math.round(Fe.centerX)==Math.round(re/2+Ce/100*re)?Fe.mov(se/2):Math.round(Fe.centerX)>Math.round(re/2+Ce/100*re)&&Fe.mov(se):Fe.centerX>Xe&&Fe.mov(se):!(C||b)&&Q=="right"?Fe.centerX<r-Xe&&Fe.mov(-se):!(C||b)&&Q=="center"?Fe.centerX>r/2+Ce/100*re?Fe.mov(se/2):Fe.mov(-se/2):(C||b)&&Q=="right"?Fe.centerX>re-Xe&&Fe.mov(se):(C||b)&&Q=="center"?Fe.centerX>re/2+Ce/100*re&&Fe.mov(se):Fe.centerX>Xe&&Fe.mov(se)})),ce&&(U+=de,ee=U/(G.rows+1)),ye=="center"?e.loop(g,function(Fe){Fe.mov(0,(D-Fe.wrapHeight)/2*(C?-1:1))}):!C&&ye=="bottom"?e.loop(g,function(Fe){Fe.mov(0,D-Fe.wrapHeight-(Fe.marginBottom?Fe.marginBottom:0))}):C&&ye=="top"&&e.loop(g,function(Fe){Fe.mov(0,-(D-Fe.wrapHeight)+(Fe.marginTop?Fe.marginTop:0))})}Object.defineProperty(G,"spacingH",{get:function(){return i},set:function(g){i=g,this.resize()}}),Object.defineProperty(G,"spacingV",{get:function(){return o},set:function(g){o=g,this.resize()}}),Object.defineProperty(G,"wrapperType",{get:function(){return l},set:function(g){g=="spread"?he=!0:he=!1,g=="stretch"?j=!0:j=!1,l=g,this.resize()}}),Object.defineProperty(G,"align",{get:function(){return f},set:function(g){f=g,f=="middle"&&(f="center"),this.resize()}}),Object.defineProperty(G,"valign",{get:function(){return h},set:function(g){h=g,h=="middle"&&(h="center"),this.resize()}}),Object.defineProperty(G,"alignInner",{get:function(){return p},set:function(g){p=g,p=="middle"&&(p="center"),this.resize()}}),Object.defineProperty(G,"valignInner",{get:function(){return _},set:function(g){_=g,_=="middle"&&(_="center"),this.resize()}}),Object.defineProperty(G,"colSize",{get:function(){return O},set:function(g){O=g,l=="column"&&this.resize()}}),Object.defineProperty(G,"rowSize",{get:function(){return P},set:function(g){P=g,this.resize()}}),Object.defineProperty(G,"flip",{get:function(){return b},set:function(g){b=g,this.resize()}}),Object.defineProperty(G,"reverse",{get:function(){return w},set:function(g){w=g,this.resize()}}),Object.defineProperty(G,"bottomFull",{get:function(){return C},set:function(g){C=g,this.resize()}}),Object.defineProperty(G,"percentVoidH",{get:function(){return L},set:function(g){L=g,this.resize()}}),Object.defineProperty(G,"offsetVoidH",{get:function(){return S},set:function(g){S=g,this.resize()}}),Object.defineProperty(G,"percentVoidV",{get:function(){return E},set:function(g){E=g,this.resize()}}),Object.defineProperty(G,"offsetVoidV",{get:function(){return k},set:function(g){k=g,this.resize()}}),n(t)||G.add(t),X!==!1&&e.styleTransforms(this,B),this.clone=function(){var g=G.cloneProps(new e.Wrapper(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,this.style,this.group));return g}},e.extend(e.Wrapper,e.Container,"clone","zimContainer",!1),e.Tile=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B,Z,U,ee,ae,re,he,j){var G="obj, cols, rows, spacingH, spacingV, unique, width, height, squeezeH, squeezeV, colSize, rowSize, align, valign, count, mirrorH, mirrorV, snapToPixel, clone, events, exact, scaleToH, scaleToV, scaleToType, backgroundColor, backing, backdropColor, backdropPadding, backdropPaddingH, backdropPaddingV, mat, style, group, inherit",y;if(y=mt(e.Tile,arguments,G,this))return y;qe("66.5"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Tile",this.group=he;var g=re===!1?{}:e.getStyle(this.type,this.group,j);n(t)&&(t=g.obj!=null?g.obj:new e.Circle),n(r)&&(r=g.cols!=null?g.cols:1121),n(i)&&(i=g.rows!=null?g.rows:1121);var d;r==1121&&i==1121?r=i=d=3:r==1121?r=1:i==1121&&(i=1),n(f)&&(f=g.unique!=null?g.unique:!1),n(h)&&(h=g.width!=null?g.width:null),n(p)&&(p=g.height!=null?g.height:null),n(w)&&(w=g.colSize!=null?g.colSize:null),n(C)&&(C=g.rowSize!=null?g.rowSize:null),n(h)||(w=null),n(p)||(C=null),n(o)&&(o=g.spacingH!=null?g.spacingH:d?3:null),n(l)&&(l=g.spacingV!=null?g.spacingV:d?3:null);var D=o,K=l;(n(o)||!n(w)||!n(h))&&(o=0),(n(l)||!n(C)||!n(p))&&(l=0),n(_)&&(_=g.squeezeH!=null?g.squeezeH:!1),n(b)&&(b=g.squeezeV!=null?g.squeezeV:!1),n(O)&&(O=g.align!=null?g.align:"left"),n(P)&&(P=g.valign!=null?g.valign:"top"),n(A)&&(A=g.count!=null?g.count:f&&Array.isArray(t)?t.length:null),A===0&&(A=null,Ct&&ht("ZIM Tile() - count parameter of 0 is ignored - see docs")),n(R)&&(R=g.mirrorH!=null?g.mirrorH:!1),n(T)&&(T=g.mirrorV!=null?g.mirrorV:!1),n(L)&&(L=g.snapToPixel!=null?g.snapToPixel:!0),L&&(t&&t.stage?t.stage.snapToPixelEnabled=!0:typeof elem<"u"&&le.zdf&&(le.zdf.stage.snapToPixelEnabled=!0)),n(S)&&(S=g.clone!=null?g.clone:f?!1:null),S==null&&(S=!(typeof t=="function"&&t.type!="series")),n(E)&&(E=g.events!=null?g.events:!0),n(X)&&(X=g.scaleToH!=null?g.scaleToH:null),n(q)&&(q=g.scaleToV!=null?g.scaleToV:null),n(V)&&(V=g.scaleToType!=null?g.scaleToType:null),n(I)&&(I=g.backgroundColor!=null?g.backgroundColor:null),n(te)&&(te=g.backing!=null?g.backing:null),n(B)&&(B=g.backdropColor!=null?g.backdropColor:null),n(Z)&&(Z=g.backdropPadding!=null?g.backdropPadding:null),n(U)&&(U=g.backdropPaddingH!=null?g.backdropPaddingH:n(B)?null:Z||o),n(ee)&&(ee=g.backdropPaddingV!=null?g.backdropPaddingV:n(B)?null:Z||l),(ee||U)&&(Z=!0),n(ae)&&(ae=g.mat!=null?g.mat:!1);var m=this;m.cols=r=Math.round(r),m.rows=i=Math.round(i),m.spacingH=o,m.spacingV=l,m.squeezeH=_,m.squeezeV=b;var F=typeof O=="function",Ce=typeof P=="function";m.align=F?"left":O,m.valign=Ce?"top":P,m.mirrorH=R,m.mirrorV=T,m.items=[];var Y,Q=0,ce=!1;e:for(var pe=0;pe<i;pe++)for(var J=0;J<r;J++){if(Q++,!n(A)&&Q>A)break e;Y=f?t[Q-1]:e.Pick.choose(t),typeof Y=="string"&&(Y=le.asset(Y).centerReg({add:!1}).clone()),n(Y)&&(Y=new e.Container(0,0,0,0)),S&&(pe!=0||J!=0)&&(Y=Y.clone(k)),E&&Y.on("change",function(be){var ze=new $e.Event("change");ze.item=be.currentTarget,m.dispatchEvent(ze)}),m.items.push(Y),Y.type=="AC"&&(ce=!0),Y.tileNum=Q-1,Y.tileCol=J,Y.tileRow=pe}ce&&Ct&&ht("ZIM Tile - assets must have dimensions for Tile");var ue,ye,Xe,se,Ae,ie,_e,$,xe,Be,me,Oe,Ye,de;function ve(){m.removeAllChildren(),ue=[],ye=[],Xe=[],se=[],Ae=[],ie=0,_e=0,$=0,xe=0,Be=[],me=[],Oe=[],de=[],Ye=[],(!m.items||!m.items.length)&&(m.items=[]),A=m.items.length;var be=0,ze,it,je=0,tt=0,Te,et;for(it=0;it<A;it++)je=Math.floor(it/m.cols),tt=it%m.cols,n(ue[je])&&(ue[je]=[]),n(m.items[it])&&(m.items[it]=new e.Container(0,0,0,0)),ue[je][tt]=m.items[it];m.rows=Math.max(1,ue.length),m.cols=Math.max(1,n(ue[0])?0:ue[0].length);e:for(je=0;je<m.rows;je++)for(Be.push([]),me.push([]),de.push([]),C&&n(p)&&(Te=e.Pick.choose(C)),it=0;it<m.cols;it++){if(be++,!n(A)&&be>A)break e;ze=ue[je][it],ze.snapToPixel=L,m.addChild(ze),Be[je].push(ze.scaleX),me[je].push(ze.scaleY),w&&n(h)&&(et=e.Pick.choose(w)),je==0&&Ye.push(e.Pick.choose(O)),(!w||!n(h))&&(et=Math.abs(ze.width)),(!C||!n(p))&&(Te=Math.abs(ze.height)),de[je][it]=[et,Te],n(se[it])&&(se[it]=0),n(Ae[je])&&(Ae[je]=0),et>se[it]&&(se[it]=et),Te>Ae[je]&&(Ae[je]=Te),n(ye[je])&&(ye[je]=0),n(Xe[it])&&(Xe[it]=0),ye[je]+=et,Xe[it]+=Te,ye[je]>ie&&(ie=ye[je]),Xe[it]>_e&&(_e=Xe[it]),n(Oe[it])&&(Oe[it]=0),Oe[it]++}var Ue;if(m.squeezeH===!1)for(it=0;it<se.length;it++)Ue=se[it],$+=Ue;if(m.squeezeV===!1)for(it=0;it<Ae.length;it++)Ue=Ae[it],xe+=Ue}ve();var Me=$,we=xe,Fe,ge,Ve,He,Le=1,fe=1;function Ge(be,ze){!n(B)&&Z&&(be-=Math.max(U*2,0),ze-=Math.max(ee*2,0)),be<=0&&(be=null),ze<=0&&(ze=null),!n(be)&&m.squeezeH=="full"?Fe=be:n(be)?$>0?Fe=$+(m.cols-1)*m.spacingH:Fe=ie+(m.cols-1)*m.spacingH:X?Fe=be:Fe=Math.max(ie+(m.cols-1)*m.spacingH,be),!n(ze)&&m.squeezeV=="full"?ge=ze:n(ze)?xe>0?ge=xe+(m.rows-1)*m.spacingV:ge=_e+(m.rows-1)*m.spacingV:q?ge=ze:ge=Math.max(_e+(m.rows-1)*m.spacingV,ze),m.setBounds(0,0,Fe,ge),Le=(Fe-(m.cols-1)*D)/Me,fe=(ge-(m.rows-1)*K)/we;var it,je;Ve=[],He=[];var tt=[];for(pe=0;pe<ue.length;pe++)for(it=ue[pe],je=0,J=0;J<it.length;J++){Y=it[J];var Te,et;if(pe==0&&(Ve[J]=0,n(ze)||(m.squeezeV=="full"?He[J]=Oe[J]>1?(ze-Xe[J])/(Oe[J]-1):0:m.squeezeV?He[J]=Oe[J]>1?Math.max(m.spacingV,(ze-Xe[J])/(Oe[J]-1)):0:He[J]=Oe[J]>1?Math.max(m.spacingV,(ge-Xe[J])/(Oe[J]-1)):0),m.squeezeV?m.valign=="center"||m.valign=="middle"?tt[J]=(ge-(Xe[J]+(Oe[J]-1)*(n(ze)?m.spacingV:He[J])))/2:m.valign=="bottom"?tt[J]=ge-(Xe[J]+(Oe[J]-1)*(n(ze)?m.spacingV:He[J])):tt[J]=0:tt[J]=0),J==0){n(be)||(m.squeezeH=="full"?et=it.length>1?(be-ye[pe])/(it.length-1):0:m.squeezeH?et=it.length>1?Math.max(m.spacingH,(be-ye[pe])/(it.length-1)):0:et=it.length>1?Math.max(m.spacingH,(Fe-ye[pe])/(it.length-1)):0),m.squeezeH?m.align=="center"||m.align=="middle"?Te=(Fe-(ye[pe]+(it.length-1)*(n(be)?m.spacingH:et)))/2:m.align=="right"?Te=Fe-(ye[pe]+(it.length-1)*(n(be)?m.spacingH:et)):Te=0:Te=0;var Ue=e.Pick.choose(P)}O=Ye[J];var Re=de[pe][J][0],Ze=de[pe][J][1];m.mirrorH&&J%2==1&&(Y.scaleX=-Be[pe][J]),Y.pos(je,null),!m.squeezeH&&F?n(be)&&(O=="center"||O=="middle")?Y.x+=(se[J]-Y.width)/2:n(be)&&O=="right"&&(Y.x+=se[J]-Y.width):m.squeezeH?n(be)&&(m.align=="center"||m.align=="middle")?Y.x+=(Re-Y.width)/2:n(be)&&m.align=="right"&&(Y.x+=Re-Y.width):n(be)&&(m.align=="center"||m.align=="middle")?Y.x+=(se[J]-Y.width)/2:n(be)&&m.align=="right"&&(Y.x+=se[J]-Y.width),m.mirrorV&&pe%2==1&&(Y.scaleY=-me[pe][J]),Y.pos(null,Ve[J]),!m.squeezeV&&Ce?n(ze)&&(Ue=="center"||Ue=="middle")?Y.y+=(Ae[pe]-Y.height)/2:n(ze)&&Ue=="bottom"&&(Y.y+=Ae[pe]-Y.height):m.squeezeV?n(ze)&&(m.valign=="center"||m.valign=="middle")?Y.y+=(Ze-Y.height)/2:n(ze)&&m.valign=="bottom"&&(Y.y+=Ze-Y.height):n(ze)&&(m.valign=="center"||m.valign=="middle")?Y.y+=(Ae[pe]-Y.height)/2:n(ze)&&m.valign=="bottom"&&(Y.y+=Ae[pe]-Y.height),m.squeezeH===!0||!n(be)?je+=Re+(n(be)?m.spacingH:et):je+=se[J]+(n(be)?m.spacingH:et),Y.x+=Te,Y.y+=tt[J],m.squeezeV===!0||!n(ze)?Ve[J]+=Ze+(n(ze)?m.spacingV:He[J]):Ve[J]+=Ae[pe]+(n(ze)?m.spacingV:He[J])}}Ge(h,p),this.itemUnderPoint=function(be,ze,it){if(n(it)&&(it=!0),!(n(be)||n(ze))){var je=m.globalToLocal(be,ze);be=je.x,ze=je.y;var tt=0,Te=e.loop(se,function(Re,Ze){if(tt+=Re+m.spacingH,(!it||it=="vertical")&&be>tt-m.spacingH&&be<tt)return!1;if(be<tt-m.spacingH/2)return Ze});if(Te!==!1&&(Te===!0&&(Te=r-1),!(be<0||be>Fe||ze<0||ze>ge))){var et=0,Ue=e.loop(Ae,function(Re,Ze){var Je=n(p)?m.spacingV:He[J];if((!it||it=="horizontal")&&ze>et-Je&&ze<et)return!1;if(et+=Re+Je,ze<et-Je/2)return Ze});if(Ue!==!1)return Ue===!0&&(Ue=i-1),m.items2D[Ue][Te]}}},this.remake=function(be){return n(be)||(m.items=be),ve(),Ge(h,p),Ie(!0),m},this.resize=function(be,ze){return n(be)&&(be=h),n(ze)&&(ze=p),h=be,p=ze,Ge(be,ze),Ie(!0),m};function Qe(be){for(var ze=[],it,je=0;je<be.length;je++)je%m.cols==0&&(it=[],ze.push(it)),it.push(be[je]);return ze}function Ke(be){var ze=[],it;for(it=0;it<m.cols;it++)ze.push([]);for(it=0;it<be.length;it++)ze[it%m.cols][Math.floor(it/m.cols)]=be[it];return ze}Object.defineProperty(this,"items2D",{get:function(){return Qe(m.items)},set:function(){Ct&&ht("Tile() - items2D is read only")}}),Object.defineProperty(this,"items2DCols",{get:function(){return Ke(m.items)},set:function(){Ct&&ht("Tile() - items2DCols is read only")}}),Object.defineProperty(this,"current",{get:function(){var be=[];return e.loop(m.items,function(ze){var it=ze.getBounds(),je=ze.x-ze.regX+it.x+it.width/2,tt=ze.y-ze.regY+it.y+it.height/2,Te=m.hitTestGrid(m.width,m.height,m.cols,m.rows,je,tt,null,null,m.spacingH,m.spacingV,!0,"open");Te!=null&&(be[Te[0]]=ze)}),be},set:function(){Ct&&ht("Tile() - current is read only")}}),Object.defineProperty(this,"current2D",{get:function(){return Qe(m.current)},set:function(){Ct&&ht("Tile() - current2D is read only")}}),Object.defineProperty(this,"current2DCols",{get:function(){return Ke(m.current)},set:function(){Ct&&ht("Tile() - current2DCols is read only")}});var st,yt,We,at,ct,Pe;function Ie(be){if(be&&(at&&at.removeFrom(),ae&&ae.removeFrom()),!n(I)||te||X||q){!be&&(X||q)&&(ct=[],Pe=[]),(!be||n(I))&&(st=[]),!be&&!n(I)&&(We=[]),!be&&te&&(yt=[]);var ze=(w?D:0)/2,it=(C?K:0)/2,je,tt=0;if(e.loop(m.items2D,function(et,Ue){e.loop(et,function(Re,Ze){var Je=black;if(n(I)||(be&&!n(I)?(Je=We[tt],je=st[tt].siz(se[Ze]*Le-(w?D:0),Ae[Ue]*fe-(C?K:0)).loc(ze,it,m,0)):(Je=dt(I),We.push(I),je=new e.Rectangle({width:se[Ze]*Le-(w?D:0),height:Ae[Ue]*fe-(C?K:0),color:Je,style:!1,scaleDimensions:!1,strokeObj:{ignoreScale:!0},group:"background"}).loc(ze,it,m,0),st.push(je)),Re.pos(0,0,O,P,je).addTo(m)),ze=je.x+je.width+D,X||q){var nt,pt;if(be)nt=ct[tt],pt=Pe[tt];else{var nt=dt(X)||100,pt=dt(q)||100;ct.push(nt),Pe.push(pt)}Re.scaleTo(je,nt,pt,V).pos(0,0,O,P,je).addTo(m)}if(te){var De;be?De=yt[tt]:De=dt(te).clone(null,!1),yt.push(De),De.pos(0,0,O,P,je).addTo(m)}tt++}),ze=(w?D:0)/2,it+=je.height+K}),te&&!n(I)&&e.loop(yt,function(et){et.addTo(m,st.length)},!0),n(I)?(e.loop(st,function(et){et.dispose()},!0),st=null,We=null):(m.backgrounds=st,m.backgroundColors=We),!n(I)&&(w||C)){m.loop(function(et){et.mov(w?-D/2:0,C?-K/2:0)});var Te=m.getBounds();m.setBounds(Te.x,Te.y,Te.width-(w?D:0)*r,Te.height-(C?K:0)*i),Te=m.getBounds()}te&&(m.backings=yt)}if(ae&&(m.mat=ae,ae.center(m,0)),B){var Te=m.getBounds();at=m.backdrop=new e.Rectangle({width:Te.width+U*2,height:Te.height+ee*2,color:B,style:!1,group:"backdrop"}),at.center(m,0),m.loop(function(Ue){Ue.mov(Math.max(0,U),Math.max(ee,0))}),m.setBounds(0,0,Te.width+Math.max(0,U)*2,Te.height+Math.max(ee,0)*2)}}Ie(),re!==!1&&e.styleTransforms(this,g),this.clone=function(be){if(be){var ze=[];if(I)var it=[];if(te)var je=[];for(var tt=0;tt<m.items.length;tt++)ze.push(m.items[tt].clone(!0)),I&&it.push(We[tt]),te&&je.push(yt[tt].clone(!0))}return m.cloneProps(new e.Tile(be?e.series(ze):t.clone?t.clone():t,m.cols,m.rows,m.spacingH,m.spacingV,be?!1:f,h,p,m.squeezeH,m.squeezeV,w,C,O,P,m.items.length,m.mirrorH,m.mirrorV,L,be?!1:S,E,be,X,q,V,be?e.series(it):I,be?e.series(je):te&&te.clone?te.clone():te,B,Z,U,ee,ae&&ae.clone?ae.clone():ae,this.style,this.group))}},e.extend(e.Tile,e.Container,"clone","zimContainer",!1),e.Pack=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I){var te="width, height, items, spacingH, spacingV, flatten, direction, lock, backgroundColor, align, valign, lastAlign, paddingH, paddingV, dragOrder, dragColor, dragThickness, dragDashed, reverse, funnel, showPacking, order, style, group, inherit",B;if(B=mt(e.Pack,arguments,te,this))return B;qe("66.52"),this.group=V;var Z=q===!1?{}:e.getStyle("Pack",this.group,I);n(t)&&(t=Z.width!=null?Z.width:500),n(r)&&(r=Z.height!=null?Z.height:500),this.zimContainer_constructor(t,r),this.type="Pack",n(i)&&(i=Z.items!=null?Z.items:[new e.Rectangle(400,300,e.orange),new e.Rectangle(400,200,e.purple),new e.Rectangle(500,300,e.blue)]),n(o)&&(o=Z.spacingH!=null?Z.spacingH:10),n(l)&&(l=Z.spacingV!=null?Z.spacingV:10),n(f)&&(f=Z.flatten!=null?Z.flatten:"top"),n(h)&&(h=Z.direction!=null?Z.direction:"horizontal"),n(p)&&(p=Z.lock!=null?Z.lock:"auto"),n(_)&&(_=Z.backgroundColor!=null?Z.backgroundColor:e.clear),n(b)&&(b=Z.align!=null?Z.align:"center"),n(w)&&(w=Z.valign!=null?Z.valign:"center"),n(C)&&(C=Z.lastAlign!=null?Z.lastAlign:h=="horizontal"?"left":"top"),n(O)&&(O=Z.paddingH!=null?Z.paddingH:0),n(P)&&(P=Z.paddingV!=null?Z.paddingV:0),n(A)&&(A=Z.dragOrder!=null?Z.dragOrder:!1),n(R)&&(R=Z.dragColor!=null?Z.dragColor:e.white),n(T)&&(T=Z.dragThickness!=null?Z.dragThickness:2),n(L)&&(L=Z.dragDashed!=null?Z.dragDashed:!0),n(S)&&(S=Z.reverse!=null?Z.reverse:!1),n(E)&&(E=Z.funnel!=null?Z.funnel:!1),n(k)&&(k=Z.showPacking!=null?Z.showPacking:!1),n(X)&&(X=Z.order!=null?Z.order:null);var U=this;U.funnel=E;var ee=i.length,ae=t-O*2,re=r-P*2,he=50;f===!1&&(f=NONE);var j=this.backing=new On({width:t,height:r,color:_,scaleDimensions:!1}).addTo(this);if(U.items=e.copy(i),i.length<=0)return this;if(i.length==1)return y(i[0]),g(i[0]),this;var G=function(we,Fe,ge){return we.width>Fe.width?1:we.width<Fe.width?-1:0};function y(we){we.scaleTo(j,100-O/ae*100*2,100-P/re*100*2),we.scale*=U.scale,we.scale<0&&(we.scale=.05)}function g(we){we.pos(b!=CENTER&&b!=MIDDLE?O:0,w!=CENTER&&w!=MIDDLE?P:0,b,w,j).addTo(U)}function d(we){var Fe=[];e.loop(we,function(ge,Ve){Fe[Ve]=U.items[ge]}),i=[],e.loop(Fe,function(ge){ge&&i.push(ge)})}var D=U.content=new e.Container,K,m,F,Ce,Y,Q,ce,pe,J,ue,ye,Xe,se,Ae;e.loop(i,function(we,Fe){we.zpRotation=we.rotation,we.zpIndex=Fe}),X&&d(X),h==VERTICAL&&ie(!0);function ie(we){D.rotation=0;var Fe=r;r=t,t=Fe;var ge=re;re=ae,ae=ge;var Ve=l;l=o,o=Ve;var He=P;P=O,O=He,f==RIGHT?f=BOTTOM:f!=CENTER&&f!=NONE&&(f=TOP),C==BOTTOM?C=LEFT:C!=CENTER&&C!=MIDDLE&&(C=RIGHT),j.dispose(),j=new On(t,r,_).center(U),we?(p==HORIZONTAL?p=VERTICAL:p==VERTICAL&&(p=HORIZONTAL),e.loop(i,function(Le,fe){var Ge=new e.Container(Le.height,Le.width);Le.rotation+=90,Le.pos(0,0,TOP,LEFT,Ge),i[fe]=Ge})):(p==HORIZONTAL?p=VERTICAL:p==VERTICAL&&(p=HORIZONTAL),D.rotation-=90,e.loop(i,function(Le,fe){var Ge=Le,Qe=Le.getChildAt(0).addTo(D).sca(Ge.scale);Ge.dispose(),i[fe]=Qe}))}var _e=p;function $(we){p==AUTO&&(p=HORIZONTAL),K=Math.ceil(Math.sqrt(ee)),m=Math.ceil(ee/K),Y=null,Q=null,ce=0,Ae=null,pe=0,J=0,ue=null,ye=null,Xe=null,se=null,Me(we,K,m),ve(D,K,m)}$(i),xe();function xe(){if(y(D),g(D),f==NONE){e.loop(i,function(Ve){Ve.surrogate?(i.splice(i.indexOf(Ve),1),Ve.dispose()):Ve.bot()},!0);var we=m*K-ee;if(f==NONE&&we>0){var Fe=D.getChildAt(D.numChildren-1);if(h==HORIZONTAL&&!S&&C!=LEFT){var ge=D.getBounds().width-(Fe.x+(Fe.getBounds().x-Fe.regX)*Fe.scaleX+Fe.width);e.loop(K-we,function(Ve){D.getChildAt(D.numChildren-Ve-1).mov(C==RIGHT?ge:ge/2)})}else if(h==HORIZONTAL&&S&&C!=RIGHT){var ge=Fe.x+(Fe.getBounds().x-Fe.regX)*Fe.scaleX;e.loop(K-we,function(He){D.getChildAt(D.numChildren-He-1).mov(C==LEFT?-ge:-ge/2)})}else if(h==VERTICAL&&!S&&C!=RIGHT){var ge=Fe.x;e.loop(K-we,function(He){D.getChildAt(D.numChildren-He-1).mov(C==LEFT?-ge:-ge/2)})}else if(h==VERTICAL&&S&&C!=LEFT){var ge=D.getBounds().width-Fe.x;e.loop(K-we,function(He){D.getChildAt(D.numChildren-He-1).mov(C==RIGHT?ge:ge/2)})}}}h==VERTICAL&&(ie(!1),y(D),g(D)),U.cols=K,U.rows=m,U.iterations=ce-2,U.currentItems=i,U.dispatchEvent("change")}var Be,me,Oe;A&&U.added(Ye);function Ye(){de(),Oe=Math.min(30,h==HORIZONTAL?D.height/m/3*U.scale*D.scale:D.width/K/3*U.scale*D.scale),Be?Be.siz(Oe,Oe).reg(CENTER):Be=U.beacon=new e.Rectangle({width:Oe,height:Oe,borderColor:R,borderWidth:T,scaleDimensions:!1}).reg(CENTER).rot(45),me||(me=U.ghost=new e.Rectangle({width:100,height:100,borderColor:R,borderWidth:T,dashed:L,scaleDimensions:!1}).reg(CENTER));var we,Fe,ge,Ve;U.mdEvent=U.on("mousedown",function(He){if(ge=He.target,Be.top(),we=null,!(i.indexOf(ge)<0)){Ve=U.localToGlobal(U.getBounds().x,U.getBounds().y);var Le=ge.boundsToGlobal();U.ghost.siz(Le.width,Le.height).reg(CENTER).loc(Le.x+me.width/2,Le.y+me.height/2,U.stage),me.diffX=U.stage.frame.mouseX-me.x,me.diffY=U.stage.frame.mouseY-me.y,Fe=D.getChildIndex(ge),U.stage.update()}}),U.pmEvent=U.on("pressmove",function(){if(me.parent){var He=U.stage.frame;me.loc(He.mouseX-me.diffX,He.mouseY-me.diffY);var Le=U.getObjectUnderPoint((me.x-Ve.x)/U.scaleX,(me.y-Ve.y)/U.scaleY,1);if(i.indexOf(Le)>=0){var fe=Le.boundsToGlobal();h==HORIZONTAL?me.x>=fe.x+fe.width/2?(Be.loc(fe.x+fe.width+o/2*U.scaleX*D.scaleX,fe.y+fe.height/2,U.stage),we=D.getChildIndex(Le)+(S?0:1)):(Be.loc(fe.x-o/2*U.scaleX*D.scaleX,fe.y+fe.height/2,U.stage),we=D.getChildIndex(Le)+(S?1:0)):me.y>=fe.y+fe.height/2?(Be.loc(fe.x+fe.width/2,fe.y+fe.height+l/2,U.stage),we=D.getChildIndex(Le)+(S?0:1)):(Be.loc(fe.x+fe.width/2,fe.y-l/2,U.stage),we=D.getChildIndex(Le)+(S?1:0))}U.stage.update()}}),U.puEvent=U.on("pressup",function(){me.parent&&(we!=null&&(we>Fe&&we--,we!=Fe&&(ge.level=we,i=[],D.loop(function(He,Le){i.push(He.rot(He.zpRotation||0).sca(1))}),p=_e,h==VERTICAL&&ie(!0),$(i),xe())),me.removeFrom(),Be.removeFrom(),U.stage.update())})}function de(){U.mdEvent&&U.off("mousedown",U.mdEvent),U.pmEvent&&U.off("pressmove",U.pmEvent),U.puEvent&&U.off("pressup",U.puEvent),Be&&Be.removeFrom(),me&&me.removeFrom()}function ve(we,Fe,ge){if(we.scale=1,ce++>20){Ae&&Ae.clear();return}var Ve=!1;if(we.height>re){if(F=Fe+1,Ce=Math.ceil(ee/F),Fe==Q&&p==VERTICAL)if(J>pe)F=ye,Ce=se,Ve=!0;else return we}else if(we.height<=re&&(F=Math.max(Fe-1,1),Ce=Math.ceil(ee/F),Fe==Q&&p==HORIZONTAL))if(J>pe)F=ye,Ce=se,Ve=!0;else return we;if(Q=Y,Y=K,K=F,m=Ce,e.loop(i,function(He){f==NONE&&He.surrogate?(i.splice(i.indexOf(He),1),He.dispose()):He.siz(null,re)},!0),Me(i,K,m),J=pe,ye=ue,se=Xe,_e==AUTO||p==HORIZONTAL&&Math.round(we.width)==ae||p==VERTICAL&&Math.round(we.height)==re?pe=we.width*we.height:pe=0,ue=K,Xe=m,Ve){Ae&&Ae.clear(),g(we),U.stage&&U.stage.update();return}k?(Ae=ri(1,function(){ve(we,K,m)}),g(we),U.stage&&U.stage.update(),we.sca(1)):(we.sca(1),ve(we,K,m))}function Me(we,Fe,ge){var Ve=0;e.loop(we,function(We,at){We.siz(null,he),Ve+=We.width});var He=Ve/ee,Le=we;ee%Fe!=0&&f==NONE&&e.loop(Fe-ee%Fe,function(){var We=new e.Rectangle(He,he,grey);We.surrogate=!0,Le.push(We)});var fe=new ai(Le,Fe,ge,0,0,!0),Ge=[],Qe=e.copy(fe.items2D);if(f!=NONE&&Fe*ge!=ee&&Qe.length>1){var Ke;if(f==BOTTOM)Ke=U.funnel?Math.floor((Fe*ge-ee)/2):Math.ceil((Fe*ge-ee)/2),e.loop(Ke,function(We){Qe[ge-1].unshift(Qe[ge-2].pop())});else{var st=Fe*ge-ee;e.loop(Qe,function(We,at,ct){at!=ct-1&&e.loop(We.splice(-st,st),function(Pe){Qe[at+1].unshift(Pe)},!0)}),Ke=U.funnel?Math.floor((Fe*ge-ee)/2):Math.ceil((Fe*ge-ee)/2),e.loop(Ke,function(We){Qe[0].push(Qe[1].shift())})}}e.loop(Qe,function(We,at,ct){var Pe=0;e.loop(We,function(it){Pe+=it.width});var Ie=(ae-o*(We.length-1))/Pe;e.loop(We,function(it){it.scale*=Ie});var be=e.copy(We);(S&&h==HORIZONTAL||!S&&h==VERTICAL)&&be.reverse();var ze=new ai(be,We.length,1,o,0,!0);S&&ze.loop(function(it){it.bot()}),Ge.push(ze)}),fe.dispose();var yt=0;return D.loc(j,null,U),D.removeAllChildren(),e.loop(Ge,function(We){We.loc(0,yt,D),yt+=We.height+l,We.loop(function(at,ct,Pe){at.addTo(D).ord(-(Pe-ct))},!0)}),e.loop(Ge,function(We){We.dispose()},!0),y(D),D}U.getOrder=function(we){if(n(we)&&(we=!1),we){if(!Fe){var Fe=U.pane=new e.Pane({displayClose:!1,container:U.stage,width:Math.min(500,U.stage.width-20),height:Math.min(500,U.stage.height-20),draggable:!0}),ge=U.textArea=new e.TextArea(Math.min(400,U.stage.width-70),Math.min(400,U.stage.height-70));ge.centerReg(Fe)}Fe.show(),ge.text=JSON.stringify(U.order)}return U.order},this.setOrder=function(we){return d(we),$(i),xe(),U},this.addAt=function(we,Fe){return n(we)||(n(Fe)&&(Fe=U.items.length),Array.isArray(we)||(we=[we]),e.loop(we,function(ge,Ve){U.items.push(ge),ge.zpIndex=U.items.length-1,U.currentItems.splice(Fe+Ve,0,ge)}),$(U.currentItems),xe()),U},this.removeAt=function(we,Fe){n(we)&&(we=1),n(Fe)&&(Fe=U.items.length);var ge=U.currentItems.splice(Fe,we);return e.loop(ge,function(Ve){var He=U.items.indexOf(Ve);U.items.splice(He,1)}),$(U.currentItems),xe(),U},Object.defineProperty(U,"order",{get:function(){var we=[];return D.loop(function(Fe){we.push(Fe.zpIndex)}),we},set:function(we){U.setOrder(we)}}),Object.defineProperty(U,"lock",{get:function(){return _e},set:function(we){we!=_e&&(p=we,$(i),xe(),A&&Ye())}}),Object.defineProperty(U,"direction",{get:function(){return h},set:function(we){we!=h&&(h=we,D.rotation=0,i=[],D.loop(function(Fe,ge){i.push(Fe.rot(Fe.zpRotation||0).sca(1))}),h==VERTICAL&&ie(!0),$(i),xe(),A&&Ye())}}),Object.defineProperty(U,"spacing",{get:function(){return h==VERTICAL?l:o},set:function(we){o=l=we,$(i),xe()}}),Object.defineProperty(U,"outerWidth",{get:function(){return t},set:function(we){t!=we&&(t=we,ae=t-O*2,j&&(j.widthOnly=t,j.center(U)),$(i),xe(),A&&Ye())}}),Object.defineProperty(U,"outerHeight",{get:function(){return r},set:function(we){r!=we&&(r=we,re=r-P*2,j&&(j.heightOnly=r,j.center(U)),$(i),xe(),A&&Ye())}}),Object.defineProperty(U,"flatten",{get:function(){return f},set:function(we){f!=we&&(f=we,$(i),xe())}}),Object.defineProperty(U,"dragOrder",{get:function(){return A},set:function(we){we?Ye():(de(),U.stage&&U.stage.update())}}),q!==!1&&e.styleTransforms(this,Z),this.dispose=function(we){return A&&de(),U.items=null,U.currentItems=null,we||this.zimContainer_dispose(!0),!0},this.clone=function(){return U.cloneProps(new e.Pack(t,r,e.copy(i,!0),o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,e.copy(U.order),this.style,this.group))}},e.extend(e.Pack,e.Container,["dispose","clone"],"zimContainer",!1),e.Beads=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A){var R="path, obj, count, angle, startPercent, endPercent, percents, onTop, showControls, visible, interactive, clone, group, style, inherit",T;if(T=mt(e.Beads,arguments,R,this))return T;qe("66.7"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Beads",this.group=O;var L=P===!1?{}:e.getStyle(this.type,this.group,A);n(p)&&(p=L.onTop!=null?L.onTop:!1),n(_)&&(_=L.showControls!=null?L.showControls:!1),n(b)&&(b=L.visible!=null?L.visible:!0),n(w)&&(w=L.interactive!=null?L.interactive:!0),n(t)&&(t=L.path!=null?L.path:new e.Blob({color:null,borderWidth:3,borderColor:e.blue})),t.visible=b,t.interactive=w,t.toggle(_),t.onTop=p,n(r)&&(r=L.obj!=null?L.obj:new e.Circle(10)),n(i)&&(i=L.count!=null?L.count:10),n(o)&&(o=L.angle!=null?L.angle:null),n(l)&&(l=L.startPercent!=null?L.startPercent:0),n(f)&&(f=L.endPercent!=null?L.endPercent:100),n(h)&&(h=L.percents!=null?L.percents:null);var S=f;f<l&&(S=100+f);var E;if(n(h)){var k;t.type=="Squiggle"?k=(S-l)/(i-1):k=(S-l)/(i-(l!=S%100?1:0)),h=[];var X=l-k;for(E=0;E<i;E++)h.push(X+k),X+=k,X>100&&(X-=100)}n(C)&&(C=L.clone!=null?L.clone:!0);var q=this;q.count=i,q.percents=h,q.items=[];var V;for(E=0;E<i;E++)V=e.Pick.choose(r),C&&E!=0&&(V=V.clone()),V.beadNum=E,V.startPercent=h[E],q.items.push(V);q.path=t.addTo(q),q.beads=new e.Container().addTo(q,p?0:null),q.beads.type="BeadsContainer",this.resize=function(){for(var I=t.segmentRatios,te=t.segmentPoints,B=0;B<q.count;B++){var Z=t.getCurvePoint(Math.max(0,Math.min(.9999,h[B]/100)),I,te,!0);if(Z){var U=q.beads.globalToLocal(Z.x,Z.y);U&&q.items[B].loc(U,null,q.beads).rot(n(o)?Z.angle>180?Z.angle-360+t.rotation:Z.angle+t.rotation:o)}}return this},q.resize(),w&&(t.on("pressmove",q.resize),t.on("update",q.resize)),P!==!1&&e.styleTransforms(this,L),this.dispose=function(I){return I||this.zimContainer_dispose(!0),q.items=[],!0},this.clone=function(I){if(I)for(var te=[],B=0;B<q.items.length;B++)te.push(q.items[B].clone(!0));return q.cloneProps(new e.Beads(t.clone(),I?e.series(te):r.clone?r.clone():r,q.count,o,l,f,h,p,_,b,w,C,this.style,this.group))}},e.extend(e.Beads,e.Container,["clone","dispose"],"zimContainer",!1),e.Layout=function(t,r,i,o,l,f,h,p,_,b,w,C){var O="holder, regions, lastMargin, lastMarginMin, backgroundColor, vertical, showRegions, scalingObject, hideKey, style, group, inherit",P;if(P=mt(e.Layout,arguments,O,this))return P;qe("80"),this.cjsEventDispatcher_constructor(),this.type="Layout",this.group=w;var A=b===!1?{}:e.getStyle(this.type,this.group,C);if(n(t)&&(t=A.holder!=null?A.holder:null),n(p)&&(p=A.scalingObject!=null?A.scalingObject:null),n(t)||!t.getBounds){Hn("zim controls - Layout(): please provide an object with bounds set that holds the objects being laid out");return}if(p=n(p)?t:p,!p.getBounds||!p.getBounds()){Hn("zim controls - Layout(): holder must have bounds set or provide a scalingObject with bounds");return}var R=p.getBounds();t.setBounds(0,0,R.width,R.height),n(i)&&(i=A.lastMargin!=null?A.lastMargin:0),n(o)&&(o=A.lastMarginMin!=null?A.lastMarginMin:0),n(f)&&(f=A.vertical!=null?A.vertical:!0),n(l)&&(l=A.backgroundColor!=null?A.backgroundColor:""),n(_)&&(_=A.hideKey!=null?A.hideKey:"B"),n(h)&&(h=A.showRegions!=null?A.showRegions:null);var T;h&&(T=new e.Shape);var L=this.backing=new e.Shape,S=this;if(this.active=!0,n(r)&&(r=A.regions!=null?e.copy(A.regions):null),n(r))return;e.loop(r,function(y,g){y instanceof $e.DisplayObject&&(r[g]={obj:y}),r[g].object&&(r[g].obj=r[g].object,delete r[g].object)}),this.regions=r;var E,k=0,X="minWidth",q="width",V="height",I="marginLeft",te="marginMinLeft",B="maxHeight";f&&(X="minHeight",q="height",V="width",I="marginTop",te="marginMinTop",B="maxWidth");for(var Z=[],U=0,ee=0;ee<r.length;ee++){if(E=r[ee],!E.obj||!E.obj.getBounds()){ht("Layout(): each region object must have an object with setBounds() set");return}E[X]||(E[X]=0),E[q]||(E[q]=0),E.backgroundColor||(E.backgroundColor=""),E.given=0,E.maxGiven=0,E[I]=="auto"?(Z[ee]=!0,U++,E[te]?E[I]=E[te]:delete E[I]):E[I]&&E[te]&&E[I]<E[te]&&(E[I]=E[te]),n(E[I])&&(E[I]=1e-4),E[B]||(E[B]=100),f?(E.align||(E.align="middle"),E.valign||(ee==0?E.valign="top":ee==r.length-1?E.valign="bottom":E.valign="middle",r.length==1&&(E.valign="middle"))):(E.valign||(E.valign="top"),E.align||(ee==0?E.align="left":ee==r.length-1?E.align="right":E.align="middle",r.length==1&&(E.align="middle"))),E[q]&&(E[X]=0),k+=E[q]+E[I]}if(i=="auto"?(Z[r.length]=!0,i=o||0):i&&o&&i<o&&(i=o),k+=i,k>100){ht("Layout(): cannot fit regions into 100% bounds");return}var ae=100-k;re();function re(){var y=0,g;for(g=0;g<r.length;g++)E=r[g],E.given=0,E[q]==0&&(y+=E.obj.getBounds()[q]);for(g=0;g<r.length;g++)E=r[g],E[q]==0&&(E.given=E.obj.getBounds()[q]/y*ae)}this.resize=function(){var y;if(S.active){for(R=p.getBounds(),t.setBounds(0,0,R.width,R.height),L.graphics.clear(),l!=""&&(he(L,l),L.graphics.r(0,0,R.width,R.height)),y=0;y<r.length;y++)E=r[y],E.maxGiven=0,E.marginGiven=0;for(var g=!0,d,D,K,m,F,Ce,Y=ae;g;){for(g=!1,d=!0,y=0;y<r.length;y++)E=r[y],E.given>0&&E.maxGiven==0&&(D=E.obj.getBounds()[q],K=E.obj.getBounds()[V],m=E.given*R[q]/100,F=E[B]*R[V]/100,Ce=K/D*m,Ce>F&&E.obj.type!="Window"?(E.maxGiven=D/K*F*100/R[q],Y-=E.maxGiven):d=!1);if(d)break;var Q=0;for(y=0;y<r.length;y++)E=r[y],E[q]==0&&E.maxGiven==0&&(Q+=E.obj.getBounds()[q]);for(y=0;y<r.length;y++)E=r[y],E[q]==0&&E.maxGiven==0&&(E.given=E.obj.getBounds()[q]/Q*Y)}var ce=!0;if(E=r[0],E.maxGiven>0?E.maxGiven<E[X]&&(E[q]=E[X],ce=!1):E.given>0&&E.given<E[X]&&(E[q]=E[X],ce=!1),E=r[r.length-1],E.maxGiven>0?E.maxGiven<E[X]&&(E[q]=E[X],ce=!1):E.given>0&&E.given<E[X]&&(E[q]=E[X],ce=!1),!ce){for(k=0,y=0;y<r.length;y++)E=r[y],k+=E[q]+E[I];if(k+=i,k>100){ht("zim display - Layout(): cannot fit regions into 100% bounds");return}ae=100-k,re(),S.resize();return}var pe=!0,J=0,ue=0;for(y=0;y<r.length;y++)E=r[y],J+=E[I],E[q]>0?ue+=E[q]:E.maxGiven>0?ue+=E.maxGiven:E.given>0&&(ue+=E.given),E[q]==0&&(pe=!1);if(pe||d){J+=i;var ye=100-ue-J;if(J-=i+r[0][I],ye!=0&&J!=0)for(y=0;y<r.length;y++)y!=0&&(E=r[y],E.marginGiven=E[I]/J*(J+ye))}if(U>0){var Xe=0,se=0;for(y=0;y<r.length;y++)E=r[y],E.marginGiven>0?se+=E.marginGiven:se+=E[I],E.marginGiven=0,Xe+=E[I]>.05?E[I]:0;var Ae=(se-Xe)/U;for(y=0;y<Z.length;y++)Z[y]&&r[y]&&(E=r[y],E.marginGiven=(E[te]?E[te]:0)+Ae)}var ie=0,_e=0,$,xe,Be;if(T&&T.graphics){var me=T.graphics;me.c()}for(y=0;y<r.length;y++)E=r[y],E.marginGiven>0?ie+=E.marginGiven*R[q]/100:ie+=E[I]*R[q]/100,E[q]>0?D=E[q]:E.maxGiven>0?D=E.maxGiven:E.given>0?D=E.given:D=0,D=D*R[q]/100,K=E[B]*R[V]/100,_e=(R[V]-K)/2,f?(E.obj.type=="Wrapper"&&E.obj.resize(K),E.obj.type=="Window"&&E.obj.resize(K,D),E.obj.type=="Region"&&E.obj.setBounds(K,D),$=e.fit(E.obj,_e,ie,K,D)):(E.obj.type=="Wrapper"&&E.obj.resize(D),E.obj.type=="Window"&&E.obj.resize(D,K),E.obj.type=="Region"&&E.obj.setBounds(D,K),$=e.fit(E.obj,ie,_e,D,K)),E.valign=="top"?E.obj.y=$.bY:E.valign=="bottom"&&(E.obj.y=$.bY+$.bHeight-$.height),E.align=="left"?E.obj.x=$.bX:E.align=="right"&&(E.obj.x=$.bX+$.bWidth-$.width),T&&T.graphics&&(me.s("white").ss(2).r($.bX,$.bY,$.bWidth,$.bHeight),me.s("#ff8203").sd([20,20]).r($.bX,$.bY,$.bWidth,$.bHeight).sd()),Be=xe=0,(ie==0||ie+D==R[q])&&(f?Be=1:xe=1),K==R[V]&&(f?xe=1:Be=1),E.backgroundColor!=""&&(he(L,E.backgroundColor),L.graphics.r($.bX,$.bY,$.bWidth+xe,$.bHeight+Be)),ie+=D,E.obj.ZIMoutlineShape&&E.obj.outline()}};function he(y,g){g.type=="GradientColor"?y.graphics.lf(g.colors,g.ratios,g.x0,g.y0,g.x1,g.y1):g.type=="RadialColor"?y.graphics.rf(g.colors,g.ratios,g.x0,g.y0,g.r0,g.x1,g.y1,g.r1):g.type=="BitmapColor"?y.graphics.bf(g.image,g.repetition,g.matrix):y.graphics.f(E.backgroundColor)}this.resize(),T&&t.addChild(T),t.addChildAt(L,0),le.addEventListener("keydown",j);function j(y){y||(y=event),T&&String.fromCharCode(y.keyCode)==_.toUpperCase()&&(S.toggle(),T.stage&&T.stage.update())}this.disable=function(){S.active=!1,le.removeEventListener("keydown",j),T&&(T.alpha=0)},this.enable=function(){S.active=!0,le.addEventListener("keydown",j),S.resize(),T&&(T.alpha=1)},this.removeShape=function(){T&&(T.graphics.clear(),T.dispose(),T=null,T=!1),le.removeEventListener("keydown",j)},this.toggled=!0,this.toggle=function(y){return y===!0?T.visible=!0:y===!1?T.visible=!1:T.visible=!T.visible,S.toggled=T.visible,S},this.addShape=function(y){S.removeShape(),T=y,le.addEventListener("keydown",j),t.addChild(T),S.resize()},b!==!1&&e.styleTransforms(this,A),p.added?p.added(G):G(p);function G(y){if(y&&y.frame&&y.frame.scaling=="full"){if(!e.globalManager){var g=e.globalManager=new e.Manager;g.frame=y.frame,g.event=y.frame.on("resize",function(){g.resize()})}e.globalManager.add(S)}}this.dispose=function(){if(S.resize=null,e.globalManager){var y=e.globalManager;y.remove(S),e.globalManager.items.length==0&&(y.frame.off("resize",y.event),y.dispose(),e.globalManager=null)}return S.backing&&S.backing.dispose(),S.backing=null,S.removeShape(),!0}},e.extend(e.Layout,$e.EventDispatcher,null,"cjsEventDispatcher",!1),e.Accessibility=function(t,r,i,o,l,E,h,p,_,b,w,C,O,P,A){var R="appName, tabOrder, tabIndex, cycle, decimals, frame, application, alwaysHighlight, AHTime, AHColor, AHBorderWidth, AHBorderPadding, AHAlpha, AHObject, AHObjectScale",T;if(T=mt(e.Accessibility,arguments,R,this))return T;qe("30.5"),this.cjsEventDispatcher_constructor(),this.type="Accessibility",n(t)&&(t="application"),n(o)&&(o=!1),n(l)&&(l=2),n(E)&&(E=le.zdf),n(h)&&(h=!e.mobile()),n(p)&&(p=!1);var L=v(_);if(n(_)&&(_=L=="s"?.7:700),n(b)&&(b="brown"),n(w)&&(w=3),n(C)&&(C=5),n(O)&&(O=.8),n(A)&&(A=.8),n(P)){var S=new e.Shape({style:!1});S.mouseEnabled=!1}else P.mouseEnabled&&(P.mouseEnabled=!1);if(typeof E>"u")var E=le.zdf;if(n(E)){Ct&&ht("Accessibility - needs a Frame");return}var k=E.retina&&le.devicePixelRatio||1,X=this;X.cycle=o,X.decimals=l,X.alwaysHighlight=p,X.AHTime=_,X.AHColor=b,X.AHBorderWidth=w,X.AHBorderPadding=C,X.AHAlpha=O,X.AHObjectScale=A;var q=-1,V=-1,I=[],te=[],B={RadioButtons:"option",Tabs:"tab",Pad:"key"},Z,U=E.canvas.id,ee=e.mobile(),ae=!1,re=null,he=[],j,G,y,g,d,D,K,m=150,F;Object.defineProperty(this,"tabOrder",{get:function(){return q},set:function(ge){var Ve;for(j&&j.removeEventListener("focus",Q),G&&G.removeEventListener("focus",Q),Ve=0;Ve<I.length;Ve++)I[Ve].parentElement&&(I[Ve].outerHTML="");I=[];var He,Le;for(Ve=0;Ve<te.length;Ve++)He=q[Ve],He&&te[Ve][0].off("mousedown",te[Ve][1]);te=[],q=[];var fe=[];F=E.shim?document.body:E.canvas,we=!1;var Ge=0;for(Ve=0;Ve<ge.length;Ve++){if(He=ge[Ve],He.type=="HotSpots"&&(ge.splice.apply(ge,[Ve,1].concat(He.hotSpots)),He=He.hotSpots[0]),He.type=="HotSpot"&&(He=He.spot),He.constructor=={}.constructor){if(Le=He.obj,!Le||!Le.getStage)continue;He.title||(He.title=ie(Le,Ve+Ge))}else Le=He,He={obj:He,title:ie(He,Ve+Ge)};if(Le.type=="RadioButtons"||Le.type=="Tabs"||Le.type=="Pad"){var Qe=[];Ge--;for(var Ke=0;Ke<Le.buttons.length;Ke++){Ge++;var st=Le.buttons[Ke],yt={obj:st,title:He.title+" - "+B[Le.type]+": "+(st.text=="a"||st.text=="A"?"eh":st.text)};Qe.push(yt),st.zimTabParent=Le,st.zimTabParent.zimAccessibility=X,st.zimTabIndex=Ve+Ge,st.tabIndex=Ke,st.zimAccessibility=X,_e(yt),F=$(U+"Tab"+(Ve+Ge),yt.title,F,yt),te.push([st,st.on("mousedown",Ae)]),ae||he.push([st,st.on("mousedown",Y)])}fe=fe.concat(Qe)}else Le.zimTabIndex=Ve+Ge,Le.zimTabParent=Le,_e(He),Le.zimAccessibility=X,te.push([Le,Le.on("mousedown",Ae)]),ae||he.push([Le,Le.on("mousedown",Y)]),fe.push(He),F=$(U+"Tab"+(Ve+Ge),He.title,F,He)}j=X.startAppTag=$(U+"PrefixTab",t+" start",E.shim?document.body:E.canvas,null,"before"),j.addEventListener("focus",Q),ae||(j.addEventListener("focus",ye),g=$(U+"noAriaTab","",j,null,"before"),g.setAttribute("aria-hidden",!0),g.focusTab=j,g.addEventListener("focus",ue),D=$(U+"noAriaTab","",j),D.setAttribute("aria-hidden",!0),D.focusTab=j,D.addEventListener("focus",ue)),F=$(U+"BufferTab","",F),ee&&F.setAttribute("aria-hidden",!0),F=G=X.endAppTag=$(U+"SuffixTab",t+" end",F),G.addEventListener("focus",Q),ae||(G.addEventListener("focus",ye),F=d=$(U+"noAriaTab","",G),d.setAttribute("aria-hidden",!0),d.focusTab=G,d.addEventListener("focus",ue),K=$(U+"noAriaTab","",G,null,"before"),K.setAttribute("aria-hidden",!0),K.focusTab=G,K.addEventListener("focus",ue)),q=fe}});function Ce(){j&&(j.removeEventListener("focus",Q),j.removeEventListener("focus",ye),j.parentNode&&(j.outerHTML="")),g&&(g.removeEventListener("focus",ue),g.parentNode&&(g.outerHTML="")),D&&(D.removeEventListener("focus",ue),D.parentNode&&(D.outerHTML="")),F&&F.parentNode&&(F.outerHTML=""),G&&(G.removeEventListener("focus",Q),G.removeEventListener("focus",ye),G.parentNode&&(G.outerHTML="")),d&&(d.removeEventListener("focus",ue),d.parentNode&&(d.outerHTML="")),K&&(K.removeEventListener("focus",ue),K.parentNode&&(K.outerHTML=""))}Object.defineProperty(this,"tabIndex",{get:function(){return V},set:function(ge){if(!Fe)return;if(ge<0||ge>=q.length)We();else{ge!=V&&yt();var Ve=q[ge].obj;if(Ve.stage){if(V=ge,Ve.focus=!0,xe=!0,Be=!1,X.changeTitle(Ve),Ve.zimTabTag.focus(),setTimeout(function(){Ve.zimTabTag.focus();var at=new $e.Event("change");at.title=Ve.zimTabTag.getAttribute("aria-label"),X.dispatchEvent(at)},m),X.alwaysHighlight&&(!re||!ee)){if(X.AHObject){Z=X.AHObject;var st=e.boundsToGlobal(Ve);X.AHObject.alp(X.AHAlpha).addTo(E.stage,null,!1),X.AHObject.fit(st.x,st.y,st.width,st.height),X.AHObject.sca(X.AHObject.scaleX*X.AHObjectScale),X.AHTime>0&&(ve=setTimeout(function(){E.stage.removeChild(X.AHObject),E.stage.update()},X.AHTime*(L=="s"?1e3:1)))}else{Z=S;var He=Ve.getBounds(),Le=Ve.localToGlobal(He.x-5,He.y-5),fe=Ve.localToGlobal(He.x+He.width+5,He.y-5),Ge=Ve.localToGlobal(He.x+He.width+5,He.y+He.height+5),Qe=Ve.localToGlobal(He.x-5,He.y+He.height+5),Ke=S.graphics;Ke.clear(),Ke.s(X.AHColor).ss(X.AHBorderWidth).mt(Le.x-X.AHBorderPadding,Le.y-X.AHBorderPadding).lt(fe.x+X.AHBorderPadding,fe.y-X.AHBorderPadding).lt(Ge.x+X.AHBorderPadding,Ge.y+X.AHBorderPadding).lt(Qe.x-X.AHBorderPadding,Qe.y+X.AHBorderPadding).lt(Le.x-X.AHBorderPadding,Le.y-X.AHBorderPadding).cp(),S.alpha=X.AHAlpha,X.AHTime>0&&(ve=setTimeout(function(){E.stage.removeChild(S),E.stage.update()},X.AHTime*(L=="s"?1e3:1)))}E.stage.addChild(Z),E.stage.update()}}else We()}function yt(){if(V&&V>-1)q&&q[V]&&(q[V].obj.focus=!1);else for(var at=0;at<q.length;at++)q[at].obj.focus=!1}function We(){yt(),xe=!1,X.AHObject&&E.stage.removeChild(X.AHObject),X.alwaysHighlightShape&&E.stage.removeChild(X.alwaysHighlightShape),E.stage.update(),V=-1}}}),Object.defineProperty(this,"aria",{get:function(){return re},set:function(ge){re=ge,re&&ce()}});function Y(ge){var Ve=ge.currentTarget,He=Ve.boundsToGlobal(),Le=He.x+He.width/2,fe=He.y+He.height/2,Ge=5;ge.stageX/e.scaX<Le-Ge||ge.stageX/e.scaX>Le+Ge||ge.stageY/e.scaY<fe-Ge||ge.stageY/e.scaY>fe+Ge?pe():ce()}function Q(){y&&(y.innerHTML="")}ee=="android"&&(e.ACTIONEVENT="click",Dt||(le.ACTIONEVENT="click"));function ce(){re=!0,Xe(),y&&y.setAttribute("aria-hidden",!1),e.ACTIONEVENT="click",Dt||(le.ACTIONEVENT="click"),E.stage.removeChild(Z),ee&&(X.alwaysHighlight=!1),E.stage.update();for(var ge,Ve,He,Le=0;Le<q.length;Le++)ge=q[Le],Ve=ge.obj,He=Ve.zimTabTag,He.disabled=!1,ge.title=ge.title.replace(/\s\(use arrow keys\)/,""),He.setAttribute("aria-label",ge.title),He.addEventListener("focus",J)}function pe(){re=!1;for(var ge,Ve,He,Le=0;Le<q.length;Le++)ge=q[Le],Ve=ge.obj,He=Ve.zimTabTag,He.disabled=!1;Xe(),p&&se()}function J(ge){var Ve=ge.currentTarget,He=Ve.zimObject;V=He.zimTabIndex,He.focus=!0;var Le=new $e.Event("change");Le.title=Ve.getAttribute("aria-label"),X.dispatchEvent(Le)}function ue(ge){re=!1,ge.target.focusTab.focus()}function ye(){n(re)||re?ce():pe()}function Xe(){ae=!0,j.removeEventListener("focus",ye),G.removeEventListener("focus",ye),g.removeEventListener("focus",ue),d.removeEventListener("focus",ue),g.parentNode&&(g.parentNode.removeChild(g),d.parentNode.removeChild(d)),D.removeEventListener("focus",ue),K.removeEventListener("focus",ue),D.parentNode&&(D.parentNode.removeChild(D),K.parentNode.removeChild(K));for(var ge=0;ge<he.length;ge++)he[ge][0].off("mousedown",he[ge][1])}function se(){for(var ge=0;ge<I.length;ge++){var Ve=I[ge];Ve.zimObject&&(Ve.zimObject.type=="Loader"||Ve.zimObject.type=="TextArea"||Ve.zimObject.type=="Tag")||(I[ge].style.left="-2000px")}}n(r)?setTimeout(function(){if(q==-1){q=[];var ge=[];e.loop(E.stage,function(Ve){Ve.type&&ge.push(Ve)}),X.tabOrder=ge,n(i)||(X.tabIndex=i)}},50):(q=[],X.tabOrder=r,n(i)||(X.tabIndex=i));function Ae(ge){var Ve=ge.currentTarget;if(Ve.type=="RadioButton"||Ve.type=="TabsButton"||Ve.type=="PadButton")for(var He=0;He<Ve.zimTabParent.buttons.length;He++){var Le=Ve.zimTabParent.buttons[He];Le.zimTabTag.setAttribute("aria-label",Le.zimTabTag.getAttribute("aria-label").split(" - currently")[0]+(Ve.zimTabParent.selectedIndex==Le.tabIndex?" - currently selected.":" - currently not selected."))}X.tabIndex=ge.currentTarget.zimTabIndex,X.activatedObject=Ve}function ie(ge){return ge.talk?ge.talk:ge.type=="TextArea"||ge.type=="RadioButtons"||ge.type=="Tabs"||ge.type=="Pad"?ge.type:ge.type=="Waiter"?"Waiter active - please wait":ge.text?ge.type+" - "+(ge.text=="a"||ge.text=="A"?"eh":ge.text):ge.type+(ge.type=="Dial"||ge.type=="Slider"||ge.type=="ColorPicker"||ge.type=="Stepper"?" (use arrow keys)":"")+(ge.type=="TextArea"?" (press ENTER to edit)":"")}function _e(ge){var Ve=ge.obj;ge.title=ge.title.replace(/\.$/,""),Ve.type=="RadioButton"||Ve.type=="TabsButton"||Ve.type=="PadButton"?ge.title=ge.title+(Ve.tabIndex==Ve.zimTabParent.selectedIndex?" - currently selected":" - currently not selected"):Ve.type=="CheckBox"?ge.title=ge.title+(Ve.checked?" - currently checked":" - currently not checked"):Ve.type=="Stepper"?ge.title=ge.title+" - currently displaying "+Ve.currentValue:Ve.type=="Slider"||Ve.type=="Dial"?ge.title=ge.title+" - currently at "+e.decimals(Ve.currentValue,X.decimals):Ve.type=="ColorPicker"?ge.title=ge.title+" - currently at "+Ve.selectedColor:Ve.type=="TextArea"?ge.title=ge.title+(Ve.tag.value!=""?"":" - placeholder: "+Ve.tag.placeholder):Ve.type=="Indicator"?ge.title=ge.title+" - currently "+(Ve.selectedIndex>=0?"at "+(Ve.selectedIndex+1)+" of "+Ve.num:"not indicating"):Ve.type=="TextInput"&&(ge.title=ge.title+(Ve.htmlTag.value!=""?"":" - placeholder: "+Ve.htmlTag.placeholder)),ge.title+="."}function $(ge,Ve,He,Le,fe){var Ge,Qe;if(Le&&(Ge=Le.obj),Le&&(Ge.type=="TextArea"||Ge.type=="Loader"))return Qe=Ge.tag,Qe.setAttribute("aria-label",Ve),Ge&&Qe.setAttribute("aria-hidden",!Ge.stage),fe=="before"?He.parentNode.insertBefore(Qe,He):He.parentNode.insertBefore(Qe,He.nextSibling),Ge.type=="TextArea"?Qe.style.zIndex=3:Qe.style.zIndex=-5,Qe.zimObject=Ge,Le.obj.zimTabTag=Qe,I.push(Qe),Qe;if(Le&&Ge.type=="TextInput")return Qe=Ge.htmlTag,Qe.setAttribute("aria-label",Ve),Ge&&Qe.setAttribute("aria-hidden",!Ge.stage),fe=="before"?He.parentNode.insertBefore(Qe,He):He.parentNode.insertBefore(Qe,He.nextSibling),Qe.style.zIndex=-5,Qe.zimObject=Ge,Le.obj.zimTabTag=Qe,I.push(Qe),Qe;var Ke;if(Le&&(Ge.type=="Dial"||Ge.type=="Slider"||Ge.type=="Stepper"||Ge.type=="ColorPicker")){var st=[];if(Ge.type=="Dial"||Ge.type=="Slider"){var yt=Ge.step<=0?(Ge.max-Ge.min)/20:Ge.step;for(Ke=Ge.min;Ke<Ge.max;Ke=Ke+yt)st.push(Ge.min+Ke)}else Ge.type=="Stepper"?st=Ge.stepperArray:Ge.type=="ColorPicker"&&(st=Ge.colors);Qe=document.createElement("select"),Qe.disabled=!0,Qe.zimObject=Ge,Qe.addEventListener("change",function(Pe){!re&&!ee=="android"||(Pe.currentTarget.zimObject.zimTabParent.currentValueEvent=Pe.target.value,E.stage.update())}),Qe.size=1;var We,at;for(Ke=0;Ke<st.length;Ke++)We=st[Ke],at=document.createElement("option"),at.setAttribute("aria-label",We),at.innerHTML=We,Qe.add(at),We==Ge.zimTabParent.currentValue&&at.setAttribute("selected","selected");Qe.setAttribute("role","button")}else Qe=document.createElement("div"),Ge&&(Qe.zimObject=Ge),Qe.innerHTML="tag",Qe.setAttribute("role",h?"application":"button"),ee=="android"&&Qe.addEventListener("click",function(){Ge.dispatchEvent("click")});if(Qe.setAttribute("id",ge),Qe.setAttribute("tabindex",0),Qe.setAttribute("aria-label",Ve),Ge&&Qe.setAttribute("aria-hidden",!Ge.stage),fe=="before"?He.parentNode.insertBefore(Qe,He):He.parentNode.insertBefore(Qe,He.nextSibling),Qe.style.position="absolute",Le){Ge=Le.obj;var ct=Ge.boundsToGlobal();E.retina?(Qe.style.left=E.x+ct.x*E.scale/k+"px",Qe.style.top=E.y+ct.y*E.scale/k+"px",Qe.style.width=ct.width*E.scale/k+"px",Qe.style.height=ct.height*E.scale/k+"px"):(Qe.style.left=E.x+ct.x*E.scale+"px",Qe.style.top=E.y+ct.y*E.scale+"px",Qe.style.width=ct.width*E.scale+"px",Qe.style.height=ct.height*E.scale+"px"),Le.obj.zimTabTag=Qe}else Qe.style.left="-1000px",Qe.style.top=E.y+"px";return Qe.style.overflow="hidden",Qe.style.zIndex=-5,Qe.style.fontSize="20px",Qe.style.color="rgba(0,0,0,.01)",I.push(Qe),Qe}var xe=!1,Be=!0,me=E.on("keydown",function(ge){if(ge.keyCode==9&&(Oe()||(xe=!1,X.tabIndex!=-1&&(X.tabIndex=-1)),xe?de(ge):Ye(ge)),xe&&q.length>0&&X.tabIndex>=0&&ge.keyCode==13){var Ve=q[X.tabIndex],He=Ve.obj;if(Ve&&He.stage){var Le=new $e.Event("mousedown"),fe=new $e.Event("click");Le.fromEnter=fe.fromEnter=!0,He.type=="Pane"?(He.backdrop.dispatchEvent(Le),He.backdrop.dispatchEvent(fe)):(He.dispatchEvent(Le),He.dispatchEvent(fe))}}});function Oe(){for(var ge=!1,Ve=0;Ve<I.length;Ve++)if(document.activeElement==I[Ve]){ge=!0;break}return!!(document.activeElement==E.canvas||ge)}function Ye(ge){!E.shiftKey&&(_n(U+"PrefixTab")==document.activeElement||E.canvas==document.activeElement)?(q.length>0&&(q[q.length-1].obj.focus=!0),Be=!0,xe=!0,de(ge)):E.shiftKey&&(_n(U+"SuffixTab")==document.activeElement||_n(U+"BufferTab")==document.activeElement)&&(q.length>0&&(q[0].obj.focus=!0),Be=!0,xe=!0,de(ge))}function de(ge){if(ge.ctrlKey){Me(ge.shiftKey?-1:1);return}ge.shiftKey?X.tab(-1):X.tab(1),ge.preventDefault()}var ve;this.tab=function(ge){if(clearTimeout(ve),Z&&E.stage.removeChild(Z),n(ge)&&(ge=1),q.length==0){Me(ge);return}for(var Ve=0;Ve<q.length;Ve++){var He=q[Ve].obj;if(He.focus){He.focus=!1;var Le=Ve+ge,fe=(Le+q.length*1e4)%q.length,Ge=q[fe];He=Ge.obj;for(var Qe=0,Ke=!1;!(He.stage&&(!He.zimTabParent&&(n(He.enabled)||He.enabled)||He.zimTabParent&&(n(He.zimTabParent.enabled)||He.zimTabParent.enabled)));)if(Qe++,Le=Le+ge,fe=(Le+q.length*100)%q.length,Ge=q[fe],He=Ge.obj,Qe==q.length){Ke=!0;break}if(Ke||!X.cycle&&Le!=fe&&!Be){Me(ge);return}Be=!1,X.tabIndex=fe;break}}};function Me(ge){xe=!1,_n(U+(ge==1?"SuffixTab":"PrefixTab")).focus(),E.stage.removeChild(P),E.stage.update(),X.tabIndex=-1}this.changeTitle=function(ge,Ve,He){if(typeof ge!="number"&&(ge=ge.zimTabIndex),!n(ge)){if(He&&n(Ve)){X.tabIndex=ge;return}var Le=q[ge],fe=Le.obj;n(Ve)&&(Ve=fe.zimTabTag.getAttribute("aria-label").split(" - currently")[0]),Le.title=Ve,_e(Le),fe.zimTabTag.setAttribute("aria-label",Le.title),He&&(X.tabIndex=ge)}};var we=!1;this.talk=function(ge){we||(y=$(U+"TalkTab","",G),y.setAttribute("role","alert"),we=!0),y.removeAttribute("role"),y.setAttribute("aria-label",ge),y.setAttribute("role","alert");var Ve=new $e.Event("change");Ve.title=ge,X.dispatchEvent(Ve)},this.resize=function(ge){if(n(ge))for(var Le=0;Le<q.length;Le++)fe(q[Le].obj);else{if(typeof ge!="number"&&(ge=ge.zimTabIndex),ge<0)return;var Ve=q[ge],He=Ve.obj;!He.stage&&Z&&He==X.currentObject&&(E.stage.removeChild(Z),E.stage.update()),fe(He)}function fe(Ge){if(Ge.type=="TextArea"||Ge.type=="Loader"){Ge.resize();return}else{var Qe=Ge.boundsToGlobal(),Ke=Ge.zimTabTag;E.retina?(Ke.style.left=E.x+Qe.x*E.scale/k+"px",Ke.style.top=E.y+Qe.y*E.scale/k+"px",Ke.style.width=Qe.width*E.scale/k+"px",Ke.style.height=Qe.height*E.scale/k+"px"):(Ke.style.left=E.x+Qe.x*E.scale/k/k+"px",Ke.style.top=E.y+Qe.y*E.scale/k/k+"px",Ke.style.width=Qe.width*E.scale/k/k+"px",Ke.style.height=Qe.height*E.scale/k/k+"px")}Ke.setAttribute("aria-hidden",!Ge.stage),Ke.hidden=!Ge.stage}},Object.defineProperty(this,"currentObject",{get:function(){return q[V]&&q[V].obj?q[V].obj:null},set:function(ge){for(var Ve=0;Ve<q.length;Ve++)if(q[Ve].obj==ge){X.tabIndex=Ve;break}}});var Fe=!0;Object.defineProperty(this,"enabled",{get:function(){return Fe},set:function(ge){Fe=ge}}),this.dispose=function(){S&&S.graphics.clear(),X.tabOrder=[];for(var ge=0;ge<I.length;ge++)I[ge].parentElement&&(I[ge].outerHTML="");Ce(),X.removeAllEventListeners(),E.off("keydown",me)}},e.extend(e.Accessibility,$e.EventDispatcher,null,"cjsEventDispatcher",!1),e.TextureActive=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R){var T="width, height, color, color2, angle, borderColor, borderWidth, corner, interactive, animated, backingOrbit, pattern, scalePattern, style, group, inherit",L;if(L=mt(e.TextureActive,arguments,T,this))return L;qe("35.2"),this.group=A;var S=P===!1?{}:e.getStyle("TextureActive",this.group,R);n(t)&&(t=S.width!=null?S.width:le.zdf.width),n(r)&&(r=S.height!=null?S.height:le.zdf.height),n(_)&&(_=S.interactive!=null?S.interactive:!0),n(b)&&(b=S.animated!=null?S.animated:!0),n(i)&&(i=S.color!=null?S.color:null),n(o)&&(o=S.color2!=null?S.color2:null),n(l)&&(l=S.angle!=null?S.angle:null),n(f)&&(f=S.borderColor!=null?S.borderColor:null),n(h)&&(h=S.borderWidth!=null?S.borderWidth:null),f<0||h<0?f=h=null:f!=null&&h==null&&(h=1),n(p)&&(p=S.corner!=null?S.corner:10),n(w)&&(w=S.backingOrbit!=null?S.backingOrbit:!0),n(C)&&(C=S.pattern!=null?S.pattern:null),n(O)&&(O=S.scalePattern!=null?S.scalePattern:null),this.zimPage_constructor(t,r,i,o,l,C,O,null,P,A,R),this.type="TextureActive",p&&(this.backing.corner=p),n(h)||(this.backing.borderWidth=h),n(f)||(this.backing.borderColor=f),(h||!n(f))&&(this.backing.siz(this.width-h,this.height-h),this.backing.center()),this.backing.mouseChildren=!1,this.interactive=_,this.animated=b,this.backingOrbit=w,P!==!1&&e.styleTransforms(this,S),this.clone=function(){return this.cloneProps(new e.TextureActive(t,r,i,o,l,f,h,p,_,b,w,C,O,P,this.group,R))}},e.extend(e.TextureActive,e.Page,["clone"],"zimPage",!1),e.TextureActive.makeLogo=function(t,r){n(t)&&(t="light");var i=t!="dark",o=i?e.light:e.dark,l=i?e.dark:e.light,f=i?e.white:e.black,h=i?e.black:e.white,p=new e.Container(400,100),_=le.zdf.makeIcon(o,l,[o,o,o,o,o]).ske(0,30).scaleTo(p,100,100).center(p),b=new e.Rectangle((400-_.width)/2+4,80-10,new e.GradientColor([i?o:f,i?f:o,i?o:f],-70),h,.5).addTo(p),w=b.clone().pos(0,0,"right","bottom",p);return new e.Label({text:"Texture",size:50,color:l,variant:!0}).scaleTo(b,75,75).center(b),new e.Label({text:"Active",size:50,color:l,variant:!0}).scaleTo(b,72,72).center(w),r?p:p.noMouse()},e.TextureActive.makeBacking=function(t,r,i,o){n(t)&&(t=800),n(r)&&(r=600),n(i)&&(i="CANVAS WINDOW"),n(o)&&(o=e.light);var l=new e.Container(t,r);return l.icon=le.zdf.makeIcon({box:black}).sca(2),l.label=new e.Label({text:i,size:25,color:o,align:"center"}).reg("center"),l.tile=new e.Tile({obj:[l.icon,l.label],rows:2,spacingV:24,unique:!0,align:CENTER}).scaleTo(l,50,70).center(l),l.tile.items[1].mov(0,10),l},e.TextureActives=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L){var S="actives, threejs, zimThree, renderer, scene, camera, controls, layers, near, far, ignoreList, toggleKey, color, outerColor, damp, style, group, inherit",E;if(E=mt(e.TextureActives,arguments,S,this))return E;qe("35.4"),this.group=T;var k=R===!1?{}:e.getStyle("TextureActives",this.group,L),X,q,V="ZIM TextureActives - need a ZIM Frame";if(n(t)&&n(t[0]))if(le.zdf)q=le.zdf,X=le.zdf.stage;else{ht(V);return}else if(n(t)||n(t[0])||n(t[0].stage))if(le.zdf)q=le.zdf,X=le.zdf.stage;else{ht(V);return}else X=t[0].stage,q=X.frame;n(t)&&(t=k.actives!=null?k.actives:null),n(r)&&(r=k.threejs!=null?k.threejs:null),n(i)&&(i=k.zimThree!=null?k.zimThree:null),n(o)&&(o=k.renderer!=null?k.renderer:null),n(l)&&(l=k.scene!=null?k.scene:null),n(f)&&(f=k.camera!=null?k.camera:null),n(h)&&(h=k.controls!=null?k.controls:null),n(p)&&(p=k.layers!=null?k.layers:[]),Array.isArray(p)||(p=[p]),n(_)&&(_=k.near!=null?k.near:void 0),n(b)&&(b=k.far!=null?k.far:void 0),n(w)&&(w=k.ignoreList!=null?k.ignoreList:[]),Array.isArray(w)||(w=[w]),n(C)&&(C=k.toggleKey!=null?k.toggleKey:"t"),n(O)&&(O=k.color!=null?k.color:e.darker),n(P)&&(P=k.outerColor!=null?k.outerColor:"black"),n(A)&&(A=k.damp!=null?k.damp:null);var I=this;e.TAM||(e.TAM=new e.TextureActivesManager(X,C,A),o&&o.domElement&&o.domElement.addEventListener("mousedown",U=>{U.preventDefault()})),I.manager=e.TAM,this.ignoreList=w,this.raycast=!0,this.renderer=o,this.layers=p,this.animated=!1,this.interactive=!1,this.actives=[],this.threeMeshes=[];var te=!1;function B(U){n(U)&&(U=[]),Array.isArray(U)||(U=[U]);var ee=0,ae,re;return e.loop(U,function(he){I.actives.indexOf(he)<0&&(I.actives.push(he),he.cache(),he.canvas.content=he,he.interactive&&(ae=!0,he.canvas.isTextureActive=!0),he.animated&&(re=!0),ee++)}),ae&&!I.interactive&&(I.interactive=!0,ee>0&&Z()),re&&!I.animated&&(I.animated=!0),ee}B(t),e.TAM.updateTile(I,I.actives),e.TAM.color=O,e.TAM.outerColor=P,q.canvas.style.display="none";function Z(){if(te)return;te=!0,I.pointerCheck||(I.pointerCheck=e.TAM.addPointer(I)),I.pointerData={x:q.mouseX,y:q.mouseY,mousedown:!1};var U=window.innerWidth,ee=window.innerHeight,ae=-1,re=-2,he=-1,j=-2;I.overInterval=e.interval(.05,function(){if(re&&re!=ae||j&&j!=he){var m=new $e.Event("rayover");m.mesh=I.mesh=re,m.material=I.material=j,j.userData&&(m.textureActive=I.textureActive=j.userData.ta_content),m.intersect=I.intersect,I.dispatchEvent(m),h&&!h.screenSpacePanning&&(h.activeLook=!1)}else if(!re&&ae||!j&&he){var m=new $e.Event("rayout");m.mesh=ae,m.material=he,he.userData&&(m.textureActive=he.userData.ta_content),m.intersect=I.intersect,I.dispatchEvent(m),h&&!h.screenSpacePanning&&(h.activeLook=!0)}ae=re,he=j});var G=I.raycaster=new r.Raycaster(void 0,void 0,_,b);p.length>0&&e.loop(p,function(m){G.layers.set(m)});var y;window.addEventListener("pointerdown",g);function g(m){if(I.raycast){var F;!i||i.resizeEvent?F={x:m.clientX/window.innerWidth*2-1,y:1-m.clientY/window.innerHeight*2}:F={x:m.clientX/U*2-1,y:1-m.clientY/ee*2},G.setFromCamera(F,f);var Ce=G.intersectObjects(l.children);y=null;var Y,Q,ce;for(Q=0;Q<Ce.length;Q++)if(Y=Ce[Q].object,!(I.ignoreList.indexOf(Y)>-1)){if(I.threeMeshes.indexOf(Y)>-1)if(Y.material&&Array.isArray(Y.material))ce=Y.material[Ce[Q].face.materialIndex];else if(Y.material)ce=Y.material;else break;if(ce&&ce.map&&ce.map.source&&ce.map.source.data&&ce.map.source.data.isTextureActive&&ce.userData.ta_content){y=Y;var pe=ce.userData.ta_content;if(I.pointerData.mousedown=!0,K(pe,Ce[Q],ce.userData.ta_flipped),$e.handleRemotePointer(I.pointerData.x,I.pointerData.y,"down",m,X,m.pointerID),h&&h.maxAzimuthAngle&&pe)if(pe.backingOrbit){var J=pe.globalToLocal(q.mouseX,q.mouseY),ue=pe.backing;ue&&pe.getObjectUnderPoint(J.x,J.y,1)!=ue?h.enableRotate=!1:h.enableRotate=!0}else h.enableRotate=!1;var m=new $e.Event("raydown");m.mesh=I.mesh=Y,m.material=I.material=ce,m.textureActive=I.textureActive=pe,m.intersect=I.intersect=Ce[Q],I.dispatchEvent(m);break}else break}}}window.addEventListener("pointerup",d);function d(m){if(I.raycast){if(I.pointerData.mousedown=!1,h&&h.maxAzimuthAngle&&(h.enableRotate=!0),y){var m=new $e.Event("rayup");m.mesh=I.mesh,m.material=I.material,m.textureActive=I.textureActive,m.intersect=I.intersect,I.dispatchEvent(m)}y=null,$e.handleRemotePointer(null,null,"up",m,X,-1)}}window.addEventListener("pointermove",D);function D(m){if(I.raycast){var F;!i||i.resizeEvent?F={x:m.clientX/window.innerWidth*2-1,y:1-m.clientY/window.innerHeight*2}:F={x:m.clientX/U*2-1,y:1-m.clientY/ee*2},G.setFromCamera(F,f);var Ce=!1,Y,Q,ce;if(y){let ue=G.intersectObject(y);if(ue.length>0&&(Y=y,Y.material&&Array.isArray(Y.material)?ce=Y.material[ue[0].face.materialIndex]:Y.material&&(ce=Y.material),ce)){var pe=ce.userData.ta_content;K(pe,ue[0],ce.userData.ta_flipped),$e.handleRemotePointer(I.pointerData.x,I.pointerData.y,"move",m,X,m.pointerID),Ce=!0;var m=new $e.Event("raymove");m.mesh=re=I.mesh=Y,m.material=j=I.material=ce,m.textureActive=I.textureActive=pe,m.intersect=I.intersect=ue[0],I.dispatchEvent(m)}}else{var J=G.intersectObjects(l.children);for(Q=0;Q<J.length;Q++)if(Y=J[Q].object,!(I.ignoreList.indexOf(Y)>-1)){if(I.threeMeshes.indexOf(Y)>-1)if(Y.material&&Array.isArray(Y.material))ce=Y.material[J[Q].face.materialIndex];else if(Y.material)ce=Y.material;else break;if(ce&&ce.map&&ce.map.source&&ce.map.source.data&&ce.map.source.data.isTextureActive&&ce.userData.ta_content){var pe=ce.userData.ta_content;K(pe,J[Q],ce.userData.ta_flipped),$e.handleRemotePointer(I.pointerData.x,I.pointerData.y,"move",m,X,m.pointerID),Ce=!0;var m=new $e.Event("raymove");m.material=j=I.material=ce,m.mesh=re=I.mesh=Y,m.textureActive=I.textureActive=pe,m.intersect=I.intersect=J[Q],I.dispatchEvent(m);break}else break}}Ce||(re=null,j=null),e.TAM.setActive(I,Ce)}}function K(m,F,Ce){if(!(!m||!m.getBounds)){var Y=m.getBounds(),Q=Ce?Y.width-F.uv.x*Y.width:F.uv.x*Y.width,ce=(1-F.uv.y)*Y.height,pe=m.localToGlobal(Q,ce);I.pointerData.x=pe.x,I.pointerData.y=pe.y}}}this.add=function(U){var ee=B(U);return ee>0&&e.TAM.updateTile(I,I.actives),I},this.remove=function(U){n(U)&&(U=[]),Array.isArray(U)||(U=[U]);var ee=0;return e.loop(U,function(ae){if($e.remoteQueue){var re=$e.remoteQueue.indexOf(ae);re>=0&&$e.remoteQueue.splice(re,1)}re=I.actives.indexOf(ae),re>=0&&(I.actives.splice(re,1),ee++),ae.textureMap&&delete ae.textureMap.userData.ta_content,re=I.threeMeshes.indexOf(ae),re>=0&&I.threeMeshes.splice(re,1),ae.dispose()},!0),ee>0&&e.TAM.updateTile(I,I.actives),I},I.addMesh=function(U,ee){if(n(ee)||U.layers.enable(ee),U.material){var ae=I.threeMeshes.indexOf(U);if(ae<0)I.threeMeshes.push(U);else return I;var re;Array.isArray(U.material)?re=U.material:re=[U.material],U.onBeforeRender=function(){U.userData.ta_viewID&&clearTimeout(U.userData.ta_viewID),U.userData.ta_viewID=setTimeout(function(){U.userData.ta_view=!1,$e.remoteQueue&&e.loop(U.userData.ta_content,function(he){var j=$e.remoteQueue.indexOf(he);j>=0&&$e.remoteQueue.splice(j,1)},!0)},100),U.userData.ta_view||(U.userData.ta_view=!0,e.loop(U.userData.ta_content,function(he){$e.remoteQueue.indexOf(he)<0&&$e.remoteQueue.push(he)}))},U.userData.ta_content=[],e.loop(re,function(he){if(he&&he.map&&he.map.source&&he.map.source.data&&he.map.source.data.content){var j=he.map.source.data.content;U.userData.ta_content.push(j),j.mesh=U,U.textureActive=!0,he.userData.ta_content=j,j.textureMaps||(j.textureMaps=[]);var G=j.textureMaps.indexOf(he.map);G<0&&j.textureMaps.push(he.map),(j.animated||j.interactive)&&($e.remoteQueue||($e.remoteQueue=[]))}})}return I},I.dispose=function(){I.raycast=!1,h&&(h.enableRotate=!0,h.enabled=!0),I.remove(I.actives),e.TAM.remove(I),e.TAM.count<1&&(e.TAM.dispose(),e.TAM=null),I.material=I.mesh=I.content=I.intersect=null}},e.extend(e.TextureActives,$e.EventDispatcher,"dispose"),e.TextureActivesManager=function(t,r,i){qe("35.6");var o=this;this.type="TextureActivesManager",o.color=e.darker,o.outerColor="black";var l=!1;o.toggleKey=r||"t",(n(i)||i===!0)&&(i=.2);var f=o.objects=new e.Dictionary(!0),h=t.frame,p=new e.Proportion({baseMin:1e3,baseMax:9e3,targetMin:-.1,targetMax:-.05,clamp:!1});o.backing=new e.Rectangle(100,100,e.faint).addTo(t,0);var _=[];o.updateTile=function(L,S,E){E||f.add(L,S);var k=[];if(_=[],e.loop(f,function(q,V){e.loop(V,function(I){k.push(I),I.loop(function(te){(te.type=="Scrambler"||te.type=="List"||te.type=="Window")&&_.push(te)})})}),k.length<0){var X=o.message=new e.Rectangle(W,H,e.yellow);new e.Label("No TextureActives Added").center(X),k.push(X)}o.tile?(o.tile.cols=k.length,o.tile.remake(k)):o.tile=new e.Tile(k,k.length,1,20,0,!0).addTo(t),o.backing.scaleTo(o.tile,100,100,"full").siz(null,t.height,!0),o.swiper&&(o.swiper.sensitivity=e.constrain(p.convert(o.tile.width),-.1,-.01))},this.addPointer=function(L){var S=[];return e.loop(f,function(E){S.indexOf(E.renderer.domElement)<0&&S.push(E.renderer.domElement)}),S.indexOf(L)<0&&S.push(L.renderer.domElement),$e.remotePointers?$e.remotePointers=S:$e.addRemotePointers(t,S),!0},this.setActive=function(L,S){if(L.active=S,!S){var E=e.loop(f,function(k){if(k.active)return!1});E&&(t.mouseInBounds=!1)}};var b=!1,w=this.nav=new e.Panel({width:200,height:80,titleBar:"TextureActives",draggable:!0,close:!0}).pos(50,50,RIGHT,BOTTOM),C=this.slider=new e.Slider({min:0,max:100,damp:!0}).scaleTo(w,80);C.on("mousedown",function(){b=!0,o.swiper.enabled=!1,P()}),C.on("pressup",function(){o.swiper.immediate(C.currentValue),o.swiper.enabled=!0,A(),b=!1}),w.on("close",function(){o.hide(),w.addTo()});var O=0;this.ticker=e.Ticker.add(function(){o.tile.x=-C.currentValue*(o.tile.width-W)/100,l&&!b&&O!=0&&O!=100&&(C.currentValue==0||C.currentValue==100)&&A(),O=C.currentValue}),w.add(C,0,!0),w.removeFrom(),e.Ticker.remove(o.ticker);function P(){l||(l=!0,e.loop(_,function(L){L.enabled=!1}))}function A(){l&&(l=!1,e.loop(_,function(L){L.enabled=!0,L.update()}))}o.swiper=new e.Swiper({swipeOn:o.backing,target:C,property:"currentValue",sensitivity:o.tile?e.constrain(p.convert(tile.width),-.1,-.01):-.1,damp:i}),o.backing.on("mousedown",function(){O=-100,P()}),o.swiper.on("swipestop",A),o.toggled=!1;var R=h.color,T=h.outerColor;this.show=function(){if(!o.toggled)return h.color=o.color,h.outerColor=o.outerColor,o.toggled=!0,e.Ticker.add(o.ticker),w.addTo(),e.loop(f,function(L){L.lastRaycast=L.raycast,L.raycast=!1,L.renderer.domElement.style.display="none"}),$e.remoteQueue&&e.loop(o.tile.items,function(L){$e.remoteQueue.indexOf(L)<0&&$e.remoteQueue.push(L)}),h.canvas.style.display="block",$e.removeRemotePointers(t),this},this.hide=function(){if(o.toggled){h.color=R,h.outerColor=T,o.toggled=!1,e.Ticker.remove(o.ticker),w.removeFrom();var L=[];return e.loop(f,function(S){S.raycast=S.lastRaycast,S.renderer.domElement.style.display="block",L.push(S.renderer.domElement)}),$e.remoteQueue&&($e.remoteQueue=[],e.loop(o.tile.items,function(S){S.mesh&&(S.mesh.userData.ta_view=!1)})),h.canvas.style.display="none",$e.addRemotePointers(t,L),this}},o.toggle=function(L){return n(L)&&(L=!o.toggled),L&&!o.toggled?o.show():!L&&o.toggled&&o.hide(),this},o.keyEvent=h.on("keydown",function(L){L.key==o.toggleKey&&(o.toggled?o.hide():o.show())}),o.remove=function(L){f.remove(L),o.updateTile(null,null,!0)},o.dispose=function(){o.hide(),w.dispose(),h.off("keydown",o.keyEvent),o.backing.removeAllEventListeners(),o.backing.dispose(),o.objects.dispose(),o.tile.dispose(),o.objects=o.tile=w=null}},e.extend(e.TextureActivesManager,$e.EventDispatcher),e.Manager=function(t){qe("75");var r=this;this.type=t,this.items=[],this.add=function(l){return Array.isArray(l)?r.items=r.items.concat(l):r.items.push(l),r};var i,o;this.remove=function(l){if(r){if(!l)r.items=[];else for(Array.isArray(l)||(l=[l]),i=l.length-1;i>=0;i--){o=l[i];var f=r.items.indexOf(o);f!=-1&&r.items.splice(f,1)}return r}},this.resize=function(l){if(r){if(l)for(Array.isArray(l)||(l=[l]),i=l.length-1;i>=0;i--)o=l[i],!o.resize&&r.items.indexOf(o)!=-1?r.items.splice(r.items.indexOf(o),1):o.resize();else for(i=r.items.length-1;i>=0;i--)r.items[i].resize?r.items[i].resize():r.items.splice(i,1);return r}},this.toggle=function(l,f){if(r){if(f)for(Array.isArray(f)||(f=[f]),h=f.length-1;h>=0;h--)o=f[h],!o.resize&&r.items.indexOf(o)!=-1?r.items.splice(r.items.indexOf(o),1):o.toggle(l);else for(var h=r.items.length-1;h>=0;h--)r.items[h].resize?r.items[h].toggle(l):r.items.splice(h,1);return r}},this.dispose=function(l){if(r){if(r.resize=null,l)for(Array.isArray(l)||(l=[l]),i=l.length-1;i>=0;i--)o=l[i],r.items.indexOf(o)!=-1&&r.items.splice(r.items.indexOf(o)),o.dispose&&o.dispose();else{for(i=r.items.length-1;i>=0;i--)r.items[i].resize?r.items[i].dispose():r.items.splice(i,1);r.items=null}return!0}}},e.ResizeManager=function(){qe("75.5"),e.Manager.call(this,"ResizeManager")},e.ResizeManager.prototype=new e.Manager,e.ResizeManager.prototype.constructor=e.ResizeManager,e.TransformManager=function(t,r){qe("75.7");var i=this;this.type="TransformManager",this.persistID=r,this.items=[];function o(f){!localStorage||f&&!f.pressup||i.savePersist(f)}this.add=function(f){var h=[];Array.isArray(f)?h=f:h=[f];for(var p,_=!1,b=0;b<h.length;b++)if(p=h[b],p.transformControls&&(p.originalVisible=p.transformControls.visible),p.toggle&&p.toggle(!1),i.items.length==0&&b==0&&(_=!0),p.type=="Blob"||p.type=="Squiggle")i.persistID||_&&(_=!1,p.controlsVisible=!0,i.currentObject=p),p.on("change",function(C){var O=new $e.Event("transformed");O.transformObject=C.target,O.transformType=C.controlType,i.dispatchEvent(O)}),p.on("controlsshow",function(C){var O=new $e.Event("transformshow");i.currentObject=O.transformObject=C.target,i.dispatchEvent(O)}),p.on("controlshide",function(C){var O=new $e.Event("transformhide");O.transformObject=C.target,i.currentObject=null,i.dispatchEvent(O)}),p.on("update",function(C){var O=new $e.Event("transformed");O.transformObject=C.target,O.transformType=C.controlType,i.dispatchEvent(O)});else if(p.type=="Connectors")i.persistID||_&&(_=!1,i.currentObject=p),p.on("connection",function(C){var O=new $e.Event("transformed");O.transformObject=C.target,O.transformType="connection",i.dispatchEvent(O)});else if(p.type=="Pack")i.persistID||_&&(_=!1,i.currentObject=p),p.on("change",function(C){var O=new $e.Event("transformed");O.transformObject=C.target,O.transformType="change",i.dispatchEvent(O)});else{var w=p.transformControls;i.persistID||_&&p.type!="Layer"&&(_=!1,p.originalVisible&&(w.show(),i.currentObject=p)),p.on("transformed",function(C){var O=new $e.Event("transformed");O.transformObject=C.target,O.transformType=C.transformType,i.dispatchEvent(O)}),p.on("transformshow",function(C){var O=new $e.Event("transformshow");i.currentObject=O.transformObject=C.target,i.dispatchEvent(O)}),p.on("transformhide",function(C){var O=new $e.Event("transformhide");O.transformObject=C.target,i.currentObject=null,i.dispatchEvent(O)})}i.items=i.items.concat(f),i.persist&&!n(i.persistID)&&i.persist(i.persistID)},this.remove=function(f){if(n(f)){i.items=[];return}Array.isArray(f)||(f=[f]);for(var h,p=0;p<f.length;p++){h=f[p],i.currentObject==h&&(i.currentObject=null),h.transformedEvent&&(h.off("transformed",h.transformedEvent),h.transformedEvent=null),h.type=="Blob"||h.type=="Squiggle"?h.controlsVisible=!1:h.transformControls&&h.transformControls.remove();var _=i.items.indexOf(h);_!=-1&&i.items.splice(_,1)}r&&i.savePersist()},this.show=function(f){if(!n(f)){if(f.type=="Blob"||f.type=="Squiggle")f.controlsVisible||(f.controlsVisible=!0);else{var h=f.transformControls;if(!h||h.visible)return;h.show()}i.currentObject=f}},this.hide=function(f){if(!n(f))if(i.currentObject==f&&(i.currentObject=null),f.type=="Blob"||f.type=="Squiggle")f.controlsVisible&&(f.controlsVisible=!1);else{var h=f.transformControls;if(!h||h.visible)return;h.hide()}},this.hideAll=function(f){for(var h,p,_=0;_<i.items.length;_++)if(p=i.items[_],!p||!(p.transformControls||p.update))i.items.splice(_);else{if(i.items[_]==f)continue;p.type=="Blob"||p.type=="Squiggle"?p.controlsVisible&&(p.controlsVisible=!1):(h=i.items[_].transformControls,h.visible&&h.hide())}i.currentObject=null},this.resize=function(){if(i){for(var f,h=0;h<i.items.length;h++)f=i.items[h],!f||!(f.transformControls||f.update)?i.items.splice(h):f.type=="Blob"||f.type=="Squiggle"?f.update():f.transformControls.resize();r&&i.savePersist()}},n(t)||i.add(t);var l="TransformManager persist(persistID) - sorry, must provide id";this.persist=function(f){var h,p;if(n(f)&&Ct){ht(l);return}i.persistID=f;var _=0;if(localStorage&&localStorage[f]){var b=i.persistData=JSON.parse(localStorage[f]);if(b.length==i.items.length)for(p=0;p<i.items.length;p++)b[p].controls&&(i.currentObject=i.items[p]),b[p]&&(b[p].type=="Blob"||b[p].type=="Squiggle")?(i.items[p].points.length!=b[p].points.length&&(i.items[p].points=b[p].points),i.items[p].setData(b[p]),i.items[p]==i.currentObject&&i.currentObject.toggle(!0),_++,_==b.length&&setTimeout(function(){i.dispatchEvent("persistcomplete")},100)):b[p]&&b[p].type=="Connectors"?(i.items[p].setSteps(b[p].steps),i.items[p].loc(b[p].x,b[p].y),i.items[p].sca(b[p].scale),_++,_==b.length&&setTimeout(function(){i.dispatchEvent("persistcomplete")},100)):b[p]&&b[p].type=="Pack"?(i.items[p].setOrder(b[p].order),i.items[p].outerWidth=b[p].outerWidth,i.items[p].outerHeight=b[p].outerHeight,_++,_==b.length&&setTimeout(function(){i.dispatchEvent("persistcomplete")},100)):b[p]&&(n(i.items[p].transformControls)?-function(){var w=h=i.items[p],C=b[p];e.interval(50,function(O){w.transformControls&&(w.transformControls.setData(C),w.dispatchEvent("persistset"),_++,_==b.length&&(setTimeout(function(){w==i.currentObject&&i.currentObject.toggle(!0),i.dispatchEvent("persistcomplete")},100),O.clear()))},20,null,null,"ms")}():(i.items[p].transformControls.setData(b[p]),-function(){var w=h=i.items[p];e.interval(50,function(C){w.dispatchEvent("persistset"),_++,_==b.length&&(setTimeout(function(){w==i.currentObject&&i.currentObject.toggle(!0),i.dispatchEvent("persistcomplete")},100),C.clear())},20,null,null,"ms")}()))}for(p=0;p<i.items.length;p++)h=i.items[p],h.transformedEvent||(h.type=="Blob"||h.type=="Squiggle"?(h.transformedEvent=h.on("change",function(w){w.pressup=!0,o(w)}),h.transformedUEvent=h.on("update",function(w){w.pressup=!0,o(w)}),h.transformedSEvent=h.on("controlsshow",function(w){w.pressup=!0,o(w)}),h.transformedHEvent=h.on("controlshide",function(w){w.pressup=!0,o(w)})):h.type=="Connectors"?h.transformedEvent=h.on("connection",function(w){w.pressup=!0,o(w)}):h.type=="Pack"?h.transformedEvent=h.on("change",function(w){w.pressup=!0,o(w)}):(h.transformedEvent=h.on("transformed",o),h.transformedSEvent=h.on("transformshow",o),h.transformedHEvent=h.on("transformhide",o)))},this.savePersist=function(){for(var f=[],h=0;h<i.items.length;h++){var p=i.items[h];p.type=="Blob"||p.type=="Squiggle"?p.recordData&&f.push(p.recordData()):p.type=="Connectors"?f.push({type:p.type,x:p.x,y:p.y,scale:p.scale,steps:p.getSteps()}):p.type=="Pack"?f.push({type:p.type,outerWidth:p.outerWidth,outerHeight:p.outerHeight,order:p.getOrder()}):p.transformControls&&p.transformControls.recordData&&f.push(p.transformControls.recordData())}i.persistData=f,localStorage[i.persistID]=JSON.stringify(f)},this.clearPersist=function(f){if(n(f)&&Ct){ht(l);return}i.persistData=null,localStorage&&localStorage.removeItem(f)},this.stopPersist=function(){for(var f=0;f<i.items.length;f++){var h=i.items[f];h.transformedEvent&&(h.type=="Blob"||h.type=="Squiggle"?(h.off("change",h.transformedEvent),h.off("update",h.transformedUEvent),h.off("controlsshow",h.transformedSEvent),h.off("controlshide",h.transformedHEvent)):h.type=="Connectors"?h.off("connection",h.transformedEvent):h.type=="Pack"?h.off("change",h.transformedEvent):(h.off("transformed",h.transformedEvent),h.off("transformshow",h.transformedSEvent),h.off("transformhide",h.transformedHEvent)),h.transformedEvent=null,h.transformedUEvent=null,h.transformedSEvent=null,h.transformedHEvent=null)}i.persistData=null},n(r)||i.persist(r),this.dispose=function(f,h){if(n(f)&&(f=!0),i.removeAllEventListeners(),i.persistID&&f&&i.stopPersist(),h)for(var p=0;p<i.items.length;p++){var _=i.items[p];_.type=="Blob"||_.type=="Squiggle"?_.dispose():_.transformControls.dispose()}}},e.extend(e.TransformManager,$e.EventDispatcher,null,"cjsEventDispatcher",!1),e.GuideManager=function(){qe("77"),e.Manager.call(this,"GuideManager")},e.GuideManager.prototype=new e.Manager,e.GuideManager.prototype.constructor=e.GuideManager,e.GridManager=function(){qe("79"),e.Manager.call(this,"GridManager")},e.GridManager.prototype=new e.Manager,e.GridManager.prototype.constructor=e.GridManager,e.LayoutManager=function(){qe("81"),e.Manager.call(this,"LayoutManager")},e.LayoutManager.prototype=new e.Manager,e.LayoutManager.prototype.constructor=e.LayoutManager,e.SelectionSet=function(t){qe("81.5"),this.type="SelectionSet",n(t)&&(t=[]),this.selections=t,this.clear=function(){this.selections=[]},this.isSelected=function(r){return this.selections.indexOf(r)>=0},this.add=function(r,i,o,l){if(!n(r)){n(i)&&(n(this.selectionManager)||(i=this.selectionManager.multiple)),n(this.selectionManager)||(this.selectionManager.setCurrent(this),!i&&this.selectionManager.multipleSets&&this.selectionManager.clear()),i||this.clear();var f=this.selections.indexOf(r);if(!(f>=0)){if(this.selections.push(r),!n(o)){Array.isArray(o)||(o=[o]);for(var h=0;h<=o.length;h++)o[h].add(r,i)}if(!n(l))for(Array.isArray(l)||(l=[l]),h=0;h<=l.length;h++)l[h].remove(r,i)}}},this.remove=function(r,i,o,l){if(!n(r)){n(i)&&(n(this.selectionManager)||(i=this.selectionManager.multiple)),n(this.selectionManager)||this.selectionManager.setCurrent(this),i||this.clear();var f=this.selections.indexOf(r);if(n(this.selectionManager)||(this.selectionManager.setCurrent(this),!i&&this.selectionManager.multipleSets&&this.selectionManager.clear()),i||this.clear(),i?f>=0&&this.selections.splice(f,1):this.clear(),!n(o)){Array.isArray(o)||(o=[o]);for(var h=0;h<=o.length;h++)o[h].remove(r,i)}if(!n(l))for(Array.isArray(l)||(l=[l]),h=0;h<=l.length;h++)l[h].add(r,i)}},this.toggle=function(r,i,o,l){this.isSelected(r)?this.remove(r,i,o,l):this.add(r,i,o,l)},this.dispose=function(){return this.clear(),this.selections=null,!0}},e.SelectionManager=function(t,r,i){qe("81.6"),this.cjsEventDispatcher_constructor(),this.type="SelectionManager",n(t)&&(t=[]),n(i)&&(i=!0),Array.isArray(t)||(t=[t]),this.sets=t,this.multipleKey=r,this.multipleSets=i,this.multiple=!1;for(var o=this,l=0;l<t.length;l++)t[l].selectionManager=this;this.clear=function(){this.currentSet=null;for(var h=0;h<t.length;h++)t[h].clear()},this.setCurrent=function(h){this.currentSet=h;for(var p=0;p<t.length;p++)t[p]!=h&&(this.multipleSets||t[p].clear())};var f=new $e.Event("keydown");this.eventRemove=f.remove,this.keydownEvent=function(h){h.remove=o.eventRemove,o.multipleKey&&(o.multiple=h[o.multipleKey+"Key"]),o.ctrlKey=h.ctrlKey,o.shiftKey=h.shiftKey,o.metaKey=h.metaKey,o.dispatchEvent(h),h.keyCode==90&&(o.ctrlKey||o.metaKey)&&o.dispatchEvent("undo")},le.addEventListener("keydown",this.keydownEvent),this.keyupEvent=function(h){o.multipleKey&&(o.multiple=h[o.multipleKey+"Key"]),o.ctrlKey=h.ctrlKey,o.shiftKey=h.shiftKey,o.metaKey=h.metaKey,h.remove=o.eventRemove,o.dispatchEvent(h)},le.addEventListener("keyup",this.keyupEvent),this.dispose=function(){this.clear(),le.removeEventListener("keydown",this.keydownEvent),le.removeEventListener("keyup",this.keyupEvent)}},e.extend(e.SelectionManager,$e.EventDispatcher,null,"cjsEventDispatcher",!1),typeof x>"u")var x;e.Bind=function(t,r,i,o,l,f,h,p){var _="connection, bindType, master, masterFilter, couple, smartDecimals, report, setDefault",b;if(b=mt(e.Bind,arguments,_,this))return b;qe("81.8"),this.type="Bind";var w=this;n(t)&&localStorage&&n(x)&&(n(r)||r==e.LOCALSTORAGE)?(t="zimBind",r=e.LOCALSTORAGE):t&&t.match(/\/|\./)?(n(r)&&(r=e.GET),t.match(/\?/)?t+="&":t+="?"):t&&n(r)&&(r=e.LOCALSTORAGE),n(f)&&(f=!0),r==e.LOCALSTORAGE&&!localStorage&&(Ct&&ht("Bind() - no localStorage"),w.error="error - no localStorage"),this.connection=t,this.bindType=r,this.master=i,this.masterFilter=o,this.smartDecimals=f,n(h)&&(h=!1),(!x||p)&&(x=this),Object.defineProperty(w,"default",{get:function(){return w==x},set:function(T){!T&&x==w?x=null:T&&(x=w)}}),this.bindType==e.POST&&(w.ajax=new e.Ajax),this.bindings={},this.ids=[],this.data={},this.objIDs=new e.Dictionary(!0),this.toIDs={},this.fromIDs={},this.add=function(T,L,S,E,k){if(n(S)||n(L)||n(T))return w;if(w.bindings[T]){if(w.bindings[T].obj!=L)return Ct&&ht("Bind() - id can be used with only one object"),w}else{w.ids.indexOf(T)<=0&&w.ids.push(T),w.bindings[T]={obj:L,props:[]},!n(k)&&typeof k=="function"&&(w.bindings[T].filter=k);var X=w.objIDs.at(L);X?X.indexOf(T)<0&&X.push(T):w.objIDs.add(L,[T])}!Array.isArray(S)&&S.constructor!={}.constructor&&(S=[S]);var q=w.bindings[T].props;Array.isArray(S)?e.loop(S,function(I){V(w.toIDs,I,T),V(w.fromIDs,I,T),q.indexOf(I)<0&&q.push(I)}):e.loop(S,function(I,te){(te==e.BOTH||te==e.TO)&&V(w.toIDs,I,T),(te==e.BOTH||te==e.FROM)&&V(w.fromIDs,I,T),q.indexOf(I)<0&&q.push(I)});function V(I,te,B){n(I[te])?I[te]=[B]:I[te].indexOf(B)<0&&I[te].push(B)}return h&&R("Bind Report: ADD ["+T+"]",(S?" "+S:"")+(E?" "+E:"")),w.bindType==e.LOCALSTORAGE?(w.from(null,T,S,E),(!w.data||e.isEmpty(w.data))&&w.to(T,S)):(P("bind",null,[k],w.data,E),w.applyData()),w},this.updatefilter=function(T,L){var S=w.bindings[T];return S&&(n(L)?S.filter&&delete S.filter:typeof L=="function"&&(S.filter=L)),w},this.remove=function(T,L,S,E,k,X){var q;if(!n(T)&&!Array.isArray(T)&&(T=[T]),!n(T)){q=[];var V=[];e.loop(T,function(he){typeof he=="string"?q.push(he):V.push(he)})}!n(L)&&!Array.isArray(L)&&(L=[L]),n(k)&&(k=!0),T=q.concat(V),T.length==0&&(T=null);var I=C("from",T,L,!1),te=I[0];I=I[1];var B=P("remove",E,te,I,S);if(B=="stop")return;var Z=e.copy(I);n(L)||L.length==0?(q.length>0&&e.loop(q,function(he){re(he,!0)}),V.length>0&&e.loop(V,function(he){q=w.objIDs.at(he),q.length>0&&e.loop(q,function(j){re(j,!1)}),w.objIDs.remove(he)})):(q=[],e.loop(I,function(he,j){var G=w.bindings[he],y=G.props;e.loop(j,function(g){var d=y.indexOf(g);d>=0&&y.splice(d,1),ae(g,he)}),y.length==0&&q.push(he)}),q.length>0&&w.remove(q));function U(he){X&&typeof X=="function"&&(l&&(he=e.couple(he)),X(he)),h&&R("Bind Report: REMOVE"+(S?" ["+S+"]":""),he)}if(k){var ee="type="+w.bindType+"&";w.bindType==e.LOCALSTORAGE?(w.to(),U("success")):w.bindType==e.GET?(B=JSON.stringify(Z),l&&(B=e.couple(B)),e.async(w.connection+ee+"remove="+B,U,"callbackRemove")):w.bindType==e.POST?w.ajax.post(w.connection+ee,Z,U,"remove"):w.bindType==e.SOCKET}function ae(he,j){var G,y;G=w.fromIDs[he],G&&(y=G.indexOf(j),y>=0&&G.splice(y,1),G.length==0&&delete w.fromIDs[he]),G=w.toIDs[he],G&&(y=G.indexOf(j),y>=0&&G.splice(y,1),G.length==0&&delete w.toIDs[he])}function re(he,j){var G=w.bindings[he].obj,y=w.bindings[he].props,g=w.objIDs.at(G),d=g.indexOf(he);d>=0&&g.splice(d,1),j&&g.length==0&&V.push(G),d=w.ids.indexOf(he),d>=0&&w.ids.splice(d,1),e.loop(y,function(D){ae(D,he)}),delete w.bindings[he]}return w};function C(T,L,S){var E=[],k;if(n(L)&&n(S)){if(T=="from"&&w.bindType!=e.LOCALSTORAGE)return e.loop(w.bindings,function(I){I.filter&&E.push(I.filter)}),[E,"full"];k=w.ids}else!n(L)&&!Array.isArray(L)&&(L=[L]),!n(S)&&!Array.isArray(S)&&(S=[S]),L&&(k=[],e.loop(L,function(I){if(typeof I=="string")k.indexOf(I)<0&&k.push(I);else{var te=w.objIDs.at(I);te&&e.loop(te,function(B){k.indexOf(B)<0&&k.push(B)})}}));var X={};return k?q(S):S&&V(),[E,X];function q(I){e.loop(k,function(te){var B=w.bindings[te];if(B){B.filter&&E.push(B.filter);var Z=B.obj;e.loop(I||B.props,function(U){var ee=w.toIDs[U];if(ee&&ee.indexOf(te)>=0)if(T=="from")X[te]||(X[te]=[]),X[te].push(U);else{X[te]||(X[te]={});var ae=Z[U];typeof ae=="number"&&w.smartDecimals&&(ae>1?ae=e.decimals(ae,1):ae=e.decimals(ae,2)),X[te][U]=e.copy(ae)}})}})}function V(){var I=[];e.loop(S,function(te){e.loop(w.toIDs[te],function(B){var Z=w.bindings[B];I.indexOf(B)<0&&(Z.filter&&E.push(Z.filter),I.push(B));var U=Z.obj;if(T=="from")X[B]||(X[B]=[]),X[B].push(te);else{X[B]||(X[B]={});var ee=U[te];typeof ee=="number"&&w.smartDecimals&&(ee>1?ee=e.decimals(ee,1):ee=e.decimals(ee,2)),X[B][te]=e.copy(ee)}})})}}this.stopProcess=!1,this.stop=function(){w.stopped=!0};var O=function(){var T=this;T.stop=function(){T.stopped=!0}};function P(T,L,S,E,k){var X=new O,q=E!=null&&!e.isEmpty(E)&&w.data;if(A(X,k))return["stop",E];w.masterFilter&&typeof w.masterFilter=="function"&&(E=w.data=w.masterFilter(E,T,k,X));var V=e.loop(S,function(I){if(typeof I=="function"){if(A(X,k))return"stop";E=w.data=I(E,T,k,X)}});return V=="stop"||A(X,k)?["stop",E]:(L&&typeof L=="function"&&(E=w.data=L(E,T,k,X)),A(X,k)?["stop",E]:(q&&!w.data&&Ct&&ht("Bind()"+(T?" ["+T+"]":"")+(k?" ["+k+"]":"")+" - warning, a filter may not have returned data"),["go",E]))}function A(T,L){if(w.stopped||T.stopped)return R("STOP"+(L?" ["+L+"]":""),T.stopped?"process stopped":"bind stopped"),T.stopped?T.stop=null:w.stopped=!1,!0}this.to=function(T,L,S,E,k,X,q,V){var I="targets, props, extra, filter, smartDecimals, call, lock, unique",te;if(te=mt(w.to,arguments,I))return te;var B=C("to",T,L,k),Z=B[0];B=B[1];var U=P("to",E,Z,B,S);if(B=U[1],U[0]=="stop")return;if(w.bindType==e.LOCALSTORAGE)localStorage[w.connection]=JSON.stringify(B),g(B);else{var ee="type="+w.bindType+"&";if(!B||e.isEmpty(B))return w;if(w.bindType==e.GET){var ae=B;e.isJSON(ae)||(ae=JSON.stringify(ae)),l&&(ae=e.couple(ae)),h&&R("Bind Report: TO [bindings]",ae),ae=e.urlEncode(ae);var re=n(w.master)?"":"&master="+e.urlEncode(i),he=n(q)?"":"&lock="+e.urlEncode(q),j=n(V)?"":"&unique="+e.urlEncode(V),G=n(S)?"":"&extra="+e.urlEncode(S),y=w.connection+ee+"command=to&data="+ae+re+he+j+G;h&&R("Bind Report: TO [url]",y),e.async(y,g,"callbackTo")}else w.bindType==e.POST&&(w.ajax.master=i,w.ajax.couple=l,w.ajax.lock=q,w.ajax.unique=V,h&&R("Bind Report: TO [bindings]",B),w.ajax.post(w.connection+ee,B,"to",S,g))}function g(d){l&&(d=e.decouple(d)),X&&typeof X=="function"&&X(d),h&&R("Bind Report: TO"+(S?" ["+S+"]":" -"),d)}return w},this.toLock=function(T,L,S,E,k,X){var q="targets, props, extra, filter, smartDecimals, call",V;if(V=mt(w.toLock,arguments,q))return V;if(w.bindType.toLowerCase()=="localstorage")return w.to(T,L,S,E,k,X),w;var I=e.makeID();w.from(te,T,L,S,E,I);function te(){w.to(T,L,S,E,k,X,I)}return w},this.toUnique=function(T,L,S,E,k,X){var q="targets, props, extra, filter, smartDecimals, call",V;return(V=mt(w.toUnique,arguments,q))?V:(w.to(T,L,S,E,k,X,null,!0),w)},this.toggleReport=function(T){return n(T)?h=!h:h=T,w},h&&R("Bind Report: CREATE ["+r.toUpperCase()+"]",t+(i?" "+i:""));function R(T,L){w==x?kr(T,L):Pr(T,L)}return this.report=function(){var T="Bind {DATA} Report:",L=e.copy(w.data);return w==x?kr(T,L):Pr(T,L),T="Bind {BINDINGS} Report:",L=e.copy(w.bindings),w==x?kr(T,L):Pr(T,L),w},this.from=function(T,L,S,E,k,X){var q="call, targets, props, extra, filter, lock",V;if(V=mt(w.from,arguments,q))return V;var I=C("from",L,S,f),te=I[0];I=I[1];var B=P("fromTo",k,te,I,E);if(I=B[1],B[0]=="stop")return;var Z="type="+w.bindType+"&";if(w.bindType==e.LOCALSTORAGE)(!localStorage[w.connection]||localStorage[w.connection]==null)&&(localStorage[w.connection]="{}"),w.data=JSON.parse(localStorage[w.connection]),j(w.data);else if(w.bindType==e.GET){var U=I;e.isJSON(U)||(U=JSON.stringify(U)),l&&(U=e.couple(U)),h&&R("Bind Report: FROM [bindings]",U),U=e.urlEncode(U);var ee=n(w.master)?"":"&master="+e.urlEncode(i),ae=n(X)?"":"&lock="+e.urlEncode(X),re=n(E)?"":"&extra="+e.urlEncode(E),he=w.connection+Z+"data="+U+"&command=from"+ee+ae+re;h&&R("Bind Report: FROM [url]",he),e.async(he,j,"callbackFrom")}else w.bindType==e.POST&&(w.ajax.master=i,w.ajax.couple=l,w.ajax.lock=X,h&&R("Bind Report: FROM [bindings]",I),w.ajax.post(w.connection+Z,I,"from",E,j));function j(G){if(w.data=G,l&&(w.data=e.decouple(w.data)),!n(X))var y=JSON.stringify(w.data);var g=P("from",k,te,w.data,E);if(g[0]!="stop"){var d=!1;(n(X)||y!=JSON.stringify(w.data))&&(d=!0,w.applyData()),h&&R("Bind Report: FROM"+(E?" ["+E+"]":" -"),d?w.data:"data not applied in toLock()"),T&&typeof T=="function"&&T(w.data)}}return w},this.applyData=function(){return e.loop(w.data,function(T,L){var S=w.bindings[T];if(S){var E=w.bindings[T].obj;e.loop(L,function(k,X){E[k]=X})}}),w},this.clear=function(){return w.bindType==e.LOCALSTORAGE&&(localStorage[w.connection]=null),w},this.removeAllBindings=function(T,L){if(n(T)&&(T=!0),this.bindings={},this.ids=[],this.data={},this.objIDs=new e.Dictionary(!0),this.toIDs={},this.fromIDs={},T){var S="type="+w.bindType+"&";if(w.bindType==e.LOCALSTORAGE)w.clear(),k("success");else if(w.bindType==e.GET){var E=n(w.master)?"":"&master="+encodeURI(i);e.async(w.connection+S+"command=removeAll"+E,k,"callbackRemoveAll")}else w.bindType==e.POST&&(w.ajax.master=i,w.ajax.post(w.connection+S,{},"removeAll",null,k,"removeAll"))}function k(X){L&&typeof L=="function"&&L(X),h&&R("Bind Report: REMOVEALL",X)}return w},w},e.Swipe=function(t,r,i,o,l){var f="obj, distance, duration, isometric, overrideNoSwipe",h;if(h=mt(e.Swipe,arguments,f,this))return h;if(qe("70"),this.cjsEventDispatcher_constructor(),this.type="Swipe",n(t)||!t.on){ht("zim controls - Swipe():\nPlease pass in object");return}n(r)&&(r=30);var p=v(i);n(i)&&(i=p=="s"?.08:80),this.distance=r,this.duration=i,this.active=!0;var _,b,w,C,O,P,A=this,R,T,L=t.on("mousedown",function(S){if(!A.active||!l&&S.target.zimNoSwipe)return;A.obj=S.target,C=_=S.stageX/e.scaX,O=b=S.stageY/e.scaY,w=!0,A.dispatchEvent("swipedown"),clearTimeout(P),P=setTimeout(function(){w&&(E(),w=!1)},A.duration*(p=="s"?1e3:1)),R=t.on("pressmove",function(k){C=k.stageX/e.scaX,O=k.stageY/e.scaY}),T=t.on("pressup",function(){w&&(E(),w=!1,clearTimeout(P))});function E(){var k=new $e.Event("swipe");if(k.obj=A.obj,k.stageX=S.stageX/e.scaX,k.stageY=S.stageY/e.scaY,k.rawX=S.rawX/e.scaX,k.rawY=S.rawY/e.scaY,k.swipeX=k.swipeY=0,A.direction="none",o){if(Math.abs(C-_)>A.distance||Math.abs(O-b)>A.distance){var X=Math.atan2(O-b,C-_)*180/Math.PI;X=(X+360)%360,X>=270&&X<360?(k.swipeY=-1,A.direction="up"):X>=0&&X<90?(k.swipeX=1,A.direction="right"):X>=90&&X<180?(k.swipeY=1,A.direction="down"):X>=180&&X<270&&(k.swipeX=-1,A.direction="left")}}else Math.abs(C-_)>Math.abs(O-b)?(C-_>A.distance&&(k.swipeX=1,A.direction="right"),_-C>A.distance&&(k.swipeX=-1,A.direction="left")):(O-b>A.distance&&(k.swipeY=1,A.direction="down"),b-O>A.distance&&(k.swipeY=-1,A.direction="up"));A.dispatchEvent(k)}});this.disable=function(){A.active=!1},this.enable=function(){A.active=!0},this.dispose=function(){L&&t.off("mousedown",L),R&&t.off("pressmove",R),T&&t.off("pressup",T)}},e.extend(e.Swipe,$e.EventDispatcher,null,"cjsEventDispatcher",!1),e.Swiper=function(t,r,i,o,l,f,h,p,_,b,w,C,O){var P="swipeOn, target, property, sensitivity, swiperType, min, max, damp, integer, factor, loop, pauseTime, otherSwiper",A;if(A=mt(e.Swiper,arguments,P,this))return A;if(qe("69.5"),this.cjsEventDispatcher_constructor(),this.type="Swiper",n(t)||!t.getStage||!t.stage){ht("zim.Swiper() - please provide container on stage");return}if(n(r))return;n(o)&&(o=1),n(l)&&(l="horizontal"),n(p)&&(p=.1),p===!1&&(p=1),n(_)&&(_=!1),n(b)&&(b=1),n(w)&&(w=!1);var R=v(C);n(C)&&(C=R=="s"?.2:200);var T=this,L=t,S,E,k=T.desiredValue=r[i],X;this.target=r,this.property=i,this.sensitivity=o;var q=!1,V=le.zdf||t.stage?t.stage.frame:{};L.canvas?(X=L,T.downEvent=L.on("stagemousedown",function(Y){q=!0,j(Y),T.moveEvent=L.on("stagemousemove",G),T.upEvent=L.on("stagemouseup",I),T.upEvent2=V.on("mouseupplus",I)})):(X=L.stage,m(),T.downEvent=L.on("mousedown",j),T.moveEvent=L.on("pressmove",G),T.upEvent=L.on("pressup",te),T.upEvent2=V.on("mouseupplus",te));function I(){q=!1,L.off("stagemousemove",T.moveEvent),L.off("stagemouseup",T.upEvent),T.dispatchEvent("swipeup")}function te(){q=!1,T.dispatchEvent("swipeup")}var B,Z,U,ee=Math.sqrt(Math.pow(L.width,2)+Math.pow(L.height,2)),ae,re,he=!1;function j(Y){he=!0,X=Y.target.stage,U=(L.parent?L.parent:L).localToGlobal(L.x,L.y),q=!0,l=="radial"?(ae=Y.stageX/e.scaX,re=Y.stageY/e.scaY,B=Math.atan2(re-U.y,ae-U.x)*e.DEG):S=l=="horizontal"?Y.stageX/e.scaX:Y.stageY/e.scaY,E=T.target[T.property],T.dispatchEvent("swipedown")}function G(Y){if(q){if(l=="radial"){T.diff=e.dist(ae,re,Y.stageX/e.scaX,Y.stageY/e.scaY),Z=Math.atan2(Y.stageY/e.scaY-U.y,Y.stageX/e.scaX-U.x)*e.DEG;var Q=e.sign(B-Z);if(Math.abs(Z-B)>180){q=!1;return}T.diff=T.diff*Q;var ce=Math.max(10,e.dist(U.x,U.y,Y.stageX/e.scaX,Y.stageY/e.scaY));T.diff*=(ee-ce)/ee}else T.diff=S-(l=="horizontal"?Y.stageX/e.scaX:Y.stageY/e.scaY);if(O&&(Math.abs(T.diff)<Math.abs(O.diff)?(T.override=!0,O.override=!1):(T.override=!1,O.override=!0)),!T.override){if(Math.abs(T.diff)>0&&(T.swiperMoving=!0),k=E-T.diff*T.sensitivity*b,!n(f)&&!n(h)&&w){var pe=k;k=(k+(h-f)*1e4-f)%(h-f)+f,Math.abs(pe-k)>Math.abs(h-f)*.8&&(T.immediate(k),S=l=="horizontal"?Y.stageX/e.scaX:Y.stageY/e.scaY,E=T.target[T.property])}else n(f)||(k=Math.max(k,f)),n(h)||(k=Math.min(k,h));T.desiredValue=k,T.dispatchEvent("swipemove")}}}var y=new e.Damp(T.target[T.property],p),g=k,d=k;T.swiperTicker=e.Ticker.add(function(){k==g?k!=d&&(T.pauseTimeout&&T.pauseTimeout.clear(),d=k,T.pauseTimeout=e.timeout(C,function(){q&&T.dispatchEvent("swipepause"),T.pauseTimeout=null})):(d=null,g=k,T.pauseTimeout&&T.pauseTimeout.clear()),T.swiperMoving&&(T.target[T.property]=_?Math.round(y.convert(k)):y.convert(k),he&&!q&&Math.abs(T.target[T.property]-k)<Math.abs(o)/2&&(T.swiperMoving=!1,he=!1,T.target[T.property]=k,T.immediate(T.target[T.property]),T.dispatchEvent("swipestop")))},X),this.immediate=function(Y){y.immediate(Y),T.target[T.property]=_?Math.round(Y):Y,T.desiredValue=k=Y};var D=!0;Object.defineProperty(T,"enabled",{get:function(){return D},set:function(Y){D!=Y&&(Y?Ce():F(),D=!!Y)}}),Object.defineProperty(T,"desiredValue",{get:function(){return k},set:function(Y){T.swiperMoving=!0,k=Y}}),Object.defineProperty(T,"damp",{get:function(){return p},set:function(Y){p=Y,y.damp=p}});function K(){L.off("stagemousedown",T.downEvent),L.off("stagemousemove",T.moveEvent),L.off("stagemouseup",T.upEvent),V.off("mouseupplus",T.upEvent2)}function m(){L.off("mousedown",T.downEvent),L.off("pressmove",T.moveEvent),L.off("pressup",T.upEvent),V.off("mouseupplus",T.upEvent2)}function F(){L.canvas?K():m(),e.Ticker.remove(T.swiperTicker)}function Ce(){L.canvas?T.downEvent=L.on("stagemousedown",T.downEvent):(T.downEvent=L.on("mousedown",T.downEvent),T.moveEvent=L.on("pressmove",T.moveEvent),T.upEvent=L.on("pressup",T.upEvent),T.upEvent2=V.on("mouseupplus",T.upEvent2)),T.immediate(T.target[T.property]),T.swiperTicker=e.Ticker.add(T.swiperTicker,X)}this.dispose=function(){F(),y=null,T.swiperTicker=null}},e.extend(e.Swiper,$e.EventDispatcher,null,"cjsEventDispatcher",!1),e.MotionController=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V){var I="target, type, speed, axis, boundary, map, diagonal, damp, flip, orient, constant, firstPerson, turnSpeed, moveThreshold, stickThreshold, container, localBoundary, mouseMoveOutside, mousedownIncludes, minPercentSpeed, maxPercentSpeed, dampKeyup, rotate, mouseOutside",te;if(te=mt(e.MotionController,arguments,I,this))return te;qe("69.7"),this.cjsEventDispatcher_constructor(),this.type="MotionController";var B=this,Z,U="zim MotionController(): Please pass in a reference to the stage or a container on the stage";if(n(R))if(le.zdf)Z=R=le.zdf.stage;else{ht(U);return}else if(n(R.stage))if(le.zdf)Z=le.zdf.stage;else{ht(U);return}else Z=R.stage;var ee=Z.frame;n(b)||(q=b),n(t)&&(t=new e.Container(1,1,null,null,!1));var ae=t.type=="Accelerator";if(n(i)&&(i=r=="pressmove"?20:7),!n(r)&&r.type=="DPad"){var re=r;r="manual",n(o)&&(o=re.axis),o=="all"&&(o="both"),re.on("change",function(){B.convert(t.x+re.dirX*i,t.y+re.dirY*i)})}(n(r)||r!="mousemove"&&r!="pressmove"&&r!="pressdrag"&&r!="keydown"&&r!="gamebutton"&&r!="gamestick"&&r!="swipe"&&r!="follow"&&r!="manual")&&(r="mousedown"),n(o)&&(o=ae?"horizontal":"both"),r=="keydown"&&n(f)&&(f=[[65,37],[68,39],[87,38],[83,40]]),r=="gamebutton"&&n(f)&&(C?f=[14,15,e.GamePad.RT,e.GamePad.LT]:f=[14,15,12,13]),r=="gamestick"&&n(f)&&(C?f=[[0,2],[0,2],[1],[1]]:f=[0,0,1,1]),r=="gamestick"&&n(f)&&(f=[0,0,1,1]),n(h)&&(h=!0),(o=="horizontal"||o=="vertical")&&(h=!1),(n(p)||p===!0)&&(p=r=="keydown"||r=="gamebutton"?1:r=="pressmove"?.5:.1),p===!1&&(p=1),n(C)&&(C=!1),n(O)&&(O=i*.4),n(P)&&(P=4),n(A)&&(A=.2),n(L)&&(L=!0),Z.mouseMoveOutside=L,n(S)&&(S=[]),Array.isArray(S)||(S=[S]),t.type=="Pen"&&!t.move?S.push(t,t.paper):S.push(t),l&&l.getBounds&&(S?S.indexOf(l)==-1&&S.push(l):S=[l]),t.motionController=this,this.mousedownIncludes=S,R&&R.backing&&this.mousedownIncludes.push(R.backing),n(X)&&(X=.3),B.dampKeyup=X,this.dirX=0,this.dirY=0,this.speed=i,this.turnSpeed=O,this.axis=o,this.target=t,this.moveThreshold=P,this.stickThreshold=A,this.boundary=l,t.zimMCStartAngle=t.rotation;var he=B.speed,j=B.speed,G=0;B.rotation=t.zimMCStartAngle;var y,g;if(ae){g=R.getBounds();var d;!g||o=="vertical"&&!g.height||o!="vertical"&&!g.width?d=1e3:d=o=="vertical"?g.height:g.width,n(E)&&(E=0),n(k)&&(k=100),n(this.target.percentSpeed)&&(this.target.percentSpeed=(k-E)/2),B.x=d/2,B.y=d/2,y=new e.Proportion(0,d,E,k)}else B.x=this.target.x,B.y=this.target.y;var D=B.scaleX=t.scaleX,K=B.scaleY=t.scaleY,m,F,Ce,Y,Q=!1,ce=!1,pe,J,ue,ye,Xe;if(r=="keydown"||r=="gamebutton"){for(J=0;J<4;J++)Array.isArray(f[J])||(f[J]=[f[J]]);var se=[0,0,0,0],Ae=[],ie=["X","X","Y","Y"],_e=[-1,1,-1,1],$={dirX:0,dirY:0};if(r=="keydown")var xe=ee.on("keydown",Fe);else{ye=B.gamepad=new e.GamePad;var Be=ye.on("buttondown",Fe)}if(n(w))if(r=="keydown")var me=ee.on("keyup",ge);else var Oe=ye.on("buttonup",ge);Xe={rotation:0,speedX:B.speed,speedY:B.speed};var Ye=e.Ticker.add(function(){if(C){He($);return}var tt=B.speed,Te=B.speed;if(B.axis=="both"&&$.dirX!=0&&$.dirY!=0){var et=Ge($.dirX,$.dirY);tt=et.speedX,Te=et.speedY}(B.axis=="horizontal"||B.axis=="both")&&(B.x+=tt*$.dirX),(B.axis=="vertical"||B.axis=="both")&&(B.y+=Te*$.dirY),Le()},Z)}else if(r=="mousedown"||r=="mousemove")m=Z.on("stage"+r,function(tt){Z=tt.target.stage;var Te,et;if(!V&&B.boundary&&!B.boundary.type=="Blob"?et=B.boundary:!V&&R&&(et=R.boundsToGlobal()),!(et&&(Te={x:tt.stageX/e.scaX,y:tt.stageY/e.scaY},Te.x<et.x||Te.x>et.x+et.width||Te.y<et.y||Te.y>et.y+et.height))){if(r=="mousedown"){if(Array.isArray(B.mousedownIncludes)||(B.mousedownIncludes=[B.mousedownIncludes]),B.mousedownIncludes.indexOf(R)<0)for(J=0;J<R.numChildren;J++){var Ue=R.getChildAt(J);if(B.mousedownIncludes.indexOf(Ue)==-1&&Ue.mouseEnabled&&Ue.hitTestPoint&&Ue.hitTestPoint(tt.stageX/e.scaX,tt.stageY/e.scaY))return}B.dispatchEvent("mousedown")}var Re=R.globalToLocal(L?tt.rawX/e.scaX:tt.stageX/e.scaX,L?tt.rawY/e.scaY:tt.stageY/e.scaY);B.x=Re.x,B.y=Re.y,Le()}});else if(r=="pressmove"||r=="pressdrag"||r=="follow")t.type=="Pen"&&(t.write=!1),m=Z.on("stagemousedown",function(tt){var Te,et;if(!V&&B.boundary&&!B.boundary.type=="Blob"?et=B.boundary:!V&&R&&(et=R.boundsToGlobal()),!(et&&(Te={x:tt.stageX/e.scaX,y:tt.stageY/e.scaY},Te.x<et.x||Te.x>et.x+et.width||Te.y<et.y||Te.y>et.y+et.height))&&!(B.boundary&&B.boundary.type=="Blob"&&(r=="pressmove"||r=="pressdrag")&&(Te={x:tt.stageX/e.scaX,y:tt.stageY/e.scaY},!B.boundary.shape.hitTestPoint(Te.x,Te.y)))&&!(r=="pressdrag"&&!t.hitTestPoint(tt.stageX/e.scaX,tt.stageY/e.scaY))){ce=!1,Array.isArray(B.mousedownIncludes)||(B.mousedownIncludes=[B.mousedownIncludes]);var Ue=!1;for(B.mouseDownIncludes&&(pe=Z.getObjectUnderPoint(tt.stageX,tt.stageY,1)),J=0;J<B.mousedownIncludes.length;J++)pe&&B.mousedownIncludes[J].hitTestPoint&&B.mousedownIncludes[J].hitTestPoint(tt.stageX/e.scaX,tt.stageY/e.scaY)&&B.mousedownIncludes[J].contains(pe)&&(Ue=!0);if(!Ue)for(J=0;J<R.numChildren;J++){var Re=R.getChildAt(J);if(B.mousedownIncludes.indexOf(Re)==-1&&Re.mouseEnabled&&Re.hitTestPoint&&Re.hitTestPoint(tt.stageX/e.scaX,tt.stageY/e.scaY))return}var Ze=R.globalToLocal(L?tt.rawX/e.scaX:tt.stageX/e.scaX,L?tt.rawY/e.scaY:tt.stageY/e.scaY);r!="follow"&&r!="pressdrag"&&B.immediate(o=="both"||o=="horizontal"?Ze.x:null,o=="both"||o=="vertical"?Ze.y:null),Le(),B.dispatchEvent("mousedown"),Q=!0,B.moveX=L?tt.rawX/e.scaX:tt.stageX/e.scaX,B.moveY=L?tt.rawY/e.scaY:tt.stageY/e.scaY,F=Z.on("stagemousemove",function(Je){B.moveX=L?Je.rawX/e.scaX:Je.stageX/e.scaX,B.moveY=L?Je.rawY/e.scaY:Je.stageY/e.scaY,r!="follow"&&Ve()}),Y&&e.Ticker.remove(Y),r=="follow"&&(Y=e.Ticker.add(Ve)),t.type=="Pen"&&(t.write=!0,t.paper.noMouse(),t.zimDragCheck=!0)}}),Ce=Z.on("stagemouseup",function(){t.type=="Pen"&&(t.write=!1,t.paper.mouse(),t.zimDragCheck=!1,ce&&t.stopCheck()),Y&&e.Ticker.remove(Y),Z.off("stagemousemove",F),Q=!1});else if(r=="gamestick"){for(ye=this.gamepad=new e.GamePad,J=0;J<4;J++)Array.isArray(f[J])||(f[J]=[f[J]]);Xe={rotation:t.zimMCStartAngle,speedX:B.speed,speedY:B.speed};var de=ye.on("data",function(tt){for($={dirX:0,dirY:0},J=0;J<f[0].length;J++)if(ue=tt.axes[f[0][J]],Math.abs(ue)>B.stickThreshold){$.dirX=ue;break}for(J=0;J<f[2].length;J++)if(ue=tt.axes[f[2][J]],Math.abs(ue)>B.stickThreshold){$.dirY=ue;break}if(C){He($);return}B.x+=B.speed*$.dirX,B.y+=B.speed*$.dirY,Le()})}else if(r=="swipe")var ve=new e.Swiper(Z,B,"x",.8),Me=new e.Swiper(Z,B,"y",.8,!1),we=ve.on("swipemove",function(){Le()});function Fe(tt){var Te=r=="keydown"?tt.keyCode:tt.buttonCode,et;for(J=0;J<4;J++)if(f[J].indexOf(Te)>-1){if(!h&&B.axis=="both"&&($.dirX=$.dirY=0),$["dir"+ie[J]]=_e[J],se[J]=1,et=Ae.indexOf(J),et==0)return;et>0&&Ae.splice(et,1),Ae.unshift(J);return}}function ge(tt){var Te=r=="keydown"?tt.keyCode:tt.buttonCode,et;for(J=0;J<4;J++)if(f[J].indexOf(Te)>-1){if(se[J]=0,et=Ae.indexOf(J),et>=0&&Ae.splice(et,1),B.axis!="both"||h)$["dir"+ie[J]]=-se[Math.floor(J/2)*2]+se[Math.floor(J/2)*2+1];else if(Ae.length>0){$["dir"+ie[J]]=0;var Ue=Ae[0];$["dir"+ie[Ue]]=_e[Ue]}else $.dirX=$.dirY=0;return}}function Ve(){var tt=R.globalToLocal(B.moveX,B.moveY);B.x=tt.x,B.y=tt.y,Le(),t.type=="Pen"&&!ce&&t.drawing&&(ce=!0)}function He(tt){Xe.rotation+=tt.dirX*B.turnSpeed,B.rotation=Xe.rotation,Xe.speedX=Math.sin(Xe.rotation*Math.PI/180)*B.speed*-tt.dirY,Xe.speedY=-Math.cos(Xe.rotation*Math.PI/180)*B.speed*-tt.dirY,B.x+=Xe.speedX,B.y+=Xe.speedY}function Le(){var tt=B.x-(ae?B.target.percentSpeed:B.target.x),Te=B.y-(ae?B.target.percentSpeed:B.target.y),et=Ge(tt,Te);if(he=et.speedX,j=et.speedY,!!q){if(n(et.angle)||(B.rotation=et.angle+t.zimMCStartAngle),n(B.rotation)){B.rotation=B.target.rotation;return}B.rotation+=G;var Ue=fe(B.rotation),Re=B.target.rotation=fe(B.target.rotation);Math.abs(Ue-Re)>180&&(Re>Ue?Re-=360:Ue-=360),B.dampR.immediate(Re),B.target.rotation=Re,B.rotation=Ue}}function fe(tt){return(tt%360+360)%360}function Ge(tt,Te){var et=B.speed,Ue=B.speed,Re,Ze=Math.sqrt(Math.pow(tt,2)+Math.pow(Te,2));return Ze>0&&(et=Math.abs(tt)/Ze*B.speed,Ue=Math.abs(Te)/Ze*B.speed,Re=90-Math.atan2(tt,Te)*180/Math.PI),{speedX:et,speedY:Ue,angle:Re}}var Qe=this.x,Ke=this.y,st=this.x,yt=this.y,We=this.x=ae?d/2:this.target.x,at=this.y=ae?d/2:this.target.y;this.dampX=new e.Damp(We,p),this.dampY=new e.Damp(at,p),this.dampR=new e.Damp(this.target.rotation,p);var ct=0,Pe=0,Ie=e.Ticker.add(function(){if(r=="manual"&&Le(),B.boundary&&B.boundary.type!="Blob"&&(B.x=e.constrain(B.x,B.boundary.x,B.boundary.x+B.boundary.width),B.y=e.constrain(B.y,B.boundary.y,B.boundary.y+B.boundary.height)),B.axis=="horizontal"||B.axis=="both"){if(B.dirX=e.sign(B.x-We),Math.abs(B.x-We)<he?We=B.x:We+=B.dirX*he,$&&$.dirX==0){var tt=B.boundary?B.boundary.width/2:Z.width/2,Te=B.x-(B.x-tt)*(ae?B.dampKeyup:0);We=Te,B.x=We}ae&&g&&g.width?B.target.percentSpeed=y.convert(B.dampX.convert(We)):B.target.x=B.dampX.convert(We)}if(B.axis=="vertical"||B.axis=="both"){if(B.dirY=e.sign(B.y-at),Math.abs(B.y-at)<j?at=B.y:at+=e.sign(B.y-at)*j,$&&$.dirY==0){tt=B.boundary?B.boundary.height/2:Z.height/2;var et=B.y-(B.y-tt)*(ae?B.dampKeyup:0);at=et,B.y=at}ae&&g&&g.height?B.target.percentSpeed=y.convert(B.dampY.convert(at)):B.target.y=B.dampY.convert(at)}if(B.boundary&&B.boundary.type=="Blob"&&(B.boundary.shape.hitTestPoint(B.target.x,B.target.y)?(Qe=B.target.x,Ke=B.target.y):(B.target.x=B.x=Qe,B.target.y=B.y=Ke,B.immediate(Qe,Ke))),r=="pressmove"&&Q&&B.dispatchEvent("pressing"),p==1?(B.movingX=Math.round(st-B.x)!=0,B.movingY=Math.round(yt-B.y)!=0,st=B.x,yt=B.y):(B.movingX=Math.abs(We-(ae?B.target.percentSpeed:B.target.x))>B.moveThreshold,B.movingY=Math.abs(at-(ae?B.target.percentSpeed:B.target.y))>B.moveThreshold),B.moving&&!(B.movingX||B.movingY)?B.dispatchEvent("stopmoving"):!B.moving&&(B.movingX||B.movingY)&&B.dispatchEvent("startmoving"),B.moving=B.movingX||B.movingY,B.moving&&B.dispatchEvent("moving"),B.dirX!=ct||B.dirY!=Pe){var Ue=new $e.Event("change"),Re;B.dirX!=ct?(Re=["left",null,"right"],Ue.dir=Re[B.dirX+1],ct=B.dirX,!t.zimMCStartAngle&&(_=="horizontal"||_=="both")&&(B.scaleX=t.scaleX=B.dirX?Math.abs(t.scaleX)*B.dirX:t.scaleX,D!=0&&Math.round(B.scaleX/D)==-1?G=180:G=0)):(Re=["up",null,"down"],Ue.dir=Re[B.dirY+1],Pe=B.dirY,!t.zimMCStartAngle&&(_=="vertical"||_=="both")&&(B.scaleY=t.scaleY=B.dirY?-Math.abs(t.scaleY)*B.dirY:t.scaleY,K!=0&&Math.round(B.scaleY/K)==-1?G=180:G=0)),B.dispatchEvent(Ue)}q&&!n(B.rotation)&&(B.target.rotation=B.dampR.convert(B.rotation))},Z);this.immediate=function(tt,Te,et){return!n(tt)&&B.dampX&&(B.dampX.immediate(tt),ae?B.x=B.target.percentSpeed=We=tt:B.x=B.target.x=We=tt,ve&&ve.immediate(tt)),!n(Te)&&B.dampY&&(B.dampY.immediate(Te),ae?B.y=B.target.percentSpeed=at=Te:B.y=B.target.y=at=Te,Me&&Me.immediate(Te)),!n(et)&&B.dampR&&(B.dampR.immediate(et),B.rotation=B.target.rotation=et),Qe=B.x,Ke=B.y,B},this.convert=function(tt,Te){n(tt)||(B.x=tt),n(Te)||(B.y=Te),Le()},Object.defineProperty(B,"pausingSpeed",{get:function(){return B.speed},set:function(tt){B.speed=tt}}),this.paused=!1;var be;this.pause=function(tt,Te,et){return n(tt)&&(tt=!0),n(Te)&&(Te=0),n(et)&&(et=!1),tt?(be=B.speed,Te>0?(e.animate({target:B,obj:{pausingSpeed:0},ticker:!1,time:Te,call:function(){B.speed=0,B.paused=!0,B.enabled=!1,B.immediate(B.target.x,B.target.y),B.dispatchEvent("pause")}}),et&&(Q=!1,F&&Z.off("stagemousemove",F),Y&&e.Ticker.remove(Y),t.type=="Pen"&&(t.write=!1,t.zimDragCheck=!1),Ce&&Z.off("stagemouseup",Ce),ce&&t.stopCheck(),r=="keydown"?me&&ee.off("keyup",me):Oe&&ye.off("buttonup",Oe))):(B.speed=0,B.paused=!0,B.enabled=!1,B.immediate(B.target.x,B.target.y),setTimeout(function(){B.dispatchEvent("pause")},10))):(B.enabled=!0,Te>0?e.animate({target:B,obj:{pausingSpeed:be},ticker:!1,time:Te,call:function(){B.speed=be,B.paused=!1}}):(B.speed=be,B.paused=!1)),B};var ze=!0;Object.defineProperty(B,"enabled",{get:function(){return ze},set:function(tt){ze!=tt&&(tt?(it(),B.paused=!1):(je(),B.paused=!0),ze=!!tt)}});function it(){r=="keydown"?(xe=ee.on("keydown",xe),me&&(me=ee.on("keyup",me)),Ye=e.Ticker.add(Ye,Z)):r=="gamebutton"?(Be=ye.on("buttondown",Be),Oe&&(Oe=ye.on("buttonup",Oe)),Ye=e.Ticker.add(Ye,Z)):r=="gamestick"?de=ye.on("data",de):r=="swipe"?(ve.enabled=!0,Me.enabled=!0,we&&(we=ve.on("swipemove",we))):r=="mousedown"||r=="mousemove"?m=Z.on("stage"+r,m):r=="pressmove"&&(m=Z.on("stagemousedown",m),F&&(F=Z.on("stagemousemove",F)),Ce&&(Ce=Z.on("stagemouseup",Ce))),Ie=e.Ticker.add(Ie,Z)}function je(){r=="keydown"?(ee.off("keydown",xe),ee.off("keyup",me),e.Ticker.remove(Ye)):r=="gamebutton"?(ye.off("buttondown",Be),ye.off("buttonup",Oe),e.Ticker.remove(Ye)):r=="gamestick"?ye.off("data",de):r=="swipe"?(ve.enabled=!1,Me.enabled=!1,ve.off("swipemove",we)):r=="mousedown"||r=="mousemove"?Z.off("stage"+r,m):r=="pressmove"&&(Z.off("stagemousedown",m),Z.off("stagemousemove",F),Z.off("stagemouseup",Ce)),e.Ticker.remove(Ie)}this.dispose=function(){je(),ye&&ye.dispose(),ve&&ve.dispose(),Me&&ve.dispose()}},e.extend(e.MotionController,$e.EventDispatcher,"enabled","cjsEventDispatcher"),e.GamePad=function(){if(qe("69.8"),this.type="GamePad",this.cjsEventDispatcher_constructor(),!navigator.getGamepads){this.error=!0,Ct&&ht("zim.GamePad() - no browswer support");return}var t;le.addEventListener("gamepadconnected",i),this.currentIndex=0;var r=this;function i(h){r.connected=!0,l("gamepadconnected",h);var p=navigator.getGamepads()[r.currentIndex];r.lastData=[];for(var _=0;_<p.buttons.length;_++)r.lastData[_]=p.buttons[_].pressed;function b(){if(t=requestAnimationFrame(b),r.data=navigator.getGamepads()[r.currentIndex],!!r.data){for(var w=r.buttons=[],C,O=0;O<r.data.buttons.length;O++)w[O]=r.data.buttons[O].pressed,w[O]!=r.lastData[O]&&(r.lastData[O]=w[O],w[O]?C=new $e.Event("buttondown"):C=new $e.Event("buttonup"),C.buttonCode=O,C.button=N[O],r.dispatchEvent(C));C=new $e.Event("data"),C.axes=r.axes=r.data.axes,C.buttons=r.buttons,r.dispatchEvent(C)}}b()}var o=setInterval(function(){navigator.getGamepads&&navigator.getGamepads()[0]&&(r.connected||i(),clearInterval(o))},500);function l(h,p){var _=new $e.Event(h);_.index=p.gamepad.index,_.id=p.gamepad.id,_.buttons=p.gamepad.buttons,_.axes=p.gamepad.axes,r.dispatchEvent(_)}var f=function(h){h.gamepad.index==r.currentIndex&&(cancelAnimationFrame(t),r.connected=!1,r.dispatchEvent("gamepaddisconnected"))};le.addEventListener("gamepaddisconnected",f),this.dispose=function(){le.removeEventListener("gamepadconnected",i),le.removeEventListener("gamepaddisconnected",f),cancelAnimationFrame(t),clearInterval(o),r.connected=!1}};var N=["A","B","X","Y","LB","RB","LT","RT","BACK","START","LS","RS","DPAD_UP","DPAD_DOWN","DPAD_LEFT","DPAD_RIGHT"];for(dn=0;dn<N.length;dn++)e.GamePad[N[dn]]=dn;var z=["LSX","LSY","RSX","RSY"];for(dn=0;dn<z.length;dn++)e.GamePad[z[dn]]=dn;e.extend(e.GamePad,$e.EventDispatcher,null,"cjsEventDispatcher"),e.Portal=function(t,r){var i="obj, lands",o;if(o=mt(e.Portal,arguments,i,this))return o;if(qe("69.96"),n(t)||!t.stage)return;this.type="Portal";var l=this,f=r&&r.numChildren&&r.numChildren>0;if(f){var h=r.getChildAt(r.numChildren-1),p=r.getChildAt(r.numChildren-2);r.setChildIndex(p,r.numChildren-1),p.setMask(t)}function _(){r.setChildIndex(h,0),h=p,p=r.getChildAt(r.numChildren-2),r.setChildIndex(p,r.numChildren-1),h.setMask(null),p.setMask(t),t.stage.update()}t.on(e.mobile()?"mousedown":"mouseover",function(){l._enabled&&(f&&_(),l.dispatchEvent("enter"))}),t.on(e.mobile()?"pressup":"mouseout",function(){l._enabled&&l.dispatchEvent("exit")}),Object.defineProperty(this,"portal",{get:function(){return t},set:function(b){if((n(b)||!b.stage)&&Ct){ht("zim.Portal() - please provide a Display Object to act as the portal");return}p.setMask(t)}}),Object.defineProperty(this,"currentLand",{get:function(){return h},set:function(b){if(r.contains(b))for(;b!=h;)_()}}),Object.defineProperty(this,"nextLand",{get:function(){return p},set:function(){if(Ct){ht("zim.Portal() - nextLand is read only - remake Portal to change");return}}}),this._enabled=!0,Object.defineProperty(l,"enabled",{get:function(){return l._enabled},set:function(b){l._enabled=b}})},e.extend(e.Portal,$e.EventDispatcher,null,"cjsEventDispatcher",!1),le.zimContactListener=null;var oe,Ee;function ke(t,r,i,o,l,f,h,p,_,b,w,C){if(qe("69.97"),n(i)&&(i=0),o=="rectangle")t.body=t.physics.makeRectangle(t.width-i,t.height-i,r,l,h,p,_,b,w,f,C);else if(o=="circle")t.body=t.physics.makeCircle(t.width/2-i,r,l,h,p,_,b,w,f,C);else if(o=="triangle")n(t.a)&&(t.a=t.width,t.b=t.c=Math.sqrt(Math.pow(t.a/2,2)+Math.pow(t.height,2))),t.body=t.physics.makeTriangle(t.a-i,t.b-i,t.c-i,r,l,h,p,_,b,w,f,C);else if(o=="poly"){var O=[];t.reg(0,0,!0);var P=t;t.scale!=1&&(P=t.clone().transformPoints("scale",t.scale)),i&&(P=t.clone().transformPoints("scale",Math.max(0,1-i/((t.width+t.height)/4)))),e.loop(P.points,function(R){O.push({x:R[0],y:R[1]})}),t.body=t.physics.makePoly(O,t.width,t.height,r,l,h,p,_,b,w,f,C)}t.body.x=t.x,t.body.y=t.y,t.body.rotation=t.rotation,t.physics.addMap(t.body,t),t.impulse=function(R,T,L,S){n(R)&&(R=0),n(T)&&(T=0);var E=t.body.GetWorldCenter();return n(L)&&(L=E.x*t.physics.scale),n(S)&&(S=E.y*t.physics.scale),t.body.ApplyImpulse(new le.b2Vec2(R,T),new le.b2Vec2(L/t.physics.scale,S/t.physics.scale)),t},t.force=function(R,T,L,S){n(R)&&(R=0),n(T)&&(T=0);var E=t.body.GetWorldCenter();return n(L)&&(L=E.x*t.physics.scale),n(S)&&(S=E.y*t.physics.scale),t.body.ApplyForce(new le.b2Vec2(R,T),new le.b2Vec2(L/t.physics.scale,S/t.physics.scale)),t},t.setLinearVelocity=function(R,T){return t.body.SetLinearVelocity(new le.b2Vec2(R,T)),t},t.setAngularVelocity=function(R){return t.body.SetAngularVelocity(R),t},t.spin=function(R){return n(R)&&(R=10),t.body.ApplyTorque(R*1e3),t},t.torque=function(R){return n(R)&&(R=10),t.body.ApplyTorque(R),t},t.follow=function(R,T,L,S,E,k,X,q,V,I,te,B){var Z="damp, dampY, leftOffset, rightOffset, upOffset, downOffset, offsetDamp, offsetDampY, horizontal, vertical, borderLock, borderOriginal",U;return(U=mt(t.follow,arguments,Z))?U:(t.physics.follow(t,R,T,L,S,E,k,X,q,V,I,te,B),t)},t.noFollow=function(){return t.physics.follow(null),t},t.control=function(R,T,L,S,E){var k="type, speed, speedY, horizontal, vertical",X;return(X=mt(t.control,arguments,k))?X:(t.physics.control(t,R,T,L,S,E),t)},t.customControl=function(R,T,L){var S="dir, speed, speedY",E;return(E=mt(t.customControl,arguments,S))?E:(t.physics.customControl(R,T,L),t)},t.noControl=function(){return t.physics.noControl(t),t},t.sleep=function(){return t.body.SetAwake(!1),t},t.wake=function(){return t.body.SetAwake(!0),t};function A(){le.zimContactListener=new le.b2ContactListener,oe=new e.Dictionary(!0),Ee=new e.Dictionary(!0),le.zimContactListener.BeginContact=R,le.zimContactListener.EndContact=T;function R(L){var S=oe.at(L.m_fixtureB.GetBody());S&&S(L.m_fixtureA.GetBody().zimObj,L.m_fixtureA.GetBody()),S=oe.at(L.m_fixtureA.GetBody()),S&&S(L.m_fixtureB.GetBody().zimObj,L.m_fixtureB.GetBody())}function T(L){var S=Ee.at(L.m_fixtureB.GetBody());S&&S(L.m_fixtureA.GetBody().zimObj,L.m_fixtureA.GetBody()),S=Ee.at(L.m_fixtureA.GetBody()),S&&S(L.m_fixtureB.GetBody().zimObj,L.m_fixtureB.GetBody())}t.physics.world.SetContactListener(le.zimContactListener)}t.contact=function(R){return le.zimContactListener||A(),oe.add(t.body,R),t},t.noContact=function(){return oe.remove(t.body),t},t.contactEnd=function(R){return le.zimContactListener||A(),Ee.add(t.body,R),t},t.noContactEnd=function(){return Ee.remove(t.body),t},t.hasOwnProperty("dynamic")||Object.defineProperty(t,"dynamic",{get:function(){return t.body.GetType()==2},set:function(R){t.body.SetType(R==!0?2:0)}})}for(e.Timeline=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A){var R="objects, width, startPaused, barColor, buttonColor, themeColor, corner, ticks, damp, loop, noLoop, call, style, group, inherit",T;if(T=mt(e.Timeline,arguments,R,this))return T;qe("69.971"),this.group=P;var L=O===!1?{}:e.getStyle("Timeline",P,A),S=this.stage?this.stage:zimDefaultFrame.stage,E=S.frame,k=S.width,X=S.height;n(i)&&(i=L.startPaused!=null?L.startPaused:!1),n(b)&&(b=L.loop!=null?L.loop:!0),n(w)&&(w=L.noLoop!=null?L.noLoop:!1),n(o)&&(o=L.barColor!=null?L.barColor:e.tin),n(l)&&(l=L.buttonColor!=null?L.buttonColor:e.light),n(f)&&(f=L.themeColor!=null?L.themeColor:e.purple),n(r)&&(r=L.width!=null?L.width:k*.5),n(p)&&(p=L.ticks!=null?L.ticks:!0),n(_)&&(_=L.damp!=null?L.damp:!1),n(Q)&&(Q=L.labels!=null?L.labels:!0),n(h)&&(h=L.corner!=null?L.corner:5);var q=50;this.zimContainer_constructor(r,q,null,null,!1),this.type="Timeline";var V=this,I=t,te=e.toBW(E.color);if(n(I)){if(!e.animatedObjects||!e.animatedObjects.objects)return ht("ZIM Timeline - add Timeline after animated objects"),V;I=e.copy(e.animatedObjects.objects)}Array.isArray(I)||(I=[I]);var B=Date.now(),Z=0;e.loop(I,function(Oe){Oe.pauseAnimate(),Oe.tweenEndTime&&Oe.tweenEndTime>Z&&(Z=Oe.tweenEndTime)});var U=Math.ceil((Z-B)/1e3),ee=this.backing=new e.Rectangle(r,q,o,null,null,h).alp(.8).addTo(V),ae=te=="#000000"?0:1,re=this.shade=new e.Rectangle(q-ae,q-ae*2,black,null,null,[h,0,0,h]).alp(.7).pos(ae,ae,LEFT,TOP,V),he=this.shade2=new e.Rectangle(q-ae,q-ae*2,black,null,null,[0,h,h,0]).alp(.7).pos(ae,ae,RIGHT,TOP,V),j=new e.Container(50,50).alp(.9);new e.Rectangle(7,24,white).center(j).mov(-6),new e.Rectangle(7,24,white).center(j).mov(6);var G=V.controls=new e.Button({icon:new e.Triangle(30,30,30,white).reg(null,16).rot(90).alp(.9),toggleIcon:j.reg("center"),downBackgroundColor:e.purple.darken(.2),width:50,height:50,corner:25}).scaleTo(ee,null,70).center(re).addTo(V).expand(10).tap(function(){se.pauseAnimate(!G.toggled)});i||G.toggle();var y=new e.Container(50,50).reg("center").alp(.8).expand(10);new On(24,5,e.white).center(y).mov(0,-8),new On(24,5,e.white).center(y),new On(24,5,e.white).center(y).mov(0,8);var g=!0,d=V.menu=new e.Button({icon:y,downBackgroundColor:e.purple.darken(.2),width:50,height:50,corner:25}).scaleTo(ee,null,70).center(he).addTo(V).tap(function(){Xe.show(),g&&Xe.loc(V.x,V.y).mov(V.width-Xe.width/2,-Xe.height/2-10)});function D(Oe){se.rate=Oe,me.speed=Oe,V.trailInterval.time=Be.convert(me.speed),localStorage&&(localStorage.zim_tl=JSON.stringify(me))}function K(Oe){se.ticks.vis(Oe),se.labels.vis(Oe),S.update(),me.labels=Oe,localStorage&&(localStorage.zim_tl=JSON.stringify(me))}function m(Oe){b=Oe,me.looping=Oe,localStorage&&(localStorage.zim_tl=JSON.stringify(me))}function F(Oe){xe(),Oe&&(se.percentComplete=0,setTimeout(function(){$()},50)),me.trailing=Oe,localStorage&&(localStorage.zim_tl=JSON.stringify(me))}function Ce(Oe){return e.loop([G,d],function(Ye){Ye.backgroundColor=Oe,Ye.toggleBackgroundColor=Oe,Ye.rollBackgroundColor=Oe.lighten(.2),Ye.rollToggleBackgroundColor=Oe.lighten(.2),Ye.downBackgroundColor=Oe.darken(.2)}),Xe.backing.color=Oe,Y.slider.bar.color=Oe,S.update(),me.color=Oe,localStorage&&(localStorage.zim_tl=JSON.stringify(me)),this}this.setThemeColor=Ce;var Y=e.List.slider("speed",0,2,1,D,.1),Q=e.List.checkBox("labels",!1,K),ce=e.List.checkBox("loop",!1,m),pe=e.List.checkBox("trails",!1,F),J=e.List.colorPicker("color",e.purple,new e.ColorPicker({colors:[e.purple,e.pink,e.red,e.orange,e.brown,e.green,e.blue,e.grey,e.black],cols:9}),Ce),ue=this.title=new e.Container(300,25).noMouse();new e.Rectangle(500,70,e.black.toAlpha(.4)).pos(0,-45,CENTER,TOP,ue),this.icon=E.makeIcon({edges:"white",box:faint,slats:["white","white","white","white","white"]}).alp(.6).scaleTo(ue,null,140).pos(7,-10,"left","center",ue),new e.Label({text:"Z  I  M  -  T  I  M  E  L  I  N  E",color:"white"}).alp(.6).sca(.47).loc(51,-4,ue),new e.Line(219,1,"white").alp(.6).center(ue).mov(8,3);var ye=this.list=new e.List({width:300,height:260,backdropColor:clear,borderWidth:-1,shadowColor:-1,viewNum:6,padding:12,scrollBarV:!1,list:[Y,Q,ce,pe,J],swipe:!1});Y.slider.bar.color=e.purple,ye.tabs.mov(0,8);var Xe=V.pane=new e.Pane({width:ye.width,height:ye.height+40,backgroundColor:e.purple,backdropColor:e.faint,draggable:!0,corner:8,content:ye,resets:!1});Xe.contentContainer.mov(0,20),Xe.backing.on("pressmove",function(){g=!1},null,!0),ue.scaleTo(Xe.contentContainer,100).pos(0,2,"center","top",Xe.contentContainer).setMask(Xe.backing);var se=V.slider=new e.Slider({min:0,max:U,inside:!0,barColor:o,barWidth:q,barLength:r-q*2-12,tickColor:te.toAlpha(.8),damp:_,useTicks:!0,tickScale:1,tickStep:.1,semiTicks:4,semiTickScale:1,useLabels:!0,labelColor:te.toAlpha(.8)}).center(V,1);se.bar.dye(e.faint),se.currentValue=0,se.ticks.mov(0,-20),se.bar.widthOnly=se.bar.width+14,new e.Triangle({color:e.dark}).alp(.3).scaleTo(se.button,70,90,"full").center(se.button),se.animate({props:{currentValue:se.max},time:se.max,ease:"linear",startPaused:i,loop:!0,loopWait:.5,loopWaitCall:function(){b||(se.pauseAnimate(),G.toggle(!1),se.currentValue=se.max),ie&&V.trailInterval.pause(),C&&typeof C=="function"&&C()},loopCall:function(){e.loop(I,function(Oe){Oe.percentComplete=0})}}),se.bar.on("mousedown",function(){se.percentComplete=se.currentValue/se.max*100});var Ae=!0;se.button.on("mousedown",function(){Ae=se.animating,se.pauseAnimate()}),se.button.on("pressup",function(){Ae&&se.pauseAnimate(!1),se.percentComplete=se.currentValue/se.max*100}),V.keyEvent=E.on("keydown",function(Oe){Oe.key==" "&&(G.toggled?(G.toggle(!1),se.pauseAnimate(!0)):(G.toggle(!0),se.pauseAnimate(!1)))}),V.tickerID=e.Ticker.add(function(){var Oe=Math.min(100,V.slider.currentValue/U*100)-.01;e.loop(I,function(Ye){var de=B+Oe/100*(Z-B)-Ye.tweenStartTime;w&&(Ye.percentComplete=Math.max(0,Math.min(100,de/(Ye.tweenEndTime-Ye.tweenStartTime)*100))),Ye.percentComplete=de/(Ye.tweenEndTime-Ye.tweenStartTime)*100})});var ie;function _e(){e.loop(I,function(Oe){var Ye=Oe.clone().addTo(ie).alp(.05);Ye.color=clear,Ye.borderColor=te}),ie.updateCache("source-over"),ie.disposeAllChildren()}V.trailInterval=e.interval(.05,function(){se.animating&&Y.slider.currentValue>0&&_e()}),V.trailInterval.pause();function $(){V.trails||(ie=new e.Container(k,X).addTo(S,0).cache(),V.trails=new e.Bitmap(ie.cacheCanvas).addTo(S,1),V.trailInterval.pause(!1))}function xe(){V.trails&&(V.trailInterval.pause(),V.trails.dispose(),V.trails=null,ie.dispose(),ie=null)}var Be=new e.Proportion(.1,2,.1,.01);if(localStorage){var me=localStorage.zim_tl;me||(me=JSON.stringify({speed:1,labels:!1,looping:!1,color:purple})),me=JSON.parse(me),D(me.speed),Y.slider.currentValue=me.speed,Y.stepper.currentValue=me.speed,K(me.labels),Q.checkBox.checked=me.labels,m(me.looping),ce.checkBox.checked=me.looping,Ce(me.color),J.colorPicker.selectedColor=me.color,J.swatch.color=me.color,J.colorLabel.text=me.color.toUpperCase(),me.trailing&&$(),pe.checkBox.checked=me.trailing,V.trailInterval.time=Be.convert(me.speed)}this.pos(0,20,"center","bottom"),f!=e.purple&&Ce(f),this.dispose=function(Oe,Ye,de){return e.Ticker.remove(V.tickerID),E.off("keydown",V.keyEvent),de||this.zimContainer_dispose(!0),!0},O!==!1&&e.styleTransforms(this,L)},e.extend(e.Timeline,e.Container,"dispose","zimContainer",!1),e.BlurEffect=function(t,r,i,o,l,f){var h="blurX, blurY, quality, style, group, inherit",p;if(p=mt(e.BlurEffect,arguments,h,this))return p;qe("69.972"),this.group=l;var _=o===!1?{}:e.getStyle("BlurEffect",l,f);n(t)&&(t=_.blurX!=null?_.blurX:10),n(r)&&(r=_.blurY!=null?_.blurY:10),n(i)&&(i=_.quality!=null?_.quality:1);var b=w(t,r,i);this.veeObj={blurX:b[0],blurY:b[1],quality:b[2]};function w(){return arguments}t=dt(t),r=dt(r),i=dt(i),this.createjsBlurFilter_constructor(t,r,i),this.type="BlurEffect",this.clone=function(C){return new e.BlurEffect(C||!e.isPick(b[0])?t:b[0],C||!e.isPick(b[1])?r:b[1],C||!e.isPick(b[2])?i:b[2],o,this.group,f)}},e.extend(e.BlurEffect,$e.BlurFilter,"clone","createjsBlurFilter",!1),e.GlowEffect=function(t,r,i,o,l,f,h,p,_,b,w,C){var O="color, alpha, blurX, blurY, strength, quality, inner, knockout, hideObject, style, group, inherit",P;if(P=mt(e.GlowEffect,arguments,O,this))return P;qe("69.9725"),this.group=w;var A=b===!1?{}:e.getStyle("GlowEffect",w,C);n(t)&&(t=A.color!=null?A.color:e.white),n(r)&&(r=A.alpha!=null?A.alpha:1),n(i)&&(i=A.blurX!=null?A.blurX:30),n(o)&&(o=A.blurY!=null?A.blurY:30),n(l)&&(l=A.strength!=null?A.strength:1),n(f)&&(f=A.quality!=null?A.quality:1),n(h)&&(h=A.inner!=null?A.inner:!1),n(p)&&(p=A.knockout!=null?A.knockout:!1),n(_)&&(_=A.hideObject!=null?A.hideObject:!1);var R=T(t,r,i,o,l,f,h,p,_);this.veeObj={color:R[0],alpha:R[1],blurX:R[2],blurY:R[3],strength:R[4],quality:R[5],inner:R[6],knockout:R[7],hideObject:R[8]};function T(){return arguments}i=dt(i),o=dt(o),f=dt(f),t=dt(t),this.alpha=dt(r),this.strength=dt(l),this.inner=dt(h),this.knockout=dt(p),this.hideObject=dt(_),this.createjsBlurFilter_constructor(i,o,f),this.type="GlowEffect",this.usesContext=!0,this.applyFilter=function(L,S,E,k,X,q,V,I){if((this.alpha<=0||this.strength<=0)&&!this.knockout)return!0;q=q||L,V===void 0&&(V=S),I===void 0&&(I=E);var te=q.getImageData(V,I,k,X),B=te.data,Z=document.createElement("canvas");Z.width=k,Z.height=X;for(var U=Z.getContext("2d",{willReadFrequently:!0}),ee=U.getImageData(0,0,k,X),ae=ee.data,re=this.inner,he=this._red,j=this._green,G=this._blue,y=0,g=ae.length;y<g;y+=4){var d=y+3,D=B[d];re?D!==255&&(ae[y]=he,ae[y+1]=j,ae[y+2]=G,ae[d]=255-D):D!==0&&(ae[y]=he,ae[y+1]=j,ae[y+2]=G,ae[d]=D)}U.putImageData(ee,0,0);var K=this.strength;if(0<K){this.createjsBlurFilter_applyFilter(U,0,0,k,X),255<K&&(K=255);for(var m=1;m<K;m++)U.drawImage(Z,0,0)}var F=this.alpha;F<0?F=0:1<F&&(F=1);var Ce;return this.knockout?re?Ce="source-in":Ce="source-out":this.hideObject?re?Ce="source-in":Ce="copy":re?Ce="source-atop":Ce="destination-over",q.save(),q.setTransform(1,0,0,1,0,0),q.globalAlpha=F,q.globalCompositeOperation=Ce,q.drawImage(Z,V,I),q.restore(),!0},Object.defineProperty(this,"color",{get:function(){return this._red<<16|this._green<<8|this._blue},set:function(L){L=e.convertColor(L,"hexNumber"),this._red=L>>16&255,this._green=L>>8&255,this._blue=L&255}}),this.color=t,this.clone=function(L){return new e.GlowFilter(L||!e.isPick(R[0])?t:R[0],L||!e.isPick(R[1])?r:R[1],L||!e.isPick(R[2])?i:R[2],L||!e.isPick(R[3])?o:R[3],L||!e.isPick(R[4])?f:R[4],L||!e.isPick(R[5])?l:R[5],L||!e.isPick(R[6])?h:R[6],L||!e.isPick(R[7])?p:R[7],L||!e.isPick(R[8])?p:R[8],b,this.group,C)}},e.extend(e.GlowEffect,$e.BlurFilter,["clone","applyFilter"],"createjsBlurFilter",!1),e.ShadowEffect=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P){var A="distance, angle, color, alpha, blurX, blurY, strength, quality, inner, knockout, hideObject, style, group, inherit",R;if(R=mt(e.ShadowEffect,arguments,A,this))return R;qe("69.973"),this.group=O;var T=C===!1?{}:e.getStyle("ShadowEffect",O,P);n(t)&&(t=T.distance!=null?T.distance:10),n(r)&&(r=T.angle!=null?T.angle:45),n(i)&&(i=T.color!=null?T.color:e.black),n(o)&&(o=T.alpha!=null?T.alpha:.4),n(l)&&(l=T.blurX!=null?T.blurX:15),n(f)&&(f=T.blurY!=null?T.blurY:15),n(h)&&(h=T.strength!=null?T.strength:1),n(p)&&(p=T.quality!=null?T.quality:1),n(_)&&(_=T.inner!=null?T.inner:!1),n(b)&&(b=T.knockout!=null?T.knockout:!1),n(w)&&(w=T.hideObject!=null?T.hideObject:!1);var L=S(t,r,i,o,l,f,h,p,_,b,w);this.veeObj={distance:L[0],angle:L[1],color:L[2],alpha:L[3],blurX:L[4],blurY:L[5],strength:L[6],quality:L[7],inner:L[8],knockout:L[9],hideObject:L[10]};function S(){return arguments}l=dt(l),f=dt(f),p=dt(p),i=dt(i),t=dt(t),r=dt(r);var E=this;this.alpha=dt(o),this.strength=dt(h),this.inner=dt(_),this.knockout=dt(b),this.hideObject=dt(w),this.createjsBlurFilter_constructor(l,f,p),this.type="ShadowEffect",this.usesContext=!0,Object.defineProperty(this,"angle",{get:function(){return r},set:function(X){r=X=(X%360+360)%360,k(t,X)}}),this.angle=r,Object.defineProperty(this,"distance",{get:function(){return t},set:function(X){t=X,k(X,r)}}),this.distance=t;function k(X,q){var V=q*e.RAD;E._offsetX=Math.cos(V)*X,E._offsetY=Math.sin(V)*X}Object.defineProperty(this,"color",{get:function(){return this._red<<16|this._green<<8|this._blue},set:function(X){X=e.convertColor(X,"hexNumber"),this._red=X>>16&255,this._green=X>>8&255,this._blue=X&255}}),this.color=i,this.applyFilter=function(X,q,V,I,te,B,Z,U){if((this.alpha<=0||this.strength<=0)&&!this.knockout&&!this.hideObject)return!0;B=B||X,Z===void 0&&(Z=q),U===void 0&&(U=V);var ee=B.getImageData(Z,U,I,te),ae=ee.data,re=document.createElement("canvas");re.width=I,re.height=te;for(var he=re.getContext("2d",{willReadFrequently:!0}),j=he.getImageData(0,0,I,te),G=j.data,y=this.inner,g=this._red,d=this._green,D=this._blue,K=0,m=G.length;K<m;K+=4){var F=K+3,Ce=ae[F];y?Ce!==255&&(G[K]=g,G[K+1]=d,G[K+2]=D,G[F]=255-Ce):Ce!==0&&(G[K]=g,G[K+1]=d,G[K+2]=D,G[F]=Ce)}he.putImageData(j,0,0);var Y=this.strength;if(0<Y){this.createjsBlurFilter_applyFilter(he,0,0,I,te),255<Y&&(Y=255);for(var Q=1;Q<Y;Q++)he.drawImage(re,0,0)}var ce=this.alpha;ce<0?ce=0:1<ce&&(ce=1);var pe;return this.knockout?y?pe="source-in":pe="source-out":this.hideObject?y?pe="source-in":pe="copy":y?pe="source-atop":pe="destination-over",B.save(),B.setTransform(1,0,0,1,0,0),B.globalAlpha=ce,B.globalCompositeOperation=pe,B.drawImage(re,Z+this._offsetX,U+this._offsetY),B.restore(),!0},this.getBounds=function(X){var q=this.createjsBlurFilter_getBounds(X),V=this._offsetX,I=this._offsetY;return V!==0&&(V<0?(q.x+=V,q.width+=-V):q.width+=V),I!==0&&(I<0?(q.y+=I,q.height+=-I):q.height+=I),q},this.clone=function(X){return new e.ShadowFilter(X||!e.isPick(L[0])?t:L[0],X||!e.isPick(L[1])?r:L[1],X||!e.isPick(L[2])?i:L[2],X||!e.isPick(L[3])?o:L[3],X||!e.isPick(L[4])?l:L[4],X||!e.isPick(L[5])?f:L[5],X||!e.isPick(L[6])?p:L[6],X||!e.isPick(L[7])?h:L[7],X||!e.isPick(L[8])?_:L[8],X||!e.isPick(L[9])?b:L[9],X||!e.isPick(L[10])?w:L[10],C,this.group,P)}},e.extend(e.ShadowEffect,$e.BlurFilter,["clone","getBounds","applyFilter"],"createjsBlurFilter",!1),e.ColorEffect=function(t,r,i,o,l,f,h,p,_,b,w){var C="redMultiplier, greenMultiplier, blueMultiplier, alphaMultiplier, redOffset, greenOffset, blueOffset, alphaOffset, style, group, inherit",O;if(O=mt(e.ColorEffect,arguments,C,this))return O;qe("69.9735"),this.group=b;var P=_===!1?{}:e.getStyle("ColorEffect",b,w);n(t)&&(t=P.redMultiplier!=null?P.redMultiplier:1),n(r)&&(r=P.greenMultiplier!=null?P.greenMultiplier:1),n(i)&&(i=P.blueMultiplier!=null?P.blueMultiplier:1),n(o)&&(o=P.alphaMultiplier!=null?P.alphaMultiplier:1),n(l)&&(l=P.redOffset!=null?P.redOffset:0),n(f)&&(f=P.greenOffset!=null?P.greenOffset:0),n(h)&&(h=P.blueOffset!=null?P.blueOffset:0),n(p)&&(p=P.alphaOffset!=null?P.alphaOffset:0);var A=R(t,r,i,o,l,f,h,p);this.veeObj={redMultiplier:A[0],greenMultiplier:A[1],blueMultiplier:A[2],alphaMultiplier:A[3],redOffset:A[4],greenOffset:A[5],blueOffset:A[6],alphaOffset:A[7]};function R(){return arguments}t=dt(t),r=dt(r),i=dt(i),o=dt(o),l=dt(l),f=dt(f),h=dt(h),p=dt(p),this.createjsColorFilter_constructor(t,r,i,o,l,f,h,p),this.type="ColorEffect",this.clone=function(T){return new e.ColorEffect(t,r,i,o,l,f,h,p,T||!e.isPick(A[0])?t:A[0],T||!e.isPick(A[1])?r:A[1],T||!e.isPick(A[2])?i:A[2],T||!e.isPick(A[2])?o:A[3],T||!e.isPick(A[2])?l:A[4],T||!e.isPick(A[2])?f:A[5],T||!e.isPick(A[2])?h:A[6],T||!e.isPick(A[2])?p:A[7],_,this.group,w)}},e.extend(e.ColorEffect,$e.ColorFilter,"clone","createjsColorFilter",!1),e.MultiEffect=function(t,r,i,o,l,f,h){var p="hue, saturation, brightness, contrast, style, group, inherit",_;if(_=mt(e.MultiEffect,arguments,p,this))return _;qe("69.974"),this.group=f;var b=l===!1?{}:e.getStyle("MultiEffect",f,h);n(t)&&(t=b.hue!=null?b.hue:0),n(r)&&(r=b.saturation!=null?b.saturation:0),n(i)&&(i=b.brightness!=null?b.brightness:0),n(o)&&(o=b.contrast!=null?b.contrast:0);var w=C(t,r,i,o);this.veeObj={hue:w[0],saturation:w[1],brightness:w[2],contrast:w[3]};function C(){return arguments}t=dt(t),this.createjsColorMatrixFilter_constructor(new $e.ColorMatrix().adjustColor(i,o,r,t)),this.type="MultiEffect",this.adjustColor=function(O,P,A,R){n(t)||(t=dt(O)),n(r)||(r=dt(P)),n(i)||(i=dt(A)),n(o)||(o=dt(R)),this.matrix.reset().adjustColor(O,P,A,R)},Object.defineProperty(this,"brightness",{get:function(){return i},set:function(O){i=dt(O),this.matrix.reset().adjustColor(i,o,r,t)}}),Object.defineProperty(this,"contrast",{get:function(){return o},set:function(O){o=dt(O),this.matrix.reset().adjustColor(i,o,r,t)}}),Object.defineProperty(this,"saturation",{get:function(){return r},set:function(O){r=dt(O),this.matrix.reset().adjustColor(i,o,r,t)}}),Object.defineProperty(this,"hue",{get:function(){return t},set:function(O){t=dt(O),this.matrix=new $e.ColorMatrix().adjustColor(i,o,r,t),this.applyFilter()}}),this.clone=function(O){return new e.MultiEffect(O||!e.isPick(w[0])?t:w[0],O||!e.isPick(w[0])?r:w[0],O||!e.isPick(w[0])?i:w[0],O||!e.isPick(w[0])?o:w[0],l,this.group,h)}},e.extend(e.MultiEffect,$e.ColorMatrixFilter,"clone","createjsColorMatrixFilter",!1),e.AlphaEffect=function(t,r,i,o){var l="mask, style, group, inherit",f;if(f=mt(e.AlphaEffect,arguments,l,this))return f;qe("69.9745"),this.group=i;var h=r===!1?{}:e.getStyle("AlphaEffect",i,o);n(t)&&(t=h.mask!=null?h.mask:null);var p=_(t);this.veeObj={mask:p[0]};function _(){return arguments}t=dt(t),t.type=="Bitmap"?t=t.image:t.cache&&(t=t.cache().cacheCanvas),this.createjsAlphaMaskFilter_constructor(t),this.type="AlphaEffect",this.clone=function(b){return new e.AlphaEffect(b||!e.isPick(p[0])?t:p[0],r,this.group,o)}},e.extend(e.AlphaEffect,$e.AlphaMaskFilter,"clone","createjsAlphaMaskFilter",!1),e.Pixel=function(t,r,i,o,l,f,h,p,_,b,w,C,O){var P="obj, amount, amountY, blur, dynamic, blendmode, boundary, expand, amountFactor, blurFactor, style, group, inherit",A;if(A=mt(e.Pixel,arguments,P,this))return A;qe("69.9747"),this.group=C;var R=w===!1?{}:e.getStyle("Pixel",C,O);n(t)&&(t=R.obj!=null?R.obj:null),n(r)&&(r=R.amount!=null?R.amount:.5),n(i)&&(i=R.amountY!=null?R.amountY:null);var T=!1;i==null&&(T=!0,i=r),n(o)&&(o=R.blur!=null?R.blur:0),n(l)&&(l=R.dynamic!=null?R.dynamic:!1),n(f)&&(f=R.blendmode!=null?R.blendmode:null),n(h)&&(h=R.boundary!=null?R.boundary:new e.Boundary(t.getBounds())),n(p)&&(p=R.expand!=null?R.expand:0),n(_)&&(_=R.amountFactor!=null?R.amountFactor:.6),n(b)&&(b=R.blurFactor!=null?R.blurFactor:.6);var L=S(t,r,i,o,f,_,b);this.veeObj={obj:L[0],amount:L[1],amountY:L[2],blur:L[3],blendmode:L[4],amountFactor:L[5],blurFactor:L[6]};function S(){return arguments}t=dt(t),r=dt(r),i=dt(i),o=dt(o),f=dt(f),_=dt(_),b=dt(b),p&&(Array.isArray(p)?p.length==1?h.contract(-p):p.length==2?h.contract(-p[0],-p[1]):h.contract(-p[0],-p[1],-p[2],-p[3]):h.contract(-p));var E=e.constrain(_*10,0,10),k=e.constrain(b*10,0,10),X=this,q=Math.pow(Math.E,-r*E),V=Math.pow(Math.E,-i*E),I=Math.pow(Math.E,-o*k);n(t)&&(t=new e.Tile(new e.Circle(20,[e.green,e.blue,e.yellow,e.pink,e.purple]),5,5,5,5));var te=document.createElement("canvas"),B=te.getContext("2d"),Z=document.createElement("canvas"),U=Z.getContext("2d"),ee=I;this.update=function(){!t.cacheCanvas||I!=ee?(t.cache(h.x,h.y,h.width,h.height,I),ee=I):t.updateCache(f);var ae=t.width,re=t.height,he=t.width*q,j=t.height*V;te.width=ae,te.height=re,Z.width=ae,Z.height=re,U.msImageSmoothingEnabled=!1,U.mozImageSmoothingEnabled=!1,U.webkitImageSmoothingEnabled=!1,U.imageSmoothingEnabled=!1,B.drawImage(t.cacheCanvas,0,0,he,j),U.drawImage(te,0,0,he,j,-p*t.scale,-p*t.scale,Z.width+p*2*t.scaleX,Z.height+p*2*t.scaleY)},this.update(),this.zimBitmap_constructor(Z),l&&(this.dynamicTicker=e.Ticker.add(function(){X.update()})),Object.defineProperty(this,"amount",{get:function(){return r},set:function(ae){r=ae,q=Math.pow(Math.E,-r*E),T&&(V=Math.pow(Math.E,-r*E),i=r),X.update()}}),Object.defineProperty(this,"amountX",{get:function(){return r},set:function(ae){r=ae,T=!1,q=Math.pow(Math.E,-r*E),X.update()}}),Object.defineProperty(this,"amountY",{get:function(){return i},set:function(ae){i=ae,T=!1,V=Math.pow(Math.E,-i*E),X.update()}}),Object.defineProperty(this,"amountFactor",{get:function(){return _},set:function(ae){_=ae,E=e.constrain(_*10,0,10),q=Math.pow(Math.E,-r*E),V=Math.pow(Math.E,-i*E),X.update()}}),Object.defineProperty(this,"blur",{get:function(){return o},set:function(ae){o=ae,I=Math.pow(Math.E,-o*k),X.update()}}),Object.defineProperty(this,"blurFactor",{get:function(){return b},set:function(ae){b=ae,k=e.constrain(b*10,0,10),I=Math.pow(Math.E,-o*k),X.update()}}),Object.defineProperty(this,"dynamic",{get:function(){return l},set:function(ae){l!=ae&&(l=ae,l?X.dynamicTicker?X.dynamicTicker=e.Ticker.add(X.dynamicTicker):X.dynamicTicker=e.Ticker.add(X.update):X.dynamicTicker&&e.Ticker.remove(X.dynamicTicker))}}),this.dispose=function(){X.dynamicTicker&&e.Ticker.remove(X.dynamicTicker),this.zimBitmap_dispose()},w!==!1&&e.styleTransforms(this,R),this.clone=function(ae){return X.cloneProps(new e.Pixel(ae||!e.isPick(L[0])?t:L[0],ae||!e.isPick(L[1])?r:L[1],ae||!e.isPick(L[2])?i:L[2],ae||!e.isPick(L[3])?o:L[3],l,ae||!e.isPick(L[4])?f:L[4],h,p,ae||!e.isPick(L[5])?_:L[5],ae||!e.isPick(L[6])?b:L[6],w,this.group,O))}},e.extend(e.Pixel,e.Bitmap,["clone","dispose"],"zimBitmap",!1),e.Parallax=function(t,r,i,o,l,f,h){var p="layers, damp, auto, stage, startPaused, mouseMoveOutside, clamp",_;if(_=mt(e.Parallax,arguments,p,this))return _;if(qe("68"),this.type="Parallax",n(o))if(t&&t[0]&&t[0].obj&&t[0].obj.stage)o=t[0].obj.stage;else if(le.zdf)o=le.zdf.stage;else return;n(i)?i=!0:i=!1,n(l)&&(l=!1),n(f)&&(f=!1);var b=o.getBounds().width,w=o.getBounds().height;o.mouseMoveOutside=f;var C=this;C.stageEvent=o.on("stagemousemove",function(L){C.mouseX=L.rawX/e.scaX,C.mouseY=L.rawY/e.scaY});var O=n(r)?.1:r;this.addLayer=function(L){if(!(n(L.obj)||n(L.prop)||n(L.propChange))){var S={obj:L.obj,prop:L.prop};S[S.prop]=L.propChange,n(L.input)&&(L.input="mouseX"),S.input=L.input,S.split=n(L.split)?!!(L.input=="mouseX"&&i):L.split;var E=n(L.inMin)?0:L.inMin,k=n(L.inMax)?L.input=="mouseX"||L.input=="scrollX"?b:w:L.inMax,X=n(L.factor)?1:L.factor,q=n(L.integer)?!1:L.integer;return S["p_"+S.prop]=new e.ProportionDamp(E,k,0,S[S.prop],O,X,q,h),S.prop=="scale"?S["s_"+S.prop]=S.obj.scaleX:S.prop=="frame"?S["s_"+S.prop]=S.obj.currentFrame:S["s_"+S.prop]=S.obj[S.prop],n(L.immediate)||S["p_"+S.prop].immediate(L.immediate),P.push(S),C}},this.removeLayer=function(L){if(!n(L)){var S=P[L];return S["p_"+S.prop].dispose(),P.splice(L,1),C}},this.immediate=function(L){for(var S,E=0;E<P.length;E++)S=P[E],S["p_"+S.prop].immediate(L[E]);return C},this.dispose=function(){return o.off("stagemousemove",C.stageEvent),P=null,i&&e.Ticker.remove(R),!0},t=n(t)?[]:t;for(var P=[],A=0;A<t.length;A++)this.addLayer(t[A]);if(i){var R=e.Ticker.add(T,o);l&&e.Ticker.remove(R)}function T(){C.step()}this.step=function(L){for(var S,E,k=0;k<P.length;k++)S=P[k],n(L)?S.input=="mouseX"?E=C.mouseX:S.input=="mouseY"?E=C.mouseY:S.input=="scrollX"?E=e.scrollX():S.input=="scrollY"&&(E=e.scrollY()):E=L,S.prop=="scale"?S.obj.scaleX=S.obj.scaleY=S["s_"+S.prop]+S["p_"+S.prop].convert(E):S.prop=="frame"?S.obj.gotoAndStop(S["s_"+S.prop]+S["p_"+S.prop].convert(E)):(S.obj[S.prop]=S["s_"+S.prop]+S["p_"+S.prop].convert(E),S.split&&(S.obj[S.prop]-=S[S.prop]/2));return C},C.paused=l,C.pause=function(L){return n(L)&&(L=!0),C.paused!=L&&(C.paused=L,R&&(L?e.Ticker.remove(R):R=e.Ticker.add(R))),C},Object.defineProperty(C,"damp",{get:function(){return O},set:function(L){O=L;for(var S,E=0;E<P.length;E++)S=P[E],S["p_"+S.prop].damp=O}})},e.Flipper=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P){var A="front, back, interactive, time, vertical, flipped, easeRoot, frontPress, backPress, reverse, continuous, style, group, inherit",R;if(R=mt(e.Flipper,arguments,A,this))return R;qe("68.5"),this.group=O;var T=C===!1?{}:e.getStyle("Flipper",this.group,P);if(n(t)&&(t=T.front!=null?T.front:le.zdf.makeIcon().sca(2)),n(r)&&(r=T.back!=null?T.back:new e.Page(t.width,t.height,e.dark)),this.front=t,this.back=r,f){var L=t;t=r,r=L}var S=Math.max(t.width,r.width),E=Math.max(t.height,r.height);this.zimContainer_constructor(S,E),this.type="Flipper",n(o)&&(o=T.time!=null?T.time:.2),n(l)&&(l=T.vertical!=null?T.vertical:!1),n(i)&&(i=T.interactive!=null?T.interactive:!1),n(f)&&(f=T.flipped!=null?T.flipped:!1),n(h)&&(h=T.easeRoot!=null?T.easeRoot:"quad"),n(p)&&(p=T.frontPress!=null?T.frontPress:!0),n(_)&&(_=T.backPress!=null?T.backPress:!0),n(b)&&(b=T.reverse!=null?T.reverse:!1),n(w)&&(w=T.continuous!=null?T.continuous:!1);var k=f;this.flipped=f;var X=this;t.centerReg(this);var q;(p&&!f||_&&f)&&(q=i&&t.backing?t.backing:t,q.on("mousedown",function(){V(t,r)}),q.cur()),(_&&!f||p&&f)&&(q=i&&r.backing?r.backing:r,q.on("mousedown",function(){V(r,t,-1)}),q.cur()),t.oScale=t.scale,r.oScale=r.scale,t.flipper=X,t.other=r,r.flipper=X,r.other=t,i||(t.mouseChildren=r.mouseChildren=!1),this.flip=function(I,te){I!=X.flipped&&(X.flipped?V(k?t:r,k?r:t,-1,te):V(k?r:t,k?t:r,1,te))};function V(I,te,B,Z){if(n(B)&&(B=1),B*=b?-1:1,w&&(B=b?k?1:-1:k?-1:1),n(Z)&&(Z=o),X.flipped=!X.flipped,X.dispatchEvent("flip"),Z==0){X.removeAllChildren(),te.scale=te.oScale,te.skewX=te.skewY=0,te.centerReg(X),X.dispatchEvent("flipped");return}var U,ee;l?(U={skewX:-90*B,scaleY:I.oScale/2},ee={skewX:0,scaleY:te.oScale},te.ske(90*B,0).sca(te.oScale,te.oScale/2)):(U={skewY:-90*B,scaleX:I.oScale/2},ee={skewY:0,scaleX:te.oScale},te.ske(0,90*B).sca(te.oScale/2,te.oScale)),I.animate({props:U,time:o,ease:h+"In",call:function(){I.removeFrom(),te.centerReg(X).animate({props:ee,time:o,ease:h+"Out",call:function(){X.dispatchEvent("flipped")}})}})}C!==!1&&e.styleTransforms(this,T),this.clone=function(){return X.cloneProps(new e.Flipper(t.clone(),r.clone(),i,o,l,f,h,p,_,b,w,C,this.group,P))}},e.extend(e.Flipper,e.Container,"clone","zimContainer"),e.Book=function(t,r,i,o,l,f,h,p){var _="width, height, pages, startPage, rollUp, radius, backgroundColor, arrows",b;if(b=mt(e.Book,arguments,_,this))return b;qe("68.7"),n(t)&&(t=le.zdf?le.zdf.stage.width:1024),n(r)&&(r=le.zdf?le.zdf.stage.height:768),this.zimContainer_constructor(t,r),this.type="Book",n(i)&&(i=[]),n(o)&&(o=0),n(l)&&(l=!0),n(h)&&(h=e.darker),n(p)&&(p=!0);var w=v(),C=this;if(i.length==0)return;C.backing=new e.Rectangle(t-2,r-2,h),e.loop(i,function(X,q){typeof X=="string"&&(i[q]=e.asset(X)),i[q].zimBookIndex=q,T(X)}),C.added(R);var O,P,A;function R(X){O=X,P=O.frame;var q=new e.Shape,V,I,te,B,Z,U,ee;C._currentPage=o;function ae(D){if(C._currentPage=D,C.removeAllChildren(),C.backing.loc(1,1,C),C.setMask(C.backing),q.addTo(C),q.c().f(e.black).dr(0,0,0,0),C.moving=!1,i[D-1]?V=i[D-1].reg(0,0).rot(0).loc(0,0,C):D>0&&ee.reg(0,0).rot(0).loc(0,0,C).setMask(null),i[D-2]?I=i[D-2].reg(t/2,r).loc(0,r,C).rot(-90):I=new e.Rectangle(t/2,r,h).reg(t/2,r).loc(0,r,C).rot(-90),i[D-3]?te=i[D-3].rot(0).loc(0,0,C).setMask(q):te=new e.Rectangle(t/2,r,h).loc(0,0,C).setMask(q),i[D])B=i[D].rot(0).reg(0,0).pos(0,0,e.RIGHT,e.TOP,C);else{O.update();return}i[D+1]?Z=i[D+1].reg(0,r).loc(t,r,C).rot(90):(Z=new e.Rectangle(t/2,r,h).reg(0,r).loc(t,r,C).rot(90),ee=Z),i[D+2]?U=i[D+2].rot(0).pos(0,0,e.RIGHT,e.TOP,C).setMask(q):U=new e.Rectangle(t/2,r,h).pos(0,0,e.RIGHT,e.TOP,C).setMask(q),O.update()}ae(o),Object.defineProperty(C,"directPage",{get:function(){return C._currentPage},set:function(D){k(),o%2==1?D=Math.ceil(D/2)*2-1:D=Math.ceil(D/2)*2,D!=C.page&&(D>C.page?(Z.reg(0,0),U.setMask(null)):(I.reg(0,0),te.setMask(null)),ae(D),C.moving=!1,re=!1,C.currentW=0,C.currentH=0,E())}});var re=!1;C.currentW=0,C.currentH=0,C.moving=!1;function he(){C.stageEvent=O.on("stagemousedown",function(){if(C.hitTestPoint(P.mouseX,P.mouseY)){var D,K;if(!C.moving){var m=C.globalToLocal(P.mouseX,P.mouseY);if(!(m.x<0||m.x>t||m.y<0||m.y>r)&&!(f>0&&e.dist(m,new e.Point(0,r))>f&&e.dist(m,new e.Point(t,r))>f)){var F=m.x>t/2?"right":"left";F=="right"&&C._currentPage>=i.length-1||F=="left"&&C._currentPage<=1||(C.moving=!0,F=="right"?(B.addTo(C),Z.addTo(C),U.addTo(C),C.pageNext=U.zimBookIndex):(V.addTo(C),I.addTo(C),te.addTo(C),C.rolledUp&&y(0,0,"right"),C.pageNext=I.zimBookIndex),k(),C.direction=F,C.dispatchEvent("rollpress"),C.moveEvent=O.on("stagemousemove",function(){j&&(j.clear(),j=null);var Ce=C.globalToLocal(P.mouseX,P.mouseY);F=="right"?D=t-Ce.x:D=Ce.x,K=r-Ce.y+D,C.currentW=D=e.constrain(D,0,t/2),C.currentH=K=e.constrain(K,0,r),y(D,K,F)}),C.upEvent=O.on("stagemouseup",function(){O.off("stagemousemove",C.moveEvent),!re&&G(D,K,F)},null,!0))}}}})}if(he(),C.rollUp=function(D,K,m,F,Ce){if(!C.moving&&!(m=="right"&&C._currentPage>=i.length-1)&&!(m=="left"&&C._currentPage<=1)){m=="right"?(B.addTo(C),Z.addTo(C),U.addTo(C)):(C.rolledUp&&y(0,0,"right"),V.addTo(C),I.addTo(C),te.addTo(C)),C.moving=!0,n(F)&&(F=w=="s"?.5:.5/1e3),n(Ce)&&(Ce=null),C.animate({props:{currentW:D,currentH:K},time:F,ease:Ce,call:function(){e.Ticker.remove(Y),C.moving=!1,y(D,K,m)}});var Y=e.Ticker.add(function(){y(C.currentW,C.currentH,m)})}},l!==!1){C.rolledUp=!0,l===!0&&(l=w=="s"?1:1/1e3);var j=e.timeout(l,function(){C.rollUp(60,130,"right",.5),C.dispatchEvent("rollup")})}C.rollDown=function(D,K,m,F){C.moving||m=="right"&&C._currentPage>=i.length-1||m=="left"&&C._currentPage<=1||G(D,K,m,F)};function G(D,K,m,F){C.moving=!0,C.rolledUp=!1,n(F)&&(F=w=="s"?.7:.7/1e3),C.animate({props:{currentW:0,currentH:0},time:F,call:function(){e.Ticker.remove(Ce),y(0,0,m),C.moving=!1,E(),C.dispatchEvent("rolldown")}});var Ce=e.Ticker.add(function(){y(C.currentW,C.currentH,m)})}function y(D,K,m){var F;m=="right"?(q.c().mt(t,r).lt(t-D,r).lt(t,r-K).cp(),F=Math.atan2(D,K),Z.loc(t-(D+D*Math.cos(2*F)),r-D*Math.sin(2*F)).rot(F*2*e.DEG),!re&&D>=t/2&&K>=r&&g()):(q.c().mt(0,r).lt(D,r).lt(0,r-K).cp(),F=Math.atan2(D,K),I.loc(D+D*Math.cos(2*F),r-D*Math.sin(2*F)).rot(-F*2*e.DEG),!re&&D>=t/2&&K>=r&&d()),O.update()}function g(){k(),re=!0,C.moving=!0,C.moveEvent&&O.off("stagemousemove",C.moveEvent),C.upEvent&&O.off("stagemouseup",C.upEvent),C.currentW=0,C.currentH=0,C.lastPage=e.constrain(C._currentPage),C.direction="right",C.pageNext=U.zimBookIndex,C.dispatchEvent("pageanimate"),C.animate({ease:"quadOut",props:{currentW:t/2},time:.3,timeUnit:"s",call:function(){e.Ticker.remove(D),Z.reg(0,0),U.setMask(null),ae(C._currentPage+2),C.moving=!1,re=!1,C.currentW=0,C.currentH=0,E(),C.dispatchEvent("page")}});var D=e.Ticker.add(function(){q.c().mt(t,r).lt(t/2,r).lt(t-C.currentW,0).lt(t,0).cp()});Z.reg(t/2,r).loc(t/2,r,C).animate({props:{rotation:0},time:.3,ease:"quadOut",timeUnit:"s"})}function d(){k(),re=!0,C.moving=!0,C.moveEvent&&O.off("stagemousemove",C.moveEvent),C.upEvent&&O.off("stagemouseup",C.upEvent),C.currentW=0,C.currentH=0,C.lastPage=e.constrain(C._currentPage),C.direction="left",C.pageNext=I.zimBookIndex,C.dispatchEvent("pageanimate"),C.animate({ease:"quadOut",props:{currentW:t/2},time:.3,timeUnit:"s",call:function(){e.Ticker.remove(D),I.reg(0,0),te.setMask(null),ae(C._currentPage-2),C.moving=!1,re=!1,C.currentW=0,C.currentH=0,E(),C.dispatchEvent("page")}});var D=e.Ticker.add(function(){q.c().mt(0,r).lt(t/2,r).lt(C.currentW,0).lt(0,0).cp()});I.reg(0,r).loc(t/2,r,C).animate({props:{rotation:0},time:.3,timeUnit:"s",ease:"quadOut"})}p&&(p===!0&&(p=.2),C.keydown=P.on("keydown",function(D){D.keyCode==39?C.nextPage(p):D.keyCode==37&&C.prevPage(p)})),C.changeFrame=function(D){return C.stageEvent&&O.off("stagemousedown",C.stageEvent),C.moveEvent&&O.off("stagemousemove",C.moveEvent),C.upEvent&&O.off("stagemouseup",C.upEvent),P=D,O=D.stage,he(),C},E()}C.nextPage=function(X){if(n(C.rollUp))return setTimeout(function(){C.nextPage(X)},10),C;C.moving||C.rollUp(t/2+.1,r+.1,"right",X,"quadIn")},C.prevPage=function(X){if(n(C.rollUp))return setTimeout(function(){C.prevPage(X)},10),C;C.moving||C.rollUp(t/2+.1,r+.1,"left",X,"quadIn")},C.gotoPage=function(X,q){if(n(C.rollUp))return setTimeout(function(){C.gotoPage(X,q)},10),C;X=e.constrain(X,0,C.pages.length-1),n(q)&&(q=w=="s"?.3:300);var V=q+(w=="s"?.35:350);C.pageInterval=e.interval(V,function(I){var te=!1;C._currentPage<X?C.nextPage(q):C._currentPage>X?C.prevPage(q):te=!0,C.dispatchEvent("pageturn"),I.count==I.total-1&&(te?(E(),C.dispatchEvent("pagedone")):e.timeout(V,function(){E(),C.dispatchEvent("pagedone")}))},Math.floor(Math.abs(X-C._currentPage)/2+1),!0)};function T(X){X.addChild&&(X.zimHTMLList=new e.Dictionary,S(X),X.parent&&X.parent.removeChild(data.page))}function L(X){if(!(n(X)||!X.addChild))for(X.removedHTML=!1,A=0;A<X.zimHTMLList.length;A++)X.addChildAt(X.zimHTMLList.values[A].obj,X.zimHTMLList.values[A].depth)}function S(X){if(!(X.removedHTML||!X.addChild)){X.removedHTML=!0,X.zimHTMLList.clear();var q,V;for(V=0;V<X.numChildren;V++)if(q=X.getChildAt(V),q.type=="TextArea"||q.type=="Loader"||q.type=="Tag"){var I={obj:q,depth:X.getChildIndex(q)};X.zimHTMLList.add(q,I)}for(V=X.numChildren-1;V>=0;V--)q=X.getChildAt(V),(q.type=="TextArea"||q.type=="Loader"||q.type=="Tag")&&X.removeChild(q)}}function E(){C.pages[C.page]&&L(C.pages[C.page]),C.pages[C.page-1]&&L(C.pages[C.page-1])}function k(){C.pages[C.page]&&S(C.pages[C.page]),C.pages[C.page-1]&&S(C.pages[C.page-1])}Object.defineProperty(C,"page",{get:function(){return C._currentPage},set:function(X){C.gotoPage(X,w=="s"?.1:100)}}),Object.defineProperty(C,"pages",{get:function(){return i},set:function(){Ct&&ht("Book() - pages is read only")}}),this.dispose=function(X,q,V){return C.stageEvent&&O.off("stagemousedown",C.stageEvent),C.moveEvent&&O.off("stagemousemove",C.moveEvent),C.upEvent&&O.off("stagemouseup",C.upEvent),C.keydown&&P.off("keydown",C.keydown),C.removeFrom(),V||this.zimContainer_dispose(!0),!0}},e.extend(e.Book,e.Container,["clone","dispose"],"zimContainer"),e.Scrambler=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P){var A="tile, keys, keyProperty, scramble, time, wait, num, shadowColor, shadowBlur, swap, swapLock, style, group, inherit",R;if(R=mt(e.Scrambler,arguments,A,this))return R;qe("67.35"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Scrambler",this.group=O;var T=C===!1?{}:e.getStyle(this.type,this.group,P);n(t)&&(t=T.tile!=null?T.tile:t),n(r)&&(r=T.keys!=null?T.keys:null),n(i)&&(i=T.keyProperty!=null?T.keyProperty:null),n(o)&&(o=T.scramble!=null?T.scramble:!0),n(l)&&(l=T.time!=null?T.time:0),n(f)&&(f=T.wait!=null?T.wait:0),n(h)&&(h=T.num!=null?T.num:1),n(p)&&(p=T.shadowColor!=null?T.shadowColor:"rgba(0,0,0,.3)"),n(_)&&(_=T.shadowBlur!=null?T.shadowBlur:5),n(b)&&(b=T.swap!=null?T.swap:!1),n(w)&&(w=T.swapLock!=null?T.swapLock:!1),w&&(b=!0),n(t)&&(t=new e.Tile(new e.Rectangle(100,100,e.series(e.silver,e.tin,e.grey,e.dark,e.darker)),5,1,5)),t.addTo(this);var L=this;L.tile=t,L.complete=!0;var S=v(l);v(f);var E=(t.width+t.spacingH)/t.cols,k=(t.height+t.spacingV)/t.rows,X=le.zdf,q=e.makeID(null,10),V,I,te,B=!1;t.pointers={},t.on("mousedown",function(G){if(B)return;B=!0,U(G.target),L.myDownCheck=!0,te=G.target;var y="id"+Math.abs(G.pointerID+1);if(t.pointers[y]=!0,V=G.target.x,I=G.target.y,w){var g=t.current;if(L.testItem(G.target,g.indexOf(G.target))){G.target.noMouse(),G.target.noDrag(),G.target.locked=!0,L.myDownCheck=B=!1,ee();return}}if(p!=-1&&_>0){var d=new $e.Shadow(p,3,3,_);G.target.backing?G.target.backing.shadow=d:G.target.shadow=d}X&&(L.scrmu||(L.scrmu=X.on("mouseupplusonly",function(m){if(L.myDownCheck){L.myDownCheck=!1;var F=e.loop(t.pointers,function(Ce,Y){return Y});F||(t.pointers.id0=!0),m={target:te,pointerID:m.pointerID?F:-1},D(m)}}))),L.upEvent&&t.off("pressup",L.upEvent),L.upEvent=t.on("pressup",function(m){var F="id"+Math.abs(m.pointerID+1);t.pointers[F]&&(L.myDownCheck=B=!1,D(m))});function D(m){var F="id"+Math.abs(m.pointerID+1);if(t.pointers[F]){delete t.pointers[F];var Ce=!0;if(ee(),B=!1,L.moveEvent&&t.off("pressmove",L.moveEvent),w){var Y=m.target.boundsToGlobal(),Q=t.hitTestGrid(t.width,t.height,t.cols,t.rows,Y.x+Y.width/2,Y.y+Y.height/2,null,null,t.spacingH,t.spacingV,null,"open");if(n(Q))Ce=!1;else{var ce=g[Q[0]];m.target==ce?Ce=!1:Ce=!L.testItem(ce,Q[0])}}b&&Ce&&Z(m),m.target.mouseEnabled=!1,m.target.animate({props:{x:V,y:I},time:.1,id:q,timeUnit:"seconds",pauseOnBlur:!1,call:K,params:m})}}function K(m){!L.complete&&L.test()&&(L.complete=!0,L.dispatchEvent("complete")),p!=-1&&_>0&&(m.target.backing?m.target.backing.shadow=null:m.target.shadow=null),m.target.mouseEnabled=!0}b||(L.moveEvent&&t.off("pressmove",L.moveEvent),L.moveEvent=t.on("pressmove",function(m){Z(m)}))});function Z(G){var y=G.target;y.stopAnimate();var g=y.boundsToGlobal(),d=t.hitTestGrid(t.width,t.height,t.cols,t.rows,g.x+g.width/2,g.y+g.height/2,null,null,t.spacingH,t.spacingV,null,"open");n(d)||e.loop(t,function(D){if(!(D==y||D.paused===!1)){var K=D.boundsToGlobal(),m=t.hitTestGrid(t.width,t.height,t.cols,t.rows,K.x+K.width/2,K.y+K.height/2,null,null,t.spacingH,t.spacingV,null,"open");if(!n(m)){var F;d[2]==m[2]&&(D.x>=y.x&&D.x<=y.x+E/2||D.x<=y.x&&D.x>=y.x-E/2)&&(F=D.x,D.top().ord(-1),D.animate({props:{x:V},time:.2,id:q,timeUnit:"seconds",call:function(){b&&!L.complete&&L.test()&&(L.complete=!0,L.dispatchEvent("complete"))}}),V=F),d[1]==m[1]&&(D.y>=y.y&&D.y<=y.y+k/2||D.y<=y.y&&D.y>=y.y-k/2)&&(F=D.y,D.top().ord(-1),D.animate({props:{y:I},time:.201,override:!1,id:q,timeUnit:"seconds",call:function(){b&&!L.complete&&L.test()&&(L.complete=!0,L.dispatchEvent("complete"))}}),I=F)}}},!0)}function U(G){t.loop(function(y){y!=G&&y.noMouse()})}function ee(){t.loop(function(G){G.locked||G.mouse()})}this.test=function(){var G=t.current;return e.loop(G,function(y,g){if(n(y)||!L.testItem(y,g))return!1})},this.testItem=function(G,y){if(!n(G)){if(n(y)&&(y=t.current.indexOf(G)),r){var g=n(i)?G.key:G[i];if(g!=r[y])return!1}else if(t.items[y]!=G)return!1;return!0}},this.update=function(){return t.noDrag(),t.drag({boundary:t,singleTouch:!0}),this},this.starts=[];var ae=[];e.loop(t.rows*t.cols,function(G){ae.push(G)});var re=ae.slice();t.loop(function(G){G.mouseChildren=!1,L.starts.push({x:G.x,y:G.y})}),this.inactive=!1,this.scramble=function(G,y,g){n(y)&&(y=0),n(G)&&(G=0),(n(g)||G==0)&&(g=1),he(),e.timeout(y,function(){G>0?e.interval(G/g,d,g,!0):d()}),setTimeout(function(){L.complete=!1,t.loop(function(D){D.mouse(),D.locked=!1}),L.mouse(),t.drag({boundary:t,singleTouch:!0}),B=!1},S=="s"?(y+G)*1e3:y+G);function d(){for(var D=!0,K=0;D&&K<50;)K++,e.shuffle(ae),D=e.loop(ae,function(m,F){var Ce=t.getChildAt(m);if(r){var Y=n(i)?Ce.key:Ce[i];if(Y!=r[F])return!1}else if(t.items[F]!=Ce)return!1});j(ae,G/g),e.timeout(G,function(){L.dispatchEvent("scrambled")})}return L},o?L.scramble(l,f,h):L.added(function(){t.drag({boundary:t,singleTouch:!0})});function he(){L.upEvent&&t.off("pressup",L.upEvent),L.moveEvent&&t.off("pressmove",L.moveEvent),t.noDrag(),f+l>0&&L.noMouse()}function j(G,y,g){e.stopAnimate(q),e.loop(t.items,function(d,D,K){var m=L.starts[G[D]];y?d.animate({props:{x:m.x,y:m.y},time:y,ease:g?"quadInOut":"quadOut",wait:g,timeUnit:"seconds",id:q}):(d.loc(m),L.stage?d.drag({boundary:t,singleTouch:!0}):D==K-1&&L.added(function(){t.drag({boundary:t,singleTouch:!0})}))})}this.solve=function(G,y,g){n(g)&&(g=!0),n(y)&&(y=0),n(G)&&(G=0),y+G==0&&g&&L.noMouse(),setTimeout(function(){ae=re.slice(),he(),j(ae,G,0,g)},S=="s"?y*1e3:y),g||setTimeout(function(){L.mouse(),t.drag({boundary:t,singleTouch:!0})},S=="s"?(y+G)*1e3:y+G)},this._enabled=!0,Object.defineProperty(L,"enabled",{get:function(){return L._enabled},set:function(G){c(L,G),!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&L.stage&&L.stage.update()}}),Object.defineProperty(L,"order",{get:function(){var G=[],y=e.loop(t.current,function(g){if(!g)return!1;G.push(g.tileNum)});return!y||G.length!=ae.length||(ae=G),ae},set:function(G){var y=[];e.loop(G,function(g){y.push(t.items[g])}),t.remake(y),t.stage&&t.stage.update()}}),this.dispose=function(G,y,g){return L.scrmu&&X.off("mouseupplus",L.scrmu),t.removeAllEventListeners(),g||(L.zimContainer_dispose(!0),L.stage&&L.stage.update()),!0},C!==!1&&e.styleTransforms(this,T),this.clone=function(){return L.cloneProps(new e.Scrambler(t.clone(),r,i,o,l,f,h,p,_,b,w,C,L.group,P))}},e.extend(e.Scrambler,e.Container,["clone","dispose"],"zimContainer",!1),e.Scroller=function(t,r,i,o,l,f,h,p,_,b,w){var C="backing, speed, direction, horizontal, gapFix, stage, container, backing2, style, group, inherit",O;if(O=mt(e.Scroller,arguments,C,this))return O;qe("69"),this.cjsEventDispatcher_constructor(),this.type="Scroller",this.group=b;var P=_===!1?{}:e.getStyle(this.type,this.group,w);if(n(t)&&(t=P.backing!=null?P.backing:null),n(t))return;var A=this.backing1=t;if(n(A)||!A.getBounds)return;var R;n(p)?R=this.backing2=t.clone(!0):R=p,n(o)&&(o=P.horizontal!=null?P.horizontal:!0),n(l)&&(l=P.gapFix!=null?P.gapFix:0),n(h)&&(h=P.container!=null?P.container:null),n(f)&&(f=P.stage!=null?P.stage:null);var T=this;n(r)&&(r=P.speed!=null?P.speed:1),this.speed=r;var L=this.baseSpeed=this.speed;n(i)&&(i=P.direction!=null?P.direction:1),this.direction=i;var S=o?A.scaleX:A.scaleY;if(A.type=="AC"){ht("ZIM Scroller(): please provide Pic() with dimensions for backing objects");return}if(!A.getBounds()){ht("ZIM Scroller(): please setBounds() on backing objects");return}if(!f&&!A.stage){ht("ZIM Scroller(): please pass in stage parameter or add backing objects to stage to start");return}if(!A.parent){ht("ZIM Scroller(): please add object to container or stage before adding to Scroller");return}if(A.parent.addChildAt(R,A.parent.getChildIndex(A)),f=f||A.stage,n(h)&&(h=f),!h.getBounds()){ht("zim display - Scroller(): please setBounds() on container or stage if no container");return}var E=A.getBounds().width*S-l,k=A.getBounds().height*S-l,X,q;o?R.x=E:R.y=k;var V=!1,I=e.Ticker.add(te,f);function te(){X||(X=h.getBounds().width,q=h.getBounds().height),!(T.speed==0||T.direction==0)&&(o?(A.x-=T.speed*T.direction,A.x<R.x?R.x=A.x+E:R.x=A.x-E,T.direction*T.speed>0?R.x<0&&A.x<R.x?A.x=R.x+E:A.x<0&&R.x<A.x&&(R.x=A.x+E):R.x>X&&R.x>A.x?R.x=A.x-E:A.x>X&&A.x>R.x&&(A.x=R.x-E)):(A.y-=T.speed*T.direction,A.y<R.y?R.y=A.y+k:R.y=A.y-k,T.direction*T.speed>0?R.y<0&&A.y<R.y?A.y=R.y+k:A.y<0&&R.y<A.y&&(R.y=A.y+k):R.y>q&&R.y>A.y?R.y=A.y-k:A.y>q&&A.y>R.y&&(A.y=R.y-k)))}this.paused=!1,this.pause=function(B,Z){return n(B)&&(B=!0),n(Z)&&(Z=0),B?(L=T.speed,Z>0?(V=!0,e.animate({target:T,obj:{pausingSpeed:0},ticker:!1,time:Z,call:function(){T.speed=0,T.paused=!0,V=!1,T.dispatchEvent("pause")}})):(V=!1,T.speed=0,T.paused=!0,setTimeout(function(){T.dispatchEvent("pause")},10))):(V=!1,Z>0?e.animate({target:T,obj:{pausingSpeed:L},ticker:!1,time:Z,call:function(){T.speed=L,T.paused=!1,V=!1}}):(T.speed=L,T.paused=!1)),T},Object.defineProperty(T,"percentSpeed",{get:function(){return T.baseSpeed==0?NaN:T.speed/T.baseSpeed*100},set:function(B){V||T.paused||(T.speed=T.baseSpeed*B/100)}}),Object.defineProperty(T,"pausingSpeed",{get:function(){return T.baseSpeed==0?NaN:T.speed/T.baseSpeed*100},set:function(B){T.speed=T.baseSpeed*B/100}}),Object.defineProperty(T,"percentComplete",{get:function(){return o?A.x<0&&A.x>R.x?-A.x/A.width*100:(-R.x/R.width*100+1e9)%100:A.y<0&&A.y>R.y?-A.y/A.height*100:(-R.y/R.height*100+1e9)%100},set:function(B){B=(B+1e9)%100,o?(A.x=-B*A.width/100,R.x=A.x+E):(A.y=-B*A.height/100,R.y=A.y+k)}}),_!==!1&&e.styleTransforms(this,P),this.dispose=function(){return e.Ticker.remove(I),!0}},e.extend(e.Scroller,$e.EventDispatcher,null,"cjsEventDispatcher"),e.Dynamo=function(t,r,i,o,l,f,h,p,_,b,w,C){var O="sprite, speed, label, startFrame, endFrame, update, reversible, flip, flipVertical, style, group, inherit",P;if(P=mt(e.Dynamo,arguments,O,this))return P;qe("69.2"),this.cjsEventDispatcher_constructor(),this.type="Dynamo",this.group=w;var A=b===!1?{}:e.getStyle(this.type,this.group,C);if(n(t)&&(t=A.sprite!=null?A.sprite:null),n(t))return;var R=this.frames=t.parseFrames(i,o,l,!0);if(R.length==0)return;this.totalFrames=R.length;var T=0;n(r)&&(r=A.speed!=null?A.speed:30),n(h)&&(h=A.reversible!=null?A.reversible:!0);var L=this.baseSpeed=this.speed=r;n(f)&&(f=A.update!=null?A.update:!1),n(p)&&(p=A.flip!=null?A.flip:null),n(p)&&h==!1&&(p=!0);var S=this,E,k,X=Date.now(),q,V,I,te=!1;S.scaleX=t.scaleX,S.scaleY=t.scaleY;function B(){if(E=requestAnimationFrame(B),k=R[T].s,!(S.speed==0||k==0)&&(V=1e3/Math.abs(S.speed)*k,q=Date.now(),q-X>V)){X=q;var Z=S.frame+(S.speed>0||!h?1:-1),U=!1;Z>=R.length&&(U=!0,Z=0),Z<0&&(U=!0,Z=R.length-1),S.frame=Z,p&&(S.speed<0?t.scaleX=-S.scaleX:t.scaleX=S.scaleX),_&&(S.speed<0?t.scaleY=-S.scaleY:t.scaleY=S.scaleY),U&&S.dispatchEvent("loop"),S.dispatchEvent("change"),f&&t.stage&&t.stage.update(),!n(I)&&I==S.frame&&(te=!1,S.speed=0,S.paused=!0,S.dispatchEvent("pause"))}}B(),this.paused=!1,this.pause=function(Z,U,ee){if(n(Z)&&(Z=!0),Z!=S.paused)return n(U)&&(U=0),Z?(L=S.speed,typeof ee>"u"?U>0?(te=!0,e.animate({target:S,obj:{pausingSpeed:0},ticker:!1,time:U,call:function(){te=!1,S.speed=0,S.paused=!0,S.dispatchEvent("pause")}})):(te=!1,S.speed=0,S.paused=!0,setTimeout(function(){S.dispatchEvent("pause")},10)):(te=!0,I=ee)):(I=null,U>0?(te=!0,e.animate({target:S,obj:{pausingSpeed:L},ticker:!1,time:U,call:function(){te=!1,S.speed=L,S.paused=!1}})):(te=!1,S.speed=L,S.paused=!1)),S},Object.defineProperty(S,"frame",{get:function(){return T},set:function(Z){T=Math.round(Z)%R.length;var U=R[T];n(U)||(t.frame=U.f)}}),Object.defineProperty(S,"percentSpeed",{get:function(){return S.baseSpeed==0?NaN:te||S.paused?L/S.baseSpeed*100:S.speed/S.baseSpeed*100},set:function(Z){if(te||S.paused){L=S.baseSpeed*Z/100;return}S.speed=S.baseSpeed*Z/100}}),Object.defineProperty(S,"pausingSpeed",{get:function(){return S.baseSpeed==0?NaN:S.speed/S.baseSpeed*100},set:function(Z){S.speed=S.baseSpeed*Z/100}}),b!==!1&&e.styleTransforms(this,A),this.dispose=function(){cancelAnimationFrame(E)}},e.extend(e.Dynamo,$e.EventDispatcher,null,"cjsEventDispatcher"),e.Accelerator=function(t){qe("69.3"),this.cjsEventDispatcher_constructor();var r=this;this.type="Accelerator",this.paused=!1,this.items=[],this.paused=!1,this._percentSpeed=100,this.add=function(i){var o;Array.isArray(i)?o=i:o=[i];for(var l,f=0;f<o.length;f++)l=r.items.indexOf(o[f]),l<0&&r.items.push(o[f]);return r},t&&this.add(t),this.remove=function(i){var o;Array.isArray(i)?o=i:o=[i];for(var l,f=0;f<o.length;f++)l=r.items.indexOf(o[f]),l>=0&&r.items.splice(l,1);return r},this.pause=function(i,o,l){if(n(i)&&(i=!0),i==r.paused)return;var f=[];if(i){n(l)||(o=null);for(var h=!1,p=0;p<r.items.length;p++)(!n(o)&&n(l)&&!r.items[p].totalFrames||r.items[p].totalFrames&&(!n(o)||!n(l)))&&(r.items[p].pause(!0,o,l),h=!0,f[p]=1,r.items[p].on("pause",function(){r.paused||(_(!0),r.paused=!0,r.dispatchEvent("pause"))},null,!0));h||(_(),r.paused=!0,setTimeout(function(){r.dispatchEvent("pause")},10))}else r.paused=!1,_();function _(){for(var b=0;b<r.items.length;b++)f[b]!=1&&r.items[b].pause(i)}},Object.defineProperty(r,"percentSpeed",{get:function(){return r._percentSpeed},set:function(i){r._percentSpeed=i;for(var o=0;o<r.items.length;o++)r.items[o].percentSpeed=i}}),this.dispose=function(){for(var i=0;i<r.items.length;i++)r.items[i].dispose();return r.items=null,!0}},e.extend(e.Accelerator,$e.EventDispatcher,null,"cjsEventDispatcher"),e.Emitter=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B,Z,U,ee,ae,re,he,j,G,y){var g="obj, width, height, interval, num, life, fade, shrink, warm, decayTime, decayStart, trace, traceFadeTime, traceShiftX, traceShiftY, angle, force, gravity, wind, layers, animation, random, horizontal, vertical, sink, sinkForce, cache, events, startPaused, pool, poolMin, particles, focusWarm, style, group, inherit",d;if(d=mt(e.Emitter,arguments,g,this))return d;qe("69.9"),this.type="Emitter",this.group=G;var D=j===!1?{}:e.getStyle(this.type,this.group,y);n(t)&&(t=D.obj!=null?D.obj:[new e.Circle(20,e.pink),new e.Circle(20,e.green),new e.Circle(20,e.blue)]),n(r)&&(r=D.width!=null?D.width:300),n(i)&&(i=D.height!=null?D.height:300);var K=v(o);n(o)&&(o=D.interval!=null?D.interval:K=="s"?.02:20),typeof o=="number"&&(o=Math.max(K=="s"?.01:10,o)),n(l)&&(l=D.num!=null?D.num:1),n(C)&&(C=D.trace!=null?C.size:!1),n(O)&&(O=D.traceFadeTime!=null?D.traceFadeTime:b),n(P)&&(P=D.traceShiftX!=null?D.traceShiftX:0),n(A)&&(A=D.traceShiftY!=null?D.traceShiftY:0),a(f,K),n(f)&&(f=D.life!=null?D.life:K=="s"?1:1e3),n(h)&&(h=D.fade!=null?D.fade:!0),n(p)&&(p=D.shrink!=null?D.shrink:!C),n(_)&&(_=D.warm!=null?D.warm:null),a(b,K),n(b)&&(b=D.decayTime!=null?D.decayTime:K=="s"?1:1e3),n(R)&&(R=D.angle!=null?D.angle:{min:0,max:360}),n(T)&&(T=D.force!=null?D.force:5),n(L)&&(L=D.gravity!=null?D.gravity:9.8),n(S)&&(S=D.wind!=null?D.wind:0),n(E)&&(E=D.layers!=null?D.layers:"top"),n(r)&&(r=D.width!=null?D.width:100),n(i)&&(i=D.height!=null?D.height:100),n(q)&&(q=D.horizontal!=null?D.horizontal:!1),n(V)&&(V=D.vertical!=null?D.vertical:!1),n(I)&&(I=D.sink!=null?D.sink:null),!n(I)&&n(te)&&(te=D.sinkForce!=null?D.sinkForce:10),n(Z)&&(Z=D.events!=null?D.events:!1),n(U)&&(U=D.startPaused!=null?D.startPaused:!1),n(ee)&&(ee=D.pool!=null?D.pool:!0),n(ae)&&(ae=D.poolMin!=null?D.poolMin:0),n(re)&&(re=D.particles!=null?D.particles:new e.Container),n(he)&&(he=D.focusWarm!=null?D.focusWarm:!0),t.type=="shape"&&(he=!1),re.type="Particles",re.emitter=this,this.zimContainer_constructor(r,i,null,null,!1),this.type="Emitter";var m=this;this.regX=r/2,this.regY=i/2,m.obj=t,m.particles=re,m.interval=o,m.num=l,m.life=f,m.fade=h,m.shrink=p,m.decayTime=b,m.decayStart=w,m.trace=C,m.traceFadeTime=O,m.traceShiftX=P,m.traceShiftY=A,m.angle=R,m.emitterForce=T,m.gravity=L,m.wind=S,m.layers=E,m.animation=k,m.random=X,m.horizontal=q,m.vertical=V,m.sink=I,m.sinkForce=te,m.events=Z,m.startEmitterPaused=m.emitterPaused=U,m.pool=ee,m.poolMin=ae,m.particlesEmitted=0;var F=[],Ce=0,Y=0,Q,ce;e.added(m,pe);function pe(se){if(m.emitterPaused=null,m.on("added",function(){e.loop(m.particles,function(_e){_e.visible=!1}),m.particles.addTo(m.parent)}),ce=se,n(B)&&(ce.isWebGL?B=!1:B=e.mobile()),B&&(ce.snapToPixelEnabled=!0),ce){let _e=function(){var xe=e.isPick(m.life)?e.Pick.getMinMax(m.life).max:m.life;if(n(xe)&&(xe=K=="s"?1:1e3),m.startEmitterPaused){m.pauseEmitter();return}if(t=Array.isArray(m.obj)?m.obj:[m.obj],t.length<=0)return;var Be,me;function Oe(Ye,de){return Ye-de}Array.isArray(m.interval)?(m.interval.sort(Oe),Be=m.interval[0]):m.interval.constructor=={}.constructor?Be=m.interval.min:Be=m.interval,Array.isArray(m.num)?(m.num.sort(Oe),me=m.num[m.num.length-1]):m.num.constructor=={}.constructor?me=m.num.max:me=m.num,e.loop(e.Pick.choose(m.num),function(){if(m.decayTime>0){var Ye={};m.shrink&&(Ye.scale=0),m.fade&&(Ye.alpha=0)}var de,ve,Me;if(m.pool&&F.length>0&&Y>=Math.max(m.poolMin,xe/Be*me))de=F[Ce++%F.length],de.visible=!0,Me=de.trace?de.getChildAt(0):de,Me.emitShape&&(ve=Me.template,Me.graphics.c().s(ve.s?e.Pick.choose(ve.s):null).ss(ve.ss?e.Pick.choose(ve.ss):null).sd(ve.sd?e.Pick.choose(ve.sd):null,ve.offset?e.Pick.choose(ve.offset):null)),de.trace&&de.cacheCanvas&&de.updateCache(),m.layers=="top"?Me.emitShape?de.addTo(re,null,!1):de.addTo(re,re.numChildren-1):Me.emitShape?de.addTo(re,m.layers=="bottom"?0:e.rand(re.numChildren),!1):de.addTo(re,m.layers=="bottom"?0:e.rand(re.numChildren)),C||de.reg("center"),de.scaleX=1,de.scaleY=1,de.alpha=de.originalAlpha,Me.scaleX=Me.originalScaleX,Me.scaleY=Me.originalScaleY,Me.rotation=Me.originalRotation,Me.color=Me.originalColor,Me.endSpurt=!1;else{Y++,m.trace&&(de=new e.Container(r,i,null,null,!1),de.trace=!0);var we=e.Pick.choose(e.shuffle(t)[0]);we.type=="shape"?(ve=we,Me=new e.Shape(1,1,null,null,null,!1),Me.emitShape=!0,Me.template=ve,Me.graphics.s(ve.s?e.Pick.choose(ve.s):null).ss(ve.ss?e.Pick.choose(ve.ss):null).sd(ve.sd?e.Pick.choose(ve.sd):null,ve.offset?e.Pick.choose(ve.offset):null),m.trace?Me.addTo(de,null,!1):m.layers=="top"?Me.addTo(re,null,!1):Me.addTo(re,m.layers=="bottom"?0:e.rand(re.numChildren),null,!1)):(Me=we.clone(),Me.centerReg||Wn(Me),m.trace?Me.centerReg(de).loc(-1e3,-1e3):m.layers=="top"?Me.centerReg(re):Me.centerReg(re,m.layers=="bottom"?0:e.rand(re.numChildren))),m.trace&&(m.layers=="top"?de.addTo(re,null,!1):de.addTo(re,m.layers=="bottom"?0:e.rand(re.numChildren),!1),de.cache(P,A,r*2,i*2)),m.trace||(de=Me),de.particle=Me,de.originalAlpha=de.alpha,Me.originalAlpha=Me.alpha,Me.originalScaleX=Me.scaleX,Me.originalScaleY=Me.scaleY,Me.originalRotation=Me.rotation,Me.originalColor=Me.color}m.currentParticle=Me,m.particlesEmitted++,de.particleNormal=!0,de.particleDecaying=!1,de.particleFizzing=!1;var Fe=e.Pick.choose(m.angle),ge=e.Pick.choose(m.emitterForce),Ve=ge*Math.cos(Fe*Math.PI/180),He=ge*Math.sin(Fe*Math.PI/180);Me.info={position:{x:m.x,y:m.y},velocity:{x:Ve,y:He},sink:n(te)?null:dt(te)},m.horizontal&&(Me.info.position={x:m.x-m.regX+e.rand(0,r),y:m.y-m.regY+(m.vertical?i/2:0)}),m.vertical&&(Me.info.position={x:m.x-m.regX+(m.horizontal?r/2:0),y:m.y-m.regY+e.rand(0,i)}),Me.emitShape?Me.graphics.mt(Me.info.position.x,Me.info.position.y):(Me.x=Me.info.position.x,Me.y=Me.info.position.y),Me.alpha=Me.originalAlpha,m.random&&e.loop(m.random,function(Ke,st){var yt=e.Pick.choose(st);Ke=="scale"?Me.sca(yt):(Ke=="x"?Me.info.position.x=m.horizontal||m.vertical?yt:yt+r/2:Ke=="y"&&(Me.info.position.y=m.horizontal||m.vertical?yt:yt+i/2),(Ke=="x"||Ke=="y")&&Me.emitShape&&Me.graphics.mt(Me.info.position.x,Me.info.position.y),Me[Ke]=yt,Me.emitShape&&(Me.x=0,Me.y=0))}),B&&!Me.emitShape&&Me.cache(Me.getBounds().x-10,Me.getBounds().y-10,Me.getBounds().width+20,Me.getBounds().height+20);var Le=Me.emitShape?!1:m.shrink,fe=(de||Me).life=dt(m.life);if(m.decayTime>0&&(m.fade||Le||m.trace&&m.traceFadeTime>0)){if(m.trace&&m.traceFadeTime>0&&de.animate({obj:{alpha:0},time:m.traceFadeTime,wait:fe-m.traceFadeTime,waitedCall:function(Ke){Ke.particleNormal=!1,Ke.particleFizzing=!0},call:J,override:!1,id:"decay"}),m.fade||Le){var Ge={};m.fade&&(Ge.alpha=0),Le&&(Ge.scaleX=0,Ge.scaleY=0),Me.animate({obj:Ge,time:m.decayTime,wait:n(m.decayStart)?fe-m.decayTime:m.decayStart,waitedCall:function(Ke){Ke.parent!=m&&(Ke=Ke.parent),Ke.particleNormal=!1,Ke.particleDecaying=!0},call:function(Ke){m.events&&ue("decayed",Ke),Ke.endSpurt&&ue("spurtdecayed",Ke),m.trace&&m.traceFadeTime>0||(n(m.decayStart)||m.decayStart+m.decayTime>m.life?Ke.parent&&J(Ke.parent.trace?Ke.parent:Ke):-function(){var st=de;e.timeout(fe-(m.decayStart+m.decayTime),function(){J(st)})}())},override:!1,id:"decay"})}}else de.life=m.life,m.life>0&&-function(){var Ke=de;Ke.timeOut=e.timeout(m.life,function(){J(Ke)})}();if(m.events&&ue("emitted",de),ye(Me),m.animation){var Qe=e.Pick.choose(m.animation);Array.isArray(Qe)?e.loop(Qe,function(Ke){n(Ke.override)&&(Ke.override=!1),Me.animate(e.copy(Ke))}):(n(Qe.override)&&(Qe.override=!1),Me.animate(e.copy(Qe)))}})},$=function(){e.loop(re,function(xe){if(xe.trace){var Be=xe;xe=xe.getChildAt(0)}var me=xe.info,Oe=0,Ye=0;if(!n(m.sink)){var de=m.particles.localToGlobal(me.position.x,me.position.y),ve;m.sink.parent&&m.sink.parent.localToGlobal?ve=m.sink.parent.localToGlobal(m.sink.x,m.sink.y):ve=new $e.Point(e.Pick.choose(m.sink.x),e.Pick.choose(m.sink.y));var Me=e.angle(de.x,de.y,ve.x,ve.y);Oe=me.sink*Math.cos(Me*Math.PI/180),Ye=me.sink*Math.sin(Me*Math.PI/180)}var we=m.wind+Oe,Fe=m.gravity+Ye;me.velocity.x+=we*ie,me.velocity.y+=Fe*ie,me.position.x+=me.velocity.x*ie*100,me.position.y+=me.velocity.y*ie*100,xe.emitShape?xe.graphics.lt(me.position.x,me.position.y):(xe.x=me.position.x,xe.y=me.position.y),m.trace&&Be&&Be.cacheCanvas&&Be.updateCache(xe.emitShape?null:"source-over")})};var Ae=m.parent.getChildIndex(m);m.parent.addChildAt(re,Ae),!q&&!V&&m.centerReg(null,null,!1),m.zimInterval=e.interval(m.interval,_e,null,!0,!0);var ie=0;Q=m.emitterTicker=e.Ticker.add($,ce),ie=1/e.Ticker.framerate,m.focusWarm=he,m.doWarm=function(xe){if(n(xe)||xe===!0){var Be;f.max?Be=f.max:Array.isArray(f)?Be=e.arrayMinMax(f).max:Be=dt(f);var me;o.min?me=o.min:Array.isArray(o)?me=e.arrayMinmin(o).min:me=dt(o),xe=Math.min(200,Math.round(Be/me))}var Oe=m.pool;m.pool=!1;var Ye=Math.round(o*e.Ticker.framerate);e.loop(Math.round(xe*o*e.Ticker.framerate),function(de){de%Ye==0&&_e(),e.loop(re,function(ve){ve.warmTick?ve.warmTick++:ve.warmTick=1,ve.warmTick/e.Ticker.framerate>ve.life&&J(ve)}),$()}),e.loop(re,function(de){if(de.zimTweens){var ve=de.warmTick/e.Ticker.framerate/de.life*100;ve>=100&&(de.alpha=0),de.percentComplete=ve}}),m.pool=Oe},_&&m.doWarm(_)}}m.particles.noMouse();function J(se){if(m.events&&ue("fizzed",se),(se.trace?se.getChildAt(0).endSpurt:se.endSpurt)&&(ue("spurtfizzed",se),m.spurting=!1),m.pool&&se.pooled!="end")if(se.pooled){se.visible=!1;return}else{se.pooled=!0,F&&F.push(se),se.visible=!1;return}m.removeChild(se),m.trace&&se.uncache(),se=null}function ue(se,Ae){if(!n(Ae)){var ie=new $e.Event(se);ie.particle=Ae.trace?Ae.getChildAt(0):Ae,m.dispatchEvent(ie)}}function ye(se){n(m.spurtCount)&&n(m.spurtNum)||(m.spurtCount++,m.spurtCount>=m.spurtNum&&Xe(se))}function Xe(se){m.pauseEmitter(),m.spurtCount=m.spurtNum=null,!n(se)&&(ue("spurted",se),se.endSpurt=!0)}Object.defineProperty(m,"interval",{get:function(){return o},set:function(se){o=se,m.zimInterval&&(m.zimInterval.time=o)}}),this.removeFrom=function(){m.parent&&m.parent.removeChild(m),m.particles.removeFrom()},this.spurting=!1,this.spurt=function(se,Ae,ie){var _e="num, time, restart",$;return($=mt(m.spurt,arguments,_e))?$:(n(Ae)||(e.timeout(e.Pick.choose(Ae),function(){Xe(m.currentParticle)},!0),m.spurting=!0),n(se)||(m.spurtNum=e.Pick.choose(se),m.spurtCount=0,m.spurting=!0),m.pauseEmitter(!1,ie,null,!0),m)},this.clearPool=function(){e.loop(m.particles,function(se){se.pooled="end",se.visible||m.removeChild(se)},!0),Y=0,Ce=0,F=[]},m.startEmitterPaused||(this.emitterPaused=!1),this.pauseEmitter=function(se,Ae,ie,_e){if(m.startEmitterPaused=null,n(se)&&(se=!0),n(Ae)&&(Ae=!1),n(ie)&&(ie=!1),se){if(m.emitterPaused)return m;ie&&(Q&&e.Ticker.remove(Q),e.loop(m.particles,function($){$.pauseAnimate(),$.trace&&$.getChildAt(0).pauseAnimate(),$.timeOut&&$.timeOut.pause()})),m.zimInterval.pause(),m.emitterPaused=!0}else{if(!m.emitterPaused)return m;Ae&&(e.loop(m.particles,function($){$.stopAnimate(),$.timeOut&&$.timeOut.clear(),$.trace&&$.getChildAt(0).pauseAnimate()}),m.removeAllChildren()),ce&&Q&&!e.Ticker.has(ce,Q)&&(e.Ticker.add(Q,ce),e.loop(m.particles,function($){$.pauseAnimate(!1),$.timeOut&&$.timeOut.pause(!1),$.trace&&$.getChildAt(0).pauseAnimate(!1)})),m.zimInterval&&m.zimInterval.pause(!1,_e),m.emitterPaused=!1}return m},this.resize=function(se,Ae){n(se)||(r=se),n(Ae)||(i=Ae),m.setBounds(0,0,r,i),!q&&!V&&m.centerReg(),m.clearPool()},j!==!1&&e.styleTransforms(this,D),this.clone=function(se){var Ae;return Array.isArray(m.obj)||m.obj.constructor=={}.constructor?Ae=e.copy(m.obj):m.obj.clone?Ae=m.obj.clone(se):Ae=m.obj,m.cloneProps(new e.Emitter(Ae,r,i,m.interval,m.num,m.life,m.fade,m.shrink,m.decayTime,m.decayStart,m.trace,m.traceFadeTime,m.traceShiftX,m.traceShiftY,m.angle,m.emitterForce,m.gravity,m.wind,m.layers,m.animation,e.copy(m.random),m.horizontal,m.vertical,m.sink,m.sinkForce,B,m.events,U,m.pool,m.poolMin,j,m.group,y))},this.dispose=function(){return m.zimInterval&&m.zimInterval.clear(),Q&&e.Ticker.remove(Q),e.loop(F,function(se){se&&se.dispose()}),re&&re.dispose&&re.dispose(),m.currentParticle&&m.currentParticle.dispose&&m.currentParticle.dispose(),t&&Array.isArray(t)?e.loop(t,function(se){se.dispose&&se.dispose()}):t&&t.dispose&&t.dispose(),re=m.currentParticle=m.particles=t=m.obj=F=m.poolList=null,!0}},e.extend(e.Emitter,e.Container,"clone","zimContainer",!1),e.Generator=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X){var q="color, strokeColor, strokeWidth, draw, stamp, setup, maxCount, boundary, drawCount, drawPause, drawSpacebarPause, startX, startY, cache, recordLinePoints, frame, seed, output, outputType, style, group, inherit",V;if(V=mt(e.Generator,arguments,q,this))return V;qe("69.92"),this.group=k;var I=E===!1?{}:e.getStyle("Generator",this.group,X);n(R)&&(R=I.frame!=null?I.frame:le.zdf);var te=R.stage;n(t)&&(t=I.color!=null?I.color:null),n(r)&&(r=I.strokeColor!=null?I.strokeColor:e.white),n(i)&&(i=I.strokeWidth!=null?I.strokeWidth:1),n(h)&&(h=I.maxCount!=null?I.maxCount:1e3),n(p)&&(p=I.boundary!=null?I.boundary:new e.Boundary(0,0,te.width,te.height)),n(_)&&(_=I.drawCount!=null?I.drawCount:1),n(b)&&(b=I.drawPause!=null?I.drawPause:!0),n(w)&&(w=I.drawSpacebarPause!=null?I.drawSpacebarPause:!0),n(C)&&(C=I.startX!=null?I.startX:te.width/2),n(O)&&(O=I.startY!=null?I.startY:te.height/2),n(P)&&(P=I.cache!=null?I.cache:!1);var B=this.drawing=new e.Container(p.x,p.y,p.width,p.height).addTo(te),Z=this.shape=new e.Shape(p.width,p.height).addTo(B);this.drawCount=_,n(b)&&(b=!0),P&&Z.cache(p.x,p.y,p.width,p.height),this.zimContainer_constructor(p.x,p.y,p.width,p.height),this.type="Generator";var U=this;if(U.draw=null,L){U.drawCount=10,!n(l)&&n(o)&&(o=l),l=null;var ee=new e.Loader;U.outputNum=0,U.outputName=L===!0?"gen_":L.match(/_$/)?L:L+"_"}this.color=t,this.strokeColor=r,this.strokeWidth=i;var ae=C,re=O;this.fill=function(g){return U.color=g,U.currentColor=dt(U.color),Z.f(U.currentColor),this},this.stroke=function(g,d){return n(g)||(U.strokeColor=g,U.currentStrokeColor=dt(U.strokeColor),Z.s(U.currentStrokeColor)),n(d)||(U.strokeWidth=d,U.currentStrokeWidth=dt(U.strokeWidth),Z.ss(U.currentStrokeWidth)),this},this.noStroke=function(){return U.strokeColor=U.currentStrokeColor=null,U.strokeWidth=U.currentStrokeWidth=null,Z.s(),Z.ss(1),this},Z.matrix=Z.getMatrix(),this.translate=function(g,d){n(g)&&(g=0),n(d)&&(d=0),g=dt(g),d=dt(d);var D=Z.matrix.transformPoint(g,d);return ae=D.x,re=D.y,Z.mt(ae,re),Z.matrix.translate(g,d),this},this.rotate=function(g){return n(g)&&(g=0),g=dt(g),Z.matrix.rotate(g),this},this.scale=function(g,d){return n(g)&&(g=1),n(d)&&(d=g),g=dt(g),d=dt(d),Z.matrix.scale(g,d),this},this.skew=function(g,d){return n(g)&&(g=0),n(d)&&(d=0),g=dt(g),d=dt(d),Z.matrix.skew(g,d),this},A&&(U.linePoints=[]),this.line=function(g,d,D,K){n(g)&&(g=0),n(d)&&(d=0),n(D)&&(D=0),n(K)&&(K=0),g=dt(g),d=dt(d),D=dt(D),K=dt(K),(A=="zero"||A=="nonzero"&&g&&d)&&U.linePoints.push([g,d]),U.translate(g,d);var m=Z.matrix.transformPoint(D,K);return ae=m.x,re=m.y,Z.lt(ae,re),A&&U.linePoints.push([ae,re]),Z.matrix.translate(D,K),this},this.arc=function(g,d,D,K,m,F){n(g)&&(g=0),n(d)&&(d=0),n(D)&&(D=50),g=dt(g),d=dt(d),D=dt(D),D=Math.abs(D),n(K)&&(K=0),n(m)&&(m=180),K=dt(K),m=dt(m),n(F)&&(F=!1),F=dt(F),U.translate(g,d);var Ce=Z.matrix.transformPoint(0,0);Z.decomp||(Z.decomp={}),Z.matrix.decompose(Z.decomp);var Y=(Math.abs(Z.decomp.scaleX)+Math.abs(Z.decomp.scaleY))/2,Q=Z.decomp.rotation||0,ce=D*Y;return Z.mt(Ce.x+ce*Math.cos((K+Q)*Math.PI/180),Ce.y+ce*Math.sin((K+Q)*Math.PI/180)),Z.a(Ce.x,Ce.y,ce,(K+Q)*Math.PI/180,(m+Q)*Math.PI/180,F),this},this.curve=function(g,d,D,K,m,F){n(g)&&(g=0),n(d)&&(d=0),n(D)&&(D=50),n(K)&&(K=50),n(m)&&(m=100),n(F)&&(F=0),g=dt(g),d=dt(d),D=dt(D),K=dt(K),m=dt(m),F=dt(F),U.translate(g,d);var Ce=Z.matrix.transformPoint(D,K),Y=Z.matrix.transformPoint(m,F),Q=Y.x,ce=Y.y;return Z.qt(Ce.x,Ce.y,Q,ce),Z.matrix.translate(m,F),this},this.bezier=function(g,d,D,K,m,F,Ce,Y){n(g)&&(g=0),n(d)&&(d=0),n(D)&&(D=50),n(K)&&(K=50),n(m)&&(m=-50),n(F)&&(F=-50),n(Ce)&&(Ce=100),n(Y)&&(Y=0),g=dt(g),d=dt(d),D=dt(D),K=dt(K),m=dt(m),F=dt(F),Ce=dt(Ce),Y=dt(Y),U.translate(g,d);var Q=Z.matrix.transformPoint(D,K),ce=Z.matrix.transformPoint(m,F),pe=Z.matrix.transformPoint(Ce,Y),J=pe.x,ue=pe.y;return Z.bt(Q.x,Q.y,ce.x,ce.y,J,ue),Z.matrix.translate(Ce,Y),this},this.rectangle=function(g,d,D,K,m,F,Ce,Y){if(n(g)&&(g=0),n(d)&&(d=0),n(D)&&(D=100),n(K)&&(K=D),g=dt(g),d=dt(d),D=dt(D),K=dt(K),!m&&!F&&!Ce&&!Y){U.translate(g,d);var Q=Z.matrix.transformPoint(0,0),ce=Z.matrix.transformPoint(D,0),pe=Z.matrix.transformPoint(D,K),J=Z.matrix.transformPoint(0,K);return Z.mt(Q.x,Q.y).lt(ce.x,ce.y).lt(pe.x,pe.y).lt(J.x,J.y).lt(Q.x,Q.y).lt(ce.x,ce.y),Z.mt(Q.x,Q.y),this}n(m)&&(m=0),n(F)&&(F=m),n(Ce)&&(Ce=m),n(Y)&&(Y=m),m=dt(m),F=dt(F),Ce=dt(Ce),Y=dt(Y);var ue=(D<K?D:K)/2,ye=0,Xe=0,se=0,Ae=0;ue=Math.abs(ue),m<0&&(m*=ye=-1),m>ue&&(m=ue),F<0&&(F*=Xe=-1),F>ue&&(F=ue),Ce<0&&(Ce*=se=-1),Ce>ue&&(Ce=ue),Y<0&&(Y*=Ae=-1),Y>ue&&(Y=ue),U.translate(g,d),Z.decomp||(Z.decomp={}),Z.matrix.decompose(Z.decomp);var ie=(Math.abs(Z.decomp.scaleX)+Math.abs(Z.decomp.scaleY))/2,_e=D<0?-1:1,$=K<0?-1:1,xe=Z.matrix.transformPoint(D-F*_e,0),Be=Z.matrix.transformPoint(D+F*Xe*_e,-F*Xe*$),me=Z.matrix.transformPoint(D,F*$),Oe=Z.matrix.transformPoint(D,K-Ce*$),Ye=Z.matrix.transformPoint(D+Ce*se*_e,K+Ce*se*$),de=Z.matrix.transformPoint(D-Ce*_e,K),ve=Z.matrix.transformPoint(Y*_e,K),Me=Z.matrix.transformPoint(-Y*Ae*_e,K+Y*Ae*$),we=Z.matrix.transformPoint(0,K-Y*$),Fe=Z.matrix.transformPoint(0,m*$),ge=Z.matrix.transformPoint(-m*ye*_e,-m*ye*$),Ve=Z.matrix.transformPoint(m*_e,0);return Z.mt(xe.x,xe.y).at(Be.x,Be.y,me.x,me.y,F*ie).lt(Oe.x,Oe.y).at(Ye.x,Ye.y,de.x,de.y,Ce*ie).lt(ve.x,ve.y).at(Me.x,Me.y,we.x,we.y,Y*ie).lt(Fe.x,Fe.y).at(ge.x,ge.y,Ve.x,Ve.y,m*ie).cp(),this},this.circle=function(g,d,D,K,m){n(g)&&(g=0),n(d)&&(d=0),n(D)&&(D=50),n(K)&&(K=100),n(m)&&(m=!0),g=dt(g),d=dt(d),D=dt(D),K=dt(K),D=Math.abs(D),U.translate(g,d);var F=Z.matrix.transformPoint(0,0);Z.decomp||(Z.decomp={}),Z.matrix.decompose(Z.decomp);var Ce=(Math.abs(Z.decomp.scaleX)+Math.abs(Z.decomp.scaleY))/2,Y=Z.decomp.rotation||0,Q=D*Ce;if(U.circleHeight=Q*2,typeof K=="number"&&K>=0&&K<100){var ce=360*K/100/2;Z.mt(F.x+Q*Math.cos((-ce-90+Y)*Math.PI/180),F.y+Q*Math.sin((-ce-90+Y)*Math.PI/180)),Z.a(F.x,F.y,Q,(-ce-90+Y)*Math.PI/180,(ce-90+Y)*Math.PI/180,!1),m&&Z.cp(),U.circleHeight=Q-Math.cos(ce*Math.PI/180)*Q}else Z.mt(F.x+Q,F.y),Z.a(F.x,F.y,Q,0,Math.PI*2);return this},this.elipse=function(g,d,D,K){n(g)&&(g=0),n(d)&&(d=0),n(D)&&(D=100),n(K)&&(K=50),g=dt(g),d=dt(d),D=dt(D),K=dt(K),U.translate(g,d);var m=Z.matrix.transformPoint(-D/2,-K/2);Z.decomp||(Z.decomp={}),Z.matrix.decompose(Z.decomp);var F=Z.decomp.scaleX,Ce=Z.decomp.scaleY;return Z.de(m.x,m.y,D*F,K*Ce),this},this.poly=function(g,d,D,K,m,F){n(g)&&(g=0),n(d)&&(d=0),n(D)&&(D=100),n(K)&&(K=5),n(m)&&(m=0),n(F)&&(F=0),g=dt(g),d=dt(d),D=dt(D),K=dt(K),m=dt(m),F=dt(F),D=Math.abs(D),U.translate(g,d);var Ce=Z.matrix.transformPoint(0,0);Z.decomp||(Z.decomp={}),Z.matrix.decompose(Z.decomp);var Y=(Math.abs(Z.decomp.scaleX)+Math.abs(Z.decomp.scaleY))/2,Q=Z.decomp.rotation||0,ce=D*Y;return Z.dp(Ce.x,Ce.y,ce,K,m,Q),this},this.closePath=this.close=this.cp=function(){return Z.cp(),this},this._noise=new e.Noise(T),this.noise=function(){if(arguments.length==1)return(this._noise.simplex1D.apply(null,arguments)+1)/2;if(arguments.length==2)return(this._noise.simplex2D.apply(null,arguments)+1)/2;if(arguments.length==3)return(this._noise.simplex3D.apply(null,arguments)+1)/2;if(arguments.length==4)return(this._noise.simplex4D.apply(null,arguments)+1)/2},this.stack=[],this.colorStrokeStack=[],this.push=function(){return U.stack.push(Z.matrix.clone()),U.colorStrokeStack.push([U.color,U.strokeColor,U.strokeWidth,U.currentColor,U.currentStrokeColor,U.currentStrokeWidth]),this},this.pop=function(){Z.matrix=U.stack.pop()||Z.matrix;var g=U.colorStrokeStack.pop()||[U.color,U.strokeColor,U.strokeWidth,U.currentColor,U.currentStrokeColor,U.currentStrokeWidth];return U.color=g[0],U.strokeColor=g[1],U.strokeWidth=g[2],U.currentColor=g[3],U.currentStrokeColor=g[4],U.currentStrokeWidth=g[5],Z.f(U.currentColor).s(U.currentStrokeColor).ss(U.currentStrokeWidth),Z.mt(Z.matrix.x,Z.matrix.y),this},this.blit=function(){return Z.updateCache("source-over"),Z.c(),this},this.step=function(){return U.draw&&y(),this},n(U.color)||this.fill(U.color),!n(U.strokeColor)&&U.strokeWidth?this.stroke(U.strokeColor,U.strokeWidth):U.noStroke(),this.translate(ae,re),typeof f=="function"&&(this.setup=f,e.timeout(.01,function(){f(0,U.count,U),P&&Z.updateCache(),te.update()}));var he=0;this.maxCount=h,this.resetup=function(g){return n(g)&&(g=!0),he=0,g&&U.shape.c(),n(U.color)||this.fill(U.color),!n(U.strokeColor)&&U.strokeWidth?this.stroke(U.strokeColor,U.strokeWidth):U.noStroke(),this.reset(),this.setup&&(f(0,U.count,U),P&&Z.updateCache(),te.update()),this},this.stampNum=0,typeof l=="function"&&(this.stamp=l,e.timeout(.015,function(){G(0)})),this.restamp=function(g,d){return n(g)&&(g=!0),n(d)&&(d=!0),he=0,g&&U.shape.c(),d&&U.resetup(g),G(0),this},this.reset=function(){return this.fill(t),!n(r)&&i?this.stroke(r,i):this.noStroke(),Z.matrix.identity(),this.translate(C,O),this},this.clear=function(){return this.shape.c(),this};function j(){ee.save({content:te,filename:U.outputName+e.decimals(U.outputNum,null,null,6),type:S}),U.outputNum++}L&&(te.update(),j());function G(g){U.stampNum++;var d=e.loop(U.maxCount,function(D,K){if(U.paused)return U.pausedCount=D,!1;if(U.changeCount)return U.changeCount=!1,!1;he=D+1;var m=l(D+1,K,U,U.stampNum);if(U.currentColor=dt(U.color),Z.f(U.currentColor),U.currentStrokeColor=dt(U.strokeColor),Z.s(U.currentStrokeColor),U.currentStrokeWidth=dt(U.strokeWidth),Z.ss(U.currentStrokeWidth),L&&(te.update(),j()),m)return m},null,null,g);P&&Z.updateCache(),d&&U.dispatchEvent("complete"),te.update()}U.iterator=0,typeof o=="function"&&(this.draw=o,f?setTimeout(function(){U.ticker=e.Ticker.add(y)},100):this.ticker=e.Ticker.add(y),U.generatorPaused=!1,b&&(U.pauseEvent=te.on("stagemousedown",function(){U.count>=U.maxCount||U.pauseTimeout||(e.Ticker.has(U.ticker)?(e.Ticker.remove(U.ticker),U.generatorPaused=!0,U.dispatchEvent("generatorpaused")):(U.ticker=e.Ticker.add(U.ticker),U.generatorPaused=!1,U.dispatchEvent("generatorunpaused")))})),w&&(U.pauseSpacebarEvent=R.on("keydown",function(g){U.count>=U.maxCount||U.pauseTimeout||g.keyCode==20&&(e.Ticker.has(U.ticker)?(e.Ticker.remove(U.ticker),U.generatorPaused=!0,U.dispatchEvent("generatorpaused")):(U.ticker=e.Ticker.add(U.ticker),U.generatorPaused=!1,U.dispatchEvent("generatorunpaused")))})));function y(){U.iterator++,U.iterator%Math.ceil(U.drawCount)==0&&(U.count++,U.draw(U.count,U.maxCount,U),P&&U.blit(),U.currentColor=dt(U.color),Z.f(U.currentColor),U.currentStrokeColor=dt(U.strokeColor),Z.s(U.currentStrokeColor),U.currentStrokeWidth=dt(U.strokeWidth),Z.ss(U.currentStrokeWidth),U.dispatchEvent("drawing"),te.update(),L&&j()),U.maxCount&&U.count>=U.maxCount&&(U.dispatchEvent("complete"),e.Ticker.remove(U.ticker))}this.redraw=function(g,d){return n(g)&&(g=!0),U.reset(),n(d)&&(d=!0),U.ticker&&e.Ticker.remove(U.ticker),U.iterator=0,U.count=0,g&&U.shape.c(),d?(U.resetup(g),setTimeout(function(){U.ticker&&(U.ticker=e.Ticker.add(U.ticker))},100)):U.ticker&&(U.ticker=e.Ticker.add(U.ticker)),this},this.paused=!1,this.pause=function(g,d){if(n(g)&&(g=!0),!(U.count>=U.maxCount)){if(g==this.paused)return this;this.paused=g,this.pauseTimeout&&this.pauseTimeout.clear(),this.paused?U.ticker&&e.Ticker.remove(U.ticker):U.ticker?U.ticker=e.Ticker.add(U.ticker):G(U.pausedCount,U.maxCount),setTimeout(function(){te.update()},20),d&&(this.pauseTimeout=e.timeout(d,function(){U.pause(!U.paused),U.pauseTimeout=null})),U.dispatchEvent(U.paused?"paused":"unpaused")}},this.outOfBounds=function(g,d){n(g)&&(g=0),n(d)&&(d=g);var D=U.shape.stage;if(D)return U.currentX>D.width-g||U.currentX<0+g||U.currentY>D.height-d||U.currentY<0+d},this.stop=function(){U.pause(),U.pauseEvent&&te.off("stagemousedown",U.pauseEvent),U.pauseSpaceEvent&&R.off("keydown",U.pauseSpaceEvent)},Object.defineProperty(this,"count",{get:function(){return he},set:function(g){he=g,U.stamp&&(U.changeCount=!0,setTimeout(function(){G(he,U.maxCount)}))}}),Object.defineProperty(this,"currentX",{get:function(){return ae},set:function(){Ct&&ht("Generator() - currentX is read only")}}),Object.defineProperty(this,"currentY",{get:function(){return re},set:function(){Ct&&ht("Generator() - currentY is read only")}}),this.clone=function(){return U.cloneProps(new e.Generator(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,E,U.group,X))},U.dispose=function(g,d,D){return U.pause(),U.ticker&&e.Ticker.remove(U.ticker),U.pauseEvent&&te.off("stagemousedown",U.pauseEvent),U.pauseSpacebarEvent&&R.off("keydown",U.pauseSpacebarEvent),U._noise&&(U._noise=null),U.shape&&U.shape.dispose(),U.drawing&&U.drawing.dispose(),U.shape=U.drawing=null,D||U.zimContainer_dispose(),!0},E!==!1&&e.styleTransforms(this,I)},e.extend(e.Generator,e.Container,["clone","dispose"],"zimContainer",!1),e.Pen=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B,Z,U,ee){var ae="size, color, penType, damp, spread, borderColor, borderWidth, end, paper, nib, cache, ctrlKey, cropScale, undo, undoKeys, move, onTop, deleteable, doubleClickDelete, holdDelete, immediateStop, lineAlpha, lineBlendMode, frame, dashed, pullColor, pullThickness, style, group, inherit",re;if(re=mt(e.Pen,arguments,ae,this))return re;qe("69.93"),this.zimContainer_constructor(),this.type="Pen",this.group=U;var he=Z===!1?{}:e.getStyle(this.type,this.group,ee);n(i)&&(i=he.penType!=null?he.penType:"line");var j={size:2,color:e.dark,spread:{min:5,max:20},borderColor:e.darker,borderWidth:0},G={line:{size:2},kitetail:{size:{min:5,max:20},color:e.series(e.pink,e.blue,e.green),borderColor:"rgba(0,0,0,.5)",borderWidth:1},grass:{color:e.green,size:3,spread:{min:10,max:30}},hair:{color:[e.pink,e.blue],size:3,spread:{min:20,max:50}},city:{size:{min:30,max:70},spread:{min:50,max:200},color:[e.dark,e.darker,e.grey]},barbwire:{},splatter:{size:{min:5,max:20},color:"rgba(0,0,0,.5)"}};n(G[i])&&(i="line"),n(t)&&(t=he.size!=null?he.size:n(G[i].size)?j.size:G[i].size),n(r)&&(r=he.color!=null?he.color:n(G[i].color)?j.color:G[i].color),n(o)&&(o=he.damp!=null?he.damp:.5),o===!1&&(o=1),n(l)&&(l=he.spread!=null?he.spread:n(G[i].spread)?j.spread:G[i].spread),n(f)&&(f=he.borderColor!=null?he.borderColor:n(G[i].borderColor)?j.borderColor:G[i].borderColor),n(h)&&(h=he.borderWidth!=null?he.borderWidth:n(G[i].borderWidth)?j.borderWidth:G[i].borderWidth),n(p)&&(p=he.end!=null?he.end:e.isPick(t)||e.isPick(r)||i!="line"?"butt":"round"),n(O)&&(O=he.cropScale!=null?he.cropScale:1),n(w)&&(w=he.cache!=null?he.cache:!0),n(P)&&(P=he.undo!=null?he.undo:0),n(A)&&(A=he.undoKeys!=null?he.undoKeys:!0),n(R)&&(R=he.move!=null?he.move:!0),n(L)&&(L=he.deleteable!=null?he.deleteable:!0),n(S)&&(S=he.doubleClickDelete!=null?he.doubleClickDelete:!0),n(E)&&(E=he.holdDelete!=null?he.holdDelete:!0),n(T)&&(T=he.onTop!=null?he.onTop:!0),n(k)&&(k=he.immediateStop!=null?he.immediateStop:"both"),n(X)&&(X=he.lineAlpha!=null?he.lineAlpha:1),n(q)&&(q=he.lineBlendMode!=null?he.lineBlendMode:"normal"),n(_)&&(_=he.paper!=null?he.paper:new e.Container),n(b)&&(b=he.nib!=null?he.nib.clone():null),n(V)&&(V=he.frame!=null?he.frame:le.zdf),n(I)&&(I=he.dashed!=null?he.dashed:null),I===!0&&(I=[3,100]),n(te)&&(te=he.pullColor!=null?he.pullColor:null),n(B)&&(B=he.pullThickness!=null?he.pullThickness:1);var y=this;this.dampX=new e.Damp(null,o),this.dampY=new e.Damp(null,o);var g=!0;this.drawing=!1,this.immediateStop=k,this.undoLevels=P,this.undoKeys=A,this.move=R,this.draggable=!0,this.lineAlpha=X,this.lineBlendMode=q;var d=y.shape=new e.Shape,D=V.stage.width,K=V.stage.height,m,F,Ce,Y;y.paperNum=0,y.sizeScale=1,y.spreadScale=1,y.sizeFactor=1,y.spreadFactor=1,y.pullThickness=B,y.stop=function(){};var Q;this.added(function(ie){Q=ie,y.paper=_,D=y.stage.width,K=y.stage.height,n(b)?y.stageDown=Q.on("stagemousedown",function(me){y.dispatchEvent("start")}):y.zimDown?y.nib=b.addTo(y):(y.nib=b.addTo(y.parent,y.parent.getChildIndex(y)),y.nib.x=y.x,y.nib.y=y.y,y.nib.mouseEnabled=!1,y.stageDown=Q.on("stagemousedown",function(me){Q=me.target.stage,y.nibEvent=Q.on("stagemousemove",_e),y.dispatchEvent("start")}),y.stageUp=Q.on("stagemouseup",function(){Q.off("stagemousemove",y.nibEvent)}));function _e(me){y.drawing&&(y.nib.x=me.stageX/e.scaX,y.nib.y=me.stageY/e.scaY)}y.zimDragCheck=!1,y.stop=function(){y.stopCheck(!0)},y.infinite=!1,y.stopCheck=function(me){if(me)y.drawing=!1,y.infinite=!1;else if(y.infinite||y.zimDragCheck||!y.immediateStop&&y.drawing)return;y.immediate(y.x,y.y),setTimeout(function(){var Oe;if(!y.drawing){if(w?(d.cache(-(D*O-D)/2,-(K*O-K)/2,D*O,K*O),Oe=_.bitmap=new e.Bitmap(d.cacheCanvas).reg((D*O-D)/2,(K*O-K)/2).addTo(_),d.graphics.clear(),d.uncache(),d.top()):Oe=d,y.undoLevels>0){var Ye={paper:_,line:Oe};P.push(Ye),P.length>y.undoLevels&&P.shift(),y.dispatchEvent("recordUndo")}w||(d=new e.Shape().clone().addTo(_)),y.lastSegment=Oe,y.lastSelected=Oe,Oe.alpha=y.lineAlpha,Oe.blendMode=y.lineBlendMode,Oe.paper=_,y.dispatchEvent("stop"),y.dispatchEvent("change")}},y.immediateStop||me?0:50)};var $=0;y.dampX.immediate(y.x),y.dampY.immediate(y.y),y.lastX=y.lastMidX=y.drawX=y.x,y.lastY=y.lastMidY=y.drawY=y.y;var xe,Be;y.ticker=e.Ticker.add(function(){if(y.parent){var me=y.dampX.convert(g?y.x:y.finishX),Oe=y.dampY.convert(g?y.y:y.finishY),Ye=y.parent.localToLocal(me,Oe,d);if(Math.abs(y.lastX-me)+Math.abs(y.lastY-Oe)<1){if(y.drawing&&(y.drawing=!1,y.zimDown?(y.x=y.lastX=y.lastMidX=g?y.x:y.finishX,y.y=y.lastY=y.lastMidY=g?y.y:y.finishY):(y.x=y.finishX=y.lastX=y.lastMidX=me,y.y=y.finishY=y.lastY=y.lastMidY=Oe),y.stopCheck(),xe=Be=null),y.lastX=y.lastMidX=me,y.lastY=y.lastMidY=Oe,_){var de=_.localToLocal(0,0,y.parent);y.lastMidX-=de.x,y.lastMidY-=de.y}return}else{var ve=e.Pick.choose(t)*y.sizeScale*y.sizeFactor,Me=e.Pick.choose(l)*y.spreadScale*y.spreadFactor;y.drawing||(J=[],_.getChildIndex(d)!=_.numChildren-1&&d.top()),y.drawing=!0,y.dispatchEvent("drawing")}var we=y.parent.localToLocal(y.lastX,y.lastY,d),Fe;_?Fe=_.localToLocal(y.lastMidX,y.lastMidY,d):Fe=y.parent.localToLocal(y.lastMidX,y.lastMidY,d);var ge,Ve,He;if(i=="splatter")for(var Le=0;Le<=3;Le++){var fe=e.rand(360)*Math.PI/180,Ge=Me,Qe={x:me+Ge*Math.cos(fe),y:Oe+Ge*Math.sin(fe)},Ke=y.parent.localToLocal(Qe.x,Qe.y,d);d.graphics.mt(Ke.x,Ke.y).f(e.Pick.choose(r)).dc(Ke.x,Ke.y,ve/2)}else i=="grass"||i=="hair"||i=="city"?((i=="grass"||i=="hair")&&(ge=y.lastX+(me-y.lastX)/2,Ve=y.lastY+(Oe-y.lastY)/2,He=y.parent.localToLocal(ge,Ve,d),d.graphics.s(e.Pick.choose(r)).ss(ve,p).mt(He.x,He.y).lt(He.x+e.rand(-Me/4,Me/4),i=="hair"?He.y+Me:He.y-Me)),(i=="grass"||i=="hair"||i=="city"&&$%3==0)&&d.graphics.s(e.Pick.choose(r)).ss(ve,p).mt(Ye.x,Ye.y).lt(Ye.x+(i=="city"?0:e.rand(-Me/4,Me/4)),i=="hair"?He.y+Me:Ye.y-Me),$++):(i=="kitetail"&&d.graphics.s(e.Pick.choose(r)).ss(ve,p),i=="barbwire"?(d.graphics.s(e.Pick.choose(r)).ss(ve,p),ge=y.lastX+(me-y.lastX)/2+e.rand(-Me,Me),Ve=y.lastY+(Oe-y.lastY)/2+e.rand(-Me,Me)):(ge=y.lastX+(me-y.lastX)/2,Ve=y.lastY+(Oe-y.lastY)/2),He=y.parent.localToLocal(ge,Ve,d),i!="line"&&d.graphics.qt(we.x,we.y,He.x,He.y));if(h>0&&i!="line"&&(ge=y.lastX+(me-y.lastX)/2,Ve=y.lastY+(Oe-y.lastY)/2,He=y.parent.localToLocal(ge,Ve,d),d.graphics.s(e.Pick.choose(f)).ss(e.Pick.choose(h)).mt(Fe.x,Fe.y).qt(we.x,we.y,He.x,He.y),i=="splatter"&&d.graphics.es()),i=="splatter")d.graphics.f(e.Pick.choose(r));else if(i!="kitetail")if(i=="line"){if(e.isPick(r)||ve!=Be){var st=e.Pick.choose(r);(st!=xe||ve!=Be)&&d.graphics.s(st).ss(ve,p),xe=st,Be=ve}}else d.graphics.s(e.Pick.choose(r)).ss(ve,p);i!="grass"&&i!="hair"&&i!="city"&&i!="splatter"&&d.graphics.mt(Fe.x,Fe.y).qt(we.x,we.y,He.x,He.y),I&&d.graphics.sd(I),y.lastX=me,y.lastY=Oe,He&&(y.lastMidX=He.x,y.lastMidY=He.y),y.drawX=y.lastMidX||0,y.drawY=y.lastMidY||0}}),n(te)||ce(Q),y.mouseChildren=!1});function ce(ie){var _e=ie.frame;y.ppdEvent&&y.off("drawing",y.ppdEvent),y.ppsEvent&&y.off("stop",y.ppsEvent),y.ppmEvent&&ie.off("stagemousedown",y.ppmEvent),y.pullShape||(y.pullShape=new e.Shape),y.ppdEvent=y.on("drawing",function(){setTimeout(function(){var $=_.localToGlobal(y.drawX,y.drawY);y.pullShape.c().s(te).ss(y.pullThickness).mt(_e.mouseX,_e.mouseY).lt($.x,$.y)},10)}),y.ppsEvent=y.on("stop",function(){y.pullShape.removeFrom(),y.pullShape.c()}),y.ppmEvent=ie.on("stagemousedown",function(){y.pullShape.addTo(ie),y.immediate(_e.mouseX,_e.mouseY),y.motionController&&y.motionController.immediate(_e.mouseX,_e.mouseY)})}function pe(){y.ppdEvent&&y.off("drawing",y.ppdEvent),y.ppsEvent&&y.off("stop",y.ppsEvent),y.ppmEvent&&y.off("stagemousedown",y.ppmEvent),y.pullShape&&y.pullShape.dispose()}P=[];var J=[];this.saveState=function(ie,_e,$){var xe=ie.type=="Container"?"paper":"line",Be={paper:y.paper};Be[xe]=ie,Be[xe+"Transform"]={x:ie.x,y:ie.y,r:ie.rotation,a:ie.alpha,rX:ie.regX,rY:ie.regY,sX:ie.scaleX,sY:ie.scaleY,skX:ie.skewX,skY:ie.skewY,v:ie.visible},!n(_e)&&!n($)&&_e!=$&&(Be.startLayer=_e,Be.endLayer=$),P.push(Be),y.dispatchEvent("recordUndo"),P.length>y.undoLevels&&P.shift()};var ue={x:0,y:0,r:0,a:1,rX:0,rY:0,sX:1,sY:1,skX:0,skY:0,v:!0};this.undo=function(){var ie=P.pop();if(ie){if(J.push(ie),ie.clear){for(var _e=0;_e<ie.clear.length;_e++)ie.paper.addChild(ie.clear[_e]);ie.paper.addChild(d)}else ie.line&&ie.lineTransform?(n(ie.startLayer)||(d.top(),ie.paper.setChildIndex(ie.line,Ce)),ye("line",ie.line)):ie.line?ie.line.removeFrom():ie.paperTransform&&ye("paper",ie.paper);y.lastPaper=y.paper,ie.paper!=y.paper&&(y.paper=ie.paper,y.dispatchEvent("paperChange")),y.dispatchEvent("change"),y.dispatchEvent("undo"),!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&y.stage&&y.stage.update()}};function ye(ie,_e){for(var $,xe=P.length-1;xe>=0;xe--)if(P[xe][ie]==_e&&P[xe][ie+"Transform"]){$=P[xe][ie+"Transform"];break}$||($=e.copy(ue)),_e.x=$.x,_e.y=$.y,_e.alpha=$.a,_e.rotation=$.r,_e.regX=$.rX,_e.regY=$.rY,_e.scaleX=$.sX,_e.scaleY=$.sY,_e.skewX=$.skX,_e.skewY=$.skY,_e.visible=$.v,ie=="line"&&w&&(_e.regX=(D*O-D)/2,_e.regY=(K*O-K)/2)}this.redo=function(){var ie=J.pop(),_e,$;ie&&(P.push(ie),ie.clear?(ie.paper.removeAllChildren(),ie.paper.addChild(d)):ie.line&&ie.lineTransform?(n(ie.endLayer)||(d.top(),ie.paper.setChildIndex(ie.line,Y)),$=ie.lineTransform,_e=ie.line):ie.line?ie.line.addTo(ie.paper):ie.paperTransform&&($=ie.paperTransform,_e=ie.paper),_e&&(_e.x=$.x,_e.y=$.y,_e.alpha=$.a,_e.rotation=$.r,_e.regX=$.rX,_e.regY=$.rY,_e.scaleX=$.sX,_e.scaleY=$.sY,_e.skewX=$.skX,_e.skewY=$.skY,_e.visible=$.v),y.lastPaper=y.paper,ie.paper!=y.paper&&(y.paper=ie.paper,y.dispatchEvent("paperChange")),y.dispatchEvent("change"),y.dispatchEvent("redo"),!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&y.stage&&y.stage.update())},y.ctrlKey=!1,y.shiftKey=!1,y.ctrlKeyCheck=!1,y.zimkeydownEvent=function(ie){y.ctrlKey=ie.ctrlKey,y.shiftKey=ie.shiftKey,ie.keyCode==17&&R&&!y.ctrlKeyCheck&&(y.ctrlKeyCheck=!0,_.noDrag(),_.drag({onTop:T,all:!0})),!(y.undoLevels<=0)&&y.undoKeys&&(ie.ctrlKey&&(ie.shiftKey&&ie.keyCode==90||ie.keyCode==89)?y.redo():ie.ctrlKey&&ie.keyCode==90&&y.undo(),V&&V.ctrlKey&&y.write&&(y.lastWrite=y.write,y.write=!1))},le.addEventListener("keydown",y.zimkeydownEvent),y.zimkeyupEvent=function(ie){ie.keyCode==17&&R&&y.ctrlKeyCheck&&(y.ctrlKeyCheck=!1,_.noDrag(),_.drag({onTop:T})),ie.ctrlKey||(y.ctrlKey=!1),ie.shiftKey||(y.shiftKey=!1),V&&!V.ctrlKey&&y.write==!1&&(y.write=y.lastWrite)},le.addEventListener("keyup",y.zimkeyupEvent),Object.defineProperty(this,"paper",{get:function(){return _},set:function(ie){ie.type=="Container"&&(_=ie,d.addTo(_,0,!1),_.shape=d,y.dampX.immediate(y.x),y.dampY.immediate(y.y),y.lastX=y.lastMidX=y.finishX=y.x,y.lastY=y.lastMidY=y.finishY=y.y,i=="barbwire"&&d.graphics.s(e.Pick.choose(r)).ss(e.Pick.choose(t)*y.sizeScale*y.sizeFactor,p),d.graphics.mt(y.x,y.y),_.parent||_.addTo(y.parent,y.parent.getChildIndex(y)),n(_.paperNum)&&(_.paperNum=++y.paperNum,L&&_.on("mousedown",function(_e){y.lastSelected=_e.target,y.nibEvent&&y.stage.off("stagemousemove",y.nibEvent);var $=_e.target.paper;$&&($!=y.paper&&(y.paper=$,y.dispatchEvent("paperChange")),y.shiftKey&&(y.ctrlKey?y.clear():(_e.target.visible=!1,y.undoLevels>0&&y.saveState(_e.target),y.dispatchEvent("change"))))}),S&&_.on("dblclick",function(_e){_e.target.visible=!1,y.undoLevels>0&&y.saveState(_e.target)}),S&&_.hold(function(_e){_e.target.visible=!1,y.undoLevels>0&&y.saveState(_e.target)}),R&&(_.on("mousedown",function(_e){Q=_e.target.stage,y.draggingCheck=!0,!(y.shiftKey&&L)&&(m=_e.stageX/e.scaX,F=_e.stageY/e.scaY,d.top(),Ce=_.getChildIndex(_e.target))}),_.drag({onTop:T}),_.on("pressup",function(_e){if(!(L&&y.shiftKey)&&_e.target.visible!=!1&&!(y.undoLevels<=0)){if(Math.abs(_e.stageX/e.scaX-m)<1&&Math.abs(_e.stageY/e.scaY-F)<1){T&&(d.top(),Y=_.getChildIndex(_e.target),Ce!=Y&&y.saveState(_e.target,Ce,Y));return}y.ctrlKey?(y.saveState(_),y.dispatchEvent("paperChange")):(d.top(),Y=_.getChildIndex(_e.target),y.saveState(_e.target,Ce,Y)),y.dispatchEvent("change"),d.top()}}))))}}),Object.defineProperty(this,"write",{get:function(){return g},set:function(ie){g&&ie===!1&&(y.finishX=y.x,y.finishY=y.y),!g&&ie&&(d.graphics.es(),d.graphics.ef(),y.dampX.immediate(y.x),y.dampY.immediate(y.y),y.lastX=y.lastMidX=y.x,y.lastY=y.lastMidY=y.y),g=ie}}),Object.defineProperty(this,"size",{get:function(){return t},set:function(ie){d.graphics.es(),d.graphics.ef(),t=ie,i!="splatter"&&d.graphics.ss(e.Pick.choose(t)*y.sizeScale*y.sizeFactor,p)}}),Object.defineProperty(this,"color",{get:function(){return r},set:function(ie){r=ie,d.graphics.es(),d.graphics.ef(),i!="splatter"&&d.graphics.s(e.Pick.choose(r))}}),Object.defineProperty(this,"penType",{get:function(){return i},set:function(ie){i=ie,d.graphics.ef().es(),i!="splatter"?d.graphics.s(e.Pick.choose(r)):d.graphics.s(e.Pick.choose(r)).ss(e.Pick.choose(t)*y.sizeScale*y.sizeFactor,p)}}),Object.defineProperty(this,"end",{get:function(){return p},set:function(ie){p=ie}}),Object.defineProperty(this,"damp",{get:function(){return o},set:function(ie){o=ie,y.dampX.damp=o,y.dampY.damp=o}}),Object.defineProperty(this,"spread",{get:function(){return l},set:function(ie){l=ie}});var Xe,se;this.setColorRange=function(ie,_e){return n(_e)?(Xe=y.color,se=ie):n(ie)?(Xe=y.color,se=_e):(Xe=ie,se=_e),y};var Ae=0;Object.defineProperty(y,"colorRange",{get:function(){return Ae},set:function(ie){Ae=ie,!n(Xe)&&!n(se)&&(y.color=e.colorRange(Xe,se,ie))}}),Object.defineProperty(this,"borderColor",{get:function(){return f},set:function(ie){f=ie}}),Object.defineProperty(this,"borderWidth",{get:function(){return h},set:function(ie){h=ie}}),Object.defineProperty(this,"pullColor",{get:function(){return te},set:function(ie){if(n(ie||ie==-1))pe(),te=null;else if(n(te)){te=ie;var _e=Q||zdf.stage;ce(_e)}else te=ie}}),y.setPen=function(ie){y.dampX.immediate(y.x),y.dampY.immediate(y.y),y.lastX=y.lastMidX=y.finishX=y.x,y.lastY=y.lastMidY=y.finishY=y.y,n(ie)&&(ie=i),n(G[ie])&&(ie="line"),y.penType=i=ie;var _e=e.merge(j,G[ie]);for(var $ in _e)y[$]!=_e[$]&&(y[$]=_e[$]);return y},y.immediate=function(ie,_e){return n(ie)||(y.x=ie,y.dampX.immediate(y.x),y.lastX=y.lastMidX=y.finishX=y.x),n(_e)||(y.y=_e,y.dampY.immediate(y.y),y.lastY=y.lastMidY=y.finishY=y.y),y},y.clear=function(){for(var ie=[],_e=0;_e<_.numChildren-1;_e++)ie.push(_.getChildAt(_e));return P.push({paper:_,clear:ie}),P.length>y.undoLevels&&P.shift(),y.dispatchEvent("recordUndo"),_.removeAllChildren(),d.graphics.clear(),_.addChild(d),y.dispatchEvent("change"),y.stage&&y.stage.update(),y},this.deleteSegment=function(ie){ie.visible=!1,y.undoLevels>0&&y.saveState(ie)},this.clone=function(){return this.cloneChildren(this.cloneProps(new e.Pen(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B,Z,U,ee)))},y.dispose=function(ie,_e,$){return n(ie)&&(ie=!0),le.removeEventListener("keydown",y.zimkeydownEvent),le.removeEventListener("keyup",y.zimkeyupEvent),Q&&y.nibEvent&&Q.off("stagemousemove",y.nibEvent),Q&&y.stageDown&&Q.off("stagemousedown",y.stageDown),Q&&y.stageUp&&Q.off("stagemouseup",y.stageUp),Q&&y.upEvent&&Q.off("stagemouseup",y.upEvent),e.Ticker.remove(y.ticker),y.removeAllEventListeners(),b&&b.removeFrom(),ie&&(y.shape&&y.shape.dispose(),y.paper&&y.paper.dispose(),w&&(y.bitmap&&y.bitmap.dispose(),y.bitmap=null),y.zimContainer_dispose($),_=d=y.shape=null),!0},Z!==!1&&e.styleTransforms(this,he)},e.extend(e.Pen,e.Container,["dispose","clone"],"zimContainer",!1),e.SoundWave=function(t,r,i,o,l,f,h,p,_,b,w,C){var O="num, input, include, smoothing, min, max, operation, baseline, magnify, reduce, adjust, channel",P;if(P=mt(e.SoundWave,arguments,O,this))return P;qe("69.95"),this.type="SoundWave",n(t)&&(t=120),n(r)&&(r="mic"),n(i)&&(i=120/1024),n(o)&&(o=.85),n(l)&&(l=r=="mic"?-80:(r.oscillator,-100)),n(f)&&(f=r=="mic"?-40:(r.oscillator,-10)),n(h)&&(h=function(X,q){return X*(.5+q*1/Math.pow(e.SoundWave.bufferLength,.95))}),n(p)&&(p=r=="mic"?0:(r.oscillator,30)),n(_)&&(_=r=="mic"?1:r.oscillator?5:10),n(b)&&(b=0),n(w)&&(w=5),e.SoundWave.bufferLength=1024;var A=t,R=this;R.baseline=p,R.magnify=_,R.reduce=b,R.input=r,R.adjust=w;var T;r.type=="Tone"||r.type=="SynthSound"?T=r.audioContext:T=new(le.AudioContext||le.webkitAudioContext);var L=R.analyser=T.createAnalyser();L.minDecibels=l,L.maxDecibels=f,L.smoothingTimeConstant=o,Object.defineProperty(this,"smoothing",{get:function(){return L.smoothingTimeConstant},set:function(X){L.smoothingTimeConstant=X}}),Object.defineProperty(this,"num",{get:function(){return A},set:function(X){A=X,S=Math.floor(i*e.SoundWave.bufferLength/A),S<1&&ht("ZIM SoundWave: num is too big")}}),this.setInput=function(X){if(R.input=X,X=="mic"){navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia({audio:!0}).then(function(I){var te=R.source=T.createMediaStreamSource(I);k(te)}).catch(function(I){ht("ZIM SoundWave: Error occured: "+I)}):navigator.getUserMedia?navigator.getUserMedia({audio:!0},function(I){var te=R.source=T.createMediaStreamSource(I);k(te)},function(I){ht("ZIM SoundWave: Error occured: "+I)}):ht("ZIM SoundWave: Sorry, mic not supported");return}else if(X.type=="Tone")k(X.compressor);else if(X.type=="SynthSound")k(X.gain);else{if(X.type&&X.type=="sound"){ht("ZIM SoundWave: pass in the result of a zim.asset('somesound').play() for the input");return}var q,V;X.playbackResource?(q=X.playbackResource,V=T.createMediaElementSource(q)):(q=X,V=T.createMediaElementSource(q)),k(V)}},this.setInput(r);var S,E;function k(X){if(E&&E.disconnect(L),E=X,n(C)||C!==0&&C!==1)X.connect(L),r!="mic"&&L.connect(T.destination);else{var q=new ChannelSplitterNode(T,{numberOfOutputs:2});X.connect(q),q.connect(L,C);var V=new ChannelMergerNode(T,{numberOfInputs:2});L.connect(V,0,C),r!="mic"&&V.connect(T.destination)}if(L.fftSize=e.SoundWave.bufferLength*2,S=Math.floor(i*e.SoundWave.bufferLength/A),S<1){ht("ZIM SoundWave: include param is too small or num param is too big");return}var I=L.frequencyBinCount,te=new Uint8Array(I),B=300,Z=0,U=0,ee=Math.round(60*R.adjust*.8),ae=new e.Damp(B,.01);R.calculate=function(re){n(re)&&(re=!0),L.getByteFrequencyData(te);var he=te.map(h);if(S==1&&!re)return he;var j=[],G=0,y;for(y=0;y<=i*e.SoundWave.bufferLength;y++)G+=he[y],y!=0&&y%S==0&&(j.push(Math.max(0,(G/S-R.baseline)*R.magnify-R.reduce)),G=0);var g=j.length;if(r!="mic"&&(j[0]*=.75,j[1]*=.85,j[2]*=.9,j[g-2]*=.8,j[g-1]*=.75),j[g-1]*=1.3,j[g-2]*=1.2,j[g-3]*=1.1,re){var d=[];ee++,ee>=60*R.adjust&&(B=Z/ee,Z=0,U=0,ee=0);var D=ae.convert(B);for(y=0;y<g;y++)j[y]>U&&(U=j[y]),d[y]=Math.min(1,D!=0?j[y]/D:0);return Z+=U,d}return j},setTimeout(function(){R.dispatchEvent("ready")},50)}this.dispose=function(X){return X&&T&&T.close(),L&&L.disconnect(),!0}},e.extend(e.SoundWave,$e.EventDispatcher,null,"cjsEventDispatcher",!1),e.Synth=function(t,r){qe("69.955"),this.type="Synth",n(t)&&(t=.3),n(r)&&(r=220),this.volume=t,this.frequency=r;var i=this,o;this.play=function(l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B,Z,U,ee,ae,re,he,j,G,y,g,d,D,K,m,F,Ce,Y,Q,ce,pe,J,ue,ye,Xe,se,Ae){var ie=Array.prototype.slice.call(arguments);if(ie=ie.shift(),!o&&(le.AudioContext||le.webkitAudioContext)&&(o=new(le.AudioContext||le.webkitAudioContext),o.z=o.createBufferSource,o.createBufferSource=function(xe){return xe==null&&(xe=o.z()),xe.start=xe.start||function(Be){o.noteOn(Be)},xe}),!!o){for(l=l!=null?dt(l):0,f=f!=null?dt(f):.3,h=h!=null?dt(h):.05,p=p!=null?dt(p):220,_=_!=null?dt(_):0,b=b!=null?dt(b):0,w=w!=null?dt(w):.1,C=C!=null?dt(C):0,O=O!=null?dt(O):1,P=P!=null?dt(P):0,A=A!=null?dt(A):0,R=R!=null?dt(R):0,T=T!=null?dt(T):0,L=L!=null?dt(L):0,S=S!=null?dt(S):0,E=E!=null?dt(E):0,k=k!=null?dt(k):0,X=X!=null?dt(X):0,I=I!=null?dt(I):0,q=q!=null?dt(q):1,V=V!=null?dt(V):0,re=re!=null?dt(re):44100,he==null&&(he=99+_*re),j==null&&(j=b*re),G==null&&(G=w*re),y==null&&(y=V*re),g==null&&(g=X*re),d==null&&(d=Math.PI*2),D==null&&(D=function(xe){return xe>0?1:-1}),K==null&&(K=he+y+j+G+g),m==null&&(m=P*=500*d/Math.pow(re,2)),F==null&&(F=p*=(1+h*2*Math.random()-h)*d/re),Ce==null&&(Ce=D(E)*d/4),Y==null&&(Y=0),Q==null&&(Q=0),ce==null&&(ce=0),pe==null&&(pe=0),J==null&&(J=0),ue==null&&(ue=0),ye==null&&(ye=1),Xe==null&&(Xe=[]),se==null&&(se=o.createBufferSource()),Ae==null&&(Ae=o.createBuffer(1,K,re)),se.connect(o.destination);ce<Math.floor(K);Xe[ce++]=ue)++J>k*100&&(J=0,ue=Y*p*Math.sin(Q*E*d/re-Ce),ue=C?C>1?C>2?C>3?Math.sin(Math.pow(ue%d,3)):Math.max(Math.min(Math.tan(ue),1),-1):1-(2*ue/d%2+2)%2:1-4*Math.abs(Math.round(ue/d)-ue/d):Math.sin(ue),ue=(L?1-I+I*Math.sin(d*ce/L):1)*D(ue)*Math.pow(Math.abs(ue),O)*f*i.volume*(ce<he?ce/he:ce<he+y?1-(ce-he)/y*(1-q):ce<he+y+j?q:ce<K-g?(K-ce-g)/G*q:0),ue=g?ue/2+(g>ce?0:(ce<K-g?1:(ce-K)/g)*Xe[ce-g|0]/2):ue),Y+=1-S+(Math.sin(ce)+1)*1e9%2*S,Q+=1-S+(Math.pow(Math.sin(ce),2)+1)*1e9%2*S,p+=P+=A*500*d/Math.pow(re,3),ye&&++ye>T*re&&(p+=R*d/re,F+=R*d/re,ye=0),L&&++pe>L*re&&(p=F,P=m,pe=1,ye=ye||1);Ae.getChannelData(0).set(Xe),se.buffer=Ae;var _e=new $e.EventDispatcher;_e.type="SynthSound",_e.audioContext=o,_e.gain=o.createGain(),se.connect(_e.gain),_e.gain.connect(o.destination),_e.pan=o.createStereoPanner(),_e.pan.pan.value=l,se.connect(_e.pan),_e.pan.connect(o.destination),se.start(),_e.duration=Xe.length/re,_e.playing=!0,_e.stop=function(){clearTimeout(_e.completeID),clearInterval(_e.repeatID),_e.gain.gain.setTargetAtTime(0,o.currentTime,.1),_e.playing=!1,setTimeout(function(){o.close()},.1*1e3)};var $;return _e.repeat=_e.loop=function(xe,Be){$=0,xe===!0&&(xe=null),n(Be)&&(Be=0),clearTimeout(_e.completeID);function me(){return _e.duration+dt(Be)}return _e.repeatID=e.interval(me,function(){$++,xe&&$>=xe?(_e.dispatchEvent("complete"),_e.repeatID.clear(),_e.playing=!1):(_e.dispatchEvent("loop"),i.play.apply(i,ie))}),_e},_e.play=function(){return i.play.apply(i,ie),_e.playing=!0,_e},_e.completeID=setTimeout(function(){_e.dispatchEvent("complete")},(Xe.length/re+.1)*1e3),_e}},this.Tone=function(l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V){var I="volume, note, shape, pan, duration, attack, release, wahAmount, wahRate, wahShape, wahThroat, wahNote, vibratoAmount, vibratoRate, vibratoShape, tremeloAmount, tremeloRate, tremeloShape, startTime, pauseOnBlur",te;if(te=mt(i.Tone,arguments,I,this))return te;this.type="Tone";var B=this,Z;n(l)&&(l=i.volume),n(f)&&(f=i.frequency),n(h)&&(h=e.SINE),n(p)&&(p=0),n(b)&&(b=.02),n(w)&&(w=.05),n(q)&&(q=0),le.AudioContext||le.webkitAudioContext?Z=this.audioContext=new(le.AudioContext||le.webkitAudioContext):Ct&&ht("Synth tone() needs AudioContext"),l=dt(l),f=dt(f),h=dt(h),p=dt(p),_=dt(_),b=dt(b),w=dt(w),C=dt(C),O=dt(O),P=dt(P),A=dt(A),R=dt(R),T=dt(T),L=dt(L),S=dt(S),E=dt(E),k=dt(k),X=dt(X),q=dt(q);var U=v(_);i.duration=_,_&&(_=_*(U=="s"?1:1/1e3)),q&&(v(q),q=q*(U=="s"?1:1/1e3)),i.attack=b,i.release=w,i.rampDuration=.02,i.hush=.1;var ee=this.note=this.oscillator=Z.createOscillator();ee.frequency.value=e.Synth.note(f),e.Synth.setShape(ee,h);var ae=this.filter=Z.createBiquadFilter();ae.type="bandpass",ae.frequency.value=ee.frequency.value,ae.Q.value=0;var re=this.gain=ee.gain=Z.createGain();re.type="gain",re.gain.setValueAtTime(0,Z.currentTime);var he=this.compressor=Z.createDynamicsCompressor();he.threshold.setValueAtTime(-50,Z.currentTime),he.knee.setValueAtTime(40,Z.currentTime),he.ratio.setValueAtTime(12,Z.currentTime),he.attack.setValueAtTime(0,Z.currentTime),he.release.setValueAtTime(.25,Z.currentTime);var j=this.panNode=Z.createStereoPanner();this.panNode.pan.value=p,ee.connect(ae),ae.connect(j),j.connect(re),re.connect(he),he.connect(Z.destination);function G(J,ue){n(J)&&(J=Z.currentTime),n(ue)&&(ue=i.attack),ee.start(J);var ye=le.zdf&&new Date().getTime()-le.zdf.startTime<200?.1:i.attack;re.gain.setValueAtTime(0,Z.currentTime+.1),re.gain.linearRampToValueAtTime(l*i.hush,Z.currentTime+.1+ye)}G(q),this.stop=function(J){n(J)&&(J=i.release),re&&g(re.gain,0,!0,J),Q&&g(Q.gain,0,!0,J),F&&g(F.gain,0,!0,J),setTimeout(function(){B.dispatchEvent("complete")},(.6+J+i.rampDuration)*1e3),setTimeout(function(){Z&&!Z.iamClosed&&(Z.iamClosed=!0,Z.close())},(J+1)*1e3),setTimeout(function(){d&&B.removeWah()},(J+1)*1e3)},_&&this.stop(q+_-.1);var y=this.notes=[ee];this.addNote=function(J,ue,ye,Xe,se,Ae){n(Xe)&&(Xe=!0),n(se)&&(se=!1),n(J)&&(J=.1),n(Ae)&&(Ae=0);var ie={type:"Note"};ie._volume=J,ie._note=e.Synth.note(ue),y.push(ie);var _e=ie.oscillator=Z.createOscillator();_e.frequency.value=ie._note,_e.type=e.Synth.setShape(_e,ye);var $=ie.gain=Z.createGain();return g($.gain,ie._volume,!0),$.connect(Xe?ae:re),_e.connect($),F&&se&&F.connect(_e.frequency),_e.start(Z.currentTime+Ae),Object.defineProperty(ie,"volume",{get:function(){return ie._volume},set:function(xe){n(xe)||(ie._volume=dt(xe),g(ie.gain.gain,ie._volume,!0))}}),Object.defineProperty(ie,"note",{get:function(){return ie._note},set:function(xe){n(xe)||(ie._note=dt(xe),g(ie.oscillator.frequency,e.Synth.note(ie._note)))}}),ie},this.removeNote=function(J){var ue=y.indexOf(J);return ue>=0&&y.splice(ue,1),J.oscillator.disconnect(),J=null,this};function g(J,ue,ye,Xe){n(ue)&&(ue=0),n(Xe)&&(Xe=i.rampDuration),ye?(J.cancelScheduledValues(Z.currentTime),J.linearRampToValueAtTime(J.value,Z.currentTime+.02),J.linearRampToValueAtTime(ue,Z.currentTime+.05+Xe)):(J.cancelScheduledValues(Z.currentTime),J.setTargetAtTime(ue,Z.currentTime,Xe))}this.ramp=function(J,ue){g(re.gain,J*i.hush,!0,ue)},this.rampPan=function(J,ue){g(j.pan,J,!1,ue)},this.animate=function(){return arguments[0].props?arguments[0].target=this:Array.prototype.unshift.call(arguments,this),e.animate.apply(null,arguments),this},this.wiggle=function(){return arguments[0].props?arguments[0].target=this:Array.prototype.unshift.call(arguments,this),e.wiggle.apply(null,arguments),this},e.addWires(this);var d,D;function K(){n(C)&&(C=1e3),n(O)&&(O=1),n(P)&&(P="sine"),n(A)&&(A=5),n(R)?R=B.oscillator.frequency.value:R=e.Synth.note(R),n(D)&&(D=200),B.filter.Q.value=A,d=B.wah=i.oscillator(O,C/2,P,R+C/2+D),d.ticker=e.Ticker.add(function(){B.filter.frequency.value=B.wah.amplitude})}(C||O||!n(P)||!n(A))&&K(),B.removeWah=function(){e.Ticker.remove(d.ticker),d.dispose(),d=B.wah=null,B.filter.Q.value=0};var m,F;function Ce(){n(L)&&(L=5),n(S)&&(S="sine"),n(T)&&(T=10),m=B.vibrato=Z.createOscillator(),F=B.vibratoGain=Z.createGain(),F.gain.value=0,m.frequency.value=L,e.Synth.setShape(m,S),m.connect(F),F.connect(ee.frequency),m.start(0),F.gain.setValueAtTime(0,Z.currentTime+.1),F.gain.linearRampToValueAtTime(T,Z.currentTime+.1+i.attack)}(T||L||!n(S))&&Ce(),B.removeVibrato=function(){g(F.gain,0,!0),setTimeout(function(){F.disconnect(),m.disconnect(),m.stop(),m=null},(i.rampDuration+1)*1e3)};var Y,Q;function ce(){n(k)&&(k=5),n(X)&&(X="sine"),Y=B.tremelo=Z.createOscillator(),Q=B.tremeloGain=Z.createGain(),Q.gain.value=0,Y.frequency.value=k,e.Synth.setShape(Y,X),Y.connect(Q),Q.connect(re.gain),Y.start(0);var J=le.zdf&&new Date().getTime()-le.zdf.startTime<200?.1:i.attack;Q.gain.setValueAtTime(0,Z.currentTime+.1),Q.gain.linearRampToValueAtTime(l*i.hush,Z.currentTime+.1+J)}(E||k||!n(X))&&ce(),B.removeTremelo=function(){g(Q.gain,0,!0),setTimeout(function(){Q.disconnect(),Y.disconnect(),Y.stop(),Y=null},(i.rampDuration+1)*1e3)},Object.defineProperty(this,"volume",{get:function(){return l},set:function(J){if(!n(J)){var ue;Y?(re.gain.value?ue=Q.gain.value/re.gain.value:ue=l?E/l:0,l=dt(J),l=e.constrain(l,.001),g(Q.gain,l*ue*i.hush,!0)):l=dt(J),g(re.gain,l*i.hush,!1,i.rampDuration)}}}),this.paused=!1;var pe=l;this.pause=function(J){n(J)&&(J=!0),J?(pe=B.volume,B.volume=0):B.volume=pe},V&&(n(e.blurCheck)&&e.setBlurDetect(),e.pauseOnBlur.push(this)),Object.defineProperty(this,"frequency",{get:function(){return r},set:function(J){n(J)||(r=dt(J),g(ee.frequency,J))}}),Object.defineProperty(this,"note",{get:function(){return f},set:function(J){n(J)||(f=dt(J),ee.frequency.value=e.Synth.note(f))}}),Object.defineProperty(this,"shape",{get:function(){return h},set:function(J){h=dt(J),e.Synth.setShape(ee,h)}}),Object.defineProperty(this,"pan",{get:function(){return p},set:function(J){n(J)||(p=dt(J),g(j.pan,p,!1,.1))}}),Object.defineProperty(this,"currentTime",{get:function(){return Z.currentTime},set:function(){Ct&&ht("Synth tone() - currentTime is read only")}}),this.wahAmountMin=0,this.wahAmountMax=5e3,Object.defineProperty(this,"wahAmount",{get:function(){return C},set:function(J){n(J)||(C=dt(J),C=e.constrain(C,i.wahAmountMin,i.wahAmountMax),n(d)?K():d.gain=C/2)}}),this.wahRateMin=0,this.wahRateMax=30,Object.defineProperty(this,"wahRate",{get:function(){return O},set:function(J){n(J)||(O=dt(J),O=e.constrain(O,i.wahRateMin,i.wahRateMax),n(d)?K():d.frequency=O)}}),this.wahThroatMin=0,this.wahThroatMax=100,Object.defineProperty(this,"wahThroat",{get:function(){return A},set:function(J){A=dt(J),A=e.constrain(A,i.wahThroatMin,i.wahThroatMax),n(d)?K():ae.Q.value=A}}),Object.defineProperty(this,"wahNote",{get:function(){return R},set:function(J){n(J)||(R=dt(J),n(d)?K():d.offset=R+C/2+D)}}),Object.defineProperty(this,"wahAdjust",{get:function(){return D},set:function(J){n(J)||(D=dt(J),n(d)?K():d.offset=R+C/2+D)}}),Object.defineProperty(this,"wahShape",{get:function(){return P},set:function(J){P=dt(J),n(d)?K():d.shape=P}}),Object.defineProperty(this,"tremeloAmount",{get:function(){return E},set:function(J){n(J)||(E=dt(J),n(Y)?ce():Q.gain.setValueAtTime(E,Z.currentTime))}}),Object.defineProperty(this,"tremeloRate",{get:function(){return k},set:function(J){n(J)||(k=dt(J),n(d)?ce():Y.frequency.value=k)}}),Object.defineProperty(this,"tremeloShape",{get:function(){return X},set:function(J){X=dt(J),n(Y)?ce():e.Synth.setShape(Y,X)}}),Object.defineProperty(this,"vibratoAmount",{get:function(){return T},set:function(J){n(J)||(T=dt(J),n(m)?Ce():F.gain.setValueAtTime(T,Z.currentTime))}}),Object.defineProperty(this,"vibratoRate",{get:function(){return L},set:function(J){n(J)||(L=dt(J),n(m)?Ce():m.frequency.value=L)}}),Object.defineProperty(this,"vibratoShape",{get:function(){return S},set:function(J){S=dt(J),n(m)?Ce():e.Synth.setShape(m,S)}})},e.extend(this.Tone,$e.EventDispatcher),this.tone=function(l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q){return Array.prototype.unshift.call(arguments,null),new(Function.prototype.bind.apply(i.Tone,arguments))},this.Oscillator=function(l,f,h,p){var _="frequency, gain, shape, offset",b;if(b=mt(i.Oscillator,arguments,_,this))return b;this.type="Oscillator",n(l)&&(l=1),n(f)&&(f=10),n(h)&&(h="sine"),n(p)&&(p=0),this.frequency=dt(l),this.gain=dt(f),this.shape=dt(h),this.shape=="saw"&&(this.shape="sawtooth"),this.offset=dt(p),this.paused=!1;var w=this,C=0,O=e.Ticker.framerate;this.ticker=e.Ticker.add(function(){if(!w.paused){var P=0;w.shape=="sine"?P=Math.sin(w.frequency*(Math.PI*2*(C/O))):w.shape=="square"?(P=Math.sin(w.frequency*(Math.PI*2*(C/O))),P=P<=0?0:1):w.shape=="triangle"?P=2/Math.PI*Math.asin(Math.sin(w.frequency*Math.PI*2*C/O)):w.shape=="sawtooth"||w.shape=="saw"?P=-2/Math.PI*Math.atan(1/Math.tan(w.frequency*Math.PI*C/O)):w.shape=="zap"&&(P=2/Math.PI*Math.atan(1/Math.tan(w.frequency*Math.PI*C/O))),w.amplitude=P*w.gain+w.offset,C++}}),this.pause=function(P){w.paused=P},this.dispose=function(){e.Ticker.remove(this.ticker)}},this.oscillator=function(l,f,h,p){return Array.prototype.unshift.call(arguments,null),new(Function.prototype.bind.apply(i.Oscillator,arguments))}},e.Synth.notes=["C",null,"D",null,"E","F",null,"G",null,"A",null,"B"],e.Synth.major=["C","D","E","F","G","A","B","C4"],e.Synth.minor=["C","D","Eb","F","G","Ab","B","C4"],e.Synth.shapes=["sine","triangle","sawtooth","tan","noise","square"],e.Synth.setShape=function(t,r){if(!n(t)){n(r)&&(r="sine"),r=="saw"&&(r="sawtooth");var i;if(typeof r=="number")r=e.Synth.shapes[r],r||(r="sine");else if(r.real&&r.imag)i=t.context.createPeriodicWave(new Float32Array(r.real),new Float32Array(r.imag));else if(r.constructor==PeriodicWave)i=r;else if(typeof r=="string"){var o=e.Synth.shapes.indexOf(r);if(o<0&&(r="sine"),r=="noise"){for(var l=4096,f=new Float32Array(l),h=new Float32Array(l),p=1;p<l;p+=2)h[p]=e.shuffle([0,.5,1])[0];i=t.context.createPeriodicWave(f,h)}else r=="tan"&&(r="sawtooth")}else r="sine";i?(t.setPeriodicWave(i),r="custom"):t.type=r}},e.Synth.getNote=function(t,r){return n(r)&&(r=0),t*Math.pow(2,r/12)},e.Synth.note=function(t){if(typeof t=="string"){var r=t.substr(0,1).toUpperCase(),i=e.loop(t,function(p){if(!isNaN(p))return Number(p)});i=i!==!0&&!isNaN(i)?i:3;var o=e.Synth.notes.indexOf(r);o<0&&(o=9);var l=t.match(/b/g),f=t.match(/#/g);l=l?l.length:0,f=f?f.length:0;var h=(i-3)*12+o+f-l;return e.Synth.getNote(e.Synth.getNote(220,-9),h)}else return typeof t!="number"&&(t=220),t},e.Synth.wave=function(t,r){if(le.AudioContext||le.webkitAudioContext){var i=new(le.AudioContext||le.webkitAudioContext);if(t.real)r=t.imag,t=t.real;else if(n(r)&&Ct){ht("Synth.wave() - pass in asset('wave.json') or real and imag properties");return}return t.constructor!==Float32Array&&(t=new Float32Array(t)),r.constructor!==Float32Array&&(r=new Float32Array(r)),i.createPeriodicWave(t,r)}},e.Synth.drawWave=function(t,r,i,o,l,f,h,p,_){var b="shape, color, thickness, backgroundColor, borderColor, borderWidth, corner, padding, paddingV",w;if(w=mt(e.Synth.drawWave,arguments,b))return w;var C=45,O=45;t=dt(t),n(i)&&(i=2),n(r)&&(r=e.darker),n(p)&&(p=8),n(_)&&(_=p);var P=p,A=_,R=new e.Container(C,O);R.mouseChildren=!1,n(o)||(R.backing=new e.Rectangle(C,O,o,l,f,h).addTo(R)),R.shape=new e.Shape(C,O).addTo(R).s(r).ss(i);var T=C-P*2;return t=="square"?R.shape.mt(P,O/2).lt(P,A+3).lt(C/2,A+3).lt(C/2,O-A-3).lt(C-P,O-A-3).lt(C-P,O/2):t=="triangle"?R.shape.mt(P,O/2).lt(P+T/4,A+3).lt(P+T*3/4,O-A-3).lt(C-P,O/2):t=="sawtooth"||t=="saw"?R.shape.mt(P,O/2).lt(C/2,A+2).lt(C/2,O-A-2).lt(C-P,O/2):t=="zap"?R.shape.mt(P,O/2).lt(C/2,O-A-2).lt(C/2,A+2).lt(C-P,O/2):R.shape.mt(P,O/2).bt(C/2,0-15,C/2,O+15,C-P,O/2),R.type=t,R},e.VR=function(t,r,i,o,l,f,h,p,_,b,w,C){var O="content, angle, distance, parallax, parallaxAngle, damp, parallaxDamp, startAngle, negativeParallax, boundaryMarkers, swiper, holder",P;if(P=mt(e.VR,arguments,O,this))return P;if(qe("69.98"),this.type="VR",!le.zdf){Ct&&ht("VR() - please use ZIM Frame");return}var A=le.zdf;(n(C)||!C.getBounds||!C.getBounds().width)&&(C=A.stage),n(r)&&(r=0),n(i)&&(i=100),n(f)&&(f=.5),n(o)&&(o=0),n(l)&&(l=60),n(h)&&(h=.1),n(p)&&(p=0),n(_)&&(_=!1),n(b)&&(b=!0),n(w)&&(w=!0),this.angle=r,this.currentAngle=p,e.mobile()&&(w=!1);var R=this,T=C.width,L=C.height;R.zimContainer_constructor();var S=R.left=new e.Container(T/2,L,null,null,!1),E=new e.Rectangle(T/2,L,"rgba(0,0,0,.01)",null,null,null,null,null,null,!1);S.addChild(E);var k=R.right=S.clone();R.addChild(S,k),k.x=T/2;var X=R.contentLeft=R.content=t,q=R.contentRight=t.clone();if(p!=0)var V=setTimeout(I,100);else I();function I(){X.addTo(S,null,!1).setMask(S.getChildAt(0)).pos({y:(C.height-X.height)/2,reg:!0}),q.addTo(k,null,!1).setMask(k.getChildAt(0)).pos({y:(C.height-X.height)/2,reg:!0})}var te=[],B=[];function Z(ie,_e,$,xe){ie.vrMatch=_e,_e.vrMatch=ie,ie.cacheCanvas&&_e.cache(),ie.dep&&!n(ie.depth)&&(te.push(ie),B.push(_e),n($)||$.push(ie),n(xe)||xe.push(_e),_e.dep(ie.depth)),e.loop(ie,function(Be,me){Z(Be,_e.getChildAt(me),$,xe)})}Z(X,q);function U(ie,_e){e.loop(ie,function($){$.vrChannel=_e,$.vrStartX=$.x,r!=0&&i!=0&&($.vrAngle=r,$.vrDistance=i),o!=0&&i!=0&&($.vrParallax=o/100,$.vrParallaxDistance=0,r!=0&&($.vrParallaxDamp=new e.Damp(0,h))),$.dep($.depth)})}if(U(te,"left"),U(B,"right"),r!=0&&i!=0){var ee=new e.Damp(180+p,f);ee.immediate(180+p);var ae=!1,re=!1;A.on("deviceorientation",function(ie){he(ee.convert((ie.rotation.z>180?-180:180)+ie.rotation.z+p)-180)}),e.Ticker.always()}function he(ie){R.currentAngle=ie;var _e=-R.currentAngle*i/r;R.contentLeft.x=_e,R.contentRight.x=_e;var $;Math.round(R.currentAngle)<=-r/2&&!ae?($=new $e.Event("boundaryout"),$.boundary="left",ae=!0,R.dispatchEvent($)):Math.round(R.currentAngle)>=r/2&&!re?($=new $e.Event("boundaryout"),$.boundary="right",re=!0,R.dispatchEvent($)):Math.round(R.currentAngle)>-r/2&&Math.round(R.currentAngle)<r/2&&($=new $e.Event("boundaryin"),ae?($.boundary="left",R.dispatchEvent($),ae=!1):re&&($.boundary="right",R.dispatchEvent($),re=!1))}function j(ie){var _e=ie.parent.localToLocal(ie.vrStartX,0,C),$=ie.vrParallaxDamp.convert(ie.vrChannel=="left"?R.contentLeft.x+_e.x-T/4:R.contentRight.x+_e.x-T/2-T/4);ie.depth<=0&&!_&&($=0),ie.vrParallaxDistance=Math.max(-i/r*l/2,Math.min(i/r*l/2,$)),ie.dep(ie.depth)}if(o!=0&&i!=0){var G=new e.ProportionDamp(180-l/2,180+l/2,-l/2,l/2,h);G.immediate(180),A.on("deviceorientation",function(ie){var _e=0;r==0&&o!=0&&i!=0&&(_e=G.convert((ie.rotation.z>180?-180:180)+ie.rotation.z)),g(_e)}),e.Ticker.always()}function y(ie,_e){ie.vrParallaxDistance=ie.depth<=0&&!_?0:_e,ie.dep(ie.depth)}function g(ie){r!=0&&i!=0?(e.loop(te,j),e.loop(B,j)):(e.loop(te,function(_e){y(_e,ie)}),e.loop(B,function(_e){y(_e,ie)}))}w&&i!=0&&(r!=0||o!=0)&&R.added(function(){var ie={swipeAngle:0};R.swiper=new e.Swiper({swipeOn:R,target:ie,property:"swipeAngle",sensitivity:.2,damp:.05,factor:-1,min:-330,max:330}),e.Ticker.add(function(){r!=0&&i!=0&&he(ie.swipeAngle),o!=0&&i!=0&&g(G.convert(ie.swipeAngle+180))})});var d=localStorage&&localStorage.zimEyeAdjust?Number(localStorage.zimEyeAdjust):0,D=d,K=!1;X.startRegX=X.regX,q.startRegX=q.regX;var m=this.adjuster=new e.Container(800,300,null,null,!1);E=m.backing=new e.Rectangle(m.width,m.height,e.lighter,null,null,null,null,null,null,!1).center(m).alp(1).sha("rgba(0,0,0,.2)",0,0,30),m.strip=new e.Rectangle(m.width,m.height/3,e.white,null,null,null,null,null,null,!1).center(m).alp(1),m.label=new e.Label({text:"slide to adjust center of left and right",size:28,color:e.dark,align:"center",valign:"center"}).center(m).pos({y:50,reg:!0});var F=m.close=new e.Rectangle(50,50,e.light,null,null,null,null,null,null,!1).addTo(m).mov(m.width-70,26),Ce=new e.Shape(-40,-40,80,80,null,!1);Ce.graphics.f(e.dark).p("AmJEVIEUkTIkXkWIB4h5IEWEYIETkTIB4B3IkTESIEQERIh4B4IkRkRIkSEVg"),Ce.center(F).sca(.3),F.cur("pointer"),F.on((Dt?e.ACTIONEVENT=="mousedown":le.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){R.hideAdjuster(),ce.currentValue=(ce.max-ce.min)/2+D,R.dispatchEvent("closed")});var Y=new e.Circle(30,e.dark,null,null,null,null,null,null,!1).center(m).pos({x:m.width/4,reg:!0});Y.shape.alpha=.2,new e.Circle(12,e.dark,null,null,null,null,null,!1).center(Y);var Q=new e.Circle(30,e.dark,null,null,null,null,null,!1).center(m).pos({x:m.width/4*3,reg:!0});Q.shape.alpha=.2,new e.Circle(12,e.dark,null,null,null,null,null,null,!1).center(Q);var ce=m.slider=new e.Slider({min:0,max:30,step:1,useTicks:!0,style:!1}).centerReg(m).pos({y:m.height-40,reg:!0});ce.currentValue=(ce.max-ce.min)/2+d;var pe=new e.Proportion(ce.min,ce.max,Y.x-m.width/4,Y.x+m.width/4,-1),J=new e.Proportion(ce.min,ce.max,Q.x-m.width/4,Q.x+m.width/4);ce.on("change",function(){Y.x=pe.convert(ce.currentValue),Q.x=J.convert(ce.currentValue)}),new e.Label("closer",24,null,e.silver).centerReg(m).pos({x:ce.x-220,y:ce.y,reg:!0}),new e.Label("farther",24,null,e.silver).centerReg(m).pos({x:ce.x+220,y:ce.y,reg:!0});var ue=R.ok=new e.Button({label:"OK",width:90,height:60,corner:0,backgroundColor:e.blue,rollBackgroundColor:e.green,shadowColor:-1,style:!1}).centerReg(m).sca(.8).pos({x:m.width-58,y:ce.y,reg:!0});ue.on((Dt?e.ACTIONEVENT=="mousedown":le.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){localStorage&&(localStorage.zimEyeAdjust=ce.currentValue-(ce.max-ce.min)/2),se(),R.hideAdjuster(),R.dispatchEvent("saved"),R.dispatchEvent("closed")});var ye=R.zero=new e.Button({label:">|<",width:90,height:60,corner:0,backgroundColor:e.yellow,rollBackgroundColor:e.green,shadowColor:-1,style:!1}).centerReg(m).sca(.8).pos({x:58,y:ce.y,reg:!0});ye.on((Dt?e.ACTIONEVENT=="mousedown":le.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){ce.currentValue=(ce.max-ce.min)/2,Y.x=pe.convert(ce.currentValue),Q.x=J.convert(ce.currentValue)});var Xe=new e.Proportion(0,30,-C.width/4,C.width/4);function se(){var ie=Xe.convert(ce.currentValue);X.regX=X.startRegX+ie,q.regX=q.startRegX-ie}se(),this.showAdjuster=function(){if(K)return R;K=!0,Y.x=pe.convert(ce.currentValue),Q.x=J.convert(ce.currentValue),D=ce.currentValue-(ce.max-ce.min)/2,m.scaleTo(C,100,100).center(this),C.stage.update()},this.hideAdjuster=function(){if(!K)return R;K=!1,m.removeFrom(this),C.stage.update()},this.position=function(ie,_e,$){xe(ie),xe(ie.vrMatch);function xe(Be){Be.vrStartX=_e,Be.vrParallaxDamp&&Be.vrParallaxDamp.immediate(_e),Be.mov(_e,$)}return ie},this.register=function(ie){if(!ie.parent||!ie.parent.vrMatch)return Ct&&ht("ZIM VR() - please only register objects already inside content container"),ie;var _e=ie.clone().addTo(ie.parent.vrMatch),$=[],xe=[];return Z(ie,_e,$,xe),U($,"left"),U(xe,"right"),ie},r!=0&&i!=0&&b&&(R.boundaryRight=new e.Container({style:!1}),new e.Circle(24,e.light,null,null,null,null,null,null,!1).addTo(R.boundaryRight).dep(-2),new e.Triangle(16,16,16,e.yellow,e.grey,null,null,null,-3,null,null,!1).rot(-90).center(R.boundaryRight).dep(-6),R.boundaryRight.center(t).mov(i/2+24),R.boundaryLeft=new e.Container({style:!1}),new e.Circle(24,e.light,null,null,null,null,null,null,!1).addTo(R.boundaryLeft).dep(-2),new e.Triangle(16,16,16,e.yellow,e.grey,null,null,null,-3,null,null,!1).rot(90).center(R.boundaryLeft).dep(-6),R.boundaryLeft.center(t).mov(-i/2-24),R.register(R.boundaryRight),R.register(R.boundaryLeft));function Ae(ie){var _e=te.indexOf(ie);te.indexOf(ie)>=0&&(te.splice(_e,1),B.splice(_e,1)),e.loop(ie,function($){Ae($)})}this.remove=function(){return e.loop(arguments,function(ie,_e){t.contains(_e)&&(Ae(_e),_e.parent.removeChild(_e),_e.vrMatch.parent.removeChild(_e.vrMatch))}),R},this.resize=function(){T=C.width,L=C.height,S.getChildAt(0).widthOnly=k.getChildAt(0).widthOnly=T/2,S.getChildAt(0).heightOnly=k.getChildAt(0).heightOnly=L,k.x=T/2,S.setBounds(0,0,T/2,L),k.setBounds(0,0,T/2,L),p!=0?(clearTimeout(V),V=setTimeout(I,100)):I(),m.scaleTo(C,100,100).center(this,null,!1)}},e.extend(e.VR,e.Container,"clone","zimContainer",!1),e.scaX=1,e.scaY=1,e.Frame=function(t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B,Z,U,ee,ae,re,he){var j="scaling, width, height, color, outerColor, ready, assets, path, progress, ticker, rollover, touch, scrollTop, align, valign, canvasID, rollPerSecond, delay, canvasCheck, gpu, gpuObj, nextFrame, nextStage, allowDefault, loadFailObj, sensors, retina, mouseMoveOutside, captureMouse, shim, maxConnections, maxNum, singleTouch",G;if(G=mt(e.Frame,arguments,j,this))return G;qe("83"),Ct&&oi("ZIM FRAME"),this.cjsEventDispatcher_constructor(),this.type="Frame";var y=this;(!le.zdf||!le.zdf.type)&&(le.zimDefaultFrame=le.zdf=le.F=this),le.M=e.mobile();var g=Date;this.startTime=new g().getTime(),n(S)&&(S=!0);var d=!!le.HTMLCanvasElement;if(!d&&S){setTimeout(function(){y.dispatchEvent("failed")},100);return}var D=e.mobile();n(t)&&(t="full"),t=="outside"&&(t="fill"),n(p)||(le.PATH=p),n(w)&&(w=!D),n(C)&&(C=!0),n(O)&&(O=!1),n(P)&&(P="center"),n(A)&&(A="center");var K="";n(R)&&(le.zdf!=this?(K=e.makeID(null,5),R="myCanvas"+K):R="myCanvas");var m=v(L);n(T)&&(T=20),n(L)&&(L=D?m=="s"?1:1e3:m=="s"?.03:30),n(E)&&(E=!1),n(V)&&(V=!1),n(I)&&(I="circles"),this.loadFailObj=I,n(te)&&(te=!1),n(B)&&(B=!0),this.retina=B,n(Z)&&(Z=!1),n(U)&&(U=!0),n(ee)&&(ee=!1),n(ae)&&(ae=10),n(he)&&(he=!1),he&&(C=!0);var F=ae;y.maxNum=re,E&&(B=!1),this.retina=B;var Ce=!1,Y=!1;this.leftMouseDown=!1;function Q(De){y.leftMouseDown=De.buttons===void 0?De.which===1:De.buttons===1,Ce&&!y.leftMouseDown&&y.dispatchEvent("mouseupplus"),Y&&!y.leftMouseDown&&y.dispatchEvent("mouseupplusonly"),Ce=Y=y.leftMouseDown}var ce=["fit","fill","full"],pe,J,ue;if(ee){this.shim=!0,ee.stage.frame=this;var ye=this.canvas=ee.canvas;this.scale=ee.stage.scaleX;var Xe,se;setTimeout(function(){Ae(),se=function(){Ae(),Xe&&clearTimeout(Xe),Xe=setTimeout(Ae,50)},le.addEventListener("resize",se)},20),pe=ee.stage,J=pe.getBounds()?pe.getBounds().width:ye.width/pe.scaleX,ue=pe.getBounds()?pe.getBounds().height:ye.height/pe.scaleY,pe.getBounds()||pe.setBounds(0,0,J,ue),o=ye.style.backgroundColor,Ke(),Ae()}else this.scale=1,this.x=0,this.y=0;function Ae(){y.scale=ee.stage.scaleX;var De=ye.getBoundingClientRect();y.x=De.x+e.scrollX(),y.y=De.y+e.scrollY(),e.scaX=$e.stageTransformable?1:ee.stage.scaleX,e.scaY=$e.stageTransformable?1:ee.stage.scaleY}var ie,_e,$=!1,xe,Be,me=!1,Oe=!1,Ye=!1;ee||(document.readyState==="interactive"||document.readyState==="complete"?setTimeout(function(){fe()},200):document.addEventListener("DOMContentLoaded",fe));var de,ve=!1,Me=t=="full"&&typeof InstallTrigger<"u";if(this.swapRotation=!1,D&&!le.parent){var we=isNaN(le.innerWidth)?le.clientWidth:le.innerWidth,Fe=isNaN(le.innerHeight)?le.clientHeight:le.innerHeight;this.swapRotation=(le.orientation==0||le.orientation==180)&&we>Fe||Math.abs(le.orientation)==90&&Fe>we}le.addEventListener("resize",Ve);var ge;function Ve(){if(ee){if(pe.canvas){var De=J=pe.canvas.width,lt=ue=pe.canvas.height;pe.setBounds(0,0,De,lt)}y.dispatchEvent("resize");return}ge=Date.now()+L*(m=="s"?1e3:1),Me?ve||(ve=!0,de=e.Ticker.update,e.tickerFrame||(e.Ticker.update=!1,e.tickerFrame=y),yt(),ct(),clearInterval(y.frameTime),y.frameTime=setInterval(function(){if(Date.now()>ge){clearInterval(y.frameTime),ve=!1,y==e.tickerFrame&&(e.Ticker.update=de);return}yt(),ct()},50)):(yt(),ct(),clearInterval(y.frameTime),y.frameTime=setInterval(function(){if(Date.now()>ge){clearInterval(y.frameTime);return}yt(),ct()},L*(m=="s"?1e3:1)<50?L*(m=="s"?1e3:1)+5:50))}y.loadAssetsCount=0,n(e.assets)&&(e.assets={},e.assetIDs={});var He=[];He[0]="h",He[1]="c",He[2]="o",He[3]="p",He[4]="e";var Le=!1;function fe(){if(Ye)return;if(Ye=!0,ce.indexOf(t)==-1){if(xe=t,n(_n(xe))){ht("Frame - scaling: HTML tag with id="+t+" must exist");return}Be=y.tag=_n(xe),y.scaling=t=n(r)||n(i)?"tag":"inline",R.indexOf("myCanvas")==0&&(R=xe+"Canvas"),Be.tagName.toLowerCase()=="canvas"&&(Le=!0,R=xe)}else y.scaling=t;y.canvasID=R,n(r)&&(r=500),n(i)&&(i=500),J=r,ue=i,n(l)||(y.outerColor=l),Qe(),st(),D?(O&&setTimeout(function(){le.scrollTo(0,0)},50),setTimeout(De,100),L*(m=="s"?1e3:1)!=100&&setTimeout(De,L*(m=="s"?1e3:1))):(me=!0,Ge());function De(){yt(),me=!0,Ge(),ct(),pe&&pe.update()}if(n(h))Oe=!0,Ge();else{var lt;h.constructor=={}.constructor&&!(h.audioSprite||h.id||h.data||h.src)?lt=y.loadAssets(e.merge(h,{progress:_,queueOnly:!0})):lt=y.loadAssets({assets:h,path:p,progress:_,queueOnly:!0}),n(lt)||!lt.on?(Ct&&ht("Frame() - load failed"),Oe=!0,Ge()):lt.on("complete",function(){Oe=!0,Ge()})}}function Ge(){if(me&&Oe&&!$)if(pe.width>=1&&pe.height>=1){if(!n(_)&&_.show&&_.hide(),y==le.zdf&&(le.S=pe,le.W=pe.width,le.H=pe.height),f&&typeof f=="function"&&f(y,pe,pe.width,pe.height),!y)return;if(b&&typeof b=="function"){var De=0;if(!y)return;y.updateID=e.Ticker.add(function(){b(++De,y,pe,pe.width,pe.height)}),y.pauseTicker=function(lt){n(lt)&&(lt=!0),lt?e.Ticker.remove(y.updateID):e.Ticker.add(y.updateID)}}y.dispatchEvent("ready"),$=!0,ct(),pe.update()}else setTimeout(function(){yt(),Ge()},50)}function Qe(){var De;Le?De=y.canvas=y.tag:(De=y.canvas=document.createElement("canvas"),De.setAttribute("id",R)),De.setAttribute("tabindex",0);var lt=e.windowWidth(),vt=e.windowHeight(),rt=le.devicePixelRatio||1;t=="full"||t=="tag"?B?(y.scale=rt,De.setAttribute("width",lt*y.scale),De.setAttribute("height",vt*y.scale),t=="full"&&(De.style.width=lt+"px",De.style.height=vt+"px")):(De.setAttribute("width",lt),De.setAttribute("height",vt)):(De.setAttribute("width",J),De.setAttribute("height",ue));var xt=_n(R+"Alternative");xt&&De.appendChild(xt),Le||(t=="tag"||t=="inline"?Be.appendChild(De):document.body.appendChild(De)),n(o)||(De.style.backgroundColor=o),t=="full"||t=="fit"||t=="fill"?(De.style.position="absolute",V||(document.body.style.overflow="hidden")):getComputedStyle(De.parentElement).position=="static"&&(De.parentElement.style.position="relative"),De.addEventListener("pointerdown",function(wt){De.setPointerCapture(wt.pointerId),y.dispatchEvent(wt)}),De.addEventListener("pointerup",function(wt){De.releasePointerCapture(wt.pointerId),y.dispatchEvent(wt)}),De.addEventListener("pointermove",function(wt){y.dispatchEvent(wt)}),De.addEventListener("pointerenter",function(wt){y.dispatchEvent(wt)}),De.addEventListener("pointerleave",function(wt){y.dispatchEvent(wt)})}function Ke(){U&&(y.mouseX=0,y.mouseY=0,y.mousedownEvent=pe.on("stagemousedown",function(De){y.mouseX=De.stageX/e.scaX,y.mouseY=De.stageY/e.scaY}),y.mousemoveEvent=pe.on("stagemousemove",function(De){y.mouseX=De.stageX/e.scaX,y.mouseY=De.stageY/e.scaY})),le.removeEventListener("mousedown",Q,!0),le.removeEventListener("mousemove",Q,!0),le.removeEventListener("mouseup",Q),le.addEventListener("mousedown",Q,!0),le.addEventListener("mousemove",Q,!0),le.addEventListener("mouseup",Q)}function st(){yt(),ce.indexOf(t)!=-1&&!V&&(y.zil=Xr()),y.mousedownEvent&&pe&&pe.off("stagemousedown",y.mousedownEvent),y.mousemoveEvent&&pe&&pe.off("stagemousemove",y.mousemoveEvent),pe=E?new e.StageGL(R,k):new e.Stage(R),pe.frame=y,pe.mouseMoveOutside=Z,!n(o)&&E&&pe.setClearColor(e.convertColor(o)),pe.setBounds(0,0,J,ue),pe.width=J,pe.height=ue,B&&yt(),w&&pe.enableMouseOver(T),C&&(he?$e.Touch.enable(pe,!0,V):$e.Touch.enable(pe,!1,V)),V&&(pe.preventSelection=!1),X&&(pe.nextStage=X.stage),q&&(pe.nextStage=q),Ke(),pe.on("stagemouseup",function(){Y=!1})}function yt(){if(y){var De=_n(R),lt=e.windowWidth(),vt=e.windowHeight(),rt,xt,wt,_t;if(ie=y.orientation=lt>vt?"horizontal":"vertical",ie!=_e&&(_e=ie,y.dispatchEvent("orientation")),D&&O&&setTimeout(function(){le.scrollTo(0,0)},100),!!De){if(t=="fit")y.scale=lt/vt>=J/ue?vt/ue:lt/J;else if(t=="fill")y.scale=lt/vt>=J/ue?lt/J:vt/ue;else if(t=="full"){De.style.left=De.style.top="0px",De.width=J=lt,De.height=ue=vt,pe&&(pe.setBounds(0,0,J,ue),B?(wt=le.devicePixelRatio||1,De.width=lt*wt,De.height=vt*wt,De.style.width=lt+"px",De.style.height=vt+"px",y.scale=wt,pe.scaleX=pe.scaleY=y.scale):pe.scaleX=pe.scaleY=1,pe.tickOnUpdate=!1,pe.update(),pe.tickOnUpdate=!0,pe.width=J,pe.height=ue,E&&pe.updateViewport(J/pe.scaleX,ue/pe.scaleY),e.scaX=$e.stageTransformable?1:pe.scaleX,e.scaY=$e.stageTransformable?1:pe.scaleY),V||(e.scrollX(0),e.scrollY(0)),at();return}else if(t=="tag"){J=Be.style.width==""?Be.getAttribute("width")||Be.offsetWidth:Be.style.width,ue=Be.style.height==""?Be.getAttribute("height")||Be.offsetHeight:Be.style.height,B?(De.width=J*y.scale,De.height=ue*y.scale,De.style.width=J+"px",De.style.height=ue+"px",pe&&(pe.scaleX=pe.scaleY=y.scale)):(pe&&(pe.scaleX=pe.scaleY=1),De.width=J,De.height=ue),pe&&(pe.tickOnUpdate=!1,pe.update(),pe.tickOnUpdate=!0,pe.setBounds(0,0,J,ue),pe.width=J,pe.height=ue,E&&pe.updateViewport(J/pe.scaleX,ue/pe.scaleY),e.scaX=$e.stageTransformable?1:pe.scaleX,e.scaY=$e.stageTransformable?1:pe.scaleY),Be.style.overflow="hidden",De.style.left=De.style.top="0px",_t=De.getBoundingClientRect(),y.x=_t.x+e.scrollX(),y.y=_t.y+e.scrollY(),at();return}else if(t=="inline"){if(B){if(document.styleSheets[0])try{for(var ft=document.styleSheets[0].rules||document.styleSheets[0].cssRules,Ot=0;Ot<ft.length;Ot++){var Rt=ft[Ot];if(Rt.selectorText=="#"+R){var St=Rt.style.getPropertyValue("width");if(St){var Gt=Zn(De.style.width),Yt=Zn(De.style.height);De.style.width=St}}}}catch(Lt){+function(){}()}var $t=le.getComputedStyle(De),sn=Zn($t.getPropertyValue("width"));Gt&&(De.style.height=Yt*sn/Gt+"px",$t=le.getComputedStyle(De));var en=Zn($t.getPropertyValue("height"));wt=le.devicePixelRatio||1,y.scale=sn/r*wt,De.width=J*y.scale,De.height=ue*y.scale,De.style.width=sn+"px",De.style.height=en+"px",pe&&(pe.scaleX=pe.scaleY=y.scale)}else pe&&(pe.scaleX=pe.scaleY=1);pe&&(pe.tickOnUpdate=!1,pe.update(),pe.tickOnUpdate=!0,pe.setBounds(0,0,J,ue),pe.width=J,pe.height=ue,E&&pe.updateViewport(J/pe.scaleX,ue/pe.scaleY),e.scaX=$e.stageTransformable?1:pe.scaleX,e.scaY=$e.stageTransformable?1:pe.scaleY),De.style.left=De.style.top="0px",_t=De.getBoundingClientRect(),y.x=_t.x+e.scrollX(),y.y=_t.y+e.scrollY(),at();return}xt=ue*y.scale,rt=J*y.scale,B?(wt=le.devicePixelRatio||1,y.scale*=wt,De.width=J*y.scale,De.height=ue*y.scale,De.style.width=J*y.scale/wt+"px",De.style.height=ue*y.scale/wt+"px",pe&&(pe.scaleX=pe.scaleY=y.scale)):(pe&&(pe.scaleX=pe.scaleY=1),De.style.width=rt+"px",De.style.height=xt+"px"),pe&&(pe.tickOnUpdate=!1,pe.update(),pe.tickOnUpdate=!0),P=="left"?y.x=0:P=="right"?y.x=lt-rt:y.x=(lt-rt)/2,A=="top"?y.y=0:A=="bottom"?y.y=vt-xt:y.y=(vt-xt)/2,De.style.left=y.x+"px",De.style.top=y.y+"px",V||(e.scrollX(0),e.scrollY(0)),at(),pe&&(e.scaX=$e.stageTransformable?1:pe.scaleX,e.scaY=$e.stageTransformable?1:pe.scaleY)}}}var We=He.reverse().join("");this.update=function(){yt(),y.dispatchEvent("update")};function at(){if(t=="fill"){var De=(Zn(y.canvas.style.width)-e.windowWidth())/2;P=="left"?(y.visibleLeft=0,y.visibleRight=e.windowWidth()/(e.windowWidth()+De*2)*J):P=="right"?(y.visibleLeft=De*2/(e.windowWidth()+De*2)*J,y.visibleRight=J):(y.visibleLeft=De/(e.windowWidth()+De*2)*J,y.visibleRight=(e.windowWidth()+De)/(e.windowWidth()+De*2)*J);var lt=(Zn(y.canvas.style.height)-e.windowHeight())/2;A=="top"?(y.visibleTop=0,y.visibleBottom=e.windowHeight()/(e.windowHeight()+lt*2)*ue):A=="bottom"?(y.visibleTop=lt*2/(e.windowHeight()+lt*2)*ue,y.visibleBottom=ue):(y.visibleTop=lt/(e.windowHeight()+lt*2)*ue,y.visibleBottom=(e.windowHeight()+lt)/(e.windowHeight()+lt*2)*ue)}else y.visibleLeft=y.visibleTop=0,y.visibleRight=J,y.visibleBottom=ue}function ct(){if(!(!$||!y)){y==le.zdf&&(le.W=y.width,le.H=y.height),y.dispatchEvent("resize");var De=new Date().getTime();setTimeout(function(){new Date().getTime()-De>80&&(yt(),y==le.zdf&&(le.W=y.width,le.H=y.height),setTimeout(function(){y.dispatchEvent("resize"),!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&pe&&(t=="full"||t=="tag")&&pe.update()},100))},100),!e.OPTIMIZE&&(Dt||!le.OPTIMIZE)&&pe&&(t=="full"||t=="tag")&&pe.update()}}setTimeout(function(){y&&y.dispatchEvent("orientation")},250);var Pe=["ttf","otf","woff2","woff","fnt"];g[We]=function(){var vt=g.now(),De=Math.floor(vt/1e3%10),lt=(lt=vt.toString()).substring(0,lt.length-2)+(10+De-3)%10+lt.substring(lt.length-1),vt=Math.floor(vt/1e4%10);return lt=(lt=lt.substring(0,lt.length-1)+(vt+1)%10).substring(0,lt.length-3)+(De+vt+3)%10+lt.substring(lt.length-2),Number(lt)},this.loadAssets=function(De,lt,vt,rt,xt,wt,_t,ft,Ot,Rt,St,Gt){if(n(De))return en();if(n(De.src)){var Yt="assets, path, progress, xhr, time, loadTimeout, outputAudioSprite, crossOrigin, fileType, queueOnly, maxConnections, maxNum",$t;if($t=mt(y.loadAssets,arguments,Yt))return $t}n(lt)||(le.PATH=lt);var sn=v(xt||null);if(!n(vt)&&vt.type=="ProgressBar"&&n(rt)&&(rt=!0),n(rt)&&(rt=!0),Array.isArray(De)||(De=[De]),De.length==0)return en();function en(){var qt=new e.Queue;return qt.isLoading=!1,qt.loadAssetsCount=0,setTimeout(function(){qt.dispatchEvent("complete"),y.dispatchEvent("complete")},10),qt}n(xt)&&(xt=0),n(wt)&&(wt=sn=="s"?8:8e3),n(_t)&&(_t=!1),n(ft)&&(ft="anonymous"),n(Rt)&&(Rt=!1),n(St)&&(St=F),n(Gt)&&(Gt=y.maxNum);var Lt=!1,Zt=[],ot,bt,Bt,It,Ut,kt=/\.([^.]+)$/i,Nt=[],Wt=[],jt=[],rn=0,Kt=!0;for(Bt=0;Bt<De.length;Bt++){if(ot=De[Bt],ot.assets){var ln=[];for(De.splice(Bt,1),Array.isArray(ot.assets)||(ot.assets=[ot.assets]),It=0;It<ot.assets.length;It++){var tn=ot.assets[It];if(tn.split){var xn=tn.split("?");bt=xn[0].match(kt)}bt&&Pe.indexOf(bt[1])>=0?Nt.push(tn):tn.match&&tn.match(/fonts\.googleapis\.com/i)?Wt.push(tn):tn.font?(tn.src?tn.src=ot.path+tn.src:tn.font=ot.path+tn.font,Nt.push(tn)):e.assetIDs[tn]?ln.push({id:ot.path+tn,src:ot.path+tn,path:null,loadTimeout:ot.loadTimeout,maxNum:ot.maxNum,noCORSonImage:ot.noCORSonImage}):ln.push({id:tn,src:tn,path:ot.path,loadTimeout:ot.loadTimeout,maxNum:ot.maxNum,noCORSonImage:ot.noCORSonImage})}for(var Pt=ln.length-1;Pt>=0;Pt--)De.splice(Bt,0,ln[Pt]);if(ot=ln[0],ot==null)continue}if(ot.constructor=={}.constructor){var ut=0;for(var At in ot)ut++;ut==1&&ot.src&&!ot.src.match(/fonts\.googleapis\.com/i)&&(ot=ot.src)}var Ht;if(ot.constructor=={}.constructor)if(ot.audioSprite){Ut=e.copy(ot),ot=Ut.src,An(ot);var Jt=[],zt;for(It=0;It<Ut.audioSprite.length;It++)zt=Ut.audioSprite[It],Jt.push({id:zt[0],startTime:Math.round(zt[1]*1e3),duration:Math.round((zt[2]-zt[1])*1e3)});delete Ut.audioSprite,Ut.data={audioSprite:Jt},Zt.push(Ut)}else if(ot.data&&ot.data.audioSprite)Ut=e.copy(ot),ot=Ut.src,An(ot),Zt.push(Ut);else if(ot.id){if(ot.path){var Qt,Mt;if(ot.path.match(/http/i))ot.src=ot.path+ot.src;else if(ot.path.match(/^\//))Qt=le.location.href,Mt=Qt.match(/(.*?)([^/])\/[^/]/),Qt=Mt[1]+Mt[2],ot.src=Qt+ot.path+ot.src;else{var Ft=le.location.pathname;Qt=le.location.href;var yn=Qt.split(Ft)[0]+Ft;Mt=yn.match(/(.*)\//),ot.src=Mt[1]+"/"+ot.path+ot.src}delete ot.path}if(ot.noCORSonImage){var gn=new Image;jt.push(gn),gn.src=ot.src,gn.id=ot.id;var nn;gn.onload=function(qt){var cn=qt.currentTarget,fn=e.assets[cn.id]=new e.Bitmap({image:cn,style:!1}).expand(0);nn=new $e.Event("assetload"),fn&&typeof fn!="string"&&typeof fn!="number"&&(fn.file=cn.id,fn.src=cn.src),nn.asset=fn,un.dispatchEvent(nn),Rt||(nn=new $e.Event("assetload"),nn.asset=fn,y.dispatchEvent(nn)),un.loadAssetsCount--,un.loadAssetsCount==0&&In()}}else{e.assetIDs[ot.id]=ot.src;var kn=ot.maxNum;n(kn)&&(kn=Gt);var ar=ot.type,Jn=n(ot.loadTimeout)?wt:ot.loadTimeout;ot=ot.src,An(ot),Ht={src:ot,loadTimeout:Jn*(sn=="s"?1e3:1),data:kn,type:ar},n(Ot)||(Ht.type=Ot),Zt.push(Ht)}}else ot.src&&ot.src.match(/fonts\.googleapis\.com/i)?Wt.push(ot):Nt.push(ot);else{var tr=An(ot);tr&&Pe.indexOf(tr[1])>=0?(Nt.push(ot),rn--):ot.match(/fonts\.googleapis\.com/i)?(Wt.push(ot),rn--):(Ht={src:ot,loadTimeout:wt*(sn=="s"?1e3:1),data:Gt},n(Ot)||(Ht.type=Ot),Zt.push(Ht))}if(Lt&&Kt){var pr=document.createElement("audio");pr.setAttribute("src",(!n(lt)&&!ot.match(/^http:\/\/|https:\/\//i)?lt:"")+ot),document.body.appendChild(pr),Kt=!1}}function An(qt){if(bt=null,qt.split){var cn=qt.split("?");bt=cn[0].match(kt),bt&&$e.Sound.SUPPORTED_EXTENSIONS.indexOf(bt[1])>=0&&(Lt=!0)}return rn++,bt}y.loadAssetsCount++,y.isLoading=!0;var un=new e.Queue;un.isLoading=!0,un.loadAssetsCount=0,!n(vt)&&vt.show&&(vt.zimActiveLoader=un,vt.show());var an;if(Nt.length>0){var or=[],En,on;for(Bt=0;Bt<Nt.length;Bt++){if(on=Nt[Bt],on.font&&!on.src){on.src=on.font,on.font=on.font.split(".")[0];var nr=on.font.split("/");on.font=nr[nr.length-1]}typeof on=="string"&&(on={font:on.split(".")[0],src:on}),En={src:"url("+(on.src.match(/\//i)?"":lt||"")+on.src+")"+(on.type?" format('"+on.type+"')":""),family:on.font},on.weight&&(En.weight=on.weight),on.style&&(En.style=on.style),or.push(En)}an=new $e.FontLoader({src:or},!0),an.on("complete",qn),an.on("error",qn),an.load(),un.loadAssetsCount++}if(Wt.length>0)for(Bt=0;Bt<Wt.length;Bt++)on=Wt[Bt],typeof on=="string"&&(on={src:on}),En={src:on.src,type:"fontcss"},un.loadAssetsCount++,an=new $e.FontLoader(En,!0),an.on("complete",qn),an.on("error",qn),an.load();function qn(){un.loadAssetsCount--,un.loadAssetsCount==0&&In()}if(jt.length>0)for(Bt=0;Bt<jt.length;Bt++)un.loadAssetsCount++;function Bn(qt,cn){un.loadAssetsCount--;var fn=cn.item,wn=e.assets[fn.id]=qt;wn.src=fn.src,wn.file=fn.id,wn.item=fn,wn.svg=cn.svg;var Ln=new $e.Event("assetload");Ln.item=fn,Ln.asset=wn,wn.type="SVG",un.dispatchEvent(Ln),Rt||(Ln=new $e.Event("assetload"),Ln.item=fn,Ln.asset=wn,y.dispatchEvent(Ln)),un.loadAssetsCount==0&&In()}var Un=Date.now(),Nn=new $e.Event("complete");if(rn>0){un.loadAssetsCount++;var Sn=un.preload=y.preload=new $e.LoadQueue(rt,lt,ft);St!=1&&Sn.setMaxConnections(St),Lt&&Sn.installPlugin($e.Sound),Sn.on("progress",function(qt){un.dispatchEvent(qt),Rt||y.dispatchEvent(qt)}),Sn.on("error",function(qt){un.dispatchEvent(qt),Rt||y.dispatchEvent(qt)}),Sn.on("fileload",function(qt){if(!qt.result||(qt.result.nodeName=="IMG"||qt.result.nodeName=="SVG")&&!qt.rawResult&&rt){var cn=new $e.Event("error");cn=new $e.Event("error"),cn.item=qt.item,un.dispatchEvent(cn),cn=new $e.Event("error"),cn.item=qt.item,y.dispatchEvent(cn)}else{var fn=qt.item,wn=qt.item.type,Ln=fn.id.match(kt),Tn;if(wn&&wn=="sound"){var $n=[];if(fn.data&&fn.data.audioSprite)for(var Yn=0;Yn<fn.data.audioSprite.length;Yn++)$n.push(fn.data.audioSprite[Yn].id);else $n.push(fn.id);for(Yn=0;Yn<$n.length;Yn++)~function(){var Fn=$n[Yn],gr=qt.item.src,vr=qt.item;Tn=e.assets[Fn]={type:"sound",path:lt,id:Fn,file:Fn,src:gr,item:vr,dispose:function(){delete e.assets[Fn],Tn=null},play:function(Qn,lr,yr,mr,xr,wr,mn){var jn="volume, loop, loopCount, pan, offset, delay, interrupt",zn;if(zn=mt(e.assets[Fn].play,arguments,jn))return zn;var Cn={volume:Qn,loop:lr,loopCount:yr,pan:mr,offset:xr,delay:wr,interrupt:mn},Mn=v(Cn.offset,null,30);Mn=="s"&&(Cn.offset&&(Cn.offset*=1e3),Cn.delay&&(Cn.delay*=1e3)),Cn.loop===!0&&(Cn.loop=-1),Cn.loopCount&&(Cn.loop=Cn.loopCount,delete Cn.loopCount);var Pn=$e.Sound.play(Fn,Cn);return Pn.getStage=function(){return pe},Pn.dispose=function(){Pn.destroy()},Pn}}}()}else if(wn=="image")qt.result.width&&(Tn=e.assets[fn.id]=new e.Bitmap({image:qt.result,width:qt.result.width,height:qt.result.height,style:!1}),fn.avoidCORS&&Tn.expand(0));else if(wn=="svg"){un.loadAssetsCount++,e.svgToBitmap(qt.result,Bn,null,null,{svg:qt.result,item:fn,type:wn,ext:Ln});return}else Tn=e.assets[fn.id]=qt.result;Tn&&typeof Tn!="string"&&typeof Tn!="number"&&wn!="json"&&wn!="xml"&&(Tn.file=qt.item.id,Tn.src=qt.item.src,Tn.item=qt.item),cn=new $e.Event("assetload"),cn.item=fn,cn.asset=Tn,un.dispatchEvent(cn),Rt||(cn=new $e.Event("assetload"),cn.item=fn,cn.asset=Tn,y.dispatchEvent(cn))}}),y.preloadEvent=Sn.on("complete",function(qt){Nn=qt,un.loadAssetsCount--,un.loadAssetsCount==0&&In()});try{Sn.loadManifest(Zt)}catch(qt){+function(){}()}}function In(){var qt=Date.now();xt=Math.max(0,xt-(qt-Un)),setTimeout(function(){y.loadAssetsCount--,y.loadAssetsCount<=0&&(y.isLoading=!1),un.isLoading=!1,un.dispatchEvent(Nn),!n(vt)&&vt.show&&vt.hide(),Rt||y.dispatchEvent(Nn)},xt*(sn=="s"?1e3:1))}return un},this.ac=function(De,lt,vt){vt?(vt.commands||(vt.commands=[]),vt.commands.push([De,lt,vt])):(lt[0].commands||(lt[0].commands=[]),lt[0].commands.push([De,lt]))},e.asset=this.asset=function(De,lt,vt,rt,xt){if(!n(De)){De=dt(De);var wt=e.assetIDs[De];if(wt&&(De=wt),e.assets[De]&&(!e.assets[De].type||e.assets[De].type&&e.assets[De].type.substr(0,2)!="AC"))return e.assets[De];if(le.PATH!=null&&(e.PATH=le.PATH),xt){var _t;return y.loadFailObj=="circles"?_t=y.makeCircles(14):_t=y.loadFailObj,_t&&(_t.type="EmptyAsset",_t.id=De,_t.play=function(){if(Ct)return ht("Frame - asset("+De+") not found"),{}}),_t}else{var ft=new e.Container(lt,vt);e.assets[De]=ft,lt&&vt?ft.type="ACWD":ft.type="AC";var Ot=y.loadAssets({assets:De,path:De.split("/").length==1?e.PATH:null,queueOnly:!0,maxNum:rt}),Rt=De.split(".");return $e.Sound.SUPPORTED_EXTENSIONS.indexOf(Rt[Rt.length-1])>=0&&(ft.play=function(){return ft.playParams=arguments,ft.proxy=new $e.EventDispatcher,Object.defineProperty(ft.proxy,"volume",{get:function(){return ft.sound?ft.sound.volume:null},set:function(St){ft.volume=St,ft.sound&&(ft.sound.volume=St)}}),Object.defineProperty(ft.proxy,"pan",{get:function(){return ft.sound?ft.sound.pan:null},set:function(St){ft.pan=St,ft.sound&&(ft.sound.pan=St)}}),ft.proxy}),Ot.on("complete",function(){De.id?De=De.id:De.src&&(De=De.src);var St=y.asset(De,null,null,null,!0),Gt=De.split("."),Yt;if($e.Sound.SUPPORTED_EXTENSIONS.indexOf(Gt[Gt.length-1])>=0)ft.play=St.play,ft.type="Sound",ft.src=St.src,ft.item=St.item,ft.playParams&&(ft.sound=ft.play.apply(null,ft.playParams),ft.volume!=null&&(ft.sound.volume=ft.volume),ft.pan!=null&&(ft.sound.pan=ft.pan),ft.sound.on("complete",function(){ft.proxy.dispatchEvent("complete")}));else if(St.type=="Bitmap"||St.type=="Image"||St.type=="Pic"){if(St.type=="Bitmap"?(St.addTo(ft),ft.bitmap=St,ft.image=St.image,ft.id=St.id,ft.item=St.item):(ft.bitmap=St.getChildAt(0).clone(),ft.bitmap.addTo(ft),ft.image=ft.bitmap.image,ft.id=ft.bitmap.id,ft.item=ft.bitmap.item),ft.mouseChildren=!1,ft.type="Image",ft.commands)for(Yt=0;Yt<ft.commands.length;Yt++)ft.commands[Yt][2]?ft[ft.commands[Yt][0]].apply(ft,ft.commands[Yt][1]):e[ft.commands[Yt][0]].apply(ft,ft.commands[Yt][1]);ft.commands=null,ft.stage&&ft.stage.update()}else if(St.type=="EmptyAsset"){if(St.addTo(ft),ft.mouseChildren=!1,ft.type="EmptyAsset",ft.commands)for(Yt=0;Yt<ft.commands.length;Yt++)ft.commands[Yt][2]?ft[ft.commands[Yt][0]].apply(ft,ft.commands[Yt][1]):e[ft.commands[Yt][0]].apply(ft,ft.commands[Yt][1]);ft.commands=null,ft.stage&&ft.stage.update()}else if(St.type=="SVG"){if(St.addTo(ft),ft.mouseChildren=!1,ft.type="SVG",ft.bitmap=St,ft.svg=St.svg,ft.commands)for(Yt=0;Yt<ft.commands.length;Yt++)ft.commands[Yt][2]?ft[ft.commands[Yt][0]].apply(ft,ft.commands[Yt][1]):e[ft.commands[Yt][0]].apply(ft,ft.commands[Yt][1]);ft.commands=null,ft.stage&&ft.stage.update()}e.assets[De]=ft,ft.dispatchEvent("assetLoad"),ft.dispatchEvent("complete")}),Ot.on("error",function(St){var Gt=new $e.Event("error");Gt.id=St.id,Gt.item=St.item,ft.dispatchEvent(Gt)}),ft}}},e.asset.getIDs=function(){var De=[];for(var lt in e.assetIDs)De.push(lt);return De},e.image=function(De,lt,vt,rt,xt){return De.match(/^htt/i)&&(De="https://cors.zimjs.com/"+De),e.asset(De,lt,vt,rt,xt)},e.zimObjectIDs={},e.object=this.object=function(De){return e.zimObjectIDs[De]},e.object.getNames=function(){var De=[];for(var lt in e.zimObjectIDs)De.push(lt);return De},le.zns||(le.asset=this.asset,le.image=e.image,le.object=this.object),this.setDefault=function(){return le.zimDefaultFrame=le.zdf=le.F=y,le.S=pe,le.W=pe.width,le.H=pe.height,y},Object.defineProperty(y,"isDefault",{get:function(){return le.zdf==y},set:function(){ht("Frame(): isDefault is read only - see setDefault()")}}),Object.defineProperty(y,"stage",{get:function(){return pe},set:function(){ht("Frame(): stage is read only - see remakeCanvas(), perhaps")}}),Object.defineProperty(y,"width",{get:function(){return J},set:function(){ht("Frame(): width is read only - see remakeCanvas(), perhaps")}}),Object.defineProperty(y,"height",{get:function(){return ue},set:function(){ht("Frame(): height is read only - see remakeCanvas(), perhaps")}}),Object.defineProperty(this,"color",{get:function(){return o},set:function(De){o=De,n(De)?y.canvas.style.backgroundColor="default":(y.canvas.style.backgroundColor=o,!n(o)&&E&&pe.setClearColor(e.convertColor(o)))}});var Ie;Object.defineProperty(this,"outerColor",{get:function(){return Ie},set:function(De){Ie=De,dr("body").css({backgroundColor:Ie})}}),Object.defineProperty(y,"allowDefault",{get:function(){return V},set:function(De){De?(pe.preventSelection=!1,document.body.style.overflow="visible",y.zil&&(le.removeEventListener("keydown",y.zil[0]),le.removeEventListener("wheel",y.zil[1]),le.removeEventListener("DOMMouseScroll",y.zil[2]),y.zil=null)):(pe.preventSelection=!0,pe.enableDOMEvents(!0),(t=="full"||t=="fit"||t=="fill")&&(document.body.style.overflow="hidden"),n(y.zil)&&(y.zil=Xr())),V=De,pe.__touch&&(pe.__touch.preventDefault=!V)}});var be;Object.defineProperty(y,"cursors",{get:function(){return be},set:function(De){be=De&&De.constructor=={}.constructor?De:null,be?ze(be):it()}}),y.cursorTypes=["none","auto","pointer","text","wait","crosshair","default","help","move","progress","e-resize","ne-resize","nw-resize","n-resize","se-resize","sw-resize","s-resize","w-resize","context-menu","cell","vertical-text","alias","copy","no-drop","not-allowed","ew-resize","ns-resize","nesw-resize","nwse-resize","col-resize","row-resize","all-scroll","grab","grabbing","zoom-in","zoom-out"],y.cursorList=new e.Dictionary(!0);function ze(De){e.loop(De,function(wt,_t){_t.noMouse&&_t.noMouse()}),y.pme&&it(),e.loop(y.cursorList,function(wt){!wt._cursor&&wt.cursor&&De[wt.cursor]&&(wt._cursor=wt.cursor,y.cursorList.add(wt,wt._cursor),wt.cursor="none")}),De.default&&(document.body.style.cursor="none"),y.pme=y.on("pointermove",function(wt){if(y.cursorObj){var _t=y.cursorObj,ft=y.stage.getObjectUnderPoint(y.mouseX,y.mouseY,1);ft&&(ft._cursor||ft.cursor)?xt(ft):De.default?(je("none"),y.cursorObj=De.default,De.default.addTo(y.stage)):je(),y.cursorObj!=_t&&_t.removeFrom&&_t.removeFrom(),y.cursorObj.x=y.mouseX,y.cursorObj.y=y.mouseY,y.cursorObj.top(),e.Ticker.isUpdating(y.stage)||y.stage.update()}});var lt=!1;if(y.mouseX!=0&&y.mouseY!=0){lt=!0;var vt=y.stage.getObjectUnderPoint(y.mouseX,y.mouseY,1);vt&&(vt._cursor||vt.cursor)?(Hn("setting"),xt(vt)):De.default?(je("none"),De.default.x=y.mouseX,De.default.y=y.mouseY,y.cursorObj=De.default,y.cursorObj.mouseChildren=!1,y.cursorObj.mouseEnabled=!1,De.default.addTo(y.stage)):je(),y.stage.update()}function rt(wt){je("none"),y.cursorObj=wt,y.cursorObj.x=y.mouseX,y.cursorObj.y=y.mouseY,y.cursorObj.mouseChildren=!1,y.cursorObj.mouseEnabled=!1,y.cursorObj.addTo(y.stage)}y.pee=y.on("pointerenter",function(wt){if(lt){lt=!1;return}setTimeout(function(){var _t=y.stage.getObjectUnderPoint(y.mouseX,y.mouseY,1);_t&&(_t._cursor||_t.cursor)||(De.default?rt(De.default):je(),y.stage.update())},50)}),y.smo=y.stage.on("mouseover",function(wt){xt(wt.target)});function xt(wt){var _t=y.cursorsExclude;if(_t&&(Array.isArray(_t)||(_t=[_t]),_t.includes(wt))){wt.cursor=y.cursorTypes.includes(wt._cursor)?wt._cursor:"default";return}if(wt._cursor&&De[wt._cursor]){if(De[wt._cursor]==y.cursorObj)return;y.cursorObj&&y.cursorObj.removeFrom(),rt(De[wt._cursor])}else if(De.default&&(!wt.cursor||!y.cursorTypes.includes(wt.cursor))){if(De.default==y.cursorObj)return;y.cursorObj&&y.cursorObj.removeFrom(),rt(De.default)}else y.cursorTypes.includes(wt.cursor)||(wt.cursor="default"),y.cursorObj&&y.cursorObj.removeFrom();y.stage.update()}y.ple=y.on("pointerdown",function(wt){y.cursorObj&&e.interval(.001,function(){y.cursorObj&&y.cursorObj.top(),y.stage.update()},2,!0)}),y.pde=y.on("pointerleave",function(wt){lt=!1,y.cursorObj&&y.cursorObj.removeFrom(),y.stage.update()}),y.smu=y.stage.on("mouseout",function(wt){y.cursorObj&&y.cursorObj.removeFrom(),De.default?rt(De.default):je()})}function it(){y.pme&&y.off("pointermove",y.pme),y.pee&&y.off("pointerenter",y.pee),y.ple&&y.off("pointerdown",y.ple),y.pde&&y.off("pointerleave",y.pde),y.smo&&y.stage.off("mouseover",y.smo),y.smu&&y.stage.off("mouseout",y.smu),y.pme=y.pee=y.ple=y.pde=y.smo=y.smu=null,e.loop(y.cursorList,function(De,lt){lt!==!0&&(De.cursor=lt),De._cursor=null}),e.loop(y.cursorList,function(De){y.cursorList.add(De,!0)}),y.cursorObj&&(y.cursorObj.dispose(),y.cursorObj=null,y.stage.update()),je()}function je(De){De!="none"&&(y.cursorObj=null),y.canvas.parentElement&&(y.canvas.parentElement.style.cursor=De||"default")}function tt(De){y.dispatchEvent(De)}le.addEventListener("contextmenu",tt,!1);var Te=new $e.Event("keydown");this.eventRemove=Te.remove;function et(De){De.remove=y.eventRemove,y.altKey=De.altKey,y.ctrlKey=De.ctrlKey,y.metaKey=De.metaKey,y.shiftKey=De.shiftKey,y.dispatchEvent(De)}le.addEventListener("keydown",et);function Ue(De){y.altKey=De.altKey,y.ctrlKey=De.ctrlKey,y.metaKey=De.metaKey,y.shiftKey=De.shiftKey,De.remove=y.eventRemove,y.dispatchEvent(De)}le.addEventListener("keyup",Ue);function Re(De){y.dispatchEvent(De)}le.addEventListener("wheel",Re);function Ze(De){De.remove=y.eventRemove,y.dispatchEvent(De)}te&&le.DeviceMotionEvent&&le.addEventListener("devicemotion",Ze);function Je(De){De.remove=y.eventRemove;var lt=360-De.alpha;Math.abs(lt-nt)>180-45&&Math.abs(lt-nt)<180+45&&(pt=pt==0?180:0),nt=lt,De.rotation={x:De.beta,y:De.gamma,z:(lt+pt)%360},y.dispatchEvent(De)}if(te&&le.DeviceOrientationEvent){var nt=0,pt=0;le.addEventListener("deviceorientation",Je)}this.isFullscreen=!!document.fullscreenElement,this.htmlobc=dr("html").css("backgroundColor"),this.fullscreen=function(De){if(n(De)&&(De=!0),De){if(document.fullscreenElement)return;var lt=y.canvas.parent?y.canvas.parent:document.body;lt.requestFullscreen?lt.requestFullscreen():lt.webkitRequestFullscreen?lt.webkitRequestFullscreen():lt.mozRequestFullscreen?lt.mozRequestFullscreen():lt.msRequestFullscreen&&lt.msRequestFullscreen()}else{if(!document.fullscreenElement)return;document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozExitFullscreen?document.mozExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()}this.isFullscreen=De},document.addEventListener("fullscreenchange",function(){y.isFullscreen=!!document.fullscreenElement,document.fullscreenElement?(dr("html").css("backgroundColor",y.color),y.dispatchEvent("fullscreenenter")):(dr("html").css("backgroundColor",y.htmlobc?y.htmlobc:"transparent"),y.dispatchEvent("fullscreenexit"))}),this.remakeCanvas=function(De,lt){if(t!="full"){n(De)&&(De=J),n(lt)&&(lt=ue),_n(R)&&_n(R).parentNode.removeChild(_n(R)),J=De,ue=lt;for(var vt=[],rt=0;rt<y.stage.numChildren;rt++)vt.push(y.stage.getChildAt(rt));for(Qe(),st(),rt=0;rt<vt.length;rt++)y.stage.addChild(vt[rt])}},this.follow=function(De,lt,vt,rt,xt,wt,_t,ft,Ot,Rt,St,Gt,Yt,$t){var sn="obj, boundary, damp, dampY, leftOffset, rightOffset, upOffset, downOffset, offsetDamp, offsetDampY, horizontal, vertical, borderLock, lag",en;if(en=mt(y.follow,arguments,sn))return en;if(y.followObj=null,y.followTicker&&e.Ticker.remove(y.followTicker),n(De))return;De.dirX=De.dirY=0,y.followObj=De,De.followDampX=null,De.followDampY=null,n(lt)&&(lt=new e.Boundary(0,0,y.stage.width,y.stage.height)),y.followBoundary=lt,n(vt)&&(vt=.05),n(rt)&&(rt=vt),n(xt)&&(xt=0),n(wt)&&(wt=0),n(_t)&&(_t=0),n(ft)&&(ft=0),n(Ot)&&(Ot=.02),n(Rt)&&(Rt=Ot),n(St)&&(St=!0),n(Gt)&&(Gt=!0),n(Yt)&&(Yt=!1),n($t)&&($t=!1),De.parent?Lt():De.on("added",Lt);function Lt(){var Zt=De.parent;y.frameBorderLock=Yt,St&&(y.followDampX=new e.Damp(Zt.x,vt),y.offsetDampX=new e.Damp(lt.x+xt+(lt.width-xt-wt)/2,Ot)),Gt&&(y.followDampY=new e.Damp(Zt.y,rt),y.offsetDampY=new e.Damp(lt.y+_t+(lt.height-_t-ft)/2,Rt)),y.followTicker=e.Ticker.add(function(){var ot=y.followBoundary;if(St){var bt=ot.x+xt+(ot.width-xt-wt)/2;y.followOffsetX=[$t?ot.x+ot.width-xt:bt,bt,$t?ot.x+xt:bt],y.followObj&&(Zt.x=y.followDampX.convert(y.offsetDampX.convert(y.followOffsetX[De.motionController?De.motionController.dirX+1:1])-De.x))}if(Gt){var Bt=ot.y+_t+(ot.height-_t-ft)/2;y.followOffsetY=[$t?ot.y+ot.height-ft:Bt,Bt,$t?ot.y+_t:Bt],y.followObj&&(Zt.y=y.followDampY.convert(y.offsetDampY.convert(y.followOffsetY[De.motionController?De.motionController.dirY+1:1])-De.y))}y.frameBorderLock&&(Zt.x>y.followBoundary.x&&(Zt.x=y.followBoundary.x),Zt.y>y.followBoundary.y&&(Zt.y=y.followBoundary.y),Zt.x<y.followBoundary.x+y.followBoundary.width-Zt.width&&(Zt.x=y.followBoundary.x+y.followBoundary.width-Zt.width),Zt.y<y.followBoundary.y+y.followBoundary.height-Zt.height&&(Zt.y=y.followBoundary.y+y.followBoundary.height-Zt.height))})}return De},n(e.blurCheck)&&e.setBlurDetect(),this.keyboardMessage=function(De,lt,Rt,rt,xt){var wt="color, backgroundColor, message, response, percent",_t;if(_t=mt(y.keyboardMessage,arguments,wt))return _t;n(De)&&(De=e.yellow),n(lt)&&(lt="black"),n(Rt)&&(Rt="PRESS SCREEN FOR KEYBOARD CONTROL"),n(rt)&&(rt="YOU HAVE KEYBOARD CONTROL"),n(xt)&&(xt=80);function ft(){try{return window.self!==window.top}catch(Gt){return!0}}var Ot=ft();Ot&&(y.canvas.style.pointerEvents="none");var Rt=new e.Label({text:Rt,size:40,color:De,backgroundColor:lt,paddingV:15,paddingH:30,shiftV:1,align:CENTER}).scaleTo(y.stage,xt).ske(10).reg(CENTER).pos(0,50,CENTER,BOTTOM);document.addEventListener("mousedown",St),document.addEventListener("pointerdown",St);function St(){Ot&&(y.canvas.style.pointerEvents="auto"),document.removeEventListener("mousedown",St),document.removeEventListener("pointerdown",St),Rt&&(Rt.text=rt,Rt.animate({props:{alpha:0},wait:1,call:()=>{Rt.dispose(),Rt=null}}),y.stage.update())}return Rt},this.dispose=function(){y.zil&&y.zil.length&&(le.removeEventListener("keydown",y.zil[0]),le.removeEventListener("wheel",y.zil[1]),le.removeEventListener("DOMMouseScroll",y.zil[2])),ye&&ye.removeAllEventListeners(),se&&le.removeEventListener("resize",se),le.removeEventListener("resize",Ve),le.removeEventListener("contextmenu",tt),le.removeEventListener("keydown",et),le.removeEventListener("keyup",Ue),le.removeEventListener("wheel",Re),le.removeEventListener("devicemotion",Ze),le.removeEventListener("deviceorientation",Je),le.removeEventListener("mousedown",Q,!0),le.removeEventListener("mousemove",Q,!0),le.removeEventListener("mouseup",Q),V||(document.body.style.overflow="auto"),De(pe);function De(lt){if(lt.dispose)lt.dispose();else{if(lt.removeAllEventListeners(),lt.numChildren)for(var vt=lt.numChildren-1;vt>=0;vt--)De(lt.getChildAt(vt));lt.parent&&lt.parent.removeChild(lt)}lt=null}return _n(R)&&_n(R).parentNode.removeChild(_n(R)),y==e.tickerFrame&&(e.tickerFrame=null),y===le.zdf&&(le.zdf=le.S=le.W=le.H=null),pe=null,y=null,!0},this.makeCircles=function(De,lt){n(De)&&(De=100);var vt=[e.orange,e.green,e.pink,e.blue,e.brown,e.dark],rt,xt;if(lt)for(rt=new e.Container({style:!1}),rt.radius=De,xt=0;xt<vt.length;xt++)rt.addChild(new e.Circle(rt.radius/vt.length*(vt.length-xt),vt[xt],null,null,null,null,null,null,!1));else{rt=new e.Shape({style:!1});var wt=rt.graphics;for(rt.radius=De,xt=0;xt<vt.length;xt++)wt.f(vt[xt]).dc(0,0,rt.radius/vt.length*(vt.length-xt));rt.setBounds(-rt.radius,-rt.radius,rt.radius*2,rt.radius*2)}return rt},this.madeWith=function(De,lt,vt,rt,xt,wt,_t){var ft="color, text, edges, box, slats, borderColor, borderWidth",Ot;if(Ot=mt(y.madeWith,arguments,ft))return Ot;n(De)&&(De=e.dark),n(lt)&&(lt="Made with ZIM");var Rt=new e.Container,St=Rt.icon=y.makeIcon(vt,rt,xt,wt,_t).sca(.5).alp(.92).hov(1).addTo(Rt).tap(function(){St.alp(.92),St.stage.update(),sr("https://zimjs.com","_blank")});return Rt.label=new e.Label(lt,16,null,De).sca(.7).pos(0,-19,e.CENTER,e.BOTTOM,Rt),Rt},this.makeIcon=function(De,lt,vt,rt,xt){var wt="edges, box, slats, borderColor, borderWidth",_t;if(_t=mt(y.makeIcon,arguments,wt))return _t;var ft=new e.Container(-20,-13,102,120).reg(-20,-13);n(De)&&(De=e.light),n(lt)&&(lt=e.dark),vt===!0&&(vt=[e.silver,e.silver,e.silver,e.silver,e.silver]),new e.Rectangle(ft.width,ft.height,lt,rt,xt).loc(-20,-13,ft);var Ot=[[vt?vt[0]:"#E474C3","AieA0IAAgCIAmhlIEXAAIg5Bng",41.7,19.5],[vt?vt[1]:"#50C5B7","AiSAzIAnhlID+AAIg5Blg",35.3,33.2],[vt?vt[2]:"#F48E25","AiFA0IAmhnIDlAAIg5Bng",28.9,46.7],[vt?vt[3]:"#EBCD36","Ah4AzIAmhlIDLAAIg5Blg",22.4,60.5],[vt?vt[4]:"#ABD140","AhrA0IAAgFIAlhiICxAAIg5Bng",16.1,74.3],[De,"AlGHRIAnhnIH+AAIgbBngAlGlpIAnhnIJmAAIg5Bng",32.7,46.5]];return e.loop(Ot,function(Rt){var St=new e.Shape().addTo(ft);St.graphics.f(Rt[0]).p(Rt[1]),St.setTransform(Rt[2],Rt[3])}),ft.mouseChildren=!1,ft},this.makeAbstract=function(De){n(De)&&(De="black");var lt=[[115.8,103.55,"#4ACBEB","Am6GkIAAtHIN0AAIAAClIrZAAIAAKig"],[127.55,73.3,"#A1E543","AAjLSIAAp6IEiAAIAAJ6gAlELOIAAp2IEiAAIAAJ2gAlEihIAAowIKEAAIAAIwg"],[32.55,73.05,"#B545E4","Ak6LQIAA2fIJ1AAIAAWfg"]],vt=new e.Rectangle(200,200);e.loop(lt,function(xt){var wt=new e.Shape().f(xt[2]).p(xt[3]);wt.setTransform(xt[0]+20,xt[1]+27),wt.addTo(vt)},!0);var rt=new e.Container;return vt.sca(.4).addTo(rt),rt.mouseChildren=!1,rt},this.makeCat=function(De){n(De)&&(De=246);var lt=[[16.95,241.15,0,"black",[1.5,2,1],"AgKAhIAVhB"],[58.65,244.378,0,"#A7A7A7",[3,2,1],"AmYAAIMxAB"],[105.64,107.14,"#EF7988",0,0,"AAEArQgNAAgjghQgiggAFgIQAFgJBEgCQBEgDAGAGQAHAIgfAkQgfAlgPAAIAAAAg"],[104.84,111.34,0,"black",[1,1,1],"AABA2IAPAYQAJAPAJAGQAKAHAMAAQAbAAAXgWQAQgPAVghQAVghAAgcQAAgnglgYQgbgSgxgCIgrACAAJADIgIAzAhphVQgXAVgMAWQgKAQgIAiQgIAkAFAMQALAfAqAOQAmANAcgIQANgEANgQQALgNAGgT"],[105.05,111.4,"#757B74",0,0,"AheBrQgvgRgQgeQgPgdAQgkQAZg8AEgFQAXgfA8gGQBVgKA+ATQBRAZgYBEQgVA/gnAZQgUAOgZAKQgJAJgVgbQgUgegCAAQgDAAgWAgQgWAUgZAAQgMAAgNgEg"],[86.18,93,"black",0,0,"Aj7g0QiYg0i9AyQA0g3BcgRQBagQBfAaQBkAbBEBBQBNBHASBpQhgiYibg0gAFxiDQAzgdA6AMQA9AMA2A4QgHgBAAACQAAAAgBABQAAAAAAAAQgBAAgBAAQAAAAgBgBQh8gshOAzQhIAvhBCYQALjABzhCg"],[78.5,63.23,"#705F6C","black",[1,1,1],"AHAg5IgNmIIBfGpQgOgQgSgMQgjgXgPASgAKeDZQg2g4g9gMQg6gMgzAdQhzBCgLDBQBBiZBIgvQBNgzB9AsQAEACAAgCQAAgCAHABgAqdBuIAAnsIDmHEQgegMgsgBQhXgChFA3gAoEDzQA0g3BdgRQBagQBeAaQBkAbBFBBQBMBIASBpQhfiYibg1QiYg0i+Ayg"],[86.28,98.01,"black","black",[1,1,1],"AJSh/QgEADgHgDQgFgBgBAFQgNBXhNA9QhTBEhagZQgGgCgPAFQgUAHgEAAQCNAeBchOQBGg7AWhigApRhnQAFABAIAAQAGABAAAAQBFBsCVA7QCpBDCrgzQACAAAHAJQAEAFAFAJQjAAzitg/Qing9g/iHg"],[96.95,97.3,"#0C0436",0,0,"AlZBJQgVgVAAgeQAAgcAVgVQAVgVAeAAQAdAAAVAVQAVAVAAAcQAAAegVAVQgVAVgdAAQgeAAgVgVgAD1AcQgVgVAAgdQAAgdAVgVQAVgVAeAAQAdAAAVAVQAVAVAAAdQAAAdgVAVQgVAVgdAAQgeAAgVgVg"],[96.88,97.2,"#EA9424",0,0,"AlpBYQgbgbAAgnQAAglAbgbQAbgbAnAAQAmAAAbAbQAbAbAAAlQAAAngbAbQgbAbgmAAQgnAAgbgbgADnArQgbgbAAgmQAAgmAbgbQAbgbAmAAQAnAAAbAbQAbAbAAAmQAAAmgbAbQgbAbgnAAQgmAAgbgbg"],[96.88,97.2,"#AFCE3A",0,0,"AlzBiQgggfAAgtQAAgrAggfQAfggAtAAQAsAAAgAgQAfAfAAArQAAAtgfAfQggAggsAAQgtAAgfgggADcA1QgfgfAAgsQAAgsAfgfQAgggAsAAQAtAAAfAgQAgAfAAAsQAAAsggAfQgfAggtAAQgsAAggggg"],[78.5,64.1,0,"black",[1,1,1],"AHAhCIgNmIIBfGpQgOgQgSgMQgjgXgPASgAKeDQQg2g4g9gMQg6gMgzAdQhzBCgLDBQCqAvBlhgQBJhFAGhagAoADiQAlgiBTgOQBYgOBaARQDrAsA0DTQjAAziog/Qihg+hAiIgAqdBlIAAnsIDmHEQgegMgsgBQhXgChFA3g"],[86.375,93.9,"#EACE35",0,0,"AltB+Qiig9g/iIQAkghBTgOQBZgPBaARQDrAtA0DRQhWAXhSAAQhkAAhcgjgADxB2QALjABzhBQAzgeA6AMQA9ANA2A4QgGBYhJBGQhEBAhiAAQgxAAg4gQg"],[73.45,154.83,"black","black",[2,1,1],"AkjjDIByAMQB/ANBEAFQB/AICXgSIgKFzQj4hflLiNQgDgBAFiag"],[79.42,123.62,"#A7A7A7","black",[2,1,1],"AEBpxIgBgBQAYiNAeiQQA8kgAfgMQAggNBLEqQAlCVAfCXIAXARQAbAXAZAcQBQBZAZBnQAZBngUB+QgKA/gPArQgeASgrAWQhYAuhFAXQg8AUh0AWIhoASIAAQzItygCQAvhKA1hoQBqjRAjiXQAri/AOjLIAFimQgegHhTgeQhEgZhgg/IhTg7QgekPgQkUQggonBEgWQBFgWCbEtQAkBGA3B9QAbA9AYA3QASAqAQAmIgjhQIABAAIJmgYIBUACIBQAK"]],vt=new e.Container(157.5,246);e.loop(lt,function(xt){var wt=new e.Shape().f(xt[2]).s(xt[3]).ss(xt[4]?xt[4][0]:null,xt[4]?xt[4][1]:null,xt[4]?xt[4][2]:null).p(xt[5]);wt.setTransform(xt[0],xt[1]),wt.addTo(vt)},!0);var rt=new e.Container;return vt.sca(De/246).addTo(rt).mov(0,-.4),D&&rt.cache(),rt.mouseChildren=!1,rt}},e.extend(e.Frame,$e.EventDispatcher,null,"cjsEventDispatcher",!1),e.Queue=function(){this.cjsEventDispatcher_constructor(),this.type="Queue",this.isLoading=!0},e.extend(e.Queue,$e.EventDispatcher,null,"cjsEventDispatcher"),e.Pic=function(t,r,i,o,l,f,h){var p="file, width, height, noCors, style, group, inherit",_;if(_=mt(e.Pic,arguments,p,this))return _;qe("83.03"),this.group=f;var b=l===!1?{}:e.getStyle("Pic",this.group,h);if(n(t)&&(t=b.file!=null?b.file:null),n(o)&&(o=b.noCors!=null?b.noCors:!1),n(t)){Ct&&ht("ZIM Pic - needs a file");return}this.zimContainer_constructor(r,i);var w=this,C=t;t=w.file=e.Pick.choose(t),r&&i?this.type="ACWD":this.type="AC";var O=o?e.image(t):e.asset(t);w.mouseChildren=!1,O.type=="Bitmap"||O.type=="Image"?(O.type=="Bitmap"?w.bitmap=O.clone().addTo(w):w.bitmap=O.getChildAt(0).clone().addTo(w),w.id=O.id,w.image=w.bitmap.image,w.src=w.bitmap.src,w.item=w.bitmap.item,w.setBounds(null),w.type="Pic",setTimeout(function(){w.dispatchEvent("ready"),w.dispatchEvent("complete")},20)):O.on("complete",function(){if(w.bitmap=O.getChildAt(0).clone().addTo(w),w.id=O.id,w.setBounds(null),w.type="Pic",w.commands)for(var P=0;P<w.commands.length;P++)w.commands[P][2]?w[w.commands[P][0]].apply(w,w.commands[P][1]):e[w.commands[P][0]].apply(w,w.commands[P][1]);w.image=w.bitmap.image,w.src=w.bitmap.src,w.item=w.bitmap.item,w.commands=null,w.dispatchEvent("ready"),w.dispatchEvent("complete"),w.stage&&w.stage.update()}),w.keyOut=function(P,A,R){return w.type=="AC"&&le.zdf?(le.zdf.ac("keyOut",arguments,w),w):(w.bitmap&&w.bitmap.keyOut(P,A,R),w.stage&&w.stage.update(),w)},l!==!1&&e.styleTransforms(this,b),w.clone=function(P){return this.cloneProps(new e.Pic(P?t:C,r,i,o,l,this.group,h))}},e.extend(e.Pic,e.Container,["clone"],"zimContainer",!1),e.Aud=function(t,r,i,o,l,f,h,p,_,b,w,C){var O="file, volume, loop, loopCount, pan, offset, delay, interrupt, maxNum, style, group, inherit",P;if(P=mt(e.Aud,arguments,O,this))return P;qe("83.05"),this.cjsEventDispatcher_constructor(),this.type="Aud",this.group=w;var A=b===!1?{}:e.getStyle(this.type,this.group,C);if(n(t)&&(t=A.file!=null?A.file:null),n(t)){Ct&&ht("ZIM Sound - needs a file");return}n(r)&&(r=A.volume!=null?A.volume:1),n(i)&&(i=A.loop!=null?A.loop:!1),n(o)&&(o=A.loopCount!=null?A.loopCount:null),n(l)&&(l=A.pan!=null?A.pan:0),n(f)&&(f=A.offset!=null?A.offset:0),n(h)&&(h=A.delay!=null?A.delay:0),n(p)&&(p=A.interrupt!=null?A.interrupt:"none"),n(_)&&(_=A.maxNum!=null?A.maxNum:null);var R=this;t=R.file=e.Pick.choose(t);var T=R.sound=e.asset(t,null,null,_);T.type=="AC"?T.on("complete",function(){R.src=T.src,R.item=T.item,R.dispatchEvent("ready"),R.dispatchEvent("complete")}):setTimeout(function(){R.src=T.src,R.item=T.item,R.dispatchEvent("ready"),R.dispatchEvent("complete")},20),R.volume=r,R.loop=i,R.loopCount=o,R.pan=l,R.offset=f,R.delay=h,R.interrupt=p,R.maxNum=_,R.play=function(L,S,E,k,X,q,V){var I="volume, loop, loopCount, pan, offset, delay, interrupt",te;return(te=mt(R.play,arguments,I))?te:(n(L)&&(L=R.volume),n(S)&&(S=R.loop),n(E)&&(E=R.loopCount),n(k)&&(k=R.pan),n(X)&&(X=R.offset),n(q)&&(q=R.delay),n(V)&&(V=R.interrupt),R.sound.play(L,S,E,k,X,q,V))},R.dispose=function(){return R.sound&&R.sound.dispose(),R.sound=null,!0}},e.extend(e.Aud,$e.EventDispatcher,null,"cjsEventDispatcher"),e.Vid=function(t,r,i,o,l,f,h,p,_,b,w,C){var O="file, width, height, scaling, volume, loop, align, valign, type, style, group, inherit",P;if(P=mt(e.Vid,arguments,O,this))return P;qe("83.07"),this.group=w;var A=b===!1?{}:e.getStyle("Vid",this.group,C);if(n(t)&&(t=A.file!=null?A.file:null),n(t)){Ct&&ht("ZIM Vid - needs a file");return}n(r)&&(r=A.width!=null?A.width:null),n(i)&&(i=A.height!=null?A.height:null),n(o)&&(o="fit"),n(f)&&(f=A.loop!=null?A.loop:!1),n(l)&&(l=A.volume!=null?A.volume:1),n(h)&&(h=A.align!=null?A.align:"center"),n(p)&&(p=A.valign!=null?A.valign:"center"),n(_)&&(_=A.type!=null?A.type:"video/mp4"),this.zimContainer_constructor(r,i),r&&i?this.type="ACWD":this.type="AC";var R=this,T,L=t;t=e.Pick.choose(t),R.file=t,le.PATH!=null&&(e.PATH=le.PATH);var S="";t.split("/").length==1&&e.PATH&&(S=e.PATH),this.mouseChildren=!1;var E=R.source=document.createElement("video");document.body.appendChild(E),E.style.display="none",E.setAttribute("autoplay","autoplay"),E.setAttribute("playsinline","playsinline"),E.setAttribute("crossorigin","anonymous"),f&&E.setAttribute("loop","loop");var k=R.innerSource=document.createElement("source");t.split("?").length==1&&(t+="?playsinline=1"),k.setAttribute("src",S+t),k.setAttribute("type",_),E.appendChild(k),q();var X=0;function q(){X++>5&&R.dispatchEvent("error"),E.addEventListener("stalled",q),E.addEventListener("error",q),E.addEventListener("canplay",V)}function V(){R.type="Vid",E.removeEventListener("stalled",q),E.removeEventListener("error",q),E.removeEventListener("canplay",V),E.pause();var I=E.videoWidth,te=E.videoHeight;if(R.setBounds(0,0,r||I,i||te),T=R.bitmap=new e.Bitmap(E,I,te).addTo(R),T.setBounds(0,0,I,te),T.scaleTo(R,100,100,o).pos(0,0,h,p,R),R.commands)for(var B=0;B<R.commands.length;B++)R.commands[B][2]?R[R.commands[B][0]].apply(R,R.commands[B][1]):e[R.commands[B][0]].apply(R,R.commands[B][1]);R.commands=null,R.dispatchEvent("ready")}R.videoPaused=!0,R.play=function(){if(!T){Ct&&ht("ZIM Vid - no file found");return}if(E.play(),E.volume=l,R.videoPaused=!1,!R.ticker)if(R.keyObj){var I=R.keyObj.color,te=R.keyObj.tolerance,B=R.keyObj.replacement;R.ticker=e.Ticker.add(function(){T.keyOut(I,te,B)})}else R.ticker=e.Ticker.add(function(){});return R},R.keyOut=function(I,te,B){return R.ticker?(e.Ticker.remove(R.ticker),R.ticker=e.Ticker.add(function(){T.keyOut(I,te,B)})):R.keyObj={color:I,tolerance:te,replacement:B},R},R.pause=function(I){return n(I)&&(I=!0),R.videoPaused=I,I?(E.pause(),R.ticker&&e.Ticker.remove(R.ticker)):(R.ticker&&e.Ticker.add(R.ticker),E.play()),R},Object.defineProperty(this,"duration",{get:function(){return E.duration},set:function(){}}),Object.defineProperty(this,"currentTime",{get:function(){return E.currentTime},set:function(I){E.currentTime=I}}),Object.defineProperty(this,"volume",{get:function(){return E.volume},set:function(I){l=I,E.volume=I}}),b!==!1&&e.styleTransforms(this,A),R.clone=function(I){return this.cloneProps(new e.Vid(I?t:L,r,i,o,l,f,h,p,_,b,this.group,C))},R.dispose=function(I,te,B){this.ticker&&e.Ticker.remove(this.ticker);var Z=R.stage;return R.bitmap.dispose(),T=R.bitmap=null,E.pause(),E.removeAttribute("src"),E.load(),E.remove(),E=null,B||this.zimContainer_dispose(!0),Z&&Z.update(),!0}},e.extend(e.Vid,e.Container,["clone","dispose"],"zimContainer",!1),e.SVG=function(t,r,i,o,l,f,h,p,_,b,w){var C="svg, width, height, bitmap, splitTypes, geometric, showControls, interactive, style, group, inherit",O;if(O=mt(e.SVG,arguments,C,this))return O;qe("83.09"),this.group=b;var P=_===!1?{}:e.getStyle("SVG",this.group,w);if(n(t)&&(t=P.svg!=null?P.svg:null),n(t)){Ct&&ht("ZIM SVG - needs a svg value");return}n(o)&&(o=P.bitmap!=null?P.bitmap:!0),n(l)&&(l=P.splitTypes!=null?P.splitTypes:!1),n(f)&&(f=P.geometric!=null?P.geometric:!0),n(h)&&(h=P.showControls!=null?P.showControls:!0),n(p)&&(p=P.interactive!=null?P.interactive:!0),this.zimContainer_constructor(r,i);var A=this;o&&(this.mouseChildren=!1);var R=t;t=e.Pick.choose(t),r&&i?this.type="ACWD":this.type="AC";var T=e.assets[t];if(T&&(A.src=T.src,A.file=T.file,A.item=T.item,A.svg=T.svg),T&&T.type=="Bitmap")A.type="SVG",A.bitmap=T.clone(),S();else if(T&&T.type=="AC")T.on("complete",function(){A.type="SVG",A.bitmap=T.bitmap.clone(),S(n(r)&&n(i))});else if(T&&T.type=="ACWB")n(r)&&n(i)&&A.setBounds(0,0,T.width,T.height),T.on("complete",function(){A.type="SVG",A.bitmap=T.bitmap.clone(),S()});else if(T&&T.type=="SVG")A.type="SVG",T.bitmap?A.bitmap=T.bitmap.clone():A.bitmap=T.clone(),S();else if(t&&t.match(/<svg/i)&&(A.svg=t),A.svg&&A.svg.match(/<svg/i))A.type="SVG",S();else{var L=e.asset(t);L.on("complete",function(){A.type="SVG",L.bitmap&&(A.src=L.bitmap.src,A.file=L.bitmap.file,A.item=L.bitmap.item,A.svg=L.bitmap.svg,A.bitmap=L.bitmap.clone()),S(n(r)&&n(i))})}function S(k){if(o)A.bitmap?(A.svg=A.bitmap.svg,A.bitmap.addTo(A),k&&E(),setTimeout(function(){A.dispatchEvent("ready"),A.dispatchEvent("complete")},20)):e.svgToBitmap(A.svg,function(V){A.bitmap=V,A.bitmap.addTo(A),E(),A.dispatchEvent("ready"),A.dispatchEvent("complete"),A.stage&&A.stage.update()});else if(A.bitmap&&(A.svg=A.bitmap.svg),t.match(/<svg/i)||T&&T.type=="SVG"||k){var X=new e.SVGContainer(A.svg);X.loop(function(V){V&&V.addTo(A)},!0),k&&E(),setTimeout(function(){A.dispatchEvent("ready"),A.dispatchEvent("complete")},20)}else{var q=e.asset(t);q.on("complete",function(){var V=new e.SVGContainer(q);V.loop(function(I){I&&I.addTo(A)},!0),E(),A.dispatchEvent("ready"),A.dispatchEvent("complete"),A.stage&&A.stage.update()})}}function E(){if(n(r)&&n(i)&&A.setBounds(null),A.type="SVG",A.commands)for(var k=0;k<A.commands.length;k++)A.commands[k][2]?A[A.commands[k][0]].apply(A,A.commands[k][1]):e[A.commands[k][0]].apply(A,A.commands[k][1]);A.commands=null}A.keyOut=function(k,X,q){return A.type=="AC"&&le.zdf?(le.zdf.ac("keyOut",arguments,A),A):(A.bitmap&&A.bitmap.keyOut(k,X,q),A.stage&&A.stage.update(),A)},_!==!1&&e.styleTransforms(this,P),A.clone=function(k){return this.cloneProps(new e.SVG(k?t:R,r,i,o,l,f,h,p,_,this.group,w))}},e.extend(e.SVG,e.Container,["clone"],"zimContainer",!1),e.SensorAsk=function(t,r,i,o,l,f,h){var p="callback, sensorType, color, backgroundColor, style, group, inherit",_;if(_=mt(e.SensorAsk,arguments,p,this))return _;qe("83.01"),this.group=f;var b=l===!1?{}:e.getStyle("SensorAsk",this.group,h);if(n(r)&&(r=b.sensorType!=null?b.sensorType:"deviceorientation"),r!="devicemotion"&&(r="deviceorientation"),this.sensorType=r,!n(t)){n(i)&&(i=b.color!=null?b.color:e.dark),n(o)&&(o=b.backgroundColor!=null?b.backgroundColor:e.lighter),this.zimPane_constructor("",o,i,200,200,!1,null,!0,100,black.toAlpha(.3),null,null,null,!1,!1),this.type="SensorAsk";var w=this;if(Style.addGroup("sensorAsk",{width:100,color:i,rollColor:o,corner:10,backgroundColor:e.faint,rollBackgroundColor:i,borderColor:i,borderWidth:2}),w.yes=new e.Button({label:"YES",group:"sensorAsk"}).sca(.65).pos(0,30,CENTER,TOP,this).tap(function(){w.hide(!0);var O=DeviceMotionEvent;r!="devicemotion"&&(O=DeviceOrientationEvent),O.requestPermission().then(function(P){P!="denied"?t(!0):t(!1)})}),w.label=new e.Label("Use sensor?",null,null,i,null,null,null,"center").sca(.9).centerReg(this),w.no=new e.Button({label:"NO",group:"sensorAsk"}).sca(.65).pos(0,30,CENTER,BOTTOM,this).tap(function(){w.hide(!1),t(!1)}),new e.Circle(110,e.clear,i,1).center(this).alp(.8),new e.Circle(120,e.clear,i,1).center(this).alp(.5),new e.Circle(130,e.clear,i,1).center(this).alp(.2),l!==!1&&e.styleTransforms(this,b),typeof DeviceOrientationEvent<"u"&&DeviceOrientationEvent&&typeof DeviceOrientationEvent.requestPermission=="function")w.show();else{let O=function(P){r=="deviceorientation"?P.alpha==null||P.alpha==0&&P.beta==0&&P.gamma==0?t(!1):t(!0):!P.acceleration||P.acceleration.x==null||P.acceleration.x==0&&P.acceleration.y==0&&P.acceleration.z==0?t(!1):t(!0),C=!0,le.removeEventListener(r,O)};var C=!1;le.addEventListener(r,O),setTimeout(function(){C||t(!1)},100)}}},e.extend(e.SensorAsk,e.Pane,null,"zimPane",!1),e.colorsHex=["#fb4758","#f58e25","#ebcb35","#acd241","#50c4b7","#993399","#e472c4","#d1a170","#112233","#000000","#111111","#222222","#333333","#444444","#555555","#555555","#666666","#777777","#888888","#999999","#aaaaaa","#bbbbbb","#cccccc","#dddddd","#eeeeee","#ffffff","rgba(0,0,0,.01)","rgba(0,0,0,0)"],e.colors=["red","orange","yellow","green","blue","purple","pink","brown","interstellar","black","darker","licorice","dark","charcoal","grey","gray","granite","tin","pewter","silver","fog","mist","light","moon","lighter","white","faint","clear"],dn=0;dn<e.colors.length;dn++)e[e.colors[dn]]=e.colorsHex[dn];return String.prototype.darken=function(t){return e.darken(this,t)},String.prototype.lighten=function(t){return e.lighten(this,t)},String.prototype.toColor=function(t,r){return e.toColor(this,t,r)},String.prototype.toAlpha=function(t){return e.toAlpha(this,t)},e.FIT="fit",e.FILL="fill",e.FULL="full",e.LEFT="left",e.RIGHT="right",e.CENTER="center",e.MIDDLE="middle",e.START="start",e.END="end",e.TOP="top",e.BOTTOM="bottom",e.OVER="over",e.UNDER="under",e.HORIZONTAL="horizontal",e.VERTICAL="vertical",e.BOTH="both",e.RADIAL="radial",e.UP="up",e.DOWN="down",e.NEXT="next",e.PREV="prev",e.AUTO="auto",e.AVE="ave",e.DEFAULT="default",e.ALL="all",e.NONE="none",e.GET="get",e.POST="post",e.LOCALSTORAGE="localStorage",e.SOCKET="socket",e.TO="to",e.FROM="from",e.SINE="sine",e.SQUARE="square",e.TRIANGLE="triangle",e.SAW="saw",e.SAWTOOTH="saw",e.ZAP="zap",e.DISTILL=!1,e.distillery=[],e.distill=function(){!le.zns&&e&&(e.DISTILL||le.DISTILL)&&e.distillery.push("83.3","83.35");function t(r,i,o){return o.indexOf(r)===i}e.distillery.length>0?(e.distillery=e.distillery.filter(t),ht("zim.distill() - go to https://zimjs.com/distill and enter the following:"),Hn(e.distillery.join(" "))):ht("must set zim.DISTILL = true;")},e.parseAudioSprite=function(t,r){if(qe("83.25"),!(n(t)||n(t.resources)||n(t.spritemap))){var i=t,o=i.resources[0],l=i.spritemap,f=[],h,p={src:o,data:{}};for(var _ in l)h=l[_],f.push({id:_,startTime:Math.round(h.start*1e3),duration:Math.round((h.end-h.start)*1e3)});return p.data.audioSprite=f,r&&ht(JSON.stringify(p)),p}},e.previewAudioSprite=function(t,r,i){if(qe("83.26"),!n(t)){if(n(r)&&(r=3),typeof i>"u"){if(n(le.zdf))return;var i=le.zdf}var o=i.width,l=t,f=[],h=[];if(l.constructor=={}.constructor)l.resources&&(l=e.parseAudioSprite(l)),l.audioSprite?e.loop(l.audioSprite,function(_){f.push(_[0].substr(0,r)),h.push(_[0])}):l.data&&l.data.audioSprite&&e.loop(l.data.audioSprite,function(_){f.push(_.id.substr(0,r)),h.push(_.id)});else return;var p=new e.Tabs({tabs:f,width:o,currentEnabled:!0}).addTo();return p.on("change",function(){i.asset(h[p.selectedIndex]).play()}),p}},e.svgToBitmap=function(t,r,i,o,l){if(qe("83.27"),!n(t.draggable)){var f=new DOMParser;t=t.innerHTML?f.parseFromString(t.innerHTML,"text/xml"):t;var h=t.getElementsByTagName("svg"),p=h?t.getElementsByTagName("svg")[0]:null;t=p}if(!XMLSerializer&&Ct){ht("ZIM svgToBitmap() - sorry, not supported in Browser");return}var _=typeof t=="string"?t:new XMLSerializer().serializeToString(t);if(_){var b=_.split(">")[0];if(b.length>1){var w=b.split(/width/i);if(w.length==1){var C=100,O=100,P=b.split(/viewBox/i);if(P.length>1){var A=P[1].split('"')[1];if(A){var R=A.split(" ");R.length>1&&(C=R[R.length-2],O=R[R.length-1])}}_=_.replace(/svg /i,'svg  width="'+C+'" height="'+O+'" ')}}_.match(/xmlns/i)||(_=_.replace(/svg /i,"svg  xmlns='http://www.w3.org/2000/svg' "))}var T=self.URL||self.webkitURL||self,L=new Image;L.onload=function(){var E=new e.Bitmap(L,i,o);r(E,l),T.revokeObjectURL(S)};var S=T.createObjectURL(new document.Blob([_],{type:"image/svg+xml"}));L.src=S},e.makeContent=function(t,r,i){qe("83.29");var o;if(n(i)&&(i=e.dark),typeof t=="string"||typeof t=="number")t=this.message=new e.Label(t,null,null,i);else if(t.constructor=={}.constructor){var l=t;l.buttonScale||(l.buttonScale=.5),n(l.spacingH)&&(l.spacingH=20*l.buttonScale),n(l.spacingV)&&(l.spacingV=20);var f=l.spacingH,h=l.spacingV;l.align||(l.align="center"),t=new e.Container;var p=new ii(10,h).addTo(t);if(l.header&&l.header.pos(0,h,"left","top",t),l.message)var _=new e.Label(l.message,null,null,n(l.color)?i:l.color).loc(0,t.height+(l.header?h:0),t);if(l.display&&l.display.pos(0,-l.display.height-(l.header||l.message?h:0),"left","bottom",t),l.buttons){Array.isArray(l.buttons)||(l.buttons=[l.buttons]);for(var b=l.length*100,w=new e.Container().loc(0,t.height+(l.header||l.message||l.display?h:0),t),C=0;C<l.buttons.length;C++){var O=l.buttons[C],P=O.call||function(){};O.button||(O.button=new e.Button({width:O.width,label:O.label,backgroundColor:O.backgroundColor||O.bgColor,color:O.color,rollBackgroundColor:O.rollBackgroundColor||O.rollBgColor,rollColor:O.rollColor})),O.button.call=P,O.button.sca(l.buttonScale).loc(C==0?0:w.width+f,0,w).tap(function(R){R.target.call(R.target)})}}for(o=0;o<t.numChildren;o++){var A=t.getChildAt(o);A.lastY=A.y,l.align=="center"?A.center(t).loc(null,A.lastY):l.align=="right"&&A.pos(0,null,"right")}if(r&&typeof r=="number"&&(t.width=Math.min(t.width,r-f*2-(l.scrollBar===!0?12:l.scrollBar>0?l.scrollBar:0))),new e.Container(10,h).pos(0,-p.height,"center","bottom",t).bot(),p.top(),t.config=l,t.header=l.header,t.message=_,t.text=l.message,t.display=l.display,l.buttons)for(t.buttons=[],o=0;o<w.numChildren;o++)t.buttons.push(w.getChildAt(o))}return t},e}(Se||{});function qe(e){Se&&(Se.DISTILL||le.DISTILL)&&Se.distillery.push(e)}function Wn(e,v,a,u,c,x){if(qe("83.3"),e&&e.noDrag)return e;x!==!0&&(x=null);var N={drag:function(ke,t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T){return pn(arguments)?(arguments[0].obj=this,Se.drag(arguments[0])):Se.drag(this,ke,t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T)},noDrag:function(ke){return Se.noDrag(this,ke)},mouse:function(){return Se.mouse(this)},noMouse:function(){return Se.noMouse(this)},effect:function(ke,t,r,i,o){return Se.effect(this,ke,t,r,i,o)},noEffect:function(ke,t){return Se.noEffect(this,ke,t)},updateEffects:function(ke){return Se.updateEffects(this,ke)},wire:function(ke,t,r,i,o,l,f){return pn(arguments)?(arguments[0].source=this,Se.wire(arguments[0])):Se.wire(this,ke,t,r,i,o,l,f)},noWire:function(ke,t,r){return pn(arguments)?(arguments[0].source=this,Se.noWire(arguments[0])):Se.noWire(this,ke,t,r)},wired:function(ke,t,r,i,o,l,f){return pn(arguments)?(arguments[0].target=this,Se.wired(arguments[0])):Se.wired(this,ke,t,r,i,o,l,f)},noWired:function(ke,t,r){return pn(arguments)?(arguments[0].target=this,Se.noWired(arguments[0])):Se.noWired(this,ke,t,r)},bind:function(ke,t,r,i,o){return pn(arguments)?(arguments[0].obj=this,Se.bind(arguments[0])):Se.bind(this,ke,t,r,i,o)},noBind:function(ke,t,r,i){return pn(arguments)?(arguments[0].obj=this,Se.noBind(arguments[0])):Se.noBind(this,ke,t,r,i)},dragBoundary:function(ke){return Se.dragBoundary(this,ke)},dragRect:function(ke){return Se.dragBoundary(this,ke)},transform:function(ke,t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B,Z){return pn(arguments)?(arguments[0].obj=this,Se.transform(arguments[0])):Se.transform(this,ke,t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B,Z)},setSwipe:function(ke){return Se.setSwipe(this,ke)},gesture:function(ke,t,r,i,o,l,f,h,p,_,b,w,C,O,P){return pn(arguments)?(arguments[0].obj=this,Se.gesture(arguments[0])):Se.gesture(this,ke,t,r,i,o,l,f,h,p,_,b,w,C,O,P)},noGesture:function(ke,t,r){return pn(arguments)?(arguments[0].obj=this,Se.noGesture(arguments[0])):Se.noGesture(this,ke,t,r)},gestureBoundary:function(ke,t){return Se.gestureBoundary(this,ke,t)},gestureRect:function(ke,t){return Se.gestureBoundary(this,ke,t)},addPhysics:function(ke,t,r,i,o,l,f,h,p,_,b){return pn(arguments)?(arguments[0].obj=this,Se.addPhysics(arguments[0])):Se.addPhysics(this,ke,t,r,i,o,l,f,h,p,_,b)},removePhysics:function(){return Se.removePhysics(this)},hitTestPoint:function(ke,t,r){return Se.hitTestPoint(this,ke,t,r)},hitTestReg:function(ke,t){return Se.hitTestReg(this,ke,t)},hitTestRect:function(ke,t,r,i){return Se.hitTestRect(this,ke,t,r,i)},hitTestCircle:function(ke,t,r,i){return Se.hitTestCircle(this,ke,t,r,i)},hitTestCircleRect:function(ke,t){return Se.hitTestCircleRect(this,ke,t)},hitTestCircles:function(ke,t){return Se.hitTestCircles(this,ke,t)},hitTestBounds:function(ke,t,r){return Se.hitTestBounds(this,ke,t,r)},boundsToGlobal:function(ke,t,r,i){return Se.boundsToGlobal(this,ke,t,r,i)},resetBounds:function(ke,t,r,i,o){return pn(arguments)?(arguments[0].obj=this,Se.resetBounds(arguments[0])):Se.resetBounds(this,ke,t,r,i,o)},hitTestPath:function(ke,t,r,i,o){return Se.hitTestPath(this,ke,t,r,i,o)},hitTestGrid:function(ke,t,r,i,o,l,f,h,p,_,b,w){return Se.hitTestGrid(this,ke,t,r,i,o,l,f,h,p,_,b,w)},animate:function(ke,t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B,Z,U,ee,ae,re,he,j,G,y,g,d,D,K,m,F,Ce,Y,Q,ce,pe,J,ue,ye,Xe,se,Ae,ie,_e,$){return ke&&(ke.props||ke.obj)&&pn(arguments)?(arguments[0].target=this,Se.animate(arguments[0])):Se.animate(this,ke,t,r,i,o,l,f,h,p,_,b,w,C,O,P,A,R,T,L,S,E,k,X,q,V,I,te,B,Z,U,ee,ae,re,he,j,G,y,g,d,D,K,m,F,Ce,Y,Q,ce,pe,J,ue,ye,Xe,se,Ae,ie,_e,$)},pauseAnimate:function(){return this},stopAnimate:function(){return this},wiggle:function(ke,t,r,i,o,l,f,h,p,_,b,w,C,O,P){return pn(arguments)?(arguments[0].target=this,Se.wiggle(arguments[0])):Se.wiggle(this,ke,t,r,i,o,l,f,h,p,_,b,w,C,O,P)},loop:function(ke,t,r,i,o,l,f,h){return Se.loop(this,ke,t,r,i,o,l,f,h)},copyMatrix:function(ke){return Se.copyMatrix(this,ke)},duplicate:function(ke){return Se.duplicate(this,ke)},cur:function(ke){return Se.cur(this,ke)},sha:function(ke,t,r,i){return Se.sha(this,ke,t,r,i)},pos:function(ke,t,r,i,o,l,f,h,p,_){return pn(arguments)?(arguments[0].obj=this,Se.pos(arguments[0])):Se.pos(this,ke,t,r,i,o,l,f,h,p,_)},loc:function(ke,t,r,i,o,l,f){return pn(arguments)?(arguments[0].obj=this,Se.loc(arguments[0])):Se.loc(this,ke,t,r,i,o,l,f)},mov:function(ke,t){return pn(arguments)?(arguments[0].obj=this,Se.mov(arguments[0])):Se.mov(this,ke,t)},top:function(){return Se.top(this)},bot:function(){return Se.bot(this)},ord:function(ke){return Se.ord(this,ke)},dep:function(ke){return Se.dep(this,ke)},nam:function(ke){return Se.nam(this,ke)},alp:function(ke){return Se.alp(this,ke)},vis:function(ke){return Se.vis(this,ke)},ble:function(ke){return Se.ble(this,ke)},dye:function(ke){return Se.dye(this,ke)},hov:function(ke,t){return Se.hov(this,ke,t)},rot:function(ke,t,r){return Se.rot(this,ke,t,r)},siz:function(ke,t,r){return Se.siz(this,ke,t,r)},ske:function(ke,t){return Se.ske(this,ke,t)},reg:function(ke,t,r){return Se.reg(this,ke,t,r)},sca:function(ke,t){return Se.sca(this,ke,t)},scaleTo:function(ke,t,r,i,o){return pn(arguments)?(arguments[0].obj=this,Se.scaleTo(arguments[0])):Se.scaleTo(this,ke,t,r,i,o)},fit:function(ke,t,r,i,o){return pn(arguments)?(arguments[0].obj=this,Se.fit(arguments[0])):Se.fit(this,ke,t,r,i,o)},outline:function(ke,t,r){return pn(arguments)?(arguments[0].obj=this,Se.outline(arguments[0])):Se.outline(this,ke,t,r)},blendmodes:function(ke){return Se.blendmodes(this,ke)},addTo:function(ke,t,r){return pn(arguments)?(arguments[0].obj=this,Se.addTo(arguments[0])):Se.addTo(this,ke,t,r)},removeFrom:function(ke){return Se.removeFrom(this,ke)},added:function(ke,t,r){return Se.added(this,ke,t,r)},movement:function(ke,t){return Se.movement(this,ke,t)},noMovement:function(){return Se.noMovement(this)},tap:function(ke,t,r,i,o,l,f,h,p){return pn(arguments)?(arguments[0].obj=this,Se.tap(arguments[0])):Se.tap(this,ke,t,r,i,o,l,f,h,p)},noTap:function(){return Se.noTap(this)},hold:function(ke,t,r,i){return Se.hold(this,ke,t,r,i)},noHold:function(){return Se.noHold(this)},change:function(ke,t){return Se.change(this,ke,t)},noChange:function(){return Se.noChange(this)},centerReg:function(ke,t,r){return pn(arguments)?(arguments[0].obj=this,Se.centerReg(arguments[0])):Se.centerReg(this,ke,t,r)},center:function(ke,t,r){return pn(arguments)?(arguments[0].obj=this,Se.center(arguments[0])):Se.center(this,ke,t,r)},place:function(ke){return Se.place(this,ke)},placeReg:function(ke){return Se.placeReg(this,ke)},expand:function(ke,t,r,i){return pn(arguments)?(arguments[0].obj=this,Se.expand(arguments[0])):Se.expand(this,ke,t,r,i)},setMask:function(ke,t){return Se.setMask(this,ke,t)},cloneProps:function(ke){return ke.type=this.type,ke.group=this.group,ke.style=this.style,ke.alpha=this.alpha,ke.rotation=this.rotation,ke.mouseEnabled=this.mouseEnabled,ke.mouseChildren=this.mouseChildren,ke.tickEnabled=this.tickEnabled,ke.x=this.x,ke.y=this.y,ke.scaleX=this.scaleX,ke.scaleY=this.scaleY,ke.skewX=this.skewX,ke.skewY=this.skewY,ke.name&&(ke.name=this.name),ke.regX=this.regX*ke.width/(this.width||1),ke.regY=this.regY*ke.height/(this.height||1),ke.visible=this.visible,ke.shadow=this.shadow,(!this.type||this.type=="Shape")&&Se.copyMatrix(ke,this),ke.compositeOperation=this.compositeOperation,ke.snapToPixel=this.snapToPixel,this.filters&&this.filters.length>0&&(ke.filters=this.filters.slice(0),ke.cache()),ke.mask=this.mask,ke.hitArea=this.hitArea,(!this.type||this.type=="Shape"||this.type=="Blob"||this.type=="Squiggle")&&this._bounds&&ke.setBounds(this._bounds.x,this._bounds.y,this._bounds.width,this._bounds.height),ke},cloneChildren:function(ke,t){ke.children.length&&ke.removeAllChildren();for(var r=ke.children,i=0,o=this.children.length;i<o;i++){var l=this.children[i].clone(t);l.parent=ke,r.push(l)}return ke}};if(!n(x)){x=[];for(var z in N)x.push(z);return x}for(var oe in N)Object.prototype.hasOwnProperty.call(N,oe)&&(e[oe]=N[oe]);if(Se&&(e.cjsLocalToGlobal=e.localToGlobal,e.cjsGlobalToLocal=e.globalToLocal,e.cjsLocalToLocal=e.localToLocal,e.localToGlobal=function(ke,t){return Se.localToGlobal(ke,t,e,e.cjsLocalToGlobal)},e.globalToLocal=function(ke,t){return Se.globalToLocal(ke,t,e,e.cjsGlobalToLocal)},e.localToLocal=function(ke,t,r){return Se.localToLocal(ke,t,r,e)},e.hueBatch||Se.displayBase(e)),!n(v)&&!n(a)&&!n(u)&&!n(c)?v=v:!n(v)&&!n(a)&&(u=v,c=a,v=0,a=0),!n(v)&&!n(a)&&!n(u)&&!n(c))e.setBounds(v,a,u,c);else if(e.nominalBounds!=null&&e.getBounds&&e.getBounds()==null){var Ee=e.nominalBounds;e.setBounds(Ee.x,Ee.y,Ee.width,Ee.height)}return e.parent&&e.parent.actionFrames&&!e.parent.addPhysics&&Wn(e.parent,zdf?zdf.width:null,zdf?zdf.height:null),e}var Di;function Ri(e){qe("83.35"),document.Window=Window,document.Blob=Blob,Di="ignore",n(e)&&(e=[]),Array.isArray(e)||(e=[e]);var v=Wn(null,null,null,null,null,!0),a=["loop","stopAnimate","pauseAnimate","animate","wiggle","wire","wired"];for(var u in Se)(v.indexOf(u)==-1||a.indexOf(u)>=0)&&e.indexOf(u)==-1&&(window[u]=Se[u])}Se.fastFrame=function(e,v){if(qe("83.355"),$e=e,n(le.zdf))return v.frame=new Se.Frame({shim:{stage:v,canvas:v.canvas}}),le.zimDefaultFrame=le.zdf=v.frame,Se.scaX=$e.stageTransformable?1:v.scaleX,Se.scaY=$e.stageTransformable?1:v.scaleY,v.frame};Se.addWires=function(e){return qe("83.365"),e.wire=function(){return Array.prototype.unshift.call(arguments,e),Se.wire.apply(null,arguments),e},e.noWire=function(){return Array.prototype.unshift.call(arguments,e),Se.noWire.apply(null,arguments),e},e.wired=function(){return Array.prototype.unshift.call(arguments,e),Se.wired.apply(null,arguments),e},e.noWired=function(){return Array.prototype.unshift.call(arguments,e),Se.noWired.apply(null,arguments),e},e};Se.setBlurDetect=function(){qe("83.36"),Se.blurCheck=!0,Se.pauseAnimateOnBlur=!0,Se.pauseOnBlur=[],Se.blurDetect=function(){var e,v,a={hidden:"visibilitychange",webkitHidden:"webkitvisibilitychange",mozHidden:"mozvisibilitychange",msHidden:"msvisibilitychange"};for(e in a)if(e in document){v=a[e];break}return function(u){return u&&document.addEventListener(v,u),!document[e]}}(),Se.blurDetect(function(){var e,v,a;if(Se.blurDetect())setTimeout(function(){if(Se.pauseOnBlur)for(e=0;e<Se.pauseOnBlur.length;e++)v=Se.pauseOnBlur[e],v.pauseOnBlurPaused||v.pause(!1);if(Se.pauseAnimateOnBlur&&Se.animatedObjects){var u=[],c;for(e=0;e<Se.animatedObjects.objects.length;e++){v=Se.animatedObjects.objects[e];var x=Se.copy(v.tweenStates);if(!v.tweenStates)v.pauseAnimate(!1);else if(n(x.all)||x.all){if(v.pauseAnimate(!1),!v.dynamicAnimation)for(a in x)a!="all"&&x[a]===!1&&v.pauseAnimate(!0,a)}else{v.pauseAnimate(!0);for(a in x)a!="all"&&x[a]&&v.pauseAnimate(!1,a)}v.type=="Sprite"&&(v.paused=!0),v.parent&&v.parent.type=="Particles"&&v.parent.emitter&&v.parent.emitter.focusWarm&&(c=v.parent.emitter,u.indexOf(v.parent.emitter)<0&&u.push(v.parent.emitter))}if(u.length>0)for(e=0;e<u.length;e++)u[e].doWarm(u[e].focusWarm)}},300),le.zdf&&le.zdf.dispatchEvent("tabfocus");else{if(Se.pauseOnBlur)for(e=0;e<Se.pauseOnBlur.length;e++)v=Se.pauseOnBlur[e],v.pauseOnBlurPaused=v.paused,v.pause(!0);Se.pauseAnimateOnBlur&&Se.animatedObjects&&Se.pauseAnimate(!0,"pauseOnBlur"),le.zdf&&le.zdf.dispatchEvent("tabblur")}})};var fi=!1;Se=function(e){e.ZIMON={stringify:function(a,u){if(qe("83.39"),n(a))return;if(!fi){Ct&&ht("ZIMON - set ZIMONON=true before using ZIMON.stringify()");return}return a=e.copy(a),c(a),JSON.stringify({obj:a,key:u,zimon:1,info:"https://zimjs.com/zimon/"});function c(x,N,z){if(!n(x))if(Array.isArray(x))e.loop(x,function(Ee,ke){c(Ee,x,ke)});else if(x.constructor=={}.constructor)e.loop(x,function(Ee,ke){c(ke,x,Ee)});else if(x.type){var oe={zimon:x.type};x.arguments&&(oe.args=Array.prototype.slice.call(x.arguments),c(oe.args)),x.type=="series"&&(oe.args=Array.prototype.slice.call(x.array),c(oe.args)),u&&u[x.type]&&u[x.type].props&&(oe.props=[],e.loop(u[x.type].props,function(Ee){oe.props.push(x[Ee])})),N?N[z]=oe:a=oe}else typeof x!="string"&&typeof x!="number"&&typeof x!="boolean"&&x!==null&&Ct&&ht("ZIMON - potentially bad JSON value"+x)}},parse:function(a,u){if(qe("83.39"),n(a))return;var c=JSON.parse(a),x=c.obj;return u=c.key,z(x),x;function N(oe){try{return Function("return("+oe+")")()}catch(Ee){return Ct&&ht("ZIMON - bad function scope or name: "+oe),null}}function z(oe,Ee,ke){if(!n(oe)){if(Array.isArray(oe))e.loop(oe,function(f,h){z(f,oe,h)});else if(n(oe.zimon)&&oe.constructor=={}.constructor)e.loop(oe,function(f,h){z(h,oe,f)});else if(oe.zimon){var t=oe.zimon,r="";u&&(u[t]&&u[t].scope?r=u[t].scope+".":u.scope&&(r=u.scope+"."));var i=N(r+t),o=oe.args;n(o)&&(o=[]),z(o);var l;oe.type=="series"?l=e.series(o):l=i?new(i.bind.apply(i,[null].concat(Array.prototype.slice.call(o)))):null,Ee?Ee[ke]=l:x=l,u&&u[t]&&u[t].props&&l&&e.loop(u[t].props,function(f,h){n(oe.props[h])||(l[f]=oe.props[h])})}}}}},e.Wonder=function(a,u,c,x,N){var z="wid, client, app, notes, server",oe;if(oe=mt(e.Wonder,arguments,z,this))return oe;if(qe("82"),n(a)){ht("zim.Wonder() - please provide Wonder ID (see https://zimjs.com/wonder/)");return}n(N)&&(N="https://wonder.zimjs.org/wonder");var Ee=this;n(e.wonderSession)&&(e.wonderSession="W"+e.rand(1e5,999999));var ke=[],t=setInterval(i,1e3),r=0;function i(){ke.length>0&&(e.async(N+"?wonder="+JSON.stringify(ke)),ke=[],r++)}var o,l=setInterval(function(){r>28&&(ke.push({id:a,c:u,a:c,n:x,k:o,t:"e",v:"frequency max - terminated",s:e.wonderSession}),ht("zim.Wonder() - frequency max - terminated"),Ee.dispose()),r=0},30*1e3);this.countsOff={},this.timesOff={},this.ordersOff={};function f(_,b){return n(_)?(ht("zim.Wonder "+b+" - please provide a keyword"),!1):!Ee[b+"sOff"][_]}this.count=function(_){f(_,"count")&&(o=_,ke.push({id:a,c:u,a:c,n:x,k:_,t:"c",v:1,s:e.wonderSession}))};var h={};this.timeStart=function(_){f(_,"time")&&(Ee.timeEnd(_),o=_,h[_]=new Date().getTime())};var p={};this.timePause=function(_){f(_,"time")&&(p[_]||(p[_]=new Date().getTime()))},this.timeUnpause=function(_){if(f(_,"time")&&p[_]){var b=new Date().getTime()-p[_];h[_]&&(h[_]+=b),delete p[_]}},this.timeEnd=function(_){if(f(_,"time")&&h[_]){var b=p[_]?p[_]:new Date().getTime(),w=Math.round((b-h[_])/1e3);delete p[_],delete h[_],ke.push({id:a,c:u,a:c,n:x,k:_,t:"t",v:w,s:e.wonderSession})}},this.order=function(_,b){if(f(_,"order")){if(o=_,n(b)){ht("zim.Wonder order() - please provide an item");return}ke.push({id:a,c:u,a:c,n:x,k:_,t:"o",v:b,s:e.wonderSession})}},this.countOff=function(_){Ee.countsOff[_]=1},this.countOn=function(_){delete Ee.countOff[_]},this.timeOff=function(_){Ee.timesOff[_]=1},this.timeOn=function(_){delete Ee.timesOff[_]},this.orderOff=function(_){Ee.ordersOff[_]=1},this.orderOn=function(_){delete Ee.ordersOff[_]},this.dispose=function(){return i(),clearInterval(t),clearInterval(l),!0}},e.VERSION="015/zim",e.getLatestVersions=function(a){qe("82.2");var u="https://zimjs.com/live/getLatestVersions.php";function c(x){a(JSON.parse(x))}e.async(u,c,"returnLatestVersions")},typeof $e<"u"&&(e.PWA=function(a,u,c,x,N,z,oe){var Ee="call, label, backgroundColor, color, backdropColor, pane, noScale",ke;if(ke=mt(e.PWA,arguments,Ee,this))return ke;qe("82.4"),this.cjsEventDispatcher_constructor(),this.type="PWA";var t,r=this,i=le.M=="ios"?"In Safari, please add to\nhome screen as an app":"Please add to\nhome screen as an app";if(n(u)&&(u=new e.Label({text:i,align:e.LEFT,lineHeight:44,color:x})),n(c)&&(c=e.yellow),n(z)){z=new e.Pane({width:1200,height:230,content:u,backgroundColor:c,backdropColor:N});var o=new e.Container;new e.Shape().s(e.dark).ss(3,1,0,3).p("AAAj0IAAFJAA8hoIBuAAIAAFdIlTAAIAAldIBuAA").sca(1.7).addTo(o),new e.Shape().s(e.dark).ss(3,1,0,3).p("AhGAlIBGhGIBHBG").sca(1.7).addTo(o).mov(0,-38);var l=new e.Tile([o,u],2,1,40,0,!0);l.width>zdf.stage.width*.7&&(l.width=zdf.stage.width*.7),l.setBounds(-70,-10,480,100),o.mov(-30,35),l.center(z)}M&&!(le.matchMedia("(display-mode: standalone)").matches||le.navigator.standalone||document.referrer.includes("android-app://"))?f():(a&&a.constructor===Function&&a(),setTimeout(function(){r.dispatchEvent("ready")},20));function f(){r.pane=t=z.show(),t.on("close",function(){a&&a.constructor===Function&&a(),r.scaleEvent&&h.off("resize",r.scaleEvent),r.dispatchEvent("ready"),le.zdf.stage.update()});var h=h||le.zdf;h&&!oe&&(t.scaleTo(h.stage,105).center(),(h.scaling=="full"||h.scaling=="tag")&&(r.scaleEvent=h.on("resize",function(){t.scaleTo(h.stage,105).center()})),h.stage.update())}this.show=function(){return f(),this}},e.extend(e.PWA,$e.EventDispatcher,null,"cjsEventDispatcher",!1)),e.QR=function(a,u,c,x,N,z){var oe="url, color, backgroundColor, size, clickable, correctLevel",Ee;if(Ee=mt(e.QR,arguments,oe,this))return Ee;qe("82.5"),n(a)&&(a="https://zimjs.com"),n(x)&&(x=256),n(u)&&(u=e.black),n(c)&&(c=e.white),n(N)&&(N=!0),n(z)&&(z=2);var ke=document.createElement("div");if(typeof QRCode>"u"){ht("ZIM QR - needs qrcode.js library - see docs");return}var t=new QRCode(ke,{text:a,width:x,height:x,colorDark:u,colorLight:c,correctLevel:z});this.zimBitmap_constructor(t._oDrawing._oContext.canvas),N&&this.cur().on("click",function(){sr(a,"_blank")}),ke=null},e.extend(e.QR,e.Bitmap,null,"zimBitmap",!1),e.GIF=function(a,u,c,x){var N="file, width, height, startPaused",z;if(z=mt(e.GIF,arguments,N,this))return z;if(qe("82.7"),typeof gifler>"u"){ht("ZIM GIF - needs gifler.js library - see docs");return}n(u)&&(u=100),n(c)&&(c=100);var oe=this;oe.paused=!1,this.zimBitmap_constructor(null,u,c),this.cache();var Ee,ke,t;if(le.PATH!=null&&(e.PATH=le.PATH),a.match(/http/)||a.match(/^\//)?t=a:t=(e.PATH?e.PATH:"")+a,oe.gifler=gifler(t).animate(this.cacheCanvas).then(function(l){oe.animator=l,x&&(Ee=setInterval(function(){oe.animator.running()&&(ke=setTimeout(function(){oe.animator.stop(),oe.paused=!0},.1),clearInterval(Ee))},.05))}),!oe.ticker)if(oe.keyObj){var r=oe.keyObj.color,i=oe.keyObj.tolerance,o=oe.keyObj.replacement;oe.ticker=e.Ticker.add(function(){oe.keyOut(r,i,o)})}else oe.ticker=e.Ticker.add(function(){});oe.keyOut=function(l,f,h){return oe.ticker?(e.Ticker.remove(oe.ticker),oe.ticker=e.Ticker.add(function(){oe.keyOut(l,f,h)})):oe.keyObj={color:l,tolerance:f,replacement:h},oe},this.pause=function(l){return n(l)&&(l=!0),oe.animator&&(Ee&&clearInterval(Ee),ke&&clearTimeout(ke),l&&oe.animator.running()?(oe.animator.stop(),e.Ticker.remove(oe.ticker)):!l&&!oe.animator.running()&&(oe.animator.start(),e.Ticker.add(oe.ticker))),oe.paused=l,oe},this.stop=function(){oe.dispose()},this.reset=function(){return oe.animator.reset(),oe.paused&&(oe.animator.start(),e.Ticker.add(oe.ticker)),oe},this.clone=function(){return this.cloneProps(new e.GIF(a,u,c,x))},this.dispose=function(){oe.animator.stop(),oe.parent&&oe.removeFrom(),e.Ticker.remove(oe.ticker),e.gD(this)}},e.extend(e.GIF,e.Bitmap,["clone","dispose","keyOut"],"zimBitmap",!1),e.Theme={set:function(a,u,c,x,N){var z="name, lightenRatio, tint, tintRatio, exclude",oe;if(oe=mt(e.Theme.set,arguments,z))return oe;qe("82.8"),n(a)&&(a="zim");var Ee=a.toLowerCase();n(u)&&(u=0),c==-1&&(c=null),n(x)&&(x=0),N==-1&&(N=null),!n(N)&&!Array.isArray(N)&&(N=[N]),e.THEME=window.THEME={name:Ee,lightenRatio:u,tint:c,tintRatio:x,exclude:N};var ke={},t,r=e.colors.slice(0,8),i=e.colors.slice(8,25);Ee=="zim"?e.loop(e.colors,function(o,l){o=="clear"||o=="faint"||(ke[o]=e.colorsHex[l])}):Ee=="html"?(e.loop(r,function(o){ke[o]=o}),e.loop(i,function(o,l){ke[o]=e.colorsHex[l+8]})):Ee=="future"?(t=["f25019","fd8918","ffc955","1dcfae","00a5ab","007175","00969b","d6b361"],e.loop(r,function(o,l){ke[o]="#"+t[l]}),e.loop(i,function(o,l){ke[o]=e.colorsHex[l+8].toColor("#1dcfae",.4-l*.025)})):Ee=="invert"?(ke={},e.loop(e.colorsHex,function(o,l,f){if(l==f-2)return 1;ke[e.colors[l]]=e.invertColor(o)})):Ee=="greyscale"?(t=["222222","aaaaaa","dddddd","888888","333333","111111","777777","bbbbbb"],e.loop(r,function(o,l){ke[o]="#"+t[l]})):Ee=="neon"?(t=["FF3624","ff6f00","e2f705","a3f307","05f9e2","ED0AF5","ff33c9","e16d00"],e.loop(r,function(o,l){ke[o]="#"+t[l]}),e.loop(i,function(o,l){ke[o]=e.colorsHex[l+8].toColor("#000",.9)}),ke.light=e.lighter,ke.moon=e.lighter,ke.lighter=e.white,ke.white=e.white):Ee=="seventies"?(t=["e5771e","f4a127","ffecb4","6F8212","75c8ae","5a3d2b","956e4e","4c3607"],e.loop(r,function(o,l){ke[o]="#"+t[l]}),e.loop(i,function(o,l){ke[o]=e.colorsHex[l+8].toColor(l<8?"#344f00":"#f4a127",.8-l*.04)})):Ee=="warm"?(t=["965746","c07768","ffecb4","8da279","6da0b1","745c58","9a7e79","be8858"],e.loop(r,function(o,l){ke[o]="#"+t[l]}),e.loop(i,function(o,l){ke[o]=e.colorsHex[l+8].toColor(l<8?"#4e352e":"#745c58",.8-l*.05)})):Ee.constructor=={}.constructor&&(ke=Ee,e.loop(ke,function(o){e.colors.indexOf(o)==-1&&delete ke[o]})),e.loop(N,function(o){o.toLowerCase()=="colors"?e.loop(e.colors,function(l,f){if(f>=8)return 1;N.push(l)}):(o.toLowerCase()=="greys"||o.toLowerCase()=="grays")&&e.loop(e.colors,function(l,f){f<8||N.push(l)})}),e.loop(ke,function(o,l){N&&N.indexOf(o)!=-1||(c&&(l=l.toColor(c,x)),u!=0&&(l=l.lighten(u)),Dt||(window[o]=l),e[o]=l)})},apply:function(a,u,c,x,N){var z="name, lightenRatio, tint, tintRatio, exclude",oe;if(oe=mt(e.Theme.apply,arguments,z))return oe;if(localStorage){n(a)&&(a="zim");var Ee=a.toLowerCase();n(u)&&(u=0),n(c)&&(c=-1),n(x)&&(x=0),n(N)?N=-1:Array.isArray(N)||(N=[N]),localStorage.setItem(v,JSON.stringify({name:Ee,lightenRatio:u,tint:c,tintRatio:x,exclude:N})),window.location.reload()}else ht("ZIM applyTheme() - needs localStorage")},clear:function(){localStorage&&localStorage.getItem(v)&&localStorage.removeItem(v),window.location.reload()}};var v=window.location.href.replace(/[.\/:]/g,"");return localStorage&&localStorage.getItem(v)?(e.THEME=window.THEME=JSON.parse(localStorage.getItem(v)),e.Theme.set(hr.name,hr.lightenRatio,hr.tint,hr.tintRatio,hr.exclude)):e.THEME=window.THEME=null,e}(Se||{});var ti=[["zog",Hn],["zid",_n],["zss",Ii],["zgo",sr],["zum",Zn],["zot",n],["zop",Mi],["zil",Xr],["zet",dr],["zob",mt],["zik",dt],["zta",Oi],["zor",Li],["zogg",oi],["zogp",Si],["zogb",Yr],["zogr",li],["zogy",ht],["zogo",ui],["zogl",kr],["zogd",Pr],["zimplify",Ri],["zimify",Wn]];for(dn=0;dn<ti.length;dn++)Kn=ti[dn],le[Kn[0]]=Se[Kn[0]]=Kn[1];var Kn,ni=[["FIT",Se.FIT],["FILL",Se.FILL],["FULL",Se.FULL],["LEFT",Se.LEFT],["RIGHT",Se.RIGHT],["CENTER",Se.CENTER],["MIDDLE",Se.MIDDLE],["START",Se.START],["END",Se.END],["TOP",Se.TOP],["BOTTOM",Se.BOTTOM],["OVER",Se.OVER],["UNDER",Se.UNDER],["HORIZONTAL",Se.HORIZONTAL],["VERTICAL",Se.VERTICAL],["BOTH",Se.BOTH],["RADIAL",Se.RADIAL],["UP",Se.UP],["DOWN",Se.DOWN],["NEXT",Se.NEXT],["PREV",Se.PREV],["AUTO",Se.AUTO],["AVE",Se.AVE],["DEFAULT",Se.DEFAULT],["ALL",Se.ALL],["NONE",Se.NONE],["GET",Se.GET],["POST",Se.POST],["LOCALSTORAGE",Se.LOCALSTORAGE],["SOCKET",Se.SOCKET],["TO",Se.TO],["FROM",Se.FROM],["SINE",Se.SINE],["SQUARE",Se.SQUARE],["TRIANGLE",Se.TRIANGLE],["SAW",Se.SAW],["SAWTOOTH",Se.SAWTOOTH],["ZAP",Se.ZAP],["TAU",Se.TAU],["DEG",Se.DEG],["RAD",Se.RAD],["PHI",Se.PHI]];for(dn=0;dn<ni.length;dn++)Kn=ni[dn],le[Kn[0]]=Kn[1];var Kn;for(dn=0;dn<Se.colors.length;dn++)le[Se.colors[dn]]=Se.colorsHex[dn];le.zim=Se;var Yi=Se;var Xi=Se.chop,Gi=Se.shuffle,Ui=Se.pluck,Vi=Se.rand,Hi=Se.seedRandom,Wi=Se.odds,qi=Se.rarity,Qi=Se.repeats,Zi=Se.series,Ki=Se.loop,Ji=Se.getTIME,ri=Se.timeout,Bi=Se.interval,$i=Se.async,ji=Se.couple,zi=Se.decouple,es=Se.convertColor,ts=Se.colorRange,ns=Se.lighten,rs=Se.darken,is=Se.toColor,ss=Se.toAlpha,as=Se.toBW,os=Se.invertColor,ls=Se.zimEase,us=Se.spline,fs=Se.pointAlongCurve,cs=Se.distanceAlongCurve,hs=Se.closestPointAlongCurve,ds=Se.transformPoints,ps=Se.trimEndPoints,gs=Se.reversePoints,vs=Se.appendPoints,ys=Se.prependPoints,ms=Se.splitPoints,xs=Se.makeID,ws=Se.makeSyllable,_s=Se.makePrimitive,Ts=Se.makeMath,Cs=Se.swapProperties,As=Se.mobile,Es=Se.vee,bs=Se.extend,ks=Se.copy,Ps=Se.merge,Ss=Se.sortObject,Is=Se.arraysEqual,Ms=Se.arrayMinMax,Os=Se.isEmpty,Ls=Se.isJSON,Ds=Se.isPick,Rs=Se.decimals,Bs=Se.countDecimals,Ns=Se.sign,Fs=Se.constrain,Ys=Se.dist,Xs=Se.rectIntersect,Gs=Se.boundsAroundPoints,Us=Se.angle,Vs=Se.smoothStep,Hs=Se.unicodeToUTF,Ws=Se.capitalizeFirst,qs=Se.Ajax,Qs=Se.Noise,Zs=Se.Point,Ks=Se.Bezier,Js=Se.Boundary,$s=Se.GradientColor,js=Se.RadialColor,zs=Se.BitmapColor,ea=Se.Damp,ta=Se.Proportion,na=Se.ProportionDamp,ra=Se.Dictionary,ia=Se.Hierarchy,sa=Se.Pick,aa=Se.scrollX,oa=Se.scrollY,la=Se.windowWidth,ua=Se.windowHeight,fa=Se.browserZoom,ca=Se.getQueryString,ha=Se.swapHTML,da=Se.urlEncode,pa=Se.urlDecode,ga=Se.setCookie,va=Se.getCookie,ya=Se.deleteCookie,ma=Se.Stage,xa=Se.StageGL,ii=Se.Container,wa=Se.Shape,_a=Se.Bitmap,Ta=Se.Sprite,Ca=Se.MovieClip,Aa=Se.SVGContainer,Ea=Se.CustomShape,ba=Se.Circle,On=Se.Rectangle,ka=Se.Triangle,Pa=Se.Poly,Sa=Se.Line,Ia=Se.Squiggle;var Ma=Se.Flare,Oa=Se.MultiFlare,La=Se.FlareBox,si=Se.Label,Da=Se.LabelOnPath,Ra=Se.LabelOnArc,Ba=Se.LabelLetters,Na=Se.Emoji,Fa=Se.Button,Ya=Se.CheckBox,Xa=Se.RadioButtons,Ga=Se.Toggle,Ua=Se.Tip,Va=Se.Pane,Ha=Se.Panel;var Wa=Se.Page,qa=Se.Central,Qa=Se.Layer,Za=Se.Waiter,Ka=Se.ProgressBar,Ja=Se.Indicator,$a=Se.TextInput,ja=Se.List,za=Se.Stepper,eo=Se.Slider,to=Se.Selector,no=Se.Dial,ro=Se.Tabs,io=Se.Pad,so=Se.NumPad,ao=Se.DPad,oo=Se.Radial,lo=Se.RadialMenu,uo=Se.ColorPicker,fo=Se.EmojiPicker,co=Se.TextEditor,ho=Se.Keyboard,po=Se.Organizer,go=Se.Connectors,vo=Se.Marquee,yo=Se.Carousel,mo=Se.Loader,xo=Se.TextArea,wo=Se.Tag,_o=Se.localToGlobal,To=Se.globalToLocal,Co=Se.localToLocal,Ao=Se.addTo,Eo=Se.removeFrom,bo=Se.added,ko=Se.centerReg,Po=Se.center,So=Se.place,Io=Se.placeReg,Mo=Se.pos,Oo=Se.loc,Lo=Se.mov,Do=Se.sca,Ro=Se.alp,Bo=Se.vis,No=Se.ble,Fo=Se.dye,Yo=Se.hov,Xo=Se.rot,Go=Se.siz,Uo=Se.ske,Vo=Se.reg,Ho=Se.top,Wo=Se.bot,qo=Se.ord,Qo=Se.cur,Zo=Se.sha,Ko=Se.dep,Jo=Se.nam,$o=Se.movement,jo=Se.noMovement,zo=Se.tap,el=Se.noTap,tl=Se.hold,nl=Se.noHold,rl=Se.change,il=Se.noChange,sl=Se.drag,al=Se.noDrag,ol=Se.dragBoundary,ll=Se.mouse,ul=Se.noMouse,fl=Se.wire,cl=Se.noWire,hl=Se.wired,dl=Se.noWired,pl=Se.bind,gl=Se.noBind,vl=Se.transform,yl=Se.gesture,ml=Se.noGesture,xl=Se.gestureBoundary,wl=Se.effect,_l=Se.updateEffects,Tl=Se.noEffect,Cl=Se.addPhysics,Al=Se.removePhysics,El=Se.hitTestPoint,bl=Se.hitTestReg,kl=Se.hitTestRect,Pl=Se.hitTestCircle,Sl=Se.hitTestCircleRect,Il=Se.hitTestCircles,Ml=Se.hitTestBounds,Ol=Se.hitTestPath,Ll=Se.hitTestGrid,Dl=Se.animate,Rl=Se.stopAnimate,Bl=Se.pauseAnimate,Nl=Se.wiggle,Fl=Se.scaleTo,Yl=Se.fit,Xl=Se.boundsToGlobal,Gl=Se.resetBounds,Ul=Se.copyMatrix,Vl=Se.duplicate,Hl=Se.expand,Wl=Se.setSwipe,ql=Se.setMask,Ql=Se.outline,Zl=Se.blendmodes,Kl=Se.Pages,Jl=Se.Arrow,$l=Se.HotSpots,jl=Se.HotSpot,zl=Se.Guide,eu=Se.Grid,tu=Se.Wrapper,ai=Se.Tile,nu=Se.Pack,ru=Se.Beads,iu=Se.Layout,su=Se.Accessibility,au=Se.TextureActive,ou=Se.TextureActives,lu=Se.TextureActivesManager,uu=Se.Manager,fu=Se.ResizeManager,cu=Se.TransformManager,hu=Se.GuideManager,du=Se.GridManager,pu=Se.LayoutManager,gu=Se.SelectionSet,vu=Se.SelectionManager,yu=Se.Bind,mu=Se.Swipe,xu=Se.Swiper,wu=Se.MotionController,_u=Se.GamePad,Tu=Se.Portal,Cu=Se.Physics,Au=Se.TimeLine,Eu=Se.BlurEffect,bu=Se.GlowEffect,ku=Se.ShadowEffect,Pu=Se.ColorEffect,Su=Se.MultiEffect,Iu=Se.AlphaEffect,Mu=Se.Pixel,Ou=Se.Parallax,Lu=Se.Flipper,Du=Se.Book,Ru=Se.Scrambler,Bu=Se.Scroller,Nu=Se.Dynamo,Fu=Se.Accelerator,Yu=Se.Emitter,Xu=Se.Generator,Gu=Se.Pen,Uu=Se.SoundWave,Vu=Se.Synth,Hu=Se.VR,Wu=Se.Frame,qu=Se.Pic,Qu=Se.Aud,Zu=Se.Vid,Ku=Se.SVG,Ju=Se.SensorAsk,$u=Se.distill,ju=Se.parseAudioSprite,zu=Se.previewAudioSprite,ef=Se.svgToBitmap,tf=Se.makeContent,nf=Se.fastFrame,rf=Se.addWires,sf=Se.setBlurDetect,af=Se.Wonder,of=Se.getLatestVersions,lf=Se.PWA,uf=Se.QR,ff=Se.GIF,hr=Se.THEME;})();
/*! ZIM - JavaScript Canvas Framework - Code Creativity
https://zimjs.com (c) 2023 modified MIT License
Donations welcome https://zimjs.com/donate
Node module - also see ES6 modules at https://zimjs.com/cdn
*/
/*! Bundled license information:

@danzen/createjs/create.js:
  (*!
  * CreateJS
  * Visit http://createjs.com/ for documentation, updates and examples.
  *
  * Copyright (c) 2010 gskinner.com, inc.
  *
  * Permission is hereby granted, free of charge, to any person
  * obtaining a copy of this software and associated documentation
  * files (the "Software"), to deal in the Software without
  * restriction, including without limitation the rights to use,
  * copy, modify, merge, publish, distribute, sublicense, and/or sell
  * copies of the Software, and to permit persons to whom the
  * Software is furnished to do so, subject to the following
  * conditions:
  *
  * The above copyright notice and this permission notice shall be
  * included in all copies or substantial portions of the Software.
  *
  * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
  * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
  * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
  * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
  * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
  * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
  * OTHER DEALINGS IN THE SOFTWARE.
  *)
*/
